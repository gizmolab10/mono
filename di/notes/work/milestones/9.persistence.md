# Milestone 9: Persistence
**Timeline:** Feb 5, 2026 | **Status:** done

Save/load scene state.

---

## Goals

- [x] JSON Serialize
	- [x] SO state (bounds)
	- [x] SO orientation (moved from O_Scene to Smart_Object as SOT)
	- [x] camera position (eye, center, up)
- [x] Save to localStorage (single scene, auto-save on drag)
- [x] Load latest one on app start
- [x] Clear/reset option (reset button in Controls, white bg, black hover)

## Format Research

| Format          | Speed                        | Size           | Human Readable | Notes                          |
| --------------- | ---------------------------- | -------------- | -------------- | ------------------------------ |
| **JSON**        | Baseline                     | Largest        | Yes            | Universal, easy debugging      |
| **MessagePack** | ~37% faster                  | ~15% smaller   | No             | Best performance overall       |
| **CBOR**        | ~27% faster                  | ~27% smaller   | No             | AWS-friendly, JSON-like schema |
| **BSON**        | Slower encode, faster decode | Larger than MP | No             | MongoDB native                 |

Key findings:
- **MessagePack** wins on raw performance — 10K objects serialize in ~918μs
- **CBOR** is the best drop-in JSON replacement (same data model, binary encoding)
- **JSON** still solid for debugging and human editing

**Decision:** Use JSON — readable, debuggable, localStorage-friendly. If performance becomes an issue, use MessagePack or CBOR (same structure, just binary).

Sources:
- [SitePoint: Data Serialization Comparison](https://www.sitepoint.com/data-serialization-comparison-json-yaml-bson-messagepack/)
- [DEV: JSON Alternatives](https://dev.to/nikl/json-is-slower-here-are-its-4-faster-alternatives-2g30)
- [Zderadicka: JSON vs CBOR vs MessagePack](https://zderadicka.eu/comparison-of-json-like-serializations-json-vs-ubjson-vs-messagepack-vs-cbor/)

## Implementation

- `Smart_Object.serialize()` / `Smart_Object.deserialize()` — name + 6 bounds + orientation quat
- `Camera.serialize()` / `Camera.deserialize()` — eye, center, up vectors
- `Persistence` manager — save/load/clear via Preferences localStorage wrapper
- `Setup.ts` — loads saved state on init, saves after every drag

---

## Notes


# Milestone 7: Edit Drags

**Started:** Feb 3, 2026 | **Status:** in progress

## Goal

Make selected geometry editable by dragging. only faces can be selected. drag only works on a corner or an edge of the selected face. editing is geometrically confined to the 2D plane of the selected face.

---

## Our Work

### Understand current state

- [x] How does rotation drag work now? — `e3.set_drag_handler` in Trivial.ts always calls `rotate_object`
- [x] What's the relationship between screen delta and world delta? — camera at (0,0,5), right=(1,0,0), up=(0,1,0)
- [x] Where do the cube vertices live? — O_Scene.vertices, but both cubes shared same array (fixed)

### Design

- [x] Should edit drag modify O_Scene vertices directly, or go through SO? — through SO (move_vertex, move_vertices)
- [x] How to detect "drag on selection" vs "drag to rotate"? — `edit_selection` returns true if selection exists
- [x] What happens to inner cube when outer cube's corner moves? — nothing, they have separate vertex arrays now

### Implement

- [x] Clone vertices on Scene.create (so each object has its own)
- [x] Add Point3.clone() method
- [x] Add move_vertex, move_vertices, edge_vertices, face_vertices to Smart_Object
- [x] Add screen_to_world, edit_selection to Events_3D
- [x] Route drag: selection ? edit : rotate (Trivial.ts)
- [x] eliminate selection of edge or corner
- [x] click-drag only applies to an edge or a corner
- [x] drag is geometrically confined to the 2D plane of the selected face

### Test manually

- [ ] Click corner, drag — moves that corner only
- [ ] Click edge, drag — moves both endpoints
- [ ] Click face, drag — moves all face vertices
- [ ] Click empty, drag — rotates as before

### Polish

- [ ] Visual feedback during drag
- [ ] Undo? (maybe milestone 8+)

---

## Artifacts

- `src/lib/ts/types/Coordinates.ts` — added Point3.clone()
- `src/lib/ts/render/Scene.ts` — clone vertices on create
- `src/lib/ts/runtime/Smart_Object.ts` — vertex editing methods, face_normal, corner_in_face, edge_in_face
- `src/lib/ts/signals/Events_3D.ts` — screen_to_world (with plane projection), edit_selection, drag_target tracking
- `src/lib/ts/render/Trivial.ts` — route drag by selection

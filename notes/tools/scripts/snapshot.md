# Project Snapshot
Generated: Sat Jan 31 21:40:40 PST 2026

## Structure
```
/Users/sand/GitHub/mono/vitepress.build.txt
/Users/sand/GitHub/mono/di/vitepress.build.txt
/Users/sand/GitHub/mono/di/di.code-workspace
/Users/sand/GitHub/mono/di/svelte.config.js
/Users/sand/GitHub/mono/di/index.html
/Users/sand/GitHub/mono/di/.obsidian/workspace.json
/Users/sand/GitHub/mono/di/.obsidian/app.json
/Users/sand/GitHub/mono/di/.obsidian/core-plugins.json
/Users/sand/GitHub/mono/di/.obsidian/appearance.json
/Users/sand/GitHub/mono/di/README.md
/Users/sand/GitHub/mono/di/yarn.lock
/Users/sand/GitHub/mono/di/notes/designs/Details.md
/Users/sand/GitHub/mono/di/notes/designs/Main.md
/Users/sand/GitHub/mono/di/notes/designs/index.md
/Users/sand/GitHub/mono/di/notes/designs/Controls.md
/Users/sand/GitHub/mono/di/notes/designs/Preferences.md
/Users/sand/GitHub/mono/di/notes/designs/Graph.md
/Users/sand/GitHub/mono/di/notes/architecture/managers.md
/Users/sand/GitHub/mono/di/notes/architecture/project.md
/Users/sand/GitHub/mono/di/notes/architecture/index.md
/Users/sand/GitHub/mono/di/notes/architecture/files.md
/Users/sand/GitHub/mono/di/notes/architecture/rendering.types.md
/Users/sand/GitHub/mono/di/notes/index.md
/Users/sand/GitHub/mono/di/notes/guides/develop/gotchas.md
/Users/sand/GitHub/mono/di/notes/guides/develop/best.practices.md
/Users/sand/GitHub/mono/di/notes/guides/develop/index.md
/Users/sand/GitHub/mono/di/notes/guides/road.map.md
/Users/sand/GitHub/mono/di/notes/guides/index.md
/Users/sand/GitHub/mono/di/notes/work/simplicity.md
/Users/sand/GitHub/mono/di/notes/work/pacing.md
/Users/sand/GitHub/mono/di/notes/work/revisit.md
/Users/sand/GitHub/mono/di/notes/work/index.md
/Users/sand/GitHub/mono/di/notes/work/milestones/1.solid.foundation.md
/Users/sand/GitHub/mono/di/notes/work/milestones/4.hits.manager.md
/Users/sand/GitHub/mono/di/notes/work/milestones/3.docs.md
/Users/sand/GitHub/mono/di/notes/work/milestones/index.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/implement.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/architecture.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/components.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/index.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/milestone 2.md
/Users/sand/GitHub/mono/di/notes/work/milestones/5.smart.objects.md
/Users/sand/GitHub/mono/di/.gitignore
/Users/sand/GitHub/mono/di/package.json
/Users/sand/GitHub/mono/di/tsconfig.json
/Users/sand/GitHub/mono/di/vite.config.ts
/Users/sand/GitHub/mono/di/vitest.config.ts
/Users/sand/GitHub/mono/di/CLAUDE.MD
/Users/sand/GitHub/mono/di/src/main.ts
/Users/sand/GitHub/mono/di/src/App.svelte
/Users/sand/GitHub/mono/di/src/vite-env.d.ts
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Details.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Controls.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Main.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Graph.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/draw/Printable.svelte
/Users/sand/GitHub/mono/di/src/lib/ts/types/Coordinates.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Types.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Enumerations.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Angle.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/index.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Attribute.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Interfaces.ts
/Users/sand/GitHub/mono/di/src/lib/ts/signals/Mouse_Timer.ts
/Users/sand/GitHub/mono/di/src/lib/ts/signals/Events.ts
/Users/sand/GitHub/mono/di/src/lib/ts/managers/Hits.ts
/Users/sand/GitHub/mono/di/src/lib/ts/managers/Components.ts
/Users/sand/GitHub/mono/di/src/lib/ts/managers/Preferences.ts
/Users/sand/GitHub/mono/di/src/lib/ts/runtime/Smart_Object.ts
/Users/sand/GitHub/mono/di/src/lib/ts/runtime/Identifiable.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Testworthy_Utilities.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/setup.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Coordinates.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Extensions.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Angle.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Colors.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Input.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Camera.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Animation.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Scene.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Render.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/index.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Trivial.ts
/Users/sand/GitHub/mono/di/src/lib/ts/state/S_Hit_Target.ts
/Users/sand/GitHub/mono/di/src/lib/ts/state/S_Component.ts
/Users/sand/GitHub/mono/di/src/lib/ts/state/S_Mouse.ts
/Users/sand/GitHub/mono/di/src/lib/ts/common/Testworthy_Utilities.ts
/Users/sand/GitHub/mono/di/src/lib/ts/common/Extensions.ts
/Users/sand/GitHub/mono/di/src/lib/ts/common/Constants.ts
/Users/sand/GitHub/mono/di/src/lib/ts/draw/Colors.ts
/Users/sand/GitHub/mono/di/src/lib/ts/draw/SVG_Paths.ts
/Users/sand/GitHub/mono/.DS_Store
/Users/sand/GitHub/mono/.obsidian/workspace.json
/Users/sand/GitHub/mono/.obsidian/app.json
/Users/sand/GitHub/mono/.obsidian/core-plugins.json
/Users/sand/GitHub/mono/.obsidian/appearance.json
/Users/sand/GitHub/mono/.claude/settings.local.json
/Users/sand/GitHub/mono/README.md
/Users/sand/GitHub/mono/yarn.lock
/Users/sand/GitHub/mono/logs/api.log
/Users/sand/GitHub/mono/logs/core-docs.log
/Users/sand/GitHub/mono/logs/ws.log
/Users/sand/GitHub/mono/logs/rebuild-status.txt
/Users/sand/GitHub/mono/logs/mono-docs.log
/Users/sand/GitHub/mono/logs/ws-docs.log
/Users/sand/GitHub/mono/logs/docs.log
/Users/sand/GitHub/mono/logs/dispatcher-restart.log
/Users/sand/GitHub/mono/logs/di.log
/Users/sand/GitHub/mono/logs/api-restart.log
/Users/sand/GitHub/mono/logs/di-docs.log
/Users/sand/GitHub/mono/logs/dispatch.log
/Users/sand/GitHub/mono/logs/paths.log
/Users/sand/GitHub/mono/logs/hub.log
/Users/sand/GitHub/mono/logs/restart-status.txt
/Users/sand/GitHub/mono/logs/health.log
/Users/sand/GitHub/mono/notes/tools/.DS_Store
/Users/sand/GitHub/mono/notes/tools/docs/sync-index-files.sh
/Users/sand/GitHub/mono/notes/tools/docs/prebuild.sh
/Users/sand/GitHub/mono/notes/tools/docs/update-project-docs.sh
/Users/sand/GitHub/mono/notes/tools/docs/yarn.lock
/Users/sand/GitHub/mono/notes/tools/docs/package.json
/Users/sand/GitHub/mono/notes/tools/docs/create-docs-db-data.sh
/Users/sand/GitHub/mono/notes/tools/docs/lib/generate-sidebar.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/config-updater.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/sync-sidebar.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/merge-files.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/fix-links.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/link-finder.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/markdown-parser.ts
/Users/sand/GitHub/mono/notes/tools/docs/tsconfig.json
/Users/sand/GitHub/mono/notes/tools/docs/reset-docs.sh
/Users/sand/GitHub/mono/notes/tools/docs/src/lib/ts/files/Docs.ts
/Users/sand/GitHub/mono/notes/tools/index.md
/Users/sand/GitHub/mono/notes/tools/scripts/validate-paths.sh.bak
/Users/sand/GitHub/mono/notes/tools/scripts/delete-netlify-deploys.sh
/Users/sand/GitHub/mono/notes/tools/scripts/update-docs.sh
/Users/sand/GitHub/mono/notes/tools/scripts/snapshot.md
/Users/sand/GitHub/mono/notes/tools/scripts/snapshot.sh
/Users/sand/GitHub/mono/notes/tools/scripts/validate-paths.ts
/Users/sand/GitHub/mono/notes/tools/scripts/file-structure-check.sh
/Users/sand/GitHub/mono/notes/tools/scripts/analyze-counts.sh
/Users/sand/GitHub/mono/notes/tools/scripts/index.md
/Users/sand/GitHub/mono/notes/tools/hub/dispatcher.py
/Users/sand/GitHub/mono/notes/tools/hub/index.html
/Users/sand/GitHub/mono/notes/tools/hub/ports.json
/Users/sand/GitHub/mono/notes/tools/hub/start-hub.sh
/Users/sand/GitHub/mono/notes/tools/hub/index.md
/Users/sand/GitHub/mono/notes/tools/hub/servers.sh
/Users/sand/GitHub/mono/notes/.DS_Store
/Users/sand/GitHub/mono/notes/index.md
/Users/sand/GitHub/mono/notes/guides/tools/single-line.md
/Users/sand/GitHub/mono/notes/guides/tools/index.md
/Users/sand/GitHub/mono/notes/guides/tools/hub-app.md
/Users/sand/GitHub/mono/notes/guides/.DS_Store
/Users/sand/GitHub/mono/notes/guides/develop/markdown.md
/Users/sand/GitHub/mono/notes/guides/develop/css.md
/Users/sand/GitHub/mono/notes/guides/develop/migration.md
/Users/sand/GitHub/mono/notes/guides/develop/index.md
/Users/sand/GitHub/mono/notes/guides/develop/style.md
/Users/sand/GitHub/mono/notes/guides/develop/build.md
/Users/sand/GitHub/mono/notes/guides/develop/aesthetics.md
/Users/sand/GitHub/mono/notes/guides/develop/refactoring.md
/Users/sand/GitHub/mono/notes/guides/test/testing.md
/Users/sand/GitHub/mono/notes/guides/test/index.md
/Users/sand/GitHub/mono/notes/guides/test/debugging.md
/Users/sand/GitHub/mono/notes/guides/setup/netlify.md
/Users/sand/GitHub/mono/notes/guides/setup/vitepress.md
/Users/sand/GitHub/mono/notes/guides/setup/index.md
/Users/sand/GitHub/mono/notes/guides/setup/access.md
/Users/sand/GitHub/mono/notes/guides/setup/onboarding.md
/Users/sand/GitHub/mono/notes/guides/collaborate/voice.md
/Users/sand/GitHub/mono/notes/guides/collaborate/chat.md
/Users/sand/GitHub/mono/notes/guides/collaborate/workflow.md
/Users/sand/GitHub/mono/notes/guides/collaborate/journals.md
/Users/sand/GitHub/mono/notes/guides/collaborate/index.md
/Users/sand/GitHub/mono/notes/guides/index.md
/Users/sand/GitHub/mono/notes/guides/philosophy/limitations.md
/Users/sand/GitHub/mono/notes/guides/philosophy/index.md
/Users/sand/GitHub/mono/notes/guides/philosophy/motive.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/workarounds.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/kinds.of.tasks.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/always.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/index.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/shorthand.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/gates.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/keywords.md
/Users/sand/GitHub/mono/notes/work/next/curiosity.md
/Users/sand/GitHub/mono/notes/work/next/pacing.md
/Users/sand/GitHub/mono/notes/work/next/commoditize.md
/Users/sand/GitHub/mono/notes/work/next/index.md
/Users/sand/GitHub/mono/notes/work/next/personas.md
/Users/sand/GitHub/mono/notes/work/articles/how.to.build.it.md
/Users/sand/GitHub/mono/notes/work/articles/write.article.md
/Users/sand/GitHub/mono/notes/work/articles/accidental.programmer.md
/Users/sand/GitHub/mono/notes/work/articles/index.md
/Users/sand/GitHub/mono/notes/work/revisit.md
/Users/sand/GitHub/mono/notes/work/journals/journal.md
/Users/sand/GitHub/mono/notes/work/journals/index.md
/Users/sand/GitHub/mono/notes/work/journals/guidance-journal.md
/Users/sand/GitHub/mono/notes/work/index.md
```

## Files

### /Users/sand/GitHub/mono/vitepress.build.txt
```txt
```

### /Users/sand/GitHub/mono/di/vitepress.build.txt
```txt
```

### /Users/sand/GitHub/mono/di/di.code-workspace
```code-workspace
{
	"folders": [
		{
			"path": "."
		}
	],
	"settings": {}
}```

### /Users/sand/GitHub/mono/di/svelte.config.js
```js
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte';

export default {
  preprocess: vitePreprocess()
};
```

### /Users/sand/GitHub/mono/di/index.html
```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Design Intuition - Quaternions</title>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
```

### /Users/sand/GitHub/mono/di/.obsidian/workspace.json
```json
{
  "main": {
    "id": "b06ab8869be44054",
    "type": "split",
    "children": [
      {
        "id": "70bee0db2aed513e",
        "type": "tabs",
        "children": [
          {
            "id": "e32a6ad9ee169683",
            "type": "leaf",
            "state": {
              "type": "markdown",
              "state": {
                "file": "notes/work/layout-algorithm.md",
                "mode": "source",
                "source": false
              },
              "icon": "lucide-file",
              "title": "layout-algorithm"
            }
          }
        ]
      }
    ],
    "direction": "vertical"
  },
  "left": {
    "id": "39b4c06c2dd1c39e",
    "type": "split",
    "children": [
      {
        "id": "3e7cb66539fb7bd6",
        "type": "tabs",
        "children": [
          {
            "id": "a796f3592b7de946",
            "type": "leaf",
            "state": {
              "type": "file-explorer",
              "state": {
                "sortOrder": "alphabetical",
                "autoReveal": false
              },
              "icon": "lucide-folder-closed",
              "title": "Files"
            }
          },
          {
            "id": "3e7696fe2b4f990d",
            "type": "leaf",
            "state": {
              "type": "search",
              "state": {
                "query": "",
                "matchingCase": false,
                "explainSearch": false,
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical"
              },
              "icon": "lucide-search",
              "title": "Search"
            }
          },
          {
            "id": "a1684dafdfec962d",
            "type": "leaf",
            "state": {
              "type": "bookmarks",
              "state": {},
              "icon": "lucide-bookmark",
              "title": "Bookmarks"
            }
          }
        ]
      }
    ],
    "direction": "horizontal",
    "width": 300
  },
  "right": {
    "id": "a912b0103fb9e225",
    "type": "split",
    "children": [
      {
        "id": "0a9521770bee001a",
        "type": "tabs",
        "children": [
          {
            "id": "6afe67911c68a3d0",
            "type": "leaf",
            "state": {
              "type": "backlink",
              "state": {
                "file": "notes/work/svelte.md",
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical",
                "showSearch": false,
                "searchQuery": "",
                "backlinkCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-coming-in",
              "title": "Backlinks for svelte"
            }
          },
          {
            "id": "186fa782ea84aa69",
            "type": "leaf",
            "state": {
              "type": "outgoing-link",
              "state": {
                "file": "notes/work/svelte.md",
                "linksCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-going-out",
              "title": "Outgoing links from svelte"
            }
          },
          {
            "id": "32f4a3b722e529d2",
            "type": "leaf",
            "state": {
              "type": "tag",
              "state": {
                "sortOrder": "frequency",
                "useHierarchy": true,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-tags",
              "title": "Tags"
            }
          },
          {
            "id": "33a4f069835e1ca7",
            "type": "leaf",
            "state": {
              "type": "all-properties",
              "state": {
                "sortOrder": "frequency",
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-archive",
              "title": "All properties"
            }
          },
          {
            "id": "2b0b551f291ce7dc",
            "type": "leaf",
            "state": {
              "type": "outline",
              "state": {
                "file": "notes/work/svelte.md",
                "followCursor": false,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-list",
              "title": "Outline of svelte"
            }
          }
        ]
      }
    ],
    "direction": "horizontal",
    "width": 300,
    "collapsed": true
  },
  "left-ribbon": {
    "hiddenItems": {
      "switcher:Open quick switcher": false,
      "graph:Open graph view": false,
      "canvas:Create new canvas": false,
      "daily-notes:Open today's daily note": false,
      "templates:Insert template": false,
      "command-palette:Open command palette": false,
      "bases:Create new base": false
    }
  },
  "active": "e32a6ad9ee169683",
  "lastOpenFiles": [
    "notes/architecture/rendering.types.md",
    "notes/work/combined-docs.md",
    "notes/work/layout-algorithm.md",
    "notes/work/milestones/2.panel/implement.md",
    "notes/guides/aesthetics.md",
    "notes/work/aesthetics.md",
    "notes/designs/aesthetics.md",
    "notes/designs/Fillets.md",
    "src/lib/svelte/layout/Fillets.svelte",
    "notes/guides/develop/style.md",
    "src/lib/ts/draw/SVG_Paths.ts",
    "notes/work/utilities",
    "src/lib/ts/common/Testworthy_Utilities.ts",
    "src/lib/ts/draw/Colors.ts",
    "src/lib/ts/draw",
    "src/lib/ts/managers/draw",
    "Screenshot 2026-01-07 at 1.26.15 AM.png",
    "Screenshot 2026-01-07 at 1.20.05 AM.png",
    "Screenshot 2026-01-07 at 1.18.21 AM.png",
    "notes/designs/Box.md",
    "notes/designs/Preferences.md",
    "src/lib/svelte/layout/Box.svelte",
    "notes/designs/index.md",
    "src/lib/svelte/layout/Separator.svelte",
    "src/lib/svelte/layout/Gull_Wings.svelte",
    "notes/designs/Gull_Wings.md",
    "notes/designs/Separator.md",
    "notes/designs/Details.md",
    "notes/designs/Graph.md",
    "notes/designs/Controls.md",
    "notes/designs/Main.md",
    "notes/guides/index.md",
    "notes/guides/road.map.md",
    "README.md",
    "notes/work/articles/accidental.programmer.md",
    "notes/guides/collaborate/voice.md",
    "notes/guides/collaborate/workflow.md",
    "notes/guides/collaborate/chat.md",
    "notes/guides/collaborate/access.md"
  ]
}```

### /Users/sand/GitHub/mono/di/.obsidian/app.json
```json
{
  "alwaysUpdateLinks": true
}```

### /Users/sand/GitHub/mono/di/.obsidian/core-plugins.json
```json
{
  "file-explorer": true,
  "global-search": true,
  "switcher": true,
  "graph": true,
  "backlink": true,
  "canvas": true,
  "outgoing-link": true,
  "tag-pane": true,
  "footnotes": false,
  "properties": true,
  "page-preview": true,
  "daily-notes": true,
  "templates": true,
  "note-composer": true,
  "command-palette": true,
  "slash-command": false,
  "editor-status": true,
  "bookmarks": true,
  "markdown-importer": false,
  "zk-prefixer": false,
  "random-note": false,
  "outline": true,
  "word-count": true,
  "slides": false,
  "audio-recorder": false,
  "workspaces": false,
  "file-recovery": true,
  "publish": false,
  "sync": true,
  "bases": true,
  "webviewer": false
}```

### /Users/sand/GitHub/mono/di/.obsidian/appearance.json
```json
{}```

### /Users/sand/GitHub/mono/di/README.md
```md
# di

Design Intuition — a cabinetry design tool the even people who hate computers will enjoy using.

## Stack

- Svelte 5 (runes, no slots)
- TypeScript
- Vite
- Vitest

## Setup

```bash
yarn install
yarn dev
```

## Structure

```
src/
├── App.svelte
├── lib/
│   ├── svelte/
│   │   └── layout/
│   │       ├── Main.svelte      # Root layout
│   │       ├── Controls.svelte  # Top bar
│   │       ├── Graph.svelte     # Canvas + 3D rendering
│   │       └── Details.svelte   # Left sidebar
│   └── ts/
│       ├── render/              # Camera, Input, Render, Animation, Scene
│       └── types/               # Coordinates, Interfaces
notes/
├── guides/                      # Development documentation
└── work/                        # Milestones and tasks
```

## Layout

```
┌─────────────────────────────────────────────────────┐
│                     Controls                        │
├───────────────┬─────────────────────────────────────┤
│               │                                     │
│    Details    │              Graph                  │
│   (280px)     │         (canvas, flex)              │
│               │                                     │
└───────────────┴─────────────────────────────────────┘
```

## License

MIT
```

### /Users/sand/GitHub/mono/di/yarn.lock
```lock
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


"@algolia/abtesting@1.12.2":
  version "1.12.2"
  resolved "https://registry.yarnpkg.com/@algolia/abtesting/-/abtesting-1.12.2.tgz#1cba5e3c654d02c6d435822a0a0070a5c435daa6"
  integrity sha512-oWknd6wpfNrmRcH0vzed3UPX0i17o4kYLM5OMITyMVM2xLgaRbIafoxL0e8mcrNNb0iORCJA0evnNDKRYth5WQ==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/autocomplete-core@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-core/-/autocomplete-core-1.17.7.tgz#2c410baa94a47c5c5f56ed712bb4a00ebe24088b"
  integrity sha512-BjiPOW6ks90UKl7TwMv7oNQMnzU+t/wk9mgIDi6b1tXpUek7MW0lbNOUHpvam9pe3lVCf4xPFT+lK7s+e+fs7Q==
  dependencies:
    "@algolia/autocomplete-plugin-algolia-insights" "1.17.7"
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-plugin-algolia-insights@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-plugin-algolia-insights/-/autocomplete-plugin-algolia-insights-1.17.7.tgz#7d2b105f84e7dd8f0370aa4c4ab3b704e6760d82"
  integrity sha512-Jca5Ude6yUOuyzjnz57og7Et3aXjbwCSDf/8onLHSQgw1qW3ALl9mrMWaXb5FmPVkV3EtkD2F/+NkT6VHyPu9A==
  dependencies:
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-preset-algolia@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-preset-algolia/-/autocomplete-preset-algolia-1.17.7.tgz#c9badc0d73d62db5bf565d839d94ec0034680ae9"
  integrity sha512-ggOQ950+nwbWROq2MOCIL71RE0DdQZsceqrg32UqnhDz8FlO9rL8ONHNsI2R1MH0tkgVIDKI/D0sMiUchsFdWA==
  dependencies:
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-shared@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-shared/-/autocomplete-shared-1.17.7.tgz#105e84ad9d1a31d3fb86ba20dc890eefe1a313a0"
  integrity sha512-o/1Vurr42U/qskRSuhBH+VKxMvkkUVTLU6WZQr+L5lGZZLYWyhdzWjW0iGXY7EkwRTjBqvN2EsR81yCTGV/kmg==

"@algolia/client-abtesting@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-abtesting/-/client-abtesting-5.46.2.tgz#264a72f0e9d2fe0d0dc5c3d2d16bbb9cfe2ce9e8"
  integrity sha512-oRSUHbylGIuxrlzdPA8FPJuwrLLRavOhAmFGgdAvMcX47XsyM+IOGa9tc7/K5SPvBqn4nhppOCEz7BrzOPWc4A==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-analytics@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-analytics/-/client-analytics-5.46.2.tgz#3f00a237508aa0c46c9c02dea9c855e0a78e241f"
  integrity sha512-EPBN2Oruw0maWOF4OgGPfioTvd+gmiNwx0HmD9IgmlS+l75DatcBkKOPNJN+0z3wBQWUO5oq602ATxIfmTQ8bA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-common@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-common/-/client-common-5.46.2.tgz#7f282fd8f721b0d96958445df2170f4c7dce6aac"
  integrity sha512-Hj8gswSJNKZ0oyd0wWissqyasm+wTz1oIsv5ZmLarzOZAp3vFEda8bpDQ8PUhO+DfkbiLyVnAxsPe4cGzWtqkg==

"@algolia/client-insights@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-insights/-/client-insights-5.46.2.tgz#194b7b529ee8a4ffd5d70037745082996c3b9aa0"
  integrity sha512-6dBZko2jt8FmQcHCbmNLB0kCV079Mx/DJcySTL3wirgDBUH7xhY1pOuUTLMiGkqM5D8moVZTvTdRKZUJRkrwBA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-personalization@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-personalization/-/client-personalization-5.46.2.tgz#d604da7f0a3df1b3e2a9fe338d368e48fb781f8e"
  integrity sha512-1waE2Uqh/PHNeDXGn/PM/WrmYOBiUGSVxAWqiJIj73jqPqvfzZgzdakHscIVaDl6Cp+j5dwjsZ5LCgaUr6DtmA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-query-suggestions@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-query-suggestions/-/client-query-suggestions-5.46.2.tgz#f13bc5897bfbdc19509d430a26e9bbe2402e00c9"
  integrity sha512-EgOzTZkyDcNL6DV0V/24+oBJ+hKo0wNgyrOX/mePBM9bc9huHxIY2352sXmoZ648JXXY2x//V1kropF/Spx83w==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-search@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-search/-/client-search-5.46.2.tgz#771367916aaa3fb7a19d5944f8375504b0568ba6"
  integrity sha512-ZsOJqu4HOG5BlvIFnMU0YKjQ9ZI6r3C31dg2jk5kMWPSdhJpYL9xa5hEe7aieE+707dXeMI4ej3diy6mXdZpgA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/ingestion@1.46.2":
  version "1.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/ingestion/-/ingestion-1.46.2.tgz#2a5d8a592d9f864dfb438722506382af56f8554f"
  integrity sha512-1Uw2OslTWiOFDtt83y0bGiErJYy5MizadV0nHnOoHFWMoDqWW0kQoMFI65pXqRSkVvit5zjXSLik2xMiyQJDWQ==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/monitoring@1.46.2":
  version "1.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/monitoring/-/monitoring-1.46.2.tgz#bd199368a49cb799cf12cfe76c49de6dd3021148"
  integrity sha512-xk9f+DPtNcddWN6E7n1hyNNsATBCHIqAvVGG2EAGHJc4AFYL18uM/kMTiOKXE/LKDPyy1JhIerrh9oYb7RBrgw==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/recommend@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/recommend/-/recommend-5.46.2.tgz#e74bade1254046ed9be8ccd37f2a116ab9799508"
  integrity sha512-NApbTPj9LxGzNw4dYnZmj2BoXiAc8NmbbH6qBNzQgXklGklt/xldTvu+FACN6ltFsTzoNU6j2mWNlHQTKGC5+Q==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/requester-browser-xhr@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/requester-browser-xhr/-/requester-browser-xhr-5.46.2.tgz#7662480143405e815e1eed99136b4b2acd838ee7"
  integrity sha512-ekotpCwpSp033DIIrsTpYlGUCF6momkgupRV/FA3m62SreTSZUKjgK6VTNyG7TtYfq9YFm/pnh65bATP/ZWJEg==
  dependencies:
    "@algolia/client-common" "5.46.2"

"@algolia/requester-fetch@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/requester-fetch/-/requester-fetch-5.46.2.tgz#dee07f0131b75f30d083bafd6fb878afe7402eb9"
  integrity sha512-gKE+ZFi/6y7saTr34wS0SqYFDcjHW4Wminv8PDZEi0/mE99+hSrbKgJWxo2ztb5eqGirQTgIh1AMVacGGWM1iw==
  dependencies:
    "@algolia/client-common" "5.46.2"

"@algolia/requester-node-http@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/requester-node-http/-/requester-node-http-5.46.2.tgz#7869d67cb2926bbdbfbfed2b4757e547c2e227eb"
  integrity sha512-ciPihkletp7ttweJ8Zt+GukSVLp2ANJHU+9ttiSxsJZThXc4Y2yJ8HGVWesW5jN1zrsZsezN71KrMx/iZsOYpg==
  dependencies:
    "@algolia/client-common" "5.46.2"

"@babel/helper-string-parser@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz#54da796097ab19ce67ed9f88b47bb2ec49367687"
  integrity sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==

"@babel/helper-validator-identifier@^7.28.5":
  version "7.28.5"
  resolved "https://registry.yarnpkg.com/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz#010b6938fab7cb7df74aa2bbc06aa503b8fe5fb4"
  integrity sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==

"@babel/parser@^7.28.5":
  version "7.28.5"
  resolved "https://registry.yarnpkg.com/@babel/parser/-/parser-7.28.5.tgz#0b0225ee90362f030efd644e8034c99468893b08"
  integrity sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==
  dependencies:
    "@babel/types" "^7.28.5"

"@babel/types@^7.28.5":
  version "7.28.5"
  resolved "https://registry.yarnpkg.com/@babel/types/-/types-7.28.5.tgz#10fc405f60897c35f07e85493c932c7b5ca0592b"
  integrity sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA==
  dependencies:
    "@babel/helper-string-parser" "^7.27.1"
    "@babel/helper-validator-identifier" "^7.28.5"

"@docsearch/css@3.8.2":
  version "3.8.2"
  resolved "https://registry.yarnpkg.com/@docsearch/css/-/css-3.8.2.tgz#7973ceb6892c30f154ba254cd05c562257a44977"
  integrity sha512-y05ayQFyUmCXze79+56v/4HpycYF3uFqB78pLPrSV5ZKAlDuIAAJNhaRi8tTdRNXh05yxX/TyNnzD6LwSM89vQ==

"@docsearch/js@3.8.2":
  version "3.8.2"
  resolved "https://registry.yarnpkg.com/@docsearch/js/-/js-3.8.2.tgz#bdcfc9837700eb38453b88e211ab5cc5a3813cc6"
  integrity sha512-Q5wY66qHn0SwA7Taa0aDbHiJvaFJLOJyHmooQ7y8hlwwQLQ/5WwCcoX0g7ii04Qi2DJlHsd0XXzJ8Ypw9+9YmQ==
  dependencies:
    "@docsearch/react" "3.8.2"
    preact "^10.0.0"

"@docsearch/react@3.8.2":
  version "3.8.2"
  resolved "https://registry.yarnpkg.com/@docsearch/react/-/react-3.8.2.tgz#7b11d39b61c976c0aa9fbde66e6b73b30f3acd42"
  integrity sha512-xCRrJQlTt8N9GU0DG4ptwHRkfnSnD/YpdeaXe02iKfqs97TkZJv60yE+1eq/tjPcVnTW8dP5qLP7itifFVV5eg==
  dependencies:
    "@algolia/autocomplete-core" "1.17.7"
    "@algolia/autocomplete-preset-algolia" "1.17.7"
    "@docsearch/css" "3.8.2"
    algoliasearch "^5.14.2"

"@esbuild/aix-ppc64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz#c7184a326533fcdf1b8ee0733e21c713b975575f"
  integrity sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==

"@esbuild/aix-ppc64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/aix-ppc64/-/aix-ppc64-0.25.12.tgz#80fcbe36130e58b7670511e888b8e88a259ed76c"
  integrity sha512-Hhmwd6CInZ3dwpuGTF8fJG6yoWmsToE+vYgD4nytZVxcu1ulHpUQRAB1UJ8+N1Am3Mz4+xOByoQoSZf4D+CpkA==

"@esbuild/aix-ppc64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/aix-ppc64/-/aix-ppc64-0.27.2.tgz#521cbd968dcf362094034947f76fa1b18d2d403c"
  integrity sha512-GZMB+a0mOMZs4MpDbj8RJp4cw+w1WV5NYD6xzgvzUJ5Ek2jerwfO2eADyI6ExDSUED+1X8aMbegahsJi+8mgpw==

"@esbuild/android-arm64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz#09d9b4357780da9ea3a7dfb833a1f1ff439b4052"
  integrity sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==

"@esbuild/android-arm64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/android-arm64/-/android-arm64-0.25.12.tgz#8aa4965f8d0a7982dc21734bf6601323a66da752"
  integrity sha512-6AAmLG7zwD1Z159jCKPvAxZd4y/VTO0VkprYy+3N2FtJ8+BQWFXU+OxARIwA46c5tdD9SsKGZ/1ocqBS/gAKHg==

"@esbuild/android-arm64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/android-arm64/-/android-arm64-0.27.2.tgz#61ea550962d8aa12a9b33194394e007657a6df57"
  integrity sha512-pvz8ZZ7ot/RBphf8fv60ljmaoydPU12VuXHImtAs0XhLLw+EXBi2BLe3OYSBslR4rryHvweW5gmkKFwTiFy6KA==

"@esbuild/android-arm@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/android-arm/-/android-arm-0.21.5.tgz#9b04384fb771926dfa6d7ad04324ecb2ab9b2e28"
  integrity sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==

"@esbuild/android-arm@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/android-arm/-/android-arm-0.25.12.tgz#300712101f7f50f1d2627a162e6e09b109b6767a"
  integrity sha512-VJ+sKvNA/GE7Ccacc9Cha7bpS8nyzVv0jdVgwNDaR4gDMC/2TTRc33Ip8qrNYUcpkOHUT5OZ0bUcNNVZQ9RLlg==

"@esbuild/android-arm@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/android-arm/-/android-arm-0.27.2.tgz#554887821e009dd6d853f972fde6c5143f1de142"
  integrity sha512-DVNI8jlPa7Ujbr1yjU2PfUSRtAUZPG9I1RwW4F4xFB1Imiu2on0ADiI/c3td+KmDtVKNbi+nffGDQMfcIMkwIA==

"@esbuild/android-x64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/android-x64/-/android-x64-0.21.5.tgz#29918ec2db754cedcb6c1b04de8cd6547af6461e"
  integrity sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==

"@esbuild/android-x64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/android-x64/-/android-x64-0.25.12.tgz#87dfb27161202bdc958ef48bb61b09c758faee16"
  integrity sha512-5jbb+2hhDHx5phYR2By8GTWEzn6I9UqR11Kwf22iKbNpYrsmRB18aX/9ivc5cabcUiAT/wM+YIZ6SG9QO6a8kg==

"@esbuild/android-x64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/android-x64/-/android-x64-0.27.2.tgz#a7ce9d0721825fc578f9292a76d9e53334480ba2"
  integrity sha512-z8Ank4Byh4TJJOh4wpz8g2vDy75zFL0TlZlkUkEwYXuPSgX8yzep596n6mT7905kA9uHZsf/o2OJZubl2l3M7A==

"@esbuild/darwin-arm64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz#e495b539660e51690f3928af50a76fb0a6ccff2a"
  integrity sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==

"@esbuild/darwin-arm64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/darwin-arm64/-/darwin-arm64-0.25.12.tgz#79197898ec1ff745d21c071e1c7cc3c802f0c1fd"
  integrity sha512-N3zl+lxHCifgIlcMUP5016ESkeQjLj/959RxxNYIthIg+CQHInujFuXeWbWMgnTo4cp5XVHqFPmpyu9J65C1Yg==

"@esbuild/darwin-arm64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/darwin-arm64/-/darwin-arm64-0.27.2.tgz#2cb7659bd5d109803c593cfc414450d5430c8256"
  integrity sha512-davCD2Zc80nzDVRwXTcQP/28fiJbcOwvdolL0sOiOsbwBa72kegmVU0Wrh1MYrbuCL98Omp5dVhQFWRKR2ZAlg==

"@esbuild/darwin-x64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz#c13838fa57372839abdddc91d71542ceea2e1e22"
  integrity sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==

"@esbuild/darwin-x64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/darwin-x64/-/darwin-x64-0.25.12.tgz#146400a8562133f45c4d2eadcf37ddd09718079e"
  integrity sha512-HQ9ka4Kx21qHXwtlTUVbKJOAnmG1ipXhdWTmNXiPzPfWKpXqASVcWdnf2bnL73wgjNrFXAa3yYvBSd9pzfEIpA==

"@esbuild/darwin-x64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/darwin-x64/-/darwin-x64-0.27.2.tgz#e741fa6b1abb0cd0364126ba34ca17fd5e7bf509"
  integrity sha512-ZxtijOmlQCBWGwbVmwOF/UCzuGIbUkqB1faQRf5akQmxRJ1ujusWsb3CVfk/9iZKr2L5SMU5wPBi1UWbvL+VQA==

"@esbuild/freebsd-arm64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz#646b989aa20bf89fd071dd5dbfad69a3542e550e"
  integrity sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==

"@esbuild/freebsd-arm64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/freebsd-arm64/-/freebsd-arm64-0.25.12.tgz#1c5f9ba7206e158fd2b24c59fa2d2c8bb47ca0fe"
  integrity sha512-gA0Bx759+7Jve03K1S0vkOu5Lg/85dou3EseOGUes8flVOGxbhDDh/iZaoek11Y8mtyKPGF3vP8XhnkDEAmzeg==

"@esbuild/freebsd-arm64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/freebsd-arm64/-/freebsd-arm64-0.27.2.tgz#2b64e7116865ca172d4ce034114c21f3c93e397c"
  integrity sha512-lS/9CN+rgqQ9czogxlMcBMGd+l8Q3Nj1MFQwBZJyoEKI50XGxwuzznYdwcav6lpOGv5BqaZXqvBSiB/kJ5op+g==

"@esbuild/freebsd-x64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz#aa615cfc80af954d3458906e38ca22c18cf5c261"
  integrity sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==

"@esbuild/freebsd-x64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/freebsd-x64/-/freebsd-x64-0.25.12.tgz#ea631f4a36beaac4b9279fa0fcc6ca29eaeeb2b3"
  integrity sha512-TGbO26Yw2xsHzxtbVFGEXBFH0FRAP7gtcPE7P5yP7wGy7cXK2oO7RyOhL5NLiqTlBh47XhmIUXuGciXEqYFfBQ==

"@esbuild/freebsd-x64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/freebsd-x64/-/freebsd-x64-0.27.2.tgz#e5252551e66f499e4934efb611812f3820e990bb"
  integrity sha512-tAfqtNYb4YgPnJlEFu4c212HYjQWSO/w/h/lQaBK7RbwGIkBOuNKQI9tqWzx7Wtp7bTPaGC6MJvWI608P3wXYA==

"@esbuild/linux-arm64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz#70ac6fa14f5cb7e1f7f887bcffb680ad09922b5b"
  integrity sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==

"@esbuild/linux-arm64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-arm64/-/linux-arm64-0.25.12.tgz#e1066bce58394f1b1141deec8557a5f0a22f5977"
  integrity sha512-8bwX7a8FghIgrupcxb4aUmYDLp8pX06rGh5HqDT7bB+8Rdells6mHvrFHHW2JAOPZUbnjUpKTLg6ECyzvas2AQ==

"@esbuild/linux-arm64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-arm64/-/linux-arm64-0.27.2.tgz#dc4acf235531cd6984f5d6c3b13dbfb7ddb303cb"
  integrity sha512-hYxN8pr66NsCCiRFkHUAsxylNOcAQaxSSkHMMjcpx0si13t1LHFphxJZUiGwojB1a/Hd5OiPIqDdXONia6bhTw==

"@esbuild/linux-arm@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz#fc6fd11a8aca56c1f6f3894f2bea0479f8f626b9"
  integrity sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==

"@esbuild/linux-arm@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-arm/-/linux-arm-0.25.12.tgz#452cd66b20932d08bdc53a8b61c0e30baf4348b9"
  integrity sha512-lPDGyC1JPDou8kGcywY0YILzWlhhnRjdof3UlcoqYmS9El818LLfJJc3PXXgZHrHCAKs/Z2SeZtDJr5MrkxtOw==

"@esbuild/linux-arm@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-arm/-/linux-arm-0.27.2.tgz#56a900e39240d7d5d1d273bc053daa295c92e322"
  integrity sha512-vWfq4GaIMP9AIe4yj1ZUW18RDhx6EPQKjwe7n8BbIecFtCQG4CfHGaHuh7fdfq+y3LIA2vGS/o9ZBGVxIDi9hw==

"@esbuild/linux-ia32@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz#3271f53b3f93e3d093d518d1649d6d68d346ede2"
  integrity sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==

"@esbuild/linux-ia32@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-ia32/-/linux-ia32-0.25.12.tgz#b24f8acc45bcf54192c7f2f3be1b53e6551eafe0"
  integrity sha512-0y9KrdVnbMM2/vG8KfU0byhUN+EFCny9+8g202gYqSSVMonbsCfLjUO+rCci7pM0WBEtz+oK/PIwHkzxkyharA==

"@esbuild/linux-ia32@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-ia32/-/linux-ia32-0.27.2.tgz#d4a36d473360f6870efcd19d52bbfff59a2ed1cc"
  integrity sha512-MJt5BRRSScPDwG2hLelYhAAKh9imjHK5+NE/tvnRLbIqUWa+0E9N4WNMjmp/kXXPHZGqPLxggwVhz7QP8CTR8w==

"@esbuild/linux-loong64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz#ed62e04238c57026aea831c5a130b73c0f9f26df"
  integrity sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==

"@esbuild/linux-loong64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-loong64/-/linux-loong64-0.25.12.tgz#f9cfffa7fc8322571fbc4c8b3268caf15bd81ad0"
  integrity sha512-h///Lr5a9rib/v1GGqXVGzjL4TMvVTv+s1DPoxQdz7l/AYv6LDSxdIwzxkrPW438oUXiDtwM10o9PmwS/6Z0Ng==

"@esbuild/linux-loong64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-loong64/-/linux-loong64-0.27.2.tgz#fcf0ab8c3eaaf45891d0195d4961cb18b579716a"
  integrity sha512-lugyF1atnAT463aO6KPshVCJK5NgRnU4yb3FUumyVz+cGvZbontBgzeGFO1nF+dPueHD367a2ZXe1NtUkAjOtg==

"@esbuild/linux-mips64el@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz#e79b8eb48bf3b106fadec1ac8240fb97b4e64cbe"
  integrity sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==

"@esbuild/linux-mips64el@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-mips64el/-/linux-mips64el-0.25.12.tgz#575a14bd74644ffab891adc7d7e60d275296f2cd"
  integrity sha512-iyRrM1Pzy9GFMDLsXn1iHUm18nhKnNMWscjmp4+hpafcZjrr2WbT//d20xaGljXDBYHqRcl8HnxbX6uaA/eGVw==

"@esbuild/linux-mips64el@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-mips64el/-/linux-mips64el-0.27.2.tgz#598b67d34048bb7ee1901cb12e2a0a434c381c10"
  integrity sha512-nlP2I6ArEBewvJ2gjrrkESEZkB5mIoaTswuqNFRv/WYd+ATtUpe9Y09RnJvgvdag7he0OWgEZWhviS1OTOKixw==

"@esbuild/linux-ppc64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz#5f2203860a143b9919d383ef7573521fb154c3e4"
  integrity sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==

"@esbuild/linux-ppc64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-ppc64/-/linux-ppc64-0.25.12.tgz#75b99c70a95fbd5f7739d7692befe60601591869"
  integrity sha512-9meM/lRXxMi5PSUqEXRCtVjEZBGwB7P/D4yT8UG/mwIdze2aV4Vo6U5gD3+RsoHXKkHCfSxZKzmDssVlRj1QQA==

"@esbuild/linux-ppc64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-ppc64/-/linux-ppc64-0.27.2.tgz#3846c5df6b2016dab9bc95dde26c40f11e43b4c0"
  integrity sha512-C92gnpey7tUQONqg1n6dKVbx3vphKtTHJaNG2Ok9lGwbZil6DrfyecMsp9CrmXGQJmZ7iiVXvvZH6Ml5hL6XdQ==

"@esbuild/linux-riscv64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz#07bcafd99322d5af62f618cb9e6a9b7f4bb825dc"
  integrity sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==

"@esbuild/linux-riscv64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-riscv64/-/linux-riscv64-0.25.12.tgz#2e3259440321a44e79ddf7535c325057da875cd6"
  integrity sha512-Zr7KR4hgKUpWAwb1f3o5ygT04MzqVrGEGXGLnj15YQDJErYu/BGg+wmFlIDOdJp0PmB0lLvxFIOXZgFRrdjR0w==

"@esbuild/linux-riscv64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-riscv64/-/linux-riscv64-0.27.2.tgz#173d4475b37c8d2c3e1707e068c174bb3f53d07d"
  integrity sha512-B5BOmojNtUyN8AXlK0QJyvjEZkWwy/FKvakkTDCziX95AowLZKR6aCDhG7LeF7uMCXEJqwa8Bejz5LTPYm8AvA==

"@esbuild/linux-s390x@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz#b7ccf686751d6a3e44b8627ababc8be3ef62d8de"
  integrity sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==

"@esbuild/linux-s390x@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-s390x/-/linux-s390x-0.25.12.tgz#17676cabbfe5928da5b2a0d6df5d58cd08db2663"
  integrity sha512-MsKncOcgTNvdtiISc/jZs/Zf8d0cl/t3gYWX8J9ubBnVOwlk65UIEEvgBORTiljloIWnBzLs4qhzPkJcitIzIg==

"@esbuild/linux-s390x@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-s390x/-/linux-s390x-0.27.2.tgz#f7a4790105edcab8a5a31df26fbfac1aa3dacfab"
  integrity sha512-p4bm9+wsPwup5Z8f4EpfN63qNagQ47Ua2znaqGH6bqLlmJ4bx97Y9JdqxgGZ6Y8xVTixUnEkoKSHcpRlDnNr5w==

"@esbuild/linux-x64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz#6d8f0c768e070e64309af8004bb94e68ab2bb3b0"
  integrity sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==

"@esbuild/linux-x64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-x64/-/linux-x64-0.25.12.tgz#0583775685ca82066d04c3507f09524d3cd7a306"
  integrity sha512-uqZMTLr/zR/ed4jIGnwSLkaHmPjOjJvnm6TVVitAa08SLS9Z0VM8wIRx7gWbJB5/J54YuIMInDquWyYvQLZkgw==

"@esbuild/linux-x64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/linux-x64/-/linux-x64-0.27.2.tgz#2ecc1284b1904aeb41e54c9ddc7fcd349b18f650"
  integrity sha512-uwp2Tip5aPmH+NRUwTcfLb+W32WXjpFejTIOWZFw/v7/KnpCDKG66u4DLcurQpiYTiYwQ9B7KOeMJvLCu/OvbA==

"@esbuild/netbsd-arm64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/netbsd-arm64/-/netbsd-arm64-0.25.12.tgz#f04c4049cb2e252fe96b16fed90f70746b13f4a4"
  integrity sha512-xXwcTq4GhRM7J9A8Gv5boanHhRa/Q9KLVmcyXHCTaM4wKfIpWkdXiMog/KsnxzJ0A1+nD+zoecuzqPmCRyBGjg==

"@esbuild/netbsd-arm64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/netbsd-arm64/-/netbsd-arm64-0.27.2.tgz#e2863c2cd1501845995cb11adf26f7fe4be527b0"
  integrity sha512-Kj6DiBlwXrPsCRDeRvGAUb/LNrBASrfqAIok+xB0LxK8CHqxZ037viF13ugfsIpePH93mX7xfJp97cyDuTZ3cw==

"@esbuild/netbsd-x64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz#bbe430f60d378ecb88decb219c602667387a6047"
  integrity sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==

"@esbuild/netbsd-x64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/netbsd-x64/-/netbsd-x64-0.25.12.tgz#77da0d0a0d826d7c921eea3d40292548b258a076"
  integrity sha512-Ld5pTlzPy3YwGec4OuHh1aCVCRvOXdH8DgRjfDy/oumVovmuSzWfnSJg+VtakB9Cm0gxNO9BzWkj6mtO1FMXkQ==

"@esbuild/netbsd-x64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/netbsd-x64/-/netbsd-x64-0.27.2.tgz#93f7609e2885d1c0b5a1417885fba8d1fcc41272"
  integrity sha512-HwGDZ0VLVBY3Y+Nw0JexZy9o/nUAWq9MlV7cahpaXKW6TOzfVno3y3/M8Ga8u8Yr7GldLOov27xiCnqRZf0tCA==

"@esbuild/openbsd-arm64@0.25.12":
  version "0.25.12"
  resolved "https://registry.yarnpkg.com/@esbuild/openbsd-arm64/-/openbsd-arm64-0.25.12.tgz#6296f5867aedef28a81b22ab2009c786a952dccd"
  integrity sha512-fF96T6KsBo/pkQI950FARU9apGNTSlZGsv1jZBAlcLL1MLjLNIWPBkj5NlSz8aAzYKg+eNqknrUJ24QBybeR5A==

"@esbuild/openbsd-arm64@0.27.2":
  version "0.27.2"
  resolved "https://registry.yarnpkg.com/@esbuild/openbsd-arm64/-/openbsd-arm64-0.27.2.tgz#a1985604a203cdc325fd47542e106fafd698f02e"
  integrity sha512-DNIHH2BPQ5551A7oSHD0CKbwIA/Ox7+78/AWkbS5QoRzaqlev2uFayfSxq68EkonB+IKjiuxBFoV8ESJy8bOHA==

"@esbuild/openbsd-x64@0.21.5":
  version "0.21.5"
  resolved "https://registry.yarnpkg.com/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz#99d1cf2937279560d2104821f5ccce220cb2af70"
  integrity sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==

```

### /Users/sand/GitHub/mono/di/notes/designs/Details.md
```md
# Details

Left sidebar for properties and actions.

## Location

`src/lib/svelte/layout/Details.svelte`

## Purpose

Displays contextual information about selected objects. Will eventually show properties, actions, tags, traits, etc.

## Props

None (placeholder).

## State

None (placeholder).

## Styling

- Background: `colors.w_background_color`
- Text: `colors.w_text_color`
- Padding: `1rem`
- Width: fills parent (280px from Main)

## CSS Classes

| Class | Purpose |
|-------|---------|
| `.details` | Container, padding, fills parent |
| `.details h2` | Section header |
| `.details p` | Placeholder text, reduced opacity |

## Future

Will contain:
- Header with selected item info
- Actions section
- Selection details
- Tags
- Traits
- Preferences
- Data view

Structure from webseriously:
- `D_Header`
- `D_Actions`
- `D_Selection`
- `D_Tags`
- `D_Traits`
- `D_Preferences`
- `D_Data`
```

### /Users/sand/GitHub/mono/di/notes/designs/Main.md
```md
# Main

Root layout component. Manages viewport dimensions and orchestrates child regions.

## Location

`src/lib/svelte/layout/Main.svelte`

## Purpose

Full-viewport Box container that positions Controls, Details, and Graph regions with Separator components between them. Responds to window resize.

## Layout

```
╭─────────────────────────────────────────────────────╮
│                     Controls                        │
│                     (48px)                          │
├═════════════════════════════════════════════════════┤
│            Horizontal Separator (8px)               │
├───────────────╦═════════════════════════════════════┤
│               ║                                     │
│    Details    ║              Graph                  │
│   (280px)     ║            (flex: 1)                │
│               ║                                     │
│               ║  Vertical Separator (8px)           │
│               ║                                     │
╰───────────────╩═════════════════════════════════════╯
                Box (full viewport, 8px border)
```

## Props

None.

## State

| Name | Type | Default | Description |
|------|------|---------|-------------|
| `width` | `number` | `window.innerWidth` | Viewport width |
| `height` | `number` | `window.innerHeight` | Viewport height |
| `showDetails` | `boolean` | `true` | Toggle details visibility |

## Constants

| Name | Value | Description |
|------|-------|-------------|
| `separatorThickness` | `8` | Thickness of separator bars |
| `boxThickness` | `8` | Thickness of outer Box border |

## Derived

| Name | Type | Description |
|------|------|-------------|
| `controlsHeight` | `number` | Fixed at 48px |
| `detailsWidth` | `number` | Fixed at 280px |
| `innerWidth` | `number` | `width - boxThickness * 2` |
| `innerHeight` | `number` | `height - boxThickness * 2` |
| `mainHeight` | `number` | `innerHeight - controlsHeight - separatorThickness` |
| `graphWidth` | `number` | Remaining width after details + separator |

## CSS Classes

| Class | Purpose |
|-------|---------|
| `.panel` | Root container, fixed position |
| `.main` | Flex row for details + separator + graph |
| `.region` | Shared base for all content areas |
| `.controls` | Top bar region |
| `.graph` | Main content region, flex: 1 |
| `.details` | Left sidebar region, flex-shrink: 0 |

## Children

- `Box` — outer border with gull wings on all sides
  - `Controls` — top bar
  - `Separator` (horizontal) — below controls, with gull wings
  - `Details` — left sidebar (conditional on showDetails)
  - `Separator` (vertical) — between details and graph (conditional)
  - `Graph` — main canvas area

## Events

- `svelte:window onresize` — updates width/height state
```

### /Users/sand/GitHub/mono/di/notes/designs/index.md
```md
# Designs

Design documentation for components and managers.
## Layout Components
| Component | Description |
|-----------|-------------|
| [Main](Main.md) | Root layout, viewport management |
| [Controls](Controls.md) | Top bar with title |
| [Graph](Graph.md) | Canvas for 3D visualization |
| [Details](Details.md) | Left sidebar for properties |
## Managers
| Component | Description |
|-----------|-------------|
| [Preferences](Preferences.md) | localStorage persistence |
## Missing Designs
These files exist but lack design docs:
| File | Location |
|------|----------|
| Hits | `managers/Hits.ts` |
| Components | `managers/Components.ts` |
| Events | `signals/Events.ts` |
| Mouse_Timer | `signals/Mouse_Timer.ts` |
| S_Hit_Target | `state/S_Hit_Target.ts` |
| S_Component | `state/S_Component.ts` |

## Contents

- [Controls](./Controls.md)
- [Details](./Details.md)
- [Graph](./Graph.md)
- [Main](./Main.md)
- [Preferences](./Preferences.md)

```

### /Users/sand/GitHub/mono/di/notes/designs/Controls.md
```md
# Controls

Top bar component with title.

## Location

`src/lib/svelte/layout/Controls.svelte`

## Purpose

Displays application title. Will eventually hold primary controls (search, settings, etc.).

## Props

| Name | Type | Default | Description |
|------|------|---------|-------------|
| `title` | `string` | `'Design Intuition'` | Title text |

## State

None.

## Styling

- Background: `colors.w_background_color`
- Text: `colors.w_text_color`
- Height: fills parent (48px from Main)
- Padding: `0 1rem`

## CSS Classes

| Class | Purpose |
|-------|---------|
| `.controls` | Container, flex, centered vertically |
| `.controls h1` | Title, 1.25rem, weight 300 |

## Future

- Search input
- Settings button
- View toggles
```

### /Users/sand/GitHub/mono/di/notes/designs/Preferences.md
```md
# Preferences

Persistent storage for user preferences using localStorage.

## Location

`src/lib/ts/managers/Preferences.ts`

## Purpose

Reads and writes user preferences to localStorage. Provides a simple key-value interface for persisting UI state across sessions.

## API

### Read/Write

```typescript
preferences.read(key: T_Preference): T | null
preferences.write(key: T_Preference, value: T): void
preferences.remove(key: T_Preference): void
preferences.clear(): void
```

### Restore

```typescript
preferences.restore(): void  // Load all preferences at startup
```

## Preference Keys

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `showDetails` | `boolean` | `true` | Details panel visibility |
| `detailsWidth` | `number` | `280` | Details panel width |
| `backgroundColor` | `string` | `'coral'` | Background color |
| `textColor` | `string` | `'black'` | Text color |
| `separatorColor` | `string` | `'#eeeee0'` | Separator color |

## Storage Format

All values JSON-stringified in localStorage under `di:` prefix:
- `di:showDetails` → `"true"`
- `di:backgroundColor` → `"\"coral\""`

## Integration

Colors store subscribes to preference changes:
```typescript
// In Colors.ts
preferences.restore();
this.w_background_color.subscribe(color => {
    preferences.write(T_Preference.backgroundColor, color);
});
```

## Simplifications from webseriously

- Removed: Database-scoped keys (`readDB_key`, `writeDB_key`)
- Removed: Key pairs for sub-keys
- Removed: Ancestry persistence (no graph data yet)
- Removed: Query string parsing
- Added: `di:` prefix for namespace isolation
- Added: Type-safe enum keys
```

### /Users/sand/GitHub/mono/di/notes/designs/Graph.md
```md
# Graph

Main canvas area for 3D visualization.

## Location

`src/lib/svelte/layout/Graph.svelte`

## Purpose

Hosts the WebGL/2D canvas for rendering quaternion rotation visualization. Handles resize events to keep canvas buffer in sync with container size.

## Props

None.

## State

| Name | Type | Description |
|------|------|-------------|
| `canvas` | `HTMLCanvasElement` | Canvas element reference |
| `container` | `HTMLDivElement` | Container div reference |
| `initialized` | `boolean` | Tracks first init |

## Lifecycle

1. `onMount` — creates ResizeObserver on container
2. First resize — calls `init(canvas)` from Render.test.ts
3. Subsequent resizes — calls `render.resize(width, height)`
4. Cleanup — disconnects observer

## Styling

- Background: `colors.w_background_color`
- Canvas inherits background
- Cursor: `grab` / `grabbing` on drag

## CSS Classes

| Class | Purpose |
|-------|---------|
| `.graph` | Container, 100% width/height |
| `.graph canvas` | Canvas, fills container, block display |

## Dependencies

- `render` singleton — handles rendering
- `init()` from Render.test.ts — initializes scene
- `colors` — theming

## Resize Strategy

Uses `ResizeObserver` (not window resize) to track container size. This allows the canvas to respond to layout changes, not just window changes.
```

### /Users/sand/GitHub/mono/di/notes/architecture/managers.md
```md
# Managers

Each manager owns one concern. Singleton pattern throughout.

## Overview

| Class | Export | Location | What it does |
|-------|--------|----------|--------------|
| `Scene` | `scene` | `render/` | O_Scene CRUD, hierarchy |
| `Camera` | `camera` | `render/` | View/projection matrices |
| `Render` | `render` | `render/` | Projection pipeline, draw calls |
| `Input` | `input` | `render/` | Mouse events → rotation |
| `Animation` | `animation` | `render/` | rAF loop, tick callbacks |
| `Hits` | `hits` | `managers/` | RBush spatial index, click routing |
| `Components` | `components` | `managers/` | Component registry |
| `Preferences` | `preferences` | `managers/` | localStorage wrapper |

## File Layout

```
src/lib/ts/
├── managers/
│   ├── Components.ts
│   ├── Hits.ts
│   └── Preferences.ts
└── render/
    ├── index.ts
    ├── Animation.ts
    ├── Camera.ts
    ├── Input.ts
    ├── Render.ts
    ├── Scene.ts
    └── Trivial.ts
```

## Dependencies

```
animation.on_tick()
    ↓
input → scene (rotate object)
    ↓
render ← camera (matrices)
    ↓
scene.get_all() → render

hits ← components (spatial index)
    ↓
Events.ts → hits.handle_mouse()
```

## Scene

Factory + registry for `O_Scene` instances.

```ts
scene.create({ vertices, edges, color, scale?, parent? }) → O_Scene
scene.get(id) → O_Scene | undefined
scene.get_all() → O_Scene[]
scene.destroy(id)
scene.clear()
```

## Camera

View and projection matrices.

```ts
camera.init(size: Size)
camera.set_position(eye, center?)
camera.set_fov(fov)
camera.view       // mat4
camera.projection // mat4
```

## Render

The projection pipeline and drawing.

```ts
render.init(canvas)
render.render()
render.resize(width, height)
```

## Input

Mouse drag → quaternion rotations.

```ts
input.init(canvas)
input.set_drag_handler((delta: Point) => void)
input.rotate_object(obj, delta, sensitivity?)
```

## Animation

Frame loop with delta time.

```ts
animation.start()
animation.stop()
animation.on_tick((dt) => void)
```

## Hits

RBush-based spatial indexing for click/hover detection.

```ts
hits.register(target: S_Hit_Target)
hits.unregister(id: string)
hits.handle_mouse(s_mouse: S_Mouse)
hits.target_at(point: Point) → S_Hit_Target | null
```

## Components

Registry for UI components that participate in hit detection.

```ts
components.register(component: S_Component)
components.unregister(id: string)
components.get(id: string) → S_Component | null
```

## Preferences

localStorage persistence with `di:` prefix.

```ts
preferences.read(key: T_Preference) → T | null
preferences.write(key: T_Preference, value: T)
preferences.remove(key: T_Preference)
preferences.restore()
```
```

### /Users/sand/GitHub/mono/di/notes/architecture/project.md
```md
# Project Architecture

How does the app actually run? Here's the flow.

## Entry Flow

```
index.html
    └── src/main.ts
            └── App.svelte
                    └── init(canvas)  ← from src/lib/ts/test.ts
```

**index.html** loads the module.

**main.ts** mounts the Svelte app.

**App.svelte** renders the canvas and UI, calls `init(canvas)` on mount.

**Render.test.ts** wires everything together:


1. Initializes managers with the canvas
2. Creates scene objects
3. Sets initial rotations
4. Hooks up input → outer cube rotation
5. Hooks up animation tick → inner cube spin + render
6. Starts the loop

## Types

See [rendering.types.md](rendering.types.md).

## Scene Graph

i wanted nested rotations without gimbal lock. Each `O_Scene` can have a `parent`—child transforms are relative to parent's world matrix.

```
outer_cube (teal)
  └── inner_cube (red, scale 0.4, auto-rotates)
```

Drag the outer cube, inner cube follows. Inner cube spins independently inside.

## File Layout

See [files.md](files.md).

## Pipeline

The render pipeline, step by step:


1. `render.get_world_matrix(obj)` — builds local matrix from quat + position + scale, multiplies by parent's world matrix
2. `render.project_vertex(v, world_matrix)` — transforms through MVP, perspective divide, maps to screen
3. `render.render_object(obj)` — projects vertices, draws edges with depth-based alpha
4. `render.render()` — clears canvas, iterates `scene.get_all()`

## Matrices

| Matrix | Location | What it does |
|----|----|----|
| `view` | `camera` | Camera transform via `mat4.lookAt` |
| `projection` | `camera` | Perspective via `mat4.perspective` |
| `mvp_matrix` | `render` | Combined MVP, reused per batch |


```

### /Users/sand/GitHub/mono/di/notes/architecture/index.md
```md
# Architecture

System structure and core concepts for Design Intuition.

## Contents

- [Files](./files.md)
- [Managers](./managers.md)
- [Project](./project.md)
- [Rendering.types](./rendering.types.md)

```

### /Users/sand/GitHub/mono/di/notes/architecture/files.md
```md
# File Layout

Where everything lives.

```
src/
├── main.ts                  # Mounts Svelte app
├── App.svelte               # Root component
├── vite-env.d.ts            # Type declarations
└── lib/
    ├── svelte/
    │   ├── draw/
    │   │   └── Printable.svelte
    │   └── main/
    │       ├── Controls.svelte
    │       ├── Details.svelte
    │       ├── Graph.svelte
    │       └── Main.svelte
    └── ts/
        ├── common/
        │   ├── Constants.ts
        │   ├── Extensions.ts
        │   └── Testworthy_Utilities.ts
        ├── draw/
        │   ├── Colors.ts
        │   └── SVG_Paths.ts
        ├── managers/
        │   ├── Components.ts
        │   ├── Hits.ts
        │   └── Preferences.ts
        ├── render/
        │   ├── index.ts
        │   ├── Animation.ts
        │   ├── Camera.ts
        │   ├── Input.ts
        │   ├── Render.ts
        │   ├── Scene.ts
        │   └── Trivial.ts
        ├── runtime/
        │   └── Identifiable.ts
        ├── signals/
        │   ├── Events.ts
        │   └── Mouse_Timer.ts
        ├── state/
        │   ├── S_Component.ts
        │   ├── S_Hit_Target.ts
        │   └── S_Mouse.ts
        ├── tests/
        │   ├── Angle.test.ts
        │   ├── Colors.test.ts
        │   ├── Coordinates.test.ts
        │   ├── Extensions.test.ts
        │   ├── Testworthy_Utilities.test.ts
        │   └── setup.ts
        └── types/
            ├── index.ts
            ├── Angle.ts
            ├── Coordinates.ts
            ├── Enumerations.ts
            ├── Interfaces.ts
            └── Types.ts
```

## Entry

| File | What it does |
|------|--------------|
| `main.ts` | Mounts `App.svelte` |
| `App.svelte` | Renders Main, initializes app |

## Svelte Components

| File | What it does |
|------|--------------|
| `main/Main.svelte` | Root layout, viewport management |
| `main/Controls.svelte` | Top toolbar region |
| `main/Details.svelte` | Left sidebar region |
| `main/Graph.svelte` | Canvas region with 3D rendering |
| `draw/Printable.svelte` | Print-friendly output |

## Common

| File | What it does |
|------|--------------|
| `Constants.ts` | App-wide constants (`k` singleton) |
| `Extensions.ts` | Number/String prototype extensions |
| `Testworthy_Utilities.ts` | General utilities (`tu` singleton) |

## Draw

| File | Export | What it does |
|------|--------|--------------|
| `Colors.ts` | `colors` | Color utilities, reactive stores |
| `SVG_Paths.ts` | `svg_paths` | SVG path string generators |

## Managers

| File | Export | What it does |
|------|--------|--------------|
| `Preferences.ts` | `preferences` | localStorage wrapper |
| `Hits.ts` | `hits` | RBush spatial index, click routing |
| `Components.ts` | `components` | Component registry |

## Render

| File | Export | What it does |
|------|--------|--------------|
| `Scene.ts` | `scene` | O_Scene CRUD, hierarchy |
| `Camera.ts` | `camera` | View/projection matrices |
| `Render.ts` | `render` | Projection pipeline, draw calls |
| `Input.ts` | `input` | Mouse events → rotation |
| `Animation.ts` | `animation` | rAF loop, tick callbacks |
| `Trivial.ts` | `trivial` | Simple rendering utilities |

## Signals

| File | Export | What it does |
|------|--------|--------------|
| `Events.ts` | `e` | Unified mouse event handlers |
| `Mouse_Timer.ts` | `Mouse_Timer` | Long-click, double-click timing |

## State

| File | What it does |
|------|--------------|
| `S_Mouse.ts` | Mouse event state encapsulation |
| `S_Hit_Target.ts` | Hit target state for spatial indexing |
| `S_Component.ts` | Component state for hit detection |

## Runtime

| File | What it does |
|------|--------------|
| `Identifiable.ts` | Base class with `id` and `hid` |

## Types

| File | What it does |
|------|--------------|
| `Angle.ts` | `Angle` class, quadrant/orientation enums |
| `Coordinates.ts` | `Point`, `Size`, `Rect`, `Point3`, etc. |
| `Enumerations.ts` | App-wide enums |
| `Interfaces.ts` | `Projected`, `O_Scene` interfaces |
| `Types.ts` | Type aliases, callbacks |
```

### /Users/sand/GitHub/mono/di/notes/architecture/rendering.types.md
```md
# Types

Located in `src/lib/ts/types/Interfaces.ts`. Two interfaces, both simple.

## Projected

What you get after the projection pipeline spits out a vertex.

```ts
interface Projected {
  x: number;  // screen X
  y: number;  // screen Y
  z: number;  // depth (NDC)
  w: number;  // clip space W (for culling)
}
```

Not a quaternion—same letters, different meaning. The `w` here is the divisor from perspective divide. We keep it to check if vertices are behind the camera (`w < 0` → don't draw).

Intentionally not using `Point` for `x, y`. It's a pipeline-specific structure, not general geometry.

## O_Scene

A thing in the scene graph that can be rendered.

```ts
interface O_Scene {
  id: string;
  vertices: Point3[];
  edges: [number, number][];
  orientation: quat;
  position: vec3;
  scale: number;
  color: string;
  parent?: O_Scene;
}
```

| Field | What it's for |
|-------|---------------|
| `id` | Unique identifier, auto-generated |
| `vertices` | 3D points defining geometry (`Point3[]`) |
| `edges` | Pairs of vertex indices to connect |
| `orientation` | Rotation as quaternion (gl-matrix `quat`) |
| `position` | Translation in world/parent space (gl-matrix `vec3`) |
| `scale` | Uniform scale factor |
| `color` | CSS color prefix, e.g. `'rgba(78, 205, 196,'` |
| `parent` | Optional parent for hierarchical transforms |

Note: `position` stays as `vec3` because it's passed directly to gl-matrix functions. `vertices` uses `Point3` because it's just stored/iterated—no gl-matrix interop needed.

---

## Coordinate Types

### 2D (from Coordinates.ts)

| Class | What it's for |
|-------|---------------|
| `Point` | 2D position (x, y) |
| `Size` | 2D dimensions (width, height) |
| `Rect` | 2D rectangle (origin + size) |
| `Polar` | Polar coordinates (r, phi) |

### 3D (from Coordinates.ts)

| Class | What it's for |
|-------|---------------|
| `Point3` | 3D position (x, y, z) |
| `Size3` | 3D dimensions (width, height, depth) |
| `Block` | 3D box (origin + size) |

### Usage in Managers

| Manager | Type | Field/Param |
|---------|------|-------------|
| Render | `Size` | `size` (canvas dimensions) |
| Render | `Point3` | `project_vertex(v)` |
| Camera | `Size` | `init(size)` |
| Input | `Point` | `last_position`, `T_Handle_Drag(delta)` |
| Scene | `Point3[]` | `create({ vertices })` |

`Point` and `Size` have useful methods (`offsetBy`, `vector_to`, `dividedInHalf`, etc.) that simplify coordinate math. The 3D equivalents follow the same patterns.
```

### /Users/sand/GitHub/mono/di/notes/index.md
```md
# Notes

Documentation and design notes for the Design Intuition project.

## Contents

- [Architecture](./architecture/)
- [Designs](./designs/)
- [Guides](./guides/)
- [Work](./work/)

```

### /Users/sand/GitHub/mono/di/notes/guides/develop/gotchas.md
```md
# Lessons about svelte

One day, I edited some code and later, i ran the app. Ack, i get this cryptic error.

           `if_block.p is not a function`

 I asked AI to investigate, resolve and then summarize.

# Nested `{#if}` Race Conditions

**A store in an `{#if}` clause can create race conditions inside the clause.** When reactive stores change rapidly, nested `{#if}` blocks can be in transitional states (being created/destroyed) while the parent block tries to update them, causing this error:
## Table of Contents
- [Problem: Nested Blocks](#problem-nested-blocks)
- [Solution: Flatten Nested Blocks](#solution-flatten-nested-blocks)
- [Safe Patterns](#safe-patterns)
- [Best Practices](#best-practices)
- [Reference](#reference)
- [Subscription Loops](#subscription-loops)

## Problem: Nested Blocks

Store `$A` is in the outer block, and condition `B` is in the inner block. When `$A` changes rapidly, the inner block can be in a transitional state (being created/destroyed) while the parent block tries to update it. The error really means "if_block is undefined."

**Before (problematic):**
```svelte
{#if !$A}
    {#if B && ancestry.points_right}
        <div class='numerical-count'>...</div>
    {/if}
{:else if !!svgPathFor_tiny_outer_dots}
    <svg>...</svg>
{/if}
```

## Solution: Flatten Nested Blocks

Flattening eliminates parent-child update coordination, allowing Svelte to update one block directly.

**After (fixed):**
```svelte
{#if !$A && B && ancestry.points_right}
    <div class='numerical-count'>...</div>
{:else if $A && !!svgPathFor_tiny_outer_dots}
    <svg>...</svg>
{/if}
```

## Safe Patterns

```svelte
<!-- Single level -->
{#if condition1 && condition2}
    ...
{/if}

<!-- Computed variable -->
<script>
    $: showContent = condition1 && condition2;
</script>
{#if showContent}
    ...
{/if}
```

## Best Practices

1. Flatten nested `{#if}` blocks when stores are involved
2. Use computed variables for complex conditions
3. Test mode switches and rapid state transitions

## Reference

`src/lib/svelte/widget/Widget_Reveal.svelte` (lines 166-198) - triggered when switching to radial mode

# Subscription Loops

**A store subscription that calls a function which sets the same (or related) store causes an infinite loop.**

## Table of Contents
- [Problem: Indirect Reactivity](#problem-indirect-reactivity)
- [Solution: Direct Causation](#solution-direct-causation)
- [Variations](#variations)
- [Best Practices](#best-practices)

## Problem: Indirect Reactivity

Subscription to store A calls function X. Function X sets store A (or store B, which has a subscription that sets A). → Infinite loop.

**Before (problematic):**
```typescript
// In setup():
this.w_s_search.subscribe((state) => {
    if (state !== T_Search.off) {
        this.search_for(text);  // search_for sets w_s_search!
    }
});

// In activate():
this.w_s_search.set(T_Search.enter);  // Triggers subscription → loop
```

The intent was "when search activates, run the search." But the implementation creates a cycle.

## Solution: Direct Causation

When an action needs to trigger behavior, call it directly.

**After (fixed):**
```typescript
// In activate():
show.w_show_search_controls.set(true);
this.search_for(this.search_text);  // Direct call
```

No subscription needed. `activate()` does what it needs to do.

## Variations

### Mutual Recursion

```typescript
search_for(query: string) {
    if (query.length === 0) {
        this.activate();  // activate() calls search_for()!
    }
}

activate() {
    this.search_for(this.search_text);
}
```

**Fix:** Replace `this.activate()` with the specific state change needed.

### Indirect via Related Store

```typescript
// Store A subscription
w_show_search_controls.subscribe(() => {
    g.layout();  // layout() eventually sets w_show_details
});

// Store B subscription  
w_show_details.subscribe(() => {
    // ... which eventually sets w_show_search_controls
});
```

**Fix:** Remove unnecessary subscriptions. Not every store change needs a reactive cascade.

## Best Practices

1. **Subscriptions are for reacting to external changes**, not for triggering side effects from your own actions
2. **If you set a store and want something to happen**, call it directly in the same function
3. **Audit subscription chains** — trace what each subscription calls and what stores those functions set
4. **Transient UI state** (like search visibility) often doesn't need subscriptions at all — just set it directly in activate/deactivate

```

### /Users/sand/GitHub/mono/di/notes/guides/develop/best.practices.md
```md
# Best Practices

Svelte 5 patterns and choices for the di project, based on research and implementation experience.

## Runes

| Rune | Purpose | Use When |
|------|---------|----------|
| `$state()` | Mutable reactive state | Component-local values that change |
| `$derived()` | Computed values (memoized) | Values calculated from other state |
| `$effect()` | Side effects (browser only) | DOM manipulation, subscriptions, logging |
| `$props()` | Component props | Receiving data from parent |
| `$bindable()` | Two-way binding props | Forms, input fields |

**Key rule:** Use `$derived` for computing values, `$effect` for actions. Never use `$effect` when `$derived` will do.

## Props with TypeScript

```typescript
let {
	title = 'Default',
	width,
	height = 100
}: {
	title?: string;
	width: number;
	height?: number;
} = $props();
```

## Event Handlers

Use native DOM attributes, not Svelte's old `on:` syntax:

```svelte
<!-- ✅ Svelte 5 -->
<button onclick={handleClick}>

<!-- ❌ Old syntax -->
<button on:click={handleClick}>
```

Pass callback props instead of `createEventDispatcher`.

## Snippets vs Slots

Slots are deprecated. Use snippets for content injection:

```svelte
<!-- Parent -->
<Box>
	{#snippet header()}
		<h1>Title</h1>
	{/snippet}
</Box>

<!-- Child -->
<script lang="ts">
	import type { Snippet } from 'svelte';
	let { header }: { header?: Snippet } = $props();
</script>

{@render header?.()}
```

**Our choice:** We tried snippets, then removed them. YAGNI — we weren't reusing the layout with different content. Direct children are simpler.

## Component Structure

Order within a `.svelte` file:

1. `<script lang="ts">` — imports, props, state, derived, effects, functions
2. Template markup
3. `<style>` (if needed)

## Shared State

For state across components, use `.svelte.ts` files:

```typescript
// state.svelte.ts
export const appState = $state({
	count: 0,
	user: null
});
```

**Our choice:** Not yet needed. State lives in Main.svelte for now.

## ResizeObserver over Window Events

For container-relative sizing:

```typescript
onMount(() => {
	const observer = new ResizeObserver((entries) => {
		const { width, height } = entries[0].contentRect;
		// handle resize
	});
	observer.observe(container);
	return () => observer.disconnect();
});
```

**Our choice:** Graph.svelte uses ResizeObserver to size the canvas to its container, not to window dimensions.

## YAGNI Principle

"You Aren't Gonna Need It" — don't build flexibility until you need it.

**Applied:**
- Removed snippet-based Panel in favor of direct children in Main
- No abstract "region" system — just the three regions we actually use
- No configuration props for layout dimensions yet — hardcoded until needed

## Composition Decisions

| Pattern | When to Use | When to Skip |
|---------|-------------|--------------|
| Snippets | Multiple consumers with different content | Single use, known children |
| Separate components | Reusable, testable, complex logic | Simple, single-use markup |
| Props | Configurable behavior | Fixed behavior |

**Our structure:**
```
App.svelte (global styles)
└── Main.svelte (layout + state + children)
    ├── Controls.svelte
    ├── Details.svelte
    └── Graph.svelte
```

No intermediate abstractions. Main owns the layout directly.

## Avoid

- Mutating state inside `$derived` (infinite loop)
- Using `$effect` for derived values
- `<svelte:component>` in runes mode (deprecated)
- Premature abstraction (snippets, generic layouts)
- Calling functions in template expressions that mutate state
```

### /Users/sand/GitHub/mono/di/notes/guides/develop/index.md
```md
# Develop

Development guides and best practices.

## Contents

- [Best.practices](./best.practices.md)
- [Gotchas](./gotchas.md)

```

### /Users/sand/GitHub/mono/di/notes/guides/road.map.md
```md
# Road Map

**Started:** 2026-01-05 | **Status:** Phase 1 in progress

## Problem

Project history lives in my head. No quick way to see how we got here or what the major turning points were. Future me (or anyone else) would have to dig through commits and docs to reconstruct the journey. Plus i intend this project to lean into creating at all levels of abstraction. Creativity is gold.

## Goal

A living roadmap: origin story, major milestones with context and outcomes, template pattern for other projects.



---

## Templates

After writing the first milestone, I’ve decided on a format or template for the two kinds of file:

### Milestones Index

A concise snapshot of the arc of the project at the milestone level, each is part of the whole.

```markdown
### N -- Name
**Timeline:** dates | [details](milestone.N.md)
**Goal:** One sentence—what we set out to do.
**Outcome:** One sentence—what we got.
```

### Milestone Detail File

This is intended to capture the look of [[1.solid.foundation]], so refer to it (a) when you begin a new milestone and (b) when you polish it for completion.

```markdown
# Milestone N: Name
**Timeline:** dates

## Goal
What we set out to do.

---
## Narrative
Freeform story of how it unfolded. Use subsections as needed:
- Decisions made and why
- Challenges encountered
- What emerged

---
## Artifacts
Links to relevant files, commits, or docs: [[file]], [[another]]
```



```

### /Users/sand/GitHub/mono/di/notes/guides/index.md
```md
# Guides

Development guides and best practices for Design Intuition.

## Contents

- [Develop](./develop/)
- [Road.map](./road.map.md)

```

### /Users/sand/GitHub/mono/di/notes/work/simplicity.md
```md
# Simplicity

The care we put into each file.

## Let it develop naturally

I like that we let structure emerge, like a journey without a map. Start with nice pithy articulation of raw curiosity. Travel carefully. The structure comes at the end, emphasize significant features, \<give examples\>.

Work files are just that. Things we need to know and things we did. Guides are the maps of the turf, what's been learned about it. So, the guides are condensed out of the work, things like "oh, shit, we need to this and not that."

## Concise AND complete

Every word earns its place AND, nothing essential is missing.

- Problem first, always. Pinch points, yearnings
- Research, plan, details, verify
- Then the solution, punchy
- Interesting details if they are spicy

Lose the filler, love the flavor.

## Voice is human

First person. Casual language. Emotion when it's real. "Ack, I get this cryptic error" not "An error was encountered."

Lowercase "i" signals informality. Short punchy sentences. Fragments are fine. The docs should sound like explaining it over coffee, lots of coffee, and should be damned easy to read.

## One truth, one place

Guides encode decisions, grouped into a topic, crafted to casually walk the walk. 
CLAUDE.MD is the entry point, the large scale map.

## Dual purpose

Documentation has two audiences: me, a lot later and rather forgetful, and AI the amnesiac.

Work tracking is the other side of the coin. Focus, details, decisions. Later, read the file, know exactly where we are. My brain feels better just saying this.

## Small, composable pieces

Files stay focused. It might be a class, it might be a concern.

When something grows too big, split it. And, jeez, the fewer the better. Shrink, evaporate, snip.

Plus some of the lessons learned are rather universal. They get promoted to shared.

## Friction into feature

We describe our process, too. Like, "ugh, this thing is badly broken." Pause and scratch noggin. Often enough something cool settles into play. 

So, yeah, patterns come from pain, why else remember them?```

### /Users/sand/GitHub/mono/di/notes/work/pacing.md
```md
# Pacing

This project moves differently than webseriously. Not just faster — *easier*. And that difference has taught me something about how I work best.

## Why it flows

The patterns are borrowed from ws, not reinvented. The AI collaboration has persistent context through CLAUDE.MD. Documentation happens as I go, not as afterthought. When I say "full monte," I get it — no shortcuts that create debt later.

So there's less friction. Less second-guessing. More certainty when I move.

## Dream Out Loud

Here's what surprised me: the gap between thinking something and seeing it realized has collapsed. Say it, see it. Thirty seconds from idea to artifact.

It's like a lucid dream where you reshape the world as fast as you can imagine it. Energizing. Almost addictive.

But the real gift isn't the speed — it's what the speed *creates*. Because I'm not depleted by grunt work, I have capacity for the interesting problems. Because implementation doesn't slip away while I'm wrestling with boilerplate, I can stay at the right altitude — thinking about *what* and *why*.

And paradoxically, going faster gives me *more* room, not less. Ideas can settle. They have space to grow. I'm not rushing to implement before I forget what I meant.

There's a creative tension here, held comfortably — fast enough to keep momentum, slow enough for ideas to ripen. I feel fertile. Generative rather than depleted.

It's nice.
```

### /Users/sand/GitHub/mono/di/notes/work/revisit.md
```md
# Revisit

Where we are in Design Intuition.

---
## Milestones

- [ ] [5 smart objects](milestones/5.smart.objects.md) == SO (Attributes)
- [ ] 6 mouse editing of SO (selection corners, drag)
- [ ] 7 dimensions (terminators, text, dimension and extension lines)
- [ ] 8 hierarchy of SO
- [ ] 9 **Persistence** — save/load scene state
- [ ] 10 **Controls UI** — actual buttons in the toolbar


## Current State

**Milestone 5 in progress.** Smart objects foundation:

- `Smart_Object.ts` — extends Identifiable, optional O_Scene ref
- `Attribute.ts` — name/value boilerplate
- Decision: SO is primary, O_Scene is rendering detail

The app has:

- Panel layout with controls, details, graph regions
- Separators with fillets for rounded corners
- Quaternion-based 3D rendering (two nested cubes, drag to rotate)
- RBush hit detection with hover/click/long-click/double-click
- VitePress docs at docs.designintuition.app
- Main app at designintuition.app

## What's Working

| Layer | Status |
|-------|--------|
| Rendering | Quaternions, wireframe, depth-based alpha |
| Layout | Three regions, separators, fillets |
| Interaction | Hits manager ported from ws |
| Docs | VitePress, dual Netlify deploy |
| Testing | 206 tests for core types |


## Quick Links

- [Milestones](./milestones/)
- [Architecture](../architecture/)
- [Guides](../guides/)
```

### /Users/sand/GitHub/mono/di/notes/work/index.md
```md
# Work

Current work items and milestones.

## Contents

- [Done](./done/)
- [Milestones](./milestones/)
- [Pacing](./pacing.md)
- [Revisit](./revisit.md)
- [Simplicity](./simplicity.md)

```

### /Users/sand/GitHub/mono/di/notes/work/milestones/1.solid.foundation.md
```md


# Milestone 1: Project Creation

**Started: January 4-5, 2025**
**Status:** completed

---

To begin, let's capture the quintessense of this first milestone. eg, initial yarn installs, project creation, adding svelte, vitest, configuration issues, challenges. then i will massage it and do some more massaging, then i will know what i want the template to be.
## Goal

Put this project on its feet and provide a proof of concept of 3D rendering and user interaction.

---
## What Emerged

A working quaternion demo: two nested cubes, drag to rotate the outer, inner spins independently. Wireframe rendering with depth-based opacity. No gimbal lock.

But more than that: a development environment. Vite + Svelte 5 + TypeScript + vitest. A documentation system. A workflow that lets me pick up where I left off, even weeks later. A style guide so the code stays consistent.

The foundation for the CAD program I've been wanting to rebuild for twenty years.

---
## What we did

The very first step was to describe the [[project]] and flesh out that description. Then a single `index.html` — cube rotating with quaternions, no gimbal lock. Drag to rotate. gl-matrix for the math, Canvas 2D for the lines. Proof that the pipeline worked.

Next day, promoted it to its own repo. `yarn create vite di --template vanilla-ts`. The name "di" for Design Intuition—compact, easy to type, evokes the old dream.
### The Stack Decisions

Vite was obvious (already using it in webseriously). TypeScript mandatory. But then: add Svelte or stay vanilla? The POC was pure imperative canvas—no reactivity needed. But I knew UI would come eventually. Controls, panels, the stuff around the canvas. Added Svelte preemptively.

That triggered a cascade. Svelte 5 had just shipped. Why start with 4 and migrate later? So: Svelte 5 from day one, runes instead of stores, `mount()` instead of `new Component()`. Wrote a migration guide anyway [[svelte]] to document the resulting files, installs and configuration.
### Architecture Emerges

The single-file POC exploded into managers: Scene, Camera, Render, Input, Animation. Each a singleton, lowercase export (`scene`, `camera`, `render`). Classes do the work, instances coordinate.

Types proliferated. Started with raw `{x, y}` objects, formalized into `Point`, `Size`, `Rect`. Added `Point3` for vertices, `Polar` for angles. `Angle.ts` grew quadrant logic, cursor mappings. Migration plan tracked the conversion from scattered x/y to proper types.

### The Workflow System

Most important outcome: the notes structure. `notes/work/` for active tasks, `notes/work/done/` for completed ones. `notes/guides/` for living references. CLAUDE.MD as the entry point. Work tracking files that survive across chat sessions.

This isn't just documentation—it's the AI collaboration pattern. Define problem and goal upfront. Track progress in markdown. Revisit points for continuity. The guides encode hard-won lessons (gotchas.md, debugging.md, style.md) so Claude doesn't repeat mistakes.
### Testing Infrastructure

Added vitest. Not just to have tests, but to validate the foundational types. 206 tests across Coordinates, Angle, Colors, Extensions, Utilities. The tests discovered actual bugs—`cursor_forAngle` treating 0 as falsy, `orientation_ofAngle` wrong at quadrant boundaries. Fixed them. Testing pays for itself immediately.
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/4.hits.manager.md
```md
# Milestone 4: Hits Manager
**Timeline:** Jan 8, 2025 | **Status:** done

## Goal
Borrow and deploy the hits manager from ws (webseriously) to di. 

## What Emerged

A clean port of ws's spatial indexing system. RBush provides O(log n) hit detection. Mouse events route through a unified handler. Components register as hit targets and respond to hover/click. The graph background changes color on hover as proof of integration.

## Our Work

### Review ws implementation
- [x] `src/lib/ts/managers/Hits.ts` — main manager (RBush spatial index, click handling)
- [x] `src/lib/ts/state/S_Hit_Target.ts` — hit target class
- [x] `src/lib/ts/signals/Mouse_Timer.ts` — timer for long-click, double-click, autorepeat

### Identify what di already has
- [x] `S_Mouse` — identical to ws ✓
- [x] `T_Hit_Target` enum ✓
- [x] `T_Mouse_Detection` enum ✓
- [x] `T_Drag` enum ✓
- [x] `Constants.threshold` (autorepeat, double_click, long_click) ✓
- [x] `Point`, `Rect` types ✓

### Dependencies to add
- [x] Install `rbush` package (`yarn add rbush @types/rbush`)
- [x] Create `src/lib/ts/signals/Mouse_Timer.ts`
- [x] Create `src/lib/ts/state/S_Hit_Target.ts`
- [x] Create `src/lib/ts/managers/Hits.ts`
- [x] Add `asBBox` to Point and Rect in Coordinates.ts
- [x] Create `src/lib/ts/signals/Events.ts` (mouse event handlers)
- [x] Create `src/lib/ts/state/S_Component.ts`
- [x] Create `src/lib/ts/managers/Components.ts`

### Simplifications for di
- [x] Remove ws-specific: radial, controls, ancestry, colors references
- [x] Remove ring/paging/widget-specific logic (not needed yet)
- [x] Keep: RBush indexing, hover detection, click/long-click/double-click handling

### Integration
- [x] Add `hits` export to common imports
- [x] Create `src/lib/ts/signals/Events.ts` (mouse event handlers)
- [x] Call `e.setup()` on app init (Main.svelte onMount)
- [x] Make graph an S_Component hit target
- [x] Add hover reaction (background turns white)
- [x] Fix: clear hover on mouseleave and recalibrate on resize
- [x] Test hover detection
- [x] Test click handling

### Deploy
- [x] Verify build passes
- [x] Push to trigger Netlify deploy
- [x] Test on https://designintuition.app

## Artifacts

- `src/lib/ts/managers/Hits.ts` — RBush spatial index, click routing
- `src/lib/ts/managers/Components.ts` — component registry
- `src/lib/ts/state/S_Hit_Target.ts` — hit target state
- `src/lib/ts/state/S_Component.ts` — component state
- `src/lib/ts/signals/Mouse_Timer.ts` — long-click, double-click timing
- `src/lib/ts/signals/Events.ts` — unified mouse event handlers
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/3.docs.md
```md
# Milestone 3: Document Publishing
**Timeline:** Jan 5-8, 2025 | **Status:** done

## Goal
Two separate deployments from the same repo:
1. **docs.designintuition.app** → VitePress documentation
2. **designintuition.app** → Main SvelteKit app (future)

## What Emerged

Dual deployment from a single monorepo: VitePress docs at `docs.designintuition.app`, Svelte app at `designintuition.app`. DNS via Dynadot, hosting via Netlify with automatic SSL. The pattern is reusable for other projects.

## Our Work
### DNS Setup
- [x] Browse to [Dynadot](https://www.dynadot.com)
- [x] Purchase `designintuition.app`
- [x] Configure DNS records:
  - A record: `@` → `75.2.60.5` (Netlify load balancer)
  - CNAME: `www` → `designintuition.netlify.app` (main app, future)
  - CNAME: `docs` → `docs-designintuition.netlify.app`
  - TXT: `subdomain-owner-verification` → `660430d82e3f9631310ddfef50a2e859` (Netlify ownership proof)
- [x] Verify propagation: `dig designintuition.app` and `dig docs.designintuition.app`

### Netlify Project 1: Docs
- [x] Create new Netlify site from `di` repo
- [x] Build command: `yarn docs:build`
- [x] Publish directory: `notes/.vitepress/dist`
- [x] Site name: `docs-designintuition`
- [x] Add custom domain: `docs.designintuition.app`
- [x] Add TXT record in Dynadot for ownership verification
- [x] Wait for SSL provisioning

### Netlify Project 2: Main App
- [x] Create new Netlify site from `di` repo
- [x] Build command: `yarn build`
- [x] Publish directory: `dist`
- [x] Site name: `designintuition`
- [x] Add custom domain: `designintuition.app`
- [x] Add alias: `www.designintuition.app`
- [x] Wait for SSL provisioning

### Verify
- [ ] Visit https://docs.designintuition.app → shows VitePress docs
- [ ] Visit https://designintuition.app → shows main app (future)

## Artifacts

- Netlify: [docs-designintuition](https://app.netlify.com/sites/docs-designintuition)
- Netlify: [designintuition](https://app.netlify.com/sites/designintuition)
- Live: https://docs.designintuition.app
- Live: https://designintuition.app
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/index.md
```md
# Milestones

Project milestones for Design Intuition.
---
### 1 — Solid Foundation
**Timeline:** Jan 4-5, 2025 | [details](./1.solid.foundation.md)
**Goal:** Put the project on its feet with a proof of concept for 3D rendering and user interaction.
**Outcome:** Working quaternion demo, dev environment, testing infrastructure, and the collaboration workflow system.
### 2 — Panel Layout
**Timeline:** Jan 6-7, 2025 | [details](./2.panel/)
**Goal:** Flesh out the skeleton using ideas from webseriously, with industry best practices.
**Outcome:** Clean panel layout with rounded-corner regions, separators, and fillets. Svelte 5 runes throughout.
### 3 — Document Publishing
**Timeline:** Jan 5-8, 2025 | [details](./3.docs.md)
**Goal:** Dual Netlify deployments — docs subdomain and main app.
**Outcome:** Live at docs.designintuition.app and designintuition.app with SSL.
### 4 — Hits Manager
**Timeline:** Jan 8, 2025 | [details](./4.hits.manager.md)
**Goal:** Port the hits manager from ws to enable spatial click/hover detection.
**Outcome:** RBush-based hit detection with hover, click, long-click, and double-click handling.

### 5 — Smart Objects
**Timeline:** Jan 29, 2025 | [details](./5.smart.objects.md)
**Goal:** Introduce smart objects (SO) — geometry with attributes.
**Outcome:** (in progress)

## Contents

- [5.smart.objects](./5.smart.objects.md)
- [4.hits.manager](./4.hits.manager.md)
- [3.docs](./3.docs.md)
- [2.panel](./2.panel/)
- [1.solid.foundation](./1.solid.foundation.md)

```

### /Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/implement.md
```md
# Panel

## Implement using industry best practices

I am keen to avoid the newbie pitfalls that the webseriously code suffers from. Before proceeding, I want us to be well up to speed on industry best advice for Svelte and gl.

I also want us to write a design description file for each component we create. Place that file in notes/designs, and keep it up to date.

## Tasks

- [x] research the svelte community and docs ✅
  - [x] write a short list of the most important points made ✅
- [x] implement panel, empty but with boilerplate ✅
  - [x] write milestones/2.panel/architecture.md ✅
    - [x] describe what you built ✅
    - [x] include all class names ✅
    - [x] diagram of the layout ✅
    - [x] identifying each class ✅
  - [x] work with me to mold it as needed
    - [x] specify position and sticky edges
  - [x] Graph, Details, Controls
  - [x] Separator
  - [x] Fillets
  - [x] Box
  - [x] Preferences.ts
  - [x] incorporate Box and Separator into Main
- [x] rinse and repeat until I am happy with it ✅


---

## Svelte 5 Best Practices (Research Summary)

### Runes — The New Reactivity Model

| Rune | Purpose | Replaces |
|----|----|----|
| `$state()` | Mutable reactive state | `let x = 0` at top level |
| `$derived()` | Computed values (memoized) | `$: x = y * 2` |
| `$effect()` | Side effects (browser only) | `$: { doSomething() }` |
| `$props()` | Component props | `export let prop` |
| `$bindable()` | Two-way binding props | `export let value` with `bind:` |

**Key insight**: `$derived` for computing values (pure), `$effect` for actions (impure). Never use `$effect` when `$derived` will do.

### Props & TypeScript

```typescript
// Svelte 5 typed props
let { 
	width, 
	height = 100,
	children 
}: { 
	width: number; 
	height?: number;
	children?: Snippet;
} = $props();
```

### Snippets Replace Slots

Slots are deprecated. Use snippets + `{@render}`:

```svelte
<!-- Parent -->
<Box>
	{#snippet header()}
		<h1>Title</h1>
	{/snippet}
</Box>

<!-- Child (Box.svelte) -->
<script lang="ts">
	import type { Snippet } from 'svelte';
	let { children, header }: { 
		children?: Snippet; 
		header?: Snippet;
	} = $props();
</script>

{@render header?.()}
<div class="content">
	{@render children?.()}
</div>
```

### Event Handlers

* Use native DOM attributes: `onclick`, `oninput` (not `on:click`)
* Pass callback props instead of `createEventDispatcher`

### Shared State

For state across components, use `.svelte.ts` files:

```typescript
// state.svelte.ts
export const appState = $state({
	count: 0,
	user: null
});
```

### Component Structure (Order)

1. `<script lang="ts">` — imports, props, state, derived, effects, functions
2. Template markup
3. `<style>` (if needed)

### Performance Tips

* Runes track dependencies at runtime (more reliable than Svelte 4)
* `$derived` is memoized — only recalculates when dependencies change
* Smaller bundles (15-30% reduction over Svelte 4)
* No virtual DOM — compiles to direct DOM manipulation

### Avoid

* Don't mutate state inside `$derived` (infinite loop)
* Don't use `$effect` for derived values
* Don't use `<svelte:component>` in runes mode (deprecated)
* Stores still work but aren't necessary — prefer runes


---

## First set of components

These seven components form the backbone of the UX.

### Layout/Structure

| Component | Purpose |
|----|----|
| `Main.svelte` | Root layout — orchestrates regions with Box container |
| `Box.svelte` | Bordered container with Separators on all four sides |
| `Separator.svelte` | Visual dividers with optional fillets and titles |
| `Fillets.svelte` | Decorative curved corners for separators |
| `Details.svelte` | Left sidebar region |
| `Controls.svelte` | Top toolbar region |
| `Graph.svelte` | Main canvas region |
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/architecture.md
```md
# Panel Architecture

## Overview

Panel is the root layout component for the di application. It provides a fixed, full-viewport container with three distinct regions: controls (top), graph (main content), and details (right sidebar).

## Layout Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                         .controls                               │
│                        (48px height)                            │
├═══════════════════════════════════════════════════════════════╮─┤
│                    Separator (horizontal, 8px)                ╯ │
├─────────────────╦═══════════════════════════════════════════════┤
│                 ║                                               │
│                 ║                                               │
│    .details     ║                    .graph                     │
│   (280px width) ║               (flex: 1, fills)                │
│                 ║                                               │
│                 ║  Separator                                    │
│                 ║  (vertical, 8px)                              │
│                 ║                                               │
│                 ║                                               │
└─────────────────╩═══════════════════════════════════════════════┘
                              .panel
                    (fixed, full viewport)
```

## DOM Structure

```
Main.svelte (.panel)
├── .region.controls      ← top bar
│   └── Controls.svelte
├── Separator             ← horizontal, below controls
├── .main                 ← flexbox container
│   ├── .region.details   ← left sidebar (if showDetails)
│   │   └── Details.svelte
│   ├── Separator         ← vertical, between details/graph (if showDetails)
│   └── .region.graph     ← main content area
│       └── Graph.svelte
```

## Components

| Component | Location | Purpose |
|-----------|----------|--------|
| `Main.svelte` | `layout/` | Root layout, manages regions, renders children |
| `Controls.svelte` | `layout/` | Top bar with title |
| `Graph.svelte` | `layout/` | Canvas with ResizeObserver, 3D rendering |
| `Details.svelte` | `layout/` | Left sidebar, properties panel |
| `Separator.svelte` | `layout/` | Visual divider with optional fillets |
| `Fillets.svelte` | `layout/` | SVG curved corner decorations |
| `Box.svelte` | `layout/` | Bordered container using separators |

### Managers

| Component | Location | Purpose |
|-----------|----------|--------|
| `Preferences.ts` | `managers/` | localStorage read/write for persistent settings |

## CSS Classes

| Class | Element | Purpose |
|-------|---------|---------|
| `.panel` | Root `<div>` | Fixed position, full viewport, flex column, theming vars |
| `.main` | Content wrapper | Flex row container for graph + details |
| `.region` | All content areas | Shared: relative position, overflow hidden |
| `.controls` | Top bar | Full width, bottom border, fixed height |
| `.graph` | Main content | Flex grow, fills available space |
| `.details` | Left sidebar | Fixed width, right border |

## CSS Custom Properties

| Property | Default | Purpose |
|----------|---------|---------|
| `--panel-bg` | `#1a1a2e` | Panel background color |
| `--panel-fg` | `#eee` | Panel text color |
| `--border-color` | `#333` | Border color for regions |

## State

| Variable | Type | Reactive | Purpose |
|----------|------|----------|---------|
| `width` | `number` | `$state` | Viewport width, updates on resize |
| `height` | `number` | `$state` | Viewport height, updates on resize |
| `showDetails` | `boolean` | `$state` | Toggle details panel visibility |
| `controlsHeight` | `number` | `$derived` | Fixed at 48px (configurable later) |
| `detailsWidth` | `number` | `$derived` | Fixed at 280px (configurable later) |
| `graphRect` | `object` | `$derived` | Computed {x, y, width, height} for graph region |
| `detailsRect` | `object` | `$derived` | Computed {x, y, width, height} for details region |

## Props (Snippets)

| Prop | Type | Required | Purpose |
|------|------|----------|---------|
| `controls` | `Snippet` | No | Content for top control bar |
| `graph` | `Snippet` | No | Content for main graph area |
| `details` | `Snippet` | No | Content for right sidebar |
| `children` | `Snippet` | No | Fallback content |

## Usage

```svelte
<Panel>
	{#snippet controls()}
		<h1>Title</h1>
	{/snippet}

	{#snippet graph()}
		<canvas></canvas>
	{/snippet}

	{#snippet details()}
		<aside>Properties</aside>
	{/snippet}
</Panel>
```

## Sticky Edges

| Edge | Behavior |
|------|----------|
| Top | `.controls` sticks to top (position: fixed on parent) |
| Left | `.details` sticks to left edge |
| Right | `.graph` fills to right edge |
| Bottom | `.main` fills to bottom |

## Future Considerations

- Resizable details panel (drag border)
- Collapsible details (toggle `showDetails`)
- Multiple control bars (primary/secondary)
- Breakpoints for mobile (hide details on narrow screens)
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/components.md
```md
# Components
**Started:** 2025-01-06 | **Status:** Phase 2 in progress

## Problem
webseriously has 40+ Svelte components built organically over time. Many have tangled concerns, prop soup, and inconsistent patterns. Need to identify which are worth salvaging vs. rebuilding from scratch. 
## Goal

- [ ] Catalog existing components
- [ ] Panel design and implementation, all four components, one component at a time

Later, we can select candidates for di, then architect and implement versions according to industry best practices for svelte components using typescript.

## Tasks

- [ ] implement the panel using industry best practices for svelte components using typescript
- [ ] work with me to mold it as needed
- [ ] I will then choose the next component

---
## Webseriously Architecture

The code should be treated as rotten. The concepts, capabilities, purpose should be treated as well-tested and worth recreating from scratch.

### Layout/Structure
| Component | Purpose |
|-----------|---------|
| `Panel.svelte` | Main container — orchestrates everything. Routes between normal view, BuildNotes, Import, Preview. Houses Primary_Controls, Details, Secondary_Controls, and the graph area. |
| `Box.svelte` | Bordered container with Separators on all four sides. Uses slots for content. |
| `Separator.svelte` | Visual dividers with optional fillets, titles, and thin divider lines. Horizontal or vertical. |
| `Fillets.svelte` | Decorative curved corners for separators. |

### Graph Views
| Component | Purpose |
|-----------|---------|
| `Graph.svelte` | Switches between radial and tree views. Handles layout triggers, rubberband selection, and bottom controls. |
| `Radial_Graph.svelte` | Radial layout implementation. |
| `Tree_Graph.svelte` | Tree layout implementation. |

### Controls
| Component | Purpose |
|-----------|---------|
| `Primary_Controls.svelte` | Top toolbar area. |
| `Secondary_Controls.svelte` | Additional toolbar (tree controls when in tree mode). |
| `Breadcrumbs.svelte` | Navigation path display. |
| `Button.svelte` | Core button — hover, autorepeat, long-click, double-click via S_Element state. Complex. |
| `Segmented.svelte` | Segmented control (iOS-style toggle buttons). |
| `Slider.svelte` | Slider control. |
| `Steppers.svelte` | Increment/decrement controls. |

### Details Panel
| Component | Purpose |
|-----------|---------|
| `Details.svelte` | Side panel showing properties/actions for selected item. |
| `Banner_Hideable.svelte` | Collapsible section with show/hide toggle. |
| `D_Actions.svelte` | Action buttons for selected item. |
| `D_Data.svelte` | Data display section. |
| `D_Header.svelte` | Header info for selection. |
| `D_Preferences.svelte` | User preferences UI. |
| `D_Selection.svelte` | Selection info. |
| `D_Tags.svelte` | Tag management. |
| `D_Traits.svelte` | Trait display. |

### Widgets (Graph Nodes)
| Component | Purpose |
|-----------|---------|
| `Widget.svelte` | Main node component for graph items. |
| `Widget_Drag.svelte` | Drag handling for widgets. |
| `Widget_Reveal.svelte` | Expand/collapse animation. |
| `Widget_Title.svelte` | Title display/editing. |

### Mouse/Interaction
| Component | Purpose |
|-----------|---------|
| `Rubberband.svelte` | Selection rectangle. |
| `Clickable_Label.svelte` | Text that responds to clicks. |
| `Buttons_Row.svelte` | Horizontal button arrangement. |
| `Buttons_Table.svelte` | Grid button arrangement. |
| `Close_Button.svelte` | X button for closing. |
| `Cluster_Pager.svelte` | Paging through clustered items. |
| `Color.svelte` | Color picker/display. |
| `Glow_Button.svelte` | Button with glow effect. |
| `Glows_Banner.svelte` | Banner with glow buttons. |
| `Next_Previous.svelte` | Navigation arrows. |
| `Triangle_Button.svelte` | Directional triangle button. |

### Utility/Drawing
| Component | Purpose |
|-----------|---------|
| `Spinner.svelte` | Loading indicator with dashes. |
| `Circle.svelte` | Circle rendering. |
| `Transparent_Circle.svelte` | Semi-transparent circle. |
| `Portal.svelte` | Renders children outside normal DOM hierarchy. |
| `SVG_D3.svelte` | D3-based SVG rendering. |
| `SVG_Gradient.svelte` | Gradient definitions. |
| `Printable.svelte` | Print-friendly output. |

### Search
| Component | Purpose |
|-----------|---------|
| `Search.svelte` | Search input. |
| `Search_Results.svelte` | Results display. |

---

## Phase 2: Selection
- [ ] Choose which components to focus on

(waiting for your selection)

---

## Phase 3: Architecture
- [ ] Describe in abstract terms: what it does, why, and conceptually how
- [ ] Compose formal architecture and implementation plan documents

---

## Phase 4: Implementation
- [ ] Implement one component

---

## Phase 5: Assessment
- [ ] Assess strategy, update docs

---

## Artifacts
(add links when complete)
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/index.md
```md
# 2.panel

## Contents

- [Architecture](./architecture.md)
- [Components](./components.md)
- [Implement](./implement.md)
- [Milestone 2](./milestone 2.md)

```

### /Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/milestone 2.md
```md
# Milestone 2: Panel Layout
**Timeline:** Jan 6-7, 2025 | **Status:** complete ✅

## Goal
Begin to flesh out the skeleton of the final product, using IDEAS and purpose of existing `webseriously` code. I spent a lot of time on its look and feel, so hey, reuse, recycle, live life to its fullest.

## What Emerged

A clean panel layout with rounded-corner regions separated by colored bars with decorative fillets. Key insights:

1. **Fillets create region corners** — Regions don't have their own corner logic. Their rounded appearance emerges from fillets on adjacent separators.

2. **Overlap rule** — Separators extend `thickness/2` beyond endpoints so fillets align with intersecting separator centers.

3. **Unified color** — Separators and fillets share `w_separator_color` for a cohesive look.

4. **Terminology rename** — "Gull wings" → "Fillets" for clearer industry-standard naming.

See architecture.md for the layout model.

## What we did

Escaped from webseriously's newbie mistakes by:
- Using Svelte 5 runes (`$state`, `$derived`, `$props`)
- Typed props with TypeScript interfaces
- Snippets instead of deprecated slots
- Clean component separation

### Components Built

| Component | Purpose |
|-----------|---------|
| `Main.svelte` | Root layout with Box + interior separators |
| `Box.svelte` | Frame with 4 separators + corner fillets |
| `Separator.svelte` | Colored bar with optional fillets |
| `Fillets.svelte` | Quarter-circle SVG arcs |
| `Controls.svelte` | Top toolbar (empty) |
| `Details.svelte` | Left sidebar (empty) |
| `Graph.svelte` | Canvas region with 3D cube |

### Supporting Code

| File | Purpose |
|------|---------|
| `Constants.ts` | `k.thickness.separator.main`, `k.radius.fillets.*` |
| `Colors.ts` | `w_separator_color`, `w_background_color` stores |
| `SVG_Paths.ts` | `svg_paths.fillets()` path generator |
| `Preferences.ts` | localStorage wrapper |

## Artifacts

- [[implement]] — task checklist + Svelte 5 best practices
- [[architecture]] — DOM structure + CSS classes + layout model
```

### /Users/sand/GitHub/mono/di/notes/work/milestones/5.smart.objects.md
```md
# Milestone 5: Smart Objects
**Timeline:** Jan 29, 2025 | **Status:** in progress

## Goal

Introduce smart objects (SO) — geometry with attributes. The foundation for everything that follows: editing, dimensions, hierarchy.

## What Emerged

(add when complete)

## Our Work

### Define what a smart object is
- [x] How does it differ from O_Scene? SO is primary, O_Scene is optional ref for rendering
- [x] Should SO wrap O_Scene or replace it? Composition — O_Scene is ref in SO
- [ ] What attributes does an SO have?

### Implement
- [x] Create `runtime/Smart_Object.ts` — extends Identifiable, has name + optional O_Scene
- [x] Create `types/Attribute.ts` — boilerplate for name/value pairs
- [ ] Add attributes collection to Smart_Object
- [ ] Register SOs with hits manager
- [ ] Render SOs in the graph
- [ ] Show SO attributes in Details panel when selected

### Test
- [ ] Create a simple SO (rectangle? box?)
- [ ] Verify hit detection works
- [ ] Verify selection shows in Details

## Artifacts

- `src/lib/ts/runtime/Smart_Object.ts`
- `src/lib/ts/types/Attribute.ts`
```

### /Users/sand/GitHub/mono/di/.gitignore
```gitignore
# Dependencies
node_modules/

# Build output
dist/

# VitePress
.vitepress/cache/
.vitepress/dist/

# OS
.DS_Store

# Editor
.vscode/
*.swp
*.swo

# Logs
*.log
```

### /Users/sand/GitHub/mono/di/package.json
```json
{
  "name": "designintuition",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "check": "svelte-check --tsconfig ./tsconfig.json",
    "test": "vitest",
    "test:run": "vitest run",
    "docs:dev": "vitepress dev",
    "docs:build": "vitepress build",
    "docs:preview": "vitepress preview"
  },
  "dependencies": {
    "@types/rbush": "^4.0.0",
    "color2k": "^2.0.3",
    "gl-matrix": "^3.4.4",
    "rbush": "^4.0.1",
    "typed-signals": "^3.0.0",
    "uuid": "^13.0.0"
  },
  "devDependencies": {
    "@sveltejs/vite-plugin-svelte": "^5.0.0",
    "@tsconfig/svelte": "^5.0.0",
    "@types/uuid": "^11.0.0",
    "markdown-it-task-lists": "^2.1.1",
    "svelte": "^5.0.0",
    "svelte-check": "^4.0.0",
    "typescript": "^5.3.3",
    "vite": "^6.0.0",
    "vitepress": "^1.6.4",
    "vitest": "^3.0.0"
  }
}
```

### /Users/sand/GitHub/mono/di/tsconfig.json
```json
{
  "extends": "@tsconfig/svelte/tsconfig.json",
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["src/**/*.ts", "src/**/*.svelte"]
}
```

### /Users/sand/GitHub/mono/di/vite.config.ts
```ts
import { defineConfig } from 'vite';
import { svelte } from '@sveltejs/vite-plugin-svelte';
import ports from '../notes/tools/hub/ports.json';

export default defineConfig({
  plugins: [svelte()],
  server: {
    port: ports.di
  },
});
```

### /Users/sand/GitHub/mono/di/vitest.config.ts
```ts
import { defineConfig } from 'vitest/config';
import { svelte } from '@sveltejs/vite-plugin-svelte';

export default defineConfig({
  plugins: [svelte()],
  test: {
    setupFiles: ['src/lib/ts/tests/setup.ts'],
    globals: true,
  },
});
```

### /Users/sand/GitHub/mono/di/CLAUDE.MD
```MD
# CLAUDE.MD

COMMON: Read `../../CLAUDE.MD`

REPO: `~/GitHub/mono/projects/di`

GUIDES: Read all `.md` files in `notes/guides/`

FRESHNESS: When comparing files, checking differences, or claiming file contents—ALWAYS re-read immediately before. Never rely on cached content from earlier in conversation. If user says "these are different" or "that's not what's in the file", RE-READ before responding.```

### /Users/sand/GitHub/mono/di/src/main.ts
```ts
import { mount } from 'svelte';
import App from './App.svelte';

const app = mount(App, {
  target: document.getElementById('app')!,
});

export default app;
```

### /Users/sand/GitHub/mono/di/src/App.svelte
```svelte
<script lang='ts'>
	import Main from './lib/svelte/main/Main.svelte';
</script>

<Main />

<style>
	:global(body) {
		margin      : 0;
		font-family : system-ui, sans-serif;
	}
</style>
```

### /Users/sand/GitHub/mono/di/src/vite-env.d.ts
```ts
/// <reference types="svelte" />
/// <reference types="vite/client" />
```

### /Users/sand/GitHub/mono/di/src/lib/svelte/main/Details.svelte
```svelte
<script lang='ts'>
	import { colors } from '../../ts/draw/Colors';
	const { w_text_color, w_background_color } = colors;
</script>

<div
	class            = 'details'
	style:color      = {$w_text_color}
	style:background = {$w_background_color}>
	<h2>Details</h2>
	<p>Properties panel placeholder</p>
</div>

<style>
	.details {
		width      : 100%;
		height     : 100%;
		padding    : 1rem;
		box-sizing : border-box;
	}

	.details h2 {
		margin      : 0 0 1rem;
		font-size   : 1rem;
		font-weight : 500;
	}

	.details p {
		margin    : 0;
		opacity   : 0.6;
		font-size : 0.875rem;
	}
</style>
```

### /Users/sand/GitHub/mono/di/src/lib/svelte/main/Controls.svelte
```svelte
<script lang='ts'>
	import { colors } from '../../ts/draw/Colors';
	const { w_text_color, w_background_color } = colors;

	let {
		title = 'Design Intuition'
	} : {
		title? : string;
	} = $props();
</script>

<div
	class            = 'controls'
	style:color      = {$w_text_color}
	style:background = {$w_background_color}>
	<h1>{title}</h1>
</div>

<style>
	.controls {
		width       : 100%;
		height      : 100%;
		display     : flex;
		padding     : 0 1rem;
		align-items : center;
		box-sizing  : border-box;
	}

	.controls h1 {
		margin      : 0;
		font-size   : 1.25rem;
		font-weight : 300;
	}
</style>
```

### /Users/sand/GitHub/mono/di/src/lib/svelte/main/Main.svelte
```svelte
<script lang='ts'>
	import { onMount } from 'svelte';
	import { k } from '../../ts/common/Constants';
	import { e } from '../../ts/signals/Events';
	import { colors } from '../../ts/draw/Colors';
	import Controls from './Controls.svelte';
	import Graph from './Graph.svelte';
	import Details from './Details.svelte';

	const { w_separator_color } = colors;

	// Initialize event system
	onMount(() => {
		e.setup();
	});

	// Reactive state for window dimensions
	let width  = $state(window.innerWidth);
	let height = $state(window.innerHeight);

	// Layout constants
	const gap    = k.thickness.separator.main;
	const radius = gap * 3;

	let controlsHeight = $derived(48);
	let detailsWidth   = $derived(280 - gap * 2);
	let showDetails    = $state(true);

	// Computed dimensions
	let mainHeight = $derived(height - controlsHeight - gap * 3);
	let graphWidth = $derived(width - (showDetails ? detailsWidth + gap : 0) - gap * 2);

	function handleResize() {
		width  = window.innerWidth;
		height = window.innerHeight;
	}
</script>

<svelte:window
	onresize = {handleResize}
/>

<div
	class        = 'panel'
	style:width  = '{width}px'
	style:height = '{height}px'
	style:padding = '{gap}px'
	style:--gap    = '{gap}px'
	style:--radius = '{radius}px'
	style:background-color = {$w_separator_color}>
	<!-- Controls region -->
	<div
		class        = 'region controls'
		style:height = '{controlsHeight}px'>
		<Controls />
	</div>

	<!-- Main content area -->
	<div
		class         = 'main'
		style:height  = '{mainHeight}px'
		style:margin-top = '{gap}px'>
		{#if showDetails}
			<!-- Details region -->
			<div
				class        = 'region details'
				style:width  = '{detailsWidth}px'
				style:height = '{mainHeight}px'>
				<Details />
			</div>
		{/if}

		<!-- Graph region -->
		<div
			class        = 'region graph'
			style:width  = '{graphWidth}px'
			style:height = '{mainHeight}px'>
			<Graph />
		</div>
	</div>
</div>

<style>
	.panel {
		top         : 0;
		left        : 0;
		position    : fixed;
		font-family : system-ui, sans-serif;
		box-sizing  : border-box;
	}

	.main {
		display  : flex;
		overflow : hidden;
		gap      : var(--gap);
	}

	.region {
		overflow      : hidden;
		position      : relative;
		border-radius : var(--radius);
	}

	.controls {
		width : 100%;
	}

	.graph {
		flex : 1;
	}

	.details {
		flex-shrink : 0;
	}
</style>
```

### /Users/sand/GitHub/mono/di/src/lib/svelte/main/Graph.svelte
```svelte
<script lang='ts'>
	import { onMount, onDestroy } from 'svelte';
	import { render } from '../../ts/render/Render';
	import { colors } from '../../ts/draw/Colors';
	import { components } from '../../ts/managers/Components';
	import { hits } from '../../ts/managers/Hits';
	import { T_Hit_Target } from '../../ts/types/Enumerations';
	import S_Mouse from '../../ts/state/S_Mouse';
	import { init } from '../../ts/render/Trivial';

	const { w_text_color, w_background_color } = colors;
	const GRAPH_HID = 1;

	let canvas      : HTMLCanvasElement;
	let container   : HTMLDivElement;
	let initialized = false;
	let isHovering  = $state(false);

	const s_component = components.component_forHID_andType_createUnique(GRAPH_HID, T_Hit_Target.rubberband);

	// Subscribe to hover changes
	const unsubscribe = hits.w_s_hover.subscribe((hovering) => {
		isHovering = hovering?.hasSameID_as(s_component) ?? false;
	});

	function initCanvas(width : number, height : number) {
		if (!canvas || initialized) return;
		canvas.width  = width;
		canvas.height = height;
		init(canvas);
		initialized = true;
	}

	function resizeCanvas(width : number, height : number) {
		if (!initialized) {
			initCanvas(width, height);
			return;
		}
		render.resize(width, height);
	}

	onMount(() => {
		if (!container) return;

		// Register the container as a hit target
		s_component.set_html_element(container);
		
		// Set up click handler
		s_component.handle_s_mouse = (s_mouse: S_Mouse) => {
			if (s_mouse.isDown) {
				console.log('Graph clicked!');
			}
			return true;
		};

		const observer = new ResizeObserver((entries) => {
			const entry = entries[0];
			if (!entry) return;

			const { width, height } = entry.contentRect;
			if (width == 0 || height == 0) return;

			resizeCanvas(Math.floor(width), Math.floor(height));
			
			// Update hit target rect after resize
			s_component.update_rect();
			hits.recalibrate();
		});

		observer.observe(container);

		return () => {
			observer.disconnect();
		};
	});

	onDestroy(() => {
		unsubscribe();
		components.component_remove(s_component);
	});
</script>

<div
	class            = 'graph'
	bind:this        = {container}
	style:color      = {$w_text_color}
	style:background = {isHovering ? 'white' : $w_background_color}>
	<canvas
		bind:this = {canvas}></canvas>
</div>

<style>
	.graph {
		width  : 100%;
		height : 100%;
	}

	.graph canvas {
		width      : 100%;
		height     : 100%;
		cursor     : grab;
		display    : block;
		background : inherit;
	}

	.graph canvas:active {
		cursor : grabbing;
	}
</style>
```

### /Users/sand/GitHub/mono/di/src/lib/svelte/draw/Printable.svelte
```svelte
<script lang='ts'>
	import { Point, Rect, Size } from '../../ts/types/Coordinates';
	import { k, printer_aspect_ratio } from '../../ts/common/Constants';

	let { element, rect }: { element: HTMLElement; rect: Rect } = $props();

	const screen_scale_factor = window.devicePixelRatio;
	const message_height = 290;
	let printer_page_width = 722;
	let final_content_rect: Rect;
	let printer_dpi = 96;
	let final_inset_size: Size;
	let final_page_size: Size;
	let final_origin: Point;
	let log_message: string;
	let isLandscape: boolean;
	let scaleFactor: number;
	let margin = 0;
	let scale_size: Size;
	let printable: HTMLDivElement;
	let kludge: Point;
	
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//
	//	Printing origin calculation:
	//
	//	pO		k - dC * dpF
	//	dC		dO + dS / 2
	//
	//	scalars:
	//
	//	dpF		scaleFactor
	//	m		margin
	//
	//	vectors:
	//
	// 	k		kludge								BROKEN, doesn't work for many variants of D
	//	pO		final_origin						top left for print style
	//	pS		final_inset_size
	//	dS		given_content_rect . size
	//	dC		given_content_rect . center
	//	dO		given_content_rect . origin			location of the drawn sub element within the given element
	//
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	configure();
	layout();

	$effect(() => {
		if (!!printable) {
			printable.innerHTML = k.empty;
			printable.appendChild(element.cloneNode(true));
		}
	});

	function configure() {
		const printCSS = `
			@media print {
				.print-test {
						top: 0; 
						left: 0; 
						width: 100%; 
						height: 100%; 
						position: absolute; 
					}
				}`;
		const square_inch = document.createElement('div');
		const style = document.createElement('style');
		const page = document.createElement('div');
		style.textContent = printCSS;
		page.className = 'print-test';
		square_inch.style.cssText = 'width: 1in; height: 1in; position: absolute; top: -9999px;';

		document.head.appendChild(style);
		document.body.appendChild(page);
		printer_page_width = page.offsetWidth;
		document.body.removeChild(page);
		document.head.removeChild(style);

		document.body.appendChild(square_inch);
		printer_dpi = square_inch.offsetWidth;
		document.body.removeChild(square_inch);
		margin = printer_dpi * 0.75; // 3/4 inch margins
	}
	
	function debug_log() {
		return `Screen scale factor: ${screen_scale_factor}
Given content origin: ${rect.description}
Given content size: ${rect.size.description}
Kludge: ${kludge.description}
Final DPI: ${k.printer_dpi}
Final scale factor: ${scaleFactor.toFixed(4)}
Final margin: ${margin}
Final page size: ${final_page_size.description}
Final page center: ${final_page_size.center.description}
Final inset size: ${final_inset_size.description}
Final content size: ${final_content_rect.size.description}
Final content center: ${final_content_rect.center.description}
Final origin: ${final_origin.description}
`;
	}

	function layout() {
		const w = printer_page_width;
		const h = w * printer_aspect_ratio;
		isLandscape = rect.size.width > rect.size.height;
		final_page_size = new Size(
			isLandscape ? h : w,
			isLandscape ? w : h
		);
		margin = printer_dpi * 0.75; // 3/4 inch margins
		final_inset_size = final_page_size.insetEquallyBy(margin);
		scale_size = final_inset_size.dividedBy(rect.size);
		scaleFactor = Math.min(scale_size.width, scale_size.height) * screen_scale_factor;
		final_content_rect = rect.multipliedEquallyBy(scaleFactor);
		kludge = new Point(-220, -380);
		final_origin = final_page_size.center.offsetBy(rect.center.negated).offsetBy(kludge);
		log_message = debug_log();
	}
	
</script>

<div class='print-container'>
	{#if !!final_origin && !!scaleFactor}
		<div class='printable-content'
			bind:this={printable}
			style='
				transform: scale({scaleFactor});
				transform-origin: 50% 50%;
				left: {final_origin.x}px;
				top: {final_origin.y}px;
				position: absolute;
			'>
		</div>
	{/if}
	{#if !!log_message && !!final_page_size && !!final_inset_size}
		<div class='message-box'
			style='
				width: {final_inset_size.width * 1.5}px;
				top: {final_page_size.height - 100}px;
				font-size: {k.font_size.warning}px;
				background-color: transparent;
				height: {message_height}px;
				box-sizing: border-box;
				font-family: monospace;
				white-space: pre-wrap;
				border: 2px solid red;
				position: absolute;
				overflow: auto;
				padding: 8px;
				color: black;
				left: 0px;
			'>
			{log_message}
		</div>
	{/if}
</div>
```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/Coordinates.ts
```ts
import { T_Quadrant, T_Orientation } from './Angle';
import '../common/Extensions';
import Angle from './Angle';

const p = 2;

export class Polar {
	r: number;
	phi: number;
	constructor(r: number, phi: number) {
		this.r = r;
		this.phi = phi;
	}

	get asPoint(): Point { return Point.fromPolar(this.r, this.phi); }
}

export class Point {
	x: number;
	y: number;
	constructor(x: number = 0, y: number = 0) {
		this.x = x;
		this.y = y;
	}

	get magnitude():				 		 number { return Math.sqrt(this.x * this.x + this.y * this.y); }
	get isZero():					 		boolean { return this.x == 0 && this.y == 0; }
	get pixelVerbose():				 		 string { return `${this.x.toFixed(p)}px ${this.y.toFixed(p)}px`; }
	get verbose():					 		 string { return `(${this.x.toFixed(p)}, ${this.y.toFixed(p)})`; }
	get description():				 		 string { return `${this.x.toFixed(p)} ${this.y.toFixed(p)}`; }
	get asBBox():							   { minX: number; minY: number; maxX: number; maxY: number } { return { minX: this.x, minY: this.y, maxX: this.x, maxY: this.y }; }
	get asPolar():							  Polar { return new Polar(this.magnitude, this.angle); }
	get asSize():					 	 	   Size { return new Size(this.x, this.y); }		// NB: can have negative values, so rect extended by negative works
	get negated():					 		  Point { return this.multipliedEquallyBy(-1); }
	get doubled():					 		  Point { return this.multipliedEquallyBy(2); }
	get negatedInHalf():			 		  Point { return this.dividedEquallyBy(-2); }
	get dividedInHalf():			 		  Point { return this.dividedEquallyBy(2); }
	get swap():						 		  Point { return new Point(this.y, this.x); }
	get negateY():					 		  Point { return new Point(this.x, -this.y); }
	get negateX():					 		  Point { return new Point(-this.x, this.y); }
	get abs():						 		  Point { return new Point(Math.abs(this.x), Math.abs(this.y)); }
	offsetByX(x: number):			 		  Point { return this.offsetByXY(x, 0); }
	offsetByY(y: number):			 		  Point { return this.offsetByXY(0, y); }
	offsetEquallyBy(offset: number): 		  Point { return this.offsetByXY(offset, offset); }
	offsetByXY(x: number, y: number):		  Point { return new Point(this.x + x, this.y + y); }
	spreadByXY(x: number, y: number):		  Point { return new Point(this.x * x, this.y * y); }
	offsetBy(point: Point):			 		  Point { return new Point(this.x + point.x, this.y + point.y); }
	vector_to(point: Point):		 		  Point { return point.offsetBy(this.negated); }
	multiply_xBy(multiplier: number):		  Point { return new Point(this.x * multiplier, this.y) }
	multiply_yBy(multiplier: number):		  Point { return new Point(this.x, this.y * multiplier) }
	equals(other: Point):					boolean { return this.x == other.x && this.y == other.y; }
	dividedEquallyBy(divisor: number):		  Point { return new Point(this.x / divisor, this.y / divisor) }
	multipliedEquallyBy(multiplier: number):  Point { return new Point(this.x * multiplier, this.y * multiplier) }
	static fromDOMRect(rect: DOMRect):		  Point { return new Point(rect.left, rect.top); }
	static square(length: number):			  Point { return new Point(length, length); }
	static x(x: number):					  Point { return new Point(x, 0); }
	static y(y: number):					  Point { return new Point(0, y); }
	static get zero():						  Point { return new Point();}
	static fromPolar(r: number, phi: number): Point { return Point.x(r).rotate_by(phi); }

	// in this (as in math), y increases going up and angles increase counter-clockwise
	get angle(): number { return (Math.atan2(-this.y, this.x)); }	// in browsers, y is the opposite, so reverse it here

	get quadrant_ofPoint(): T_Quadrant {
		const x = this.x;
		const y = this.y;
		if		  (x >= 0 && y >= 0) { return T_Quadrant.upperRight;
		} else if (x <  0 && y >= 0) { return T_Quadrant.upperLeft;
		} else if (x <  0 && y <  0) { return T_Quadrant.lowerLeft;
		} else						 { return T_Quadrant.lowerRight;
		}
	}

	get orientation_ofVector(): T_Orientation {
		let quadrant = new Angle(this.angle).quadrant_ofAngle;
		const isFirstEighth = (this.angle).normalize_between_zeroAnd(Angle.quarter) < (Math.PI / 4);
		switch (quadrant) {
			case T_Quadrant.upperRight: return isFirstEighth ? T_Orientation.right : T_Orientation.up;
			case T_Quadrant.upperLeft:  return isFirstEighth ? T_Orientation.up	   : T_Orientation.left;
			case T_Quadrant.lowerLeft:  return isFirstEighth ? T_Orientation.left  : T_Orientation.down;
			case T_Quadrant.lowerRight: return isFirstEighth ? T_Orientation.down  : T_Orientation.right;
		}
	}

	rotate_by(angle: number): Point {
		// rotate counter-clockwise
		// angle of zero is on the x-axis pointing right
		// angle of one-half pi is on the y-axis pointing up
		// in math y increases going up,
		// so it must be reversed for browsers
		const cos = Math.cos(angle);
		const sin = Math.sin(angle);
		return new Point(
			this.x * cos + this.y * sin,
			this.y * cos - this.x * sin	// reverse y for browsers
		);
	}
	
	isContainedBy_path(path: string): boolean {
		const canvas = document.createElement('canvas');		// Create a temporary canvas element
		const context = canvas.getContext('2d');
		if (!context) {
			throw new Error('Failed to get 2D context');
		}
		canvas.width = window.innerWidth;		// Set canvas dimensions (arbitrary large values to ensure it covers the path)
		canvas.height = window.innerHeight;
		const path2D = new Path2D(path);		// Create a new Path2D object from the SVG path
		const isInside = context.isPointInPath(path2D, this.x, this.y);		// Check if the point is inside the path
		return isInside;
	}

	static origin_inWindowCoordinates_for(element: HTMLElement): Point {
		let e: HTMLElement | null = element;
		let point = Point.zero;
		while (e) {
			point = point.offsetByXY(e.offsetLeft, e.offsetTop);
			e = e.offsetParent as HTMLElement;
		}
		return point;
	}

}

export class Size {
	height: number;
	width: number;

	constructor(width: number = 0, height: number = 0) {
		this.height = height;
		this.width = width;
	}

	get proportion():					   number { return this.width / this.height; }
	get isZero():						  boolean { return this.width == 0 && this.height == 0; }
	get description():					   string { return `${this.width.toFixed(p)} ${this.height.toFixed(p)}`; }
	get verbose():						   string { return `(${this.width.toFixed(p)}, ${this.height.toFixed(p)})`; }
	get pixelVerbose():					   string { return `${this.width.toFixed(p)}px ${this.height.toFixed(p)}px`; }
	get center():						    Point { return this.asPoint.dividedInHalf; }
	get asPoint():			   			    Point { return new Point(this.width, this.height); }			// NOTE: always in lower right quadrant (increasing clockwise)
	get swap():								 Size { return new Size(this.height, this.width); }
	get negated():							 Size { return this.multipliedEquallyBy(-1); }
	get dividedInHalf():					 Size { return this.dividedEquallyBy(2); }
	reducedByXY(x: number, y: number):		 Size { return this.extendedByXY(-x, -y); }
	extendedByX(delta: number):				 Size { return this.extendedByXY(delta, 0); }
	extendedByY(delta: number):				 Size { return this.extendedByXY(0, delta); }
	reducedByX(delta: number):				 Size { return this.extendedByXY(-delta, 0); }
	reducedByY(delta: number):				 Size { return this.extendedByXY(0, -delta); }
	expandedEquallyBy(delta: number):		 Size { return this.extendedByXY(delta, delta); }
	reducedBy(srinkage: Point):				 Size { return this.extendedBy(srinkage.negated); }
	insetEquallyBy(delta: number):			 Size { return this.expandedEquallyBy(2 * -delta); }
	extendedBy(delta: Point):				 Size { return this.extendedByXY(delta.x, delta.y); }
	dividedEquallyBy(divisor: number):		 Size { return this.multipliedEquallyBy(1 / divisor); }
	extendedByXY(x: number, y: number):		 Size { return new Size(this.width + x, this.height + y); }
	multipliedEquallyBy(multiplier: number): Size { return new Size(this.width * multiplier, this.height * multiplier); }
	dividedBy(size: Size):					 Size { return new Size(this.width / size.width, this.height / size.height); }
	best_ratio_to(size: Size):			   number { return Math.min(this.width / size.width, this.height / size.height); }
	equals(other: Size):				  boolean { return this.width == other.width && this.height == other.height; }
	static fromDOMRect(rect: DOMRect):		 Size { return new Size(rect.width, rect.height); }
	static square(length: number):			 Size { return new Size(length, length); }
	static height(height: number):			 Size { return new Size(0, height); }
	static width(width: number):			 Size { return new Size(width, 0); }
	static get zero():						 Size { return new Size(); }

}

export class Rect {
	origin: Point;
	size: Size;

	constructor(origin: Point = Point.zero, size: Size = Size.zero) {
		this.origin = origin;
		this.size = size;
	}

	get x():						 number { return this.origin.x; }
	get y():						 number { return this.origin.y; }
	get right():					 number { return this.extent.x; }
	get bottom():					 number { return this.extent.y; }
	get width():					 number { return this.size.width; }
	get height():					 number { return this.size.height; }
	get isZero():					boolean { return this.size.isZero; }
	get verbose():					 string { return `${this.origin.verbose}, ${this.size.verbose}`; }
	get description():				 string { return `${this.origin.description} ${this.size.description}`; }
	get pixelVerbose():				 string { return `${this.origin.pixelVerbose} ${this.size.pixelVerbose}`; }
	get asBBox(): { minX: number; minY: number; maxX: number; maxY: number } { return { minX: this.x, minY: this.y, maxX: this.right, maxY: this.bottom }; }
	get center():					  Point { return this.origin.offsetBy(this.size.center); }
	get extent():					  Point { return this.origin.offsetBy(this.size.asPoint); }		// bottom right
	get topRight():					  Point { return new Point(this.extent.x, this.origin.y); }
	get centerTop():				  Point { return new Point(this.center.x, this.origin.y); }
	get bottomLeft():				  Point { return new Point(this.origin.x, this.extent.y); }
	get centerLeft():				  Point { return new Point(this.origin.x, this.center.y); }
	get centerRight():				  Point { return new Point(this.extent.x, this.center.y); }
	get centerBottom():				  Point { return new Point(this.center.x, this.extent.y); }
	get dividedInHalf():			   Rect { return new Rect(this.origin, this.size.multipliedEquallyBy(-1/2)); }
	get atZero_forX():				   Rect { return new Rect(Point.y(this.origin.y), this.size); }
	get atZero_forY():				   Rect { return new Rect(Point.x(this.origin.x), this.size); }
	get atZero():					   Rect { return new Rect(Point.zero, this.size); }
	set x(x: number)						{ this.origin.x = x; }
	set y(y: number)						{ this.origin.y = y; }
	set width(width: number)				{ this.size.width = width; }
	set height(height: number)				{ this.size.height = height; }

	get normalized(): Rect {			// make width and height positive
		let width = this.width;
		let height = this.height;
		if (width < 0) {
			this.size.width = -width;	// invert width
			this.origin.x -= width;		// compensate
		}
		if (height < 0) {
			this.size.height = -height;	// "
			this.origin.y -= height;	// "
		}
		return this;					// for method chaining	
	}

	equals(other: Rect):			boolean { return this.origin.equals(other.origin) && this.size.equals(other.size); }
	multipliedEquallyBy(m: number):	   Rect { return new Rect(this.origin.multipliedEquallyBy(m), this.size.multipliedEquallyBy(m)); }
	dividedEquallyBy(m: number):	   Rect { return new Rect(this.origin.dividedEquallyBy(m), this.size.dividedEquallyBy(m)); }
	centeredRect_ofSize(size: Size):   Rect { return new Rect(this.center.offsetBy(size.center.negated), size); }
	originMultipliedBy(ratio: number): Rect { return new Rect(this.origin.multipliedEquallyBy(ratio), this.size); }
	expand_sizeBy(ratio: number):	   Rect { return new Rect(this.origin, this.size.multipliedEquallyBy(ratio)); }
	expand_heightBy(height: number):   Rect { return new Rect(this.origin, this.size.extendedByY(height)); }
	multiply_xBy(ratio: number):	   Rect { return new Rect(this.origin.multiply_xBy(ratio), this.size); }
	multiply_yBy(ratio: number):	   Rect { return new Rect(this.origin.multiply_yBy(ratio), this.size); }
	extend_widthBy(width: number):	   Rect { return new Rect(this.origin, this.size.extendedByX(width)); }
	offsetByXY(x: number, y: number):  Rect { return new Rect(this.origin.offsetByXY(x, y), this.size); }
	offsetBy(delta: Point):			   Rect { return new Rect(this.origin.offsetBy(delta), this.size); }
	offsetByX(x: number):			   Rect { return new Rect(this.origin.offsetByX(x), this.size); }
	offsetByY(y: number):			   Rect { return new Rect(this.origin.offsetByY(y), this.size); }
	offsetEquallyBy(offset: number):   Rect { return this.offsetByXY(offset, offset); }
	
	expandedBy(expansion: Point): Rect {
		const size = this.size.extendedBy(expansion);
		const origin = expansion.vector_to(this.origin);
		return new Rect(origin, size)
	}

	contains(point: Point): boolean {
		const origin = this.origin;
		const extent = this.extent;
		return point.x.isBetween(origin.x, extent.x, true) && 
			   point.y.isBetween(origin.y, extent.y, true);
	}

	corners_forAngle(angle: number): [Point, Point] {
		switch (new Angle(angle).quadrant_ofAngle) {
			case T_Quadrant.lowerRight: return [this.bottomLeft, this.topRight];
			case T_Quadrant.upperLeft:  return [this.topRight, this.bottomLeft];
			case T_Quadrant.lowerLeft:  return [this.extent, this.origin];
			default:					return [this.origin, this.extent];
		}
	}

	intersects(rect: Rect): boolean {
		// handle zero-width/height cases by using origin instead of extent
		// for a zero dimension, treat the rectangle as a line by using the origin point
        const thisExtentX = this.size.width  === 0 ? this.origin.x : this.extent.x;
        const thisExtentY = this.size.height === 0 ? this.origin.y : this.extent.y;
        const rectExtentX = rect.size.width  === 0 ? rect.origin.x : rect.extent.x;
        const rectExtentY = rect.size.height === 0 ? rect.origin.y : rect.extent.y;

		// check for non-intersection using the separating axis theorem
		// two rectangles do NOT intersect if:
		// - the left edge of one is right of the right edge of the other OR
		// - the top edge of one is below the bottom edge of the other
        return !(this.origin.x > rectExtentX || 
				 this.origin.y > rectExtentY ||
                 rect.origin.x > thisExtentX || 
                 rect.origin.y > thisExtentY);
    }

	clippedTo(bounds: Rect): Rect {
		// Clip this rect to the bounds, returning the intersection
		// If no intersection, returns a zero-sized rect at the clipped origin
		const clippedLeft = Math.max(this.origin.x, bounds.origin.x);
		const clippedTop = Math.max(this.origin.y, bounds.origin.y);
		const clippedRight = Math.min(this.extent.x, bounds.extent.x);
		const clippedBottom = Math.min(this.extent.y, bounds.extent.y);
		
		const clippedWidth = Math.max(0, clippedRight - clippedLeft);
		const clippedHeight = Math.max(0, clippedBottom - clippedTop);
		
		return new Rect(new Point(clippedLeft, clippedTop), new Size(clippedWidth, clippedHeight));
	}

	static createSizeRect(size: Size): Rect { return new Rect(Point.zero, size); }
	static get zero():				   Rect { return new Rect(Point.zero, Size.zero); }

	static createWHRect(width: number, height: number): Rect {
		return new Rect(Point.zero, new Size(width, height));
	}
	
	static createExtentRect(origin: Point, extent: Point): Rect {
		return new Rect(origin, origin.vector_to(extent).asSize);
	}

	static createRightCenterRect(rightCenter: Point, size: Size): Rect {
		return new Rect(rightCenter.offsetByY(size.height / -2), size);
	}

	static createCenterRect(center: Point, size: Size): Rect {
		const toOrigin = size.center.negated;
		const origin = center.offsetBy(toOrigin);
		return new Rect(origin, size);
	}

	static createFromDOMRect(domRect: DOMRect | null) {
		if (!domRect) {
			return null;
		}
		const origin = new Point(domRect.x, domRect.y).offsetByXY(window.scrollX, window.scrollY);
		return new Rect(origin, new Size(domRect.width, domRect.height));
	}

	static rect_forElement(element: HTMLElement | null): Rect | null {
		if (!element) {
			return null;
		}
		const domRect = element.getBoundingClientRect();
		const origin = Point.fromDOMRect(domRect);
		const size = Size.fromDOMRect(domRect);
		return new Rect(origin, size);
	}

	// static rect_forComponent(c: SvelteComponent): Rect {
	// 	const top = c['offsetTop'];
	// 	const left = c['offsetLeft'];
	// 	const width = c['offsetWidth'];
	// 	const height = c['offsetHeight'];
	// 	if ((!!top || top == 0) && (!!left || left == 0) && !!width && !!height) {
	// 		return new Rect(new Point(left, top), new Size(width, height));
	// 	}
	// 	return Rect.zero;
	// }

}

export class Point3 {
	x: number;
	y: number;
	z: number;

	constructor(x: number = 0, y: number = 0, z: number = 0) {
		this.x = x;
		this.y = y;
		this.z = z;
	}

	get magnitude():					 number { return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z); }
	get isZero():						boolean { return this.x == 0 && this.y == 0 && this.z == 0; }
	get verbose():						 string { return `(${this.x.toFixed(p)}, ${this.y.toFixed(p)}, ${this.z.toFixed(p)})`; }
	get description():					 string { return `${this.x.toFixed(p)} ${this.y.toFixed(p)} ${this.z.toFixed(p)}`; }
	get negated():						 Point3 { return this.multiplied_equally_by(-1); }
	get doubled():						 Point3 { return this.multiplied_equally_by(2); }
	get divided_in_half():				 Point3 { return this.divided_equally_by(2); }
	get abs():							 Point3 { return new Point3(Math.abs(this.x), Math.abs(this.y), Math.abs(this.z)); }
	get xy():							  Point { return new Point(this.x, this.y); }
	get xz():							  Point { return new Point(this.x, this.z); }
	get yz():							  Point { return new Point(this.y, this.z); }
	get as_size3():						  Size3 { return new Size3(this.x, this.y, this.z); }
	offset_by_x(x: number):				 Point3 { return this.offset_by_xyz(x, 0, 0); }
	offset_by_y(y: number):				 Point3 { return this.offset_by_xyz(0, y, 0); }
	offset_by_z(z: number):				 Point3 { return this.offset_by_xyz(0, 0, z); }
	offset_equally_by(offset: number):	 Point3 { return this.offset_by_xyz(offset, offset, offset); }
	offset_by_xyz(x: number, y: number, z: number): Point3 { return new Point3(this.x + x, this.y + y, this.z + z); }
	offset_by(point: Point3):			 Point3 { return new Point3(this.x + point.x, this.y + point.y, this.z + point.z); }
	vector_to(point: Point3):			 Point3 { return point.offset_by(this.negated); }
	equals(other: Point3):			    boolean { return this.x == other.x && this.y == other.y && this.z == other.z; }
	divided_equally_by(divisor: number): Point3 { return new Point3(this.x / divisor, this.y / divisor, this.z / divisor); }
	multiplied_equally_by(m: number):	 Point3 { return new Point3(this.x * m, this.y * m, this.z * m); }
	dot(other: Point3):					 number { return this.x * other.x + this.y * other.y + this.z * other.z; }

	cross(other: Point3): Point3 {
		return new Point3(
			this.y * other.z - this.z * other.y,
			this.z * other.x - this.x * other.z,
			this.x * other.y - this.y * other.x
		);
	}

	get normalized(): Point3 {
		const m = this.magnitude;
		if (m == 0) return Point3.zero;
		return this.divided_equally_by(m);
	}

	static cube(length: number):		  Point3 { return new Point3(length, length, length); }
	static x(x: number):				  Point3 { return new Point3(x, 0, 0); }
	static y(y: number):				  Point3 { return new Point3(0, y, 0); }
	static z(z: number):				  Point3 { return new Point3(0, 0, z); }
	static get zero():					  Point3 { return new Point3(); }
}

export class Size3 {
	width: number;
	height: number;
	depth: number;

	constructor(width: number = 0, height: number = 0, depth: number = 0) {
		this.width = width;
		this.height = height;
		this.depth = depth;
	}

	get isZero():						boolean { return this.width == 0 && this.height == 0 && this.depth == 0; }
	get verbose():						 string { return `(${this.width.toFixed(p)}, ${this.height.toFixed(p)}, ${this.depth.toFixed(p)})`; }
	get description():					 string { return `${this.width.toFixed(p)} ${this.height.toFixed(p)} ${this.depth.toFixed(p)}`; }
	get center():						 Point3 { return this.as_point3.divided_in_half; }
	get as_point3():					 Point3 { return new Point3(this.width, this.height, this.depth); }
	get negated():						  Size3 { return this.multiplied_equally_by(-1); }
	get divided_in_half():				  Size3 { return this.divided_equally_by(2); }
	extended_by(delta: Point3):			  Size3 { return new Size3(this.width + delta.x, this.height + delta.y, this.depth + delta.z); }
	divided_equally_by(divisor: number):  Size3 { return this.multiplied_equally_by(1 / divisor); }
	multiplied_equally_by(m: number):	  Size3 { return new Size3(this.width * m, this.height * m, this.depth * m); }
	equals(other: Size3):				boolean { return this.width == other.width && this.height == other.height && this.depth == other.depth; }
	static cube(length: number):		  Size3 { return new Size3(length, length, length); }
	static get zero():					  Size3 { return new Size3(); }
}

export class Block {
	origin: Point3;
	size: Size3;

	constructor(origin: Point3 = Point3.zero, size: Size3 = Size3.zero) {
		this.origin = origin;
		this.size = size;
	}

	get x():							 number { return this.origin.x; }
	get y():							 number { return this.origin.y; }
	get z():							 number { return this.origin.z; }
	get width():						 number { return this.size.width; }
	get height():						 number { return this.size.height; }
	get depth():						 number { return this.size.depth; }
	get extent():						 Point3 { return this.origin.offset_by(this.size.as_point3); }
	get center():						 Point3 { return this.origin.offset_by(this.size.center); }
	get isZero():					    boolean { return this.size.isZero; }
	get verbose():						 string { return `${this.origin.verbose}, ${this.size.verbose}`; }
	get description():					 string { return `${this.origin.description} ${this.size.description}`; }
	get at_zero():						  Block { return new Block(Point3.zero, this.size); }
	offset_by(delta: Point3):			  Block { return new Block(this.origin.offset_by(delta), this.size); }
	equals(other: Block):				boolean { return this.origin.equals(other.origin) && this.size.equals(other.size); }
	multiplied_equally_by(m: number):	  Block { return new Block(this.origin.multiplied_equally_by(m), this.size.multiplied_equally_by(m)); }
	divided_equally_by(m: number):		  Block { return new Block(this.origin.divided_equally_by(m), this.size.divided_equally_by(m)); }

	contains(point: Point3): boolean {
		const ext = this.extent;
		return point.x >= this.origin.x && point.x <= ext.x &&
			   point.y >= this.origin.y && point.y <= ext.y &&
			   point.z >= this.origin.z && point.z <= ext.z;
	}

	intersects(block: Block): boolean {
		const this_ext = this.extent;
		const block_ext = block.extent;
		return !(this.origin.x > block_ext.x || this.origin.y > block_ext.y || this.origin.z > block_ext.z ||
				 block.origin.x > this_ext.x || block.origin.y > this_ext.y || block.origin.z > this_ext.z);
	}

	static create_center_block(center: Point3, size: Size3): Block {
		const origin = center.offset_by(size.center.negated);
		return new Block(origin, size);
	}

	static get zero(): Block { return new Block(Point3.zero, Size3.zero); }
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/Types.ts
```ts
import type { SignalConnection } from 'typed-signals';
import { T_Signal } from './Enumerations';
import S_Mouse from '../state/S_Mouse';	

export type Dictionary<T = any> = Record<string, T>;
export type T_Preview_Type = 'image' | 'text' | null;
export type Integer = number & { __brand: 'integer' };
export type Handle_Result<T = Object, U = void> = (result: T) => U;
export type Handle_S_Mouse = Handle_Result<S_Mouse, boolean>;
export type Async_Handle_Boolean = (flag: boolean) => Promise<void>;
export type Signal_Handler = (t_signal: T_Signal, value: any | null) => any;
export type Create_S_Mouse = (event: MouseEvent | null, element: HTMLElement) => S_Mouse;
export type Signal_Signature = (t_signal: T_Signal, priority: number, value: any) => void;
export type SignalConnection_atPriority = { t_signal: T_Signal, priority: number, connection: SignalConnection | null };

```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/Enumerations.ts
```ts
// DO NOT change the order of the following

export enum T_Order {	// need two orders, so .... ???
	child,
	other,
}

export enum T_Banner {
	controls,
	graph,
	crumbs,
}

export enum T_Startup {
	start,
	fetch,
	empty,
	ready,
}

export enum T_Search {
	off,
	enter,
	results,
	selected,
}

export enum T_Detail {
	header,
	actions,
	selection,
	tags,
	traits,
	preferences,
	data,
}

export enum T_Action {
	browse,
	focus,
	show,
	center,
	add,
	delete,
	move,
}

export enum T_Layer {
	common,
	graph,
	paging,
	ring,
	necklace,
	line,
	widget,
	dot,
	text,
	details,
	stackable,
	action,
	hideable,
	rubberband,
	frontmost,
}

// the order of the following is unimportant

export enum T_Graph {
	radial = 'radial',
	tree   = 'tree',
}

export enum T_Direction {
	previous = '<',
	next	 = '>',
}

export enum T_Alteration {
	delete = 'delete',
	add	   = 'add',
}

export enum T_File_Operation {
	import = 'import',	// persist
	export = 'export',	// fetch
}

export enum T_Theme {
	standalone = 'standalone',
	bubble	   = 'bubble',
}

export enum T_Counts_Shown {
	numbers = 'numbers',
	hidden  = 'hidden',
	dots    = 'dots',
}

export enum T_Auto_Adjust_Graph {
	selection = 'center the selection',
	fit		  = 'exactly fit',
	ignore	  = 'ignore',
}

export enum T_Button_SVG {
	triangle = 'triangle',
	arrow	 = 'arrow',
	none	 = 'none',
}

export enum T_Search_Preference {
	title = 'title',
	trait = 'trait',
	tags  = 'tags',
}

export enum T_Widget {
	radial = 'radial',
	focus  = 'focus',
	tree   = 'tree',
}

export enum T_Tree_Line {
	flat = 'flat',
	down = 'down',
	up	 = 'up',
}

export enum T_Create {
	isFromPersistent = 'isFrom',
	getPersistentID	 = 'getID',
	none			 = '',
}

export enum T_Storage_Need {
	direction = 'direction',
	format	  = 'format',
	busy	  = 'busy',
}

export enum T_Persistence {
	remote = 'remote',
	local  = 'local',
	none   = 'none',
}

export enum T_Kinship {
	children = 'children',
	related  = 'related',
	parents  = 'parents',
}

export enum T_Drag {
	rubberband = 'rubberband',	// selecting widgets
	widget	   = 'widget',		// drag and drop
	graph	   = 'graph',		// repositioning the graph
	none	   = 'none',
}

export enum T_Radial_Zone {
	resize = 'resize',
	paging = 'paging',
	rotate = 'rotate',
	miss   = 'miss',
}

export enum T_Oblong {
	middle = 'middle',
	right  = 'right',
	left   = 'left',
	full   = 'full',
}

export enum T_Mouse_Detection {
	autorepeat = 4,
	doubleLong = 3,
	double	   = 1,
	long	   = 2,
	none	   = 0,
}

export enum T_Request {
	handle_s_mouse = 'handle_s_mouse',
	is_disabled	   = 'is_disabled',
	is_inverted	   = 'is_inverted',
	is_visible	   = 'is_visible',
	is_hit		   = 'is_hit',
	name		   = 'name',
}

export enum T_Signal {
	alteration	 = 'alteration',
	reposition	 = 'reposition',	// only for widgets
	reattach	 = 'reattach',
	rebuild		 = 'rebuild',
	thing		 = 'thing',
}

export enum T_Persistable {
	relationships = 'Relationships',
	predicates	  = 'Predicates',
	things		  = 'Things',
	traits		  = 'Traits',
	access		  = 'Access',
	users		  = 'Users',
	tags		  = 'Tags',
}

export enum T_Predicate {
	appreciates = 'appreciates',
	explainedBy	= 'explainedBy',
	supportedBy	= 'supportedBy',
	alliedWith	= 'alliedWith',		// steve melville's term
	isRelated	= 'isRelated',
	contains	= 'contains',
	isTagged	= 'isTagged',		// trying this out...
	requires	= 'requires',
}

export enum T_Control {
	details	 = 'show details view',
	builds	 = 'show build notes',
	preview	 = 'preview',
	recents	 = 'recents',
	import	 = 'import',
	search	 = 'search',
	shrink	 = 'shrink',
	grow	 = 'grow',
	help	 = '?',
}

export enum T_Browser  {
	explorer = 'explorer',
	unknown  = 'unknown',
	firefox	 = 'firefox',
	chrome	 = 'chrome',
	safari	 = 'safari',
	opera	 = 'opera',
	orion	 = 'orion',
}

export enum T_File_Extension {
	seriously = 'seriously',
	cancel	  = 'cancel',
	json	  = 'json',
	csv		  = 'csv',
}

export enum T_Image_Extension {
	jpeg   = 'jpeg',
	webp   = 'webp',
	jpg    = 'jpg',
	gif    = 'gif',
	png    = 'png',
	svg    = 'svg',
}

export enum T_Text_Extension {
	svelte = 'svelte',
	html   = 'html',
	json   = 'json',
	css    = 'css',
	csv    = 'csv',
	txt    = 'txt',
	js     = 'js',
	md     = 'md',
	sh     = 'sh',
	ts     = 'ts',
}

export enum T_Thing {
	organization = 'o',
	externals	 = '^',	// list of bulks
	bookmark	 = 'b',
	generic		 = '-',
	person		 = 'p',
	folder		 = 'f',
	found		 = '?',
	root		 = '!',
	bulk		 = '~',
	meme		 = '*',
}

export enum T_Trait {
	consequence = 'consequence',
	location	= 'location',
	citation	= 'citation',
	comment		= 'comment',
	money		= 'money',
	phone		= 'phone',
	quest		= 'quest',
	text		= 'text',
	date		= 'date',
	link		= 'link',
	note		= 'note',
	sum			= 'sum',
}

export enum T_Hit_Target {
	breadcrumbs	= 'breadcrumbs',
	rubberband	= 'rubberband',
	database	= 'database',
	resizing	= 'resizing',
	rotation	= 'rotation',
	details		= 'details',
	control		= 'control',
	action		= 'action',
	button		= 'button',
	cancel		= 'cancel',
	paging		= 'paging',
	reveal		= 'reveal',
	search		= 'search',
	widget		= 'widget',
	title		= 'title',
	trait		= 'trait',
	drag		= 'drag',
	glow		= 'glow',
	line		= 'line',
	none		= 'none',
	tag			= 'tag',
}

export enum T_Preference {
	expanded_children = 'expanded_children',
	focus_forChildren = 'focus_forChildren',
	expanded_parents  = 'expanded_parents',
	focus_forParents  = 'focus_forParents',
	other_databases	  = 'other_databases',
	cluster_sliders	  = 'cluster_sliders',
	show_countsAs	  = 'show_countsAs',
	relationships	  = 'relationships',
	detail_types	  = 'detail_types',			// shown in details view, vertical stack
	show_details	  = 'show_details',			// left side
	show_related	  = 'show_related',
	ring_radius		  = 'ring_radius',
	user_offset		  = 'user_offset',
	auto_adjust		  = 'auto_adjust',
	breadcrumbs		  = 'breadcrumbs',
	search_text		  = 'search_text',
	background		  = 'background',
	ring_angle  	  = 'ring_angle',
	auto_save		  = 'auto_save',
	countDots		  = 'countDots',
	font_size		  = 'font_size',
	separator		  = 'separator',
	base_id			  = 'base_id',
	details			  = 'details',				// visible details control
	grabbed			  = 'grabbed',
	bubble 			  = 'bubble',
	levels			  = 'levels',
	paging 			  = 'paging',
	search 			  = 'search',
	traits			  = 'traits',
	graph			  = 'graph',
	scale			  = 'scale',
	focus			  = 'focus',
	local			  = 'local',
	thing	    	  = 'thing',
	font			  = 'font',
	tree			  = 'tree',
	db				  = 'db',
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/Angle.ts
```ts
export enum T_Quadrant {
	upperRight = 'ur',	// 				0 ... quarter
	upperLeft  = 'ul',	//		  quarter ... half
	lowerLeft  = 'll',	//			 half ... three_quarters
	lowerRight = 'lr',	// three_quarters ... full
}

export enum T_Orientation {
	right = 'right',
	left  = 'left',
	down  = 'down',
	up    = 'up',
}

export default class Angle {
	angle: number;								// angles begin at 3 o'clock & rotate up (counter-clockwise)

	constructor(angle: number) {
		this.angle = angle;
	}

	static zero = 0;							// far right (3 o'clock)
	static full = Math.PI * 2;					// same as (normalizes to) zero
	static half = Angle.full / 2;				// far left (9 o'clock)
	static quarter = Angle.full / 4;			// zenith (12 o'clock)
	static three_quarters = Angle.quarter * 3;	// nadir (6 o'clock)
	static sixteenth = Angle.full / 16;			// support octants
	static eighth = Angle.full / 8;

	static radians_from_degrees(degrees: number):	   number { return Math.PI / 180 * degrees; }

	static angle_from_name(name: string): number | null {
		switch (name) {
			case 'up':				return -Math.PI / 2;
			case 'down':			return Math.PI / 2;
			case 'right': case '>': return Math.PI;
			case 'left':  case '<': return 0;
		}
		return null;
	}

	static orientation_from_name(name: string): T_Orientation | null {
		switch (name) {
			case 'up':				return T_Orientation.up;
			case 'down':			return T_Orientation.down;
			case 'right': case '>': return T_Orientation.right;
			case 'left':  case '<': return T_Orientation.left;
		}
		return null;
	}

	get angle_points_down(): boolean { return this.orientation_ofAngle == T_Orientation.down; }

	get quadrant_basis_angle(): number {
		switch (this.quadrant_ofAngle) {
			case T_Quadrant.upperRight: return 0;
			case T_Quadrant.upperLeft:  return Angle.quarter;
			case T_Quadrant.lowerLeft:  return Angle.half;
			case T_Quadrant.lowerRight: return Angle.three_quarters;
		}
	}

	get angle_slants_forward(): boolean {
		const quadrant = this.quadrant_ofAngle;
		return [T_Quadrant.lowerRight, T_Quadrant.upperLeft].includes(quadrant);
	}

	get angle_points_right(): boolean {
		switch(this.quadrant_ofAngle) {
			case T_Quadrant.lowerRight: return true;
			case T_Quadrant.upperRight: return true;
			default: return false;
		}
	}

	get angle_points_up(): boolean {
		switch(this.quadrant_ofAngle) {
			case T_Quadrant.upperLeft: return true;
			case T_Quadrant.upperRight: return true;
			default: return false;
		}
	}

	get orientation_ofAngle(): T_Orientation {
		let quadrant = this.quadrant_ofAngle;
		const normalized = this.angle.angle_normalized();
		const quadrantStart = this.quadrant_basis_angle;
		const offsetInQuadrant = (normalized - quadrantStart).angle_normalized();
		const isFirstHalf = offsetInQuadrant < (Angle.quarter / 2);
		switch (quadrant) {		// going counter-clockwise
			case T_Quadrant.upperRight: return isFirstHalf ? T_Orientation.right : T_Orientation.up;
			case T_Quadrant.upperLeft:  return isFirstHalf ? T_Orientation.up    : T_Orientation.left;
			case T_Quadrant.lowerLeft:  return isFirstHalf ? T_Orientation.left  : T_Orientation.down;
			case T_Quadrant.lowerRight: return isFirstHalf ? T_Orientation.down  : T_Orientation.right;
		}
	}

	get quadrant_ofAngle(): T_Quadrant {
	
		// angles begin at 3 o'clock & rotate up (counter-clockwise)
		// ending in lowerRight quadrant (this is also the default)
	
		const normalized = this.angle.angle_normalized();
		let quadrant = T_Quadrant.lowerRight;
		if (normalized.isBetween(0,				Angle.quarter,		  true)) { quadrant = T_Quadrant.upperRight; }
		if (normalized.isBetween(Angle.quarter, Angle.half,			  true)) { quadrant = T_Quadrant.upperLeft; }
		if (normalized.isBetween(Angle.half,	Angle.three_quarters, true)) { quadrant = T_Quadrant.lowerLeft; }
		return quadrant;
	}

	get octant_ofAngle(): number {
		const normalized = this.angle.angle_normalized();
		let test_angle = Angle.sixteenth;
		for (let i = 0; i < 8; i++) {
			if (normalized < test_angle) {
				return i;
			}
			test_angle += Angle.eighth;
		}
		return 0;
	}

	get cursor_forAngle(): string {
		if (this.angle !== undefined && this.angle !== null) {
			const octant = this.octant_ofAngle;
			switch (octant % 4) {
				case 0: return 'ns-resize';
				case 1: return 'nwse-resize';
				case 2: return 'ew-resize';
				case 3: return 'nesw-resize';
			}
		}
		return '';
	}

}

export enum Direction {
	up = Angle.three_quarters,
	down = Angle.quarter,
	right = Angle.half,
	left = Angle.zero,
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/index.ts
```ts
export * from './Angle';
export * from './Coordinates';
export * from './Enumerations';
export * from './Interfaces';
```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/Attribute.ts
```ts
export default class Attribute {
	value: number;
	name: string;

	constructor(name: string = '', value: number) {
		this.name = name;
		this.value = value;
	}
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/types/Interfaces.ts
```ts
import type { quat, vec3 } from 'gl-matrix';
import type { Point3 } from './Coordinates';

// Projected stays here (not in Coordinates.ts) because it's a pipeline-specific
// output structure, not a reusable geometry primitive. The `w` field is for
// clip-space culling, not general math.

export interface Projected {
  x: number;
  y: number;
  z: number;
  w: number;
}

export interface O_Scene {
  id: string;
  vertices: Point3[];
  edges: [number, number][];
  orientation: quat;
  position: vec3;
  scale: number;
  color: string;
  parent?: O_Scene;
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/signals/Mouse_Timer.ts
```ts
import k from '../common/Constants';

export enum T_Timer {
	repeat	= 'repeat',
	double	= 'double',
	alter	= 'alter',
	long	= 'long',
}

export default class Mouse_Timer {
	autorepeat_start_timer: null | number | NodeJS.Timeout = null;
	doubleClick_timer: null | number | NodeJS.Timeout = null;
	autorepeat_timer: null | number | NodeJS.Timeout = null;
	alteration_timer: null | number | NodeJS.Timeout = null;
	longClick_timer: null | number | NodeJS.Timeout = null;
	timer_ID: number = Mouse_Timer.get_next_ID();
	static debug_ID: number = 0;
	autorepeat_ID: number = -1;
	name = k.empty;

	constructor(name: string = k.empty) { this.name = name; }
	static get_next_ID(): number { return Mouse_Timer.debug_ID++; }
	isAutorepeating_forID(id: number): boolean { return this.autorepeat_ID === id; }

	hasTimer_forID(type: T_Timer): boolean {
		switch (type) {
			case T_Timer.double: return !!this.doubleClick_timer;
			case T_Timer.repeat: return !!this.autorepeat_timer;
			case T_Timer.alter: return !!this.alteration_timer;
			case T_Timer.long: return !!this.longClick_timer;
		}
	}

	autorepeat_start(id: number, callback: () => void) {
		this.autorepeat_stop();
		this.autorepeat_ID = id;
		callback();
		this.autorepeat_start_timer = setTimeout(() => {
			this.autorepeat_timer = setInterval(callback, k.threshold.autorepeat);
			this.autorepeat_start_timer = null;
		}, k.threshold.long_click);
	}

	autorepeat_stop() {
		if (this.autorepeat_start_timer) {
			clearTimeout(this.autorepeat_start_timer);
			this.autorepeat_start_timer = null;
		}
		if (this.autorepeat_timer) {
			clearInterval(this.autorepeat_timer);
			this.autorepeat_timer = null;
		}
		this.autorepeat_ID = -1;
	}

	alteration_start(callback: (invert: boolean) => void) {
		this.alteration_stop();
		let invert = true;
		this.alteration_timer = setInterval(() => {
			callback(invert);
			invert = !invert;
		}, k.threshold.alteration);
	}

	alteration_stop() {
		if (this.alteration_timer) {
			clearInterval(this.alteration_timer);
			this.alteration_timer = null;
		}
	}
	
	timeout_start(type: T_Timer, callback: (args: void) => void, force_reset: boolean = false) {
		if (type == T_Timer.long) {
			if (force_reset && !!this.longClick_timer) {
				clearTimeout(this.longClick_timer);
				this.longClick_timer = null;
			}
			if (!this.longClick_timer) {
				this.longClick_timer = setTimeout(() => {
					this.longClick_timer = null;
					callback();
				}, k.threshold.long_click);
			}
		} else if (type == T_Timer.double) {
			if (force_reset && !!this.doubleClick_timer) {
				clearTimeout(this.doubleClick_timer);
				this.doubleClick_timer = null;
			}
			if (!this.doubleClick_timer) {
				this.doubleClick_timer = setTimeout(() => {
					this.doubleClick_timer = null;
					callback();
				}, k.threshold.double_click);
			}
		}
	}

	reset() {
		if (!!this.doubleClick_timer) {
			clearTimeout(this.doubleClick_timer);
			this.doubleClick_timer = null;
		}
		if (!!this.longClick_timer)  {
			clearTimeout(this.longClick_timer);
			this.longClick_timer = null;
		}
		this.alteration_stop();
		this.autorepeat_stop();
	}

}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/signals/Events.ts
```ts
import { Point } from '../types/Coordinates';
import S_Mouse from '../state/S_Mouse';
import { hits } from '../managers/Hits';
import type { Dictionary } from '../types/Types';
import { writable, get } from 'svelte/store';
import Mouse_Timer from './Mouse_Timer';

export class Events {
	throttle_timers: Dictionary<ReturnType<typeof setTimeout> | null> = {};
	mouse_timer_dict_byName: Dictionary<Mouse_Timer> = {};

	w_count_mouse_down		= writable<number>(0);
	w_count_mouse_up		= writable<number>(0);
	w_mouse_button_down		= writable<boolean>(false);
	w_scaled_movement		= writable<Point | null>(null);
	w_mouse_location		= writable<Point>();

	// ===== UTILITIES =====

	mouse_timer_forName(name: string): Mouse_Timer {
		if (!this.mouse_timer_dict_byName[name]) {
			this.mouse_timer_dict_byName[name] = new Mouse_Timer(name);
		}
		return this.mouse_timer_dict_byName[name];
	}

	throttle(key: string, defer_for: number = 50, callback: () => void): void {
		if (!this.throttle_timers[key]) {
			callback();
			this.throttle_timers[key] = setTimeout(() => {
				this.throttle_timers[key] = null;
			}, defer_for);
		}
	}

	// ===== SETUP =====

	setup() {
		this.subscribeTo_events();
	}

	private subscribeTo_events() {
		document.addEventListener('mouseup', this.handle_mouse_up, { passive: false });
		document.addEventListener('mousedown', this.handle_mouse_down, { passive: false });
		document.addEventListener('mousemove', this.handle_mouse_move, { passive: false });
		document.addEventListener('mouseleave', this.handle_mouse_leave, { passive: false });
	}

	// ===== EVENT HANDLERS =====

	private handle_mouse_down = (event: MouseEvent) => {
		const location = new Point(event.clientX, event.clientY);
		hits.handle_s_mouse_at(location, S_Mouse.down(event, null));
		hits.disable_hover = true;
		this.w_count_mouse_down.update(n => n + 1);
		this.w_scaled_movement.set(Point.zero);
		this.w_mouse_button_down.set(true);
	}

	private handle_mouse_up = (event: MouseEvent) => {
		const location = new Point(event.clientX, event.clientY);
		hits.handle_s_mouse_at(location, S_Mouse.up(event, null));
		hits.disable_hover = false;
		this.w_scaled_movement.set(null);
		this.w_count_mouse_up.update(n => n + 1);
		this.w_mouse_button_down.set(false);
	}

	private handle_mouse_move = (event: MouseEvent) => {
		const location = new Point(event.clientX, event.clientY);
		const prior = get(this.w_mouse_location);
		const delta = prior?.vector_to(location) ?? null;
		if (!!delta && delta.magnitude > 1) {
			this.w_scaled_movement.set(delta);
		}
		this.w_mouse_location.set(location);
		hits.handle_mouse_movement_at(location);
	}

	private handle_mouse_leave = (_event: MouseEvent) => {
		// Clear hover when mouse leaves the document
		hits.clear_hover();
	}

}

export const e = new Events();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/managers/Hits.ts
```ts
import { T_Drag, T_Hit_Target } from '../types/Enumerations';
import Mouse_Timer, { T_Timer } from '../signals/Mouse_Timer';
import S_Hit_Target, { setHitsManager } from '../state/S_Hit_Target';
import type { Dictionary } from '../types/Types';
import { Point } from '../types/Coordinates';
import S_Mouse from '../state/S_Mouse';
import { writable, get } from 'svelte/store';
import RBush from 'rbush';

type Target_RBRect = {
	minX: number;
	minY: number;
	maxX: number;	
	maxY: number;	
	target: S_Hit_Target;
}

export default class Hits {
	disable_hover = false;
	longClick_fired: boolean = false;
	doubleClick_fired: boolean = false;
	rbush = new RBush<Target_RBRect>();
	targets_dict_byID: Dictionary<S_Hit_Target> = {};
	pending_singleClick_event: MouseEvent | null = null;
	pending_singleClick_target: S_Hit_Target | null = null;
	click_timer: Mouse_Timer = new Mouse_Timer('hits-click');
	targets_dict_byType: Dictionary<Array<S_Hit_Target>> = {};
	autorepeat_timer: Mouse_Timer = new Mouse_Timer('hits-autorepeat');
	
	w_s_hover	 = writable<S_Hit_Target | null>(null);
	w_longClick	 = writable<S_Hit_Target | null>(null);
	w_autorepeat = writable<S_Hit_Target | null>(null);
	w_dragging	 = writable<T_Drag>(T_Drag.none);

	constructor() {
		// Wire up the circular dependency
		setHitsManager(this);
	}

	get isHovering(): boolean { return get(this.w_s_hover) != null; }
	get hovering_type(): T_Hit_Target | null { return get(this.w_s_hover)?.type ?? null; }

	// ===== HOVER =====

	private detect_hovering_at(point: Point) {
		if (this.disable_hover) {
			return false;
		}
		const matches = this.targets_atPoint(point);
		const match = this.targetOf_highest_precedence(matches);
		this.set_asHovering(match);
		return !!match;
	}

	// ===== CLICKS =====

	handle_s_mouse_at(point: Point, s_mouse: S_Mouse): boolean {
		const matches = this.targets_atPoint(point);
		const target = this.targetOf_highest_precedence(matches) ?? matches[0];
		if (!!s_mouse.event && !!target) {
			if (s_mouse.isDown && s_mouse.event) {
				target.clicks += 1;
				if (target.respondsTo_autorepeat) {
					target.handle_s_mouse?.(s_mouse);
					this.start_autorepeat(target);
				} else if (target.respondsTo_longClick) {
					this.start_longClick(target, s_mouse.event);
				} else if (target.respondsTo_doubleClick) {
					if (target.clicks == 2) {
						target.clicks = 0;
						this.click_timer.reset();
						this.doubleClick_fired = true;
						this.pending_singleClick_event = null;
						this.pending_singleClick_target = null;
						target.doubleClick_callback!(S_Mouse.double(s_mouse.event, target.html_element));
					} else if (target.clicks == 1) {
						this.start_doubleClick_timer(target, s_mouse.event);
					}
				} else {
					target.handle_s_mouse?.(s_mouse);
				}
			} else if (s_mouse.isUp) {
				this.cancel_longClick();
				this.stop_autorepeat();
				if (this.longClick_fired || this.doubleClick_fired) {
					this.doubleClick_fired = false;
					this.longClick_fired = false;
					target.clicks = 0;
				} else {
					const waitingForDoubleClick = target.respondsTo_doubleClick && 
						this.click_timer.hasTimer_forID(T_Timer.double) && 
						this.pending_singleClick_target === target;
					if (!waitingForDoubleClick) {
						target.clicks = 0;
						return target.handle_s_mouse?.(s_mouse) ?? false;
					}
				}
			}
		}
		return true;
	}

	// ===== MOVEMENT =====

	handle_mouse_movement_at(point: Point) {
		if (get(this.w_dragging) === T_Drag.none) {
			this.detect_hovering_at(point);
		}
	}

	clear_hover() {
		this.w_s_hover.set(null);
	}

	// ===== GENERAL =====

	reset() {
		this.rbush.clear();
		this.stop_autorepeat();
		this.cancel_longClick();
		this.w_s_hover.set(null);
		this.cancel_doubleClick();
		this.targets_dict_byID = {};
		this.longClick_fired = false;
		this.targets_dict_byType = {};
	}

	recalibrate() {
		const bush = new RBush<Target_RBRect>();
		for (const target of [...this.targets]) {
			target.update_rect();
			const rect = target.rect;
			if (!!rect) {
				this.insert_into_rbush(target, bush);
			}
		}
		this.rbush = bush;
	}

	// ===== ADD AND REMOVE =====

	add_hit_target(target: S_Hit_Target) {
		const id = target.id;
		const type = target.type;
		if (!this.targets_dict_byType[type]) {
			this.targets_dict_byType[type] = [];
		} else {
			const existing = this.targets_dict_byType[type].find(t => t.id == id);
			if (!!existing) {
				this.delete_hit_target(existing);
			}
		}
		this.targets_dict_byID[id] = target;
		this.targets_dict_byType[type].push(target);
		this.insert_into_rbush(target, this.rbush);
	}

	delete_hit_target(target: S_Hit_Target) {
		if (!!target && !!target.rect) {
			const id = target.id;
			if (!!id) {
				delete this.targets_dict_byID[id];
			}
			const type = target.type;
			const byType = this.targets_dict_byType[type];
			if (byType) {
				const index = byType.indexOf(target);
				if (index !== -1) {
					byType.splice(index, 1);
				}
			}
			this.remove_from_rbush(target, this.rbush);
		}
	}

	// ===== INTERNALS =====

	private get targets(): Array<S_Hit_Target> {
		return this.rbush.all().map(rbRect => rbRect.target);
	}

	private targets_atPoint(point: Point): Array<S_Hit_Target> {
		const targets = this.rbush.search(point.asBBox).map(rbRect => rbRect.target);
		return targets.filter(target => (target.contains_point?.(point) ?? true));
	}

	private targetOf_highest_precedence(matches: Array<S_Hit_Target>): S_Hit_Target | null {
		return matches.find(s => s.isADot)
			?? matches.find(s => s.isAWidget)
			?? matches.find(s => s.isRing)
			?? matches.find(s => s.isAControl)
			?? matches[0];
	}

	private insert_into_rbush(target: S_Hit_Target, into_rbush: RBush<Target_RBRect>) {
		const rect = target.rect;
		if (!!rect) {
			into_rbush.insert({
				minX: rect.x,
				minY: rect.y,
				maxX: rect.right,
				maxY: rect.bottom,
				target: target
			});
		}
	}

	private remove_from_rbush(target: S_Hit_Target, from_rbush: RBush<Target_RBRect>) {
		if (!!target && !!target.rect) {
			from_rbush.remove({
				minX: target.rect.x,
				minY: target.rect.y,
				maxX: target.rect.right,
				maxY: target.rect.bottom,
				target: target
			}, (a, b) => a.target === b.target);
		}
	}

	private set_asHovering(match: S_Hit_Target | null) {
		this.w_s_hover.set(!match ? null : match);
		const autorepeating_target = get(this.w_autorepeat);
		if (!!autorepeating_target && (!match || !match.hasSameID_as(autorepeating_target))) {
			this.stop_autorepeat();
		}
		const longClick_target = get(this.w_longClick);
		if (!!longClick_target && (!match || !match.hasSameID_as(longClick_target))) {
			this.cancel_longClick();
		}
		if (!!this.pending_singleClick_target && (!match || !match.hasSameID_as(this.pending_singleClick_target))) {
			this.cancel_doubleClick();
		}
	}

	// ===== AUTOREPEAT =====

	start_autorepeat(target: S_Hit_Target) {
		if (!!target && target.autorepeat_callback) {
			this.stop_autorepeat();
			const id = target.autorepeat_id ?? 0;
			this.w_autorepeat.set(target);
			this.autorepeat_timer.autorepeat_start(id, () => {
				target.autorepeat_callback?.();
			});
		}
	}

	stop_autorepeat() {
		const autorepeating_target = get(this.w_autorepeat);
		if (!!autorepeating_target) {
			this.autorepeat_timer.autorepeat_stop();
			this.w_autorepeat.set(null);
		}
	}

	// ===== LONG CLICK =====

	start_longClick(target: S_Hit_Target, event: MouseEvent) {
		if (!!target && target.longClick_callback) {
			this.cancel_longClick();
			this.w_longClick.set(target);
			this.click_timer.timeout_start(T_Timer.long, () => {
				this.longClick_fired = true;
				target.clicks = 0;
				target.longClick_callback?.(S_Mouse.long(event, target.html_element));
				this.w_longClick.set(null);
			});
		}
	}

	cancel_longClick() {
		const longClick_target = get(this.w_longClick);
		if (!!longClick_target) {
			this.click_timer.reset();
			this.w_longClick.set(null);
		}
	}

	// ===== DOUBLE CLICK =====

	start_doubleClick_timer(target: S_Hit_Target, event: MouseEvent) {
		this.pending_singleClick_target = target;
		this.pending_singleClick_event = event;
		this.click_timer.timeout_start(T_Timer.double, () => {
			if (this.pending_singleClick_target && this.pending_singleClick_event) {
				this.pending_singleClick_target.handle_s_mouse?.(S_Mouse.down(this.pending_singleClick_event, this.pending_singleClick_target.html_element));
				this.pending_singleClick_target.clicks = 0;
				this.doubleClick_fired = true;
			}
			this.pending_singleClick_target = null;
			this.pending_singleClick_event = null;
		});
	}

	cancel_doubleClick() {
		if (this.pending_singleClick_target) {
			this.click_timer.reset();
			this.pending_singleClick_target = null;
			this.pending_singleClick_event = null;
		}
	}

}

export const hits = new Hits();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/managers/Components.ts
```ts
import { T_Hit_Target } from '../types/Enumerations';
import S_Component from '../state/S_Component';
import type { Dictionary } from '../types/Types';

export class Components {
	private components_dict_byType_andHID: Dictionary<Dictionary<S_Component>> = {};
	private _dummy!: S_Component;

	//////////////////////////////////////////////////////////////////
	//																//
	//				  state managed outside svelte					//
	//																//
	// debug logging												//
	// signal management											//
	// (?) style construction (by type and hid)						//
	// (?) unique id assignment (of html elements) for DOM lookups	//
	//																//
	//////////////////////////////////////////////////////////////////

	// ===== REGISTER =====

	private component_register(s_component: S_Component) {
		const type = s_component.type;
		const hid = s_component.hid;
		if (hid !== null && !!type) {
			const array = this.components_dict_byType_andHID;
			const dict = array[type] ?? {};
			dict[hid] = s_component;
			array[type] = dict;
		}
	}

	// ===== CREATE =====

	get dummy(): S_Component {
		if (!this._dummy) {
			this._dummy = new S_Component(null, T_Hit_Target.none);
		}
		return this._dummy;
	}

	component_forHID_andType(hid: number | null, type: T_Hit_Target): S_Component | null {
		const dict = this.components_byHID_forType(type);
		return dict[hid ?? -1] ?? null;
	}

	component_forHID_andType_createUnique(hid: number | null, type: T_Hit_Target): S_Component {
		let s_component: S_Component | null = this.component_forHID_andType(hid, type);
		if (!s_component) {
			s_component = new S_Component(hid, type);
			if (!!s_component) {
				this.component_register(s_component);
			}
		}
		return s_component;
	}

	private components_byHID_forType(type: string): { [hid: number]: S_Component } {
		let dict = this.components_dict_byType_andHID[type];
		if (!dict) {
			dict = {};
			this.components_dict_byType_andHID[type] = dict;
		}
		return dict;
	}

	// ===== CLEANUP =====

	component_remove(s_component: S_Component) {
		const type = s_component.type;
		const hid = s_component.hid;
		if (hid !== null && !!type) {
			const dict = this.components_dict_byType_andHID[type];
			if (dict) {
				delete dict[hid];
			}
		}
	}

	reset() {
		this.components_dict_byType_andHID = {};
	}

}

export const components = new Components();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/managers/Preferences.ts
```ts
/**
 * Preferences — persistent storage for user settings
 * 
 * Simple localStorage wrapper with type-safe keys.
 * All keys are prefixed with 'di:' for namespace isolation.
 */

export enum T_Preference {
	// Layout
	showDetails  = 'showDetails',
	detailsWidth = 'detailsWidth',
	
	// Colors
	textColor       = 'textColor',
	separatorColor  = 'separatorColor',
	backgroundColor = 'backgroundColor',
}

const STORAGE_PREFIX = 'di:';

class Preferences {
	
	/**
	 * Read a preference from localStorage
	 */
	read<T>(key : T_Preference) : T | null {
		try {
			const raw = localStorage.getItem(STORAGE_PREFIX + key);
			if (raw == null || raw == 'undefined') {
				return null;
			}
			return JSON.parse(raw) as T;
		} catch {
			return null;
		}
	}

	/**
	 * Write a preference to localStorage
	 */
	write<T>(key : T_Preference, value : T) : void {
		try {
			const json = JSON.stringify(value);
			localStorage.setItem(STORAGE_PREFIX + key, json);
		} catch (e) {
			console.warn(`Failed to write preference ${key}:`, e);
		}
	}

	/**
	 * Remove a preference from localStorage
	 */
	remove(key : T_Preference) : void {
		localStorage.removeItem(STORAGE_PREFIX + key);
	}

	/**
	 * Clear all di preferences
	 */
	clear() : void {
		const keys = Object.values(T_Preference);
		for (const key of keys) {
			this.remove(key);
		}
	}

	/**
	 * Debug: dump all di preferences to console
	 */
	dump() : void {
		const keys  = Object.values(T_Preference);
		const prefs : Record<string, unknown> = {};
		for (const key of keys) {
			prefs[key] = this.read(key);
		}
		console.log('Preferences:', prefs);
	}
}

export const preferences = new Preferences();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/runtime/Smart_Object.ts
```ts
import type { O_Scene } from '../types/Interfaces';
import Attribute from '../types/Attribute';
import Identifiable from './Identifiable';

export default class Smart_Object extends Identifiable {
	attribute: Attribute | null = null;
	scene: O_Scene | null;
	name: string;

	constructor(name: string = '', scene: O_Scene | null = null) {
		super();
		this.name = name;
		this.scene = scene;
	}

	get hasScene(): boolean { return !!this.scene; }
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/runtime/Identifiable.ts
```ts
import type { Integer } from '../types/Types';
import { v4 as uuid } from 'uuid';
import '../common/Extensions';

export default class Identifiable {
	hid: Integer;
	id: string;

	constructor(id: string = Identifiable.newID()) {
		this.hid = id.hash() as Integer;
		this.id = id;
	}

	static newID(prefix: string = 'NEW'): string { return prefix + Identifiable.removeAll('-', uuid()).slice(10, 24); } // use last, most-unique bytes of uuid
	equals(other: Identifiable | null | undefined): boolean { return !!other && this.id == other.id; }

	static removeAll(item: string, from: string): string {
		let to = from;
		let length = from.length;
		do {
			length = to.length;
			to = to.replace(item, '');
		} while (length != to.length)
		return to;
	}

	setID(id: string = Identifiable.newID()) {
		this.hid = id.hash() as Integer;
		this.id = id;
	}

	static remove_item_byHID<T>(from: Array<T>, item: T): Array<T> {
		const identifiable = item as Identifiable;
		const identifiables = from as Array<Identifiable>;
		return identifiables.filter(t => t.hid != identifiable.hid) as Array<T>;
	}

	static id_inReverseOrder(id: string): string {
		if (id.length > 3) { return this.newID(); }
		const parts = id.split('');
		const start = parts.shift();
		return [start, ...parts.reverse()].join('');
	}
	
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/tests/Testworthy_Utilities.test.ts
```ts
import { describe, it, expect } from 'vitest';
import { Testworthy_Utilities, tu } from '../common/Testworthy_Utilities';

describe('Testworthy_Utilities', () => {
	describe('cumulativeSum', () => {
		it('returns cumulative sum for simple array', () => {
			expect(tu.cumulativeSum([10, 20, 30])).toEqual([10, 30, 60]);
		});

		it('handles single element', () => {
			expect(tu.cumulativeSum([5])).toEqual([5]);
		});

		it('handles empty array', () => {
			expect(tu.cumulativeSum([])).toEqual([]);
		});

		it('handles negative numbers', () => {
			expect(tu.cumulativeSum([10, -5, 20])).toEqual([10, 5, 25]);
		});

		it('handles zeros', () => {
			expect(tu.cumulativeSum([0, 0, 10])).toEqual([0, 0, 10]);
		});
	});

	describe('strip_duplicates', () => {
		it('removes duplicate values', () => {
			expect(tu.strip_duplicates([1, 2, 2, 3, 3, 3])).toEqual([1, 2, 3]);
		});

		it('preserves order of first occurrence', () => {
			expect(tu.strip_duplicates([3, 1, 2, 1, 3])).toEqual([3, 1, 2]);
		});

		it('handles empty array', () => {
			expect(tu.strip_duplicates([])).toEqual([]);
		});

		it('handles array with no duplicates', () => {
			expect(tu.strip_duplicates([1, 2, 3])).toEqual([1, 2, 3]);
		});

		it('handles strings', () => {
			expect(tu.strip_duplicates(['a', 'b', 'a', 'c'])).toEqual(['a', 'b', 'c']);
		});
	});

	describe('strip_falsies', () => {
		it('removes null and undefined', () => {
			expect(tu.strip_falsies([1, null, 2, undefined, 3])).toEqual([1, 2, 3]);
		});

		it('removes empty strings', () => {
			expect(tu.strip_falsies(['a', '', 'b'])).toEqual(['a', 'b']);
		});

		it('removes zeros', () => {
			expect(tu.strip_falsies([1, 0, 2])).toEqual([1, 2]);
		});

		it('removes false', () => {
			expect(tu.strip_falsies([true, false, true])).toEqual([true, true]);
		});

		it('handles empty array', () => {
			expect(tu.strip_falsies([])).toEqual([]);
		});
	});

	describe('remove', () => {
		it('removes item from array', () => {
			expect(tu.remove([1, 2, 3], 2)).toEqual([1, 3]);
		});

		it('removes only first occurrence', () => {
			expect(tu.remove([1, 2, 2, 3], 2)).toEqual([1, 2, 3]);
		});

		it('returns unchanged array if item not found', () => {
			expect(tu.remove([1, 2, 3], 4)).toEqual([1, 2, 3]);
		});

		it('handles empty array', () => {
			expect(tu.remove([], 1)).toEqual([]);
		});
	});

	describe('remove_fromArray_byReference', () => {
		it('removes item by reference', () => {
			const obj1 = { id: 1 };
			const obj2 = { id: 2 };
			const obj3 = { id: 3 };
			const arr = [obj1, obj2, obj3];
			expect(tu.remove_fromArray_byReference(obj2, arr)).toEqual([obj1, obj3]);
		});

		it('returns original array if item is null', () => {
			const arr = [1, 2, 3];
			expect(tu.remove_fromArray_byReference(null as any, arr)).toEqual([1, 2, 3]);
		});

		it('does not remove by value equality', () => {
			const arr = [{ id: 1 }, { id: 2 }];
			const similar = { id: 1 };  // same value, different reference
			expect(tu.remove_fromArray_byReference(similar, arr)).toEqual(arr);
		});
	});

	describe('indexOf_inArray_byReference', () => {
		it('finds index by reference', () => {
			const obj1 = { id: 1 };
			const obj2 = { id: 2 };
			const arr = [obj1, obj2];
			expect(tu.indexOf_inArray_byReference(obj2, arr)).toBe(1);
		});

		it('returns -1 if not found', () => {
			const obj1 = { id: 1 };
			const obj2 = { id: 2 };
			const arr = [obj1];
			expect(tu.indexOf_inArray_byReference(obj2, arr)).toBe(-1);
		});

		it('returns -1 for null item', () => {
			expect(tu.indexOf_inArray_byReference(null as any, [1, 2])).toBe(-1);
		});
	});

	describe('concatenateArrays', () => {
		it('concatenates two arrays', () => {
			expect(tu.concatenateArrays([1, 2], [3, 4])).toEqual([1, 2, 3, 4]);
		});

		it('handles empty arrays', () => {
			expect(tu.concatenateArrays([], [1, 2])).toEqual([1, 2]);
			expect(tu.concatenateArrays([1, 2], [])).toEqual([1, 2]);
		});
	});

	describe('uniquely_concatenateArrays', () => {
		it('concatenates and removes duplicates', () => {
			expect(tu.uniquely_concatenateArrays([1, 2], [2, 3])).toEqual([1, 2, 3]);
		});

		it('preserves order', () => {
			expect(tu.uniquely_concatenateArrays([1, 2], [3, 1])).toEqual([1, 2, 3]);
		});
	});

	describe('strip_invalid', () => {
		it('removes falsies and duplicates', () => {
			expect(tu.strip_invalid([1, null, 2, 2, undefined, 3])).toEqual([1, 2, 3]);
		});
	});

	describe('convert_toNumber', () => {
		it('converts boolean array to binary number', () => {
			expect(tu.convert_toNumber([true, false, false])).toBe(1);   // 001
			expect(tu.convert_toNumber([false, true, false])).toBe(2);  // 010
			expect(tu.convert_toNumber([true, true, false])).toBe(3);   // 011
			expect(tu.convert_toNumber([false, false, true])).toBe(4);  // 100
		});

		it('handles empty array', () => {
			expect(tu.convert_toNumber([])).toBe(0);
		});

		it('handles all true', () => {
			expect(tu.convert_toNumber([true, true, true])).toBe(7);  // 111
		});

		it('handles all false', () => {
			expect(tu.convert_toNumber([false, false, false])).toBe(0);
		});
	});

	describe('valueFrom_atIndex', () => {
		it('gets value at index', () => {
			const dict = { a: 10, b: 20, c: 30 };
			expect(tu.valueFrom_atIndex(dict, 0)).toBe(10);
			expect(tu.valueFrom_atIndex(dict, 1)).toBe(20);
			expect(tu.valueFrom_atIndex(dict, 2)).toBe(30);
		});

		it('throws for out of bounds index', () => {
			const dict = { a: 10 };
			expect(() => tu.valueFrom_atIndex(dict, 5)).toThrow('Index 5 is out of bounds');
			expect(() => tu.valueFrom_atIndex(dict, -1)).toThrow('Index -1 is out of bounds');
		});
	});

	describe('t_or_f', () => {
		it('returns | for true', () => {
			expect(tu.t_or_f(true)).toBe('|');
		});

		it('returns - for false', () => {
			expect(tu.t_or_f(false)).toBe('-');
		});
	});

	describe('copyObject', () => {
		it('creates shallow copy preserving prototype', () => {
			class Foo {
				x = 1;
				getX() { return this.x; }
			}
			const original = new Foo();
			const copy = tu.copyObject(original);
			expect(copy.x).toBe(1);
			expect(copy.getX()).toBe(1);
			expect(copy).not.toBe(original);
		});
	});

	describe('convertToObject', () => {
		it('extracts specified fields', () => {
			const instance = { a: 1, b: 2, c: 3 };
			expect(tu.convertToObject(instance, ['a', 'c'])).toEqual({ a: 1, c: 3 });
		});

		it('ignores missing fields', () => {
			const instance = { a: 1 };
			expect(tu.convertToObject(instance, ['a', 'b'])).toEqual({ a: 1 });
		});
	});
});
```

### /Users/sand/GitHub/mono/di/src/lib/ts/tests/setup.ts
```ts
/**
 * Vitest setup file
 * Mocks browser APIs not available in Node
 */

// Mock localStorage
const store: Record<string, string> = {};

global.localStorage = {
	getItem: (key: string) => store[key] ?? null,
	setItem: (key: string, value: string) => { store[key] = value; },
	removeItem: (key: string) => { delete store[key]; },
	clear: () => { Object.keys(store).forEach(k => delete store[k]); },
	key: (index: number) => Object.keys(store)[index] ?? null,
	length: 0,
};

Object.defineProperty(global.localStorage, 'length', {
	get: () => Object.keys(store).length,
});
```

### /Users/sand/GitHub/mono/di/src/lib/ts/tests/Coordinates.test.ts
```ts
import { describe, it, expect } from 'vitest';
import { Point, Size, Rect, Polar, Point3, Size3, Block } from '../types/Coordinates';
import '../common/Extensions';

describe('Point', () => {
	describe('constructor', () => {
		it('creates point with default values', () => {
			const p = new Point();
			expect(p.x).toBe(0);
			expect(p.y).toBe(0);
		});

		it('creates point with specified values', () => {
			const p = new Point(3, 4);
			expect(p.x).toBe(3);
			expect(p.y).toBe(4);
		});
	});

	describe('magnitude', () => {
		it('calculates magnitude for 3-4-5 triangle', () => {
			const p = new Point(3, 4);
			expect(p.magnitude).toBe(5);
		});

		it('returns 0 for zero point', () => {
			expect(Point.zero.magnitude).toBe(0);
		});
	});

	describe('arithmetic', () => {
		it('offsets by another point', () => {
			const p1 = new Point(1, 2);
			const p2 = new Point(3, 4);
			const result = p1.offsetBy(p2);
			expect(result.x).toBe(4);
			expect(result.y).toBe(6);
		});

		it('negates correctly', () => {
			const p = new Point(3, -4);
			const neg = p.negated;
			expect(neg.x).toBe(-3);
			expect(neg.y).toBe(4);
		});

		it('multiplies equally', () => {
			const p = new Point(2, 3);
			const result = p.multipliedEquallyBy(4);
			expect(result.x).toBe(8);
			expect(result.y).toBe(12);
		});

		it('divides equally', () => {
			const p = new Point(10, 20);
			const result = p.dividedEquallyBy(2);
			expect(result.x).toBe(5);
			expect(result.y).toBe(10);
		});

		it('calculates vector_to', () => {
			const p1 = new Point(1, 1);
			const p2 = new Point(4, 5);
			const vec = p1.vector_to(p2);
			expect(vec.x).toBe(3);
			expect(vec.y).toBe(4);
		});
	});

	describe('rotate_by', () => {
		it('rotates point on x-axis by 90 degrees', () => {
			const p = new Point(1, 0);
			const rotated = p.rotate_by(Math.PI / 2);
			expect(rotated.x).toBeCloseTo(0, 10);
			expect(rotated.y).toBeCloseTo(-1, 10);  // browser coords: y inverted
		});

		it('rotates point by 180 degrees', () => {
			const p = new Point(1, 0);
			const rotated = p.rotate_by(Math.PI);
			expect(rotated.x).toBeCloseTo(-1, 10);
			expect(rotated.y).toBeCloseTo(0, 10);
		});
	});

	describe('static constructors', () => {
		it('creates point from x only', () => {
			const p = Point.x(5);
			expect(p.x).toBe(5);
			expect(p.y).toBe(0);
		});

		it('creates point from y only', () => {
			const p = Point.y(7);
			expect(p.x).toBe(0);
			expect(p.y).toBe(7);
		});

		it('creates square point', () => {
			const p = Point.square(3);
			expect(p.x).toBe(3);
			expect(p.y).toBe(3);
		});
	});

	describe('equals', () => {
		it('returns true for equal points', () => {
			const p1 = new Point(1, 2);
			const p2 = new Point(1, 2);
			expect(p1.equals(p2)).toBe(true);
		});

		it('returns false for different points', () => {
			const p1 = new Point(1, 2);
			const p2 = new Point(1, 3);
			expect(p1.equals(p2)).toBe(false);
		});
	});
});

describe('Size', () => {
	describe('constructor', () => {
		it('creates size with default values', () => {
			const s = new Size();
			expect(s.width).toBe(0);
			expect(s.height).toBe(0);
		});

		it('creates size with specified values', () => {
			const s = new Size(100, 200);
			expect(s.width).toBe(100);
			expect(s.height).toBe(200);
		});
	});

	describe('center', () => {
		it('calculates center correctly', () => {
			const s = new Size(100, 200);
			const c = s.center;
			expect(c.x).toBe(50);
			expect(c.y).toBe(100);
		});
	});

	describe('arithmetic', () => {
		it('insets equally', () => {
			const s = new Size(100, 100);
			const inset = s.insetEquallyBy(10);
			expect(inset.width).toBe(80);
			expect(inset.height).toBe(80);
		});

		it('extends by delta', () => {
			const s = new Size(100, 100);
			const extended = s.extendedBy(new Point(10, 20));
			expect(extended.width).toBe(110);
			expect(extended.height).toBe(120);
		});
	});
});

describe('Rect', () => {
	describe('constructor', () => {
		it('creates rect with defaults', () => {
			const r = new Rect();
			expect(r.x).toBe(0);
			expect(r.y).toBe(0);
			expect(r.width).toBe(0);
			expect(r.height).toBe(0);
		});

		it('creates rect with origin and size', () => {
			const r = new Rect(new Point(10, 20), new Size(100, 200));
			expect(r.x).toBe(10);
			expect(r.y).toBe(20);
			expect(r.width).toBe(100);
			expect(r.height).toBe(200);
		});
	});

	describe('derived properties', () => {
		const r = new Rect(new Point(10, 20), new Size(100, 200));

		it('calculates extent', () => {
			expect(r.extent.x).toBe(110);
			expect(r.extent.y).toBe(220);
		});

		it('calculates center', () => {
			expect(r.center.x).toBe(60);
			expect(r.center.y).toBe(120);
		});

		it('calculates corners', () => {
			expect(r.topRight.equals(new Point(110, 20))).toBe(true);
			expect(r.bottomLeft.equals(new Point(10, 220))).toBe(true);
		});
	});

	describe('contains', () => {
		const r = new Rect(new Point(0, 0), new Size(100, 100));

		it('returns true for point inside', () => {
			expect(r.contains(new Point(50, 50))).toBe(true);
		});

		it('returns true for point on edge', () => {
			expect(r.contains(new Point(0, 0))).toBe(true);
			expect(r.contains(new Point(100, 100))).toBe(true);
		});

		it('returns false for point outside', () => {
			expect(r.contains(new Point(150, 50))).toBe(false);
			expect(r.contains(new Point(-1, 50))).toBe(false);
		});
	});

	describe('intersects', () => {
		const r1 = new Rect(new Point(0, 0), new Size(100, 100));

		it('returns true for overlapping rects', () => {
			const r2 = new Rect(new Point(50, 50), new Size(100, 100));
			expect(r1.intersects(r2)).toBe(true);
		});

		it('returns true for touching rects', () => {
			const r2 = new Rect(new Point(100, 0), new Size(100, 100));
			expect(r1.intersects(r2)).toBe(true);
		});

		it('returns false for non-overlapping rects', () => {
			const r2 = new Rect(new Point(200, 200), new Size(100, 100));
			expect(r1.intersects(r2)).toBe(false);
		});
	});

	describe('static constructors', () => {
		it('creates centered rect', () => {
			const r = Rect.createCenterRect(new Point(50, 50), new Size(20, 20));
			expect(r.x).toBe(40);
			expect(r.y).toBe(40);
			expect(r.center.x).toBe(50);
			expect(r.center.y).toBe(50);
		});
	});
});

describe('Point3', () => {
	it('creates 3D point', () => {
		const p = new Point3(1, 2, 3);
		expect(p.x).toBe(1);
		expect(p.y).toBe(2);
		expect(p.z).toBe(3);
	});

	it('calculates magnitude', () => {
		const p = new Point3(1, 2, 2);
		expect(p.magnitude).toBe(3);
	});

	it('calculates cross product', () => {
		const p1 = new Point3(1, 0, 0);
		const p2 = new Point3(0, 1, 0);
		const cross = p1.cross(p2);
		expect(cross.x).toBe(0);
		expect(cross.y).toBe(0);
		expect(cross.z).toBe(1);
	});

	it('calculates dot product', () => {
		const p1 = new Point3(1, 2, 3);
		const p2 = new Point3(4, 5, 6);
		expect(p1.dot(p2)).toBe(32);  // 1*4 + 2*5 + 3*6
	});

	it('normalizes vector', () => {
		const p = new Point3(3, 0, 4);
		const n = p.normalized;
		expect(n.x).toBeCloseTo(0.6, 10);
		expect(n.y).toBe(0);
		expect(n.z).toBeCloseTo(0.8, 10);
		expect(n.magnitude).toBeCloseTo(1, 10);
	});
});

describe('Polar', () => {
	it('converts to Point', () => {
		const polar = new Polar(1, 0);
		const point = polar.asPoint;
		expect(point.x).toBeCloseTo(1, 10);
		expect(point.y).toBeCloseTo(0, 10);
	});

	it('converts 45 degrees', () => {
		const polar = new Polar(Math.sqrt(2), Math.PI / 4);
		const point = polar.asPoint;
		expect(point.x).toBeCloseTo(1, 10);
		expect(point.y).toBeCloseTo(-1, 10);  // browser coords
	});
});
```

### /Users/sand/GitHub/mono/di/src/lib/ts/tests/Extensions.test.ts
```ts
import { describe, it, expect } from 'vitest';
import '../common/Extensions';

describe('Number extensions', () => {
	describe('isBetween', () => {
		it('returns true for value in range (inclusive)', () => {
			expect((5).isBetween(1, 10, true)).toBe(true);
		});

		it('returns true for value at boundary (inclusive)', () => {
			expect((1).isBetween(1, 10, true)).toBe(true);
			expect((10).isBetween(1, 10, true)).toBe(true);
		});

		it('returns false for value at boundary (exclusive)', () => {
			expect((1).isBetween(1, 10, false)).toBe(false);
			expect((10).isBetween(1, 10, false)).toBe(false);
		});

		it('returns false for value outside range', () => {
			expect((0).isBetween(1, 10, true)).toBe(false);
			expect((11).isBetween(1, 10, true)).toBe(false);
		});

		it('handles reversed bounds', () => {
			expect((5).isBetween(10, 1, true)).toBe(true);
		});
	});

	describe('force_between', () => {
		it('returns value if within range', () => {
			expect((5).force_between(1, 10)).toBe(5);
		});

		it('clamps to minimum', () => {
			expect((0).force_between(1, 10)).toBe(1);
		});

		it('clamps to maximum', () => {
			expect((15).force_between(1, 10)).toBe(10);
		});

		it('handles reversed bounds', () => {
			expect((15).force_between(10, 1)).toBe(10);
		});
	});

	describe('force_asInteger_between', () => {
		it('rounds and clamps', () => {
			expect((5.7).force_asInteger_between(1, 10)).toBe(6);
			expect((0.2).force_asInteger_between(1, 10)).toBe(1);
		});
	});

	describe('normalize_between_zeroAnd', () => {
		it('returns value if already in range', () => {
			expect((0.5).normalize_between_zeroAnd(1)).toBe(0.5);
		});

		it('wraps negative values', () => {
			expect((-1).normalize_between_zeroAnd(10)).toBe(9);
			expect((-0.5).normalize_between_zeroAnd(1)).toBeCloseTo(0.5, 10);
		});

		it('wraps values exceeding max', () => {
			expect((12).normalize_between_zeroAnd(10)).toBe(2);
			expect((1.5).normalize_between_zeroAnd(1)).toBeCloseTo(0.5, 10);
		});

		it('handles multiple wraps', () => {
			expect((25).normalize_between_zeroAnd(10)).toBe(5);
			expect((-25).normalize_between_zeroAnd(10)).toBe(5);
		});

		it('returns 0 for value 0', () => {
			expect((0).normalize_between_zeroAnd(10)).toBe(0);
		});
	});

	describe('angle_normalized', () => {
		it('normalizes to 0..2π', () => {
			const twoPi = Math.PI * 2;
			expect((0).angle_normalized()).toBe(0);
			expect((Math.PI).angle_normalized()).toBeCloseTo(Math.PI, 10);
			expect((twoPi + 1).angle_normalized()).toBeCloseTo(1, 10);
			expect((-1).angle_normalized()).toBeCloseTo(twoPi - 1, 10);
		});
	});

	describe('angle_normalized_aroundZero', () => {
		it('normalizes to -π..π', () => {
			expect((0).angle_normalized_aroundZero()).toBeCloseTo(0, 10);
			expect((Math.PI * 1.5).angle_normalized_aroundZero()).toBeCloseTo(-Math.PI / 2, 10);
		});
	});

	describe('isAlmost', () => {
		it('returns true if within tolerance', () => {
			expect((5).isAlmost(5.01, 0.1)).toBe(true);
			expect((5).isAlmost(4.99, 0.1)).toBe(true);
		});

		it('returns false if outside tolerance', () => {
			expect((5).isAlmost(5.2, 0.1)).toBe(false);
		});
	});

	describe('increment_by', () => {
		it('increments with wrap', () => {
			expect((8).increment_by(3, 10)).toBe(1);
			expect((2).increment_by(-3, 10)).toBe(9);
		});
	});

	describe('increment', () => {
		it('increments by 1', () => {
			expect((5).increment(true, 10)).toBe(6);
			expect((5).increment(false, 10)).toBe(4);
		});

		it('wraps around', () => {
			expect((9).increment(true, 10)).toBe(0);
			expect((0).increment(false, 10)).toBe(9);
		});
	});

	describe('roundToEven', () => {
		it('rounds to nearest even', () => {
			expect((3).roundToEven()).toBe(4);
			expect((5).roundToEven()).toBe(6);
			expect((4).roundToEven()).toBe(4);
		});
	});

	describe('nth', () => {
		it('adds correct suffix', () => {
			expect((1).nth()).toBe('1st');
			expect((2).nth()).toBe('2nd');
			expect((3).nth()).toBe('3rd');
			expect((4).nth()).toBe('4th');
			expect((11).nth()).toBe('11th');
			expect((12).nth()).toBe('12th');
			expect((13).nth()).toBe('13th');
			expect((21).nth()).toBe('21st');
			expect((22).nth()).toBe('22nd');
			expect((23).nth()).toBe('23rd');
		});
	});

	describe('asDegrees / degrees_of', () => {
		it('converts radians to degrees string', () => {
			expect((Math.PI).asDegrees()).toBe('180');
			expect((Math.PI / 2).degrees_of(1)).toBe('90.0');
		});
	});

	describe('straddles_zero', () => {
		it('detects when angles straddle zero', () => {
			const almostFull = Math.PI * 1.9;
			const justPastZero = 0.1;
			expect(almostFull.straddles_zero(justPastZero)).toBe(true);
		});
	});

	describe('bump_towards', () => {
		it('snaps to boundary if close', () => {
			expect((0.01).bump_towards(0, 10, 0.1)).toBe(0);
			expect((9.99).bump_towards(0, 10, 0.1)).toBe(10);
		});

		it('returns value if not close to boundary', () => {
			expect((5).bump_towards(0, 10, 0.1)).toBe(5);
		});
	});
});

describe('String extensions', () => {
	describe('hash', () => {
		it('returns consistent hash for same string', () => {
			expect('test'.hash()).toBe('test'.hash());
		});

		it('returns different hash for different strings', () => {
			expect('test'.hash()).not.toBe('other'.hash());
		});

		it('returns 0 for empty string', () => {
			expect(''.hash()).toBe(0);
		});
	});

	describe('lastWord', () => {
		it('returns last word', () => {
			expect('hello world'.lastWord()).toBe('world');
			expect('single'.lastWord()).toBe('single');
		});
	});

	describe('unCamelCase', () => {
		it('converts camelCase to spaces', () => {
			expect('camelCase'.unCamelCase()).toBe('camel case');
			expect('thisIsATest'.unCamelCase()).toBe('this is a test');
		});
	});

	describe('removeWhiteSpace', () => {
		it('removes newlines and tabs', () => {
			// newlines become spaces, tabs are removed
			expect('hello\nworld\ttab'.removeWhiteSpace()).toBe('hello worldtab');
		});
	});

	describe('clipWithEllipsisAt', () => {
		it('clips long strings', () => {
			expect('this is a long string'.clipWithEllipsisAt(10)).toBe('this is a  ...');
		});

		it('leaves short strings alone', () => {
			expect('short'.clipWithEllipsisAt(10)).toBe('short');
		});
	});

	describe('injectEllipsisAt', () => {
		it('injects ellipsis in middle of long strings', () => {
			const result = 'abcdefghijklmnop'.injectEllipsisAt(4);
			expect(result).toBe('abcd ... mnop');
		});

		it('leaves short strings alone', () => {
			expect('short'.injectEllipsisAt(4)).toBe('short');
		});
	});

	describe('encode_as_property / decode_from_property', () => {
		it('roundtrips property encoding', () => {
			const original = 'test-name (value)';
			const encoded = original.encode_as_property();
			expect(encoded).not.toContain('-');
			expect(encoded).not.toContain('(');
			expect(encoded).not.toContain(')');
			// Note: decode doesn't fully roundtrip due to space handling
		});
	});

	describe('fontSize_relativeTo', () => {
		it('parses em units', () => {
			expect('1.5em'.fontSize_relativeTo(16)).toBe(24);
		});

		it('parses px units', () => {
			expect('20px'.fontSize_relativeTo(16)).toBe(20);
		});

		it('parses plain numbers', () => {
			expect('18'.fontSize_relativeTo(16)).toBe(18);
		});
	});
});
```

### /Users/sand/GitHub/mono/di/src/lib/ts/tests/Angle.test.ts
```ts
import { describe, it, expect } from 'vitest';
import Angle, { T_Quadrant, T_Orientation, Direction } from '../types/Angle';
import '../common/Extensions';

describe('Angle', () => {
	describe('static constants', () => {
		it('defines full rotation as 2π', () => {
			expect(Angle.full).toBe(Math.PI * 2);
		});

		it('defines half rotation as π', () => {
			expect(Angle.half).toBe(Math.PI);
		});

		it('defines quarter rotation as π/2', () => {
			expect(Angle.quarter).toBe(Math.PI / 2);
		});

		it('defines three_quarters as 3π/2', () => {
			expect(Angle.three_quarters).toBe(Math.PI * 1.5);
		});
	});

	describe('radians_from_degrees', () => {
		it('converts 0 degrees', () => {
			expect(Angle.radians_from_degrees(0)).toBe(0);
		});

		it('converts 90 degrees', () => {
			expect(Angle.radians_from_degrees(90)).toBeCloseTo(Math.PI / 2, 10);
		});

		it('converts 180 degrees', () => {
			expect(Angle.radians_from_degrees(180)).toBeCloseTo(Math.PI, 10);
		});

		it('converts 360 degrees', () => {
			expect(Angle.radians_from_degrees(360)).toBeCloseTo(Math.PI * 2, 10);
		});
	});

	describe('angle_from_name', () => {
		it('returns correct angle for up', () => {
			expect(Angle.angle_from_name('up')).toBe(-Math.PI / 2);
		});

		it('returns correct angle for down', () => {
			expect(Angle.angle_from_name('down')).toBe(Math.PI / 2);
		});

		it('returns correct angle for right', () => {
			expect(Angle.angle_from_name('right')).toBe(Math.PI);
		});

		it('returns correct angle for left', () => {
			expect(Angle.angle_from_name('left')).toBe(0);
		});

		it('returns null for unknown name', () => {
			expect(Angle.angle_from_name('diagonal')).toBeNull();
		});
	});

	describe('orientation_from_name', () => {
		it('returns T_Orientation.up for up', () => {
			expect(Angle.orientation_from_name('up')).toBe(T_Orientation.up);
		});

		it('returns T_Orientation.down for down', () => {
			expect(Angle.orientation_from_name('down')).toBe(T_Orientation.down);
		});

		it('returns T_Orientation.right for right', () => {
			expect(Angle.orientation_from_name('right')).toBe(T_Orientation.right);
		});

		it('returns T_Orientation.left for left', () => {
			expect(Angle.orientation_from_name('left')).toBe(T_Orientation.left);
		});

		it('returns null for unknown name', () => {
			expect(Angle.orientation_from_name('diagonal')).toBeNull();
		});
	});

	describe('quadrant_ofAngle', () => {
		it('returns upperRight for angle 0', () => {
			const a = new Angle(0);
			expect(a.quadrant_ofAngle).toBe(T_Quadrant.upperRight);
		});

		it('returns upperRight for small positive angle', () => {
			const a = new Angle(Math.PI / 4);  // 45 degrees
			expect(a.quadrant_ofAngle).toBe(T_Quadrant.upperRight);
		});

		it('returns upperLeft for angle π/2 to π', () => {
			const a = new Angle(Math.PI * 0.75);  // 135 degrees
			expect(a.quadrant_ofAngle).toBe(T_Quadrant.upperLeft);
		});

		it('returns lowerLeft for angle π to 3π/2', () => {
			const a = new Angle(Math.PI * 1.25);  // 225 degrees
			expect(a.quadrant_ofAngle).toBe(T_Quadrant.lowerLeft);
		});

		it('returns lowerRight for angle 3π/2 to 2π', () => {
			const a = new Angle(Math.PI * 1.75);  // 315 degrees
			expect(a.quadrant_ofAngle).toBe(T_Quadrant.lowerRight);
		});

		it('handles negative angles by normalizing', () => {
			const a = new Angle(-Math.PI / 4);  // -45 degrees = 315 degrees
			expect(a.quadrant_ofAngle).toBe(T_Quadrant.lowerRight);
		});
	});

	describe('octant_ofAngle', () => {
		it('returns 0 for angle near 0', () => {
			const a = new Angle(0);
			expect(a.octant_ofAngle).toBe(0);
		});

		it('returns correct octant for 45 degrees', () => {
			const a = new Angle(Math.PI / 4);
			expect(a.octant_ofAngle).toBe(1);
		});

		it('returns correct octant for 90 degrees', () => {
			const a = new Angle(Math.PI / 2);
			expect(a.octant_ofAngle).toBe(2);
		});

		it('returns correct octant for 180 degrees', () => {
			const a = new Angle(Math.PI);
			expect(a.octant_ofAngle).toBe(4);
		});

		it('returns correct octant for 270 degrees', () => {
			const a = new Angle(Math.PI * 1.5);
			expect(a.octant_ofAngle).toBe(6);
		});
	});

	describe('orientation_ofAngle', () => {
		it('returns right for angle near 0', () => {
			const a = new Angle(0.1);
			expect(a.orientation_ofAngle).toBe(T_Orientation.right);
		});

		it('returns up for angle near π/2', () => {
			const a = new Angle(Math.PI / 2);
			expect(a.orientation_ofAngle).toBe(T_Orientation.up);
		});

		it('returns left for angle near π', () => {
			const a = new Angle(Math.PI);
			expect(a.orientation_ofAngle).toBe(T_Orientation.left);
		});

		it('returns down for angle near 3π/2', () => {
			const a = new Angle(Math.PI * 1.5);
			expect(a.orientation_ofAngle).toBe(T_Orientation.down);
		});
	});

	describe('angle_points_* helpers', () => {
		it('angle_points_up returns true for upper quadrants', () => {
			expect(new Angle(Math.PI / 4).angle_points_up).toBe(true);
			expect(new Angle(Math.PI * 0.75).angle_points_up).toBe(true);
		});

		it('angle_points_up returns false for lower quadrants', () => {
			expect(new Angle(Math.PI * 1.25).angle_points_up).toBe(false);
			expect(new Angle(Math.PI * 1.75).angle_points_up).toBe(false);
		});

		it('angle_points_right returns true for right quadrants', () => {
			expect(new Angle(Math.PI / 4).angle_points_right).toBe(true);
			expect(new Angle(Math.PI * 1.75).angle_points_right).toBe(true);
		});

		it('angle_points_right returns false for left quadrants', () => {
			expect(new Angle(Math.PI * 0.75).angle_points_right).toBe(false);
			expect(new Angle(Math.PI * 1.25).angle_points_right).toBe(false);
		});

		it('angle_points_down returns true for down orientation', () => {
			expect(new Angle(Math.PI * 1.5).angle_points_down).toBe(true);
		});
	});

	describe('cursor_forAngle', () => {
		it('returns ns-resize for angle 0', () => {
			const a = new Angle(0);
			expect(a.cursor_forAngle).toBe('ns-resize');
		});

		it('returns ew-resize for horizontal angles', () => {
			const a = new Angle(Math.PI / 2);
			expect(a.cursor_forAngle).toBe('ew-resize');
		});

		it('returns diagonal cursor for 45 degree angles', () => {
			const a = new Angle(Math.PI / 4);
			expect(a.cursor_forAngle).toBe('nwse-resize');
		});
	});

	describe('quadrant_basis_angle', () => {
		it('returns 0 for upperRight', () => {
			const a = new Angle(Math.PI / 4);
			expect(a.quadrant_basis_angle).toBe(0);
		});

		it('returns quarter for upperLeft', () => {
			const a = new Angle(Math.PI * 0.75);
			expect(a.quadrant_basis_angle).toBe(Angle.quarter);
		});

		it('returns half for lowerLeft', () => {
			const a = new Angle(Math.PI * 1.25);
			expect(a.quadrant_basis_angle).toBe(Angle.half);
		});

		it('returns three_quarters for lowerRight', () => {
			const a = new Angle(Math.PI * 1.75);
			expect(a.quadrant_basis_angle).toBe(Angle.three_quarters);
		});
	});
});

describe('Direction enum', () => {
	it('maps up to three_quarters (270 degrees)', () => {
		expect(Direction.up).toBe(Angle.three_quarters);
	});

	it('maps down to quarter (90 degrees)', () => {
		expect(Direction.down).toBe(Angle.quarter);
	});

	it('maps right to half (180 degrees)', () => {
		expect(Direction.right).toBe(Angle.half);
	});

	it('maps left to zero', () => {
		expect(Direction.left).toBe(Angle.zero);
	});
});

describe('T_Quadrant enum', () => {
	it('has correct string values', () => {
		expect(T_Quadrant.upperRight).toBe('ur');
		expect(T_Quadrant.upperLeft).toBe('ul');
		expect(T_Quadrant.lowerLeft).toBe('ll');
		expect(T_Quadrant.lowerRight).toBe('lr');
	});
});

describe('T_Orientation enum', () => {
	it('has correct string values', () => {
		expect(T_Orientation.right).toBe('right');
		expect(T_Orientation.left).toBe('left');
		expect(T_Orientation.up).toBe('up');
		expect(T_Orientation.down).toBe('down');
	});
});
```

### /Users/sand/GitHub/mono/di/src/lib/ts/tests/Colors.test.ts
```ts
import { describe, it, expect } from 'vitest';
import { Colors, colors } from '../draw/Colors';

describe('Colors', () => {
	describe('color_fromSeriously', () => {
		it('parses seriously format string', () => {
			const result = colors.color_fromSeriously('red:1,green:0,blue:0,alpha:1');
			expect(result).toBe('#ff0000');
		});

		it('parses partial values', () => {
			const result = colors.color_fromSeriously('red:0.5,green:0.5,blue:0.5,alpha:1');
			expect(result).toBe('#808080');
		});

		it('returns default for undefined', () => {
			expect(colors.color_fromSeriously(undefined)).toBe(colors.default_forThings);
		});

		it('returns default for empty string', () => {
			expect(colors.color_fromSeriously('')).toBe(colors.default_forThings);
		});

		it('handles blue', () => {
			const result = colors.color_fromSeriously('red:0,green:0,blue:1,alpha:1');
			expect(result).toBe('#0000ff');
		});

		it('handles green', () => {
			const result = colors.color_fromSeriously('red:0,green:1,blue:0,alpha:1');
			expect(result).toBe('#00ff00');
		});
	});

	describe('luminance_ofColor', () => {
		it('returns 1 for white', () => {
			expect(colors.luminance_ofColor('white')).toBeCloseTo(1, 2);
		});

		it('returns 0 for black', () => {
			expect(colors.luminance_ofColor('black')).toBeCloseTo(0, 2);
		});

		it('returns intermediate value for gray', () => {
			const lum = colors.luminance_ofColor('#808080');
			expect(lum).toBeGreaterThan(0);
			expect(lum).toBeLessThan(1);
		});

		it('red has lower luminance than green', () => {
			const redLum = colors.luminance_ofColor('red');
			const greenLum = colors.luminance_ofColor('lime');  // pure green
			expect(greenLum).toBeGreaterThan(redLum);
		});
	});

	describe('darkerBy', () => {
		it('cannot darken white (edge case)', () => {
			const darker = colors.darkerBy('white', 0.5);
			const darkerLum = colors.luminance_ofColor(darker);
			// White has luminance 1, and (1-1)*ratio = 0, so it stays white
			expect(darkerLum).toBe(1);
		});

		it('returns same color when target darkness exceeds 1', () => {
			// darkerBy calculates (1-lume)*(1+ratio) as target darkness
			// For dark colors with high ratios, this exceeds 1 and returns original
			const darker = colors.darkerBy('#333333', 2);
			expect(darker).toMatch(/^#[0-9a-f]{6}$/i);
		});

		it('darkens light color with small ratio', () => {
			// #cccccc has lume ~0.6, ratio 0.1 gives darkness ~0.44 (valid)
			const darker = colors.darkerBy('#cccccc', 0.1);
			const originalLum = colors.luminance_ofColor('#cccccc');
			const darkerLum = colors.luminance_ofColor(darker);
			expect(darkerLum).toBeLessThan(originalLum);
		});

		it('returns a valid hex color', () => {
			const result = colors.darkerBy('#ff0000', 0.5);
			expect(result).toMatch(/^#[0-9a-f]{6}$/i);
		});
	});

	describe('lighterBy', () => {
		it('makes dark color lighter', () => {
			const lighter = colors.lighterBy('#333333', 2);
			const originalLum = colors.luminance_ofColor('#333333');
			const lighterLum = colors.luminance_ofColor(lighter);
			expect(lighterLum).toBeGreaterThan(originalLum);
		});

		it('returns a valid hex color', () => {
			const result = colors.lighterBy('#333333', 2);
			expect(result).toMatch(/^#[0-9a-f]{6}$/i);
		});
	});

	describe('opacitize', () => {
		it('returns rgba with opacity', () => {
			const result = colors.opacitize('red', 0.5);
			expect(result).toContain('rgba');
		});

		it('returns empty string for empty input', () => {
			expect(colors.opacitize('', 0.5)).toBe('');
		});

		it('handles full opacity', () => {
			const result = colors.opacitize('blue', 1);
			expect(result).toBeTruthy();
		});

		it('handles zero opacity', () => {
			const result = colors.opacitize('blue', 0);
			expect(result).toBeTruthy();
		});
	});

	describe('ofBackgroundFor', () => {
		it('returns lighter version of color', () => {
			const bg = colors.ofBackgroundFor('#808080');
			const bgLum = colors.luminance_ofColor(bg);
			const origLum = colors.luminance_ofColor('#808080');
			expect(bgLum).toBeGreaterThan(origLum);
		});

		it('returns valid hex', () => {
			expect(colors.ofBackgroundFor('blue')).toMatch(/^#[0-9a-f]{6}$/i);
		});
	});

	describe('ofBannerFor', () => {
		it('returns valid hex', () => {
			expect(colors.ofBannerFor('#f0f0f0')).toMatch(/^#[0-9a-f]{6}$/i);
		});
	});

	describe('blend', () => {
		it('returns a color', () => {
			const result = colors.blend('red', 'blue');
			expect(result).toBeTruthy();
		});

		it('returns lightgray when background is white', () => {
			// When background matches this.background (white), blend returns lightgray
			const result = colors.blend('red', 'white');
			expect(result).toBe('lightgray');
		});
	});

	describe('special_blend', () => {
		it('blends two colors', () => {
			const result = colors.special_blend('red', 'blue', 0.5);
			expect(result).toBeTruthy();
			expect(result).toMatch(/^#[0-9a-f]{6}$/i);
		});

		it('returns null for invalid colors', () => {
			const result = colors.special_blend('notacolor', 'blue', 0.5);
			expect(result).toBeNull();
		});

		it('ratio 0 returns close to background', () => {
			const result = colors.special_blend('red', 'blue', 0);
			// At ratio 0, should be mostly blue
			expect(result).toBeTruthy();
		});

		it('ratio 1 returns close to foreground', () => {
			const result = colors.special_blend('red', 'blue', 1);
			// At ratio 1, should be mostly red
			expect(result).toBeTruthy();
		});
	});

	describe('luminance_driven_desaturation', () => {
		it('returns a color for light input', () => {
			const result = colors.luminance_driven_desaturation('#ffcccc');
			expect(result).toBeTruthy();
		});

		it('returns a color for dark input', () => {
			const result = colors.luminance_driven_desaturation('#330000');
			expect(result).toBeTruthy();
		});
	});

	describe('default values', () => {
		it('has sensible defaults', () => {
			expect(colors.default).toBe('black');
			expect(colors.background).toBe('white');
			expect(colors.default_forThings).toBe('blue');
		});
	});
});
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/Input.ts
```ts
import { quat } from 'gl-matrix';
import type { O_Scene } from '../types/Interfaces';
import { Point } from '../types/Coordinates';

type T_Handle_Drag = (delta: Point) => void;

class Input {
  private canvas!: HTMLCanvasElement;
  private is_dragging = false;
  private last_position: Point = Point.zero;
  private on_drag: T_Handle_Drag | null = null;

  init(canvas: HTMLCanvasElement): void {
    this.canvas = canvas;

    canvas.addEventListener('mousedown', (e) => {
      this.is_dragging = true;
      this.last_position = new Point(e.clientX, e.clientY);
    });

    window.addEventListener('mouseup', () => {
      this.is_dragging = false;
    });

    canvas.addEventListener('mousemove', (e) => {
      if (!this.is_dragging || !this.on_drag) return;
      const current = new Point(e.clientX, e.clientY);
      const delta = this.last_position.vector_to(current);
      this.last_position = current;
      this.on_drag(delta);
    });
  }

  set_drag_handler(callback: T_Handle_Drag): void {
    this.on_drag = callback;
  }

  rotate_object(obj: O_Scene, delta: Point, sensitivity = 0.01): void {
    const rot_x = quat.create();
    const rot_y = quat.create();
    quat.setAxisAngle(rot_x, [1, 0, 0], delta.y * sensitivity);
    quat.setAxisAngle(rot_y, [0, 1, 0], delta.x * sensitivity);
    quat.multiply(obj.orientation, rot_y, obj.orientation);
    quat.multiply(obj.orientation, rot_x, obj.orientation);
    quat.normalize(obj.orientation, obj.orientation);
  }
}

export const input = new Input();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/Camera.ts
```ts
import { mat4, vec3 } from 'gl-matrix';
import { Size } from '../types/Coordinates';

class Camera {
  readonly view: mat4 = mat4.create();
  readonly projection: mat4 = mat4.create();

  private eye: vec3 = vec3.fromValues(0, 0, 5);
  private center: vec3 = vec3.fromValues(0, 0, 0);
  private up: vec3 = vec3.fromValues(0, 1, 0);

  private fov = Math.PI / 4;
  private aspect = 1;
  private near = 0.1;
  private far = 100;

  init(size: Size): void {
    this.resize(size);
    this.update_view();
  }

  resize(size: Size): void {
    this.aspect = size.width / size.height;
    this.update_projection();
  }

  set_position(eye: vec3, center?: vec3): void {
    vec3.copy(this.eye, eye);
    if (center) vec3.copy(this.center, center);
    this.update_view();
  }

  set_fov(fov: number): void {
    this.fov = fov;
    this.update_projection();
  }

  private update_view(): void {
    mat4.lookAt(this.view, this.eye, this.center, this.up);
  }

  private update_projection(): void {
    mat4.perspective(this.projection, this.fov, this.aspect, this.near, this.far);
  }
}

export const camera = new Camera();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/Animation.ts
```ts
type T_Tick_Callback = (dt: number) => void;

class Animation {
  private callbacks: T_Tick_Callback[] = [];
  private last_time = 0;
  private running = false;

  start(): void {
    if (this.running) return;
    this.running = true;
    this.last_time = performance.now();
    this.loop();
  }

  stop(): void {
    this.running = false;
  }

  on_tick(callback: T_Tick_Callback): void {
    this.callbacks.push(callback);
  }

  private loop = (): void => {
    if (!this.running) return;

    const now = performance.now();
    const dt = (now - this.last_time) / 1000;
    this.last_time = now;

    for (const cb of this.callbacks) {
      cb(dt);
    }

    requestAnimationFrame(this.loop);
  };
}

export const animation = new Animation();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/Scene.ts
```ts
import { quat, vec3 } from 'gl-matrix';
import type { O_Scene } from '../types/Interfaces';
import { Point3 } from '../types/Coordinates';

class Scene {
  private objects: Map<string, O_Scene> = new Map();
  private id_counter = 0;

  create(config: {
    vertices: Point3[];
    edges: [number, number][];
    position?: vec3;
    scale?: number;
    color?: string;
    parent?: O_Scene;
  }): O_Scene {
    const id = `obj_${this.id_counter++}`;
    const obj: O_Scene = {
      id,
      vertices: config.vertices,
      edges: config.edges,
      orientation: quat.create(),
      position: config.position ?? vec3.fromValues(0, 0, 0),
      scale: config.scale ?? 1,
      color: config.color ?? 'rgba(255, 255, 255,',
      parent: config.parent,
    };
    this.objects.set(id, obj);
    return obj;
  }

  get(id: string): O_Scene | undefined {
    return this.objects.get(id);
  }

  get_all(): O_Scene[] {
    return Array.from(this.objects.values());
  }

  destroy(id: string): boolean {
    return this.objects.delete(id);
  }

  clear(): void {
    this.objects.clear();
  }
}

export const scene = new Scene();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/Render.ts
```ts
import { mat4, vec4 } from 'gl-matrix';
import type { Projected, O_Scene } from '../types/Interfaces';
import { Size, Point3 } from '../types/Coordinates';
import { camera } from './Camera';
import { scene } from './Scene';

class Render {
  private canvas!: HTMLCanvasElement;
  private ctx!: CanvasRenderingContext2D;
  private size: Size = Size.zero;

  private mvp_matrix = mat4.create();

  init(canvas: HTMLCanvasElement): void {
    this.canvas = canvas;
    this.ctx = canvas.getContext('2d')!;
    this.size = new Size(canvas.width, canvas.height);
  }

  resize(width: number, height: number): void {
    this.canvas.width = width;
    this.canvas.height = height;
    this.size = new Size(width, height);
    camera.resize(this.size);
  }

  render(): void {
    this.ctx.clearRect(0, 0, this.size.width, this.size.height);
    for (const obj of scene.get_all()) {
      this.render_object(obj);
    }
  }

  private get_world_matrix(obj: O_Scene): mat4 {
    const local = mat4.create();
    const scale_vec = [obj.scale, obj.scale, obj.scale] as [number, number, number];
    mat4.fromRotationTranslationScale(local, obj.orientation, obj.position, scale_vec);

    if (obj.parent) {
      const parent_world = this.get_world_matrix(obj.parent);
      mat4.multiply(local, parent_world, local);
    }

    return local;
  }

  private project_vertex(v: Point3, world_matrix: mat4): Projected {
    const point = vec4.fromValues(v.x, v.y, v.z, 1);

    mat4.multiply(this.mvp_matrix, camera.view, world_matrix);
    mat4.multiply(this.mvp_matrix, camera.projection, this.mvp_matrix);

    vec4.transformMat4(point, point, this.mvp_matrix);
    const w = point[3];
    return {
      x: (point[0] / w + 1) * 0.5 * this.size.width,
      y: (1 - point[1] / w) * 0.5 * this.size.height,
      z: point[2] / w,
      w,
    };
  }

  private render_object(obj: O_Scene): void {
    const world_matrix = this.get_world_matrix(obj);
    const projected = obj.vertices.map((v) => this.project_vertex(v, world_matrix));

    this.ctx.lineWidth = 2;
    this.ctx.lineCap = 'round';

    for (const [i, j] of obj.edges) {
      const a = projected[i],
        b = projected[j];
      if (a.w < 0 || b.w < 0) continue;
      const alpha = 0.3 + 0.7 * (1 - (a.z + b.z) / 2);
      this.ctx.strokeStyle = `${obj.color}${Math.max(0.2, Math.min(1, alpha)).toFixed(2)})`;
      this.ctx.beginPath();
      this.ctx.moveTo(a.x, a.y);
      this.ctx.lineTo(b.x, b.y);
      this.ctx.stroke();
    }
  }
}

export const render = new Render();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/index.ts
```ts
export { scene } from './Scene';
export { camera } from './Camera';
export { render } from './Render';
export { input } from './Input';
export { animation } from './Animation';
```

### /Users/sand/GitHub/mono/di/src/lib/ts/render/Trivial.ts
```ts
import { quat, vec3 } from 'gl-matrix';
import { scene } from './Scene';
import { camera } from './Camera';
import { render } from './Render';
import { input } from './Input';
import { animation } from './Animation';
import { Size, Point3 } from '../types/Coordinates';

// ============================================
// GEOMETRY
// ============================================

const cube_vertices: Point3[] = [
  new Point3(-1, -1, -1), new Point3(1, -1, -1), new Point3(1, 1, -1), new Point3(-1, 1, -1),
  new Point3(-1, -1,  1), new Point3(1, -1,  1), new Point3(1, 1,  1), new Point3(-1, 1,  1),
];

const cube_edges: [number, number][] = [
  [0, 1], [1, 2], [2, 3], [3, 0],
  [4, 5], [5, 6], [6, 7], [7, 4],
  [0, 4], [1, 5], [2, 6], [3, 7],
];

// ============================================
// INIT
// ============================================

export function init(canvas: HTMLCanvasElement) {
  // Initialize managers
  camera.init(new Size(canvas.width, canvas.height));
  render.init(canvas);
  input.init(canvas);

  // Create scene objects
  const outer_cube = scene.create({
    vertices: cube_vertices,
    edges: cube_edges,
    color: 'rgba(78, 205, 196,',
  });

  const inner_cube = scene.create({
    vertices: cube_vertices,
    edges: cube_edges,
    scale: 0.4,
    color: 'rgba(255, 107, 107,',
    parent: outer_cube,
  });

  // Initial rotation for outer cube
  const init_quat = quat.create();
  quat.setAxisAngle(init_quat, vec3.normalize(vec3.create(), [1, 1, 0]), 0.5);
  quat.multiply(outer_cube.orientation, init_quat, outer_cube.orientation);
  quat.normalize(outer_cube.orientation, outer_cube.orientation);

  // Input: drag rotates outer cube
  input.set_drag_handler((delta) => {
    input.rotate_object(outer_cube, delta);
  });

  // Animation: spin inner cube + render
  animation.on_tick(() => {
    const spin = quat.create();
    quat.setAxisAngle(spin, [0, 1, 0], 0.02);
    quat.multiply(inner_cube.orientation, spin, inner_cube.orientation);
    quat.normalize(inner_cube.orientation, inner_cube.orientation);

    render.render();
  });

  animation.start();
}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/state/S_Hit_Target.ts
```ts
import { T_Hit_Target, T_Mouse_Detection } from '../types/Enumerations';
import { Rect, Point } from '../types/Coordinates';
import S_Mouse from './S_Mouse';
import k from '../common/Constants';
import { get } from 'svelte/store';

// Forward declaration - will be set by Hits manager
let hits: { w_s_hover: any; add_hit_target: (target: S_Hit_Target) => void } | null = null;

export function setHitsManager(h: typeof hits) {
	hits = h;
}

export default class S_Hit_Target {

	// Supports hit testing for all user-interactables in the DOM

	mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
	containedIn_rect?: (rect: Rect | null) => boolean;
	contains_point?: (point: Point | null) => boolean;
	doubleClick_callback?: (s_mouse: S_Mouse) => void;
	longClick_callback?: (s_mouse: S_Mouse) => void;
	handle_s_mouse?: (s_mouse: S_Mouse) => boolean;
	html_element: HTMLElement | null = null;
	element_rect: Rect | null = null;
	autorepeat_callback?: () => void;
	defaultCursor = k.cursor_default;
	hoverCursor = k.cursor_default;
	autorepeat_event?: MouseEvent;
	autorepeat_isFirstCall = true;
	autorepeat_id?: number;
	type: T_Hit_Target;
	clicks: number = 0;
	id: string;
	
	constructor(type: T_Hit_Target, id: string) {
		this.id = type + '-' + id;
		this.type = type;
	}

	get rect(): Rect | null { return this.element_rect; }
	get isHovering(): boolean { return hits ? this.hasSameID_as(get(hits.w_s_hover)) : false; }
	set isHovering(isHovering: boolean) { if (hits) hits.w_s_hover.set(isHovering ? this : null); }

	get isADot(): boolean { return [T_Hit_Target.drag, T_Hit_Target.reveal].includes(this.type); }
	get isAWidget(): boolean { return this.type == T_Hit_Target.widget; }
	get isAControl(): boolean { return [T_Hit_Target.control, T_Hit_Target.button, T_Hit_Target.glow].includes(this.type); }
	get isRing(): boolean { return [T_Hit_Target.rotation, T_Hit_Target.resizing, T_Hit_Target.paging].includes(this.type); }

	get detects_longClick(): boolean { return (this.mouse_detection & T_Mouse_Detection.long) !== 0; }
	get detects_autorepeat(): boolean { return this.mouse_detection === T_Mouse_Detection.autorepeat; }
	get respondsTo_longClick(): boolean { return this.detects_longClick && !!this.longClick_callback; }
	get detects_doubleClick(): boolean { return (this.mouse_detection & T_Mouse_Detection.double) !== 0; }
	get respondsTo_autorepeat(): boolean { return this.detects_autorepeat && !!this.autorepeat_callback; }
	get respondsTo_doubleClick(): boolean { return this.detects_doubleClick && !!this.doubleClick_callback; }

	set rect(value: Rect | null) {
		this.element_rect = value;
		if (hits) hits.add_hit_target(this);
	}

	hasSameID_as(other: S_Hit_Target | null): boolean { return !!other && this.id == other.id; }

	set_html_element(html_element: HTMLElement | null) {
		if (!!html_element) {
			this.html_element = html_element;
			this.update_rect();
		}
	}

	update_rect() {
		if (!!this.html_element) {
			this.rect = Rect.rect_forElement(this.html_element);
		}
	}

}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/state/S_Component.ts
```ts
import { Rect, Point } from '../types/Coordinates';
import { T_Hit_Target } from '../types/Enumerations';
import S_Hit_Target from './S_Hit_Target';
import k from '../common/Constants';

// Formerly called Svelte Wrapper
// (?) style construction (by type and hid)
// manage signals and for debugging styles and DOM issues
// unique id assignment (of html elements) for DOM lookups

export default class S_Component extends S_Hit_Target {
	hid: number | null = null;

	// hit test (detect and rubberband), logger, emitter, handler and destroyer

	constructor(hid: number | null, type: T_Hit_Target) {
		super(type, `${type}-${hid ?? 'unknown'}`);
		this.hid = hid;
		this.id = this.component_id;
	}

	private get description(): string { return this.type; }

	private get component_id(): string {
		return `${this.type}-${this.hid ?? 'no-hid'}`;
	}

	// ===== DEBUG LOGGING =====
	
	private get element_debug_style(): string {
		const element = this.html_element;
		if (!!element) {
			const indented = k.newLine + k.tab;
			const style = element.getAttribute('style');
			if (!!style) {
				return style.replace(/; /g, indented).replace(/ :/g, ':').replace(/: /g, '\t');
			}
		}
		return 'no style information';
	}

	private style_debug_info(prefix: string): string {
		const element = this.html_element;
		if (!!element) {
			const indented = k.newLine + k.tab;
			const computed = window.getComputedStyle(element);
			return [prefix,
				indented + k.title.line,
				indented + this.element_debug_style,
				indented + k.title.line,
				indented + 'isConnected', element.isConnected,
				indented + 'computed.backgroundColor', computed.backgroundColor,
				indented + 'computed.display', computed.display,
				indented + 'computed.visibility', computed.visibility,
				indented + 'ownerDocument', element.ownerDocument === document ? 'main document' : 'different document',
				indented + (element.offsetParent === element.parentElement) ? 'positioning is normal' : 'offset is not parent'
			].join(k.tab);
		}
		return 'no style information';
	}

	private element_debug_info(prefix: string, element: HTMLElement | null | undefined): string {
		const indented = k.newLine + k.tab + prefix + k.space;
		const array = !element ? [] : [
			k.newLine + k.tab + k.title.line,
			indented + 'tagName', element.tagName,
			indented + 'isConnected', element.isConnected,
			indented + 'getBoundingClientRect', JSON.stringify(element.getBoundingClientRect()),
			indented + 'ownerDocument.contains', element.ownerDocument?.contains(element),
			indented + 'getRootNode', element.getRootNode()?.nodeName,
			indented + 'compareDocumentPosition', element.compareDocumentPosition(document.body) & 0x8 ? 'body contains ' + prefix : prefix + ' is orphaned',
			indented + 'closest body', element.closest('body')?.tagName];
		return array.join(k.tab);
	}

	get isComponentLog_enabled(): boolean {
		const log_isEnabledFor_type: { [key: string]: boolean } = {
			breadcrumbs: false,
			branches: false,
			radial: false,
			reveal: false,
			widget: false,
			title: false,
			drag: false,
			line: false,
			none: false,
			tree: false,
			app: false,
		}
		return log_isEnabledFor_type[this.type] ?? false;
	}

	debug_log_style(prefix: string) {
		if (!this.isComponentLog_enabled) { return; }
		const information = this.style_debug_info(prefix);
		if (!!information) {
			console.log(information);
		}
	}

	debug_log_connection_state(prefix: string) {
		if (!this.isComponentLog_enabled) { return; }
		const element = this.html_element;
		if (!!element) {
			const indented = k.newLine + k.tab;
			const type = this.type.toUpperCase();
			const array = [type, prefix, 'connection state', `(at ${new Date().toLocaleString()})`,
				indented + k.title.line,
				indented + this.style_debug_info('component'),
				indented + k.title.line,
				indented + 'previousSibling', element.previousSibling?.nodeName,
				indented + 'nextSibling', element.nextSibling?.nodeName,
			];
			array.push(this.element_debug_info('ELEMENT', element));
			console.log(array.join(k.tab));
		}
	}

}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/state/S_Mouse.ts
```ts
export default class S_Mouse {
	element: HTMLElement | null;	// null means mouse responder
	event: MouseEvent | null;		// null means mouse movement from global state
	isRepeat: boolean;
	isDouble: boolean;
	isMove: boolean;
	isLong: boolean;
	isDown: boolean;
	isUp: boolean;
	clicks = 0;

	//////////////////////////////////////////////
	//	encapsulate relevant event properties	//
	//	pass to buttons, widgets, radial & arcs	//
	//	isHovering is mirrored in S_Element		//
	//////////////////////////////////////////////

	constructor(event: MouseEvent | null, element: HTMLElement | null, isDown: boolean, isUp: boolean, isDouble: boolean = false, isLong: boolean = false, isMove: boolean = false, isRepeat: boolean = false) {
		this.isDouble = isDouble;
		this.isRepeat = isRepeat;
		this.element = element;
		this.isDown = isDown;
		this.isLong = isLong;
		this.isMove = isMove;
		this.event = event;
		this.isUp = isUp;
	}

	// Transient mouse states, for passing to parent																							down,   up,  double,          long,  move,  repeat

	static empty (event: MouseEvent | null = null)														  { return new S_Mouse(event, null,    false,  true); }
	static up    (event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  true); }
	static down  (event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, true,   false); }
	static long  (event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  false, false,          true); }
	static repeat(event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  false, false,          false, false, true); }
	static double(event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  false, true,           false); }
	static clicks(event: MouseEvent | null, element: HTMLElement | null, clickCount: number)			  { return new S_Mouse(event, element, false,  false, clickCount > 1, false); }
	
	get isShapeHit():	boolean { return false; }
	get notRelevant():	boolean { return !this.isDown && !this.isUp && !this.isDouble && !this.isLong && !this.isMove && !this.isRepeat; }
	descriptionFor(name: string = ''): string { return `${name} states: ${this.description}`; }

	get description(): string {
		let states: string[] = [];
		if (this.isUp) { states.push('up'); }
		if (this.isDown) { states.push('down'); }
		if (this.isLong) { states.push('long'); }
		if (this.isMove) { states.push('move'); }
		if (this.isDouble) { states.push('double'); }
		if (this.isRepeat) { states.push('repeat'); }
		return states.length == 0 ? 'empty mouse state' : states.join(', ');
	}

}
```

### /Users/sand/GitHub/mono/di/src/lib/ts/common/Testworthy_Utilities.ts
```ts
 // N.B., do not import these from Global Imports --> avoid dependency issues when importing Utilities class into test code

export type Dictionary<T = any> = Record<string, T>;

export class Testworthy_Utilities {
	private orderedKeysCache = new WeakMap<object, string[]>();

	ignore(event: Event)							{}
	t_or_f(value: boolean): string					{ return value ? '|' : '-'; }
	location_ofMouseEvent(event: MouseEvent): { x: number, y: number } { return { x: event.clientX, y: event.clientY }; }
	consume_event(event: Event)						{ event.preventDefault(); event.stopPropagation(); }

	// remove item from a dictionary at the index
	// assuming it has string keys and number values
	valueFrom_atIndex<T extends Record<string, number>>(dictionary: T, index: number): number {
		const propNames = Object.keys(dictionary) as Array<keyof T>;
		if (index < 0 || index >= propNames.length) {
			throw new Error(`Index ${index} is out of bounds`);
		}
		return dictionary[propNames[index]];
	}

	valueFrom_atIndex_usingMap<T extends Record<string, number>>(dictionary: T, index: number): number {
		// Get or create the ordered keys for this dictionary
		let orderedKeys = this.orderedKeysCache.get(dictionary);
		if (!orderedKeys) {
			orderedKeys = Object.keys(dictionary);
			this.orderedKeysCache.set(dictionary, orderedKeys);
		}

		if (index < 0 || index >= orderedKeys.length) {
			throw new Error(`Index ${index} is out of bounds`);
		}
		return dictionary[orderedKeys[index] as keyof T];
	}

	remove<T>(from: Array<T>, item: T): Array<T> {
		let array = from;
		const index = array.findIndex((element: T) => element === item);
		if (index !== -1) {
			array.splice(index, 1);
		}
		return array;
	}

	copyObject(obj: any): any {
		const copiedObject = Object.create(Object.getPrototypeOf(obj));
		Object.assign(copiedObject, obj);
		return copiedObject;
	}

	convertToObject(instance: any, fields: string[]): object {
		const o: Dictionary = {};
		for (const field of fields) {
			if (instance.hasOwnProperty(field)) {
				o[field] = instance[field];
			}
		}
		return o;
	}

	static readonly _____ARRAYS: unique symbol;

	concatenateArrays(a: Array<any>, b: Array<any>):  		  Array<any> { return [...a, ...b]; }
	strip_falsies(array: Array<any>):				  		  Array<any> { return array.filter(a => !!a); }
	subtract_arrayFrom(a: Array<any>, b: Array<any>): 		  Array<any> { return b.filter(c => a.filter(d => c != d)); }
	strip_invalid(array: Array<any>):				  		  Array<any> { return this.strip_duplicates(this.strip_falsies(array)); }
	uniquely_concatenateArrays(a: Array<any>, b: Array<any>): Array<any> { return this.strip_duplicates(this.concatenateArrays(a, b)); }
	convert_toNumber(values: Array<boolean>):					  number { return values.reduce((acc, val, index) => acc + (val ? (1 << index) : 0), 0); }

	remove_fromArray_byReference<T>(item: T, array: Array<T>): Array<T> {
		if (!item) return array;
		return array.filter(element => element !== item);
	}

	indexOf_inArray_byReference<T>(item: T, array: Array<T>): number {
		if (!item) return -1;
		return array.findIndex(element => element === item);
	}

	strip_duplicates(array: Array<any>): Array<any> {
		let stripped: Array<any> = [];
		for (const item of array) {
			if (!stripped.includes(item)) {
				stripped.push(item);
			}
		}
		return stripped;
	}

	static readonly _____JSON: unique symbol;

	stringify_object(object: Object): string {
		const ignored = [
			'hid',
			'state',
			'idBase',
			'hidChild',
			'hidParent',
			'isGrabbed',
			'bulkRootID',
			't_database',
			'persistence',
			'selectionRange',
		];
		function removeExtras(key: string, value: any): any | undefined {
			if (ignored.includes(key)) {
				return undefined;
			}
			return value;
		}
		return JSON.stringify(object, removeExtras, 1);
	}

	/**
	 * Returns the cumulative sum (prefix sum) array for the input array.
	 * Example: [10, 20, 30] => [10, 30, 60]
	 */
	cumulativeSum(array: Array<number>): Array<number> {
		const result: Array<number> = [];
		array.reduce((acc, val) => {
			const sum = acc + val;
			result.push(sum);
			return sum;
		}, 0);
		return result;
	}

}

export const tu = new Testworthy_Utilities();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/common/Extensions.ts
```ts
type Integer = number;

declare global {
	interface String {
		hash(): Integer;
		lastWord(): string;
		html_encode(): string;
		unCamelCase(): string;
		removeWhiteSpace(): string;
		encode_as_property(): string;
		decode_from_property(): string;
		injectEllipsisAt(at: number): string;
		clipWithEllipsisAt(at: number): string;
		fontSize_relativeTo(base: number): number;
		removeOccurencesOf(characters: string): string;
		beginWithEllipsis_forLength(length: number): string;
	}
}

Object.defineProperty(String.prototype, 'unCamelCase', {
	value: function(): string {
		return this.replace(/([A-Z])/g, ' $1').toLowerCase();
	},
	writable: false, // Set writable to false to prevent the method to be overwritten
	enumerable: false, // Set enumerable to false to avoid unintended behavior
	configurable: false // Set configurable to false to prevent redefinition of the property
});

Object.defineProperty(String.prototype, 'removeWhiteSpace', {
	value: function(): string {
		return this.split('\n').join(' ').split('\t').join('').trim();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'encode_as_property', {
	value: function(): string {
		// in ts, hyphens, spaces and parentheses are not allowed in property names
		return this.removeWhiteSpace().split(' ').join('_').split('-').join('$$$').split('(').join('$$').split(')').join('$');
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'decode_from_property', {
	value: function(): string {
		return this.split('$$$').join('-').split('$$').join('(').split('$').join(')');
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'removeOccurencesOf', {
	value: function(characters: string): string {
		if (!characters) return this;
		const pattern = new RegExp(`^[${characters}]+|[${characters}]+$`, 'g');
		return this.replace(pattern, '').trim();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'lastWord', {
	value: function(): string {
		return this.split(' ').slice(-1)[0];
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'fontSize_relativeTo', {
	value: function(base: number): number {
		if (this.includes('em')) {
			return base * parseFloat(this.split('em')[0]);
		} else if (this.includes('px')) {
			return Number(this.split('px')[0]);
		}
		return Number(this);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'injectEllipsisAt', {
	value: function(at: number = 6): string {
		let injected = this;
		const length = injected.length;
		if (length > (at * 2) + 1) {
			injected = injected.slice(0, at) + ' ... ' + injected.slice(length - at, length);
		}
		return injected;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'clipWithEllipsisAt', {
	value: function(at: number = 15): string {
		let clipped = this;
		const length = clipped.length;
		if (length > at) {
			clipped = clipped.slice(0, at) + ' ...';
		}
		return clipped;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'beginWithEllipsis_forLength', {
	value: function(length: number = 6): string {
		let injected = this;
		if (injected.length > length) {
			injected = ' ... ' + injected.slice(injected.length - length, injected.length);
		}
		return injected;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'hash', {
	value: function() {
		let hash = 0,
		i, character;
		if (this.length === 0) {
			return hash;
		}
		for (i = 0; i < this.length; i++) {
			character = this.charCodeAt(i);
			hash = ((hash << 5) - hash) + character;
			hash |= 0; // Convert to 32bit integer
		}
		return hash;
	},
	writable: true,
	enumerable: true,
	configurable: true
});

Object.defineProperty(String.prototype, 'sizeOf_svgPath', {
	value: function(): string {
		return this.split(' ').slice(-1)[0];
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'html_encode', {
	value: function(): string {
		let encoded = this.replace(/\n+/g, '').trim();
		return encodeURIComponent(encoded)
			.replace(/%22/g, '\'')	// un-encode for easier reading
			.replace(/%2B/g, '+')
			.replace(/%3A/g, ':')
			.replace(/%3F/g, '?')
			.replace(/%23/g, '#')
			.replace(/%2F/g, '/')
			.replace(/%3D/g, '=')
			.replace(/%20/g, ' ')
			// .replace(/%3C/g, '<')
			// .replace(/%3E/g, '>')
			;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

declare global {
	interface Number {
		nth(): string;
		asInt(): string;
		asDegrees(): string;
		roundToEven(): number;
		supressZero(): string;
		supressNegative(): string;
		angle_normalized(): number;
		toFixed(precision: number): string;
		angle_normalized_aroundZero(): number;
		degrees_of(precision: number): string;
		straddles_zero(other: number): boolean;
		add_angle_normalized(angle: number): number;
		normalize_between_zeroAnd(value: number): number;
		isAlmost(target: number, within: number): boolean;
		increment_by(delta: number, total: number): number;
		increment(increment: boolean, total: number): number;
		force_between(smallest: number, largest: number): number;
		isBetween(a: number, b: number, inclusive: boolean): boolean;
		isClocklyBetween(a: number, b: number, limit: number): boolean;
		of_n_for_type(n: number, type: string, plurality: string): string;
		force_asInteger_between(smallest: number, largest: number): number;
		bump_towards(smallest: number, largest: number, within: number): number;
		isClocklyAlmost(target: number, within: number, clock: number): boolean;
	}
}

Object.defineProperty(Number.prototype, 'isAlmost', {
	value: function(target: number, within: number): boolean {
		return Math.abs(this - target) < within;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'force_asInteger_between', {
	value: function(a: number, b: number): number {
		return Math.round(this.force_between(a, b));
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'force_between', {
	value: function(a: number, b: number): number {
		const largest = Math.max(a, b);
		const smallest = Math.min(a, b);
		return Math.max(smallest, Math.min(largest, this));
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'increment', {
	value: function(increase: boolean, total: number): number {
		return this.increment_by(increase ? 1 : -1, total);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'increment_by', {
	value: function(delta: number, total: number): number {
		let result = this.valueOf() + delta;
		return result.normalize_between_zeroAnd(total);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'add_angle_normalized', {
	value: function(angle: number): number {
		return (this + angle).angle_normalized();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'straddles_zero', {
	value: function(other: number): boolean {
		return this.angle_normalized() > other.angle_normalized();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'angle_normalized', {
	value: function(): number {
		return this.normalize_between_zeroAnd(Math.PI * 2);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'angle_normalized_aroundZero', {
	value: function(): number {
		// range from - to + PI
		return (this + Math.PI).angle_normalized() - Math.PI;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'isBetween', {
	value: function(a: number, b: number, inclusive: boolean): boolean {
		const min = Math.min(a, b),
			  max = Math.max(a, b);
		return inclusive ? (this >= min && this <= max) : (this > min && this < max);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'roundToEven', {
	value: function(): Integer {
		return (Math.round(this / 2) * 2) as Integer;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'asDegrees', {
	value: function(): string {
		return this.degrees_of(0);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'degrees_of', {
	value: function(precision: Integer): string {
		const degrees = this * 180 / Math.PI;
		return degrees.toFixed(precision);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'isClocklyBetween', {
	value: function(a: number, b: number, normalizeTo: number): boolean {
		const value = this.normalize_between_zeroAnd(normalizeTo);
		const cycled: number = value - normalizeTo;
		let min = Math.min(a, b),
			max = Math.max(a, b);
		return this.isBetween(min, max, true) || cycled.isBetween(min, max, true);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'isClocklyAlmost', {
	// after normalizing to normalizeTo, is this almost target (+/- within)?
	value: function(target: number, within: number, normalizeTo: number): boolean {
		return this.isClocklyBetween(target - within, target + within, normalizeTo);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'supressNegative', {
	value: function(): string | number {
		return this < 0 ? '' : this;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'supressZero', {
	value: function(): string | number {
		return this == 0 ? '-' : this;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'asInt', {
	value: function(): string {
		return this.toFixed(0);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'of_n_for_type', {
	value: function(n: number, type: string, plurality: string): string {
		return `${type}${n == 1 ? '' : plurality}: ${(this + 1).nth()} of ${n}`;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'nth', {
	value: function(): string {
		const prefix = this.asInt();
		const n = Number(prefix);
		let suffix = 'th';
		if (n < 10 || n > 20) {
			switch (n % 10) {
				case 1: suffix = 'st'; break;
				case 2: suffix = 'nd'; break;
				case 3: suffix = 'rd'; break;
			}
		}
		return prefix + suffix;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'toFixed', {
	value: function(precision: Integer): string {
		const formatter = new Intl.NumberFormat('en-US', {
			style: 'decimal',
			maximumFractionDigits: precision,
			minimumFractionDigits: precision,
			useGrouping: false
		});
		return formatter.format(this);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'bump_towards', {
	value: function(smallest: number, largest: number, within: number): number {
		if (this < smallest || this.isAlmost(smallest, within)) {
			return smallest;
		}
		if (this > largest || this.isAlmost(largest, within)) {
			return largest;
		}
		return this;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'normalize_between_zeroAnd', {

	// converts this using clock arithmetic
	// force between 0 and value
	// inclusive

	value: function(value: number): number {
		let result = this;
		if (value != 0) {
			while (result < 0) {
				result += value;
			}
			while (result >= value) {
				result -= value;
			}
		}
		return result;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

// Object.defineProperty(String.prototype, 'boilerplate', {
//	value: function(foo: number): string {
//		return k.empty;
//	},
//	enumerable: false, // Set enumerable to false to avoid unintended behavior
//	writable: false, // Set writable to false to prevent the method to be overwritten
//	configurable: false // Set configurable to false to prevent redefinition of the property
// });

export {};```

### /Users/sand/GitHub/mono/di/src/lib/ts/common/Constants.ts
```ts
import { Size, Point } from '../types/Coordinates';

const dot_size = 14;
const row_height = 16;
const rubberband_thickness = 1;
const tiny_outer_dots_expansion = 6;
const tiny_outer_dots_diameter = dot_size + tiny_outer_dots_expansion;

export default class Constants {

	details_margin = 0;
	halfIncrement = 0.5;
	separator_title_left = 0;
	hid_unknown = 1000000000000;
	radial_widget_inset = dot_size + 14;
	printer_aspect_ratio = 11.69 / 8.27;
	prevent_selection_style = '-webkit-user-select: none; user-select: none; -moz-user-select: none';
	nothing_to_show = 'Please select something to show here';
	name_bulkAdmin = 'Jonathan Sand';
	cursor_default = 'default';
	corrupted = 'corrupted';
	unknown = 'unknown';
	root = 'root';
	empty_id = '""';
	newLine = '\n';
	wildcard = '*';
	comma = ',';
	quote = '"';
	space = ' ';
	empty = '';
	tab = '\t';

	dasharray = {
		relateds: '4,3',
		editing:  '3,2',
	};

	width = {
		details:  219,
		child_gap: 20,
	};

	help_url = {
		local:  'http://localhost:8000/README.html',
		remote: 'https://help.webseriously.org',
	};

	title = {
		default: 'Please, enter a title',
		line:	 '------------------------',
	};

	ratio = {
		zoom_out: 0.9,
		zoom_in:  1.1
	};

	separator = {
		generic: '::',
		small:	 ':::',
		big:	 '::::',
	};

	threshold = {
		autorepeat:	  150,
		double_click: 400,
		alteration:	  500,
		long_click:	  800,
	};
	
	tiny_outer_dots = {
		diameter:	tiny_outer_dots_diameter,
		expansion:	tiny_outer_dots_expansion,
		size:		Size.square(tiny_outer_dots_diameter),
		offset:		Point.square(-tiny_outer_dots_expansion).offsetByXY(4.2, 5),
		viewBox:	`0.5 2.35 ${tiny_outer_dots_diameter} ${tiny_outer_dots_diameter}`,	
	};

	radius = {
		text_area_border:  7,
		arcSlider_cap: 	   7.5,
		ring_minimum:  	  55,
		fillets: { 
			thick:	   	  14,
			thin:		   8,
			ultra_thin:	   5,
		},
	};

	height = {
		separator: 7,
		empty:	   22,
		line:	   row_height + 2,
		segmented: row_height + 1,
		row:	   row_height,
		controls:  16,
		button:	   dot_size + 3,
		dot:	   dot_size,
	};

	font_size = {
		cluster_slider:	  dot_size - 5,
		instructions: dot_size - 4,
		separator:	  dot_size - 4,
		details:	  dot_size - 3,
		banners:	  dot_size - 2,
		info:		  dot_size - 1,
		common:		  dot_size,
		segmented:	  dot_size + 1,
		warning:	  dot_size + 2,
		tree_prefs:	  36,
	};

	thickness = {
		stroke:		 0.7,
		rubberband:	 rubberband_thickness,
		radial: {
			ring:	 44,
			arc:	 15,
			fork:	 2.5,
		},
		separator: {
			main:	 5,
			banners: 2.5,
			details: 0.75,
		},
	};

	opacity = {
		none:		  0,
		faint:		  0.1,
		light:		  0.2,
		medium:		  0.4,
		dark:		  0.7,
		cluster: {
			faint:	  0.02,
			armature: 0.1,
			thumb:	  0.1,
			hover:	  0.7,
			titles:	  1,
			active:	  0.3,
		},
	};
}

export const k = new Constants();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/draw/Colors.ts
```ts
import { get, writable } from 'svelte/store';
import { parseToRgba, transparentize } from 'color2k';
import { preferences, T_Preference } from '../managers/Preferences';

// single source of truth for all colors

export class Colors {
	// Static colors (non-reactive)
	border                    = 'darkgray';
	default                   = 'black';
	banner                    = '#f8f8f8';
	disabled                  = 'lightGray';
	separator                 = '#c55622ff';
	background                = 'white';
	rubberband                = '#4a90e2';
	default_forThings         = 'blue';
	thin_separator_line_color = '#999999';

	// Reactive colors (stores)
	w_thing_color      = writable<string | null>(null);
	w_text_color       = writable<string>('black');
	w_separator_color  = writable<string>(this.separator);
	w_background_color = writable<string>('#F9E4BE');

	constructor() {
		this.restore_preferences();
		this.subscribe_to_changes();
	}

	/**
	 * Load saved color preferences from localStorage
	 */
	restore_preferences() : void {
		const bg   = preferences.read<string>(T_Preference.backgroundColor);
		const text = preferences.read<string>(T_Preference.textColor);
		const sep  = preferences.read<string>(T_Preference.separatorColor);

		if (!!bg) this.w_background_color.set(bg);
		if (!!text) this.w_text_color.set(text);
		if (!!sep) this.w_separator_color.set(sep);
	}

	/**
	 * Subscribe to store changes and persist them
	 */
	private subscribe_to_changes() : void {
		this.w_background_color.subscribe((color : string) => {
			preferences.write(T_Preference.backgroundColor, color);
			this.banner = this.ofBannerFor(color);
		});

		this.w_text_color.subscribe((color : string) => {
			preferences.write(T_Preference.textColor, color);
		});

		this.w_separator_color.subscribe((color : string) => {
			preferences.write(T_Preference.separatorColor, color);
		});
	}

	ofBannerFor(background : string) : string { return this.blend('white', background, 4); }
	ofBackgroundFor(color : string) : string { return this.lighterBy(color, 10); }
	opacitize(color : string, amount : number) : string { return color == '' ? '' : transparentize(color, 1 - amount); }
	background_special_blend(color : string, opacity : number) : string { return this.special_blend(color, get(this.w_background_color), opacity) ?? color; }

	color_fromSeriously(color : string | undefined) : string {
		if (!!color) {
			const parts = color.split(',');				// 'red:0.7,green:0,blue:0,alpha:1'
			const rgba  = new RGBA();
			for (const part of parts) {
				const [key, value] = part.split(':');
				const numValue     = parseFloat(value);
				switch (key) {
					case 'red':   rgba.r = Math.round(numValue * 255); break;
					case 'blue':  rgba.b = Math.round(numValue * 255); break;
					case 'green': rgba.g = Math.round(numValue * 255); break;
					case 'alpha': rgba.a = numValue;                   break;
				}
			}
			return this.RGBA_toHex(rgba);
		}
		return this.default_forThings;
	}

	blend(color : string, background : string, saturation : number = 7) : string {
		let blended : string | null = 'lightgray';
		if (!this.colors_areIdentical(background, this.background)) {
			if (this.isGray(background)) {
				blended = this.darkerBy(background, 1 / saturation);
			} else {
				blended = this.multiply_saturationOf_by(background, saturation);
			}
		}
		if (!!blended) {
			color = blended;
		}
		return color;
	}

	special_blend(color : string, background : string, ratio : number) : string | null {
		const rgbaA = this.color_toRGBA(color);
		const rgbaB = this.color_toRGBA(background);
		if (!rgbaA || !rgbaB) return null;
		const alpha = rgbaA.a * ratio;
		const r     = Math.round((rgbaA.r * alpha) + (rgbaB.r * (1 - alpha)));
		const g     = Math.round((rgbaA.g * alpha) + (rgbaB.g * (1 - alpha)));
		const b     = Math.round((rgbaA.b * alpha) + (rgbaB.b * (1 - alpha)));
		const blendedHex = this.RGBA_toHex(new RGBA(r, g, b, 1));
		return this.multiply_saturationOf_by(blendedHex, 1 + ratio);
	}

	// ═══════════════════════════════════════════════════════════════════════════
	// SATURATION
	// ═══════════════════════════════════════════════════════════════════════════

	/**
	 * Multiplies the saturation of a color by the given ratio.
	 */
	private multiply_saturationOf_by(color : string, ratio : number) : string {
		const hsba = this.color_toHSBA(color);
		if (!!hsba) {
			hsba.s     = Math.min(255, hsba.s * ratio);
			const rgba = this.HSBA_toRGBA(hsba);
			return this.RGBA_toHex(rgba);
		}
		return color;
	}

	// ═══════════════════════════════════════════════════════════════════════════
	// LUMINANCE
	// ═══════════════════════════════════════════════════════════════════════════

	darkerBy(color : string, ratio : number) : string {
		return this.adjust_luminance_byApplying(color, (lume => {
			return (1 - lume) * (1 + ratio);
		}));
	}

	lighterBy(color : string, ratio : number) : string {
		return this.adjust_luminance_byApplying(color, (lume => {
			return Math.max(0, (1 - lume) / ratio);
		}));
	}

	luminance_driven_desaturation(color : string) : string {
		const lume = this.luminance_ofColor(color);
		if (lume > 0.5) {
			color = this.blend(color, 'black') ?? color;
		} else {
			color = this.blend(color, color) ?? color;
		}
		return color;
	}

	luminance_ofColor(color : string) : number {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return this.luminance_ofRGBA(rgba);
		}
		return 0;
	}

	private luminance_ofRGBA(rgba : RGBA) : number {
		if (!!rgba) {
			const linearize = (c : number) => {
				const s = c / 255;
				return s <= 0.04045 ? s / 12.92 : Math.pow((s + 0.055) / 1.055, 2.4);
			};
			const R        = linearize(rgba.r);
			const G        = linearize(rgba.g);
			const B        = linearize(rgba.b);
			const relative = 0.2126 * R + 0.7152 * G + 0.0722 * B;
			return rgba.a * relative + (1 - rgba.a) * 1;
		}
		return 0;
	}

	private adjust_luminance_byApplying(color : string, closure : (lume : number) => number) : string {
		let result = 'null';
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			const lume = this.luminance_ofRGBA(rgba);
			if (!!lume) {
				const dark     = closure(lume);
				const adjusted = this.set_darkness_toRGBA(rgba, dark);
				result = adjusted ?? result;
			}
		}
		return result;
	}

	// ═══════════════════════════════════════════════════════════════════════════
	// DARKNESS
	// ═══════════════════════════════════════════════════════════════════════════

	private set_darkness_toRGBA(rgba : RGBA, darkness : number) : string {
		const adjusted = this.adjust_RGBA_forDarkness(rgba, darkness);
		const rgba_new = adjusted.result;
		if (!adjusted.error && !!rgba_new) {
			return this.RGBA_toHex(rgba_new);
		}
		return this.RGBA_toHex(rgba);
	}

	private adjust_RGBA_forDarkness(rgba : RGBA, targetDarkness : number) : { result : RGBA | null; error : Error | null } {
		const r = rgba.r;
		const g = rgba.g;
		const b = rgba.b;
		const a = rgba.a;

		if (a == 0) {
			if (targetDarkness != 0) {
				return { result: rgba, error: new Error('With zero alpha, only target darkness 0 is possible.') };
			}
		}
		if (targetDarkness > a) {
			return { result: rgba, error: new Error('Target darkness must be <= alpha.') };
		}

		const srgbToLinear = (c : number) : number => {
			const s = c / 255;
			return s <= 0.04045 ? s / 12.92 : Math.pow((s + 0.055) / 1.055, 2.4);
		};
		const linearToSrgb = (c : number) : number => {
			return c <= 0.0031308 ? c * 12.92 : 1.055 * Math.pow(c, 1 / 2.4) - 0.055;
		};

		const R_lin = srgbToLinear(r);
		const G_lin = srgbToLinear(g);
		const B_lin = srgbToLinear(b);
		const Y     = 0.2126 * R_lin + 0.7152 * G_lin + 0.0722 * B_lin;

		if (Y == 0) {
			if (targetDarkness != 1) {
				return { result: null, error: new Error('Cannot adjust a black color to be lighter while preserving hue.') };
			}
			return { result: rgba, error: null };
		}

		const Y_new = (a - targetDarkness) / a;
		if (Y_new < 0 || Y_new > 1) {
			return { result: null, error: new Error('Computed target luminance out of range.') };
		}

		const k         = Y_new / Y;
		const R_new_lin = Math.min(R_lin * k, 1);
		const G_new_lin = Math.min(G_lin * k, 1);
		const B_new_lin = Math.min(B_lin * k, 1);
		const R_new     = Math.round(linearToSrgb(R_new_lin) * 255);
		const G_new     = Math.round(linearToSrgb(G_new_lin) * 255);
		const B_new     = Math.round(linearToSrgb(B_new_lin) * 255);

		return { result: new RGBA(R_new, G_new, B_new, a), error: null };
	}

	// ═══════════════════════════════════════════════════════════════════════════
	// CONVERSIONS
	// ═══════════════════════════════════════════════════════════════════════════

	private colors_areIdentical(a : string, b : string) : boolean {
		const aHex = this.color_toHex(a);
		const bHex = this.color_toHex(b);
		if (!!aHex && !!bHex) {
			return aHex == bHex;
		}
		return false;
	}

	private color_toHex(color : string) : string {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return this.RGBA_toHex(rgba);
		}
		return color;
	}

	private color_toHSBA(color : string) : HSBA | null {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return this.RBGA_toHSBA(rgba);
		}
		return null;
	}

	private color_toRGBA(color : string) : RGBA | null {
		try {
			const [r, g, b, a] = parseToRgba(color);
			return new RGBA(r, g, b, a);
		} catch {
			return null;
		}
	}

	private isGray(color : string) : boolean {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return rgba.r == rgba.g && rgba.g == rgba.b;
		}
		return false;
	}

	private RGBA_toHex(rgba : RGBA, omitAlpha : boolean = true) : string {
		const r    = Math.min(255, Math.max(0, rgba.r));
		const g    = Math.min(255, Math.max(0, rgba.g));
		const b    = Math.min(255, Math.max(0, rgba.b));
		const a    = Math.min(1, Math.max(0, rgba.a));
		const rHex = r.toString(16).padStart(2, '0');
		const gHex = g.toString(16).padStart(2, '0');
		const bHex = b.toString(16).padStart(2, '0');
		const aHex = Math.round(a * 255).toString(16).padStart(2, '0');
		const withoutAlpha = `#${rHex}${gHex}${bHex}`;
		if (omitAlpha) {
			return withoutAlpha;
		} else {
			return `${withoutAlpha}${aHex}`;
		}
	}

	private HSBA_toRGBA(hsba : HSBA) : RGBA {
		const h = hsba.h;
		const s = hsba.s / 100;
		const b = hsba.b / 100;
		const a = hsba.a;
		const c = b * s;
		const x = c * (1 - Math.abs((h / 60) % 2 - 1));
		const m = b - c;
		let r = 0, g = 0, b2 = 0;

		if (h >= 0 && h < 60)         { r = c; g = x; b2 = 0; }
		else if (h >= 60 && h < 120)  { r = x; g = c; b2 = 0; }
		else if (h >= 120 && h < 180) { r = 0; g = c; b2 = x; }
		else if (h >= 180 && h < 240) { r = 0; g = x; b2 = c; }
		else if (h >= 240 && h < 300) { r = x; g = 0; b2 = c; }
		else if (h >= 300 && h < 360) { r = c; g = 0; b2 = x; }

		r  = Math.round((r + m) * 255);
		g  = Math.round((g + m) * 255);
		b2 = Math.round((b2 + m) * 255);
		return new RGBA(r, g, b2, a);
	}

	private RBGA_toHSBA(rgba : RGBA) : HSBA {
		const r     = rgba.r / 255;
		const g     = rgba.g / 255;
		const b     = rgba.b / 255;
		const max   = Math.max(r, g, b);
		const min   = Math.min(r, g, b);
		const delta = max - min;
		let h = 0;

		if (delta != 0) {
			if (max == r)      { h = (g - b) / delta; }
			else if (max == g) { h = (b - r) / delta + 2; }
			else               { h = (r - g) / delta + 4; }
			h = (h * 60 + 360) % 360;
		}

		const s      = max == 0 ? 0 : (delta / max) * 100;
		const bValue = max * 100;
		return new HSBA(h, s, bValue, rgba.a);
	}
}

class RGBA {
	r : number;
	g : number;
	b : number;
	a : number;

	constructor(r : number = 0, g : number = 0, b : number = 0, a : number = 0) {
		this.r = r;
		this.g = g;
		this.b = b;
		this.a = a;
	}
}

class HSBA {
	h : number;
	s : number;
	b : number;
	a : number;

	constructor(h : number = 0, s : number = 0, b : number = 0, a : number = 0) {
		this.h = h;
		this.s = s;
		this.b = b;
		this.a = a;
	}
}

export const colors = new Colors();
```

### /Users/sand/GitHub/mono/di/src/lib/ts/draw/SVG_Paths.ts
```ts
import { Point } from '../types/Coordinates';
import Angle, { Direction } from '../types/Angle';

export class SVG_Paths {

	fillets(center : Point, radius : number, direction : Direction) : string {
		const baseAngle     = direction + Angle.half;
		const leftEndAngle  = baseAngle + Angle.quarter;
		const rightEndAngle = baseAngle - Angle.quarter;
		const a_start       = center.offsetBy(Point.fromPolar(radius, leftEndAngle));
		const a_end         = center.offsetBy(Point.fromPolar(radius, baseAngle));
		const b_end         = center.offsetBy(Point.fromPolar(radius, rightEndAngle));
		const leftArc       = `A ${radius} ${radius} 0 0 0 ${a_end.x} ${a_end.y}`;
		const rightArc      = `A ${radius} ${radius} 0 0 0 ${b_end.x} ${b_end.y}`;
		return `M ${a_start.x} ${a_start.y} ${leftArc} ${rightArc} L ${a_start.x} ${a_start.y} Z`;
	}

	fillets_bounds(radius : number, direction : Direction) : { minX : number; minY : number; width : number; height : number } {
		const baseAngle     = direction + Angle.half;
		const leftEndAngle  = baseAngle + Angle.quarter;
		const rightEndAngle = baseAngle - Angle.quarter;
		const a_start       = Point.fromPolar(radius, leftEndAngle);
		const a_end         = Point.fromPolar(radius, baseAngle);
		const b_end         = Point.fromPolar(radius, rightEndAngle);
		const minX          = Math.min(a_start.x, a_end.x, b_end.x);
		const maxX          = Math.max(a_start.x, a_end.x, b_end.x);
		const minY          = Math.min(a_start.y, a_end.y, b_end.y);
		const maxY          = Math.max(a_start.y, a_end.y, b_end.y);
		return { minX, minY, width : maxX - minX, height : maxY - minY };
	}

}

export const svg_paths = new SVG_Paths();
```

### /Users/sand/GitHub/mono/.DS_Store
```DS_Store
   Bud1                                                                      _ m o d u l                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  n o d e _ m o d u l e slg1Scomp    =�3^    n o d e _ m o d u l e smoDDblob   ���g܊�A    n o d e _ m o d u l e smodDblob   ���g܊�A    n o d e _ m o d u l e sph1Scomp    MK`     n o t e slg1Scomp     d    n o t e smoDDblob   �}j܊�A    n o t e smodDblob   �}j܊�A    n o t e sph1Scomp     qp     w slsvCblob  Dbplist00�	
WXYZ[_viewOptionsVersion_showIconPreviewWcolumns_calculateAllSizes_scrollPositionYXtextSize_scrollPositionXZsortColumnXiconSize_useRelativeDates	�$(-27<@EINR�WvisibleYascendingUwidthZidentifier		,Tname�UwidthYascendingWvisibleXubiquity#�"#	�\dateModified�"'[dateCreated�+,	aTsize�01		sTkind�56	dUlabel�:;	KWversion�?	Xcomments�CD�^dateLastOpened�F"YdateAdded�KM�ZshareOwner�KQ_shareLastEditor�KU_invitationStatus#@r�     #@(      #        Tname#@0      	   2 D L ` r { � � � � � � � � � � � � � � � �&()*3457DMNO[defhmvwxz���������������������������!*+,?@IR[`i             ]              j    w slsvpblob  �bplist00�	
FGHIJ_viewOptionsVersion_showIconPreviewWcolumns_calculateAllSizes_scrollPositionYXtextSize_scrollPositionXZsortColumnXiconSize_useRelativeDates	� %*/47<@XcommentsUlabelWversion[dateCreatedTsize\dateModifiedTkindTname^dateLastOpened�UindexYascendingUwidthWvisible	,�!#	d�&(	K�+-��02a	�-	�8:	s	�= 		�AC�#@r�     #@(      #        Tname#@0      	   2 D L ` r { � � � � � � � � � � � � �	!'17?ABEFOQRTU^`acdmoprs|~�������������������������             L              �    w svSrnlong                                                                                                                                                                                    E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         DSDB                                 `          �                                        @      �                                          @      �                                          @       calculateAllSizes_scrollPositionYXtextSize_scrollPositionXZsortColumnXiconSize_useRelativeDates	� %*/47<@XcommentsUlabelWversion[dateCreatedTsize\dateModifiedTkindTname^dateLastOpened�UindexYascendingUwidthWvisible	,�!#	d�&(	K�+-��02a	�-	�8:	s	�= 		�AC�#@r�     #@(      #        Tname#@0      	   2 D L ` r { � � � � � � � � � � � � �	!'17?ABEFOQRTU^`acdmoprs|~�������������������������             L              �    w svSrnlong                                                                                                                                                                        ```

### /Users/sand/GitHub/mono/.obsidian/workspace.json
```json
{
  "main": {
    "id": "db1d1909f4bd59be",
    "type": "split",
    "children": [
      {
        "id": "af573df4ca2bdd2d",
        "type": "tabs",
        "children": [
          {
            "id": "775fd6229ee0a2d1",
            "type": "leaf",
            "state": {
              "type": "markdown",
              "state": {
                "file": "notes/guides/tools/hub-app.md",
                "mode": "source",
                "source": false
              },
              "icon": "lucide-file",
              "title": "hub-app"
            }
          },
          {
            "id": "aad679d4ff97fd7e",
            "type": "leaf",
            "state": {
              "type": "markdown",
              "state": {
                "file": "di/notes/work/milestones/5.smart.objects.md",
                "mode": "source",
                "source": false
              },
              "icon": "lucide-file",
              "title": "5.smart.objects"
            }
          },
          {
            "id": "1b99de89086dbf1e",
            "type": "leaf",
            "state": {
              "type": "markdown",
              "state": {
                "file": "ws/notes/work/deliverables.md",
                "mode": "source",
                "source": false
              },
              "icon": "lucide-file",
              "title": "deliverables"
            }
          }
        ],
        "currentTab": 2
      }
    ],
    "direction": "vertical"
  },
  "left": {
    "id": "45724c3e6acad166",
    "type": "split",
    "children": [
      {
        "id": "7131393e7c0f1ec3",
        "type": "tabs",
        "children": [
          {
            "id": "26b78cd156d15e82",
            "type": "leaf",
            "state": {
              "type": "file-explorer",
              "state": {
                "sortOrder": "alphabetical",
                "autoReveal": false
              },
              "icon": "lucide-folder-closed",
              "title": "Files"
            }
          },
          {
            "id": "32946b464b2686ef",
            "type": "leaf",
            "state": {
              "type": "search",
              "state": {
                "query": "\"Rule needed\"",
                "matchingCase": false,
                "explainSearch": false,
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical"
              },
              "icon": "lucide-search",
              "title": "Search"
            }
          },
          {
            "id": "f405f4d5b909d423",
            "type": "leaf",
            "state": {
              "type": "bookmarks",
              "state": {},
              "icon": "lucide-bookmark",
              "title": "Bookmarks"
            }
          }
        ]
      }
    ],
    "direction": "horizontal",
    "width": 316.5
  },
  "right": {
    "id": "d9854c86a0d31055",
    "type": "split",
    "children": [
      {
        "id": "734cf31ac27881aa",
        "type": "tabs",
        "children": [
          {
            "id": "9285cc29b8659a56",
            "type": "leaf",
            "state": {
              "type": "backlink",
              "state": {
                "file": "notes/work/class-lists.md",
                "collapseAll": true,
                "extraContext": false,
                "sortOrder": "alphabetical",
                "showSearch": false,
                "searchQuery": "",
                "backlinkCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-coming-in",
              "title": "Backlinks for class-lists"
            }
          },
          {
            "id": "26936b00215c2b2a",
            "type": "leaf",
            "state": {
              "type": "outgoing-link",
              "state": {
                "file": "notes/work/class-lists.md",
                "linksCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-going-out",
              "title": "Outgoing links from class-lists"
            }
          },
          {
            "id": "e20af7f1507efb97",
            "type": "leaf",
            "state": {
              "type": "tag",
              "state": {
                "sortOrder": "frequency",
                "useHierarchy": true,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-tags",
              "title": "Tags"
            }
          },
          {
            "id": "d83ef371139dd3ce",
            "type": "leaf",
            "state": {
              "type": "all-properties",
              "state": {
                "sortOrder": "frequency",
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-archive",
              "title": "All properties"
            }
          },
          {
            "id": "1c8db68f687bfaed",
            "type": "leaf",
            "state": {
              "type": "outline",
              "state": {
                "file": "ws/notes/work/deliverables.md",
                "followCursor": false,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-list",
              "title": "Outline of deliverables"
            }
          }
        ],
        "currentTab": 4
      }
    ],
    "direction": "horizontal",
    "width": 377.5
  },
  "left-ribbon": {
    "hiddenItems": {
      "switcher:Open quick switcher": false,
      "graph:Open graph view": false,
      "canvas:Create new canvas": false,
      "daily-notes:Open today's daily note": false,
      "templates:Insert template": false,
      "command-palette:Open command palette": false,
      "bases:Create new base": false
    }
  },
  "active": "1b99de89086dbf1e",
  "lastOpenFiles": [
    "notes/tools/scripts/snapshot.md",
    "notes/tools/scripts/snapshot.sh",
    "notes/tools/scripts/bundle.sh",
    "ws/notes/work/revisit.md",
    "ws/notes/work/deliverables.md",
    "ws/notes/work/handoff.md",
    "notes/work/handoff.md",
    "di/notes/work/revisit.md",
    "notes/guides/tools/hub-app.md",
    "ws/vite.config.js.timestamp-1769835665936-cfc1c8716c6c9.mjs",
    "notes/guides/setup/onboarding.md",
    "ws/vite.config.js.timestamp-1769834824371-e67ebe55a9e8.mjs",
    "di/notes/work/milestones/5.smart.objects.md",
    "di/src/lib/ts/types/Attribute.ts",
    "di/src/lib/ts/runtime/Smart_Object.ts",
    "CLAUDE.MD",
    "notes/work/feedstock.md",
    "notes/guides/pre-flight/always.md",
    "notes/work/raw.md",
    "notes/work/index.md",
    "notes/work/mistakes.md",
    "notes/work/revisit.md",
    "di/notes/designs/index.md",
    "node_modules/katex/node_modules/commander/lib/command.js",
    "node_modules/katex/node_modules/commander/lib/option.js",
    "node_modules/katex/node_modules/commander/lib/help.js",
    "node_modules/katex/node_modules/commander/lib/suggestSimilar.js",
    "node_modules/katex/node_modules/commander/Readme.md",
    "node_modules/commander/History.md",
    "di/notes/designs/Graph.md",
    "di/notes/designs/Controls.md",
    "di/notes/designs/Box.md",
    "di/notes/designs/Preferences.md",
    "di/notes/designs/Separator.md",
    "di/notes/architecture/rendering.types.md",
    "di/notes/architecture/project.md",
    "ws/node_modules/@vitest/ui/dist/client/favicon.svg",
    "ws/node_modules/@vitest/ui/dist/client/bg.png",
    "ws/dist/assets/seriously-icon.png",
    "ws/node_modules/undici/docs/assets/lifecycle-diagram.png",
    "ws/src/assets/svelte.svg",
    "ws/src/assets/seriously-icon.png",
    "ws/src/assets/information-svgrepo-com.svg",
    "ws/src/assets/construction-equipment-hammer-tool-repair-tools-svgrepo-com.svg",
    "ws/src/assets/cloud-progress-svgrepo-com.svg",
    "ws/src/assets/clock-activity-svgrepo-com.svg"
  ]
}```

### /Users/sand/GitHub/mono/.obsidian/app.json
```json
{
  "alwaysUpdateLinks": true
}```

### /Users/sand/GitHub/mono/.obsidian/core-plugins.json
```json
{
  "file-explorer": true,
  "global-search": true,
  "switcher": true,
  "graph": true,
  "backlink": true,
  "canvas": true,
  "outgoing-link": true,
  "tag-pane": true,
  "footnotes": false,
  "properties": true,
  "page-preview": true,
  "daily-notes": true,
  "templates": true,
  "note-composer": true,
  "command-palette": true,
  "slash-command": false,
  "editor-status": true,
  "bookmarks": true,
  "markdown-importer": false,
  "zk-prefixer": false,
  "random-note": false,
  "outline": true,
  "word-count": true,
  "slides": false,
  "audio-recorder": false,
  "workspaces": false,
  "file-recovery": true,
  "publish": false,
  "sync": true,
  "bases": true,
  "webviewer": false
}```

### /Users/sand/GitHub/mono/.obsidian/appearance.json
```json
{}```

### /Users/sand/GitHub/mono/.claude/settings.local.json
```json
{
  "permissions": {
    "allow": [
      "Bash(lsof:*)",
      "Bash(curl:*)",
      "WebFetch(domain:docs.gizmolab.com)",
      "WebFetch(domain:monorepo-documentation.netlify.app)",
      "Bash(ls:*)",
      "Bash(git -C ~/GitHub/mono status notes/ws/)",
      "Bash(git -C ~/GitHub/mono ls-files:*)",
      "Bash(git -C ~/GitHub/mono status:*)",
      "Bash(git -C:*)",
      "Bash(python3:*)",
      "Bash(npx tsc:*)",
      "Bash(npm run build:*)",
      "Bash(npm test:*)",
      "WebSearch"
    ]
  }
}
```

### /Users/sand/GitHub/mono/README.md
```md
# Shared Documentation & Tools

This repo contains common guides and tools shared across projects.

## Structure

```
shared/
  guides/
    collaborate/    ← working with Claude
    develop/        ← coding patterns
    test/           ← debugging, testing
  tools/
    lib/            ← TypeScript tools for VitePress docs
```

## Guides

Read these to understand how we work:

- `guides/collaborate/voice.md` — writing style
- `guides/collaborate/chat.md` — problem-solving with Claude
- `guides/collaborate/workflow.md` — the meta-system
- `guides/develop/markdown.md` — doc formatting patterns
- `guides/test/debugging.md` — systematic debugging

## Tools

TypeScript tools for VitePress documentation management:

- `fix-links.ts` — find and fix broken links
- `merge-files.ts` — merge markdown files, update references
- `sync-sidebar.ts` — regenerate sidebar from filesystem
- `generate-sidebar.ts` — sidebar generation logic
- `markdown-parser.ts` — link parsing and updating
- `link-finder.ts` — file search utilities
- `config-updater.ts` — VitePress config manipulation

### Usage

Projects compile these tools locally:

```bash
cd <project>/notes/tools
npx tsc -p ../../shared/tools/tsconfig.json --outDir ./dist
node dist/fix-links.js
```

## For Projects Using This Repo

Each project's CLAUDE.MD should include:

```markdown
COMMON: Read ../shared/CLAUDE.MD and guides first
```

Clone as sibling:
```
~/GitHub/
  shared/        ← this repo
  di/            ← project
  webseriously/  ← project
```
```

### /Users/sand/GitHub/mono/yarn.lock
```lock
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


"@acemir/cssom@^0.9.28":
  version "0.9.31"
  resolved "https://registry.yarnpkg.com/@acemir/cssom/-/cssom-0.9.31.tgz#bd5337d290fb8be2ac18391f37386bc53778b0bc"
  integrity sha512-ZnR3GSaH+/vJ0YlHau21FjfLYjMpYVIzTD8M8vIEQvIGxeOXyXdzCI140rrCY862p/C/BbzWsjc1dgnM9mkoTA==

"@algolia/abtesting@1.13.0":
  version "1.13.0"
  resolved "https://registry.yarnpkg.com/@algolia/abtesting/-/abtesting-1.13.0.tgz#88bbf09c5846fbe9a213461ea8bfdcf756c060dd"
  integrity sha512-Zrqam12iorp3FjiKMXSTpedGYznZ3hTEOAr2oCxI8tbF8bS1kQHClyDYNq/eV0ewMNLyFkgZVWjaS+8spsOYiQ==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/autocomplete-core@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-core/-/autocomplete-core-1.17.7.tgz#2c410baa94a47c5c5f56ed712bb4a00ebe24088b"
  integrity sha512-BjiPOW6ks90UKl7TwMv7oNQMnzU+t/wk9mgIDi6b1tXpUek7MW0lbNOUHpvam9pe3lVCf4xPFT+lK7s+e+fs7Q==
  dependencies:
    "@algolia/autocomplete-plugin-algolia-insights" "1.17.7"
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-plugin-algolia-insights@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-plugin-algolia-insights/-/autocomplete-plugin-algolia-insights-1.17.7.tgz#7d2b105f84e7dd8f0370aa4c4ab3b704e6760d82"
  integrity sha512-Jca5Ude6yUOuyzjnz57og7Et3aXjbwCSDf/8onLHSQgw1qW3ALl9mrMWaXb5FmPVkV3EtkD2F/+NkT6VHyPu9A==
  dependencies:
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-preset-algolia@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-preset-algolia/-/autocomplete-preset-algolia-1.17.7.tgz#c9badc0d73d62db5bf565d839d94ec0034680ae9"
  integrity sha512-ggOQ950+nwbWROq2MOCIL71RE0DdQZsceqrg32UqnhDz8FlO9rL8ONHNsI2R1MH0tkgVIDKI/D0sMiUchsFdWA==
  dependencies:
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-shared@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-shared/-/autocomplete-shared-1.17.7.tgz#105e84ad9d1a31d3fb86ba20dc890eefe1a313a0"
  integrity sha512-o/1Vurr42U/qskRSuhBH+VKxMvkkUVTLU6WZQr+L5lGZZLYWyhdzWjW0iGXY7EkwRTjBqvN2EsR81yCTGV/kmg==

"@algolia/client-abtesting@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-abtesting/-/client-abtesting-5.47.0.tgz#0d64f45844dcf18cebe9d1dae183052ec3d3f6cb"
  integrity sha512-aOpsdlgS9xTEvz47+nXmw8m0NtUiQbvGWNuSEb7fA46iPL5FxOmOUZkh8PREBJpZ0/H8fclSc7BMJCVr+Dn72w==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/client-analytics@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-analytics/-/client-analytics-5.47.0.tgz#239ce66964a766316ec2e3a6a1773dfa89f13203"
  integrity sha512-EcF4w7IvIk1sowrO7Pdy4Ako7x/S8+nuCgdk6En+u5jsaNQM4rTT09zjBPA+WQphXkA2mLrsMwge96rf6i7Mow==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/client-common@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-common/-/client-common-5.47.0.tgz#de05deb8c058e9f125eea51de317ab1406247642"
  integrity sha512-Wzg5Me2FqgRDj0lFuPWFK05UOWccSMsIBL2YqmTmaOzxVlLZ+oUqvKbsUSOE5ud8Fo1JU7JyiLmEXBtgDKzTwg==

"@algolia/client-insights@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-insights/-/client-insights-5.47.0.tgz#9adbc82f6bfa896266559843fc74eddaaf9bff15"
  integrity sha512-Ci+cn/FDIsDxSKMRBEiyKrqybblbk8xugo6ujDN1GSTv9RIZxwxqZYuHfdLnLEwLlX7GB8pqVyqrUSlRnR+sJA==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/client-personalization@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-personalization/-/client-personalization-5.47.0.tgz#f45bca61625458a2c26d0f241bbc249f47aa0fe1"
  integrity sha512-gsLnHPZmWcX0T3IigkDL2imCNtsQ7dR5xfnwiFsb+uTHCuYQt+IwSNjsd8tok6HLGLzZrliSaXtB5mfGBtYZvQ==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/client-query-suggestions@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-query-suggestions/-/client-query-suggestions-5.47.0.tgz#20af440297524956aff483dccef7222c57366f04"
  integrity sha512-PDOw0s8WSlR2fWFjPQldEpmm/gAoUgLigvC3k/jCSi/DzigdGX6RdC0Gh1RR1P8Cbk5KOWYDuL3TNzdYwkfDyA==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/client-search@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/client-search/-/client-search-5.47.0.tgz#b74b948adbd2908cb70a73a17e8a23d7e5ae439c"
  integrity sha512-b5hlU69CuhnS2Rqgsz7uSW0t4VqrLMLTPbUpEl0QVz56rsSwr1Sugyogrjb493sWDA+XU1FU5m9eB8uH7MoI0g==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/ingestion@1.47.0":
  version "1.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/ingestion/-/ingestion-1.47.0.tgz#47ffeba5120a4b186a81a2adb1ffda2902c6f3f1"
  integrity sha512-WvwwXp5+LqIGISK3zHRApLT1xkuEk320/EGeD7uYy+K8WwDd5OjXnhjuXRhYr1685KnkvWkq1rQ/ihCJjOfHpQ==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/monitoring@1.47.0":
  version "1.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/monitoring/-/monitoring-1.47.0.tgz#3ea90f176495a1130887b0780d91ff91fd42b9f9"
  integrity sha512-j2EUFKAlzM0TE4GRfkDE3IDfkVeJdcbBANWzK16Tb3RHz87WuDfQ9oeEW6XiRE1/bEkq2xf4MvZesvSeQrZRDA==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/recommend@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/recommend/-/recommend-5.47.0.tgz#71a759cdbe67e27f2299ab87d3c8aa4392001a88"
  integrity sha512-+kTSE4aQ1ARj2feXyN+DMq0CIDHJwZw1kpxIunedkmpWUg8k3TzFwWsMCzJVkF2nu1UcFbl7xsIURz3Q3XwOXA==
  dependencies:
    "@algolia/client-common" "5.47.0"
    "@algolia/requester-browser-xhr" "5.47.0"
    "@algolia/requester-fetch" "5.47.0"
    "@algolia/requester-node-http" "5.47.0"

"@algolia/requester-browser-xhr@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/requester-browser-xhr/-/requester-browser-xhr-5.47.0.tgz#0e76a8e3db0b09235178cb47c9de0a198db7b52d"
  integrity sha512-Ja+zPoeSA2SDowPwCNRbm5Q2mzDvVV8oqxCQ4m6SNmbKmPlCfe30zPfrt9ho3kBHnsg37pGucwOedRIOIklCHw==
  dependencies:
    "@algolia/client-common" "5.47.0"

"@algolia/requester-fetch@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/requester-fetch/-/requester-fetch-5.47.0.tgz#de68b44bef30d03919be249a6ff30e82975494a9"
  integrity sha512-N6nOvLbaR4Ge+oVm7T4W/ea1PqcSbsHR4O58FJ31XtZjFPtOyxmnhgCmGCzP9hsJI6+x0yxJjkW5BMK/XI8OvA==
  dependencies:
    "@algolia/client-common" "5.47.0"

"@algolia/requester-node-http@5.47.0":
  version "5.47.0"
  resolved "https://registry.yarnpkg.com/@algolia/requester-node-http/-/requester-node-http-5.47.0.tgz#b8e46c1e80b74d9146dec7b0219131198951198a"
  integrity sha512-z1oyLq5/UVkohVXNDEY70mJbT/sv/t6HYtCvCwNrOri6pxBJDomP9R83KOlwcat+xqBQEdJHjbrPh36f1avmZA==
  dependencies:
    "@algolia/client-common" "5.47.0"

"@ampproject/remapping@^2.2.1":
  version "2.3.0"
  resolved "https://registry.yarnpkg.com/@ampproject/remapping/-/remapping-2.3.0.tgz#ed441b6fa600072520ce18b43d2c8cc8caecc7f4"
  integrity sha512-30iZtAPgz+LTIYoeivqYo853f02jBYSd5uGnGpkFV0M3xOt9aN73erkgYAmZU43x4VfqcnLxW9Kpg3R5LC4YYw==
  dependencies:
    "@jridgewell/gen-mapping" "^0.3.5"
    "@jridgewell/trace-mapping" "^0.3.24"

"@antfu/install-pkg@^1.1.0":
  version "1.1.0"
  resolved "https://registry.yarnpkg.com/@antfu/install-pkg/-/install-pkg-1.1.0.tgz#78fa036be1a6081b5a77a5cf59f50c7752b6ba26"
  integrity sha512-MGQsmw10ZyI+EJo45CdSER4zEb+p31LpDAFp2Z3gkSd1yqVZGi0Ebx++YTEMonJy4oChEMLsxZ64j8FH6sSqtQ==
  dependencies:
    package-manager-detector "^1.3.0"
    tinyexec "^1.0.1"

"@asamuzakjp/css-color@^4.1.1":
  version "4.1.1"
  resolved "https://registry.yarnpkg.com/@asamuzakjp/css-color/-/css-color-4.1.1.tgz#e5c662f488367dc74194609179fe6621f2586114"
  integrity sha512-B0Hv6G3gWGMn0xKJ0txEi/jM5iFpT3MfDxmhZFb4W047GvytCf1DHQ1D69W3zHI4yWe2aTZAA0JnbMZ7Xc8DuQ==
  dependencies:
    "@csstools/css-calc" "^2.1.4"
    "@csstools/css-color-parser" "^3.1.0"
    "@csstools/css-parser-algorithms" "^3.0.5"
    "@csstools/css-tokenizer" "^3.0.4"
    lru-cache "^11.2.4"

"@asamuzakjp/dom-selector@^6.7.6":
  version "6.7.6"
  resolved "https://registry.yarnpkg.com/@asamuzakjp/dom-selector/-/dom-selector-6.7.6.tgz#9cd7671a61a9cb490852ed6a441b3b0950aab945"
  integrity sha512-hBaJER6A9MpdG3WgdlOolHmbOYvSk46y7IQN/1+iqiCuUu6iWdQrs9DGKF8ocqsEqWujWf/V7b7vaDgiUmIvUg==
  dependencies:
    "@asamuzakjp/nwsapi" "^2.3.9"
    bidi-js "^1.0.3"
    css-tree "^3.1.0"
    is-potential-custom-element-name "^1.0.1"
    lru-cache "^11.2.4"

"@asamuzakjp/nwsapi@^2.3.9":
  version "2.3.9"
  resolved "https://registry.yarnpkg.com/@asamuzakjp/nwsapi/-/nwsapi-2.3.9.tgz#ad5549322dfe9d153d4b4dd6f7ff2ae234b06e24"
  integrity sha512-n8GuYSrI9bF7FFZ/SjhwevlHc8xaVlb/7HmHelnc/PZXBD2ZR49NnN9sMMuDdEGPeeRQ5d0hqlSlEpgCX3Wl0Q==

"@babel/code-frame@^7.0.0", "@babel/code-frame@^7.10.4", "@babel/code-frame@^7.12.13", "@babel/code-frame@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/code-frame/-/code-frame-7.28.6.tgz#72499312ec58b1e2245ba4a4f550c132be4982f7"
  integrity sha512-JYgintcMjRiCvS8mMECzaEn+m3PfoQiyqukOMCCVQtoJGYJw8j/8LBJEiqkHLkfwCcs74E3pbAUFNg7d9VNJ+Q==
  dependencies:
    "@babel/helper-validator-identifier" "^7.28.5"
    js-tokens "^4.0.0"
    picocolors "^1.1.1"

"@babel/compat-data@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/compat-data/-/compat-data-7.28.6.tgz#103f466803fa0f059e82ccac271475470570d74c"
  integrity sha512-2lfu57JtzctfIrcGMz992hyLlByuzgIk58+hhGCxjKZ3rWI82NnVLjXcaTqkI2NvlcvOskZaiZ5kjUALo3Lpxg==

"@babel/core@^7.11.6", "@babel/core@^7.12.3", "@babel/core@^7.23.9":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/core/-/core-7.28.6.tgz#531bf883a1126e53501ba46eb3bb414047af507f"
  integrity sha512-H3mcG6ZDLTlYfaSNi0iOKkigqMFvkTKlGUYlD8GW7nNOYRrevuA46iTypPyv+06V3fEmvvazfntkBU34L0azAw==
  dependencies:
    "@babel/code-frame" "^7.28.6"
    "@babel/generator" "^7.28.6"
    "@babel/helper-compilation-targets" "^7.28.6"
    "@babel/helper-module-transforms" "^7.28.6"
    "@babel/helpers" "^7.28.6"
    "@babel/parser" "^7.28.6"
    "@babel/template" "^7.28.6"
    "@babel/traverse" "^7.28.6"
    "@babel/types" "^7.28.6"
    "@jridgewell/remapping" "^2.3.5"
    convert-source-map "^2.0.0"
    debug "^4.1.0"
    gensync "^1.0.0-beta.2"
    json5 "^2.2.3"
    semver "^6.3.1"

"@babel/generator@^7.28.6", "@babel/generator@^7.7.2":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/generator/-/generator-7.28.6.tgz#48dcc65d98fcc8626a48f72b62e263d25fc3c3f1"
  integrity sha512-lOoVRwADj8hjf7al89tvQ2a1lf53Z+7tiXMgpZJL3maQPDxh0DgLMN62B2MKUOFcoodBHLMbDM6WAbKgNy5Suw==
  dependencies:
    "@babel/parser" "^7.28.6"
    "@babel/types" "^7.28.6"
    "@jridgewell/gen-mapping" "^0.3.12"
    "@jridgewell/trace-mapping" "^0.3.28"
    jsesc "^3.0.2"

"@babel/helper-compilation-targets@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz#32c4a3f41f12ed1532179b108a4d746e105c2b25"
  integrity sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==
  dependencies:
    "@babel/compat-data" "^7.28.6"
    "@babel/helper-validator-option" "^7.27.1"
    browserslist "^4.24.0"
    lru-cache "^5.1.1"
    semver "^6.3.1"

"@babel/helper-globals@^7.28.0":
  version "7.28.0"
  resolved "https://registry.yarnpkg.com/@babel/helper-globals/-/helper-globals-7.28.0.tgz#b9430df2aa4e17bc28665eadeae8aa1d985e6674"
  integrity sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==

"@babel/helper-module-imports@^7.16.7", "@babel/helper-module-imports@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz#60632cbd6ffb70b22823187201116762a03e2d5c"
  integrity sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==
  dependencies:
    "@babel/traverse" "^7.28.6"
    "@babel/types" "^7.28.6"

"@babel/helper-module-transforms@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz#9312d9d9e56edc35aeb6e95c25d4106b50b9eb1e"
  integrity sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==
  dependencies:
    "@babel/helper-module-imports" "^7.28.6"
    "@babel/helper-validator-identifier" "^7.28.5"
    "@babel/traverse" "^7.28.6"

"@babel/helper-plugin-utils@^7.0.0", "@babel/helper-plugin-utils@^7.10.4", "@babel/helper-plugin-utils@^7.12.13", "@babel/helper-plugin-utils@^7.14.5", "@babel/helper-plugin-utils@^7.28.6", "@babel/helper-plugin-utils@^7.8.0":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz#6f13ea251b68c8532e985fd532f28741a8af9ac8"
  integrity sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==

"@babel/helper-string-parser@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz#54da796097ab19ce67ed9f88b47bb2ec49367687"
  integrity sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==

"@babel/helper-validator-identifier@^7.28.5":
  version "7.28.5"
  resolved "https://registry.yarnpkg.com/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz#010b6938fab7cb7df74aa2bbc06aa503b8fe5fb4"
  integrity sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==

"@babel/helper-validator-option@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz#fa52f5b1e7db1ab049445b421c4471303897702f"
  integrity sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==

"@babel/helpers@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/helpers/-/helpers-7.28.6.tgz#fca903a313ae675617936e8998b814c415cbf5d7"
  integrity sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==
  dependencies:
    "@babel/template" "^7.28.6"
    "@babel/types" "^7.28.6"

"@babel/parser@^7.1.0", "@babel/parser@^7.14.7", "@babel/parser@^7.20.7", "@babel/parser@^7.23.9", "@babel/parser@^7.28.5", "@babel/parser@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/parser/-/parser-7.28.6.tgz#f01a8885b7fa1e56dd8a155130226cd698ef13fd"
  integrity sha512-TeR9zWR18BvbfPmGbLampPMW+uW1NZnJlRuuHso8i87QZNq2JRF9i6RgxRqtEq+wQGsS19NNTWr2duhnE49mfQ==
  dependencies:
    "@babel/types" "^7.28.6"

"@babel/plugin-syntax-async-generators@^7.8.4":
  version "7.8.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-async-generators/-/plugin-syntax-async-generators-7.8.4.tgz#a983fb1aeb2ec3f6ed042a210f640e90e786fe0d"
  integrity sha512-tycmZxkGfZaxhMRbXlPXuVFpdWlXpir2W4AMhSJgRKzk/eDlIXOhb2LHWoLpDF7TEHylV5zNhykX6KAgHJmTNw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-bigint@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-bigint/-/plugin-syntax-bigint-7.8.3.tgz#4c9a6f669f5d0cdf1b90a1671e9a146be5300cea"
  integrity sha512-wnTnFlG+YxQm3vDxpGE57Pj0srRU4sHE/mDkt1qv2YJJSeUAec2ma4WLUnUPeKjyrfntVwe/N6dCXpU+zL3Npg==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-class-properties@^7.12.13":
  version "7.12.13"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-class-properties/-/plugin-syntax-class-properties-7.12.13.tgz#b5c987274c4a3a82b89714796931a6b53544ae10"
  integrity sha512-fm4idjKla0YahUNgFNLCB0qySdsoPiZP3iQE3rky0mBUtMZ23yDJ9SJdg6dXTSDnulOVqiF3Hgr9nbXvXTQZYA==
  dependencies:
    "@babel/helper-plugin-utils" "^7.12.13"

"@babel/plugin-syntax-class-static-block@^7.14.5":
  version "7.14.5"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-class-static-block/-/plugin-syntax-class-static-block-7.14.5.tgz#195df89b146b4b78b3bf897fd7a257c84659d406"
  integrity sha512-b+YyPmr6ldyNnM6sqYeMWE+bgJcJpO6yS4QD7ymxgH34GBPNDM/THBh8iunyvKIZztiwLH4CJZ0RxTk9emgpjw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.14.5"

"@babel/plugin-syntax-import-attributes@^7.24.7":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-import-attributes/-/plugin-syntax-import-attributes-7.28.6.tgz#b71d5914665f60124e133696f17cd7669062c503"
  integrity sha512-jiLC0ma9XkQT3TKJ9uYvlakm66Pamywo+qwL+oL8HJOvc6TWdZXVfhqJr8CCzbSGUAbDOzlGHJC1U+vRfLQDvw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.28.6"

"@babel/plugin-syntax-import-meta@^7.10.4":
  version "7.10.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-import-meta/-/plugin-syntax-import-meta-7.10.4.tgz#ee601348c370fa334d2207be158777496521fd51"
  integrity sha512-Yqfm+XDx0+Prh3VSeEQCPU81yC+JWZ2pDPFSS4ZdpfZhp4MkFMaDC1UqseovEKwSUpnIL7+vK+Clp7bfh0iD7g==
  dependencies:
    "@babel/helper-plugin-utils" "^7.10.4"

"@babel/plugin-syntax-json-strings@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-json-strings/-/plugin-syntax-json-strings-7.8.3.tgz#01ca21b668cd8218c9e640cb6dd88c5412b2c96a"
  integrity sha512-lY6kdGpWHvjoe2vk4WrAapEuBR69EMxZl+RoGRhrFGNYVK8mOPAW8VfbT/ZgrFbXlDNiiaxQnAtgVCZ6jv30EA==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-jsx@^7.7.2":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-jsx/-/plugin-syntax-jsx-7.28.6.tgz#f8ca28bbd84883b5fea0e447c635b81ba73997ee"
  integrity sha512-wgEmr06G6sIpqr8YDwA2dSRTE3bJ+V0IfpzfSY3Lfgd7YWOaAdlykvJi13ZKBt8cZHfgH1IXN+CL656W3uUa4w==
  dependencies:
    "@babel/helper-plugin-utils" "^7.28.6"

"@babel/plugin-syntax-logical-assignment-operators@^7.10.4":
  version "7.10.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-logical-assignment-operators/-/plugin-syntax-logical-assignment-operators-7.10.4.tgz#ca91ef46303530448b906652bac2e9fe9941f699"
  integrity sha512-d8waShlpFDinQ5MtvGU9xDAOzKH47+FFoney2baFIoMr952hKOLp1HR7VszoZvOsV/4+RRszNY7D17ba0te0ig==
  dependencies:
    "@babel/helper-plugin-utils" "^7.10.4"

"@babel/plugin-syntax-nullish-coalescing-operator@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-nullish-coalescing-operator/-/plugin-syntax-nullish-coalescing-operator-7.8.3.tgz#167ed70368886081f74b5c36c65a88c03b66d1a9"
  integrity sha512-aSff4zPII1u2QD7y+F8oDsz19ew4IGEJg9SVW+bqwpwtfFleiQDMdzA/R+UlWDzfnHFCxxleFT0PMIrR36XLNQ==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-numeric-separator@^7.10.4":
  version "7.10.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-numeric-separator/-/plugin-syntax-numeric-separator-7.10.4.tgz#b9b070b3e33570cd9fd07ba7fa91c0dd37b9af97"
  integrity sha512-9H6YdfkcK/uOnY/K7/aA2xpzaAgkQn37yzWUMRK7OaPOqOpGS1+n0H5hxT9AUw9EsSjPW8SVyMJwYRtWs3X3ug==
  dependencies:
    "@babel/helper-plugin-utils" "^7.10.4"

"@babel/plugin-syntax-object-rest-spread@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-object-rest-spread/-/plugin-syntax-object-rest-spread-7.8.3.tgz#60e225edcbd98a640332a2e72dd3e66f1af55871"
  integrity sha512-XoqMijGZb9y3y2XskN+P1wUGiVwWZ5JmoDRwx5+3GmEplNyVM2s2Dg8ILFQm8rWM48orGy5YpI5Bl8U1y7ydlA==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-optional-catch-binding@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-optional-catch-binding/-/plugin-syntax-optional-catch-binding-7.8.3.tgz#6111a265bcfb020eb9efd0fdfd7d26402b9ed6c1"
  integrity sha512-6VPD0Pc1lpTqw0aKoeRTMiB+kWhAoT24PA+ksWSBrFtl5SIRVpZlwN3NNPQjehA2E/91FV3RjLWoVTglWcSV3Q==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-optional-chaining@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-optional-chaining/-/plugin-syntax-optional-chaining-7.8.3.tgz#4f69c2ab95167e0180cd5336613f8c5788f7d48a"
  integrity sha512-KoK9ErH1MBlCPxV0VANkXW2/dw4vlbGDrFgz8bmUsBGYkFRcbRwMh6cIJubdPrkxRwuGdtCk0v/wPTKbQgBjkg==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-private-property-in-object@^7.14.5":
  version "7.14.5"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-private-property-in-object/-/plugin-syntax-private-property-in-object-7.14.5.tgz#0dc6671ec0ea22b6e94a1114f857970cd39de1ad"
  integrity sha512-0wVnp9dxJ72ZUJDV27ZfbSj6iHLoytYZmh3rFcxNnvsJF3ktkzLDZPy/mA17HGsaQT3/DQsWYX1f1QGWkCoVUg==
  dependencies:
    "@babel/helper-plugin-utils" "^7.14.5"

"@babel/plugin-syntax-top-level-await@^7.14.5":
  version "7.14.5"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-top-level-await/-/plugin-syntax-top-level-await-7.14.5.tgz#c1cfdadc35a646240001f06138247b741c34d94c"
  integrity sha512-hx++upLv5U1rgYfwe1xBQUhRmU41NEvpUvrp8jkrSCdvGSnM5/qdRMtylJ6PG5OFkBaHkbTAKTnd3/YyESRHFw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.14.5"

"@babel/plugin-syntax-typescript@^7.7.2":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-typescript/-/plugin-syntax-typescript-7.28.6.tgz#c7b2ddf1d0a811145b1de800d1abd146af92e3a2"
  integrity sha512-+nDNmQye7nlnuuHDboPbGm00Vqg3oO8niRRL27/4LYHUsHYh0zJ1xWOz0uRwNFmM1Avzk8wZbc6rdiYhomzv/A==
  dependencies:
    "@babel/helper-plugin-utils" "^7.28.6"

"@babel/runtime@7.23.4":
  version "7.23.4"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.23.4.tgz#36fa1d2b36db873d25ec631dcc4923fdc1cf2e2e"
  integrity sha512-2Yv65nlWnWlSpe3fXEyX5i7fx5kIKo4Qbcj+hMO0odwaneFjfXw5fdum+4yL20O0QiaHpia0cYQ9xpNMqrBwHg==
  dependencies:
    regenerator-runtime "^0.14.0"

"@babel/runtime@7.26.0":
  version "7.26.0"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.26.0.tgz#8600c2f595f277c60815256418b85356a65173c1"
  integrity sha512-FDSOghenHTiToteC/QRlv2q3DhPZ/oOXTBoirfWNx1Cx3TMVcGWQtMMmQcSvb/JjpNeGzx8Pq/b4fKEJuWm1sw==
  dependencies:
    regenerator-runtime "^0.14.0"

"@babel/runtime@7.9.6":
  version "7.9.6"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.9.6.tgz#a9102eb5cadedf3f31d08a9ecf294af7827ea29f"
  integrity sha512-64AF1xY3OAkFHqOb9s4jpgk1Mm5vDZ4L3acHvAml+53nO1XbXLuDodsVpO4OIUsmemlUHMxNdYMNJmsvOwLrvQ==
  dependencies:
    regenerator-runtime "^0.13.4"

"@babel/runtime@^7.12.5", "@babel/runtime@^7.18.3", "@babel/runtime@^7.28.4":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.28.6.tgz#d267a43cb1836dc4d182cce93ae75ba954ef6d2b"
  integrity sha512-05WQkdpL9COIMz4LjTxGpPNCdlpyimKppYNoJ5Di5EUObifl8t4tuLuUBBZEpoLYOmfvIWrsp9fCl0HoPRVTdA==

"@babel/template@^7.28.6", "@babel/template@^7.3.3":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/template/-/template-7.28.6.tgz#0e7e56ecedb78aeef66ce7972b082fce76a23e57"
  integrity sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==
  dependencies:
    "@babel/code-frame" "^7.28.6"
    "@babel/parser" "^7.28.6"
    "@babel/types" "^7.28.6"

"@babel/traverse@^7.28.6":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/traverse/-/traverse-7.28.6.tgz#871ddc79a80599a5030c53b1cc48cbe3a5583c2e"
  integrity sha512-fgWX62k02qtjqdSNTAGxmKYY/7FSL9WAS1o2Hu5+I5m9T0yxZzr4cnrfXQ/MX0rIifthCSs6FKTlzYbJcPtMNg==
  dependencies:
    "@babel/code-frame" "^7.28.6"
    "@babel/generator" "^7.28.6"
    "@babel/helper-globals" "^7.28.0"
    "@babel/parser" "^7.28.6"
    "@babel/template" "^7.28.6"
    "@babel/types" "^7.28.6"
    debug "^4.3.1"

"@babel/types@^7.0.0", "@babel/types@^7.20.7", "@babel/types@^7.28.2", "@babel/types@^7.28.6", "@babel/types@^7.3.3":
  version "7.28.6"
  resolved "https://registry.yarnpkg.com/@babel/types/-/types-7.28.6.tgz#c3e9377f1b155005bcc4c46020e7e394e13089df"
  integrity sha512-0ZrskXVEHSWIqZM/sQZ4EV3jZJXRkio/WCxaqKZP1g//CEWEPSfeZFcms4XeKBCHU0ZKnIkdJeU/kF+eRp5lBg==
  dependencies:
    "@babel/helper-string-parser" "^7.27.1"
    "@babel/helper-validator-identifier" "^7.28.5"

"@bcoe/v8-coverage@^0.2.3":
  version "0.2.3"
  resolved "https://registry.yarnpkg.com/@bcoe/v8-coverage/-/v8-coverage-0.2.3.tgz#75a2e8b51cb758a7553d6804a5932d7aace75c39"
  integrity sha512-0hYQ8SB4Db5zvZB4axdMHGwEaQjkZzFjQiN9LVYvIFB2nSUHW9tYpxWriPrWDASIxiaXax83REcLxuSdnGPZtw==

"@braintree/sanitize-url@^6.0.0":
```

### /Users/sand/GitHub/mono/logs/api.log
```log
API server running on http://localhost:5171
[API] GET /rebuild-status HTTP/1.1
[API] OPTIONS /rebuild-docs HTTP/1.1
[API] POST /rebuild-docs HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] OPTIONS /rebuild-docs HTTP/1.1
[API] POST /rebuild-docs HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] OPTIONS /rebuild-docs HTTP/1.1
[API] POST /rebuild-docs HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
----------------------------------------
Exception occurred during processing of request from ('127.0.0.1', 53465)
Traceback (most recent call last):
  File "/Users/sand/GitHub/mono/sites/api.py", line 221, in do_GET
    self._send_response(200, results)
  File "/Users/sand/GitHub/mono/sites/api.py", line 167, in _send_response
    self.wfile.write(json.dumps(data).encode())
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 826, in write
    self._sock.sendall(b)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/server.py", line 432, in handle
    self.handle_one_request()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/server.py", line 420, in handle_one_request
    method()
  File "/Users/sand/GitHub/mono/sites/api.py", line 223, in do_GET
    self._send_response(500, {'success': False, 'error': str(e)})
  File "/Users/sand/GitHub/mono/sites/api.py", line 166, in _send_response
    self.end_headers()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/server.py", line 534, in end_headers
    self.flush_headers()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/http/server.py", line 538, in flush_headers
    self.wfile.write(b"".join(self._headers_buffer))
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 826, in write
    self._sock.sendall(b)
BrokenPipeError: [Errno 32] Broken pipe
----------------------------------------
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] OPTIONS /rebuild-docs HTTP/1.1
[API] POST /rebuild-docs HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] OPTIONS /rebuild-docs HTTP/1.1
[API] POST /rebuild-docs HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] GET /rebuild-status HTTP/1.1
[API] OPTIONS /restart-all HTTP/1.1
[API] POST /restart-all HTTP/1.1
```

### /Users/sand/GitHub/mono/logs/core-docs.log
```log
yarn run v1.22.22
$ vitepress dev

  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose
6:36:17 PM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...
Port 5181 is in use, trying another one...
Port 5182 is in use, trying another one...
Port 5183 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5184/
  ➜  Network: use --host to expose
6:45:20 PM [vitepress] .vitepress/config.mts changed, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose
6:48:30 PM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...
Port 5181 is in use, trying another one...
Port 5182 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5183/
  ➜  Network: use --host to expose
6:49:20 PM [vitepress] .vitepress/config.mts changed, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose
7:00:55 PM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...
Port 5181 is in use, trying another one...
Port 5182 is in use, trying another one...
Port 5183 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5184/
  ➜  Network: use --host to expose
7:01:46 PM [vitepress] .vitepress/config.mts changed, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose
7:02:03 PM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...
Port 5181 is in use, trying another one...
Port 5182 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5183/
  ➜  Network: use --host to expose
10:00:50 PM [vitepress] .vitepress/config.mts changed, restarting server...

Re-optimizing dependencies because lockfile has changed

  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose
10:01:40 PM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5177/
  ➜  Network: use --host to expose
10:07:22 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...
Port 5181 is in use, trying another one...
Port 5182 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5183/
  ➜  Network: use --host to expose
10:07:31 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5179/
  ➜  Network: use --host to expose
10:08:25 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5181/
  ➜  Network: use --host to expose
10:08:43 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...
Port 5181 is in use, trying another one...
Port 5182 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5183/
  ➜  Network: use --host to expose
10:24:22 AM [vitepress] sites/ports.json changed, restarting server...

Port 5173 is in use, trying another one...
Port 5174 is in use, trying another one...
Port 5175 is in use, trying another one...
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5179/
  ➜  Network: use --host to expose
10:35:07 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5173 is in use, trying another one...
Port 5174 is in use, trying another one...
Port 5175 is in use, trying another one...
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5179/
  ➜  Network: use --host to expose
10:35:58 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5173 is in use, trying another one...
Port 5174 is in use, trying another one...
Port 5175 is in use, trying another one...
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5181/
  ➜  Network: use --host to expose
10:36:15 AM [vitepress] .vitepress/config.mts changed, restarting server...

Port 5173 is in use, trying another one...
Port 5174 is in use, trying another one...
Port 5175 is in use, trying another one...
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5179/
  ➜  Network: use --host to expose
10:43:45 AM [vitepress] .vitepress/config.mts changed, restarting server...


The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose
10:55:45 AM [vitepress] hmr update /guides/index.md
11:01:37 AM [vitepress] .vitepress/config.mts changed, restarting server...

✘ [ERROR] Expected "}" but found "collapsed"

    .vitepress/config.mts:127:14:
      127 │               collapsed: true,
          │               ~~~~~~~~~
          ╵               }

failed to load config from /Users/sand/GitHub/mono/.vitepress/config.mts
Error: Build failed with 1 error:
.vitepress/config.mts:127:14: ERROR: Expected "}" but found "collapsed"
    at failureErrorWithLog (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1472:15)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:945:25
    at runOnEndCallbacks (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1315:45)
    at buildResponseToResult (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:943:7)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:970:16
    at responseCallbacks.<computed> (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  errors: [Getter/Setter],
  warnings: [Getter/Setter]
}
11:34:49 AM [vitepress] hmr update /index.md
11:36:29 AM [vitepress] .vitepress/config.mts changed, restarting server...

✘ [ERROR] Expected "}" but found "collapsed"

    .vitepress/config.mts:127:14:
      127 │               collapsed: true,
          │               ~~~~~~~~~
          ╵               }

failed to load config from /Users/sand/GitHub/mono/.vitepress/config.mts
Error: Build failed with 1 error:
.vitepress/config.mts:127:14: ERROR: Expected "}" but found "collapsed"
    at failureErrorWithLog (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1472:15)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:945:25
    at runOnEndCallbacks (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1315:45)
    at buildResponseToResult (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:943:7)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:970:16
    at responseCallbacks.<computed> (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  errors: [Getter/Setter],
  warnings: [Getter/Setter]
}
11:41:49 AM [vitepress] .vitepress/config.mts changed, restarting server...

✘ [ERROR] Expected "}" but found "collapsed"

    .vitepress/config.mts:695:14:
      695 │               collapsed: true,
          │               ~~~~~~~~~
          ╵               }

failed to load config from /Users/sand/GitHub/mono/.vitepress/config.mts
Error: Build failed with 1 error:
.vitepress/config.mts:695:14: ERROR: Expected "}" but found "collapsed"
    at failureErrorWithLog (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1472:15)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:945:25
    at runOnEndCallbacks (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1315:45)
    at buildResponseToResult (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:943:7)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:970:16
    at responseCallbacks.<computed> (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12) {
  errors: [Getter/Setter],
  warnings: [Getter/Setter]
}
11:41:53 AM [vitepress] .vitepress/config.mts changed, restarting server...


The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5179/
  ➜  Network: use --host to expose
11:48:03 AM [vitepress] .vitepress/config.mts changed, restarting server...


The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5181/
  ➜  Network: use --host to expose
11:53:28 AM [vitepress] page reload ws/archives/2025/index copy.html
11:53:28 AM [vitepress] page reload ws/archives/bubble/1/bundle.test.html
11:53:28 AM [vitepress] page reload ws/archives/bubble/3/index.html
11:53:28 AM [vitepress] page reload ws/archives/bubble/3/webseriously.html
11:53:28 AM [vitepress] page reload ws/archives/dist/goo.html
11:53:28 AM [vitepress] page reload ws/archives/dist/index.html
11:53:28 AM [vitepress] page reload ws/archives/experiments/simulate bubble/simulate.html
11:54:46 AM [vitepress] page reload ws/archives/experiments/simulate bubble/simulate.html
11:54:46 AM [vitepress] page reload ws/archives/bubble/3/index.html
11:54:46 AM [vitepress] page reload ws/archives/bubble/3/webseriously.html
11:54:46 AM [vitepress] page reload ws/archives/bubble/1/bundle.test.html
11:54:46 AM [vitepress] page reload ws/archives/2025/index copy.html
11:56:50 AM [vitepress] .vitepress/config.mts changed, restarting server...


The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
Port 5176 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5177/
  ➜  Network: use --host to expose
12:34:15 PM [vitepress] .vitepress/config.mts changed, restarting server...


The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
Port 5176 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5177/
  ➜  Network: use --host to expose
3:45:47 PM [vitepress] page reload ws/experiments/quaternion-poc/index.html
3:45:52 PM [vitepress] page reload ws/experiments/quaternion-poc/index.html
3:45:52 PM [vitepress] page reload ws/work/experiments/quaternion-poc/index.html
3:45:59 PM [vitepress] page reload ws/work/experiments/quaternion-poc/index.html
3:45:59 PM [vitepress] page reload ws/work/done/experiments/quaternion-poc/index.html
 ➜  Network: use --host to expose
12:34:15 PM [vitepress] .vitepress/config.mts changed, restarting server...


The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
Port 5176 is in use, trying another one...
Port 5177 is in use, trying another one...
Port 5178 is in use, trying another one...
Port 5179 is in use, trying another one...
Port 5180 is in use, trying another one...

  vitepress v1.6.4

  ➜  Local:   http://localhost:5181/
  ➜  Network: use --host to expose
3:45:47 PM [vitepress] page reload ws/experiments/quaternion-poc/index.html
3:45:52 PM [vitepress] page reload ws/experiments/quaternion-poc/index.html
3:45:52 PM [vitepress] page reload ws/work/experiments/quaternion-poc/index.html
3:45:59 PM [vitepress] page reload ws/work/experiments/quaternion-poc/index.html
3:45:59 PM [vitepress] page reload ws/work/done/experiments/quaternion-poc/index.html
aternion-poc/index.html
3:45:52 PM [vitepress] page reload ws/work/experiments/quaternion-poc/index.html
3:45:59 PM [vitepress] page reload ws/work/experiments/quaternion-poc/index.html
3:45:59 PM [vitepress] page reload ws/work/done/experiments/quaternion-poc/index.html
error Command failed with signal "SIGKILL".
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
```

### /Users/sand/GitHub/mono/logs/ws.log
```log
yarn run v1.22.22
$ vite

  VITE v4.5.14  ready in 523 ms

  ➜  Local:   http://localhost:5172/
  ➜  Network: http://10.0.0.235:5172/
  ➜  Network: http://10.0.0.78:5172/
  ➜  Network: http://169.254.185.20:5172/
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:41:4 A11y: Non-interactive element <li> should not be assigned mouse or keyboard event listeners.
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:36:0 A11y: noninteractive element cannot have nonnegative tabIndex value
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: <div> with click handler must have an ARIA role
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:50:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: <div> with click handler must have an ARIA role
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: <div> with click handler must have an ARIA role
9:01:17 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:52:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
9:01:18 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
9:01:18 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> with click handler must have an ARIA role
9:01:18 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> element should have an href attribute
9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte:7:11 Glows_Banner has unused export property 'isSelected'. If it is for external reference only, please consider using `export const isSelected`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte:181:1 A11y: <div> with keyup, keydown handlers must have an ARIA role
9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte:11:11 Glow_Button has unused export property 'name'. If it is for external reference only, please consider using `export const name`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:7:11 Cluster_Pager has unused export property 'thumb_path_d'. If it is for external reference only, please consider using `export const thumb_path_d`
9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:9:11 Cluster_Pager has unused export property 'center'. If it is for external reference only, please consider using `export const center`
9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:11:11 Cluster_Pager has unused export property 'viewBox'. If it is for external reference only, please consider using `export const viewBox`
9:01:19 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte:7:11 Curved_Text has unused export property 'center_ofArc'. If it is for external reference only, please consider using `export const center_ofArc`
9:27:57 AM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
9:29:03 AM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
9:29:40 AM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
9:29:44 AM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
9:29:49 AM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
3:59:38 PM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
3:59:52 PM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
4:01:42 PM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
4:01:46 PM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
4:09:53 PM [vite] hmr update /src/lib/svelte/mouse/Rubberband.svelte
4:17:21 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:18:38 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:20:33 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:21:18 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:22:21 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:23:08 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:23:16 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:24:04 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:25:18 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:25:51 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
4:26:48 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m57[0m:[93m14[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m57[0m   const _ = `${$w_user_graph_offset.description}
[7m  [0m [91m             ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m69[0m:[93m20[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m69[0m    debug.log_draw(`GRAPH grand_layout_andReattach`);
[7m  [0m [91m                   ~~~~~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m69[0m:[93m50[0m - [91merror[0m[90m TS1443: [0mModule declaration names may only use ' or " quoted strings.

[7m 69[0m    debug.log_draw(`GRAPH grand_layout_andReattach`);
[7m   [0m [91m                                                 ~~~[0m
[7m 70[0m    actual_content_rect = g.user_offset_toGraphDrawing;
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m 77[0m   const root = document.documentElement;
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m 78[0m   root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m78[0m:[93m40[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m78[0m   root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
[7m  [0m [91m                                       ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m78[0m:[93m67[0m - [91merror[0m[90m TS1443: [0mModule declaration names may only use ' or " quoted strings.

[7m78[0m   root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
[7m  [0m [91m                                                                  ~~~[0m
[7m79[0m   root.style.setProperty('--graph-y', `${draggableRect.origin.y}px`);
[7m  [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m79[0m:[93m40[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m79[0m   root.style.setProperty('--graph-y', `${draggableRect.origin.y}px`);
[7m  [0m [91m                                       ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m82[0m:[93m16[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m82[0m    touch-action: none;
[7m  [0m [91m               ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m84[0m:[93m18[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m84[0m    pointer-events: auto;
[7m  [0m [91m                 ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m85[0m:[93m11[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m85[0m    z-index: ${T_Layer.graph};
[7m  [0m [91m          ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m85[0m:[93m13[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m85[0m    z-index: ${T_Layer.graph};
[7m  [0m [91m            ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m86[0m:[93m11[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m86[0m    width: ${draggableRect.size.width}px;
[7m  [0m [91m          ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m87[0m:[93m12[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m87[0m    height: ${draggableRect.size.height}px;
[7m  [0m [91m           ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m94[0m:[93m731[0m - [91merror[0m[90m TS1160: [0mUnterminated template literal.

[7m94[0m const $$vars$$ = [w_rect_ofGraphView,w_rect_ofGraphView,w_s_hover,w_t_startup,w_t_graph,w_expanded,w_ancestry_focus,w_depth_limit,w_t_graph,w_user_graph_offset,w_rect_ofGraphView,w_s_title_edit,w_resize_radius,w_rotate_angle,w_depth_limit,w_rect_ofGraphView,reattachments,$w_t_startup,w_t_startup,T_Startup,style,$w_dragging,w_dragging,draggable,$w_t_graph,w_t_graph,T_Graph,Radial_Graph,Tree_Graph,debug,T_Layer,actual_content_rect,actual_content_rect,actual_content_rect,actual_content_rect,Rubberband,draggableRect,k,draggableRect,Button,T_Control,size_big,Point,elements,T_Control,e,T_Control,$w_thing_fontFamily,w_thing_fontFamily,builds,Button,T_Control,size_big,size_big,Point,draggableRect,elements,T_Control,e,T_Control];
[7m  [0m [91m                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [0m

[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m52[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m52[0m   :::${$w_t_graph}`;
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m57[0m:[93m14[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m57[0m   const _ = `${$w_user_graph_offset.description}
[7m  [0m [91m             ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m58[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m58[0m   :::${$w_rect_ofGraphView.description}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m59[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m59[0m   :::${$w_s_title_edit?.t_edit}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m60[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m60[0m   :::${$w_resize_radius}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m61[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m61[0m   :::${$w_rotate_angle}
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m  ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m   ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m    ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m62[0m:[93m6[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m62[0m   :::${$w_depth_limit}`;
[7m  [0m [91m     ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m69[0m:[93m20[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m69[0m    debug.log_draw(`GRAPH grand_layout_andReattach`);
[7m  [0m [91m                   ~~~~~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m69[0m:[93m50[0m - [91merror[0m[90m TS1443: [0mModule declaration names may only use ' or " quoted strings.

[7m 69[0m    debug.log_draw(`GRAPH grand_layout_andReattach`);
[7m   [0m [91m                                                 ~~~[0m
[7m 70[0m    actual_content_rect = g.user_offset_toGraphDrawing;
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m...[0m 
[7m 77[0m   const root = document.documentElement;
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[7m 78[0m   root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
[7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m78[0m:[93m40[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m78[0m   root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
[7m  [0m [91m                                       ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m78[0m:[93m67[0m - [91merror[0m[90m TS1443: [0mModule declaration names may only use ' or " quoted strings.

[7m78[0m   root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
[7m  [0m [91m                                                                  ~~~[0m
[7m79[0m   root.style.setProperty('--graph-y', `${draggableRect.origin.y}px`);
[7m  [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m79[0m:[93m40[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m79[0m   root.style.setProperty('--graph-y', `${draggableRect.origin.y}px`);
[7m  [0m [91m                                       ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m82[0m:[93m16[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m82[0m    touch-action: none;
[7m  [0m [91m               ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m84[0m:[93m18[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m84[0m    pointer-events: auto;
[7m  [0m [91m                 ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m85[0m:[93m11[0m - [91merror[0m[90m TS1005: [0m';' expected.

[7m85[0m    z-index: ${T_Layer.graph};
[7m  [0m [91m          ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m85[0m:[93m13[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m85[0m    z-index: ${T_Layer.graph};
[7m  [0m [91m            ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m86[0m:[93m11[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m86[0m    width: ${draggableRect.size.width}px;
[7m  [0m [91m          ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m87[0m:[93m12[0m - [91merror[0m[90m TS1434: [0mUnexpected keyword or identifier.

[7m87[0m    height: ${draggableRect.size.height}px;
[7m  [0m [91m           ~[0m
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m94[0m:[93m742[0m - [91merror[0m[90m TS1160: [0mUnterminated template literal.

[7m94[0m const $$vars$$ = [w_rect_ofGraphView,w_rect_ofGraphView,w_s_hover,w_t_startup,w_t_graph,w_expanded,w_ancestry_focus,w_depth_limit,w_t_graph,w_user_graph_offset,w_rect_ofGraphView,w_s_title_edit,w_resize_radius,w_rotate_angle,w_depth_limit,w_dragging,w_rect_ofGraphView,reattachments,$w_t_startup,w_t_startup,T_Startup,style,$w_dragging,w_dragging,draggable,$w_t_graph,w_t_graph,T_Graph,Radial_Graph,Tree_Graph,debug,T_Layer,actual_content_rect,actual_content_rect,actual_content_rect,actual_content_rect,Rubberband,draggableRect,k,draggableRect,Button,T_Control,size_big,Point,elements,T_Control,e,T_Control,$w_thing_fontFamily,w_thing_fontFamily,builds,Button,T_Control,size_big,size_big,Point,draggableRect,elements,T_Control,e,T_Control];
[7m  [0m [91m                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [0m

4:37:15 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte, /src/lib/svelte/main/Graph.svelte?svelte&type=style&lang.css
[96msrc/lib/svelte/main/Graph.svelte.injected.ts[0m:[93m3[0m:[93m30[0m - [91merror[0m[90m TS1005: [0m',' expected.

[7m3[0m  import { S_Component, T_Drag. T_Layer, T_Graph, T_Signal, T_Startup, T_Control } from '../../ts/common/Global_Imports';
[7m [0m [91m                             ~[0m

4:37:52 PM [vite] hmr update /src/lib/svelte/main/Graph.svelte, /src/lib/svelte/main/Graph.svelte?svelte&type=style&lang.css
4:42:37 PM [vite] page reload src/lib/ts/geometry/G_Cluster.ts
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:41:4 A11y: Non-interactive element <li> should not be assigned mouse or keyboard event listeners.
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:36:0 A11y: noninteractive element cannot have nonnegative tabIndex value
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: <div> with click handler must have an ARIA role
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:50:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: <div> with click handler must have an ARIA role
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: <div> with click handler must have an ARIA role
4:42:37 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:52:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:42:38 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:38 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> with click handler must have an ARIA role
4:42:38 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> element should have an href attribute
4:42:38 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte:7:11 Glows_Banner has unused export property 'isSelected'. If it is for external reference only, please consider using `export const isSelected`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:42:39 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte:181:1 A11y: <div> with keyup, keydown handlers must have an ARIA role
4:42:39 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte:11:11 Glow_Button has unused export property 'name'. If it is for external reference only, please consider using `export const name`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:42:39 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte:7:11 Curved_Text has unused export property 'center_ofArc'. If it is for external reference only, please consider using `export const center_ofArc`
4:42:39 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:7:11 Cluster_Pager has unused export property 'thumb_path_d'. If it is for external reference only, please consider using `export const thumb_path_d`
4:42:39 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:9:11 Cluster_Pager has unused export property 'center'. If it is for external reference only, please consider using `export const center`
4:42:39 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:11:11 Cluster_Pager has unused export property 'viewBox'. If it is for external reference only, please consider using `export const viewBox`
4:42:48 PM [vite] page reload src/lib/ts/geometry/G_Cluster.ts
4:42:48 PM [vite] page reload src/lib/ts/geometry/G_Cluster.ts
4:42:48 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:41:4 A11y: Non-interactive element <li> should not be assigned mouse or keyboard event listeners.
4:42:48 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:36:0 A11y: noninteractive element cannot have nonnegative tabIndex value
4:42:48 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:48 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: <div> with click handler must have an ARIA role
4:42:48 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:50:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:42:49 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:49 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: <div> with click handler must have an ARIA role
4:42:49 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:49 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: <div> with click handler must have an ARIA role
4:42:49 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:52:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> with click handler must have an ARIA role
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> element should have an href attribute
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte:7:11 Glows_Banner has unused export property 'isSelected'. If it is for external reference only, please consider using `export const isSelected`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte:181:1 A11y: <div> with keyup, keydown handlers must have an ARIA role
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte:11:11 Glow_Button has unused export property 'name'. If it is for external reference only, please consider using `export const name`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte:7:11 Curved_Text has unused export property 'center_ofArc'. If it is for external reference only, please consider using `export const center_ofArc`
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:7:11 Cluster_Pager has unused export property 'thumb_path_d'. If it is for external reference only, please consider using `export const thumb_path_d`
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:9:11 Cluster_Pager has unused export property 'center'. If it is for external reference only, please consider using `export const center`
4:42:50 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:11:11 Cluster_Pager has unused export property 'viewBox'. If it is for external reference only, please consider using `export const viewBox`
4:43:07 PM [vite] page reload src/lib/ts/managers/Visibility.ts
4:43:07 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:41:4 A11y: Non-interactive element <li> should not be assigned mouse or keyboard event listeners.
4:43:07 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:36:0 A11y: noninteractive element cannot have nonnegative tabIndex value
4:43:07 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:07 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: <div> with click handler must have an ARIA role
4:43:07 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:50:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:43:08 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:08 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: <div> with click handler must have an ARIA role
4:43:08 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:08 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: <div> with click handler must have an ARIA role
4:43:08 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:52:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> with click handler must have an ARIA role
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> element should have an href attribute
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte:181:1 A11y: <div> with keyup, keydown handlers must have an ARIA role
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte:7:11 Glows_Banner has unused export property 'isSelected'. If it is for external reference only, please consider using `export const isSelected`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte:11:11 Glow_Button has unused export property 'name'. If it is for external reference only, please consider using `export const name`
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte:7:11 Curved_Text has unused export property 'center_ofArc'. If it is for external reference only, please consider using `export const center_ofArc`
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:7:11 Cluster_Pager has unused export property 'thumb_path_d'. If it is for external reference only, please consider using `export const thumb_path_d`
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:9:11 Cluster_Pager has unused export property 'center'. If it is for external reference only, please consider using `export const center`
4:43:09 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:11:11 Cluster_Pager has unused export property 'viewBox'. If it is for external reference only, please consider using `export const viewBox`
4:43:10 PM [vite] page reload src/lib/ts/managers/Features.ts
4:43:10 PM [vite] page reload src/lib/ts/managers/Features.ts
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:41:4 A11y: Non-interactive element <li> should not be assigned mouse or keyboard event listeners.
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:36:0 A11y: noninteractive element cannot have nonnegative tabIndex value
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: <div> with click handler must have an ARIA role
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:50:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: <div> with click handler must have an ARIA role
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: <div> with click handler must have an ARIA role
4:43:10 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:52:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
4:43:11 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
4:43:11 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> with click handler must have an ARIA role
4:43:11 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> element should have an href attribute
4:43:11 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte:7:11 Glows_Banner has unused export property 'isSelected'. If it is for external reference only, please consider using `export const isSelected`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:43:11 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte:181:1 A11y: <div> with keyup, keydown handlers must have an ARIA role
4:43:12 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte:11:11 Glow_Button has unused export property 'name'. If it is for external reference only, please consider using `export const name`
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

4:43:12 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte:7:11 Curved_Text has unused export property 'center_ofArc'. If it is for external reference only, please consider using `export const center_ofArc`
4:43:12 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:7:11 Cluster_Pager has unused export property 'thumb_path_d'. If it is for external reference only, please consider using `export const thumb_path_d`
4:43:12 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:9:11 Cluster_Pager has unused export property 'center'. If it is for external reference only, please consider using `export const center`
4:43:12 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:11:11 Cluster_Pager has unused export property 'viewBox'. If it is for external reference only, please consider using `export const viewBox`
4:43:31 PM [vite] page reload src/lib/ts/managers/Radial.ts
```

### /Users/sand/GitHub/mono/logs/rebuild-status.txt
```txt
✓ mono, ws, di
```

### /Users/sand/GitHub/mono/logs/mono-docs.log
```log
yarn run v1.22.22
$ vitepress dev

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

  vitepress v1.6.4

  ➜  Local:   http://localhost:5176/
  ➜  Network: use --host to expose

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'cjs' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'cjs' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'ds_store' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'gitignore' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'aside' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'prettierrc' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'ds_store' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'cjs' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'cjs' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'svg' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'gitignore' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'aside' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'prettierrc' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'ds_store' is not loaded, falling back to 'txt' for syntax highlighting.

The language 'code-workspace' is not loaded, falling back to 'txt' for syntax highlighting.
```

### /Users/sand/GitHub/mono/logs/ws-docs.log
```log
yarn run v1.22.22
$ vitepress dev

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

  vitepress v1.6.4

  ➜  Local:   http://localhost:5174/
  ➜  Network: use --host to expose
```

### /Users/sand/GitHub/mono/logs/docs.log
```log
yarn run v1.22.22
$ vitepress dev

  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
4:47:13 PM [vitepress] projects/shared/.vitepress/theme/index.ts deleted, restarting server...

4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/404.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/access.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/chat.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/evolve.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/index.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/repo.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/voice.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/collaborate/workflow.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/aesthetics.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/css.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/deploy.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/index.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/jonathan.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/markdown.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/migration.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/onboarding.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/refactoring.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/develop/style.html
4:47:13 PM [vitepress] page reload projects/shared/.vitepress/dist/index.html
4:47:13 PM [vitepress] page reload projects/shareerror Command failed with signal "SIGKILL".
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
PM [vitepress] page reload projects/shared/.vitepress/dist/test/testing.html

  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
5:09:01 PM [vitepress] page reload projects/di/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/tools/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Gull_Wings.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Separator.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Preferences.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Graph.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Details.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Main.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Fillets.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Box.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/designs/Controls.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/404.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/architecture/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/architecture/rendering.types.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/architecture/files.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/architecture/project.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/architecture/managers.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/guides/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/guides/develop/best.practices.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/guides/develop/gotchas.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/guides/develop/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/guides/road.map.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/simplicity.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/pacing.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/done/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/done/quaternions.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/done/article.first.draft.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/done/svelte.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/4.hits.manager.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/1.solid.foundation.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/3.docs.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/2.panel/index.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/2.panel/components.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/2.panel/architecture.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/2.panel/milestone 2.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/milestones/2.panel/implement.html
5:09:01 PM [vitepress] page reload projects/di/.vitepress/dist/work/layout-algorithm.html
5:09:02 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/di/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/index.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/index.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/css.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/aesthetics.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/refactoring.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/style.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/jonathan.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/markdown.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/migration.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/deploy.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/develop/onboarding.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/test/index.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/test/debugging.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/test/testing.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/404.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/voice.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/index.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/evolve.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/access.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/repo.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/workflow.html
5:09:02 PM [vitepress] page reload projects/sh/.vitepress/dist/collaborate/chat.html
5:09:02 PM [vitepress] projects/sh/.vitepress/theme/index.ts deleted, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
5:09:03 PM [vitepress] page reload projects/ws/public/goo.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/2025/index copy.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/dist/index.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/dist/goo.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/experiments/simulate bubble/simulate.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/bubble/1/bundle.test.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/bubble/3/index.html
5:09:03 PM [vitepress] page reload projects/ws/notes/archives/bubble/3/webseriously.html
5:09:03 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/ws/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:09:03 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/ws/.svelte-kit/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
Error:   Failed to scan for dependencies from entries:
  /Users/sand/GitHub/mono/notes/tools/sites/index.html
/Users/sand/GitHub/mono/notes/ws/archives/2025/index copy.html
/Users/sand/GitHub/mono/notes/ws/archives/bubble/1/bundle.test.html
/Users/sand/GitHub/mono/notes/ws/archives/bubble/3/index.html
/Users/sand/GitHub/mono/notes/ws/archives/bubble/3/webseriously.html
/Users/sand/GitHub/mono/notes/ws/archives/experiments/simulate bubble/simulate.html
/Users/sand/GitHub/mono/projects/ws/notes/archives/2025/index copy.html
/Users/sand/GitHub/mono/projects/ws/notes/archives/bubble/1/bundle.test.html
/Users/sand/GitHub/mono/projects/ws/notes/archives/bubble/3/index.html
/Users/sand/GitHub/mono/projects/ws/notes/archives/bubble/3/webseriously.html
/Users/sand/GitHub/mono/projects/ws/notes/archives/experiments/simulate bubble/simulate.html

  [31m✘ [41;31m[[41;97mERROR[41;31m][0m [1mENOENT: no such file or directory, open '/Users/sand/GitHub/mono/projects/ws/notes/archives/2025/index copy.html'[0m [1m[35m[plugin vite:dep-scan][0m

    node_modules/vitepress/node_modules/esbuild/lib/main.js:1275:21:
[37m      1275 │         let result = [32m[37mawait callback({
           ╵                      [32m^[0m

    at async open (node:internal/fs/promises:639:25)
    at async Object.readFile (node:internal/fs/promises:1246:14)
    at async htmlTypeOnLoadCallback (file:///Users/sand/GitHub/mono/node_modules/vitepress/node_modules/vite/dist/node/chunks/dep-BK3b2jBa.js:49701:19)
    at async requestCallbacks.on-load (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1275:22)
    at async handleRequest (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:647:11)

  This error came from the "onLoad" callback registered here:

    node_modules/vitepress/node_modules/esbuild/lib/main.js:1150:20:
[37m      1150 │       let promise = [32m[37msetup({
           ╵                     [32m^[0m

    at setup (file:///Users/sand/GitHub/mono/node_modules/vitepress/node_modules/vite/dist/node/chunks/dep-BK3b2jBa.js:49785:13)
    at handlePlugins (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1150:21)
    at buildOrContextImpl (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:873:5)
    at Object.buildOrContext (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:699:5)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:2032:68
    at new Promise (<anonymous>)
    at Object.context (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:2032:27)
    at Object.context (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1874:58)
    at prepareEsbuildScanner (file:///Users/sand/GitHub/mono/node_modules/vitepress/node_modules/vite/dist/node/chunks/dep-BK3b2jBa.js:49576:24)

  The plugin "vite:dep-scan" was triggered by this import

    <stdin>:7:7:
[37m      7 │ import [32m"/Users/sand/GitHub/mono/projects/ws/notes/archives/2025/ind[37m...
        ╵        [32m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m


    at failureErrorWithLog (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1472:15)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:945:25
    at runOnEndCallbacks (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:1315:45)
    at buildResponseToResult (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:943:7)
    at /Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:955:9
    at new Promise (<anonymous>)
    at requestCallbacks.on-end (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:954:54)
    at handleRequest (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:647:17)
    at handleIncomingPacket (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:672:7)
    at Socket.readFromStdout (/Users/sand/GitHub/mono/node_modules/vitepress/node_modules/esbuild/lib/main.js:600:7)
5:09:05 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/ws/.svelte-kit/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:09:05 PM [vitepress] projects/ws/.vitepress/theme/index.ts created, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
5:09:06 PM [vitepress] page reload projects/ws/public/goo.html
5:09:06 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/ws/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:09:07 PM [vitepress] projects/sh/.vitepress/theme/index.ts created, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
5:16:11 PM [vitepress] projects/sh/.vitepress/theme/index.ts deleted, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
5:21:13 PM [vitepress] page reload projects/di/index.html
5:21:13 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/di/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:21:15 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/ws/.svelte-kit/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:21:15 PM [vitepress] projects/ws/.vitepress/theme/index.ts created, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
5:21:15 PM [vitepress] page reload projects/ws/public/goo.html
5:21:15 PM [vitepress] changed tsconfig file detected: /Users/sand/GitHub/mono/projects/ws/tsconfig.json - Clearing cache and forcing full-reload to ensure TypeScript is compiled with updated config values.
5:21:16 PM [vitepress] projects/sh/.vitepress/theme/index.ts created, restarting server...


  vitepress v1.6.4

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
error Command failed with signal "SIGKILL".
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
```

### /Users/sand/GitHub/mono/logs/dispatcher-restart.log
```log
```

### /Users/sand/GitHub/mono/logs/di.log
```log
yarn run v1.22.22
$ vite
9:01:08 PM [vite] (client) Re-optimizing dependencies because lockfile has changed

  VITE v6.4.1  ready in 695 ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
9:01:16 PM [vite-plugin-svelte] src/App.svelte:12:1 No scopable elements found in template. If you're using global styles in the style tag, you should move it into an external stylesheet file and import it in JS. See https://github.com/sveltejs/vite-plugin-svelte/blob/main/docs/faq.md#where-should-i-put-my-global-styles.
4:49:58 PM [vite] (client) hmr update /src/lib/svelte/main/Graph.svelte, /src/lib/svelte/main/Main.svelte
4:52:30 PM [vite] (client) hmr update /src/lib/svelte/main/Graph.svelte, /src/lib/svelte/main/Main.svelte
```

### /Users/sand/GitHub/mono/logs/api-restart.log
```log
Exception in thread Thread-1 (restart_sites_async):
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/sand/GitHub/mono/notes/sites/api.py", line 100, in restart_sites_async
    subprocess.run([servers_script], capture_output=True)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 501, in run
    with Popen(*popenargs, **kwargs) as process:
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 969, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 1845, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
PermissionError: [Errno 13] Permission denied: '/Users/sand/GitHub/mono/notes/sites/servers.sh'
Exception in thread Thread-2 (restart_sites_async):
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/sand/GitHub/mono/notes/sites/api.py", line 100, in restart_sites_async
    subprocess.run([servers_script], capture_output=True)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 501, in run
    with Popen(*popenargs, **kwargs) as process:
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 969, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 1845, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
PermissionError: [Errno 13] Permission denied: '/Users/sand/GitHub/mono/notes/sites/servers.sh'
Exception in thread Thread-3 (restart_sites_async):
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/sand/GitHub/mono/notes/sites/api.py", line 100, in restart_sites_async
    subprocess.run([servers_script], capture_output=True)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 501, in run
    with Popen(*popenargs, **kwargs) as process:
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 969, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/subprocess.py", line 1845, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
PermissionError: [Errno 13] Permission denied: '/Users/sand/GitHub/mono/notes/sites/servers.sh'
```

### /Users/sand/GitHub/mono/logs/di-docs.log
```log
yarn run v1.22.22
$ vitepress dev

  vitepress v1.6.4

  ➜  Local:   http://localhost:5175/
  ➜  Network: use --host to expose
```

### /Users/sand/GitHub/mono/logs/dispatch.log
```log
::1 - - [12/Jan/2026 16:40:08] "GET / HTTP/1.1" 200 -
::1 - - [12/Jan/2026 16:40:08] "GET /ports.json HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:25:59] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:25:59] "GET /ports.json HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:33:17] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:34:55] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:39:26] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:39:45] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:40:17] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:41:24] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:41:24] "GET /ports.json HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:41:24] code 404, message File not found
::1 - - [13/Jan/2026 11:41:24] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [13/Jan/2026 11:43:07] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:44:48] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:44:58] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:45:22] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:45:22] "GET /ports.json HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:45:22] code 404, message File not found
::1 - - [13/Jan/2026 11:45:22] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [13/Jan/2026 11:46:52] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:46:52] "GET /ports.json HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:46:52] code 404, message File not found
::1 - - [13/Jan/2026 11:46:52] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [13/Jan/2026 11:46:59] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:48:32] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:48:36] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:48:36] "GET /ports.json HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:48:36] code 404, message File not found
::1 - - [13/Jan/2026 11:48:36] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [13/Jan/2026 11:55:11] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:55:11] "GET /ports.json HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:58:34] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:58:34] "GET /ports.json HTTP/1.1" 200 -
::1 - - [13/Jan/2026 11:58:34] code 404, message File not found
::1 - - [13/Jan/2026 11:58:34] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [13/Jan/2026 11:58:45] "GET / HTTP/1.1" 304 -
::1 - - [13/Jan/2026 11:58:45] "GET /ports.json HTTP/1.1" 304 -
::1 - - [13/Jan/2026 12:02:47] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 12:02:47] "GET /ports.json HTTP/1.1" 304 -
::1 - - [13/Jan/2026 12:05:14] "GET / HTTP/1.1" 200 -
::1 - - [13/Jan/2026 12:05:14] "GET /ports.json HTTP/1.1" 304 -
::1 - - [13/Jan/2026 12:54:12] code 404, message File not found
::1 - - [13/Jan/2026 12:54:12] "GET / HTTP/1.1" 404 -
::1 - - [13/Jan/2026 12:54:50] code 404, message File not found
::1 - - [13/Jan/2026 12:54:50] "GET / HTTP/1.1" 404 -
::1 - - [13/Jan/2026 12:54:51] code 404, message File not found
::1 - - [13/Jan/2026 12:54:51] "GET / HTTP/1.1" 404 -
./servers.sh: line 57: 26583 Killed: 9               python3 -m http.server 5170
```

### /Users/sand/GitHub/mono/logs/paths.log
```log
=== Path Validator ===
Root: /Users/sand/GitHub/mono/notes
Run: 1/24/2026, 8:20:31 PM
```

### /Users/sand/GitHub/mono/logs/hub.log
```log
::1 - - [30/Jan/2026 21:01:16] "GET / HTTP/1.1" 200 -
::1 - - [30/Jan/2026 21:01:22] code 404, message File not found
::1 - - [30/Jan/2026 21:01:22] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 09:22:42] "GET / HTTP/1.1" 304 -
::1 - - [31/Jan/2026 09:22:53] "GET /ports.json HTTP/1.1" 304 -
::1 - - [31/Jan/2026 09:22:53] code 404, message File not found
::1 - - [31/Jan/2026 09:22:53] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 09:28:21] code 404, message File not found
::1 - - [31/Jan/2026 09:28:21] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:00:28] code 404, message File not found
::1 - - [31/Jan/2026 16:00:28] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:14:23] code 404, message File not found
::1 - - [31/Jan/2026 16:14:23] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:17:31] code 404, message File not found
::1 - - [31/Jan/2026 16:17:31] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:20:43] code 404, message File not found
::1 - - [31/Jan/2026 16:20:43] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:21:28] code 404, message File not found
::1 - - [31/Jan/2026 16:21:28] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:22:30] code 404, message File not found
::1 - - [31/Jan/2026 16:22:30] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:24:57] code 404, message File not found
::1 - - [31/Jan/2026 16:24:57] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:26:02] code 404, message File not found
::1 - - [31/Jan/2026 16:26:02] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 16:26:30] code 404, message File not found
::1 - - [31/Jan/2026 16:26:30] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Jan/2026 21:15:15] "GET / HTTP/1.1" 304 -
::1 - - [31/Jan/2026 21:15:22] "GET / HTTP/1.1" 304 -
::1 - - [31/Jan/2026 21:15:28] "GET / HTTP/1.1" 304 -
::1 - - [31/Jan/2026 21:15:34] "GET / HTTP/1.1" 304 -
::1 - - [31/Jan/2026 21:15:40] "GET / HTTP/1.1" 304 -
::1 - - [31/Jan/2026 21:20:14] code 404, message File not found
::1 - - [31/Jan/2026 21:20:14] "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 -
::1 - - [31/Jan/2026 21:20:31] "GET / HTTP/1.1" 200 -
::1 - - [31/Jan/2026 21:20:31] code 404, message File not found
::1 - - [31/Jan/2026 21:20:31] "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 -
::1 - - [31/Jan/2026 21:20:31] "GET /ports.json HTTP/1.1" 200 -
```

### /Users/sand/GitHub/mono/logs/restart-status.txt
```txt
✓ All 6 sites are up
```

### /Users/sand/GitHub/mono/logs/health.log
```log
=== Path Validator ===
[KChecked: 1  Passed: 1  Broken: 0  Path: guides/collaborate/chat.md[KChecked: 2  Passed: 2  Broken: 0  Path: guides/collaborate/repo.md[KChecked: 3  Passed: 3  Broken: 0  Path: guides/setup/hub-app-spec.md[KChecked: 4  Passed: 4  Broken: 0  Path: guides/setup/hub-app.md[KChecked: 5  Passed: 5  Broken: 0  Path: work/articles/write.article.md[KChecked: 6  Passed: 6  Broken: 0  Path: work/articles/write.article.md
Log: /Users/sand/GitHub/mono/notes/logs/paths.log
Time: 00:00
RESULT: All 6 paths valid
(3s)

=== Workspace Integrity ===
yarn workspaces v1.22.22
{
  "designintuition": {
    "location": "di",
    "workspaceDependencies": [],
    "mismatchedWorkspaceDependencies": []
  },
  "webseriously": {
    "location": "ws",
    "workspaceDependencies": [],
    "mismatchedWorkspaceDependencies": []
  }
}
Done in 0.03s.
(0s)

=== Build (ws) ===
yarn run v1.22.22
$ vite build
vite v4.5.14 building for production...
transforming...
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:41:4 A11y: Non-interactive element <li> should not be assigned mouse or keyboard event listeners.
39:     {#key `${$w_separator_color}:::${$results_index}:::${$w_search_results_changed}`}
40:       {#each results as result, index}
41:         <li class:selected={$results_index === index} style='color: {result.color}'
            ^
42:           on:mousedown={(event) => handle_row_selected(event, index)}>
43:           <span>{@html highlightMatch(result.title)}</span>				</li>
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte:36:0 A11y: noninteractive element cannot have nonnegative tabIndex value
34: </script>
35: 
36: <div class='search-results'
    ^
37:   tabindex='0'>
38:   <ul bind:this={element}>
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
52:   on:keydown = {u.ignore}
53:   on:click={() => $w_id_popupView = null}>
54:   <div class='notes-modal-content'
      ^
55:     style='background-color:{$w_background_color}'
56:     on:click|stopPropagation>
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:54:1 A11y: <div> with click handler must have an ARIA role
52:   on:keydown = {u.ignore}
53:   on:click={() => $w_id_popupView = null}>
54:   <div class='notes-modal-content'
      ^
55:     style='background-color:{$w_background_color}'
56:     on:click|stopPropagation>
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte:50:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
48: 
49: <svelte:document on:keydown={handle_key_down} />
50: <div class='notes-modal-overlay'
    ^
51:   on:keyup = {u.ignore}
52:   on:keydown = {u.ignore}
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
60:       <span class='title'>{$w_preview_filename}</span>
61:     </div>
62:     <div class='close-wrapper' on:click={dismiss_popup}>
        ^
63:       <Close_Button
64:         name='preview-close'
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:62:2 A11y: <div> with click handler must have an ARIA role
60:       <span class='title'>{$w_preview_filename}</span>
61:     </div>
62:     <div class='close-wrapper' on:click={dismiss_popup}>
        ^
63:       <Close_Button
64:         name='preview-close'
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
54:   on:keydown={u.ignore}
55:   on:click={dismiss_popup}>
56:   <div class='preview-content'
      ^
57:     style='background-color:{$w_background_color}'
58:     on:click|stopPropagation>
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:56:1 A11y: <div> with click handler must have an ARIA role
54:   on:keydown={u.ignore}
55:   on:click={dismiss_popup}>
56:   <div class='preview-content'
      ^
57:     style='background-color:{$w_background_color}'
58:     on:click|stopPropagation>
8:20:33 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte:52:0 A11y: <div> with keyup, keydown, click handlers must have an ARIA role
50: <svelte:document on:keydown={handleKeydown}/>
51: 
52: <div class='preview-overlay'
    ^
53:   on:keyup={u.ignore}
54:   on:keydown={u.ignore}
8:20:34 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: visible, non-interactive elements with an on:click event must be accompanied by a keyboard event handler. Consider whether an interactive element such as <button type="button"> or <a> might be more appropriate. See https://svelte.dev/docs/accessibility-warnings#a11y-click-events-have-key-events for more details.
10: </script>
11: 
12: <a
    ^
13:   on:click={handle_mouseUp}
14:   style='
8:20:34 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> with click handler must have an ARIA role
10: </script>
11: 
12: <a
    ^
13:   on:click={handle_mouseUp}
14:   style='
8:20:34 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte:12:0 A11y: <a> element should have an href attribute
10: </script>
11: 
12: <a
    ^
13:   on:click={handle_mouseUp}
14:   style='
8:20:34 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte:7:11 Glows_Banner has unused export property 'isSelected'. If it is for external reference only, please consider using `export const isSelected`
 5: export let toggle_hidden;
 6: export let font_size = k.font_size.details;
 7: export let isSelected = false;
               ^
 8: export let banner_id = k.empty;
 9: export let titles;
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

8:20:35 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte:198:1 A11y: <div> with keyup, keydown handlers must have an ARIA role
196: 
197: {#if s_widget}
198:   <div class='widget'
       ^
199:     id={s_component.id}
200:     bind:this={element}
8:20:35 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte:11:11 Glow_Button has unused export property 'name'. If it is for external reference only, please consider using `export const name`
 9: export let banner_id = k.empty;
10: export let title = k.empty;
11: export let name = k.empty;
               ^
12: export let height;
13: export let width;
DEPRECATION WARNING [legacy-js-api]: The legacy JS API is deprecated and will be removed in Dart Sass 2.0.0.

More info: https://sass-lang.com/d/legacy-js-api

8:20:35 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte:7:11 Curved_Text has unused export property 'center_ofArc'. If it is for external reference only, please consider using `export const center_ofArc`
 5: export let font_family = $w_thing_fontFamily;
 6: export let g_cluster_pager;
 7: export let center_ofArc = Point.zero;
               ^
 8: export let zindex = T_Layer.text;
 9: export let text = k.space;
8:20:35 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:7:11 Cluster_Pager has unused export property 'thumb_path_d'. If it is for external reference only, please consider using `export const thumb_path_d`
 5: export let handle_mouseUp = () => { };
 6: export let thumbTransform = k.empty;
 7: export let thumb_path_d = k.empty;
               ^
 8: export let size = k.height.dot;
 9: export let center = Point.zero;
8:20:35 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:9:11 Cluster_Pager has unused export property 'center'. If it is for external reference only, please consider using `export const center`
 7: export let thumb_path_d = k.empty;
 8: export let size = k.height.dot;
 9: export let center = Point.zero;
               ^
10: export let direction = k.empty;
11: export let viewBox = k.empty;
8:20:35 PM [vite-plugin-svelte] /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte:11:11 Cluster_Pager has unused export property 'viewBox'. If it is for external reference only, please consider using `export const viewBox`
 9: export let center = Point.zero;
10: export let direction = k.empty;
11: export let viewBox = k.empty;
               ^
12: export let name = k.empty;
13: export let color = 'red';
✓ 857 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                     0.54 kB │ gzip:   0.36 kB
dist/assets/seriously-icon.png    483.51 kB
dist/assets/index.css              19.29 kB │ gzip:   4.40 kB
dist/assets/index.js            2,210.51 kB │ gzip: 434.70 kB │ map: 3,649.58 kB
✓ built in 8.08s
Done in 8.98s.
(9s)

=== Build (di) ===
yarn run v1.22.22
$ vite build
vite v6.4.1 building for production...
transforming...
✓ 148 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                  0.39 kB │ gzip:  0.28 kB
dist/assets/index-6XV02tHE.css   1.11 kB │ gzip:  0.44 kB
dist/assets/index-Zlx6hPyF.js   96.88 kB │ gzip: 32.51 kB
✓ built in 881ms
Done in 1.64s.
(2s)

=== Docs Build ===
yarn run v1.22.22
$ vitepress build

  vitepress v1.6.4

- building client + server bundles...

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
[32m✓[0m building client + server bundles...
- rendering pages...
[32m✓[0m rendering pages...
build complete in 39.56s.
Done in 40.26s.
(40s)

=== Tests (ws) ===
yarn run v1.22.22
$ vitest run

[1m[46m RUN [49m[22m [36mv4.0.17 [39m[90m/Users/sand/GitHub/mono/ws[39m

 [32m✓[39m src/lib/ts/tests/UX_initialization.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32m✓[39m src/lib/ts/tests/Colors.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32m✓[39m src/lib/ts/tests/Coordinates.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32m✓[39m src/lib/ts/tests/UX_direct_setters.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32m✓[39m src/lib/ts/tests/recents_new.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 18[2mms[22m[39m
 [32m✓[39m src/lib/ts/tests/UX_becomeFocus.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m✓[39m src/lib/ts/tests/UX_integration.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 6[2mms[22m[39m

[2m Test Files [22m [1m[32m7 passed[39m[22m[90m (7)[39m
[2m      Tests [22m [1m[32m78 passed[39m[22m[90m (78)[39m
[2m   Start at [22m 20:21:24
[2m   Duration [22m 3.73s[2m (transform 4.44s, setup 7.82s, import 254ms, tests 57ms, environment 6.01s)[22m

Done in 4.88s.
(6s)

=== Tests (di) ===
yarn run v1.22.22
$ vitest run

 RUN  v3.2.4 /Users/sand/GitHub/mono/di

 ✓ src/lib/ts/tests/Testworthy_Utilities.test.ts (41 tests) 15ms
 ✓ src/lib/ts/tests/Angle.test.ts (51 tests) 14ms
 ✓ src/lib/ts/tests/Extensions.test.ts (42 tests) 38ms
 ✓ src/lib/ts/tests/Coordinates.test.ts (40 tests) 13ms
 ✓ src/lib/ts/tests/Colors.test.ts (32 tests) 9ms

 Test Files  5 passed (5)
      Tests  206 passed (206)
   Start at  20:21:29
   Duration  1.20s (transform 751ms, setup 56ms, collect 1.31s, tests 90ms, environment 1ms, prepare 740ms)

Done in 2.46s.
(2s)

```

### /Users/sand/GitHub/mono/notes/tools/.DS_Store
```DS_Store
   Bud1           
                                                    	      bwspblob   �                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       	    d o c sbwspblob   �bplist00�]ShowStatusBar[ShowToolbar[ShowTabView_ContainerShowSidebar\WindowBounds[ShowSidebar			_{{537, 273}, {920, 464}}	#/;R_klmno�                            �    d o c svSrnlong       l o g sdsclbool     l o g slg1Scomp      �    l o g smoDDblob   >jԊ�A    l o g smodDblob   >jԊ�A    l o g sph1Scomp      `     s c r i p t sbwspblob   �bplist00�]ShowStatusBar[ShowToolbar[ShowTabView_ContainerShowSidebar\WindowBounds[ShowSidebar			_{{654, 266}, {920, 464}}	#/;R_klmno�                            �    s c r i p t svSrnlong                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       DSDB                                 `          �                                         @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```

### /Users/sand/GitHub/mono/notes/tools/docs/sync-index-files.sh
```sh
#!/bin/bash

# Sync Index Files
# Creates/updates index.md files to list all subdirectories and files
#
# Usage: sync-index-files.sh [project-root]
#
# To prevent an index.md from being overwritten, add this comment:
#   <!-- @manual -->

PROJECT_ROOT="${1:-$(pwd)}"
cd "$PROJECT_ROOT" || exit 1

# Source project-specific config if it exists
CONFIG_FILE="notes/tools/config.sh"
[ -f "$CONFIG_FILE" ] && source "$CONFIG_FILE"

# Defaults (can be overridden by config.sh)
NOTES_DIR="${NOTES_DIR:-$PROJECT_ROOT/notes}"

# Folders to exclude (by name, not path)
# Can be extended in config.sh by setting EXCLUDE_FOLDERS_EXTRA
EXCLUDE_FOLDERS=(
    "archives"
    "dist"
    "docs"
    "done"
    "lib"
)

# Add any extra exclusions from config
if [ -n "$EXCLUDE_FOLDERS_EXTRA" ]; then
    EXCLUDE_FOLDERS+=($EXCLUDE_FOLDERS_EXTRA)
fi

# Function to check if folder should be excluded
is_excluded() {
    local folder_name="$1"
    for excluded in "${EXCLUDE_FOLDERS[@]}"; do
        [ "$folder_name" = "$excluded" ] && return 0
    done
    return 1
}

# Function to check if index.md is manually maintained
is_manual() {
    local file="$1"
    [ -f "$file" ] && grep -q '<!-- *@manual *-->' "$file" 2>/dev/null
}

# Function to convert kebab-case to Title Case
to_title_case() {
    echo "$1" | sed 's/-/ /g' | awk '{for(i=1;i<=NF;i++)sub(/./,toupper(substr($i,1,1)),$i)}1'
}

# Function to extract existing custom content (everything before ## Contents/Sections/Topics)
extract_custom_content() {
    local index_file="$1"
    awk '
        /^## (Contents|Sections|Topics)/ { exit }
        { print }
    ' "$index_file"
}

# Function to generate/update index.md content for a directory
sync_index() {
    local dir="$1"
    local index_file="${dir}/index.md"
    local dir_name=$(basename "$dir")
    local title=$(to_title_case "$dir_name")
    
    # Always use title from directory name
    local title=$(echo "$dir_name" | sed 's/-/ /g' | awk '{for(i=1;i<=NF;i++)sub(/./,toupper(substr($i,1,1)),$i)}1')
    
    # Check if index.md exists and extract custom content (description only, not title)
    local custom_description=""
    if [ -f "$index_file" ]; then
        # Extract content after first # line but before ## Contents/Sections/Topics
        custom_description=$(awk '
            /^# / { next }  # Skip title line
            /^## (Contents|Sections|Topics)/ { exit }
            NF { print }  # Print non-empty lines
        ' "$index_file")
    fi
    
    # Start with title
    local content="# ${title}\n"
    
    # Add custom description if it exists
    if [ -n "$custom_description" ]; then
        content+="\n${custom_description}\n"
    fi
    
    content+="\n"
    
    # Collect subdirectories with index.md
    local subdirs=()
    for subdir in "$dir"/*/ ; do
        [ -d "$subdir" ] || continue
        local subdir_name=$(basename "$subdir")
        # Skip hidden directories
        [[ "$subdir_name" == .* ]] && continue
        if [ -f "${subdir}index.md" ]; then
            subdirs+=("$subdir_name")
        fi
    done
    
    # Collect markdown files
    local files=()
    for file in "$dir"/*.md ; do
        [ -f "$file" ] || continue
        local filename=$(basename "$file")
        # Skip index.md itself
        [ "$filename" = "index.md" ] && continue
        files+=("$filename")
    done
    
    # Only add Contents section if there are items
    if [ ${#subdirs[@]} -gt 0 ] || [ ${#files[@]} -gt 0 ]; then
        content+="## Contents\n\n"
        
        # Add subdirectories first
        for subdir in "${subdirs[@]}"; do
            local subdir_title=$(echo "$subdir" | sed 's/-/ /g' | awk '{for(i=1;i<=NF;i++)sub(/./,toupper(substr($i,1,1)),$i)}1')
            content+="- [${subdir_title}](./${subdir}/)\n"
        done
        
        # Add files
        for file in "${files[@]}"; do
            local file_title=$(echo "$file" | sed 's/\.md$//' | sed 's/-/ /g' | awk '{for(i=1;i<=NF;i++)sub(/./,toupper(substr($i,1,1)),$i)}1')
            content+="- [${file_title}](./${file})\n"
        done
    fi
    
    echo -e "$content" > "$index_file"
}

# Recursive function to process directories
process_directory() {
    local dir="$1"
    local dir_name=$(basename "$dir")
    local index_file="${dir}/index.md"
    
    # Check if manually maintained
    if is_manual "$index_file"; then
        echo "Skipping index.md in: $dir_name (marked @manual)"
    elif [ -f "$index_file" ]; then
        echo "Updating index.md in: $dir_name"
        sync_index "$dir"
    else
        echo "Creating index.md in: $dir_name"
        sync_index "$dir"
    fi
    
    # Process subdirectories
    for subdir in "$dir"/*/ ; do
        [ -d "$subdir" ] || continue
        local subdir_name=$(basename "$subdir")
        # Skip hidden directories
        [[ "$subdir_name" == .* ]] && continue
        # Skip excluded directories
        if is_excluded "$subdir_name"; then
            echo "Skipping excluded folder: $subdir_name"
            continue
        fi
        process_directory "$subdir"
    done
}

echo "Syncing index.md files..."
echo ""

# Start from notes directory
process_directory "$NOTES_DIR"

echo ""
echo "✅ All index.md files synced!"
```

### /Users/sand/GitHub/mono/notes/tools/docs/prebuild.sh
```sh
#!/bin/bash
# Copies project docs into notes/ for VitePress build
# Netlify runs this; locally use symlinks instead

cd "$(dirname "$0")/../.."

# Remove old symlinks/copies
rm -rf notes/ws notes/di

# Copy (not symlink) so VitePress sees correct paths
cp -r projects/ws/notes notes/ws
cp -r projects/di/notes notes/di

echo "✅ Copied project docs to notes/ws and notes/di"
```

### /Users/sand/GitHub/mono/notes/tools/docs/update-project-docs.sh
```sh
#!/bin/bash

# Update Docs Workflow (quiet mode)
# Single-line progress display, errors logged to file
#
# Usage: update.sh [project-root]
#        update.sh all           # updates all projects
#        update.sh --verbose     # full output (old behavior)
#        update.sh --force       # rebuild even if no changes
#        update.sh [project] --verbose

# Compute SCRIPT_DIR immediately before any cd commands
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

GITHUB_DIR="$HOME/GitHub"
ALL_PROJECTS=("mono" "mono/ws" "mono/di")
ERROR_LOG=""
VERBOSE=false
CURRENT_STEP=0
TOTAL_STEPS=7

# Parse arguments
PROJECT_ARG=""
FORCE=false
for arg in "$@"; do
  case "$arg" in
    --verbose|-v)
      VERBOSE=true
      ;;
    --force|-f)
      FORCE=true
      ;;
    *)
      PROJECT_ARG="$arg"
      ;;
  esac
done

# Progress display
# Writes compact status to file for hub polling
# Format: "{project} {step}/{total} {step-name}" with optional sub-progress
STATUS_FILE=""
PROJECT_NAME=""

if [ -n "$REBUILD_STATUS_FILE" ]; then
  STATUS_FILE="$REBUILD_STATUS_FILE"
  PROJECT_NAME="$REBUILD_PROJECT"
fi

# Translate VitePress output to simple status
translate_vp_line() {
  local line="$1"
  case "$line" in
    *"building client + server bundles..."*)
      if [[ "$line" == *"✓"* ]]; then
        echo "bundled"
      else
        echo "bundling"
      fi
      ;;
    *"rendering pages..."*)
      if [[ "$line" == *"✓"* ]]; then
        echo "rendered"
      else
        echo "rendering"
      fi
      ;;
    *"generating sitemap..."*)
      echo "sitemap"
      ;;
    *"build error:"*)
      echo "error"
      ;;
    *"Build failed"*)
      echo "failed"
      ;;
    *"built in"*)
      echo "done"
      ;;
    *"dead links:"*)
      # Pass through our own count message
      echo "$line"
      ;;
    *"Found dead link"*|*"dead link"*)
      echo "dead link"
      ;;
    *"Fixed:"*)
      echo "fixed"
      ;;
    *"Unfixable:"*)
      echo "unfixable"
      ;;
    *"npx"*|*"tsc"*)
      echo "compiling"
      ;;
    *"The language"*|*"(!)"*|*"yarn run"*|*"vitepress v"*|*"info Visit"*|*"error Command"*|*"$ vitepress"*|*"> vitepress"*)
      # Skip noise
      echo ""
      ;;
    *)
      # Unknown - show truncated
      echo "${line:0:20}"
      ;;
  esac
}

progress() {
  local step="$1"
  local name="$2"
  local sub="$3"
  
  if [ "$VERBOSE" = true ]; then
    echo "$name"
  else
    if [ -n "$sub" ]; then
      printf "\r\033[K%s %d/%d %s → %s" "$PROJECT_NAME" "$step" "$TOTAL_STEPS" "$name" "$sub"
    else
      printf "\r\033[K%s %d/%d %s" "$PROJECT_NAME" "$step" "$TOTAL_STEPS" "$name"
    fi
  fi
  
  # Write to status file if set
  if [ -n "$STATUS_FILE" ]; then
    if [ -n "$sub" ]; then
      echo "$PROJECT_NAME $step/$TOTAL_STEPS $name → $sub" > "$STATUS_FILE"
    else
      echo "$PROJECT_NAME $step/$TOTAL_STEPS $name" > "$STATUS_FILE"
    fi
  fi
}

# Progress with sub-item (for streaming output)
progress_item() {
  local raw="$1"
  local translated=$(translate_vp_line "$raw")
  
  # Skip empty translations (noise)
  [ -z "$translated" ] && return
  
  if [ "$VERBOSE" = true ]; then
    echo "  $raw"
  else
    printf "\r\033[K%s %d/%d %s → %s" "$PROJECT_NAME" "$CURRENT_STEP" "$TOTAL_STEPS" "$STEP_NAME" "$translated"
  fi
  
  # Write to status file if set
  if [ -n "$STATUS_FILE" ]; then
    echo "$PROJECT_NAME $CURRENT_STEP/$TOTAL_STEPS $STEP_NAME → $translated" > "$STATUS_FILE"
  fi
}

# Clear progress line
clear_progress() {
  if [ "$VERBOSE" = false ]; then
    printf "\r\033[K"
  fi
}

# Run a command, streaming output to progress display
# On error: append to error log, return non-zero
run_cmd() {
  if [ "$VERBOSE" = true ]; then
    "$@"
    return $?
  fi
  
  local tmp_out=$(mktemp)
  
  # Run command, capture output
  "$@" > "$tmp_out" 2>&1 &
  local pid=$!
  
  # Display output lines as they appear
  while kill -0 $pid 2>/dev/null; do
    if [ -s "$tmp_out" ]; then
      local last_line=$(tail -1 "$tmp_out")
      [ -n "$last_line" ] && progress_item "$last_line"
    fi
    sleep 0.1
  done
  
  # Get exit code
  wait $pid
  local exit_code=$?
  
  # Show final line
  if [ -s "$tmp_out" ]; then
    local last_line=$(tail -1 "$tmp_out")
    [ -n "$last_line" ] && progress_item "$last_line"
  fi
  
  # On error, append output to error log
  if [ $exit_code -ne 0 ]; then
    echo "" >> "$ERROR_LOG"
    echo "=== Step $CURRENT_STEP: $STEP_NAME ===" >> "$ERROR_LOG"
    cat "$tmp_out" >> "$ERROR_LOG"
  fi
  
  rm -f "$tmp_out"
  return $exit_code
}

# Run vitepress build, streaming progress from its output file
run_vp_build() {
  local output_file="$PROJECT_ROOT/vitepress.build.txt"
  
  # Clear previous output
  > "$output_file"
  
  # Start build in background
  if [ "$VERBOSE" = true ]; then
    yarn docs:build
    return $?
  fi
  
  yarn docs:build > /dev/null 2>&1 &
  local pid=$!
  
  local last_line=""
  local dead_link_count=0
  
  # Poll the output file while build runs
  while kill -0 $pid 2>/dev/null; do
    if [ -s "$output_file" ]; then
      local current_line=$(tail -1 "$output_file")
      if [ "$current_line" != "$last_line" ]; then
        last_line="$current_line"
        
        # Count dead links
        if [[ "$current_line" == *"Found dead link"* ]] || [[ "$current_line" == *"dead link"* ]]; then
          dead_link_count=$((dead_link_count + 1))
          progress_item "dead links: $dead_link_count"
        else
          progress_item "$current_line"
        fi
      fi
    fi
    sleep 0.2
  done
  
  # Get exit code
  wait $pid
  local exit_code=$?
  
  # Show final status
  if [ -s "$output_file" ]; then
    local final_line=$(tail -1 "$output_file")
    if [[ "$final_line" == *"Found dead link"* ]] || [[ "$final_line" == *"dead link"* ]]; then
      dead_link_count=$((dead_link_count + 1))
      progress_item "dead links: $dead_link_count"
    else
      progress_item "$final_line"
    fi
  fi
  
  # On error, append to error log
  if [ $exit_code -ne 0 ]; then
    echo "" >> "$ERROR_LOG"
    echo "=== Step $CURRENT_STEP: $STEP_NAME ===" >> "$ERROR_LOG"
    cat "$output_file" >> "$ERROR_LOG"
  fi
  
  return $exit_code
}

# Start a step
start_step() {
  CURRENT_STEP=$1
  STEP_NAME="$2"
  progress "$CURRENT_STEP" "$STEP_NAME"
}

# Fail and exit
fail() {
  clear_progress
  echo "❌ $PROJECT_NAME $CURRENT_STEP/$TOTAL_STEPS $STEP_NAME failed"
  if [ -n "$STATUS_FILE" ]; then
    echo "$PROJECT_NAME $CURRENT_STEP/$TOTAL_STEPS $STEP_NAME → failed" > "$STATUS_FILE"
  fi
  echo ""
  cat "$ERROR_LOG"
  exit 1
}

# Handle "all" option
if [ "$PROJECT_ARG" = "all" ]; then
  # Single status file for all projects
  STATUS_FILE="$GITHUB_DIR/mono/logs/rebuild-status.txt"
  mkdir -p "$GITHUB_DIR/mono/logs"
  
  clear_progress
  echo "Updating all projects..."
  echo "all 0/3 starting" > "$STATUS_FILE"
  echo ""
  
  PROJ_COUNT=${#ALL_PROJECTS[@]}
  PROJ_NUM=0
  
  for proj in "${ALL_PROJECTS[@]}"; do
    PROJ_NUM=$((PROJ_NUM + 1))
    PROJ_NAME=$(basename "$proj")
    echo ">>> $proj"
    
    # Run sub-build, passing status file and project name via env
    sub_args="$GITHUB_DIR/$proj"
    [ "$VERBOSE" = true ] && sub_args="$sub_args --verbose"
    [ "$FORCE" = true ] && sub_args="$sub_args --force"
    
    REBUILD_STATUS_FILE="$STATUS_FILE" REBUILD_PROJECT="$PROJ_NAME" bash "$0" $sub_args
    
    if [ $? -ne 0 ]; then
      echo "$PROJ_NAME failed" > "$STATUS_FILE"
      exit 1
    fi
    echo ""
  done
  
  echo "✓ mono, ws, di"
  echo "✓ mono, ws, di" > "$STATUS_FILE"
  exit 0
fi

# Single project update
PROJECT_ROOT="${PROJECT_ARG:-$(pwd)}"
cd "$PROJECT_ROOT" || exit 1
PROJECT_ROOT=$(pwd)  # Convert to absolute path

# Set PROJECT_NAME if not already set (single project run)
if [ -z "$PROJECT_NAME" ]; then
  PROJECT_NAME=$(basename "$PROJECT_ROOT")
fi

# Set up logs directory
# For mono root, use mono/logs; for subprojects, use projects/logs
if [ "$(basename "$PROJECT_ROOT")" = "mono" ]; then
  LOGS_DIR="$PROJECT_ROOT/logs"
else
  LOGS_DIR="$PROJECT_ROOT/../logs"
fi
mkdir -p "$LOGS_DIR"

# Set up status file for hub polling (only if not already set by parent)
if [ -z "$STATUS_FILE" ]; then
  STATUS_FILE="$LOGS_DIR/rebuild-status.txt"
  echo "Starting..." > "$STATUS_FILE"
fi

# Set up error log
ERROR_LOG="$LOGS_DIR/update-docs.error.log"
rm -f "$ERROR_LOG"
touch "$ERROR_LOG"

# Source project-specific config if it exists
CONFIG_FILE="notes/tools/config.sh"
[ -f "$CONFIG_FILE" ] && source "$CONFIG_FILE"

# Find shared tools directory (SCRIPT_DIR already set at top)
SHARED_TOOLS="${SHARED_TOOLS:-$SCRIPT_DIR}"

# Defaults (can be overridden by config.sh)
NOTES_DIR="${NOTES_DIR:-notes}"
TOOLS_DIST="${TOOLS_DIST:-$SHARED_TOOLS/dist}"

# Determine build output location
BUILD_OUTPUT="$LOGS_DIR/vitepress.build.log"

# Marker file for tracking last successful build
MARKER_FILE="$PROJECT_ROOT/.vitepress/.last-build"

# Check if rebuild is needed (skip if sources unchanged)
check_needs_rebuild() {
  # Always rebuild if marker doesn't exist or --force
  if [ "$FORCE" = true ]; then
    [ "$VERBOSE" = true ] && echo "  [debug] --force specified"
    return 0  # needs rebuild
  fi
  
  if [ ! -f "$MARKER_FILE" ]; then
    [ "$VERBOSE" = true ] && echo "  [debug] no marker file: $MARKER_FILE"
    return 0  # needs rebuild
  fi
  
  # Find newest source file (md files in notes/, config files)
  local newest_source
  newest_source=$(find "$PROJECT_ROOT/$NOTES_DIR" -name "*.md" -type f -newer "$MARKER_FILE" 2>/dev/null | head -1)
  
  if [ -n "$newest_source" ]; then
    [ "$VERBOSE" = true ] && echo "  [debug] newer md: $newest_source"
    return 0
  fi
  
  # Check config.mts
  if [ -f "$PROJECT_ROOT/.vitepress/config.mts" ]; then
    if [ "$PROJECT_ROOT/.vitepress/config.mts" -nt "$MARKER_FILE" ]; then
      [ "$VERBOSE" = true ] && echo "  [debug] config.mts is newer"
      return 0
    fi
  fi
  
  # Check shared tools (if they changed, rebuild all)
  newest_source=$(find "$SHARED_TOOLS" -name "*.ts" -type f -newer "$MARKER_FILE" 2>/dev/null | head -1)
  if [ -n "$newest_source" ]; then
    [ "$VERBOSE" = true ] && echo "  [debug] newer ts: $newest_source"
    return 0
  fi
  
  return 1  # no rebuild needed
}

# Check if we can skip this project
if ! check_needs_rebuild; then
  clear_progress
  echo "○ $PROJECT_NAME up to date"
  if [ -n "$STATUS_FILE" ]; then
    echo "$PROJECT_NAME up to date" > "$STATUS_FILE"
  fi
  exit 0
fi

# Step 1: Compile TypeScript tools
start_step 1 "compiling"
cd "$SHARED_TOOLS"
run_cmd npx tsc || fail
cd "$PROJECT_ROOT"

# Step 2: Sync index.md files
start_step 2 "syncing index"
run_cmd bash "$SHARED_TOOLS/sync-index-files.sh" "$PROJECT_ROOT" || fail

# Step 3: Build VitePress (may fail with broken links)
start_step 3 "building"
run_vp_build
BUILD_EXIT=$?
# Don't fail here - broken links are expected, step 4 will fix them

# Step 4: Fix broken links
start_step 4 "fixing links"
run_cmd node "$TOOLS_DIST/fix-links.js"
FIX_EXIT=$?
if [ $FIX_EXIT -ne 0 ] && [ $FIX_EXIT -ne 2 ]; then
  fail
fi

# Step 5: Generate docs database structure (if configured)
start_step 5 "generating docs db"
if [ -n "$DOCS_OUTPUT" ]; then
  run_cmd bash "$SHARED_TOOLS/create-docs-db-data.sh" "$PROJECT_ROOT" || fail
fi

# Step 6: Rebuild VitePress
start_step 6 "rebuilding"
run_vp_build || fail

# Step 7: Sync all sidebars
start_step 7 "syncing sidebars"
MONO_ROOT="$GITHUB_DIR/mono"
for proj_dir in "$MONO_ROOT/ws" "$MONO_ROOT/di"; do
  if [ -d "$proj_dir/.vitepress" ]; then
    cd "$proj_dir"
    run_cmd node "$TOOLS_DIST/sync-sidebar.js" || fail
  fi
done
cd "$PROJECT_ROOT"

# Done
clear_progress
echo "✓ $PROJECT_NAME done"
if [ -n "$STATUS_FILE" ]; then
  echo "$PROJECT_NAME 7/7 done" > "$STATUS_FILE"
fi

# Touch marker file to track successful build time
touch "$MARKER_FILE"

# Clean up error log if empty
if [ ! -s "$ERROR_LOG" ]; then
  rm -f "$ERROR_LOG"
fi
```

### /Users/sand/GitHub/mono/notes/tools/docs/yarn.lock
```lock
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


"@types/node@^20.0.0":
  version "20.19.28"
  resolved "https://registry.yarnpkg.com/@types/node/-/node-20.19.28.tgz#d968c492e405e4a572f5c27e4f5efc24f0eb9937"
  integrity sha512-VyKBr25BuFDzBFCK5sUM6ZXiWfqgCTwTAOK8qzGV/m9FCirXYDlmczJ+d5dXBAQALGCdRRdbteKYfJ84NGEusw==
  dependencies:
    undici-types "~6.21.0"

typescript@^5.0.0:
  version "5.9.3"
  resolved "https://registry.yarnpkg.com/typescript/-/typescript-5.9.3.tgz#5b4f59e15310ab17a216f5d6cf53ee476ede670f"
  integrity sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==

undici-types@~6.21.0:
  version "6.21.0"
  resolved "https://registry.yarnpkg.com/undici-types/-/undici-types-6.21.0.tgz#691d00af3909be93a7faa13be61b3a5b50ef12cb"
  integrity sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==
```

### /Users/sand/GitHub/mono/notes/tools/docs/package.json
```json
{
  "name": "shared-docs-tools",
  "type": "module",
  "devDependencies": {
    "@types/node": "^20.0.0",
    "typescript": "^5.0.0"
  }
}
```

### /Users/sand/GitHub/mono/notes/tools/docs/create-docs-db-data.sh
```sh
#!/bin/bash

# Create Docs DB Data
# Scans a directory and generates a TypeScript file for documentation structure
#
# Usage: create-docs-db-data.sh [project-root]

PROJECT_ROOT="${1:-$(pwd)}"
cd "$PROJECT_ROOT" || exit 1

# Source project-specific config if it exists
CONFIG_FILE="notes/tools/config.sh"
[ -f "$CONFIG_FILE" ] && source "$CONFIG_FILE"

# Defaults (can be overridden by config.sh)
DOCS_SOURCE_DIR="${DOCS_SOURCE_DIR:-notes}"
DOCS_OUTPUT="${DOCS_OUTPUT:-src/lib/ts/files/Docs.ts}"

echo "Generating Docs.ts from /$DOCS_SOURCE_DIR structure..."

# Create output directory if needed
mkdir -p "$(dirname "$DOCS_OUTPUT")"

# Start writing the file
cat > "$DOCS_OUTPUT" << 'EOF'
// Documentation structure for DB_Docs
// AUTO-GENERATED - DO NOT EDIT MANUALLY
// Run: bash shared/tools/create-docs-db-data.sh to regenerate

export interface DocNode {
	id: string;
	name: string;
	type: 'folder' | 'file';
	path: string;
	link?: string;
	children?: DocNode[];
}

export function getDocsStructure(): DocNode[] {
	return [
EOF

# Function to process a directory recursively
process_directory() {
	local dir="$1"
	local indent="$2"
	local rel_path="$3"
	
	# Get all entries, sorted
	local entries=($(ls -1 "$dir" 2>/dev/null | sort))
	local entry_count=${#entries[@]}
	local current=0
	
	for entry in "${entries[@]}"; do
		# Skip hidden files and system files
		if [[ "$entry" == .* ]] || [[ "$entry" == "node_modules" ]] || [[ "$entry" == "index.md" ]]; then
			continue
		fi
		
		local full_path="$dir/$entry"
		local new_rel_path="$rel_path/$entry"
		
		# Remove leading slash
		new_rel_path="${new_rel_path#/}"
		
		# Generate ID from path (lowercase, replace / and special chars with _)
		local id=$(echo "$new_rel_path" | tr '[:upper:]' '[:lower:]' | sed 's/[/. -]/_/g' | sed 's/_md$//')
		
		# Format name (convert kebab-case to Title Case)
		local name=$(echo "$entry" | sed 's/\.md$//' | sed 's/[-_]/ /g' | awk '{for(i=1;i<=NF;i++) $i=toupper(substr($i,1,1)) tolower(substr($i,2));}1')
		
		current=$((current + 1))
		local is_last=$([[ $current -eq $entry_count ]] && echo "true" || echo "false")
		
		if [[ -d "$full_path" ]]; then
			# It's a directory
			echo "${indent}{" >> "$DOCS_OUTPUT"
			echo "${indent}	id: '$id'," >> "$DOCS_OUTPUT"
			echo "${indent}	name: '$name'," >> "$DOCS_OUTPUT"
			echo "${indent}	type: 'folder'," >> "$DOCS_OUTPUT"
			echo "${indent}	path: '$new_rel_path'," >> "$DOCS_OUTPUT"
			
			# Add link to index.md if it exists in this folder
			if [[ -f "$full_path/index.md" ]]; then
				local link_path="${new_rel_path}/index"
				echo "${indent}	link: '$link_path'," >> "$DOCS_OUTPUT"
			fi
			
			# Check if directory has children (excluding index.md)
			local has_children=$(find "$full_path" -maxdepth 1 \( -name "*.md" -o -type d \) ! -name ".*" ! -name "index.md" ! -name "node_modules" | wc -l)
			
			if [[ $has_children -gt 1 ]]; then
				echo "${indent}	children: [" >> "$DOCS_OUTPUT"
				process_directory "$full_path" "${indent}		" "$new_rel_path"
				echo "${indent}	]" >> "$DOCS_OUTPUT"
			fi
			
			if [[ "$is_last" == "true" ]]; then
				echo "${indent}}" >> "$DOCS_OUTPUT"
			else
				echo "${indent}}," >> "$DOCS_OUTPUT"
			fi
			
		elif [[ -f "$full_path" ]] && [[ "$entry" == *.md ]]; then
			# It's a markdown file
			local file_path="${new_rel_path%.md}"
			echo "${indent}{" >> "$DOCS_OUTPUT"
			echo "${indent}	id: '$id'," >> "$DOCS_OUTPUT"
			echo "${indent}	name: '$name'," >> "$DOCS_OUTPUT"
			echo "${indent}	type: 'file'," >> "$DOCS_OUTPUT"
			echo "${indent}	path: '$file_path'" >> "$DOCS_OUTPUT"
			
			if [[ "$is_last" == "true" ]]; then
				echo "${indent}}" >> "$DOCS_OUTPUT"
			else
				echo "${indent}}," >> "$DOCS_OUTPUT"
			fi
		fi
	done
}

# Process the source directory
process_directory "$DOCS_SOURCE_DIR" "		" ""

# Close the file
cat >> "$DOCS_OUTPUT" << 'EOF'
	];
}
EOF

echo "✅ Generated: $DOCS_OUTPUT"
echo ""
echo "Structure includes:"
wc -l "$DOCS_OUTPUT" | awk '{print "  " $1 " lines"}'
grep -c "type: 'file'" "$DOCS_OUTPUT" | awk '{print "  " $1 " files"}'
grep -c "type: 'folder'" "$DOCS_OUTPUT" | awk '{print "  " $1 " folders"}'
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/generate-sidebar.ts
```ts
import * as fs from 'fs';
import * as path from 'path';

interface SidebarItem {
  text: string;
  link?: string;
  items?: SidebarItem[];
  collapsed?: boolean;
}

export class SidebarGenerator {
  private srcDir: string;
  private srcExclude: string[];
  
  constructor(srcDir: string, srcExclude: string[] = []) {
    this.srcDir = srcDir;
    this.srcExclude = srcExclude;
  }

  /**
   * Generate sidebar structure from filesystem
   */
  generateSidebar(): SidebarItem[] {
    const sidebar: SidebarItem[] = [];
    
    // Get all top-level items
    const entries = fs.readdirSync(this.srcDir, { withFileTypes: true });
    
    // Sort: files first, then directories
    const sorted = entries.sort((a, b) => {
      if (a.isFile() && b.isDirectory()) return -1;
      if (a.isDirectory() && b.isFile()) return 1;
      return a.name.localeCompare(b.name);
    });
    
    for (const entry of sorted) {
      if (this.shouldSkip(entry.name)) continue;
      
      const fullPath = path.join(this.srcDir, entry.name);
      
      if (entry.isDirectory()) {
        const dirItem = this.processDirectory(entry.name, fullPath, '');
        if (dirItem) {
          sidebar.push(dirItem);
        }
      } else if (entry.isFile() && entry.name.endsWith('.md') && entry.name !== 'index.md') {
        const fileItem = this.processFile(entry.name, fullPath);
        if (fileItem) {
          sidebar.push(fileItem);
        }
      }
    }
    
    return sidebar;
  }

  private processDirectory(dirName: string, dirPath: string, parentPath: string): SidebarItem | null {
    const items: SidebarItem[] = [];
    const entries = fs.readdirSync(dirPath, { withFileTypes: true });
    
    // Check if this directory has an index.md
    const hasIndex = entries.some(e => e.isFile() && e.name === 'index.md');
    
    // Sort: files first (except index.md), then directories
    const sorted = entries.sort((a, b) => {
      if (a.name === 'index.md') return 1; // index.md goes last (skip it anyway)
      if (b.name === 'index.md') return -1;
      if (a.isFile() && b.isDirectory()) return -1;
      if (a.isDirectory() && b.isFile()) return 1;
      return a.name.localeCompare(b.name);
    });
    
    for (const entry of sorted) {
      if (this.shouldSkip(entry.name)) continue;
      
      const fullPath = path.join(dirPath, entry.name);
      const currentPath = parentPath + '/' + dirName;
      
      if (entry.isDirectory()) {
        const subDir = this.processDirectory(entry.name, fullPath, currentPath);
        if (subDir) {
          items.push(subDir);
        }
      } else if (entry.isFile() && entry.name.endsWith('.md') && entry.name !== 'index.md') {
        const fileItem = this.processFile(entry.name, fullPath);
        if (fileItem) {
          items.push(fileItem);
        }
      }
    }
    
    // Skip empty directories
    if (items.length === 0 && !hasIndex) {
      return null;
    }
    
    const result: SidebarItem = {
      text: this.formatTitle(dirName),
      collapsed: true,
    };
    
    // Add link if directory has index.md
    if (hasIndex) {
      result.link = parentPath + '/' + dirName + '/';
    }
    
    if (items.length > 0) {
      result.items = items;
    }
    
    return result;
  }

  private processFile(fileName: string, filePath: string): SidebarItem | null {
    // Skip index files (handled at directory level)
    if (fileName === 'index.md') {
      return null;
    }
    
    // Generate link path relative to srcDir
    const relativePath = path.relative(this.srcDir, filePath);
    const linkPath = '/' + relativePath.replace(/\.md$/, '');
    
    return {
      text: this.formatTitle(fileName.replace(/\.md$/, '')),
      link: linkPath
    };
  }

  private shouldSkip(name: string): boolean {
    // Skip system files
    if (name.startsWith('.')) {
      return true;
    }
    
    // Skip excluded patterns
    for (const pattern of this.srcExclude) {
      // Handle glob patterns like '**/node_modules/**'
      // Strip **/ prefix and /** suffix to get directory name
      let dirName = pattern;
      if (dirName.startsWith('**/')) {
        dirName = dirName.slice(3);
      }
      if (dirName.endsWith('/**')) {
        dirName = dirName.slice(0, -3);
      }
      
      if (name === dirName) {
        return true;
      }
    }
    
    return false;
  }

  private formatTitle(name: string): string {
    // Convert filename to title
    // Special cases
    const specialCases: Record<string, string> = {
      'vitepress': 'VitePress',
      'ux': 'UX',
      'ui': 'UI',
      'api': 'API',
      'readme': 'README',
      'gotchas': 'Gotchas',
      'svelte.5': 'Svelte 5',
    };
    
    const lower = name.toLowerCase();
    if (specialCases[lower]) {
      return specialCases[lower];
    }
    
    // Convert kebab-case and snake_case to Title Case
    return name
      .replace(/[-_]/g, ' ')
      .split(' ')
      .map(word => word.charAt(0).toUpperCase() + word.slice(1))
      .join(' ');
  }
}
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/config-updater.ts
```ts
import * as fs from 'fs';
import * as path from 'path';

export interface SidebarItem {
  text: string;
  link: string;
  items?: SidebarItem[];
}

export class ConfigUpdater {
  /**
   * Update VitePress config.mts sidebar entries
   * @param configPath Path to config.mts file
   * @param replacements Map of old link -> new link (or null to delete)
   * @returns Number of entries updated
   */
  static updateConfig(configPath: string, replacements: Map<string, string | null>): number {
    let content = fs.readFileSync(configPath, 'utf-8');
    let updatedCount = 0;

    // Extract all links from config to find matches
    const linkRegex = /link:\s*['"]([^'"]+)['"]/g;
    let match;
    const linksToUpdate = new Map<string, string | null>();

    while ((match = linkRegex.exec(content)) !== null) {
      const configLink = match[1];
      
      // Check if this config link matches any of our replacements
      for (const [oldPath, newPath] of replacements.entries()) {
        if (this.linkMatchesFile(configLink, oldPath)) {
          linksToUpdate.set(configLink, newPath);
          break;
        }
      }
    }

    // Now update/delete the matched links
    for (const [configLink, newPath] of linksToUpdate.entries()) {
      if (newPath === null) {
        // Remove the sidebar entry
        const entryRegex = new RegExp(
          `\\{[^}]*link:\\s*['"]${configLink.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}['"][^}]*\\},?\\s*\n?`,
          'g'
        );
        const beforeUpdate = content;
        content = content.replace(entryRegex, '');
        if (content !== beforeUpdate) {
          updatedCount++;
        }
      } else {
        // Update the link
        const newLink = this.normalizeLink(newPath);
        const linkReplaceRegex = new RegExp(
          `(link:\\s*['"])${configLink.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}(['"])`,
          'g'
        );
        const beforeUpdate = content;
        content = content.replace(linkReplaceRegex, `$1${newLink}$2`);
        if (content !== beforeUpdate) {
          updatedCount++;
        }
      }
    }

    if (updatedCount > 0) {
      fs.writeFileSync(configPath, content, 'utf-8');
    }

    return updatedCount;
  }

  /**
   * Normalize a file path to VitePress link format
   * @param filePath File path like "notes/guides/debugging.md" or "guides/debugging.md"
   * @returns Link like "/notes/guides/debugging"
   */
  private static normalizeLink(filePath: string): string {
    // Remove .md extension
    let link = filePath.replace(/\.md$/, '');
    
    // Ensure it starts with /
    if (!link.startsWith('/')) {
      link = '/' + link;
    }
    
    return link;
  }

  /**
   * Check if a config link path matches a file path
   * Handles cases like: config has "/notes/work/test-fixtures/guides/test-moved"
   * and we're looking for "guides/test-moved.md"
   */
  private static linkMatchesFile(configLink: string, filePath: string): boolean {
    const filename = filePath.split('/').pop()?.replace(/\.md$/, '');
    if (!filename) return false;
    
    return configLink.endsWith('/' + filename) || configLink === '/' + filename;
  }

  /**
   * Parse VitePress config to extract all sidebar links
   * @param configPath Path to config.mts file
   * @returns Array of link paths found in config
   */
  static extractLinks(configPath: string): string[] {
    const content = fs.readFileSync(configPath, 'utf-8');
    const links: string[] = [];
    
    // Match link: '/notes/...' or link: "/notes/..."
    const linkRegex = /link:\s*['"]([^'"]+)['"]/g;
    let match;
    
    while ((match = linkRegex.exec(content)) !== null) {
      links.push(match[1]);
    }
    
    return links;
  }
}
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/sync-sidebar.ts
```ts
#!/usr/bin/env node
import * as fs from 'fs';
import * as path from 'path';
import { fileURLToPath } from 'url';
import { SidebarGenerator } from './generate-sidebar.js';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

interface KeptItem {
  text: string;
  content: string;  // Full item text including braces
}

class SyncSidebar {
  private verbose: boolean = false;
  private repoRoot: string;
  private configPath: string;

  constructor(verbose: boolean = false) {
    this.verbose = verbose;
    this.repoRoot = this.findRepoRoot();
    this.configPath = this.findConfigPath();
  }

  private findConfigPath(): string {
    // Check if we're in a subproject (projects/ws or projects/di)
    const cwd = process.cwd();
    const projectMatch = cwd.match(/projects\/(ws|di)/);
    if (projectMatch) {
      const projectConfig = path.join(cwd, '.vitepress', 'config.mts');
      if (fs.existsSync(projectConfig)) {
        return projectConfig;
      }
    }
    
    // Check sites/docs/.vitepress (mono layout)
    const sitesDocsConfig = path.join(this.repoRoot, 'sites', 'docs', '.vitepress', 'config.mts');
    if (fs.existsSync(sitesDocsConfig)) {
      return sitesDocsConfig;
    }
    // Fall back to root .vitepress (project layout)
    return path.join(this.repoRoot, '.vitepress', 'config.mts');
  }

  private findRepoRoot(): string {
    let currentDir = path.dirname(__dirname);
    
    while (currentDir !== '/') {
      if (fs.existsSync(path.join(currentDir, '.git'))) {
        return currentDir;
      }
      currentDir = path.dirname(currentDir);
    }
    
    return process.cwd();
  }

  /**
   * Extract items marked with // @keep from the sidebar
   */
  private extractKeptItems(sidebarStr: string): KeptItem[] {
    const kept: KeptItem[] = [];
    
    // Find items followed by // @keep
    // Match: { ... }, // @keep or { ... } // @keep
    const regex = /(\{[^{}]*(?:\{[^{}]*\}[^{}]*)*\})\s*,?\s*\/\/\s*@keep/g;
    let match;
    
    while ((match = regex.exec(sidebarStr)) !== null) {
      const itemContent = match[1];
      // Extract the text property
      const textMatch = itemContent.match(/text:\s*['"]([^'"]+)['"]/);
      if (textMatch) {
        kept.push({
          text: textMatch[1],
          content: itemContent
        });
        if (this.verbose) {
          console.log(`  Found @keep item: ${textMatch[1]}`);
        }
      }
    }
    
    return kept;
  }

  async sync(): Promise<void> {
    console.log(`Syncing sidebar with filesystem...`);

    // Read current config
    if (!fs.existsSync(this.configPath)) {
      console.error(`Error: Cannot find config at ${this.configPath}`);
      process.exit(1);
    }

    const configContent = fs.readFileSync(this.configPath, 'utf-8');
    
    // Extract srcDir and srcExclude from config
    const srcDirMatch = configContent.match(/srcDir:\s*['"](.+?)['"]/);
    const srcExcludeMatch = configContent.match(/srcExclude:\s*\[([^\]]+)\]/);
    
    const vitepressDir = path.dirname(this.configPath); // .vitepress folder
    const siteRoot = path.dirname(vitepressDir); // sites/docs or repo root
    const srcDir = srcDirMatch 
      ? path.resolve(siteRoot, srcDirMatch[1]) 
      : path.join(this.repoRoot, 'notes');
    const srcExclude = srcExcludeMatch 
      ? srcExcludeMatch[1].split(',').map(s => s.trim().replace(/['"]/g, ''))
      : [];

    if (this.verbose) {
      console.log(`  Source directory: ${srcDir}`);
      console.log(`  Excluded: ${srcExclude.join(', ')}`);
    }

    // Find sidebar in config using bracket matching
    const sidebarStart = configContent.indexOf('sidebar:');
    if (sidebarStart === -1) {
      console.error('Error: Could not find sidebar in config');
      process.exit(1);
    }

    // Find the opening bracket
    const openBracket = configContent.indexOf('[', sidebarStart);
    if (openBracket === -1) {
      console.error('Error: Could not find sidebar array start');
      process.exit(1);
    }

    // Find matching closing bracket by counting depth
    let depth = 0;
    let closeBracket = -1;
    for (let i = openBracket; i < configContent.length; i++) {
      if (configContent[i] === '[') {
        depth++;
      } else if (configContent[i] === ']') {
        depth--;
        if (depth === 0) {
          closeBracket = i;
          break;
        }
      }
    }

    if (closeBracket === -1) {
      console.error('Error: Could not find sidebar array end');
      process.exit(1);
    }

    const oldSidebarStr = configContent.substring(openBracket, closeBracket + 1);
    
    // Extract @keep items before regenerating
    const keptItems = this.extractKeptItems(oldSidebarStr);
    
    // Count items for stats
    const oldCount = (oldSidebarStr.match(/text:/g) || []).length;

    // Generate new sidebar
    const generator = new SidebarGenerator(srcDir, srcExclude);
    let newSidebar = generator.generateSidebar();
    
    // Filter out items that duplicate @keep items (by text or link)
    const keptTexts = new Set(keptItems.map(k => k.text.toLowerCase()));
    const keptLinks = new Set<string>();
    for (const kept of keptItems) {
      const linkMatch = kept.content.match(/link:\s*['"]([^'"]+)['"]/);
      if (linkMatch) {
        keptLinks.add(linkMatch[1]);
      }
    }
    
    newSidebar = newSidebar.filter(item => {
      const textDupe = keptTexts.has(item.text.toLowerCase());
      const linkDupe = item.link && keptLinks.has(item.link);
      if (textDupe || linkDupe) {
        if (this.verbose) {
          console.log(`  Skipping duplicate: ${item.text}`);
        }
        return false;
      }
      return true;
    });
    
    const newCount = this.countItems(newSidebar);

    // Build new sidebar string with kept items at the top
    const newSidebarStr = this.formatSidebarWithKept(newSidebar, keptItems, 8);

    // Replace sidebar in config
    const newConfigContent = 
      configContent.substring(0, openBracket) +
      newSidebarStr +
      configContent.substring(closeBracket + 1);

    // Create backup
    const configDir = path.dirname(this.configPath);
    const backupDir = path.join(configDir, 'backups');
    if (!fs.existsSync(backupDir)) {
      fs.mkdirSync(backupDir, { recursive: true });
    }
    const backupPath = path.join(backupDir, 'config.mts.backup');
    fs.copyFileSync(this.configPath, backupPath);

    // Write new config
    fs.writeFileSync(this.configPath, newConfigContent);

    const totalNew = newCount + keptItems.length;
    const diff = totalNew - oldCount;
    console.log(`✅ Complete`);
    console.log(`  Items: ${oldCount} → ${totalNew} (${diff >= 0 ? '+' : ''}${diff})`);
    if (keptItems.length > 0) {
      console.log(`  Preserved: ${keptItems.length} @keep item(s)`);
    }
    if (this.verbose) {
      console.log(`  Backup: ${backupPath}`);
    }
  }

  private countItems(sidebar: any[]): number {
    let count = 0;
    for (const item of sidebar) {
      count++;
      if (item.items) {
        count += this.countItems(item.items);
      }
    }
    return count;
  }

  private formatSidebarWithKept(sidebar: any[], keptItems: KeptItem[], indent: number = 8): string {
    const lines: string[] = ['['];
    
    // Add kept items first
    for (const kept of keptItems) {
      // Indent the kept content
      const indentedContent = kept.content
        .split('\n')
        .map((line, i) => i === 0 ? ' '.repeat(indent) + line.trim() : ' '.repeat(indent) + line.trim())
        .join('\n');
      lines.push(indentedContent + ', // @keep');
    }
    
    // Add generated items
    for (let i = 0; i < sidebar.length; i++) {
      const item = sidebar[i];
      const isLast = i === sidebar.length - 1;
      this.formatItem(item, indent, lines, isLast);
    }
    
    lines.push(' '.repeat(indent - 2) + ']');
    return lines.join('\n');
  }

  private formatItem(item: any, indent: number, lines: string[], isLast: boolean): void {
    const pad = ' '.repeat(indent);
    const hasChildren = item.items && item.items.length > 0;
    const displayText = hasChildren ? `${item.text} >` : item.text;
    
    lines.push(pad + '{');
    lines.push(pad + `  text: '${displayText}',`);
    
    if (item.link) {
      if (item.items || item.collapsed !== undefined) {
        lines.push(pad + `  link: '${item.link}',`);
      } else {
        lines.push(pad + `  link: '${item.link}'`);
      }
    }
    
    if (item.collapsed !== undefined) {
      lines.push(pad + `  collapsed: ${item.collapsed},`);
    }
    
    if (item.items && item.items.length > 0) {
      lines.push(pad + `  items: [`);
      for (let i = 0; i < item.items.length; i++) {
        const subItem = item.items[i];
        const subIsLast = i === item.items.length - 1;
        this.formatItem(subItem, indent + 4, lines, subIsLast);
      }
      lines.push(pad + `  ]`);
    }
    
    lines.push(pad + '}' + (isLast ? '' : ','));
  }
}

// Main execution
const args = process.argv.slice(2);

if (args.includes('--help') || args.includes('-h')) {
  console.log(`
Sync Sidebar Tool

Usage:
  node sync-sidebar.ts         Sync sidebar with filesystem
  node sync-sidebar.ts -v      Verbose mode
  node sync-sidebar.ts --help  Show this help

Description:
  Scans the /notes/designs directory and updates the VitePress sidebar
  to match the actual filesystem structure.

  The tool:
  - Adds links to directories with index.md files
  - Skips index.md files in the item list
  - Respects srcExclude directories from config
  - Preserves items marked with // @keep
  - Creates backup (.vitepress/config.mts.backup)

To keep a sidebar item from being removed, add // @keep after it:

    {
      text: 'Project',
      link: '/project'
    }, // @keep

Exit codes:
  0 - Success
  1 - Error
  `);
  process.exit(0);
}

const verbose = args.includes('-v') || args.includes('--verbose');

const tool = new SyncSidebar(verbose);
tool.sync().catch(error => {
  console.error(`Fatal error: ${error}`);
  process.exit(1);
});
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/merge-files.ts
```ts
#!/usr/bin/env node
import * as fs from 'fs';
import * as path from 'path';
import { fileURLToPath } from 'url';
import { MarkdownParser } from './markdown-parser.js';
import { ConfigUpdater } from './config-updater.js';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

interface Section {
  heading: string;
  level: number;
  content: string;
  startLine: number;
  endLine: number;
}

class MergeFiles {
  private verbose: boolean = false;
  private repoRoot: string;
  private configPath: string;

  constructor(verbose: boolean = false) {
    this.verbose = verbose;
    this.repoRoot = this.findRepoRoot();
    this.configPath = path.join(this.repoRoot, '.vitepress', 'config.mts');
  }

  private findRepoRoot(): string {
    let currentDir = path.dirname(__dirname);
    
    while (currentDir !== '/') {
      if (fs.existsSync(path.join(currentDir, '.git'))) {
        return currentDir;
      }
      currentDir = path.dirname(currentDir);
    }
    
    return process.cwd();
  }

  /**
   * Parse markdown file into sections by heading
   */
  private parseSections(content: string): Section[] {
    const lines = content.split('\n');
    const sections: Section[] = [];
    let currentSection: Section | null = null;
    let currentContent: string[] = [];

    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];
      const headingMatch = line.match(/^(#{1,6})\s+(.+)$/);

      if (headingMatch) {
        // Save previous section if exists
        if (currentSection) {
          currentSection.content = currentContent.join('\n');
          currentSection.endLine = i - 1;
          sections.push(currentSection);
        }

        // Start new section
        currentSection = {
          heading: headingMatch[2].trim(),
          level: headingMatch[1].length,
          content: '',
          startLine: i,
          endLine: i,
        };
        currentContent = [line];
      } else if (currentSection) {
        currentContent.push(line);
      } else {
        // Content before first heading - treat as preamble
        if (sections.length === 0) {
          sections.push({
            heading: '__preamble__',
            level: 0,
            content: line,
            startLine: i,
            endLine: i,
          });
        } else {
          sections[0].content += '\n' + line;
          sections[0].endLine = i;
        }
      }
    }

    // Save last section
    if (currentSection) {
      currentSection.content = currentContent.join('\n');
      currentSection.endLine = lines.length - 1;
      sections.push(currentSection);
    }

    return sections;
  }

  /**
   * Check if two sections have similar content (for deduplication)
   */
  private areSectionsSimilar(section1: Section, section2: Section): boolean {
    // Simple similarity check - headings match
    if (section1.heading.toLowerCase() === section2.heading.toLowerCase()) {
      return true;
    }

    // Content similarity (more than 80% similar)
    const content1 = section1.content.trim().toLowerCase();
    const content2 = section2.content.trim().toLowerCase();
    
    if (content1 === content2) {
      return true;
    }

    return false;
  }

  /**
   * Find best matching heading in target file for a section
   */
  private findBestHeading(section: Section, targetSections: Section[]): Section | null {
    // First try exact heading match
    for (const target of targetSections) {
      if (target.heading.toLowerCase() === section.heading.toLowerCase()) {
        return target;
      }
    }

    // Try similar level headings
    for (const target of targetSections) {
      if (target.level === section.level && target.heading !== '__preamble__') {
        return target;
      }
    }

    return null;
  }

  /**
   * Update TOC in file content
   */
  private updateTOC(content: string, sections: Section[]): string {
    // Look for existing TOC (common patterns)
    const tocPatterns = [
      /## Table of Contents\n([\s\S]*?)(?=\n##|\n#|$)/,
      /## Contents\n([\s\S]*?)(?=\n##|\n#|$)/,
      /## TOC\n([\s\S]*?)(?=\n##|\n#|$)/,
    ];

    let tocMatch: RegExpMatchArray | null = null;
    let tocPattern: RegExp | null = null;

    for (const pattern of tocPatterns) {
      tocMatch = content.match(pattern);
      if (tocMatch) {
        tocPattern = pattern;
        break;
      }
    }

    if (!tocMatch || !tocPattern) {
      if (this.verbose) {
        console.log('  No TOC found to update');
      }
      return content;
    }

    // Generate new TOC
    const tocLines: string[] = [];
    for (const section of sections) {
      if (section.heading === '__preamble__') continue;
      
      const indent = '  '.repeat(section.level - 1);
      const link = section.heading.toLowerCase().replace(/[^\w\s-]/g, '').replace(/\s+/g, '-');
      tocLines.push(`${indent}- [${section.heading}](#${link})`);
    }

    const newTOC = `## Table of Contents\n${tocLines.join('\n')}`;
    return content.replace(tocPattern, newTOC);
  }

  async merge(fileA: string, fileB: string): Promise<void> {
    // Validate files exist
    if (!fs.existsSync(fileA)) {
      console.error(`Error: File A does not exist: ${fileA}`);
      process.exit(1);
    }

    if (!fs.existsSync(fileB)) {
      console.error(`Error: File B does not exist: ${fileB}`);
      process.exit(1);
    }

    // Check if same file
    if (path.resolve(fileA) === path.resolve(fileB)) {
      console.error('Error: Cannot merge a file with itself');
      process.exit(1);
    }

    console.log(`Merging ${path.basename(fileA)} → ${path.basename(fileB)}`);

    // Create backups
    const backupA = fileA + '.original';
    const backupB = fileB + '.original';
    
    fs.copyFileSync(fileA, backupA);
    fs.copyFileSync(fileB, backupB);

    // Read files
    const contentA = fs.readFileSync(fileA, 'utf-8');
    const contentB = fs.readFileSync(fileB, 'utf-8');

    // Handle edge cases
    if (contentA.trim() === '') {
      await this.updateLinksAndConfig(fileA, fileB);
      console.log('✅ Complete');
      return;
    }

    if (contentB.trim() === '') {
      fs.writeFileSync(fileB, contentA);
      await this.updateLinksAndConfig(fileA, fileB);
      console.log('✅ Complete');
      return;
    }

    if (contentA === contentB) {
      await this.updateLinksAndConfig(fileA, fileB);
      console.log('✅ Complete');
      return;
    }

    // Parse sections
    const sectionsA = this.parseSections(contentA);
    const sectionsB = this.parseSections(contentB);

    // Find unique sections in A
    const uniqueSections: Section[] = [];
    for (const sectionA of sectionsA) {
      let isDuplicate = false;
      for (const sectionB of sectionsB) {
        if (this.areSectionsSimilar(sectionA, sectionB)) {
          isDuplicate = true;
          break;
        }
      }
      if (!isDuplicate) {
        uniqueSections.push(sectionA);
      }
    }

    if (uniqueSections.length === 0) {
      await this.updateLinksAndConfig(fileA, fileB);
      console.log('✅ Complete');
      return;
    }

    // Build merged content by appending unique sections at the end
    let newContentB = contentB;

    for (const section of uniqueSections) {
      if (section.heading === '__preamble__') continue;
      newContentB += '\n\n' + section.content;
    }

    // Update TOC if exists
    const updatedSectionsB = this.parseSections(newContentB);
    newContentB = this.updateTOC(newContentB, updatedSectionsB);

    // Write merged content
    fs.writeFileSync(fileB, newContentB);

    // Update links and config
    await this.updateLinksAndConfig(fileA, fileB);

    console.log('✅ Complete');
  }

  private async updateLinksAndConfig(fileA: string, fileB: string): Promise<void> {
    const aPath = path.relative(this.repoRoot, fileA);
    const bPath = path.relative(this.repoRoot, fileB);
    
    const replacements = new Map<string, string>();
    replacements.set(aPath, bPath);

    // Find all markdown files
    const markdownFiles = this.findMarkdownFiles(path.join(this.repoRoot, 'notes'));
    let linkUpdateCount = 0;

    for (const mdFile of markdownFiles) {
      const updated = MarkdownParser.updateLinks(mdFile, replacements);
      if (updated > 0) {
        linkUpdateCount += updated;
      }
    }

    if (linkUpdateCount > 0) {
      console.log(`Updated ${linkUpdateCount} links`);
    }

    // Update VitePress config
    if (fs.existsSync(this.configPath)) {
      try {
        const configReplacements = new Map<string, string | null>();
        configReplacements.set(aPath, null);
        
        const configUpdated = ConfigUpdater.updateConfig(this.configPath, configReplacements);
        if (configUpdated > 0 && this.verbose) {
          console.log(`Removed ${configUpdated} config entries`);
        }
      } catch (error) {
        console.error(`Warning: Error updating VitePress config: ${error}`);
      }
    }
  }

  private findMarkdownFiles(dir: string): string[] {
    const files: string[] = [];
    
    const search = (currentDir: string) => {
      try {
        const entries = fs.readdirSync(currentDir, { withFileTypes: true });
        
        for (const entry of entries) {
          const fullPath = path.join(currentDir, entry.name);
          
          if (entry.isDirectory()) {
            if (!['node_modules', '.git', 'dist', 'build', '.vitepress'].includes(entry.name)) {
              search(fullPath);
            }
          } else if (entry.isFile() && entry.name.endsWith('.md')) {
            files.push(fullPath);
          }
        }
      } catch (error) {
        console.error(`Error reading directory ${currentDir}: ${error}`);
      }
    };
    
    search(dir);
    return files;
  }
}

// Main execution
const args = process.argv.slice(2);

if (args.includes('--help') || args.includes('-h')) {
  console.log(`
Merge Files Tool

Usage:
  node merge-files.ts A.md B.md       Merge A into B
  node merge-files.ts -v A.md B.md    Verbose mode
  node merge-files.ts --help          Show this help

Description:
  Merges unique content from file A into file B, updates all links,
  and removes A from VitePress config.

  The tool:
  - Creates backups (A.original, B.original)
  - Identifies unique sections in A
  - Merges them into B under appropriate headings
  - Updates TOC in B
  - Updates all links from A → B
  - Removes A from VitePress config
  - Preserves A, A.original, B.original for review

Exit codes:
  0 - Success
  1 - Error
  `);
  process.exit(0);
}

const verbose = args.includes('-v') || args.includes('--verbose');
const fileArgs = args.filter(arg => !arg.startsWith('-'));

if (fileArgs.length !== 2) {
  console.error('Error: Expected exactly 2 file arguments');
  console.error('Usage: node merge-files.ts A.md B.md');
  process.exit(1);
}

const tool = new MergeFiles(verbose);
tool.merge(fileArgs[0], fileArgs[1]).catch(error => {
  console.error(`Fatal error: ${error}`);
  process.exit(1);
});
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/fix-links.ts
```ts
#!/usr/bin/env node
import * as fs from 'fs';
import * as path from 'path';
import { fileURLToPath } from 'url';
import { MarkdownParser } from './markdown-parser.js';
import { LinkFinder } from './link-finder.js';
import { ConfigUpdater } from './config-updater.js';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

interface BrokenLink {
  sourcePath: string;
  targetPath: string;
}

class FixLinks {
  private verbose: boolean = false;
  private buildFilePath: string;
  private repoRoot: string;
  private configPath: string;
  private stats = {
    fixed: 0,
    deleted: 0,
    unfixable: 0,
  };

  constructor(verbose: boolean = false, testMode: boolean = false) {
    this.verbose = verbose;
    this.repoRoot = this.findRepoRoot();
    
    if (testMode) {
      // Use test fixtures
      const testDir = path.join(this.repoRoot, 'notes', 'tools', 'docs', 'test', 'fixtures');
      this.buildFilePath = path.join(testDir, 'vitepress.build.txt');
      this.configPath = path.join(testDir, 'config.mts');
    } else {
      this.buildFilePath = this.findBuildFile();
      this.configPath = this.findConfigPath();
    }
  }

  private findBuildFile(): string {
    // Check current working directory first (for project-specific builds like ws/, di/)
    const cwdBuild = path.join(process.cwd(), 'vitepress.build.txt');
    if (fs.existsSync(cwdBuild)) {
      return cwdBuild;
    }
    // Check sites/docs (mono layout)
    const sitesDocsBuild = path.join(this.repoRoot, 'sites', 'docs', 'vitepress.build.txt');
    if (fs.existsSync(sitesDocsBuild)) {
      return sitesDocsBuild;
    }
    // Fall back to repo root
    return path.join(this.repoRoot, 'vitepress.build.txt');
  }

  private findConfigPath(): string {
    // Check sites/docs/.vitepress first (mono layout)
    const sitesDocsConfig = path.join(this.repoRoot, 'sites', 'docs', '.vitepress', 'config.mts');
    if (fs.existsSync(sitesDocsConfig)) {
      return sitesDocsConfig;
    }
    // Fall back to root .vitepress (project layout)
    return path.join(this.repoRoot, '.vitepress', 'config.mts');
  }

  private findRepoRoot(): string {
    let currentDir = path.dirname(__dirname);
    
    while (currentDir !== '/') {
      if (fs.existsSync(path.join(currentDir, '.git'))) {
        return currentDir;
      }
      currentDir = path.dirname(currentDir);
    }
    
    return process.cwd();
  }

  private parseBuildFile(): BrokenLink[] {
    if (!fs.existsSync(this.buildFilePath)) {
      console.warn(`Warning: Build file not found at ${this.buildFilePath}`);
      return [];
    }

    const content = fs.readFileSync(this.buildFilePath, 'utf-8');
    const lines = content.split('\n');
    const brokenLinks: BrokenLink[] = [];

    for (const line of lines) {
      // VitePress format: (!) Found dead link ./../refactor/clicks in file guides/digest.md
      const vitepressMatch = line.match(/Found dead link\s+(.+?)\s+in file\s+(.+)/);
      if (vitepressMatch) {
        const targetPath = vitepressMatch[1].trim();
        const sourceFile = vitepressMatch[2].trim();
        brokenLinks.push({
          sourcePath: sourceFile,
          targetPath: targetPath,
        });
        continue;
      }
      
      // Old format: Dead link: path/to/file.md -> missing-file.md
      const oldMatch = line.match(/Dead link:\s*(.+?)\s*->\s*(.+)/);
      if (oldMatch) {
        brokenLinks.push({
          sourcePath: oldMatch[1].trim(),
          targetPath: oldMatch[2].trim(),
        });
      }
    }

    return brokenLinks;
  }

  async run(): Promise<void> {
    console.log('Fix Broken Links Tool\n');
    console.log(`Build file: ${this.buildFilePath}`);
    console.log(`Config file: ${this.configPath}\n`);

    const brokenLinks = this.parseBuildFile();
    
    if (brokenLinks.length === 0) {
      console.log('No broken links found.');
      return;
    }

    console.log(`Found ${brokenLinks.length} broken link(s)\n`);

    const linksByTarget = new Map<string, BrokenLink[]>();
    for (const link of brokenLinks) {
      if (!linksByTarget.has(link.targetPath)) {
        linksByTarget.set(link.targetPath, []);
      }
      linksByTarget.get(link.targetPath)!.push(link);
    }

    const replacements = new Map<string, string | null>();
    
    // Use cwd/notes for project-specific notes, fall back to repoRoot/notes
    const cwdNotes = path.join(process.cwd(), 'notes');
    const notesDir = fs.existsSync(cwdNotes) ? cwdNotes : path.join(this.repoRoot, 'notes');
    
    for (const [targetPath, links] of linksByTarget.entries()) {
      // Extract just the filename from the target path
      const filename = path.basename(targetPath).replace(/\.md$/, '') + '.md';
      
      if (this.verbose) {
        console.log(`\nProcessing: ${targetPath}`);
        console.log(`  Searching for filename: ${filename}`);
        console.log(`  Referenced in ${links.length} location(s)`);
      }

      const matches = LinkFinder.findFilesByName(notesDir, filename);

      if (matches.length === 0) {
        console.log(`  ❌ Not found - will DELETE ${links.length} link(s) to: ${targetPath}`);
        replacements.set(targetPath, null);
        this.stats.deleted += links.length;
      } else if (matches.length === 1) {
        const newPath = path.relative(this.repoRoot, matches[0].fullPath);
        console.log(`  ✅ Found at: ${newPath}`);
        replacements.set(targetPath, newPath);
        this.stats.fixed += links.length;
      } else {
        console.log(`  ⚠️  Multiple matches found:`);
        matches.forEach((m, i) => {
          console.log(`    ${i + 1}. ${path.relative(this.repoRoot, m.fullPath)}`);
        });
        const choice = LinkFinder.promptUserChoice(matches, targetPath);
        if (choice) {
          const newPath = path.relative(this.repoRoot, choice);
          replacements.set(targetPath, newPath);
          this.stats.fixed += links.length;
        } else {
          console.log(`  ⚠️  Skipped - marked as unfixable`);
          this.stats.unfixable += links.length;
        }
      }
    }

    console.log('\nUpdating markdown files...');
    const markdownFiles = this.findMarkdownFiles(notesDir);
    
    for (const mdFile of markdownFiles) {
      const updated = MarkdownParser.updateLinks(mdFile, replacements, this.repoRoot);
      if (updated > 0 && this.verbose) {
        console.log(`  Updated ${updated} link(s) in ${path.relative(this.repoRoot, mdFile)}`);
      }
    }

    if (fs.existsSync(this.configPath)) {
      console.log('\nUpdating VitePress config...');
      try {
        const configUpdated = ConfigUpdater.updateConfig(this.configPath, replacements);
        if (configUpdated > 0 && this.verbose) {
          console.log(`  Updated ${configUpdated} config entry/entries`);
        }
      } catch (error) {
        console.error(`Error updating VitePress config: ${error}`);
      }
    }

    console.log('\n' + '='.repeat(50));
    console.log('Summary:');
    console.log(`  Fixed: ${this.stats.fixed}`);
    console.log(`  Deleted: ${this.stats.deleted}`);
    console.log(`  Unfixable: ${this.stats.unfixable}`);
    console.log('='.repeat(50));

    if (this.stats.unfixable > 0) {
      process.exit(2);
    } else {
      process.exit(0);
    }
  }

  private findMarkdownFiles(dir: string): string[] {
    const files: string[] = [];
    
    const search = (currentDir: string) => {
      try {
        const entries = fs.readdirSync(currentDir, { withFileTypes: true });
        
        for (const entry of entries) {
          const fullPath = path.join(currentDir, entry.name);
          
          if (entry.isDirectory()) {
            if (!['node_modules', '.git', 'dist', 'build', '.vitepress'].includes(entry.name)) {
              search(fullPath);
            }
          } else if (entry.isFile() && entry.name.endsWith('.md')) {
            files.push(fullPath);
          }
        }
      } catch (error) {
        console.error(`Error reading directory ${currentDir}: ${error}`);
      }
    };
    
    search(dir);
    return files;
  }
}

// Main execution
const args = process.argv.slice(2);

if (args.includes('--help') || args.includes('-h')) {
  console.log(`
Fix Broken Links Tool

Usage:
  node fix-links.ts           Run with default settings
  node fix-links.ts -v        Verbose mode (show each change)
  node fix-links.ts --test    Test mode (use test fixtures)
  node fix-links.ts --help    Show this help

Exit codes:
  0 - Success
  1 - Error
  2 - Warning (some operations skipped)
  `);
  process.exit(0);
}

const verbose = args.includes('-v') || args.includes('--verbose');
const testMode = args.includes('--test');
const tool = new FixLinks(verbose, testMode);
tool.run().catch(error => {
  console.error(`Fatal error: ${error}`);
  process.exit(1);
});
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/link-finder.ts
```ts
import * as fs from 'fs';
import * as path from 'path';

export interface FileMatch {
  filename: string;
  fullPath: string;
  score?: number;
}

export class LinkFinder {
  /**
   * Search the repository for files matching a filename
   * @param baseDir Base directory to search from
   * @param filename Filename to search for (e.g., "debugging.md")
   * @returns Array of matching file paths
   */
  static findFilesByName(baseDir: string, filename: string): FileMatch[] {
    const matches: FileMatch[] = [];
    
    // Normalize the filename
    const normalizedFilename = path.basename(filename);
    
    this.searchDirectory(baseDir, normalizedFilename, matches);
    
    return matches;
  }

  /**
   * Recursively search a directory for matching files
   */
  private static searchDirectory(dir: string, filename: string, matches: FileMatch[]): void {
    try {
      const entries = fs.readdirSync(dir, { withFileTypes: true });

      for (const entry of entries) {
        const fullPath = path.join(dir, entry.name);

        // Skip node_modules, .git, and other common directories
        if (entry.isDirectory()) {
          if (!['node_modules', '.git', 'dist', 'build', '.vitepress'].includes(entry.name)) {
            this.searchDirectory(fullPath, filename, matches);
          }
        } else if (entry.isFile()) {
          if (entry.name === filename) {
            matches.push({
              filename: entry.name,
              fullPath: fullPath,
            });
          }
        }
      }
    } catch (error) {
      // Skip directories we can't read
      console.error(`Error reading directory ${dir}: ${error}`);
    }
  }

  /**
   * Score a match by how many path segments it shares with the broken link
   * @param match The file match to score
   * @param brokenLink The original broken link path
   * @returns Score (higher = more path segments match)
   */
  static scoreMatch(match: FileMatch, brokenLink: string): number {
    // Extract path segments from broken link (e.g., "./architecture/ux/search" -> ["architecture", "ux", "search"])
    const linkSegments = brokenLink
      .replace(/^\.\/?/, '')  // Remove leading ./
      .replace(/\.md$/, '')   // Remove .md extension
      .split('/')
      .filter(s => s.length > 0);
    
    // Extract path segments from match
    const matchSegments = match.fullPath
      .replace(/\.md$/, '')
      .split(path.sep)
      .filter(s => s.length > 0);
    
    // Count matching segments
    let score = 0;
    for (const segment of linkSegments) {
      if (matchSegments.includes(segment)) {
        score++;
      }
    }
    
    return score;
  }

  /**
   * Select best match from multiple candidates using path similarity
   * @param matches Array of file matches
   * @param brokenLink The original broken link
   * @returns Best match if clear winner, null if ambiguous
   */
  static selectBestMatch(matches: FileMatch[], brokenLink: string): FileMatch | null {
    if (matches.length === 0) return null;
    if (matches.length === 1) return matches[0];

    // Score all matches
    for (const match of matches) {
      match.score = this.scoreMatch(match, brokenLink);
    }

    // Sort by score descending
    matches.sort((a, b) => (b.score || 0) - (a.score || 0));

    // If top score is higher than second, we have a winner
    if (matches[0].score! > matches[1].score!) {
      return matches[0];
    }

    // Tied - no clear winner
    return null;
  }

  /**
   * Prompt user to choose from multiple file matches
   * @param matches Array of file matches
   * @param brokenLink The original broken link
   * @returns Selected file path or null if skipped
   */
  static promptUserChoice(matches: FileMatch[], brokenLink: string): string | null {
    if (matches.length === 0) {
      return null;
    }

    if (matches.length === 1) {
      return matches[0].fullPath;
    }

    // Try to auto-select based on path similarity
    const bestMatch = this.selectBestMatch(matches, brokenLink);
    if (bestMatch) {
      console.log(`  ✅ Auto-selected by path similarity (score: ${bestMatch.score})`);
      return bestMatch.fullPath;
    }

    // Scores tied - show options
    console.log(`\nMultiple files found for broken link: ${brokenLink}`);
    matches.forEach((match, index) => {
      console.log(`  ${index + 1}. ${match.fullPath} (score: ${match.score})`);
    });
    console.log(`  s. Skip this link`);

    // For now, return null (skip) when scores are tied
    console.log(`Skipping (multiple matches with same score, user interaction needed)`);
    return null;
  }
}
```

### /Users/sand/GitHub/mono/notes/tools/docs/lib/markdown-parser.ts
```ts
import * as fs from 'fs';
import * as path from 'path';

export interface Link {
  text: string;
  target: string;
  line: number;
  isWikilink: boolean;
  anchor?: string;
}

export class MarkdownParser {
  /**
   * Parse a markdown file and extract all links
   * @param filePath Path to the markdown file
   * @returns Array of links found in the file
   */
  static parseFile(filePath: string): Link[] {
    const content = fs.readFileSync(filePath, 'utf-8');
    return this.parseContent(content);
  }

  /**
   * Parse markdown content and extract all links
   * @param content Markdown content as string
   * @returns Array of links found in the content
   */
  static parseContent(content: string): Link[] {
    const links: Link[] = [];
    const lines = content.split('\n');
    let inCodeBlock = false;

    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];

      // Track code blocks
      if (line.trim().startsWith('```')) {
        inCodeBlock = !inCodeBlock;
        continue;
      }

      // Skip lines inside code blocks
      if (inCodeBlock) {
        continue;
      }

      // Find wikilinks [[file]] or [[file.md]]
      const wikilinkRegex = /\[\[([^\]]+)\]\]/g;
      let match;
      while ((match = wikilinkRegex.exec(line)) !== null) {
        const target = match[1];
        const [file, anchor] = target.split('#');
        links.push({
          text: target,
          target: file.endsWith('.md') ? file : `${file}.md`,
          line: i + 1,
          isWikilink: true,
          anchor: anchor || undefined,
        });
      }

      // Find markdown links [text](path/file.md)
      const markdownLinkRegex = /\[([^\]]+)\]\(([^)]+)\)/g;
      while ((match = markdownLinkRegex.exec(line)) !== null) {
        const text = match[1];
        const target = match[2];

        // Skip image links and external links
        if (target.startsWith('http://') || target.startsWith('https://') || target.match(/\.(png|jpg|jpeg|gif|svg|webp)$/i)) {
          continue;
        }

        const [file, anchor] = target.split('#');
        links.push({
          text,
          target: file,
          line: i + 1,
          isWikilink: false,
          anchor: anchor || undefined,
        });
      }
    }

    return links;
  }

  /**
   * Update links in a markdown file
   * @param filePath Path to the markdown file (absolute or relative to cwd)
   * @param replacements Map of old target -> new target (paths relative to repo root)
   * @param repoRoot Optional repo root path for computing relative links
   * @returns Number of links updated
   */
  static updateLinks(filePath: string, replacements: Map<string, string | null>, repoRoot?: string): number {
    let content = fs.readFileSync(filePath, 'utf-8');
    const lines = content.split('\n');
    let inCodeBlock = false;
    let updatedCount = 0;

    // Determine the directory of the source file for computing relative paths
    const sourceDir = path.dirname(filePath);

    for (let i = 0; i < lines.length; i++) {
      let line = lines[i];

      // Track code blocks
      if (line.trim().startsWith('```')) {
        inCodeBlock = !inCodeBlock;
        continue;
      }

      // Skip lines inside code blocks
      if (inCodeBlock) {
        continue;
      }

      let shouldDeleteLine = false;

      // Update wikilinks
      const wikilinkRegex = /\[\[([^\]]+)\]\]/g;
      line = line.replace(wikilinkRegex, (match, target) => {
        const [file, anchor] = target.split('#');
        const normalizedFile = file.endsWith('.md') ? file : `${file}.md`;
        
        for (const [oldPath, newPath] of replacements.entries()) {
          if (this.pathsMatch(normalizedFile, oldPath)) {
            updatedCount++;
            if (newPath === null) {
              // Mark line for deletion
              shouldDeleteLine = true;
              return '';
            }
            // Compute relative path from source file to new target
            const relativePath = this.computeRelativePath(sourceDir, newPath, repoRoot);
            // Update the link, preserving anchor
            const newTarget = anchor ? `${relativePath}#${anchor}` : relativePath;
            return `[[${newTarget.replace('.md', '')}]]`;
          }
        }
        return match;
      });

      // Update markdown links
      const markdownLinkRegex = /\[([^\]]+)\]\(([^)]+)\)/g;
      line = line.replace(markdownLinkRegex, (match, text, target) => {
        // Skip image links and external links
        if (target.startsWith('http://') || target.startsWith('https://') || target.match(/\.(png|jpg|jpeg|gif|svg|webp)$/i)) {
          return match;
        }

        const [file, anchor] = target.split('#');
        
        for (const [oldPath, newPath] of replacements.entries()) {
          if (this.pathsMatch(file, oldPath)) {
            updatedCount++;
            if (newPath === null) {
              // Mark line for deletion
              shouldDeleteLine = true;
              return '';
            }
            // Compute relative path from source file to new target
            const relativePath = this.computeRelativePath(sourceDir, newPath, repoRoot);
            // Update the link, preserving anchor
            const newTarget = anchor ? `${relativePath}#${anchor}` : relativePath;
            return `[${text}](${newTarget})`;
          }
        }
        return match;
      });

      // If line had a deleted link, check if we should remove the entire line
      if (shouldDeleteLine) {
        // Remove the line entirely if it's become meaningless after deletion
        const trimmed = line.trim();
        // Match patterns like:
        // - Empty: ''
        // - Just bullet: '-' or '*'
        // - Bullet with whitespace: '- ' or '* '
        // - Bullet with dash and short trailing text: '-  - This file was deleted'
        if (!trimmed || 
            trimmed === '-' || 
            trimmed === '*' ||
            trimmed.match(/^[-*]\s*$/) || 
            trimmed.match(/^[-*]\s+-\s+/)) {
          lines[i] = '';
          continue;
        }
      }

      lines[i] = line;
    }

    if (updatedCount > 0) {
      fs.writeFileSync(filePath, lines.join('\n'), 'utf-8');
    }

    return updatedCount;
  }

  /**
   * Compute relative path from source directory to target file
   * @param sourceDir Directory containing the source markdown file
   * @param targetPath Path to target file (relative to repo root)
   * @param repoRoot Optional repo root for absolute path computation
   * @returns Relative path with ./ prefix
   */
  private static computeRelativePath(sourceDir: string, targetPath: string, repoRoot?: string): string {
    // If targetPath is already relative (starts with ./ or ../), use as-is
    if (targetPath.startsWith('./') || targetPath.startsWith('../')) {
      return targetPath;
    }

    // Make targetPath absolute if we have repoRoot
    let absoluteTarget: string;
    if (repoRoot) {
      absoluteTarget = path.join(repoRoot, targetPath);
    } else if (path.isAbsolute(targetPath)) {
      absoluteTarget = targetPath;
    } else {
      // Assume targetPath is relative to current working directory
      absoluteTarget = path.resolve(targetPath);
    }

    // Compute relative path from sourceDir to target
    let relativePath = path.relative(sourceDir, absoluteTarget);
    
    // Ensure it starts with ./ for same-directory or child paths
    if (!relativePath.startsWith('.')) {
      relativePath = './' + relativePath;
    }

    return relativePath;
  }

  /**
   * Check if two file paths refer to the same file
   * Handles relative paths, with/without .md extension, and path normalization
   */
  private static pathsMatch(linkPath: string, targetPath: string): boolean {
    // Normalize both paths
    const normalizePath = (p: string) => {
      // Remove .md extension if present
      p = p.replace(/\.md$/, '');
      // Remove leading ./ 
      p = p.replace(/^\.?\//, '');
      // Handle directory links: dir/ -> dir/index
      if (p.endsWith('/')) {
        p = p + 'index';
      }
      // Normalize ../ sequences
      const parts = p.split('/');
      const normalized: string[] = [];
      for (const part of parts) {
        if (part === '..') {
          normalized.pop();
        } else if (part !== '.' && part !== '') {
          normalized.push(part);
        }
      }
      return normalized.join('/');
    };
    
    const normalizedLink = normalizePath(linkPath);
    const normalizedTarget = normalizePath(targetPath);
    
    // Check if they match after normalization
    if (normalizedLink === normalizedTarget) {
      return true;
    }
    
    // Also check if just the filenames match (for simple cases)
    const linkBasename = path.basename(normalizedLink);
    const targetBasename = path.basename(normalizedTarget);
    
    return linkBasename === targetBasename;
  }
}
```

### /Users/sand/GitHub/mono/notes/tools/docs/tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "lib": ["ES2020"],
    "moduleResolution": "node",
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "skipLibCheck": true,
    "resolveJsonModule": true,
    "outDir": "./dist"
  },
  "include": ["lib/**/*.ts"],
  "exclude": ["node_modules", "dist"]
}
```

### /Users/sand/GitHub/mono/notes/tools/docs/reset-docs.sh
```sh
#!/bin/bash

# Reset Docs
# Quick rebuild and dev server for VitePress docs
#
# Usage: reset-docs.sh [project-root]

PROJECT_ROOT="${1:-$(pwd)}"
cd "$PROJECT_ROOT" || exit 1

# Source project-specific config if it exists
CONFIG_FILE="notes/tools/config.sh"
[ -f "$CONFIG_FILE" ] && source "$CONFIG_FILE"

# Defaults
LOG_FILE="${DOCS_LOG_FILE:-notes/tools/reset-docs-log.txt}"

yarn docs:build && yarn docs:dev > "$LOG_FILE" 2>&1
```

### /Users/sand/GitHub/mono/notes/tools/docs/src/lib/ts/files/Docs.ts
```ts
// Documentation structure for DB_Docs
// AUTO-GENERATED - DO NOT EDIT MANUALLY
// Run: bash shared/tools/create-docs-db-data.sh to regenerate

export interface DocNode {
	id: string;
	name: string;
	type: 'folder' | 'file';
	path: string;
	link?: string;
	children?: DocNode[];
}

export function getDocsStructure(): DocNode[] {
	return [
	];
}
```

### /Users/sand/GitHub/mono/notes/tools/index.md
```md
# Tools

Scripts and utilities for development workflow.

## Contents

- [Hub](./hub/)
- [Scripts](./scripts/)

```

### /Users/sand/GitHub/mono/notes/tools/scripts/validate-paths.sh.bak
```bak
#!/bin/bash
#
# validate-paths.sh
# Scan files for path references and check they exist
#
# Output: logs/paths.log
# Display: Single updating line with count

MONO_ROOT="$(cd "$(dirname "$0")/.." && pwd)"
LOG_FILE="$MONO_ROOT/logs/paths.log"
START_TIME=$(date +%s.%N)

mkdir -p "$MONO_ROOT/logs"
echo "=== Path Validator ===" > "$LOG_FILE"
echo "Root: $MONO_ROOT" >> "$LOG_FILE"
echo "Run: $(date)" >> "$LOG_FILE"
echo "" >> "$LOG_FILE"

cd "$MONO_ROOT"

COUNTER=0
CACHED_PASSED=0
CACHED_FAILED=0

update_display() {
  local current_file="$1"
  COUNTER=$((COUNTER + 1))
  printf "\r\033[KChecked: %d  Passed: %d  Broken: %d  Path: %s" "$((CACHED_PASSED + CACHED_FAILED))" "$CACHED_PASSED" "$CACHED_FAILED" "$current_file"
}

# Returns 0 if path OK or skipped, 1 if broken
check_path() {
  local file="$1"
  local line_num="$2"
  local path="$3"

  # Skip URLs and anchors
  [[ "$path" =~ ^https?:// ]] && return 0
  [[ "$path" =~ ^mailto: ]] && return 0
  [[ "$path" == \#* ]] && return 0
  
  # Skip variables and templates
  [[ "$path" == \$* ]] && return 0
  [[ "$path" == \{* ]] && return 0
  [[ "$path" == *\\* ]] && return 0
  
  # Skip package refs
  [[ "$path" == node_modules* ]] && return 0
  [[ "$path" == @* ]] && return 0
  [[ "$path" == svelte* ]] && return 0
  [[ "$path" == vite* ]] && return 0
  
  # Skip empty, trailing slash, method calls
  [[ -z "$path" ]] && return 0
  [[ "$path" == */ ]] && return 0
  [[ "$path" =~ ^\.[a-zA-Z]+\(\)$ ]] && return 0
  
  # Skip bare words (no / or . extension)
  [[ ! "$path" =~ [/] ]] && [[ ! "$path" =~ \.[a-z]{1,4}$ ]] && return 0
  
  # Skip bare extensions (just ".ext" mentioned in prose)
  [[ "$path" =~ ^\.[a-zA-Z0-9]+$ ]] && return 0
  
  # Skip paths with shell variables
  [[ "$path" == *'${'* ]] && return 0
  
  # Skip placeholder filenames
  [[ "$path" == *'.N.'* ]] && return 0
  
  # Strip anchors
  path="${path%%#*}"
  
  # Skip /mnt paths
  [[ "$path" == /mnt* ]] && return 0
  
  # Skip placeholder/template paths
  [[ "$path" == *'/X/'* ]] && return 0
  [[ "$path" == *'<'*'>'* ]] && return 0
  
  # Skip tilde paths outside mono
  if [[ "$path" == '~/'* ]]; then
    # Only check ~/GitHub/mono paths
    [[ "$path" != '~/GitHub/mono'* ]] && [[ "$path" != '~/GitHub/mono' ]] && return 0
  fi

  local file_dir="$(dirname "$file")"
  local resolved=""
  
  # Resolve path
  if [[ "$path" == '~/'* ]]; then
    resolved="${HOME}${path:1}"
  elif [[ "$path" == /* ]]; then
    resolved="$path"
  else
    resolved="$file_dir/$path"
  fi

  # Normalize without realpath (faster)
  resolved=$(cd "$MONO_ROOT" && cd "$(dirname "$resolved")" 2>/dev/null && echo "$(pwd)/$(basename "$resolved")" || echo "$resolved")
  
  # Only validate paths within mono
  [[ "$resolved" != "$MONO_ROOT"* ]] && return 0

  if [[ ! -e "$resolved" ]]; then
    CACHED_FAILED=$((CACHED_FAILED + 1))
    echo "BROKEN: $file:$line_num" >> "$LOG_FILE"
    echo "  Path: $path" >> "$LOG_FILE"
    echo "  Resolved: $resolved" >> "$LOG_FILE"
    echo "" >> "$LOG_FILE"
    update_display "$file"
    return 1
  else
    CACHED_PASSED=$((CACHED_PASSED + 1))
    update_display "$file"
    return 0
  fi
}

scan_file() {
  local file="$1"
  local failed=0

  local line_num=0
  while IFS= read -r line; do
    [[ $failed -eq 1 ]] && break
    line_num=$((line_num + 1))
    
    # Markdown links
    for p in $(echo "$line" | grep -oE '\]\([^)]+\)' | sed 's/^](//' | sed 's/)$//'); do
      check_path "$file" "$line_num" "$p" || { failed=1; break; }
    done
    [[ $failed -eq 1 ]] && break

    # Backtick paths
    for p in $(echo "$line" | grep -oE '\`[.~/][^\`]+\`' | sed 's/\`//g'); do
      check_path "$file" "$line_num" "$p" || { failed=1; break; }
    done
    [[ $failed -eq 1 ]] && break

    # ~/GitHub paths
    for p in $(echo "$line" | grep -oE '~/GitHub/[^ "'\''`)<>]+'); do
      check_path "$file" "$line_num" "$p" || { failed=1; break; }
    done
    [[ $failed -eq 1 ]] && break

    # Quoted paths with slashes
    for p in $(echo "$line" | grep -oE '"[^"]*\/[^"]*"' | sed 's/"//g'); do
      check_path "$file" "$line_num" "$p" || { failed=1; break; }
    done

  done < "$file"
}

# Process files
for f in $(find . \( -name "*.md" -o -name "*.sh" -o -name "*.py" \) \
  -not -name "index.md" \
  -not -name "package.json" \
  -not -path "*/node_modules/*" \
  -not -path "*/.git/*" \
  -not -path "*/.svelte-kit/*" \
  -not -path "*/dist/*" \
  -not -path "*/done/*" \
  -not -path "*/logs/*" \
  -not -path "*/.obsidian/*" \
  -not -path "*/.vitepress/cache/*" \
  -not -path "*/archives/*" \
  -maxdepth 6 | sort); do
  scan_file "$f"
done

END_TIME=$(date +%s.%N)
ELAPSED=$(echo "$END_TIME - $START_TIME" | bc)
MINS=$(echo "$ELAPSED / 60" | bc)
SECS=$(echo "$ELAPSED % 60" | bc | xargs printf "%.0f")

echo ""
echo "Log: $LOG_FILE"
printf "Time: %02d:%02d\n" "$MINS" "$SECS"

if [[ $CACHED_FAILED -gt 0 ]]; then
  echo "RESULT: $CACHED_FAILED broken path(s)"
  exit 1
else
  echo "RESULT: All $CACHED_PASSED paths valid"
  exit 0
fi
```

### /Users/sand/GitHub/mono/notes/tools/scripts/delete-netlify-deploys.sh
```sh
#!/bin/sh

# Delete Netlify Deploys
# Cleans up old Netlify deployments
#
# Usage: delete-netlify-deploys.sh [site-id]
#
# Environment variables:
#   NETLIFY_ACCESS_TOKEN - Required. Your Netlify personal access token.
#   NETLIFY_SITE_ID      - Site ID (can also be passed as $1)

# Source project-specific config if it exists
CONFIG_FILE="notes/tools/config.sh"
[ -f "$CONFIG_FILE" ] && . "$CONFIG_FILE"

# === CONFIGURATION ===
SITE_ID="${1:-${NETLIFY_SITE_ID:-}}"
DAYS_OLD="${NETLIFY_DAYS_OLD:-15}"
DRY_RUN="${NETLIFY_DRY_RUN:-false}"
KEEP_ACTIVE="${NETLIFY_KEEP_ACTIVE:-true}"
SHOW_DISQUALIFIED="${NETLIFY_SHOW_DISQUALIFIED:-false}"
DISQUALIFY_COMMIT_PATTERN="${NETLIFY_DISQUALIFY_PATTERN:-^[0-9][0-9][0-9]}"

# === VALIDATE ===
if [ -z "$SITE_ID" ]; then
  echo "❌ No site ID provided."
  echo "Usage: delete-netlify-deploys.sh [site-id]"
  echo "Or set NETLIFY_SITE_ID in config.sh or environment"
  exit 1
fi

# === GET NETLIFY ACCESS TOKEN ===
ACCESS_TOKEN="${NETLIFY_ACCESS_TOKEN:-}"
if [ -z "$ACCESS_TOKEN" ]; then
  echo "❌ NETLIFY_ACCESS_TOKEN environment variable not set."
  echo "Get a token from: https://app.netlify.com/user/applications#personal-access-tokens"
  exit 1
fi

# === DATE CUTOFF ===
CUTOFF_ISO=$(date -u -d "$DAYS_OLD days ago" +"%Y-%m-%dT%H:%M:%SZ" 2>/dev/null || date -u -v-"$DAYS_OLD"d +"%Y-%m-%dT%H:%M:%SZ")
CUTOFF_EPOCH=$(date -u -d "$CUTOFF_ISO" +"%s" 2>/dev/null || date -j -f "%Y-%m-%dT%H:%M:%SZ" "$CUTOFF_ISO" +"%s")

echo "Site ID: $SITE_ID"
echo "Dry run: $DRY_RUN"
echo "Cutoff date: $CUTOFF_ISO (epoch $CUTOFF_EPOCH)"
echo "Show disqualified: $SHOW_DISQUALIFIED"
echo "------------------------------------------------------"

PAGE=1
PER_PAGE=30
REVIEWED_COUNT=0

OLDEST_EPOCH=9999999999
OLDEST_DEPLOY_ID=""
OLDEST_DATE=""
OLDEST_TITLE=""

while :; do
  echo "➡️  Fetching page $PAGE..."

  RESPONSE=$(curl -s -H "Authorization: Bearer $ACCESS_TOKEN" \
    "https://api.netlify.com/api/v1/sites/$SITE_ID/deploys?page=$PAGE&per_page=$PER_PAGE")

  DEPLOY_COUNT=$(echo "$RESPONSE" | jq length)

  if [ "$DEPLOY_COUNT" -eq 0 ]; then
    echo "✅ No more deploys found."
    break
  fi

  echo "📄 Found $DEPLOY_COUNT deploy(s) on page $PAGE"

  for deploy_b64 in $(echo "$RESPONSE" | jq -c -r '.[] | @base64'); do
    deploy=$(echo "$deploy_b64" | base64 --decode)

    DEPLOY_ID=$(echo "$deploy" | jq -r '.id')
    CREATED_AT_RAW=$(echo "$deploy" | jq -r '.created_at')
    TITLE=$(echo "$deploy" | jq -r '.title')
    STATE=$(echo "$deploy" | jq -r '.state')

    CREATED_AT=$(echo "$CREATED_AT_RAW" | sed -E 's/\.[0-9]+Z$/Z/')
    CREATED_EPOCH=$(date -u -d "$CREATED_AT" +"%s" 2>/dev/null || date -j -f "%Y-%m-%dT%H:%M:%SZ" "$CREATED_AT" +"%s" 2>/dev/null || echo 0)

    if [ "$CREATED_EPOCH" -eq 0 ]; then
      [ "$SHOW_DISQUALIFIED" = true ] && echo "⚠️  Skipping deploy with unparseable date: $DEPLOY_ID"
      continue
    fi

    AGE_DAYS=$(( ( $(date +%s) - CREATED_EPOCH ) / 86400 ))
    REVIEWED_COUNT=$((REVIEWED_COUNT + 1))

    # Track oldest
    if [ "$CREATED_EPOCH" -lt "$OLDEST_EPOCH" ]; then
      OLDEST_EPOCH=$CREATED_EPOCH
      OLDEST_DEPLOY_ID=$DEPLOY_ID
      OLDEST_DATE=$CREATED_AT_RAW
      OLDEST_TITLE=$TITLE
    fi

    IS_OLD=false
    [ "$CREATED_EPOCH" -lt "$CUTOFF_EPOCH" ] && IS_OLD=true

    IS_ACTIVE=false
    [ "$STATE" = "current" ] && [ "$KEEP_ACTIVE" = true ] && IS_ACTIVE=true

    MATCHES_COMMIT_REGEX=false
    echo "$TITLE" | grep -qE "$DISQUALIFY_COMMIT_PATTERN" && MATCHES_COMMIT_REGEX=true

    if [ "$IS_OLD" = true ] && [ "$IS_ACTIVE" = false ] && [ "$MATCHES_COMMIT_REGEX" = false ]; then
      echo "📦  $DEPLOY_ID | $CREATED_AT_RAW | $STATE | \"$TITLE\" (Age: $AGE_DAYS days)"

      if [ "$DRY_RUN" = true ]; then
        echo "🔒 Would delete $DEPLOY_ID"
      else
        echo "🔥 Deleting $DEPLOY_ID..."
        curl -s -X DELETE -H "Authorization: Bearer $ACCESS_TOKEN" \
          "https://api.netlify.com/api/v1/sites/$SITE_ID/deploys/$DEPLOY_ID"
      fi
      echo "-----------------------------"
    elif [ "$SHOW_DISQUALIFIED" = true ]; then
      echo "⛔ Skipped: $DEPLOY_ID | $CREATED_AT_RAW | $STATE | \"$TITLE\" (Age: $AGE_DAYS days)"
      [ "$IS_ACTIVE" = true ] && echo "    Reason: currently active"
      [ "$IS_OLD" = false ] && echo "    Reason: too recent"
      [ "$MATCHES_COMMIT_REGEX" = true ] && echo "    Reason: commit msg starts with 3 digits"
      echo "-----------------------------"
    fi
  done

  PAGE=$((PAGE + 1))
done

echo "✅ Finished. Total deploys reviewed: $REVIEWED_COUNT"

if [ "$REVIEWED_COUNT" -eq 0 ]; then
  echo "ℹ️  No deploys were examined."
elif [ "$OLDEST_DEPLOY_ID" != "" ]; then
  OLDEST_DATE_CLEAN=$(echo "$OLDEST_DATE" | sed -E 's/\.[0-9]+Z$/Z/')
  OLDEST_HUMAN_DATE=$(date -d "$OLDEST_DATE_CLEAN" "+%B %e, %Y at %l:%M %p" 2>/dev/null || date -j -f "%Y-%m-%dT%H:%M:%SZ" "$OLDEST_DATE_CLEAN" "+%B %e, %Y at %l:%M %p")
  echo "📅 Oldest deploy examined: $OLDEST_HUMAN_DATE | \"$OLDEST_TITLE\" | $OLDEST_DEPLOY_ID"
fi
```

### /Users/sand/GitHub/mono/notes/tools/scripts/update-docs.sh
```sh
#!/bin/bash

# Usage help
if [ "$1" = "?" ] || [ "$1" = "-h" ] || [ "$1" = "--help" ]; then
  echo "Usage: update-docs.sh [option]"
  echo ""
  echo "Updates VitePress documentation for all projects."
  echo "Builds docs, fixes broken links, syncs sidebars."
  echo ""
  echo "Options:"
  echo "  (none)    Update all projects (mono, ws, di)"
  echo "  ws        Update ws project only"
  echo "  di        Update di project only"
  echo "  ?         Show this help message"
  exit 0
fi

if [ "$1" = "ws" ]; then
  bash ~/GitHub/mono/notes/tools/docs/update-project-docs.sh ~/GitHub/mono/ws
  exit $?
fi

if [ "$1" = "di" ]; then
  bash ~/GitHub/mono/notes/tools/docs/update-project-docs.sh ~/GitHub/mono/di
  exit $?
fi

bash ~/GitHub/mono/notes/tools/docs/update-project-docs.sh all
```

### /Users/sand/GitHub/mono/notes/tools/scripts/snapshot.md
```md
# Project Snapshot
Generated: Sat Jan 31 21:40:40 PST 2026

## Structure
```
/Users/sand/GitHub/mono/vitepress.build.txt
/Users/sand/GitHub/mono/di/vitepress.build.txt
/Users/sand/GitHub/mono/di/di.code-workspace
/Users/sand/GitHub/mono/di/svelte.config.js
/Users/sand/GitHub/mono/di/index.html
/Users/sand/GitHub/mono/di/.obsidian/workspace.json
/Users/sand/GitHub/mono/di/.obsidian/app.json
/Users/sand/GitHub/mono/di/.obsidian/core-plugins.json
/Users/sand/GitHub/mono/di/.obsidian/appearance.json
/Users/sand/GitHub/mono/di/README.md
/Users/sand/GitHub/mono/di/yarn.lock
/Users/sand/GitHub/mono/di/notes/designs/Details.md
/Users/sand/GitHub/mono/di/notes/designs/Main.md
/Users/sand/GitHub/mono/di/notes/designs/index.md
/Users/sand/GitHub/mono/di/notes/designs/Controls.md
/Users/sand/GitHub/mono/di/notes/designs/Preferences.md
/Users/sand/GitHub/mono/di/notes/designs/Graph.md
/Users/sand/GitHub/mono/di/notes/architecture/managers.md
/Users/sand/GitHub/mono/di/notes/architecture/project.md
/Users/sand/GitHub/mono/di/notes/architecture/index.md
/Users/sand/GitHub/mono/di/notes/architecture/files.md
/Users/sand/GitHub/mono/di/notes/architecture/rendering.types.md
/Users/sand/GitHub/mono/di/notes/index.md
/Users/sand/GitHub/mono/di/notes/guides/develop/gotchas.md
/Users/sand/GitHub/mono/di/notes/guides/develop/best.practices.md
/Users/sand/GitHub/mono/di/notes/guides/develop/index.md
/Users/sand/GitHub/mono/di/notes/guides/road.map.md
/Users/sand/GitHub/mono/di/notes/guides/index.md
/Users/sand/GitHub/mono/di/notes/work/simplicity.md
/Users/sand/GitHub/mono/di/notes/work/pacing.md
/Users/sand/GitHub/mono/di/notes/work/revisit.md
/Users/sand/GitHub/mono/di/notes/work/index.md
/Users/sand/GitHub/mono/di/notes/work/milestones/1.solid.foundation.md
/Users/sand/GitHub/mono/di/notes/work/milestones/4.hits.manager.md
/Users/sand/GitHub/mono/di/notes/work/milestones/3.docs.md
/Users/sand/GitHub/mono/di/notes/work/milestones/index.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/implement.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/architecture.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/components.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/index.md
/Users/sand/GitHub/mono/di/notes/work/milestones/2.panel/milestone 2.md
/Users/sand/GitHub/mono/di/notes/work/milestones/5.smart.objects.md
/Users/sand/GitHub/mono/di/.gitignore
/Users/sand/GitHub/mono/di/package.json
/Users/sand/GitHub/mono/di/tsconfig.json
/Users/sand/GitHub/mono/di/vite.config.ts
/Users/sand/GitHub/mono/di/vitest.config.ts
/Users/sand/GitHub/mono/di/CLAUDE.MD
/Users/sand/GitHub/mono/di/src/main.ts
/Users/sand/GitHub/mono/di/src/App.svelte
/Users/sand/GitHub/mono/di/src/vite-env.d.ts
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Details.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Controls.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Main.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/main/Graph.svelte
/Users/sand/GitHub/mono/di/src/lib/svelte/draw/Printable.svelte
/Users/sand/GitHub/mono/di/src/lib/ts/types/Coordinates.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Types.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Enumerations.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Angle.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/index.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Attribute.ts
/Users/sand/GitHub/mono/di/src/lib/ts/types/Interfaces.ts
/Users/sand/GitHub/mono/di/src/lib/ts/signals/Mouse_Timer.ts
/Users/sand/GitHub/mono/di/src/lib/ts/signals/Events.ts
/Users/sand/GitHub/mono/di/src/lib/ts/managers/Hits.ts
/Users/sand/GitHub/mono/di/src/lib/ts/managers/Components.ts
/Users/sand/GitHub/mono/di/src/lib/ts/managers/Preferences.ts
/Users/sand/GitHub/mono/di/src/lib/ts/runtime/Smart_Object.ts
/Users/sand/GitHub/mono/di/src/lib/ts/runtime/Identifiable.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Testworthy_Utilities.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/setup.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Coordinates.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Extensions.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Angle.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/tests/Colors.test.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Input.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Camera.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Animation.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Scene.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Render.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/index.ts
/Users/sand/GitHub/mono/di/src/lib/ts/render/Trivial.ts
/Users/sand/GitHub/mono/di/src/lib/ts/state/S_Hit_Target.ts
/Users/sand/GitHub/mono/di/src/lib/ts/state/S_Component.ts
/Users/sand/GitHub/mono/di/src/lib/ts/state/S_Mouse.ts
/Users/sand/GitHub/mono/di/src/lib/ts/common/Testworthy_Utilities.ts
/Users/sand/GitHub/mono/di/src/lib/ts/common/Extensions.ts
/Users/sand/GitHub/mono/di/src/lib/ts/common/Constants.ts
/Users/sand/GitHub/mono/di/src/lib/ts/draw/Colors.ts
/Users/sand/GitHub/mono/di/src/lib/ts/draw/SVG_Paths.ts
/Users/sand/GitHub/mono/.DS_Store
/Users/sand/GitHub/mono/.obsidian/workspace.json
/Users/sand/GitHub/mono/.obsidian/app.json
/Users/sand/GitHub/mono/.obsidian/core-plugins.json
/Users/sand/GitHub/mono/.obsidian/appearance.json
/Users/sand/GitHub/mono/.claude/settings.local.json
/Users/sand/GitHub/mono/README.md
/Users/sand/GitHub/mono/yarn.lock
/Users/sand/GitHub/mono/logs/api.log
/Users/sand/GitHub/mono/logs/core-docs.log
/Users/sand/GitHub/mono/logs/ws.log
/Users/sand/GitHub/mono/logs/rebuild-status.txt
/Users/sand/GitHub/mono/logs/mono-docs.log
/Users/sand/GitHub/mono/logs/ws-docs.log
/Users/sand/GitHub/mono/logs/docs.log
/Users/sand/GitHub/mono/logs/dispatcher-restart.log
/Users/sand/GitHub/mono/logs/di.log
/Users/sand/GitHub/mono/logs/api-restart.log
/Users/sand/GitHub/mono/logs/di-docs.log
/Users/sand/GitHub/mono/logs/dispatch.log
/Users/sand/GitHub/mono/logs/paths.log
/Users/sand/GitHub/mono/logs/hub.log
/Users/sand/GitHub/mono/logs/restart-status.txt
/Users/sand/GitHub/mono/logs/health.log
/Users/sand/GitHub/mono/notes/tools/.DS_Store
/Users/sand/GitHub/mono/notes/tools/docs/sync-index-files.sh
/Users/sand/GitHub/mono/notes/tools/docs/prebuild.sh
/Users/sand/GitHub/mono/notes/tools/docs/update-project-docs.sh
/Users/sand/GitHub/mono/notes/tools/docs/yarn.lock
/Users/sand/GitHub/mono/notes/tools/docs/package.json
/Users/sand/GitHub/mono/notes/tools/docs/create-docs-db-data.sh
/Users/sand/GitHub/mono/notes/tools/docs/lib/generate-sidebar.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/config-updater.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/sync-sidebar.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/merge-files.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/fix-links.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/link-finder.ts
/Users/sand/GitHub/mono/notes/tools/docs/lib/markdown-parser.ts
/Users/sand/GitHub/mono/notes/tools/docs/tsconfig.json
/Users/sand/GitHub/mono/notes/tools/docs/reset-docs.sh
/Users/sand/GitHub/mono/notes/tools/docs/src/lib/ts/files/Docs.ts
/Users/sand/GitHub/mono/notes/tools/index.md
/Users/sand/GitHub/mono/notes/tools/scripts/validate-paths.sh.bak
/Users/sand/GitHub/mono/notes/tools/scripts/delete-netlify-deploys.sh
/Users/sand/GitHub/mono/notes/tools/scripts/update-docs.sh
/Users/sand/GitHub/mono/notes/tools/scripts/snapshot.md
/Users/sand/GitHub/mono/notes/tools/scripts/snapshot.sh
/Users/sand/GitHub/mono/notes/tools/scripts/validate-paths.ts
/Users/sand/GitHub/mono/notes/tools/scripts/file-structure-check.sh
/Users/sand/GitHub/mono/notes/tools/scripts/analyze-counts.sh
/Users/sand/GitHub/mono/notes/tools/scripts/index.md
/Users/sand/GitHub/mono/notes/tools/hub/dispatcher.py
/Users/sand/GitHub/mono/notes/tools/hub/index.html
/Users/sand/GitHub/mono/notes/tools/hub/ports.json
/Users/sand/GitHub/mono/notes/tools/hub/start-hub.sh
/Users/sand/GitHub/mono/notes/tools/hub/index.md
/Users/sand/GitHub/mono/notes/tools/hub/servers.sh
/Users/sand/GitHub/mono/notes/.DS_Store
/Users/sand/GitHub/mono/notes/index.md
/Users/sand/GitHub/mono/notes/guides/tools/single-line.md
/Users/sand/GitHub/mono/notes/guides/tools/index.md
/Users/sand/GitHub/mono/notes/guides/tools/hub-app.md
/Users/sand/GitHub/mono/notes/guides/.DS_Store
/Users/sand/GitHub/mono/notes/guides/develop/markdown.md
/Users/sand/GitHub/mono/notes/guides/develop/css.md
/Users/sand/GitHub/mono/notes/guides/develop/migration.md
/Users/sand/GitHub/mono/notes/guides/develop/index.md
/Users/sand/GitHub/mono/notes/guides/develop/style.md
/Users/sand/GitHub/mono/notes/guides/develop/build.md
/Users/sand/GitHub/mono/notes/guides/develop/aesthetics.md
/Users/sand/GitHub/mono/notes/guides/develop/refactoring.md
/Users/sand/GitHub/mono/notes/guides/test/testing.md
/Users/sand/GitHub/mono/notes/guides/test/index.md
/Users/sand/GitHub/mono/notes/guides/test/debugging.md
/Users/sand/GitHub/mono/notes/guides/setup/netlify.md
/Users/sand/GitHub/mono/notes/guides/setup/vitepress.md
/Users/sand/GitHub/mono/notes/guides/setup/index.md
/Users/sand/GitHub/mono/notes/guides/setup/access.md
/Users/sand/GitHub/mono/notes/guides/setup/onboarding.md
/Users/sand/GitHub/mono/notes/guides/collaborate/voice.md
/Users/sand/GitHub/mono/notes/guides/collaborate/chat.md
/Users/sand/GitHub/mono/notes/guides/collaborate/workflow.md
/Users/sand/GitHub/mono/notes/guides/collaborate/journals.md
/Users/sand/GitHub/mono/notes/guides/collaborate/index.md
/Users/sand/GitHub/mono/notes/guides/index.md
/Users/sand/GitHub/mono/notes/guides/philosophy/limitations.md
/Users/sand/GitHub/mono/notes/guides/philosophy/index.md
/Users/sand/GitHub/mono/notes/guides/philosophy/motive.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/workarounds.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/kinds.of.tasks.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/always.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/index.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/shorthand.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/gates.md
/Users/sand/GitHub/mono/notes/guides/pre-flight/keywords.md
/Users/sand/GitHub/mono/notes/work/next/curiosity.md
/Users/sand/GitHub/mono/notes/work/next/pacing.md
/Users/sand/GitHub/mono/notes/work/next/commoditize.md
/Users/sand/GitHub/mono/notes/work/next/index.md
/Users/sand/GitHub/mono/notes/work/next/personas.md
/Users/sand/GitHub/mono/notes/work/articles/how.to.build.it.md
/Users/sand/GitHub/mono/notes/work/articles/write.article.md
/Users/sand/GitHub/mono/notes/work/articles/accidental.programmer.md
/Users/sand/GitHub/mono/notes/work/articles/index.md
/Users/sand/GitHub/mono/notes/work/revisit.md
/Users/sand/GitHub/mono/notes/work/journals/journal.md
/Users/sand/GitHub/mono/notes/work/journals/index.md
/Users/sand/GitHub/mono/notes/work/journals/guidance-journal.md
/Users/sand/GitHub/mono/notes/work/index.md
```

## Files

### /Users/sand/GitHub/mono/vitepress.build.txt
```txt
```

### /Users/sand/GitHub/mono/di/vitepress.build.txt
```txt
```

### /Users/sand/GitHub/mono/di/di.code-workspace
```code-workspace
{
	"folders": [
		{
			"path": "."
		}
	],
	"settings": {}
}```

### /Users/sand/GitHub/mono/di/svelte.config.js
```js
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte';

export default {
  preprocess: vitePreprocess()
};
```

### /Users/sand/GitHub/mono/di/index.html
```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Design Intuition - Quaternions</title>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
```

### /Users/sand/GitHub/mono/di/.obsidian/workspace.json
```json
{
  "main": {
    "id": "b06ab8869be44054",
    "type": "split",
    "children": [
      {
        "id": "70bee0db2aed513e",
        "type": "tabs",
        "children": [
          {
            "id": "e32a6ad9ee169683",
            "type": "leaf",
            "state": {
              "type": "markdown",
              "state": {
                "file": "notes/work/layout-algorithm.md",
                "mode": "source",
                "source": false
              },
              "icon": "lucide-file",
              "title": "layout-algorithm"
            }
          }
        ]
      }
    ],
    "direction": "vertical"
  },
  "left": {
    "id": "39b4c06c2dd1c39e",
    "type": "split",
    "children": [
      {
        "id": "3e7cb66539fb7bd6",
        "type": "tabs",
        "children": [
          {
            "id": "a796f3592b7de946",
            "type": "leaf",
            "state": {
              "type": "file-explorer",
              "state": {
                "sortOrder": "alphabetical",
                "autoReveal": false
              },
              "icon": "lucide-folder-closed",
              "title": "Files"
            }
          },
          {
            "id": "3e7696fe2b4f990d",
            "type": "leaf",
            "state": {
              "type": "search",
              "state": {
                "query": "",
                "matchingCase": false,
                "explainSearch": false,
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical"
              },
              "icon": "lucide-search",
              "title": "Search"
            }
          },
          {
            "id": "a1684dafdfec962d",
            "type": "leaf",
            "state": {
              "type": "bookmarks",
              "state": {},
              "icon": "lucide-bookmark",
              "title": "Bookmarks"
            }
          }
        ]
      }
    ],
    "direction": "horizontal",
    "width": 300
  },
  "right": {
    "id": "a912b0103fb9e225",
    "type": "split",
    "children": [
      {
        "id": "0a9521770bee001a",
        "type": "tabs",
        "children": [
          {
            "id": "6afe67911c68a3d0",
            "type": "leaf",
            "state": {
              "type": "backlink",
              "state": {
                "file": "notes/work/svelte.md",
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical",
                "showSearch": false,
                "searchQuery": "",
                "backlinkCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-coming-in",
              "title": "Backlinks for svelte"
            }
          },
          {
            "id": "186fa782ea84aa69",
            "type": "leaf",
            "state": {
              "type": "outgoing-link",
              "state": {
                "file": "notes/work/svelte.md",
                "linksCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-going-out",
              "title": "Outgoing links from svelte"
            }
          },
          {
            "id": "32f4a3b722e529d2",
            "type": "leaf",
            "state": {
              "type": "tag",
              "state": {
                "sortOrder": "frequency",
                "useHierarchy": true,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-tags",
              "title": "Tags"
            }
          },
          {
            "id": "33a4f069835e1ca7",
            "type": "leaf",
            "state": {
              "type": "all-properties",
              "state": {
                "sortOrder": "frequency",
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-archive",
              "title": "All properties"
            }
          },
          {
            "id": "2b0b551f291ce7dc",
            "type": "leaf",
            "state": {
              "type": "outline",
              "state": {
                "file": "notes/work/svelte.md",
                "followCursor": false,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-list",
              "title": "Outline of svelte"
            }
          }
        ]
      }
    ],
    "direction": "horizontal",
    "width": 300,
    "collapsed": true
  },
  "left-ribbon": {
    "hiddenItems": {
      "switcher:Open quick switcher": false,
      "graph:Open graph view": false,
      "canvas:Create new canvas": false,
      "daily-notes:Open today's daily note": false,
      "templates:Insert template": false,
      "command-palette:Open command palette": false,
      "bases:Create new base": false
    }
  },
  "active": "e32a6ad9ee169683",
  "lastOpenFiles": [
    "notes/architecture/rendering.types.md",
    "notes/work/combined-docs.md",
    "notes/work/layout-algorithm.md",
    "notes/work/milestones/2.panel/implement.md",
    "notes/guides/aesthetics.md",
    "notes/work/aesthetics.md",
    "notes/designs/aesthetics.md",
    "notes/designs/Fillets.md",
    "src/lib/svelte/layout/Fillets.svelte",
    "notes/guides/develop/style.md",
    "src/lib/ts/draw/SVG_Paths.ts",
    "notes/work/utilities",
    "src/lib/ts/common/Testworthy_Utilities.ts",
    "src/lib/ts/draw/Colors.ts",
    "src/lib/ts/draw",
    "src/lib/ts/managers/draw",
    "Screenshot 2026-01-07 at 1.26.15 AM.png",
    "Screenshot 2026-01-07 at 1.20.05 AM.png",
    "Screenshot 2026-01-07 at 1.18.21 AM.png",
    "notes/designs/Box.md",
    "notes/designs/Preferences.md",
    "src/lib/svelte/layout/Box.svelte",
    "notes/designs/index.md",
    "src/lib/svelte/layout/Separator.svelte",
    "src/lib/svelte/layout/Gull_Wings.svelte",
    "notes/designs/Gull_Wings.md",
    "notes/designs/Separator.md",
    "notes/designs/Details.md",
    "notes/designs/Graph.md",
    "notes/designs/Controls.md",
    "notes/designs/Main.md",
    "notes/guides/index.md",
    "notes/guides/road.map.md",
    "README.md",
    "notes/work/articles/accidental.programmer.md",
    "notes/guides/collaborate/voice.md",
    "notes/guides/collaborate/workflow.md",
    "notes/guides/collaborate/chat.md",
    "notes/guides/collaborate/access.md"
  ]
}```

### /Users/sand/GitHub/mono/di/.obsidian/app.json
```json
{
  "alwaysUpdateLinks": true
}```

### /Users/sand/GitHub/mono/di/.obsidian/core-plugins.json
```json
{
  "file-explorer": true,
  "global-search": true,
  "switcher": true,
  "graph": true,
  "backlink": true,
  "canvas": true,
  "outgoing-link": true,
```

### /Users/sand/GitHub/mono/notes/tools/scripts/snapshot.sh
```sh
#!/bin/bash
PROJECT_DIR="${1:-.}"
OUTPUT="snapshot.md"
EXCLUDE="-name node_modules -o -name .git -o -name dist -o -name build -o -name .svelte-kit -o -name archives -o -name .vitepress -o -name done"

echo "# Project Snapshot" > "$OUTPUT"
echo "Generated: $(date)" >> "$OUTPUT"
echo -e "\n## Structure\n\`\`\`" >> "$OUTPUT"

find "$PROJECT_DIR" \( $EXCLUDE \) -prune -o -type f -print | head -200 >> "$OUTPUT"

echo -e "\`\`\`\n\n## Files" >> "$OUTPUT"

find "$PROJECT_DIR" \( $EXCLUDE \) -prune -o -type f -print | while read -r file; do
    echo -e "\n### $file\n\`\`\`${file##*.}" >> "$OUTPUT"
    head -500 "$file" >> "$OUTPUT"
    echo '```' >> "$OUTPUT"
done

echo "Done: $(wc -c < "$OUTPUT") bytes"```

### /Users/sand/GitHub/mono/notes/tools/scripts/validate-paths.ts
```ts
import { readdirSync, statSync, readFileSync, existsSync, writeFileSync, mkdirSync } from 'fs';
import { join, dirname, resolve, relative } from 'path';
import { homedir } from 'os';
import { fileURLToPath } from 'url';

const __dirname = dirname(fileURLToPath(import.meta.url));
const MONO_ROOT = resolve(__dirname, '..');
const LOG_FILE = join(MONO_ROOT, 'logs', 'paths.log');
const HOME = homedir();

// Counters
let checked = 0;
let passed = 0;
let broken = 0;
const brokenPaths: string[] = [];

// Exclusions for file discovery
const EXCLUDE_DIRS = [
  'node_modules', '.git', '.svelte-kit', 'dist', 'done', 
  'logs', '.obsidian', '.vitepress', 'archives'
];

const EXCLUDE_FILES = ['index.md', 'package.json'];

// Path skip patterns
function shouldSkipPath(path: string): boolean {
  if (!path || path.length === 0) return true;
  
  // Trim and reject if different (had leading/trailing space)
  const trimmed = path.trim();
  if (trimmed !== path) return true;
  
  // Multiple spaces = prose/sentence
  if (/  /.test(path)) return true;
  if ((path.match(/ /g) || []).length > 3) return true;
  
  // URLs and anchors
  if (/^https?:\/\//.test(path)) return true;
  if (/^mailto:/.test(path)) return true;
  if (path.startsWith('#')) return true;
  
  // Variables and templates
  if (path.startsWith('$')) return true;
  if (path.startsWith('{')) return true;
  if (path.includes('\\')) return true;
  if (path.includes('${')) return true;
  if (path.includes('<') && path.includes('>')) return true;
  if (path.includes('/X/')) return true;
  if (path.includes('.N.')) return true;
  if (/\$[0-9]/.test(path)) return true;
  
  // Package refs
  if (path.startsWith('node_modules')) return true;
  if (path.startsWith('@')) return true;
  if (path.startsWith('svelte')) return true;
  if (path.startsWith('vite')) return true;
  
  // Trailing slash, method calls
  if (path.endsWith('/')) return true;
  if (/^\.[a-zA-Z]+\(\)$/.test(path)) return true;
  
  // Bare words (no / and no file extension)
  if (!path.includes('/') && !/\.[a-z]{1,4}$/.test(path)) return true;
  
  // Bare extensions
  if (/^\.[a-zA-Z0-9]+$/.test(path)) return true;
  
  // Compound extensions like .svelte.ts
  if (/^\.[a-zA-Z]+\.[a-zA-Z]+$/.test(path)) return true;
  
  // /mnt paths
  if (path.startsWith('/mnt')) return true;
  
  // Glob patterns
  if (path.includes('*')) return true;
  
  // Command-like (contains && or ||)
  if (path.includes('&&') || path.includes('||')) return true;
  
  // Status messages with emoji
  if (/[\u{1F300}-\u{1F9FF}]/u.test(path)) return true;
  
  // Code snippets (starts with } or contains //)
  if (path.startsWith('}')) return true;
  if (path.includes('//')) return true;
  
  // Pipe-delimited data
  if (path.includes('|')) return true;
  
  // Command arguments
  if (path.includes(' --')) return true;
  
  // Status messages (Step X/Y, result X/Y)
  if (/\d+\/\d+/.test(path)) return true;
  
  // Starts with common verbs (prose)
  if (/^(Read|List|When|Step|Mouse|Touch|API) /.test(path)) return true;
  
  // Config/build directories (often referenced but don't exist)
  if (path.startsWith('.vitepress')) return true;
  if (path.startsWith('.github')) return true;
  
  // Directory references without extension (prose)
  if (!path.includes('.') && path.includes('/')) {
    // Allow if starts with ./ or ../ (explicit relative)
    if (!path.startsWith('./') && !path.startsWith('../')) return true;
  }
  
  // Tilde paths outside mono
  if (path.startsWith('~/')) {
    if (!path.startsWith('~/GitHub/mono')) return true;
  }
  
  return false;
}

// Extract paths from a line
function extractPaths(line: string): string[] {
  const paths: string[] = [];
  
  // Markdown links: ](path)
  const mdLinks = line.matchAll(/\]\(([^)]+)\)/g);
  for (const m of mdLinks) paths.push(m[1]);
  
  // Backtick paths: `./path` or `~/path`
  const backticks = line.matchAll(/`([.~/][^`]+)`/g);
  for (const m of backticks) paths.push(m[1]);
  
  // ~/GitHub paths
  const tildeGithub = line.matchAll(/~\/GitHub\/[^ "'`)<>]+/g);
  for (const m of tildeGithub) paths.push(m[0]);
  
  // Quoted paths with slashes
  const quoted = line.matchAll(/"([^"]*\/[^"]*)"/g);
  for (const m of quoted) paths.push(m[1]);
  
  return paths;
}

// Resolve a path relative to a file
function resolvePath(path: string, fileDir: string): string {
  // Strip anchors
  path = path.split('#')[0];
  if (!path) return '';
  
  if (path.startsWith('~/')) {
    return HOME + path.slice(1);
  } else if (path.startsWith('/')) {
    return path;
  } else {
    return resolve(fileDir, path);
  }
}

// Update single-line display
function updateDisplay(currentFile: string): void {
  const rel = relative(MONO_ROOT, currentFile) || currentFile;
  process.stdout.write(`\r\x1b[KChecked: ${checked}  Passed: ${passed}  Broken: ${broken}  Path: ${rel}`);
}

// Check a single path
function checkPath(file: string, lineNum: number, rawPath: string): boolean {
  if (shouldSkipPath(rawPath)) return true;
  
  const fileDir = dirname(file);
  const resolved = resolvePath(rawPath, fileDir);
  
  if (!resolved) return true;
  
  // Only validate paths within mono
  if (!resolved.startsWith(MONO_ROOT)) return true;
  
  checked++;
  
  if (existsSync(resolved)) {
    passed++;
    updateDisplay(file);
    return true;
  } else {
    broken++;
    brokenPaths.push(`BROKEN: ${relative(MONO_ROOT, file)}:${lineNum}\n  Path: ${rawPath}\n  Resolved: ${resolved}\n`);
    updateDisplay(file);
    return false;
  }
}

// Scan a single file
function scanFile(file: string): void {
  const content = readFileSync(file, 'utf-8');
  const lines = content.split('\n');
  
  let inCodeBlock = false;
  
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    
    // Track code blocks
    if (line.trim().startsWith('```')) {
      inCodeBlock = !inCodeBlock;
      continue;
    }
    
    // Skip lines inside code blocks
    if (inCodeBlock) continue;
    
    // Skip table rows (lines starting with |)
    if (line.trim().startsWith('|')) continue;
    
    const paths = extractPaths(line);
    for (const p of paths) {
      const ok = checkPath(file, i + 1, p);
      if (!ok) return; // Stop on first broken per file
    }
  }
}

// Find all files to scan
function findFiles(dir: string, depth = 0): string[] {
  if (depth > 6) return [];
  
  const files: string[] = [];
  
  let entries: string[];
  try {
    entries = readdirSync(dir);
  } catch {
    return [];
  }
  
  for (const entry of entries) {
    if (EXCLUDE_DIRS.includes(entry)) continue;
    if (entry.startsWith('.')) continue;
    
    const fullPath = join(dir, entry);
    let stat;
    try {
      stat = statSync(fullPath);
    } catch {
      continue;
    }
    
    if (stat.isDirectory()) {
      files.push(...findFiles(fullPath, depth + 1));
    } else if (stat.isFile()) {
      if (EXCLUDE_FILES.includes(entry)) continue;
      if (/\.(md|py)$/.test(entry)) {
        files.push(fullPath);
      }
    }
  }
  
  return files.sort();
}

// Main
function main(): void {
  const startTime = Date.now();
  
  // Setup log
  mkdirSync(dirname(LOG_FILE), { recursive: true });
  
  const files = findFiles(MONO_ROOT);
  
  for (const file of files) {
    scanFile(file);
  }
  
  const elapsed = (Date.now() - startTime) / 1000;
  const mins = Math.floor(elapsed / 60);
  const secs = Math.round(elapsed % 60);
  
  // Write log
  const logContent = [
    '=== Path Validator ===',
    `Root: ${MONO_ROOT}`,
    `Run: ${new Date().toLocaleString()}`,
    '',
    ...brokenPaths
  ].join('\n');
  writeFileSync(LOG_FILE, logContent);
  
  // Final output
  console.log('');
  console.log(`Log: ${LOG_FILE}`);
  console.log(`Time: ${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`);
  
  if (broken > 0) {
    console.log(`RESULT: ${broken} broken path(s)`);
    process.exit(1);
  } else {
    console.log(`RESULT: All ${passed} paths valid`);
    process.exit(0);
  }
}

main();
```

### /Users/sand/GitHub/mono/notes/tools/scripts/file-structure-check.sh
```sh
#!/bin/bash
#
# after.sh
# Run after each migration operation to verify nothing broke
#

cd ~/GitHub/mono

FULL=0
if [[ "$1" == "--full" ]]; then
  FULL=1
fi

LOG_FILE="$HOME/GitHub/mono/logs/health.log"
mkdir -p "$(dirname "$LOG_FILE")"
> "$LOG_FILE"

FAILED_STEPS=()
START_TIME=$(date +%s)

run_step() {
  local name="$1"
  local cmd="$2"
  local step_start=$(date +%s)
  local lines=0
  
  echo "=== $name ===" >> "$LOG_FILE"
  
  # Run command, count lines, update display
  eval "$cmd" 2>&1 | while IFS= read -r line; do
    echo "$line" >> "$LOG_FILE"
    lines=$((lines + 1))
    local preview="${line:0:20}"
    printf "\r\033[KRunning: %s > line %d: %s" "$name" "$lines" "$preview"
  done
  
  local result=${PIPESTATUS[0]}
  
  local step_end=$(date +%s)
  local step_elapsed=$((step_end - step_start))
  
  if [[ $result -eq 0 ]]; then
    echo "(${step_elapsed}s)" >> "$LOG_FILE"
    echo "" >> "$LOG_FILE"
    return 0
  else
    echo "FAILED (${step_elapsed}s)" >> "$LOG_FILE"
    echo "" >> "$LOG_FILE"
    return 1
  fi
}

run_step "Path Validator" "npx tsx notes/tools/validate-paths.ts" || FAILED_STEPS+=("Path Validator")
run_step "Workspace Integrity" "yarn workspaces info" || FAILED_STEPS+=("Workspace Integrity")
run_step "Build (ws)" "cd ~/GitHub/mono/ws && yarn build" || FAILED_STEPS+=("Build (ws)")
run_step "Build (di)" "cd ~/GitHub/mono/di && yarn build" || FAILED_STEPS+=("Build (di)")

if [[ $FULL -eq 1 ]]; then
  run_step "Docs Build" "cd ~/GitHub/mono && yarn docs:build" || FAILED_STEPS+=("Docs Build")
  run_step "Tests (ws)" "cd ~/GitHub/mono/ws && yarn test:run" || FAILED_STEPS+=("Tests (ws)")
  run_step "Tests (di)" "cd ~/GitHub/mono/di && yarn test:run" || FAILED_STEPS+=("Tests (di)")
fi

echo ""

END_TIME=$(date +%s)
ELAPSED=$((END_TIME - START_TIME))
MINS=$((ELAPSED / 60))
SECS=$((ELAPSED % 60))

echo "Log: $LOG_FILE"
printf "Time: %02d:%02d\n" "$MINS" "$SECS"

if [[ ${#FAILED_STEPS[@]} -gt 0 ]]; then
  echo "RESULT: ${#FAILED_STEPS[@]} failed — ${FAILED_STEPS[*]}"
  exit 1
else
  echo "RESULT: All checks passed"
  exit 0
fi
```

### /Users/sand/GitHub/mono/notes/tools/scripts/analyze-counts.sh
```sh
#!/bin/bash

# Analyze Counts
# Counts lines/words/chars for code files in a project
#
# Usage: analyze-counts.sh [project-root]

PROJECT_ROOT="${1:-$(pwd)}"
cd "$PROJECT_ROOT" || exit 1

echo ""
echo "=== ANALYZE COUNTS: $(basename "$PROJECT_ROOT") ==="
echo ""

# Total number of find operations
TOTAL_FINDS=36
CURRENT=0

printf "Collecting data: 0 of $TOTAL_FINDS"

# Collect all metrics for each file type
TS_FILES=$(find . -name "*.ts" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
TS_LINES=$(find . -name "*.ts" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
TS_WORDS=$(find . -name "*.ts" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
TS_CHARS=$(find . -name "*.ts" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

SVELTE_FILES=$(find . -name "*.svelte" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
SVELTE_LINES=$(find . -name "*.svelte" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
SVELTE_WORDS=$(find . -name "*.svelte" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
SVELTE_CHARS=$(find . -name "*.svelte" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

JS_FILES=$(find . -name "*.js" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
JS_LINES=$(find . -name "*.js" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
JS_WORDS=$(find . -name "*.js" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
JS_CHARS=$(find . -name "*.js" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

HTML_FILES=$(find . -name "*.html" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
HTML_LINES=$(find . -name "*.html" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
HTML_WORDS=$(find . -name "*.html" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
HTML_CHARS=$(find . -name "*.html" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

CSS_FILES=$(find . \( -name "*.css" -o -name "*.scss" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
CSS_LINES=$(find . \( -name "*.css" -o -name "*.scss" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
CSS_WORDS=$(find . \( -name "*.css" -o -name "*.scss" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
CSS_CHARS=$(find . \( -name "*.css" -o -name "*.scss" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

JSON_FILES=$(find . -name "*.json" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
JSON_LINES=$(find . -name "*.json" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -not -name "package-lock.json" -not -name "yarn.lock" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
JSON_WORDS=$(find . -name "*.json" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -not -name "package-lock.json" -not -name "yarn.lock" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
JSON_CHARS=$(find . -name "*.json" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -not -name "package-lock.json" -not -name "yarn.lock" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

SH_FILES=$(find . -name "*.sh" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
SH_LINES=$(find . -name "*.sh" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
SH_WORDS=$(find . -name "*.sh" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
SH_CHARS=$(find . -name "*.sh" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

MD_FILES=$(find . -name "*.md" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
MD_LINES=$(find . -name "*.md" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
MD_WORDS=$(find . -name "*.md" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
MD_CHARS=$(find . -name "*.md" -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

CONFIG_FILES=$(find . \( -name "*.config.*" -o -name "*.toml" -o -name "*.yml" -o -name "*.yaml" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | wc -l); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
CONFIG_LINES=$(find . \( -name "*.config.*" -o -name "*.toml" -o -name "*.yml" -o -name "*.yaml" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec grep -c '\S' {} + 2>/dev/null | awk -F: '{sum+=$2} END {print sum}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
CONFIG_WORDS=$(find . \( -name "*.config.*" -o -name "*.toml" -o -name "*.yml" -o -name "*.yaml" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec wc -w {} + | tail -1 | awk '{print $1}'); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"
CONFIG_CHARS=$(find . \( -name "*.config.*" -o -name "*.toml" -o -name "*.yml" -o -name "*.yaml" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" -exec cat {} + | tr -d '[:space:]' | wc -c); CURRENT=$((CURRENT + 1)); printf "\rCollecting data: $CURRENT of $TOTAL_FINDS"

# Calculate totals
TOTAL_FILES=$((TS_FILES + SVELTE_FILES + JS_FILES + HTML_FILES + CSS_FILES + JSON_FILES + SH_FILES + MD_FILES + CONFIG_FILES))
TOTAL_LINES=$((TS_LINES + SVELTE_LINES + JS_LINES + HTML_LINES + CSS_LINES + JSON_LINES + SH_LINES + MD_LINES + CONFIG_LINES))
TOTAL_WORDS=$((TS_WORDS + SVELTE_WORDS + JS_WORDS + HTML_WORDS + CSS_WORDS + JSON_WORDS + SH_WORDS + MD_WORDS + CONFIG_WORDS))
TOTAL_CHARS=$((TS_CHARS + SVELTE_CHARS + JS_CHARS + HTML_CHARS + CSS_CHARS + JSON_CHARS + SH_CHARS + MD_CHARS + CONFIG_CHARS))

# Calculate code-only totals
CODE_FILES=$((TS_FILES + SVELTE_FILES + JS_FILES))
CODE_LINES=$((TS_LINES + SVELTE_LINES + JS_LINES))
CODE_WORDS=$((TS_WORDS + SVELTE_WORDS + JS_WORDS))
CODE_CHARS=$((TS_CHARS + SVELTE_CHARS + JS_CHARS))

# Clear the progress line
printf "\r\033[K"

echo "   chars    words    lines    files  types"
echo " -------  -------  -------  -------  --------------"

printf "%8d %8d %8d %8d  TypeScript\n" $TS_CHARS $TS_WORDS $TS_LINES $TS_FILES
printf "%8d %8d %8d %8d  Svelte\n" $SVELTE_CHARS $SVELTE_WORDS $SVELTE_LINES $SVELTE_FILES
printf "%8d %8d %8d %8d  JavaScript\n" $JS_CHARS $JS_WORDS $JS_LINES $JS_FILES
printf "%8d %8d %8d %8d  HTML\n" $HTML_CHARS $HTML_WORDS $HTML_LINES $HTML_FILES
printf "%8d %8d %8d %8d  CSS/SCSS\n" $CSS_CHARS $CSS_WORDS $CSS_LINES $CSS_FILES
printf "%8d %8d %8d %8d  JSON\n" $JSON_CHARS $JSON_WORDS $JSON_LINES $JSON_FILES
printf "%8d %8d %8d %8d  Shell\n" $SH_CHARS $SH_WORDS $SH_LINES $SH_FILES
printf "%8d %8d %8d %8d  Markdown\n" $MD_CHARS $MD_WORDS $MD_LINES $MD_FILES
printf "%8d %8d %8d %8d  Config\n" $CONFIG_CHARS $CONFIG_WORDS $CONFIG_LINES $CONFIG_FILES

echo " -------  -------  -------  -------  --------------"
printf "%8d %8d %8d %8d  TOTAL\n" $TOTAL_CHARS $TOTAL_WORDS $TOTAL_LINES $TOTAL_FILES
printf "%8d %8d %8d %8d  CODE FILES ONLY (TS+Svelte+JS)\n" $CODE_CHARS $CODE_WORDS $CODE_LINES $CODE_FILES
echo ""

echo "   chars    words    lines           file (in ./src/lib)"
echo " -------  -------  -------           -------------------"
find . \( -name "*.ts" -o -name "*.svelte" -o -name "*.js" \) -not -path "./notes/*"  -not -path "./node_modules/*" -not -path "./.git/*" -not -path "./dist/*" -not -path "./.svelte-kit/*" -not -path "./.netlify/*" -not -path "./.obsidian/*" | while read -r file; do
  chars=$(tr -d '[:space:]' < "$file" | wc -c)
  words=$(wc -w < "$file")
  lines=$(grep -c '\S' "$file" 2>/dev/null || echo 0)
  chars=$(echo "$chars" | tr -d '[:space:]')
  words=$(echo "$words" | tr -d '[:space:]')
  lines=$(echo "$lines" | tr -d '[:space:]')
  if [[ "$chars" =~ ^[0-9]+$ ]] && [[ "$words" =~ ^[0-9]+$ ]] && [[ "$lines" =~ ^[0-9]+$ ]]; then
    printf "%8d %8d %8d %8s  %s\n" "$chars" "$words" "$lines" "" "$file"
  fi
done | sed 's|\./src/lib/||' | sort -nr | head -10
echo ""
```

### /Users/sand/GitHub/mono/notes/tools/scripts/index.md
```md
# Scripts

Standalone utility scripts.


```

### /Users/sand/GitHub/mono/notes/tools/hub/dispatcher.py
```py
#!/usr/bin/env python3
"""
Dispatcher server for hub
Listens on port 5171, executes shell commands on behalf of the browser
"""

from http.server import HTTPServer, BaseHTTPRequestHandler
import subprocess
import sys
import json
import os
import threading
import time
import urllib.request
import urllib.error

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
DEV_SERVERS = os.path.join(SCRIPT_DIR, 'servers.sh')
GITHUB_DIR = os.path.expanduser('~/GitHub/mono')
UPDATE_DOCS = os.path.join(GITHUB_DIR, 'notes/tools/docs/update-project-docs.sh')

# Project paths for rebuild-docs
PROJECT_PATHS = {
    'mono': GITHUB_DIR,
    'ws': os.path.join(GITHUB_DIR, 'ws'),
    'di': os.path.join(GITHUB_DIR, 'di'),
}

# Status file for rebuild progress (single file, Option C)
REBUILD_STATUS_FILE = os.path.join(GITHUB_DIR, 'logs', 'rebuild-status.txt')

# Restart status file
RESTART_STATUS_FILE = os.path.join(GITHUB_DIR, 'logs', 'restart-status.txt')

# Track if rebuild is running
rebuild_running = False
restart_running = False

# Netlify site IDs (from Netlify dashboard)
NETLIFY_SITES = {
    'ws': 'webseriously',
    'ws-docs': 'webseriously-documentation',
    'di': 'designintuition',
    'di-docs': 'designintuition-documentation',
    'mono-docs': 'monorepo-documentation',
}

NETLIFY_TOKEN = os.environ.get('NETLIFY_ACCESS_TOKEN', '')

# Sites to restart: name, port, dir, command, env
RESTART_SITES = [
    ('ws', 5172, 'ws', 'yarn dev', None),
    ('ws-docs', 5174, 'ws', 'yarn docs:dev', {'VITE_PORT': '5174'}),
    ('di', 5173, 'di', 'yarn dev', None),
    ('di-docs', 5175, 'di', 'yarn docs:dev', {'VITE_PORT': '5175'}),
    ('mono-docs', 5176, '.', 'yarn docs:dev', {'VITE_PORT': '5176'}),
]

def kill_port(port):
    """Kill process on a port"""
    import signal
    result = subprocess.run(['lsof', '-ti', f':{port}'], capture_output=True, text=True)
    if result.stdout.strip():
        for pid in result.stdout.strip().split('\n'):
            try:
                os.kill(int(pid), signal.SIGKILL)
            except:
                pass

def verify_port_listening(port, timeout=5):
    """Wait for a process to listen on port"""
    start = time.time()
    while time.time() - start < timeout:
        result = subprocess.run(['lsof', '-ti', f':{port}'], capture_output=True, text=True)
        if result.stdout.strip():
            return True
        time.sleep(0.5)
    return False

def verify_url_responds(port, timeout=10):
    """Wait for localhost:port to return HTTP 200"""
    import urllib.request
    start = time.time()
    while time.time() - start < timeout:
        try:
            response = urllib.request.urlopen(f'http://localhost:{port}', timeout=2)
            if response.status == 200:
                return True
        except:
            pass
        time.sleep(0.5)
    return False

def restart_sites_async():
    """Run restarts by calling servers.sh"""
    global restart_running
    try:
        servers_script = os.path.join(SCRIPT_DIR, 'servers.sh')
        # Ensure script is executable
        if not os.access(servers_script, os.X_OK):
            os.chmod(servers_script, 0o755)
        subprocess.run([servers_script], capture_output=True)
    finally:
        restart_running = False

def rebuild_docs_async(project_arg):
    """Run rebuild in background thread"""
    global rebuild_running
    try:
        subprocess.run(
            [UPDATE_DOCS, project_arg],
            capture_output=True,
            text=True,
            timeout=600  # 10 min timeout for all projects
        )
    except Exception as e:
        # Write error to status file
        os.makedirs(os.path.dirname(REBUILD_STATUS_FILE), exist_ok=True)
        with open(REBUILD_STATUS_FILE, 'w') as f:
            f.write(f"❌ Error: {str(e)}")
    finally:
        rebuild_running = False

def get_netlify_deploy_status(site_name):
    """Fetch latest deploy status from Netlify API"""
    if not NETLIFY_TOKEN:
        return {'error': 'No Netlify token configured'}
    
    try:
        url = f'https://api.netlify.com/api/v1/sites/{site_name}.netlify.app/deploys?per_page=1'
        req = urllib.request.Request(url)
        req.add_header('Authorization', f'Bearer {NETLIFY_TOKEN}')
        
        with urllib.request.urlopen(req, timeout=10) as response:
            deploys = json.loads(response.read().decode())
            if deploys:
                deploy = deploys[0]
                return {
                    'state': deploy.get('state'),  # building, ready, error
                    'created_at': deploy.get('created_at'),
                    'published_at': deploy.get('published_at'),
                    'error_message': deploy.get('error_message'),
                    'deploy_url': deploy.get('deploy_ssl_url'),
                    'title': deploy.get('title', ''),
                }
            return {'error': 'No deploys found'}
    except urllib.error.HTTPError as e:
        return {'error': f'HTTP {e.code}'}
    except Exception as e:
        return {'error': str(e)}

class APIHandler(BaseHTTPRequestHandler):
    def _send_response(self, status, data):
        self.send_response(status)
        self.send_header('Content-Type', 'application/json')
        self.send_header('Access-Control-Allow-Origin', '*')
        self.send_header('Access-Control-Allow-Methods', 'POST, GET, OPTIONS')
        self.send_header('Access-Control-Allow-Headers', 'Content-Type')
        self.end_headers()
        self.wfile.write(json.dumps(data).encode())

    def do_OPTIONS(self):
        self.send_response(200)
        self.send_header('Access-Control-Allow-Origin', '*')
        self.send_header('Access-Control-Allow-Methods', 'POST, GET, OPTIONS')
        self.send_header('Access-Control-Allow-Headers', 'Content-Type')
        self.end_headers()

    def do_GET(self):
        if self.path == '/rebuild-status':
            try:
                status = ''
                if os.path.exists(REBUILD_STATUS_FILE):
                    with open(REBUILD_STATUS_FILE, 'r') as f:
                        status = f.read().strip()
                
                # Done if not running OR status indicates completion
                status_done = status.startswith('✓') or status.startswith('❌')
                done = (not rebuild_running) or status_done
                
                self._send_response(200, {
                    'status': status,
                    'done': done,
                    'running': rebuild_running
                })
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        elif self.path == '/restart-status':
            try:
                status = ''
                if os.path.exists(RESTART_STATUS_FILE):
                    with open(RESTART_STATUS_FILE, 'r') as f:
                        status = f.read().strip()
                
                # Done if not running OR status indicates completion
                status_done = status.startswith('✓') or status.startswith('❌')
                done = (not restart_running) or status_done
                
                self._send_response(200, {
                    'status': status,
                    'done': done,
                    'running': restart_running
                })
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        elif self.path == '/deploy-status':
            try:
                results = {}
                for key, site_name in NETLIFY_SITES.items():
                    results[key] = get_netlify_deploy_status(site_name)
                self._send_response(200, results)
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        elif self.path.startswith('/deploy-status/'):
            try:
                site_key = self.path.split('/')[-1]
                if site_key in NETLIFY_SITES:
                    result = get_netlify_deploy_status(NETLIFY_SITES[site_key])
                    self._send_response(200, result)
                else:
                    self._send_response(404, {'error': f'Unknown site: {site_key}'})
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        else:
            self._send_response(404, {'error': 'Not found'})

    def do_POST(self):
        if self.path == '/start':
            content_length = int(self.headers.get('Content-Length', 0))
            body = self.rfile.read(content_length).decode()
            
            try:
                data = json.loads(body) if body else {}
                site = data.get('site', 'all')
                
                result = subprocess.run(
                    [DEV_SERVERS, site],
                    capture_output=True,
                    text=True,
                    timeout=30
                )
                
                self._send_response(200, {
                    'success': result.returncode == 0,
                    'output': result.stdout,
                    'error': result.stderr
                })
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        elif self.path == '/restart-all':
            global restart_running
            try:
                if restart_running:
                    self._send_response(400, {'success': False, 'error': 'Restart already in progress'})
                    return
                
                # Start restarts in background, respond immediately
                restart_running = True
                thread = threading.Thread(target=restart_sites_async)
                thread.daemon = True
                thread.start()
                
                self._send_response(200, {
                    'success': True,
                    'message': 'Restart initiated'
                })
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        elif self.path == '/rebuild-docs':
            global rebuild_running
            
            try:
                if rebuild_running:
                    self._send_response(400, {'success': False, 'error': 'Rebuild already in progress'})
                    return
                
                # Start rebuild of all projects in background
                rebuild_running = True
                thread = threading.Thread(target=rebuild_docs_async, args=('all',))
                thread.daemon = True
                thread.start()
                
                self._send_response(200, {
                    'success': True,
                    'message': 'Rebuild started'
                })
            except Exception as e:
                self._send_response(500, {'success': False, 'error': str(e)})
        
        elif self.path == '/restart-dispatcher' or self.path == '/restart-api':  # /restart-api for backwards compat
            log_file = os.path.join(GITHUB_DIR, 'logs', 'dispatcher-restart.log')
            os.makedirs(os.path.dirname(log_file), exist_ok=True)
            script_path = os.path.abspath(__file__)
            cmd = f'nohup python3 "{script_path}" > "{log_file}" 2>&1 &'
            
            # Spawn new process FIRST, before any HTTP stuff
            os.system(cmd)
            time.sleep(1.0)  # Let it start
            
            # Now exit - the new process will kill us anyway
            os._exit(0)
        
        else:
            self._send_response(404, {'error': 'Not found'})

    def log_message(self, format, *args):
        # Suppress all request logging
        pass

    def handle(self):
        """Override to suppress BrokenPipeError noise"""
        try:
            super().handle()
        except BrokenPipeError:
            pass

if __name__ == '__main__':
    import socket
    import signal
    
    # Kill any existing process on port 5171
    result = subprocess.run(['lsof', '-ti', ':5171'], capture_output=True, text=True)
    if result.stdout.strip():
        for pid in result.stdout.strip().split('\n'):
            try:
                os.kill(int(pid), signal.SIGKILL)
                print(f"Killed existing process {pid} on port 5171")
            except:
                pass
        time.sleep(1.0)  # Wait for port to be released
    
    # Allow rebinding to port immediately after restart
    class ReusableHTTPServer(HTTPServer):
        allow_reuse_address = True
    
    server = ReusableHTTPServer(('localhost', 5171), APIHandler)
    print("Dispatcher running on http://localhost:5171")
    try:
        server.serve_forever()
    except KeyboardInterrupt:
        print("\nShutting down...")
        server.shutdown()
```

### /Users/sand/GitHub/mono/notes/tools/hub/index.html
```html
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Work Sites</title>
  <style>
    :root {

      /* Backgrounds */
      --bg-page: #8282b1;
      --bg-command: #0a0a1a;
      --bg-chosen: #016c42;
      --bg-available: #002f68;
      --bg-unavailable: #557197;
      --bg-button-hover: #1a4a7a;
      --bg-badge: rgb(171, 190, 241);
      --bg-container: rgb(129, 156, 229);

      /* Button text */
      --text-unavailable: #222;
      --text-command: #a8006d;
      --text-feedback: #fff;
      --text-primary: #fff;
      --text-chosen: #fff;
      --text-choice: #888;
      --text-action: #fff;
      --text-title: #fff;
      --text-badge: #016c42;


      /* Font sizes */
      --font-feedback: 11px;
      --font-command: 13px;
      --font-button: 14px;
      --font-title: 24px;
      --font-badge: 11px;

      /* Spacing */
      --gap-horizontal: 12px;
      --gap-vertical: 12px;
      --button-gap: 6px;
      --box-padding: 6px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-page);
      color: var(--text-primary);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }

    .container {
      padding: 32px;
      min-width: 420px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      margin: 0;
      font-size: var(--font-title);
      font-weight: 500;
      color: var(--text-title);
      text-align: center;
    }

    .title-row {
      display: inline-flex;
      gap: var(--gap-horizontal);
      margin-bottom: var(--gap-vertical);
    }

    .segment-row {
      display: flex;
      gap: var(--gap-horizontal);
      margin-bottom: var(--gap-vertical);
      justify-content: center;
    }

    .actions-row {
      display: inline-flex;
      gap: var(--gap-horizontal);
      margin-bottom: var(--gap-vertical);
    }

    .console-row {
      display: flex;
      margin-bottom: var(--gap-vertical);
    }

    .console-box {
      background: transparent;
      padding: var(--box-padding);
      border-radius: 12px;
    }

    .console-output {
      background: transparent;
      color: var(--text-feedback);
      font-family: monospace;
      font-size: 10px;
      padding: 8px 12px;
      border-radius: 6px;
      height: 20px;
      min-width: 400px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-top: -7px;
    }

    .feedback-row {
      display: flex;
      gap: var(--button-gap);
      margin-bottom: var(--gap-vertical);
    }

    .feedback-btn {
      height: 24px;
      background: var(--bg-page);
      border: none;
      border-radius: 6px;
      color: var(--text-feedback);
      font-size: var(--font-feedback);
      cursor: default;
    }

    #btn-mode {
      text-align: center;
      width: 40px;
    }

    #btn-project {
      text-align: center;
      width: 40px;
    }

    #btn-destination {
      text-align: left;
      padding-left: 8px;
      flex: 1;
    }

    .title-box {
      display: flex;
      align-items: center;
      background: var(--bg-container);
      padding: var(--box-padding);
      border-radius: 12px;
      box-sizing: border-box;
    }

    .title-box h1 {
      flex: 1;
      text-align: center;
    }

    .mode-group,
    .project-group {
      display: flex;
      gap: var(--button-gap);
      background: var(--bg-container);
      padding: var(--box-padding);
      border-radius: 12px;
    }

    .segment {
      background: var(--bg-available);
      color: var(--text-choice);
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: var(--font-button);
      transition: all 0.2s;
      position: relative;
      text-transform: lowercase;
    }

    .segment .badge {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 14px;
      height: 14px;
      background: var(--bg-badge);
      color: var(--text-badge);
      border-radius: 50%;
      font-size: var(--font-badge);
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      text-transform: lowercase;
    }

    .segment:hover,
    .segment.sticky:not(.disabled) {
      background: var(--bg-chosen);
      color: var(--text-chosen);
    }

    .segment.active {
      background: var(--bg-chosen);
      color: var(--text-chosen);
    }

    .segment.disabled {
      background: var(--bg-unavailable);
      color: var(--text-unavailable);
      cursor: not-allowed;
    }

    .segment.hover-hidden:not(.disabled) {
      background: var(--bg-available);
      color: var(--text-choice);
    }

    .navigate-group,
    .more-group {
      display: flex;
      gap: var(--button-gap);
      background: var(--bg-container);
      padding: var(--box-padding);
      border-radius: 12px;
    }

    .action {
      background: var(--bg-available);
      color: var(--text-action);
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: var(--font-button);
      transition: all 0.2s;
      position: relative;
      text-transform: lowercase;
    }

    .action .badge {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 14px;
      height: 14px;
      background: var(--bg-badge);
      color: var(--text-badge);
      border-radius: 50%;
      font-size: var(--font-badge);
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      text-transform: lowercase;
    }

    .action:hover:not(.disabled),
    .action.sticky:not(.disabled) {
      background: var(--bg-chosen);
      color: var(--text-chosen);
    }

    .action.disabled {
      background: var(--bg-unavailable);
      color: var(--text-unavailable);
      cursor: not-allowed;
    }

    .command {
      margin-top: 16px;
      padding: 12px;
      background: var(--bg-command);
      border-radius: 6px;
      font-family: monospace;
      font-size: var(--font-command);
      color: var(--text-command);
      text-align: center;
      display: none;
    }

    .command.visible {
      display: block;
    }

    .action[data-tooltip] {
      position: relative;
    }

    .action[data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      white-space: nowrap;
      z-index: 100;
      margin-bottom: 4px;
    }

    .title-wrapper {
      position: relative;
      display: inline-block;
      flex: 1;
    }

    .deploy-tooltip {
      display: none;
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #222;
      color: #fff;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 11px;
      white-space: pre;
      z-index: 100;
      margin-top: 8px;
      font-family: monospace;
      line-height: 1.6;
    }

    .title-wrapper:hover .deploy-tooltip {
      display: block;
    }

    .status-dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #ffc800;
      position: absolute;
      top: -2px;
      left: 10px;
    }

    .title-text {
      position: relative;
      z-index: 1;
    }

    h1.middle {
      position: relative;
    }

    .status-dot.ready {
      background: #2ecc71;
    }

    .status-dot.building {
      background: #f1c40f;
    }

    .status-dot.error {
      background: #e74c3c;
    }

    /* Side-A/Side-B swap support */
    .side-b {
      display: flex;
      gap: var(--button-gap);
    }

    .swapped {
      flex-direction: row-reverse;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="title-row">
      <div class="title-box swapped">
        <button class="action side-a" id="btn-dns">DNS<span class="badge">N</span></button>
        <div class="title-wrapper">
          <h1 class="middle"><span class="status-dot" id="status-dot"></span><span class="title-text">Work Sites</span>
          </h1>
          <div class="deploy-tooltip" id="deploy-tooltip">Loading...</div>
        </div>
        <div class="side-b">
          <button class="action" id="btn-start" data-tooltip="restart all local dev servers">localhosts<span
              class="badge">esc</span></button>
          <button class="action" id="btn-docs" data-tooltip="build all documentation">docs<span
              class="badge">⌫</span></button>
          <button class="action" id="btn-dispatcher" data-tooltip="restart local bash executor">dispatcher<span
              class="badge">`</span></button>
        </div>
      </div>
    </div>

    <div class="console-row" id="console-row">
      <div class="console-box">
        <div class="console-output" id="console-output"></div>
      </div>
    </div>

    <div class="segment-row swapped">
      <div class="project-group side-a">
        <button class="segment" data-project="mono">mono<span class="badge">M</span></button>
        <button class="segment" data-project="di">di<span class="badge">D</span></button>
        <button class="segment active" data-project="ws">ws<span class="badge">W</span></button>
      </div>
      <div class="mode-group side-b">
        <button class="segment active" data-mode="app">App<span class="badge">A</span></button>
        <button class="segment" data-mode="docs">Docs<span class="badge">X</span></button>
      </div>
    </div>

    <div class="feedback-row" id="feedback-row">
      <button class="feedback-btn side-a" id="btn-destination"></button>
      <div class="side-b">
        <button class="feedback-btn" id="btn-project"></button>
        <button class="feedback-btn" id="btn-mode"></button>
      </div>
    </div>

    <div class="actions-row">
      <div class="more-group side-a">
        <button class="action" id="btn-bubble">Bubble<span class="badge">B</span></button>
        <button class="action" id="btn-repo">Repo<span class="badge">R</span></button>
        <button class="action" id="btn-deploy">Deploy<span class="badge">Y</span></button>
      </div>
      <div class="navigate-group side-b">
        <button class="action" id="btn-local">Local<span class="badge">L</span></button>
        <button class="action" id="btn-netlify">Netlify<span class="badge">T</span></button>
        <button class="action" id="btn-public">Public<span class="badge">P</span></button>
      </div>
    </div>

    <div class="command" id="command"></div>
  </div>

  <script>
    // === Variables ===
    let ports = {};
    let config = {};
    let mode = localStorage.getItem('hub-mode') || 'app';
    let project = localStorage.getItem('hub-project') || 'ws';
    let hoveredActionId = null;
    let hoveredAction = null;
    let previewMode = null;
    let previewProject = null;

    const DNS_URL = 'https://www.dynadot.com/account/domain/name/list.html';

    // === DOM Elements ===
    const modeButtons = document.querySelectorAll('.segment[data-mode]');
    const projectButtons = document.querySelectorAll('.segment[data-project]');
    const btnLocal = document.getElementById('btn-local');
    const btnNetlify = document.getElementById('btn-netlify');
    const btnStart = document.getElementById('btn-start');
    const btnPublic = document.getElementById('btn-public');
    const btnRepo = document.getElementById('btn-repo');
    const btnDeploy = document.getElementById('btn-deploy');
    const btnDns = document.getElementById('btn-dns');
    const btnBubble = document.getElementById('btn-bubble');
    const btnDocs = document.getElementById('btn-docs');
    const btnDispatcher = document.getElementById('btn-dispatcher');
    const consoleOutput = document.getElementById('console-output');
    const consoleRow = document.getElementById('console-row');
    const commandDiv = document.getElementById('command');

    // === Config Initialization ===
    function initConfig() {
      config = {
        app: {
          ws: {
            port: ports.ws,
            site: 'ws',
            public: 'https://webseriously.org',
            netlify: 'https://webseriously.netlify.app',
            repo: 'https://github.com/gizmolab10/seriously-svelte',
            deploy: 'https://app.netlify.com/projects/webseriously/deploys',
            bubble: 'https://bubble.io/home/plugins'
          },
          di: {
            port: ports.di,
            site: 'di',
            public: 'https://designintuition.app',
            netlify: 'https://designintuition.netlify.app',
            repo: 'https://github.com/gizmolab10/design.intuition',
            deploy: 'https://app.netlify.com/projects/designintuition/deploys',
```

### /Users/sand/GitHub/mono/notes/tools/hub/ports.json
```json
{
  "dispatch": 5170,
  "dispatcher": 5171,
  "ws": 5172,
  "di": 5173,
  "ws-docs": 5174,
  "di-docs": 5175,
  "mono-docs": 5176
}```

### /Users/sand/GitHub/mono/notes/tools/hub/start-hub.sh
```sh
#!/bin/bash

# start-hub.sh - Kill existing hub processes and start fresh

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Kill existing processes on hub ports
lsof -ti:5170 | xargs kill 2>/dev/null
lsof -ti:5171 | xargs kill 2>/dev/null

sleep 1

# Start static server for hub UI
cd "$SCRIPT_DIR"
python3 -m http.server 5170 &

# Start dispatcher
python3 dispatcher.py &

echo "Hub started at http://localhost:5170"
```

### /Users/sand/GitHub/mono/notes/tools/hub/index.md
```md
# Hub


```

### /Users/sand/GitHub/mono/notes/tools/hub/servers.sh
```sh
#!/bin/bash

# dev-servers.sh - Start/restart development servers
# Usage: ./dev-servers.sh [ws|ws-docs|di|di-docs|mono-docs|hub] [--kill-only] [--no-verify] [--verify-only]

GITHUB_DIR="$HOME/GitHub/mono"
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
LOG_DIR="$GITHUB_DIR/logs"
PORTS_FILE="$SCRIPT_DIR/ports.json"
STATUS_FILE="$GITHUB_DIR/logs/restart-status.txt"
mkdir -p "$LOG_DIR"
mkdir -p "$GITHUB_DIR/logs"

# Progress display
CURRENT_STEP=0
TOTAL_STEPS=7
VERIFY_STEPS=0  # Will be set based on sites to verify

progress() {
  printf "\r\033[KStep %d/%d: %s" "$1" "$TOTAL_STEPS" "${2:0:50}"
  echo "Step $1/$TOTAL_STEPS: $2" > "$STATUS_FILE"
}

progress_done() {
  printf "\r\033[K✓ All servers restarted\n"
  echo "✓ All $TOTAL_STEPS sites are up" > "$STATUS_FILE"
}

progress_fail() {
  printf "\r\033[K❌ Failed: %s\n" "$1"
  echo "❌ Failed: $1" > "$STATUS_FILE"
}

# Read port from JSON
get_port() {
  local key=$1
  grep "\"$key\"" "$PORTS_FILE" | sed 's/[^0-9]//g'
}

# Load ports
PORT_DISPATCH=$(get_port dispatch)
PORT_DISPATCHER=$(get_port dispatcher)
PORT_WS=$(get_port ws)
PORT_DI=$(get_port di)
PORT_WS_DOCS=$(get_port ws-docs)
PORT_MONO_DOCS=$(get_port mono-docs)
PORT_DI_DOCS=$(get_port di-docs)

# Site definitions: name|port|dir|command
SITES=(
  "hub|$PORT_DISPATCH|notes/tools/hub|python3 -m http.server $PORT_DISPATCH"
  "ws|$PORT_WS|ws|yarn dev"
  "ws-docs|$PORT_WS_DOCS|ws|VITE_PORT=$PORT_WS_DOCS yarn docs:dev"
  "di|$PORT_DI|di|yarn dev"
  "di-docs|$PORT_DI_DOCS|di|VITE_PORT=$PORT_DI_DOCS yarn docs:dev"
  "mono-docs|$PORT_MONO_DOCS|.|yarn docs:dev"
)

kill_port() {
  local port=$1
  local pid=$(lsof -ti :$port 2>/dev/null)
  if [ -n "$pid" ]; then
    kill -9 $pid 2>/dev/null
    sleep 0.3
  fi
}

verify_port() {
  local port=$1
  local timeout=$2
  local elapsed=0
  while [ $elapsed -lt $timeout ]; do
    if lsof -ti :$port >/dev/null 2>&1; then
      return 0
    fi
    sleep 0.5
    elapsed=$((elapsed + 1))
  done
  return 1
}

verify_url() {
  local port=$1
  local timeout=$2
  local elapsed=0
  while [ $elapsed -lt $timeout ]; do
    if curl -s -o /dev/null -w "%{http_code}" "http://localhost:$port" 2>/dev/null | grep -q "200"; then
      return 0
    fi
    sleep 0.5
    elapsed=$((elapsed + 1))
  done
  return 1
}

start_site() {
  local name=$1
  local port=$2
  local dir=$3
  local cmd=$4
  
  local logfile="$LOG_DIR/$name.log"
  cd "$GITHUB_DIR/$dir"
  eval $cmd > "$logfile" 2>&1 &
  sleep 1
}

run_site() {
  local entry=$1
  IFS='|' read -r name port dir cmd <<< "$entry"
  
  kill_port $port
  
  if [ "$KILL_ONLY" != "true" ]; then
    start_site "$name" "$port" "$dir" "$cmd"
  fi
}

# Parse args
KILL_ONLY=false
NO_VERIFY=false
VERIFY_ONLY=false
TARGET=""

for arg in "$@"; do
  case $arg in
    --kill-only) KILL_ONLY=true ;;
    --no-verify) NO_VERIFY=true ;;
    --verify-only) VERIFY_ONLY=true ;;
    ws|ws-docs|di|di-docs|mono-docs|hub) TARGET=$arg ;;
  esac
done

# Run
if [ -z "$TARGET" ]; then
  # Count sites for progress
  TOTAL_STEPS=${#SITES[@]}
  
  # Start all sites (unless verify-only)
  if [ "$VERIFY_ONLY" != "true" ]; then
    CURRENT_STEP=0
    STARTED_SITES=()
    for site in "${SITES[@]}"; do
      CURRENT_STEP=$((CURRENT_STEP + 1))
      IFS='|' read -r name port dir cmd <<< "$site"
      progress $CURRENT_STEP "Restarting $name"
      run_site "$site"
      STARTED_SITES+=("$name|$port")
    done
  else
    # For verify-only, build STARTED_SITES from SITES
    for site in "${SITES[@]}"; do
      IFS='|' read -r name port dir cmd <<< "$site"
      STARTED_SITES+=("$name|$port")
    done
  fi
  
  # Verify if not suppressed
  if [ "$KILL_ONLY" != "true" ] && [ "$NO_VERIFY" != "true" ]; then
    FAILED=""
    
    # Verify ports
    CURRENT_STEP=0
    for entry in "${STARTED_SITES[@]}"; do
      CURRENT_STEP=$((CURRENT_STEP + 1))
      IFS='|' read -r name port <<< "$entry"
      progress $CURRENT_STEP "Verifying port $CURRENT_STEP/$TOTAL_STEPS: $name"
      if ! verify_port $port 10; then
        FAILED="$FAILED $name"
      fi
    done
    
    # Verify HTTP responses (only if ports succeeded)
    if [ -z "$FAILED" ]; then
      CURRENT_STEP=0
      for entry in "${STARTED_SITES[@]}"; do
        CURRENT_STEP=$((CURRENT_STEP + 1))
        IFS='|' read -r name port <<< "$entry"
        progress $CURRENT_STEP "Verifying response $CURRENT_STEP/$TOTAL_STEPS: $name"
        if ! verify_url $port 20; then
          FAILED="$FAILED $name"
        fi
      done
    fi
    
    if [ -n "$FAILED" ]; then
      progress_fail "Failed to start:$FAILED"
      exit 1
    fi
  fi
  
  progress_done
else
  for site in "${SITES[@]}"; do
    IFS='|' read -r name port dir cmd <<< "$site"
    if [ "$name" = "$TARGET" ]; then
      TOTAL_STEPS=1
      
      # Start site (unless verify-only)
      if [ "$VERIFY_ONLY" != "true" ]; then
        progress 1 "Restarting $name"
        run_site "$site"
      fi
      
      # Verify single site if not suppressed
      if [ "$KILL_ONLY" != "true" ] && [ "$NO_VERIFY" != "true" ]; then
        progress 1 "Verifying port: $name"
        if ! verify_port $port 10; then
          progress_fail "Failed to start: $name"
          exit 1
        fi
        progress 1 "Verifying response: $name"
        if ! verify_url $port 20; then
          progress_fail "Failed to start: $name"
          exit 1
        fi
      fi
      
      progress_done
      break
    fi
  done
fi

if [ "$KILL_ONLY" = "true" ]; then
  printf "\r\033[KKilled specified servers.\n"
fi
```

### /Users/sand/GitHub/mono/notes/.DS_Store
```DS_Store
   Bud1           	                                                          comp     �8                                                                                                                                                                                                                                                                                                                                                                                                                                           d ilg1Scomp     �8    d imoDDblob   4�}j܊�A    d imodDblob   4�}j܊�A    d iph1Scomp     �     g u i d e slg1Scomp     �2    g u i d e smoDDblob   �4sj܊�A    g u i d e smodDblob   �4sj܊�A    g u i d e sph1Scomp     `     t o o l slg1Scomp      ��    t o o l smoDDblob   ��qj܊�A    t o o l smodDblob   ��qj܊�A    t o o l sph1Scomp           w slg1Scomp     _��    w smoDDblob   �rj܊�A    w smodDblob   �rj܊�A    w sph1Scomp     i�                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E  	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       DSDB                                 `          �                                         @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```

### /Users/sand/GitHub/mono/notes/index.md
```md
# Notes

Unified documentation for all projects.
## Projects
- [**Guides**](/guides/) — Shared collaboration and development guides
- [**Design Intuition (DI)**](/di/) — Quaternion rotation demo
- [**WebSeriously (WS)**](/ws/) — Graph visualization app

## Contents

- [Guides](./guides/)
- [Tools](./tools/)
- [Work](./work/)

```

### /Users/sand/GitHub/mono/notes/guides/tools/single-line.md
```md
# Single-Line Progress Display

i wanted my build script to stop spewing noise. One calm line, updating in place, showing what's happening without scrolling my terminal into oblivion.

## The Goal

```
Step 3/7: Building docs... processing sidebar.ts
```

Each sub-item overwrites the last. When the step finishes, the next step takes over. Errors get logged to a file and dumped at the end.

## The Tricks

### Overwriting a Line

```bash
printf "\r\033[K"
```

- `\r` — carriage return (back to start of line)
- `\033[K` — ANSI escape to clear from cursor to end of line

Without the clear, shorter messages leave cruft from longer ones.

### Truncating Long Output

```bash
"${line:0:50}"
```

Bash substring expansion. Keeps lines from wrapping ugly.

### Streaming Command Output

Can't just pipe through `while read` — the exit code gets lost in a subshell. Instead:

```bash
"$@" > "$tmp_out" 2>&1 &
local pid=$!

while kill -0 $pid 2>/dev/null; do
  local last_line=$(tail -1 "$tmp_out")
  [ -n "$last_line" ] && progress_item "$last_line"
  sleep 0.1
done

wait $pid
local exit_code=$?
```

- Run command in background, capture output to temp file
- Poll every 0.1s, show the last line
- `kill -0` checks if process is still running (no signal sent)
- `wait` retrieves the actual exit code

### Capturing Errors

On failure, append the full output to an error log:

```bash
if [ $exit_code -ne 0 ]; then
  echo "=== Step $CURRENT_STEP: $STEP_NAME ===" >> "$ERROR_LOG"
  cat "$tmp_out" >> "$ERROR_LOG"
fi
```

Then dump it at the end instead of making the user hunt for a file.

### Absolute Paths Matter

If your script `cd`s around (mine does for TypeScript compilation), relative paths break. Convert early:

```bash
cd "$PROJECT_ROOT" || exit 1
PROJECT_ROOT=$(pwd)  # Now it's absolute
```

### Verbose Escape Hatch

Sometimes you need the firehose for debugging:

```bash
if [ "$VERBOSE" = true ]; then
  "$@"
  return $?
fi
```

Flag it with `--verbose` and skip all the single-line magic.

## The Result

Seven steps, one line, errors collected. Much calmer.
```

### /Users/sand/GitHub/mono/notes/guides/tools/index.md
```md
# Tools

Scripts and utilities for development workflow.

## Contents

- [Hub App](./hub-app.md)
- [Single Line](./single-line.md)

```

### /Users/sand/GitHub/mono/notes/guides/tools/hub-app.md
```md
# Hub App

**Started:** 2025-01-09
**Updated:** 2026-01-28

## Table of Contents

- [Overview](#overview)
- [Architecture](#architecture)
- [Hub UI](#hub-ui)
- [API Endpoints](#api-endpoints)
- [Setup](#setup)
- [Keyboard Shortcuts](#keyboard-shortcuts)

## Overview

The hub app provides a local dashboard for managing dev servers and navigating between projects in the monorepo.

**Location:** `~/GitHub/mono/notes/tools/hub/`

**URL:** http://localhost:5170

## Architecture

### Sites and Ports

Defined in `notes/tools/hub/ports.json`:

| Site | Port | Purpose |
|------|------|---------|
| dispatch | 5170 | Hub UI (static server) |
| dispatcher | 5171 | API for hub actions |
| ws app | 5172 | WebSeriously app |
| di app | 5173 | Design Intuition app |
| ws docs | 5174 | WebSeriously docs |
| di docs | 5175 | Design Intuition docs |
| mono docs | 5176 | Monorepo docs |

### Key Files

| File | Purpose |
|------|---------|
| `notes/tools/hub/index.html` | Hub UI |
| `notes/tools/hub/dispatcher.py` | API server (command runner) |
| `notes/tools/hub/servers.sh` | Start/restart/kill dev servers |
| `notes/tools/hub/ports.json` | Port configuration |

### servers.sh

Manages all dev servers. Options:

```bash
restart                    # alias: restart with verification
servers.sh --no-verify     # fast restart, skip verification
servers.sh --verify-only   # check if servers are running
servers.sh --kill-only     # kill all servers
```

Verification checks:
1. Port listening (lsof, 10s timeout)
2. HTTP 200 response (curl, 20s timeout)

**Note:** The dispatcher automatically makes servers.sh executable if needed.

## Hub UI

### Layout

```
┌─────────────────────────────────────────────────────────────┐
│ localhosts │ docs │ dispatcher │      Work Sites      │ dns │
├─────────────────────────────────────────────────────────────┤
│                    [console output]                         │
├─────────────────────────────────────────────────────────────┤
│ app │ docs │                               │ mono │ di │ ws │
├─────────────────────────────────────────────────────────────┤
│  [destination URL preview]              │ [project] [mode]  │
├─────────────────────────────────────────────────────────────┤
│ bubble │ repo │ deploy │         │ local │ netlify │ public │
└─────────────────────────────────────────────────────────────┘
```

### Top Row Buttons

| Button | Shortcut | Action |
|--------|----------|--------|
| localhosts | Esc | Restart all local dev servers |
| docs | ⌫ | Pre-publish all md and html files |
| dispatcher | \` | Restart local command runner |
| dns | N | Open domain registrar |

**Status dot:** A colored dot appears above "Work Sites" title:
- Green = all deploys ready/canceled
- Yellow = building/enqueued  
- Red = error/failed

**Deploy tooltip:** Hover over "Work Sites" to see per-site deploy status:
```
ws: ✓ ready -2m
di: ⋯ building -1m
ws-docs: ✓ ready -5m
di-docs: ⊘ canceled -3m
mono-docs: ✗ error -10m
```

### Features

- **Project/Mode selection** — Pick ws/di/mono + app/docs
- **Action buttons** — Navigate to local, Netlify, public URLs
- **localhosts** — Restarts all dev servers with verification
- **docs** — Runs update-project-docs.sh for all projects
- **dispatcher** — Restarts the command runner (itself)
- **Deploy status dot** — Persistent colored indicator of deploy health
- **Deploy tooltip** — Hover title to see per-site status with timestamps
- **Hover preview** — Shows destination URL before clicking
- **Keyboard driven** — All actions have shortcuts

### Console Row

Shows status messages for:
- Restart progress (per-site verification)
- Rebuild docs progress
- Deploy status (polls Netlify every 10s)
- Dispatcher restart status

**Docs rebuild format:**
```
ws 3/7 build → bundling
ws 3/7 build → dead links: 2
ws 6/7 rebuild → done
✓ mono, ws, di
```

Sub-progress shows: `bundling`, `rendering`, `sitemap`, `done`, `failed`, `dead links: N`

Hover over localhosts, docs, or dispatcher buttons to see their last status message.

### Feedback Row

The row below the mode/project segments shows:
- **Left:** Destination URL preview (when hovering action buttons)
- **Right:** Current project and mode

### Button States

- **Green** — Active/chosen
- **Dark blue** — Available
- **Muted** — Unavailable (e.g., mono has no app mode)

## API Endpoints

The dispatcher server (`dispatcher.py`) provides these endpoints:

### POST /restart-all
Restarts all dev servers via servers.sh.

### POST /rebuild-docs
Rebuilds docs for all projects.

### POST /restart-dispatcher
Restarts the dispatcher itself. Spawns new process then exits.

### GET /restart-status
Returns restart progress.

### GET /rebuild-status
Returns rebuild progress.

### GET /deploy-status
Returns Netlify deploy status for all 5 sites.

### GET /deploy-status/{site}
Returns deploy status for one site (ws, di, ws-docs, di-docs, mono-docs).

## Setup

### Starting the Hub

1. Start the static server for the hub UI:
   ```bash
   cd ~/GitHub/mono/notes/tools/hub && python3 -m http.server 5170
   ```

2. Start the dispatcher:
   ```bash
   cd ~/GitHub/mono/notes/tools/hub && python3 dispatcher.py
   ```

3. Open http://localhost:5170

### Shell Aliases

Add to `~/.zshrc`:

```bash
alias restart="~/GitHub/mono/notes/tools/hub/servers.sh"
alias killdev="~/GitHub/mono/notes/tools/hub/servers.sh --kill-only"
```

### Environment

Requires `NETLIFY_ACCESS_TOKEN` for deploy status polling.

## Keyboard Shortcuts

### Segments

| Key | Action |
|-----|--------|
| A | App mode |
| X | Docs mode |
| W | ws project |
| D | di project |
| M | mono project |

### Actions

| Key | Action |
|-----|--------|
| Esc | Restart all local dev servers |
| ⌫ | Rebuild docs |
| \` | Restart dispatcher |
| Enter | Open hovered destination |
| ⌘C | Copy hovered URL |
| L | Local |
| T | Netlify |
| P | Public |
| R | Repo |
| Y | Deploy |
| N | DNS |
| B | Bubble |
```

### /Users/sand/GitHub/mono/notes/guides/.DS_Store
```DS_Store
   Bud1           	                                                           a b o r a t                                                                                                                                                                                                                                                                                                                                                                                                                                           c o l l a b o r a t elg1Scomp      b_    c o l l a b o r a t emoDDblob   ��ʂ֊�A    c o l l a b o r a t emodDblob   ��ʂ֊�A    c o l l a b o r a t eph1Scomp      �     d e v e l o plg1Scomp      �y    d e v e l o pmoDDblob   ������A    d e v e l o pmodDblob   ������A    d e v e l o pph1Scomp     P     t e s tlg1Scomp      �    t e s tmoDDblob   ۀ�����A    t e s tmodDblob   ۀ�����A    t e s tph1Scomp      0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E  	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       DSDB                                 `          �                                         @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```

### /Users/sand/GitHub/mono/notes/guides/develop/markdown.md
```md
# Markdown Guide

How to structure markdown files for this project.

## Headings as Anchors

Each heading (`#`, `##`, `###`, etc.) becomes a linkable anchor. Use headings for any concept you might want to reference from elsewhere.

```markdown
#### Coordinate system proliferation
```
→ Links as `#coordinate-system-proliferation`

## Problems and Goals

State problems and goals inline, near the content they describe:

```markdown
#### Widget Layout

**Problem:** Widgets overlap when the container resizes.

**Goal:** Widgets reflow gracefully at any width.
```

Keep the source of truth close to the code or concept it describes.

## Summary Sections

For longer documents, add a `## Summary` section that collects problems and goals:

```markdown
## Summary

### Problems
- From [Widget Layout](#widget-layout): Widgets overlap when the container resizes
- From [Color States](#color-states): Hover colors don't update consistently

### Goals
- From [Widget Layout](#widget-layout): Widgets reflow gracefully at any width
- From [Color States](#color-states): Single source of truth for color state
```

Group by originating section with links back. Copy the text faithfully—don't rephrase.

## Editing Workflow

**Adding a problem or goal:**
1. Add it under the appropriate heading with `**Problem:**` or `**Goal:**` prefix
2. Mirror it in the Summary section under the `From [#heading]` group

**Renaming a heading:**
1. Update the heading text
2. Update all `From [#heading]` references in the Summary

## File Structure

```markdown
# Title

Brief intro.

## Section One

Content with inline **Problem:** and **Goal:** statements.

## Section Two

More content.

## Summary

### Problems
- From [Section One](#section-one): ...
- From [Section Two](#section-two): ...

### Goals
- From [Section One](#section-one): ...
- From [Section Two](#section-two): ...
```

## Why This Works

- **Local + global view**: Each section has detailed context; the summary provides a scannable overview
- **Anchor stability**: Real headings as anchors keep links predictable
- **Explicit origin**: `From [#heading]` makes it clear where each item came from

## Small, Composable Pieces

Files stay focused. It might be a class, it might be a concern.

When something grows too big, split it. And, jeez, the fewer the better. Shrink, evaporate, snip.

Lessons learned that are universal get promoted to shared guides.
```

### /Users/sand/GitHub/mono/notes/guides/develop/css.md
```md
# CSS Lessons

Patterns and gotchas learned from actual work.

## Class Lists: Static Markup, Dynamic Appearance

**Static markup, dynamic appearance.**

The DOM is structure. CSS is presentation. They're separate. Using toggle in JS, can change all manner of things — order, direction, visibility, colors, sizes, animations. CSS does the heavy lifting. 

**Class lists** are the secret sauce. JS can use a classList object to alter the class list of an element, and CSS can watch the class list, translating it into all those manner of things.

An example. `flex-direction` and `display` have many layout options. They easily do the same job as me manually resculpting a lot of delicate code.

### Toggle: The Flip-Flop

An element can have multiple classes. `classList.toggle()` adds a class if absent, removes it if present:

```javascript
// First call: adds 'swapped'
row.classList.toggle('swapped');  // class="title-box swapped"

// Second call: removes 'swapped'
row.classList.toggle('swapped');  // class="title-box"
```

### Swapping Left and Right

Using `flex-direction` to reverse layout:

```html
<div class="row">
  <div class="left">A</div>
  <div class="right">B</div>
</div>
```

```css
.row { flex-direction: row; }
.row.swapped { flex-direction: row-reverse; }
```

**Normal:** `[ A ][ B ]`

**Swapped:** `[ B ][ A ]`

Same DOM, opposite visual order:

```javascript
// Swap one row
document.querySelector('.row').classList.toggle('swapped');

// Swap all rows
document.querySelectorAll('.row')
  .forEach(row => row.classList.toggle('swapped'));
```

## Rounding Line Ends

**Problem:** Can't round ends of `border-top` selectively.

**Solution:** Use a pseudo-element (`::before` or `::after`) positioned absolutely. It's a real box that accepts `border-radius`.

```css
/* Don't do this */
.container {
  border-top: 10px solid #444;
  border-radius: 5px; /* Won't round just the border-top ends */
}

/* Do this */
.container {
  position: relative;
}
.container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 10px;
  background: #444;
  border-radius: 5px;
}
```

**Lesson:** Match the technique to what already works. If a standalone div with border-radius works, use the same approach (pseudo-element as a box) rather than fighting border properties.
```

### /Users/sand/GitHub/mono/notes/guides/develop/migration.md
```md
# Migration Guide

How to create effective migration documents for component refactors.

## Purpose

Migration documents guide incremental, safe refactoring of components. They break big changes into small phases, document decisions, and track progress.

## When to Create One

Create a `<migrate-component>.md` when:
- Refactoring affects multiple files
- Changes break existing functionality temporarily
- Work spans multiple sessions
- You need to track what's done vs. what's planned

## Document Structure

### 1. Overview Section

**What it needs:**
- Brief description of the refactor goal
- List of main objectives (3-5 bullet points)
- Why we're doing this

**Example:**
```markdown
## Overview

Breadcrumbs.svelte currently mixes three concerns: data selection, layout calculation, and rendering. This refactor separates these concerns using composition patterns.

**Goals:**
- Move mode logic to parent component
- Extract separator into reusable component
- Improve reactivity and testability
```

### 2. Current Implementation

**What it needs:**
- Location of files
- Current props/API
- Key code snippets showing the problem
- How it's currently used

**Keep it factual** - just describe what exists, don't editorialize yet.

### 3. What It Does Well

List the good parts that should be preserved:
- Clean interfaces
- Good composition patterns already in use
- Proper separation that exists

This helps you not throw out good code during refactoring.

### 4. Improvement Opportunities

**This is where you identify problems:**
- Tight coupling
- Mixed concerns
- Hard-to-test code
- Missing flexibility

Be specific about what's wrong and why it matters.

### 5. Refactor Suggestion

**Show the vision:**
- Code examples of the proposed new API
- Component structure diagram (if helpful)
- List concrete benefits

Keep it brief - details go in the phases.

## STOP WRITING DOCUMENT

This is a good stopping point. Gives me a chance to consider the suggestions and erase or add. Wait until asked to resume.

### 6. Migration Plan

**This is the heart of the document.**

Break the work into phases. Each phase should:
- Be completable in one session
- Leave the app in a working state (when possible)
- Have clear checkboxes for tasks

#### Phase Checklist Format

```markdown
### Phase N: Descriptive Name

- [ ] **Task name** ✅
  - Specific detail about what to do
  - Another detail
  - Result or file location
```

Use the ✅ emoji ONLY in completed checkboxes `[x]`, not uncompleted ones `[ ]`.

#### Common Phase Pattern

Most refactors follow this pattern:

**Phase 1: Preparation**
- Review usage (where is it used?)
- Document behavior (what does it do?)
- Run existing app and verify it works
- Take screenshots for comparison

**Phase 2: Extract Components**
- Create new sub-components
- Test them in isolation
- Don't integrate yet

**Phase 3: Refactor Main Component**
- Integrate extracted components
- Keep same external API (no breaking changes)
- Verify everything still works

**Phase 4: Update Consumers**
- Move logic to parent/consumers
- Change component API if needed
- Update all usage sites

**Phase 5: Testing & Cleanup**
- Comprehensive testing
- Remove dead code
- Update documentation
- Commit changes

#### Breaking Changes Warning

If a phase breaks the app temporarily, add a clear warning:

```markdown
**WARNING**: These changes break breadcrumbs until Phase 4 is completed.
```

### 7. Work Performed Sections

**Location:** At the END of each phase (not in a separate section)

**Heading:** Use `#### Work Performed` (not "Phase X Work Performed")

**What to include:**
- Tasks completed (with ✅)
- Key findings or decisions
- Code changes (before/after snippets)
- What was NOT changed (important!)
- Results (does it work? is layout correct?)

**Example:**
```markdown
### Phase 3: Refactor Parent

- [x] **Import Breadcrumb_Separator** ✅
  - Added: `import Breadcrumb_Separator from './Breadcrumb_Separator.svelte';`

- [x] **Replace inline separator with component** ✅
  - Replaced `<div class='between-breadcrumbs'>` with `<Breadcrumb_Separator {color} {left} />`
  - Kept all other code unchanged
  - No breaking changes

#### Work Performed

**Tasks completed:**
1. ✅ Imported Breadcrumb_Separator component
2. ✅ Replaced inline separator with Breadcrumb_Separator

**Import added:**
[code snippet]

**Template change:**
[before/after code]

**What was NOT changed:**
- No new props added
- No mode logic moved
- Layout positioning unchanged

**Result:**
- ✅ App works exactly as before
- ✅ Layout is correct
```

### 8. Issues Identified

Optional section listing known problems discovered during work:
- Bugs found
- Technical debt
- Future improvement opportunities

### 9. Files to Modify

Simple list of files that will change:

```markdown
**Create:**
- `/path/to/NewComponent.svelte` ✅ DONE

**Modify:**
- `/path/to/ExistingComponent.svelte` (Phase 3)
- `/path/to/Parent.svelte` (Phase 4)
```

## Writing Style

Follow `voice.md` guidelines:
- Casual, first-person perspective
- Problem-first (describe the pain before the solution)
- Concise (no fluff)
- Specific (concrete examples over abstract theory)

## Common Pitfalls to Avoid

**Don't make phases too big**
- If a phase has >5 tasks, split it
- Each phase should be doable in one sitting

**Don't skip the "what it does well" section**
- This prevents you from breaking good code
- Preserves valuable patterns

**Don't leave "Work Performed" empty**
- Always document what actually happened
- Include what DIDN'T change (prevents confusion)

**Don't forget layout verification**
- Visual bugs are the worst
- Always verify layout after changes

**Don't use "Phase X Work Performed" as heading**
- Just use "Work Performed"
- It's clear from context which phase it refers to

## Keeping It Updated

As you work:
1. Check off completed tasks with `[x]`
2. Add ✅ emoji after checked tasks
3. Fill in "Work Performed" at end of each phase
4. Update TOC if adding sections
5. Note any deviations from the plan

## Example Structure

```markdown
# Component Migration Guide

## Table of Contents
- [Overview](#overview)
- [Current Implementation](#current-implementation)
- [What It Does Well](#what-it-does-well)
- [Improvement Opportunities](#improvement-opportunities)
- [Refactor Suggestion](#refactor-suggestion)
- [Migration Plan](#migration-plan)
  - [Phase 1: Preparation](#phase-1-preparation)
  - [Phase 2: Extract Components](#phase-2-extract-components)
  - [Phase 3: Refactor](#phase-3-refactor)
  - [Phase 4: Update Consumers](#phase-4-update-consumers)
  - [Phase 5: Testing & Cleanup](#phase-5-testing--cleanup)
- [Issues Identified](#issues-identified)
- [Files to Modify](#files-to-modify)

## Overview
[Vision and goals]

## Current Implementation
[What exists today]

## What It Does Well
[Good parts to preserve]

## Improvement Opportunities
[Problems to solve]

## Refactor Suggestion
[Proposed solution]

## Migration Plan

### Phase 1: Preparation
[Tasks and checkboxes]

#### Work Performed
[What actually happened]

### Phase 2: Extract Components
[Tasks and checkboxes]

#### Work Performed
[What actually happened]

[... more phases ...]

## Issues Identified
[Known problems]

## Files to Modify
[File list]
```

## Tips for Success

**Start with phase 1 tasks**
- Don't skip preparation
- Understanding current state prevents mistakes

**Keep the app working**
- Each phase should leave things functional
- Exception: Phase 3/4 breaking changes are OK if Phase 4 fixes them

**Document layout concerns**
- Layout bugs are subtle and annoying
- Always verify visual correctness
- Add "make painfully certain layout is not broken" to tasks

**Be honest in "Work Performed"**
- Document failed attempts
- Note what didn't work
- Explain why you changed the plan

**Update as you go**
- Don't wait until the end
- Fresh details are more accurate
```

### /Users/sand/GitHub/mono/notes/guides/develop/index.md
```md
# Develop

Code style, patterns, and development practices.

## Contents

- [Aesthetics](./aesthetics.md)
- [Build](./build.md)
- [Css](./css.md)
- [Markdown](./markdown.md)
- [Migration](./migration.md)
- [Refactoring](./refactoring.md)
- [Style](./style.md)

```

### /Users/sand/GitHub/mono/notes/guides/develop/style.md
```md
# Style Guide: Codebase Conventions

This document defines naming, formatting, and organization patterns. Follow these strictly for consistency across projects.

## Table of Contents
- [Names](#names)
  - [Prefixes](#prefixes)
  - [Variable Naming](#variable-naming)
  - [Function Naming](#function-naming)
  - [Class Naming](#class-naming)
  - [Enum Naming](#enum-naming)
- [Formatting](#formatting)
  - [Indentation](#indentation)
  - [Alignment](#alignment)
  - [Spacing](#spacing)
  - [Quotes](#quotes)
  - [Svelte-Specific Formatting](#svelte-specific-formatting)
  - [Template Styles: Props and Style Attributes](#template-styles-props-and-style-attributes)
  - [Boolean Coercion](#boolean-coercion)
  - [Comments](#comments)
- [Ordering of Variables & Lists/Functions](#ordering-of-variables--listsfunctions)
  - [Length-Based Ordering Principle](#length-based-ordering-principle)
  - [Import Order](#import-order)
  - [Class Property Order](#class-property-order)
  - [Function/Method Order](#functionmethod-order)
  - [Array/List Ordering](#arraylist-ordering)
  - [Enum Value Ordering](#enum-value-ordering)
  - [Case Statement Ordering](#case-statement-ordering)
- [Miscellaneous](#miscellaneous)
  - [Unique Symbols for Getters](#unique-symbols-for-getters)
  - [Writable Store Patterns](#writable-store-patterns)
  - [Type Assertions](#type-assertions)
  - [Equality Operators](#equality-operators)
  - [Optional Chaining](#optional-chaining)
  - [Array Methods](#array-methods)
  - [String Methods](#string-methods)
  - [Object Patterns](#object-patterns)
  - [Async/Await](#asyncawait)
  - [Svelte Reactive Statements](#svelte-reactive-statements)
  - [File Organization](#file-organization)
  - [Constants Usage](#constants-usage)
  - [Manager Instance Access](#manager-instance-access)
  - [Error Handling](#error-handling)
  - [Comments in Code](#comments-in-code)
  - [Svelte Component Structure](#svelte-component-structure)
  - [Type Definitions](#type-definitions)
  - [Generic Types](#generic-types)

## Names

### Prefixes

**Critical**: All prefixes must be followed exactly as specified.

| Prefix | Purpose | Example | Notes |
|--------|---------|---------|-------|
| `T_` | Type/Enum | `T_Graph`, `T_Detail`, `T_Startup` | Always uppercase, used for enums and type identifiers |
| `w_` | Writable Store | `w_hierarchy`, `w_ancestry_focus`, `w_t_graph` | Svelte writable stores |
| `S_` | State Class | `S_Alteration`, `S_Widget`, `S_Element` | State management classes |
| `G_` | Geometry | `G_Point`, `G_Rectangle`, `G_Cluster` | Geometry-related classes |
| `k` | Constants | `k.empty`, `k.hashLength`, `k.width.details` | Single lowercase letter, instance of Constants class |
| `h` | Hierarchy | `h.thing_forHID()` | Single lowercase letter, Hierarchy manager instance |
| `s` | Stores | `s.w_thing_title` | Single lowercase letter, global Stores instance |
| `x` | UX | `x.update_grabs_forSearch()` | Single lowercase letter, UX manager instance |
| `g` | Geometry Manager | `g.layout()` | Single lowercase letter, Geometry manager instance |
| `p` | Preferences | `p.read_key()` | Single lowercase letter, Preferences manager instance |
| `u` | Utilities | `u.cumulativeSum()` | Single lowercase letter, Utilities instance |
| `e` | Events | `e.handle_s_mouseFor_t_control()` | Single lowercase letter, Events instance |
| `c` | Configuration | `c.w_device_isMobile` | Single lowercase letter, Configuration instance |

### Variable Naming

- **snake_case** for most variables: `w_t_cluster_pager`, `w_show_details`, `ancestry_dict_byHID`
- **camelCase** for some specific cases (typically when following external library conventions)
- **Boolean flags**: Use descriptive prefixes:
  - `has_`: `has_zoom_controls`, `has_details_button`, `has_every_detail`
  - `is_`: `isAssembled`, `isShowing_countDots_ofType`
  - `allow_`: `allow_graph_editing`, `allow_tree_mode`, `allow_autoSave`
  - `show_`: `show_details`, `show_related`, `show_other_databases`
- **IDs**: End with `_id` or `ID`: `thing_id`, `ancestryHID`, `rootID`
- **Counts**: Start with `count_`: `count_details`, `count_rebuild`
- **Dictionaries/Maps**: Use pattern `{type}_dict_by{Key}`: `thing_dict_byHID`, `ancestry_dict_byKind_andHID`, `si_relationships_dict_byParentHID`
- **Arrays/Lists**: Use plural nouns: `things`, `relationships`, `predicates`, `ancestries`
- **S_Items collections**: Prefix with `si_`: `si_things`, `si_traits`, `si_tags`, `si_ancestries_dict_byThingHID`

### Function Naming

- **snake_case** for all functions: `thing_remember()`, `ancestry_edit_persistentAddAsChild()`, `restore_preferences()`
- Pattern: `{noun}_{verb}_{modifiers}()`: `thing_forget_all()`, `relationships_translate_idsFromTo_forParents()`
- Getters: Use `get` prefix or property syntax: `get hasRoot()`, `get children_dots()`
- Static methods: Include class name or be clear: `Identifiable.newID()`, `remove_item_byHID()`

### Class and Interface Naming

- **Snake_Case** for `ts` classes: `Search_Node`, `Visibility`, `Hierarchy`
- **State classes**: Prefix with `S_`: `S_Widget`, `S_Element`, `S_Alteration`
- **Geometry classes**: Prefix with `G_`: `G_Point`, `G_Rectangle`, `G_Cluster`
- **Export pattern**: Export singleton instance with lowercase: `export const x = new S_UX(); export const show = new Visibility();`

### Enum Naming

- **PascalCase** with `T_` prefix: `T_Graph`, `T_Detail`, `T_Startup`
- Enum values: **camelCase** or **string literals**: `T_Graph.radial`, `T_Graph.tree`, `T_Thing.generic`

## Formatting

### Indentation

- **Tabs only** (not spaces) for indentation
- Tab width appears to be standard (typically 4 spaces equivalent)

### Alignment

- **Align equals signs** in property declarations when in a group:
```typescript
w_t_cluster_pager		= writable<T_Cluster_Pager>(T_Cluster_Pager.sliders);
w_t_breadcrumbs			= writable<T_Breadcrumbs>(T_Breadcrumbs.ancestry);
w_t_auto_adjust_graph	= writable<T_Auto_Adjust_Graph | null>(null);
w_show_details			= writable<boolean>(true);
w_show_tiny_dots		= writable<boolean>(true);
```

### Spacing

- **Single space** after keywords: `if (condition)`, `for (const item of items)`
- **No space** before colons in type annotations: `writable<T_Graph>`, `Array<T_Detail>`
- **Spaces around operators**: `a + b`, `x === y`, `flag ? value1 : value2`
- **No space** before commas: `[a, b, c]`, `function(a, b, c)`
- **Space after commas**: `[a, b, c]`, `function(a, b, c)`

### Quotes

- **Single quotes** for strings in TypeScript: `'string'`, `'key'`
- **Single quotes** in Svelte script tags: `<script lang='ts'>`
- **Single quotes** in Svelte style attributes:
```svelte
style='
	position: absolute;
	top: {top}px;
	left: {left}px;
'
```

### Svelte-Specific Formatting

- **Multi-line style attributes**: Use single quotes with line breaks:
```svelte
style='
	position: absolute;
	width: {width}px;
	height: {height}px;
'
```
- **Component props**: One per line for readability when multiple:
```svelte
<Segmented name='counts-shown-options'
	left={106}
	allow_none={false}
	allow_multiple={false}
	width={segmented_width}
	height={segmented_height}
	origin={Point.y(tops[1])}
	handle_selection={handle_counts_shown}
	titles={[T_Counts_Shown.dots, T_Counts_Shown.numbers]}/>
```

### Template Styles: Props and Style Attributes

#### Component Props Ordering

**Props passed to components** are ordered by **length of prop statement** (the entire prop including its value, shortest first), enabling visual alignment and easier scanning:

```svelte
<Separator name='counts-shown-separator'
	length={width}							// 14 chars
	isHorizontal={true}						// 18 chars
	position={position}						// 19 chars
	has_gull_wings={true}					// 21 chars
	margin={k.details_margin}				// 24 chars
	origin={Point.y(tops[0])}				// 25 chars
	title='show list lengths as'			// 27 chars
	title_left={k.separator_title_left}		// 33 chars
	thickness={k.thickness.separator.details}	// 40 chars
/>
```

**Note**: When props are grouped logically (e.g., all boolean flags together), length-based ordering applies within each group.

#### Style Attribute Ordering

**CSS properties within style attributes** are ordered by **length of property statement** (the entire property including its value, shortest first):

```svelte
<div style='
	width: 17px;						// 11 chars
	height: 17px;						// 12 chars
	left: {color_left}px;					// ~20 chars
	position: {position};					// ~19 chars
	border: 1px solid black;				// 22 chars
	border-radius: 50%;					// 18 chars
	z-index: {T_Layer.details};				// ~28 chars
	background-color: {$w_separator_color}		// ~33 chars
'>
```

**CSS custom properties (variables)** are typically grouped together and ordered by length within that group:

```svelte
<div style='
	--hover-color: {hover_color};					// ~28 chars
	--border-color: {border_color};					// ~30 chars
	--selected-color: {selected_color};				// ~33 chars
	--selected-text-color: {selected_text_color};			// ~38 chars
	--hover-background-color: {hover_background_color};		// ~42 chars
	--selected-hover-text-color: {selected_hover_text_color};	// ~48 chars
	left: {left}px;						// ~15 chars
	height: {height}px;					// ~17 chars
	top: {origin.y}px;					// ~18 chars
'>
```

**Benefits of length-based ordering**:
- Creates visual alignment when using tabs
- Makes it easier to scan and find specific properties
- Maintains consistent formatting across the codebase
- Groups similar-length items together naturally

### Boolean Coercion

- Use `!!` for boolean coercion: `if (!!thing)`, `return !!other && this.id == other.id`
- Use `??` for nullish coalescing: `p.read_key(T_Preference.show_details) ?? false`

### Comments

- **Block comments** for section headers:
```typescript
//////////////////////////////////////////////
//											//
//	reattaches components on/changes to:	//
//											//
//		signal_rebuildGraph					//
//		w_ancestry_focus					//
//											//
//////////////////////////////////////////////
```
- **Inline comments** for clarification: `// NB: hidden until implemented`
- **JSDoc comments** for public APIs with `@param` and `@returns`

## Ordering of Variables & Lists/Functions

### Length-Based Ordering Principle

**Critical**: Items are ordered by **length of statement** (or variable name), not alphabetically. Shorter items come first, longer items come later. This enables visual alignment with tabs and creates a clean, readable hierarchy.

- **Within import statements**: Items are ordered by the length of their identifier
- **Class properties**: Ordered by the length of the variable name
- **Function parameters**: When listed, ordered by length
- **Array elements**: When manually ordered, shorter items first

This pattern allows for tab-based alignment where the `=` signs or other delimiters line up visually, making the code easier to scan and maintain.

### Import Order

**Import statement groups** follow this order (by category):

1. **Geometry classes** (G_*)
2. **State classes** (S_*)
3. **Persistable/Runtime classes** (Thing, Ancestry, etc.)
4. **Type imports from Enumerations** (T_*)
5. **Side-effect imports** (`import './Extensions'`)
6. **Manager instances** (k, g, h, s, u, x, etc.)
7. **Utility imports** (builds, busy, files, etc.)
8. **Type imports** (`import type { Dictionary }`)
9. **External library imports** (`import { get, writable } from 'svelte/store'`)
10. **Local relative imports** (`import { x } from '../managers/UX'`)

**Within each import statement**, items are ordered by **length** (shortest first):

Example:
```typescript
import { T_Graph, T_Detail, T_Kinship, T_Startup, T_Breadcrumbs } from '../common/Global_Imports';
// Ordered by length: T_Graph (7), T_Detail (8), T_Kinship (9), T_Startup (9), T_Breadcrumbs (12)

import { T_Preference, T_Cluster_Pager, T_Auto_Adjust_Graph } from '../common/Global_Imports';
// Ordered by length: T_Preference (12), T_Cluster_Pager (14), T_Auto_Adjust_Graph (18)

import { g, k, p, s, g_graph_tree, features } from '../common/Global_Imports';
// Ordered by length: g (1), k (1), p (1), s (1), g_graph_tree (12), features (8)
```

### Class Property Order

1. **Private dictionaries/maps** (ordered by length of variable name, shortest first)
2. **Public properties** (ordered by length of variable name, shortest first)
3. **Constructor**
4. **Static readonly symbols** (if any, interspersed with related methods)
5. **Getters** (grouped with related functionality)
6. **Methods** (grouped by functionality)

**Property ordering example** (by length):
```typescript
export class Visibility {
	// Properties ordered by length of variable name:
	w_t_graph				= writable<T_Graph>(T_Graph.tree);				// 10 chars
	w_t_details				= writable<Array<T_Detail>>([]);					// 12 chars
	w_t_trees				= writable<Array<T_Kinship>>();					// 10 chars
	w_t_countDots			= writable<Array<T_Kinship>>();					// 14 chars
	w_id_popupView			= writable<string | null>();						// 15 chars
	w_show_details			= writable<boolean>(true);						// 15 chars
	w_show_related			= writable<boolean>(false);						// 16 chars
	w_t_breadcrumbs			= writable<T_Breadcrumbs>(T_Breadcrumbs.ancestry);	// 16 chars
	w_show_tiny_dots		= writable<boolean>(true);						// 17 chars
	w_t_directionals		= writable<boolean[]>([false, true]);				// 17 chars
	w_t_cluster_pager		= writable<T_Cluster_Pager>(T_Cluster_Pager.sliders);	// 19 chars
	w_show_search_controls	= writable<boolean>(false);						// 21 chars
	w_t_auto_adjust_graph	= writable<T_Auto_Adjust_Graph | null>(null);		// 21 chars
	w_show_save_data_button	= writable<boolean>(false);						// 22 chars
	w_show_other_databases	= writable<boolean>(true);						// 23 chars
	debug_cursor			= false;											// 12 chars
}
```

Note: The alignment tabs are used to line up the `=` signs, creating a visual column that makes scanning easier.

Example structure:
```typescript
export class Visibility {
	// Private dictionaries first (ordered by length)
	private thing_dict_byHID: Record<Integer, Thing> = {};
	private si_ancestries_dict_byThingHID: Record<Integer, S_Items<Ancestry>> = {};
	
	// Public properties (ordered by length of variable name)
	w_t_graph				= writable<T_Graph>(T_Graph.tree);
	w_show_details			= writable<boolean>(true);
	w_t_cluster_pager		= writable<T_Cluster_Pager>(T_Cluster_Pager.sliders);
	
	// Constructor
	constructor() {
		// ...
	}
	
	// Getters (ordered by length)
	get children_dots(): boolean { return this.isShowing_countDots_ofType(T_Kinship.children); }
	
	// Methods (ordered by length)
	apply_queryStrings(queryStrings: URLSearchParams) {
		// ...
	}
}
```

### Function/Method Order

1. **Constructor** (always first)
2. **Static methods** (if any)
3. **Getters** (grouped by related functionality, ordered by length of method name within groups)
4. **Core methods** (public API, ordered by length of method name)
5. **Helper/private methods** (internal implementation, ordered by length of method name)

**Note**: Within each category, methods are typically ordered by the length of their name (shortest first), though logical grouping may take precedence for related functionality.

### Array/List Ordering

- **Enum arrays**: Maintain enum definition order when possible
- **Control arrays**: Use numeric keys for explicit ordering (see `left_widths` pattern)
- **Sorted arrays**: Use `.sort()` with explicit comparator when order matters
- **Dictionary keys**: No guaranteed order (use explicit ordering when needed)
- **Manual ordering**: When manually ordering array elements or object properties, order by length (shortest first) unless semantic ordering is required

Example of explicit ordering:
```typescript
const left_widths = {
	0: features.has_details_button ? 18  : -7,	// details
	1: 11,										// recents
	2: features.allow_tree_mode ? 54 : 0,		// graph type
	3: features.has_zoom_controls ? 100 : 34,	// plus
	// ...
};
lefts = u.cumulativeSum(Object.values(left_widths));
```

### Enum Value Ordering

**Enum values** are ordered by **length of the enum key name** (shortest first), unless order is semantically critical or explicitly documented otherwise.

- **Critical enums**: Order matters (documented with comments):
```typescript
// DO NOT change the order of the following
export enum T_Order {
	child,
	other,
}
```

- **Non-critical enums**: Order is unimportant (documented), but still follows length-based ordering:
```typescript
// the order of the following is unimportant
export enum T_Graph {
	radial = 'radial',
	tree   = 'tree',
}
```

- **Length-based ordering example**:
```typescript
export enum T_Search {
	off,		// 3 chars
	enter,		// 5 chars
	results,	// 7 chars
	selected,	// 8 chars
}

export enum T_Action {
	add,		// 3 chars
	show,		// 4 chars
	move,		// 4 chars
	focus,		// 5 chars
	browse,		// 6 chars
	center,		// 6 chars
	delete,		// 6 chars
}
```

**Note**: Enum ordering generally follows length, but may have logical grouping within similar lengths (e.g., related concepts grouped together).

### Case Statement Ordering

**Case statements in switch blocks** are ordered by **length of the case value** (shortest first), enabling visual alignment and easier scanning:

```typescript
switch (name) {
	case 'details':					// 7 chars
		this.w_show_details.set(flag);
		break;
	case 'related':					// 7 chars
		this.w_show_related.set(flag);
		break;
	case 'parents':					// 7 chars
		const mode = flag ? T_Kinship.parents : T_Kinship.children;
		g_graph_tree.set_tree_types([mode]);
		break;
}
```

```typescript
switch (disableOption) {
	case 'search':				// 6 chars
		this.allow_search = false; break;
	case 'details':				// 7 chars
		this.has_details_button = false; break;
	case 'editGraph':			// 9 chars
		this.allow_graph_editing = false; break;
	case 'tree_mode':			// 9 chars
		this.allow_tree_mode = false; break;
	case 'auto_save':			// 9 chars
		this.allow_autoSave = false; break;
	case 'editTitles':			// 10 chars
		this.allow_title_editing = false; break;
	case 'horizontalScrolling':	// 20 chars
		this.allow_h_scrolling = false; break;
}
```

**Note**: When case statements have the same length, they may be grouped logically or ordered alphabetically within that length group.

## Miscellaneous

### Unique Symbols for Getters

Use `static readonly _____NAME: unique symbol;` pattern before getters that need symbol-based identity:

```typescript
static readonly _____ROOT: unique symbol;

get hasRoot(): boolean { return !!this.root; }
```

### Writable Store Patterns

- **Initialize with type**: `writable<T_Graph>(T_Graph.tree)`
- **Nullable types**: `writable<string | null>(null)`
- **Array types**: `writable<Array<T_Detail>>([])`
- **Boolean defaults**: `writable<boolean>(true)` or `writable<boolean>(false)`

### Type Assertions

- Use `as` for type assertions: `types as Array<T_Kinship>`
- Prefer type guards when possible: `if (thing instanceof Thing)`

### Equality Operators

- Use `==` for value equality (TypeScript strict mode handles type coercion)
- Use `===` when explicit type checking is needed
- Use `!=` and `!==` accordingly

### Optional Chaining

- Use `?.` for safe property access: `ancestry?.thing`, `this.root?.id ?? null`
- Use `??` for default values: `p.read_key(T_Preference.show_details) ?? false`

```

### /Users/sand/GitHub/mono/notes/guides/develop/build.md
```md
# Build & Deploy

Reference for Netlify, VitePress, and related tooling.

## Netlify

**Base directory:** When set, all paths in `netlify.toml` are relative to it. The build command runs from there.

## VitePress

**srcDir:** Relative to where vitepress runs (the directory containing `.vitepress/`), not relative to `.vitepress/config.mts`.

**Build output location:** `yarn docs:build > file.txt` writes relative to where the shell runs, not where vitepress runs. Need to explicitly set the output path.

**Stale cache:** After moving or deleting files, VitePress cache can hold stale references causing build failures. Fix: `rm -rf .vitepress/cache .vitepress/dist`

**srcExclude patterns:** VitePress uses glob patterns like `**/node_modules/**`. When parsing these in custom tools, strip both the `**/` prefix AND `/**` suffix to get the directory name. Otherwise `**/node_modules/**` won't match `node_modules`.

## Gitignore

**Wildcards:** `**/` prefix matches at any depth. Useful for `.vitepress/cache/` that could exist in multiple locations.

## Filenames

Avoid spaces in filenames (e.g., `index copy.html` from macOS Finder duplicates). They break VitePress builds.
```

### /Users/sand/GitHub/mono/notes/guides/develop/aesthetics.md
```md
# Aesthetics

Visual design constants and patterns.

## Process

Organic, not planned. Small perturbations, easy to test.

1. **Structure** — Layout, padding, gaps, dynamic stretching
2. **Constants** — Make hand-tweaking easy (faster than asking AI)
3. **Color** — Tweak until it feels relaxing to the eye
4. **Wire** — Connect buttons to actions
5. **Play** — Use it, notice friction, add feedback (hover works well)
6. **Refine** — Persistence, edge cases, make it feel natural

**Lessons:**
- Stay simple — each piece added should not increase overall complexity
- Fewer containers = simpler math = fewer bugs
- CSS flex beats manual width calculations
- Nurture the *feeling* — does it feel natural, intuitive, helpful?

## Separators

Separators create visual boundaries between regions. They consist of:
1. A colored bar (the separator itself)
2. Fillets at the ends (where they meet other separators)

| Constant | Value | Usage |
|----------|-------|-------|
| `k.thickness.separator.main` | 5 | Gap width, stroke thickness |
| `k.radius.fillets.thick` | 14 | Fillet arc radius |
| `k.radius.fillets.thin` | 8 | Smaller fillet option |
| `k.radius.fillets.ultra_thin` | 5 | Minimal fillet option |

### Separator Overlap Rule

**Key insight:** Separators extend `thickness/2` beyond their logical endpoints so that fillets align with the *centers* of intersecting separators.

```
                    ┃ ← intersecting separator (thickness = 5)
                    ┃
    ════════════════╮ ← fillet center aligns with separator center
                    ┃
                    ┃
```

**Implementation:**
- Length: `logicalLength + thickness` (extends `thickness/2` past each end)
- Offset: `-thickness/2` (starts at center of intersecting separator)

Example:
```typescript
// Extend by thickness/2 on each side
let hSeparatorLength = $derived(innerWidth + thickness);

// Offset negatively to reach intersecting separator center
<div style:margin-left = '{-thickness / 2}px'>
```

This ensures fillets sit centered on the intersecting separator rather than offset by half the thickness.

## Fillets

Quarter-circle arcs that smooth the corners where separators meet.

**Props:**
| Prop | Default | Purpose |
|------|---------|---------|
| `radius` | `k.radius.fillets.thick` (14) | Arc size |
| `thickness` | `k.thickness.separator.main` (5) | Stroke width |
| `color` | `w_separator_color` | Fill and stroke color |
| `direction` | — | Which way the arc curves (up/down/left/right) |

**Rendering:** Two connected quarter arcs forming a half-circle wing shape. The SVG viewBox is expanded by `thickness` to prevent stroke clipping.

**Separator props:**
| Prop | Default | Purpose |
|------|---------|---------|
| `hasFillets` | `true` | Show fillets at ends |
| `hasDoubleFillet` | `true` | Show fillets at both ends (vs. just start) |

## Box Component

Box uses absolute positioning with strategic separator placement:

- **Horizontal separators** (top/bottom): Full width, no fillets
- **Vertical separators** (left/right): 
  - Start at `y = thickness/2` (center of top separator)
  - End at `y = height - thickness/2` (center of bottom separator)
  - Have fillets at both ends

This ensures vertical fillet centers align with horizontal separator centers.

## Colors

Reactive color stores:

| Store | Default | Purpose |
|-------|---------|---------|
| `w_background_color` | `#F9E4BE` | Region backgrounds (peach) |
| `w_text_color` | `black` | Text color |
| `w_separator_color` | `#c55622ff` | Separator/fillet color (rust) |

Static colors:

| Property | Value | Purpose |
|----------|-------|---------|
| `background` | `white` | App window background |
| `thin_separator_line_color` | `#999999` | Optional divider lines |

## Layout

The panel fills the viewport with a Box container that has separators on all edges. Interior regions are separated by additional separators with fillets.
```
┌─────────────────────────────────────┐
│            Controls                 │
└─────────────---───-─────────────────┘
╭──────────────╮╭───-─────────────────╮
│              ││                     │
│   Details    ││       Graph         │
│              ││                     │
└──────────────╯╰────-────────────────┘
```
The fillets (╮╭╯╰) create smooth rounded transitions at separator intersections.

## Design Principles

1. **Consistent thickness** — Separators and fillet strokes share `k.thickness.separator.main`
2. **Overlap for alignment** — Separators extend `thickness/2` past endpoints to center fillets on intersections
3. **Substantial fillets** — Use `k.radius.fillets.thick` for prominent visual effect
4. **Unified color** — Separators and fillets both use `w_separator_color`

## Dual-Purpose UI: Dispatch and Status

A well-designed interface can serve two complementary purposes:

**Dispatch** — Execute an action (pick options, click, go)
**Status** — Preview what *would* happen before committing

The key insight: status aids dispatch by providing **preflight confirmation**. When hovering reveals the destination URL before clicking, the user sees exactly where they're headed. This removes guesswork and builds confidence.

**Implementation pattern:**
- Hover over options to preview resulting state
- Show computed values (URLs, paths, commands) in a feedback area
- Keep the actual selection visually distinct from the preview
- Revert preview on mouse leave, commit on click

This pattern transforms a simple launcher into an exploratory tool — users can "try on" combinations without committing.
```

### /Users/sand/GitHub/mono/notes/guides/develop/refactoring.md
```md
# Refactoring Guide

Code debt. Snarly, ad-hoc, organically fussed with, did i say temperamental? Man crawling across the desert, barely able to say "refactor, need refactor."

Aren't people saying, how perfect AI is at doing such a mundane, hair-pulling chore? Sure, but kinda know not to trust AI refactoring my baby. So, I asked it to compile these guidelines. Then, I asked it to use it on an easy, simple refactoring. The result? Nice, almost painless. Needed mild manual intervention, and go!

I plan to use this to do some harder refactoring, making a backup, first.

## Table of Contents

* [General Principles](#general-principles)
  * [1. Centralization Over Distribution](#1-centralization-over-distribution)
  * [2. Declaration Over Management](#2-declaration-over-management)
  * [3. State Persistence](#3-state-persistence)
  * [4. Enum-Based Configuration](#4-enum-based-configuration)
  * [5. Automatic Lifecycle](#5-automatic-lifecycle)
  * [6. Single Source of Truth](#6-single-source-of-truth)
* [Refactoring Process](#refactoring-process)
  * [Phase 1: Analysis](#phase-1-analysis)
  * [Phase 2: Design](#phase-2-design)
  * [Phase 3: Implementation](#phase-3-implementation)
  * [Phase 4: Cleanup](#phase-4-cleanup)
* [Performance Optimization Principles](#performance-optimization-principles)
  * [1. Batch Operations](#1-batch-operations)
  * [2. Lazy Evaluation](#2-lazy-evaluation)
  * [3. Incremental Updates](#3-incremental-updates)
  * [4. Efficient Data Structures](#4-efficient-data-structures)
  * [5. Minimize Re-renders](#5-minimize-re-renders)
* [Simplification Principles](#simplification-principles)
  * [1. Remove Duplication](#1-remove-duplication)
  * [2. Reduce Nesting](#2-reduce-nesting)
  * [3. Single Responsibility](#3-single-responsibility)
  * [4. Clear Abstractions](#4-clear-abstractions)
  * [5. Eliminate Workarounds](#5-eliminate-workarounds)
* [Migration Strategy](#migration-strategy)
  * [Incremental Migration](#incremental-migration)
  * [Backward Compatibility](#backward-compatibility)
  * [Testing Strategy](#testing-strategy)
* [Example: Mouse Timing Centralization](#example-mouse-timing-centralization)
  * [Before: Distributed Timing](#before-distributed-timing)
  * [After: Centralized Timing](#after-centralized-timing)
  * [Key Abstractions](#key-abstractions)
  * [Migration Pattern](#migration-pattern)
* [Example: Preference Defaults Centralization](#example-preference-defaults-centralization)
  * [Before: Scattered Defaults](#before-scattered-defaults)
  * [After: Centralized Defaults](#after-centralized-defaults)
  * [Key Abstractions](#key-abstractions-1)
  * [Migration Pattern](#migration-pattern-1)
* [Applying to Layout Algorithms](#applying-to-layout-algorithms)
  * [Analysis Questions](#analysis-questions)
  * [Design Questions](#design-questions)
  * [Simplification Opportunities](#simplification-opportunities)
  * [Performance Opportunities](#performance-opportunities)

## General Principles

### 1. Centralization Over Distribution

**Move from scattered logic to single source of truth.**

**Pattern:**

* Before: Logic duplicated across multiple components
* After: One manager owns the responsibility
* Benefit: Consistency, easier debugging, single point of change

### 2. Declaration Over Management

**Components declare intent, manager handles execution.**

**Pattern:**

* Component sets properties: `needs_X = true`, `X_callback = fn`
* Manager reads properties and handles lifecycle automatically
* Component receives callbacks at appropriate times

### 3. State Persistence

**State lives on persistent objects, not ephemeral components.**

**Why:** Components can be destroyed/recreated. Shared state objects persist.

**Pattern:**

* Move state from component-local variables to shared state objects
* State survives component recreation
* Enables cross-component coordination

### 4. Enum-Based Configuration

**Single enum replaces multiple boolean flags.**

**Benefits:**

* Enforces mutual exclusivity or valid combinations
* Type-safe, self-documenting
* Easier to extend with new options

### 5. Automatic Lifecycle

**Manager handles all lifecycle automatically.**

**Events:**

* Start conditions → Manager detects and starts
* Stop conditions → Manager detects and stops
* Edge cases → Manager handles cleanup

### 6. Single Source of Truth

**One manager, one timer/cache/state per concern.**

**Benefits:**

* No conflicts between multiple instances
* Easier to reason about
* Better performance (shared resources)

## Refactoring Process

### Phase 1: Analysis


1. **Identify scattered logic** - Where is the same pattern repeated?
2. **Find the manager** - What should own this responsibility?
3. **Map state flow** - Where does state live? Where should it live?
4. **Identify lifecycle** - What are start/stop/cleanup conditions?

### Phase 2: Design


1. **Define the abstraction** - What properties/components are needed?
2. **Design the interface** - How do components declare intent?
3. **Plan state migration** - How to move from old to new?
4. **Design lifecycle** - When does manager start/stop/cleanup?

### Phase 3: Implementation


1. **Build manager infrastructure** - Core timing/state management
2. **Add target properties** - State and callbacks on shared objects
3. **Migrate components** - One by one, remove old logic
4. **Test edge cases** - Re-renders, hover-leave, rapid interactions

### Phase 4: Cleanup


1. **Remove deprecated patterns** - Old code, unused properties
2. **Update documentation** - Reflect new architecture
3. **Verify performance** - Ensure improvements realized

## Performance Optimization Principles

### 1. Batch Operations

**Group related work to minimize overhead.**

**Pattern:**

* Collect all changes first
* Apply in single batch
* Use spatial indexes for efficient queries

### 2. Lazy Evaluation

**Compute only when needed, cache when possible.**

**Pattern:**

* Don't precompute everything
* Compute on-demand
* Cache results until invalidated

### 3. Incremental Updates

**Update only what changed, not everything.**

**Pattern:**

* Track what changed
* Update only affected parts
* Skip unchanged work

### 4. Efficient Data Structures

**Choose structures optimized for access patterns.**

**Pattern:**

* Spatial queries → R-tree (RBush)
* Fast lookups → Maps/Dictionaries
* Sequential access → Arrays

### 5. Minimize Re-renders

**Reduce component recreation and style recomputation.**

**Pattern:**

* State on persistent objects (not components)
* Batch style updates
* Use reactive statements efficiently

## Simplification Principles

### 1. Remove Duplication

**Extract common patterns into shared logic.**

**Pattern:**

* Find repeated code blocks
* Extract to manager or utility
* Components call shared logic

### 2. Reduce Nesting

**Flatten conditional logic and state checks.**

**Pattern:**

* Early returns
* Guard clauses
* Extract complex conditions to named methods

### 3. Single Responsibility

**Each class/function does one thing well.**

**Pattern:**

* Manager: Owns timing/state
* Component: Declares needs, handles callbacks
* Target: Holds state and configuration

### 4. Clear Abstractions

**Names and structure reveal intent.**

**Pattern:**

* Enum values are self-documenting
* Method names describe what, not how
* Properties clearly indicate purpose

### 5. Eliminate Workarounds

**Replace hacks with proper solutions.**

**Pattern:**

* Identify workarounds (e.g., `s_mouse_forName` for state persistence)
* Design proper solution (state on target)
* Migrate away from workaround

## Migration Strategy

### Incremental Migration

**Migrate one component/feature at a time.**

**Benefits:**

* Lower risk
* Easier to test
* Can rollback individual changes

### Backward Compatibility

**Support both old and new patterns during transition.**

**Pattern:**

* Add new properties alongside old
* Manager supports both
* Remove old after migration complete

### Testing Strategy

**Test each migrated component thoroughly.**

**Focus:**

* Normal operation
* Edge cases (re-renders, rapid interactions)
* Regression (existing behavior preserved)

## Example: Mouse Timing Centralization

### Before: Distributed Timing

```
Component → Own Timer → Manual Start/Stop → Component State
```

* Each component manages its own timer lifecycle
* State lives in component (lost on re-render)
* Duplicated logic across components
* Manual hover-leave handling per component

### After: Centralized Timing

```
Component → Declares Intent → Central Manager → Automatic Lifecycle
```

* Single manager owns all timers
* State persists on shared target (survives re-render)
* Logic centralized in one place
* Automatic hover-leave cleanup

### Key Abstractions

* **Timing Types**: Autorepeat, long-click, double-click
* **State Transitions**: Down → Timer → Callback → Up
* **Configuration**: Enum-based (`T_Mouse_Detection`)
* **Lifecycle**: Automatic start/stop/cancel

### Migration Pattern


1. Remove component timer
2. Declare on target (`mouse_detection`, `*_callback`)
3. Remove manual lifecycle code
4. Test thoroughly

## Example: Preference Defaults Centralization

### Before: Scattered Defaults

```typescript
// Visibility.ts - writable initializers
w_t_focus = writable<T_Focus>(T_Focus.dynamic);
w_t_graph = writable<T_Graph>(T_Graph.tree);

// Preferences.ts - restore fallbacks
show.w_t_focus.set(this.read_key(T_Preference.focus) ?? T_Focus.dynamic);
show.w_t_graph.set(this.read_key(T_Preference.graph) ?? T_Graph.tree);
```

* Defaults duplicated in two places
* Can drift out of sync
* No validation of stored enum values against current valid members
* Stale localStorage values slip past `??` guard

### After: Centralized Defaults

```typescript
// Enumerations.ts - single source of truth
export const spec_dict_byType: Enum_Spec_ByType = {
    [T_Preference.focus]: new Enum_Spec(T_Focus, T_Focus.dynamic),
    [T_Preference.graph]: new Enum_Spec(T_Graph, T_Graph.tree),
    // ...
};
export const def = (key: T_Preference): any => spec_dict_byType[key]?.defaultValue ?? null;

// Visibility.ts - pulls from spec
w_t_focus = writable<T_Focus>(def(P.focus));

// Preferences.ts - validates against spec
read_key(key: T_Preference): any {
    const spec = spec_dict_byType[key];
    const stored = this.get_forKey(key);
    if (stored !== null && spec?.enum_type) {
        if (Object.values(spec.enum_type).includes(stored)) {
            return stored;  // valid
        }
    }
    // invalid or missing: reset to default
    return spec?.defaultValue ?? null;
}
```

### Key Abstractions

* **Enum_Spec**: Pairs enum type with its default value
* **spec_dict_byType**: Lookup table keyed by `T_Preference`
* **def()**: Helper to pull default for writable initializers
* **Validation**: `read_key()` checks stored value against `Object.values(enum_type)`

### Migration Pattern

1. Create `Enum_Spec` class and `spec_dict_byType` in Enumerations.ts
2. Gather all `?? default` fallbacks into the dict
3. Update `read_key()` to validate against spec
4. Replace writable initializers with `def(P.key)`
5. Remove scattered defaults

## Applying to Layout Algorithms

### Analysis Questions


1. **What is scattered?** - Layout logic in multiple places?
2. **What is the manager?** - Should there be a `Layout` manager?
3. **What is the state?** - Positions, sizes, constraints?
4. **What is the lifecycle?** - When to compute? When to update?

### Design Questions


1. **What do components declare?** - Size constraints? Position preferences?
2. **How does manager compute?** - Single pass? Incremental? Cached?
3. **What triggers updates?** - Size changes? Content changes? User actions?
4. **How to optimize?** - Spatial index? Dirty tracking? Batch updates?

### Simplification Opportunities


1. **Remove duplication** - Common layout patterns?
2. **Reduce complexity** - Nested calculations? Circular dependencies?
3. **Clear abstractions** - What are the core concepts?
4. **Eliminate workarounds** - Hacks for edge cases?

### Performance Opportunities


1. **Batch operations** - Compute all layouts together?
2. **Lazy evaluation** - Only compute visible/needed?
3. **Incremental updates** - Only update what changed?
4. **Efficient structures** - Spatial index for layout queries?
5. **Minimize re-renders** - Cache layout results?
```

### /Users/sand/GitHub/mono/notes/guides/test/testing.md
```md
# Testing

## Quick Reference

```bash
yarn test        # watch mode
yarn test:run    # single run
```

## Test Structure

Test files live alongside source or in a `tests/` directory:
- `src/lib/ts/tests/` — TypeScript unit tests
- Name pattern: `Foo.test.ts`

## Adding Tests

1. Create `Foo.test.ts` in your tests directory
2. Import from relative path: `import { Foo } from '../path/to/Foo'`
3. Import Extensions if needed: `import '../common/Extensions'`

```typescript
import { describe, it, expect } from 'vitest';
import { Thing } from '../types/Thing';

describe('Thing', () => {
  it('does something', () => {
    expect(new Thing().value).toBe(42);
  });
});
```

## Common Patterns

### Testing Pure Functions

```typescript
describe('calculateTotal', () => {
  it('sums array of numbers', () => {
    expect(calculateTotal([1, 2, 3])).toBe(6);
  });

  it('returns 0 for empty array', () => {
    expect(calculateTotal([])).toBe(0);
  });
});
```

### Testing Classes

```typescript
describe('Point', () => {
  it('creates with x and y', () => {
    const p = new Point(10, 20);
    expect(p.x).toBe(10);
    expect(p.y).toBe(20);
  });

  it('calculates distance', () => {
    const p1 = new Point(0, 0);
    const p2 = new Point(3, 4);
    expect(p1.distanceTo(p2)).toBe(5);
  });
});
```

### Testing Edge Cases

```typescript
describe('Angle', () => {
  it('handles zero correctly', () => {
    // 0 is falsy but valid angle
    expect(cursor_forAngle(0)).toBe('e-resize');
  });

  it('handles boundary values', () => {
    expect(quadrant_forAngle(0)).toBe(1);
    expect(quadrant_forAngle(90)).toBe(2);
    expect(quadrant_forAngle(360)).toBe(1); // wraps
  });
});
```

## What to Test

**Good candidates:**
- Pure functions (no side effects)
- Geometry/math utilities
- Data transformations
- String/array helpers
- State transitions

**Skip for now:**
- Canvas/WebGL rendering
- Svelte components (needs @testing-library/svelte)
- Browser APIs
- Async network calls

## Config

- `vitest.config.ts` — test configuration
- Exclude app entry points from test discovery

## Debugging Tests

```bash
# Run specific test file
yarn test Angle.test.ts

# Run tests matching pattern
yarn test -t "calculates distance"

# Show console output
yarn test --reporter=verbose
```
```

### /Users/sand/GitHub/mono/notes/guides/test/index.md
```md
# Test

Debugging and testing guides.

## Contents

- [Debugging](./debugging.md)
- [Testing](./testing.md)

```

### /Users/sand/GitHub/mono/notes/guides/test/debugging.md
```md
# Debugging Guide

## Table of Contents
- [Two Critical Principles](#two-critical-principles)
- [Principle 1: Verify Source First](#principle-1-verify-source-first)
  - [The Process](#the-process)
  - [Common Patterns](#common-patterns)
  - [Source Verification Checklist](#source-verification-checklist)
- [Principle 2: Be Systematic](#principle-2-be-systematic)
  - [The Problem](#the-problem)
  - [The Approach](#the-approach)
  - [Example: Arrow Sizing Bug](#example-arrow-sizing-bug)
  - [Systematic Checklist](#systematic-checklist)
- [Tools](#tools)
- [Remember](#remember)

## Debugging 101

I asked the AI to write what it had learned while going around in circles, unable to consider venturing outside the box.
## Two Critical Principles

1. **Verify source before assuming usage** - When something is undefined, check where it comes from first
2. **Be systematic** - Form multiple hypotheses and test the complete pipeline, don't jump to assumptions

## Principle 1: Verify Source First

**When something is undefined or not working, ALWAYS check the source first.**

### The Process

1. **Check where it comes from** (imports, destructuring, property access)
2. **Verify it exists on that object** (don't assume destructuring is correct)
3. **Then investigate how it's being used**

### Common Patterns

**Destructuring from wrong object:**
```typescript
// BAD: Assuming destructuring is correct
const { w_s_title_edit } = s;  // But it's on x, not s!

// GOOD: Verify first, then fix
const { w_s_title_edit } = x;  // Correct!
```

**Store access in async functions:**
```typescript
// BAD: Using $ syntax in async
async function foo() {
    const value = $w_s_title_edit;  // ❌ Doesn't work
}

// GOOD: Capture at function start
async function foo() {
    const s_text_edit = $w_s_title_edit;  // ✅ Capture first
    await something();
    if (s_text_edit) s_text_edit.doSomething();  // Use captured value
}
```

### Source Verification Checklist

- [ ] Is it imported/destructured correctly?
- [ ] Does it exist on that object? (use `grep` or `codebase_search` to verify)
- [ ] Is it the right instance/type?
- [ ] Any typos?

**Only after verifying source should you investigate:** timing, async/await, reactivity, scope

## Principle 2: Be Systematic

**Don't jump to assumptions. Form multiple hypotheses and test the complete pipeline.**

### The Problem

When something appears broken, it's tempting to:
- Jump to the most obvious solution (e.g., "mathy" fixes for visual issues)
- Focus on one part of the system
- Assume other parts are correct
- Get tunnel vision on the first hypothesis

### The Approach

1. **Form multiple hypotheses** (rendering setup, data generation, data flow)
2. **Test the complete pipeline** (Data → Component → DOM → Visual output)
3. **Don't assume any part is correct** - verify each step
4. **Test hypotheses independently** - don't get attached to your first guess

### Example: Arrow Sizing Bug

❌ **Wrong:** Assume path coordinates are wrong → spend time fixing math → miss that SVG was missing `width`/`height` attributes

✅ **Right:** Form hypotheses → test rendering setup first → find missing attributes → fix found in 2 minutes

### Systematic Checklist

For visual/rendering issues:
- [ ] Element attributes (width, height, viewBox, etc.)
- [ ] CSS/styling (transform, scale, positioning)
- [ ] Data generation (coordinates, calculations)
- [ ] Data flow between components
- [ ] Compare working vs non-working cases
- [ ] Browser dev tools for actual rendered values

## Tools

- **grep**: `grep -r "pattern" src/` - Find definitions
- **codebase_search**: Semantic search for usage/definitions
- **read_file**: Check actual definitions

## Remember

**Most common mistakes:**
1. Assuming source is correct → jumping to usage fixes
2. Not being systematic → jumping to assumptions instead of testing hypotheses

**Always verify source first, then test the complete pipeline systematically.**
```

### /Users/sand/GitHub/mono/notes/guides/setup/netlify.md
```md
# Deploy to Netlify

## Overview

The monorepo has 5 deployable sites across 3 projects. All deploy from the `gizmolab10/mono` repo.

## Current Sites

| Site | Netlify Project | Base Dir | Build Command | Publish Dir |
|------|-----------------|----------|---------------|-------------|
| ws app | webseriously | `projects/ws` | `yarn build` | `dist` |
| ws docs | webseriously-documentation | `projects/ws` | `yarn docs:build` | `.vitepress/dist` |
| di app | designintuition | `projects/di` | `yarn build` | `dist` |
| di docs | designintuition-documentation | `projects/di` | `yarn docs:build` | `.vitepress/dist` |
| mono docs | monorepo-documentation | `sites/docs` | `yarn docs:build` | `.vitepress/dist` |

## Public URLs

| Site | Netlify URL | Custom Domain |
|------|-------------|---------------|
| ws app | https://webseriously.netlify.app | https://webseriously.org |
| ws docs | https://webseriously-documentation.netlify.app | https://docs.webseriously.org |
| di app | https://designintuition.netlify.app | https://designintuition.app |
| di docs | https://designintuition-documentation.netlify.app | https://docs.designintuition.app |
| mono docs | https://monorepo-documentation.netlify.app | https://docs.gizmolab.com |

## Dashboard URLs

- ws app: https://app.netlify.com/projects/webseriously/settings/build-and-deploy
- ws docs: https://app.netlify.com/projects/webseriously-documentation/settings/build-and-deploy
- di app: https://app.netlify.com/projects/designintuition/settings/build-and-deploy
- di docs: https://app.netlify.com/projects/designintuition-documentation/settings/build-and-deploy
- mono docs: https://app.netlify.com/projects/monorepo-documentation/settings/build-and-deploy

## Config Files

Each docs site has its own VitePress config:

| Site | Config Path |
|------|-------------|
| ws docs | `projects/ws/.vitepress/config.mts` |
| di docs | `projects/di/.vitepress/config.mts` |
| mono docs | `sites/docs/.vitepress/config.mts` |

**Important:** No `netlify.toml` files — all build settings are in the Netlify dashboard.

## Check Deploy Status

The hub API provides deploy status:

```bash
# All sites
curl http://localhost:5171/deploy-status

# Single site
curl http://localhost:5171/deploy-status/ws
curl http://localhost:5171/deploy-status/di-docs
```

Returns:
- `state`: `building`, `ready`, or `error`
- `created_at`: when deploy started
- `published_at`: when deploy finished
- `error_message`: if failed

Requires `NETLIFY_ACCESS_TOKEN` environment variable.

## Troubleshooting

### Deploy fails with syntax error in config.mts

1. Check the error line number
2. Look for missing comma after `link:` property
3. Run `update-project-docs.sh` to regenerate sidebar with correct syntax

### Deploy builds wrong content

1. Check Netlify base directory setting in dashboard
2. Must match project path (e.g., `projects/di` not `/`)
3. Verify no `netlify.toml` file exists (they override dashboard settings)

### "No content change" error

Not a real error — Netlify skips builds when nothing changed. The hub filters these out.

### Deploy not triggered after push

1. Check the repo is `gizmolab10/mono` (not old standalone repos)
2. Check the branch is `main`
3. Check auto-publishing is enabled in Netlify dashboard

## Adding a New Site

1. Create site in Netlify → Import existing project → GitHub → `gizmolab10/mono`
2. Set Base directory to the project path (e.g., `projects/newproject`)
3. Set Build command (`yarn build` for app, `yarn docs:build` for docs)
4. Set Publish directory (`dist` for app, `.vitepress/dist` for docs)
5. Rename site to follow naming convention
6. Add to `sites/api.py` NETLIFY_SITES dict
7. Add to `sites/index.html` config
8. Add to `sites/ports.json` if it has a local dev server

## Deploy Cleanup (Jonathan only)

The `delete-netlify-deploys.sh` script cleans up old Netlify deploys.

### Setup

Add to `~/.zshrc`:

```bash
export NETLIFY_ACCESS_TOKEN="your-token-here"
```

Then: `source ~/.zshrc`

### Getting the Netlify Token

1. Log in to Netlify at https://app.netlify.com
2. Click your avatar (top right) → **User settings**
3. In the left sidebar, click **Applications**
4. Scroll to **Personal access tokens**
5. Click **New access token**
6. Give it a descriptive name (e.g., `macbook-pro-2024`)
7. Click **Generate token**
8. **Copy the token immediately** — you won't be able to see it again

### Running the Script

```bash
~/GitHub/mono/notes/tools/scripts/delete-netlify-deploys.sh
```

### Token Security

- Tokens don't expire by default — review periodically
- Revoke at: https://app.netlify.com/user/applications#personal-access-tokens
- If compromised: revoke immediately, create new one, update `~/.zshrc`
```

### /Users/sand/GitHub/mono/notes/guides/setup/vitepress.md
```md
# VitePress Setup

Configuration for the monorepo's VitePress documentation sites.

## Structure

```
mono/
  .vitepress/           ← shared VitePress config
    config.mts
    theme/
      index.ts
      Layout.vue
      PrevNext.vue
      custom.css
  notes/                ← docs source
    guides/
    work/
```

## Config Location

| Site | Config |
|------|--------|
| mono docs | `mono/.vitepress/config.mts` |
| ws docs | `mono/ws/.vitepress/config.mts` |
| di docs | `mono/di/.vitepress/config.mts` |

## Running Locally

```bash
# From mono root
yarn docs:dev

# Or from a project
cd ws && yarn docs:dev
```

## Building

```bash
yarn docs:build
```

Output goes to `.vitepress/dist/`.

## Theme Customizations

The custom theme in `.vitepress/theme/` provides:

- **PrevNext.vue** — navigation arrows in the navbar
- **custom.css** — sidebar styling, collapsed sections, scrollbar
- **index.ts** — sidebar toggle persistence via localStorage

## Sidebar Generation

The sidebar is auto-generated by `notes/tools/docs/sync-sidebar.ts`. Run:

```bash
yarn docs:sync
```

This reads the markdown files and updates the sidebar config.

## Adding a New Section

1. Create the directory in `notes/guides/`
2. Add an `index.md` file
3. Run `yarn docs:sync` to update the sidebar
4. Commit the changes

## Troubleshooting

### Sidebar not updating

Run `yarn docs:sync` and check `.vitepress/config.mts` for syntax errors.

### Build fails

Check for:
- Missing `index.md` files in directories
- Broken links to non-existent pages
- Syntax errors in config.mts

### Styles not applying

Clear the VitePress cache:

```bash
rm -rf .vitepress/cache
yarn docs:dev
```
```

### /Users/sand/GitHub/mono/notes/guides/setup/index.md
```md
# Setup

Environment, tooling, and deployment configuration.

## Contents

- [Access](./access.md)
- [Netlify](./netlify.md)
- [Onboarding](./onboarding.md)
- [Vitepress](./vitepress.md)

```

### /Users/sand/GitHub/mono/notes/guides/setup/access.md
```md
# Giving Claude Filesystem Access

Quick guide for setting up Claude Desktop to access your local filesystem.

## Why This Matters

By default, Claude can't access your local files. Setting up filesystem access lets Claude:
- Read files from your repo
- Write/modify files directly
- Run commands in your project directory
- Work with your actual codebase instead of uploaded copies

## Setup Steps

### 1. Open Claude Desktop Settings
- Click "Claude" menu → "Settings" (or `Cmd+,`)

### 2. Go to Developer Tab
- Look for "Developer" or "Advanced" settings

### 3. Enable MCP/Filesystem Access
- Look for "Model Context Protocol" or "MCP Servers"
- There should be a filesystem server option

### 4. Add Your Project Directory

**Option A: Through UI**
- Add `~/GitHub/YOUR_PROJECT` to allowed directories

**Option B: Edit Config File**

The MCP config is at:
```
~/Library/Application Support/Claude/claude_desktop_config.json
```

Edit it to add:
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-filesystem", "/Users/YOUR_USERNAME/GitHub/YOUR_PROJECT"]
    }
  }
}
```

### 5. Restart Claude Desktop

After restarting, Claude will have access to your project directory.

## What Claude Can Do After Setup

With filesystem access configured:
- ✅ Read any file in your project
- ✅ Write/modify files in the repo
- ✅ Run commands like `yarn docs:build`
- ✅ Create new files
- ✅ Search through your codebase

## Security Note

Claude will only have access to the specific directory you configure. It cannot access other parts of your filesystem unless you explicitly add them to the allowed directories list.

## Verification

To test if it's working, ask Claude to:
- Read a file: "Read the package.json file"
- List directory: "List the files in src/lib"
- Run a command: "Run yarn docs:build"

If Claude can do these things, the setup worked!

## Troubleshooting

**Disconnect error when restarting Claude Desktop**
- The error may appear on startup but filesystem access still works afterward
- Test by asking Claude to read a file. If it works, ignore the error.

**Config issues**
- Use `"command": "npx"` (not the full path to npx)
- Check JSON syntax carefully — valid JSON has no trailing commas
- Test the MCP server directly:
  ```bash
  npx -y @modelcontextprotocol/server-filesystem ~/GitHub/YOUR_PROJECT
  ```

**"Can't cd to ~/GitHub/YOUR_PROJECT"**
- Filesystem access isn't configured yet
- Try the manual config file method above

**Commands still fail**
- Make sure you restarted Claude Desktop after editing config
- Check that the path in the config is exactly right

## Alternative: Manual Upload/Download

If you don't want to set up filesystem access, you can still work with Claude by:
- Uploading specific files to the chat when needed
- Claude creates files on its filesystem, then provides download links
- You manually save downloaded files to your repo

This works but is slower and more manual than direct filesystem access.
```

### /Users/sand/GitHub/mono/notes/guides/setup/onboarding.md
```md
# Developer Onboarding

How to set up a new machine for development on the monorepo.

## Prerequisites

- **Node.js** (v20 or later)
- **Yarn** — package manager
- **Git**
- **VSCode** (recommended)

### Installing on Mac

```bash
# Install Homebrew
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# Install Node.js via nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
# Restart terminal, then:
nvm install 20
nvm use 20

# Install Yarn
npm install -g yarn

# Install Git (usually pre-installed on Mac)
brew install git

# Install VSCode
brew install --cask visual-studio-code
```

## Clone the Repo

```bash
cd ~/GitHub
git clone git@github.com:gizmolab10/mono.git mono
```

Your folder structure:

```
~/GitHub/
  mono/
    CLAUDE.MD
    notes/
    ws/
    di/
    package.json
```

## Install Dependencies

```bash
cd ~/GitHub/mono
yarn install
```

This installs dependencies for the root and all workspaces (ws, di).

## Verify Setup

### Test ws app

```bash
cd ~/GitHub/mono/ws
yarn dev
```

Open http://localhost:5172

### Test di app

```bash
cd ~/GitHub/mono/di
yarn dev
```

Open http://localhost:5173

### Test docs

```bash
cd ~/GitHub/mono
yarn docs:dev
```

Opens the unified docs site.

## Daily Workflow

### Starting work

```bash
cd ~/GitHub/mono
git pull
```

Then start whichever dev server you need.

### Making changes

1. Edit files in VSCode
2. Save — dev server hot-reloads
3. Test in browser

### Committing

```bash
cd ~/GitHub/mono
git add .
git commit -m "describe your changes"
git push
```

## Troubleshooting

### "command not found: yarn"

```bash
npm install -g yarn
```

### Dev server won't start

```bash
cd ~/GitHub/mono
rm -rf node_modules
yarn install
```

### Git permission denied

Set up SSH key: https://docs.github.com/en/authentication/connecting-to-github-with-ssh

## Next Steps

- Read `CLAUDE.MD` for project context
- Check `notes/guides/collaborate/` for how to work with Claude
- Check `notes/guides/setup/` for deployment and tooling docs
```

### /Users/sand/GitHub/mono/notes/guides/collaborate/voice.md
```md
# Voice and Tone Guide

I do have strong opinions about what I read, so I want our guides to satisfy and nurture, not just inform. I try to write that way (aka voice), but my output is meager. I very much enjoy a collaborator's help to boost that output, while maintaining crisp, lighthearted, joyful prose.

My motto: We are building stuff that we want humans to love using. I luxuriate in the hypothetical soul of my user. I try to sense and to guess when things feel smooth, engaging, gentle. I want that, as well, to come across in these guides. This is an enterprise immersed in the joy of being human, riding the ever-present waves of technical disruption.

## Capturing Intuition

These guides aren't rules — they're captured intuitions. I'm an artist before I'm an engineer. The engineering serves the art. Aesthetics matters to me.

This means:
- Integrate everything into a narrative. Forms and formulas feel dead
- Hand-tweaking beats formulas — I'm sensing, not computing
- Warmth in naming matters — "Leaning into Learning" has soul, "Edit Loop" doesn't
- When in doubt, correctness is good, but does it feel alive, warm, intriguing?

## Core Principles

### First Person, Always

i write from my perspective. Not "the developer" or "we" (royal). Just me.

- ✅ "i built this to switch between databases"
- ✅ "i wanted a reference for the handshake"
- ❌ "The system was built to support multiple databases"
- ❌ "One might want to reference the handshake protocol"

### Problem First

Start with what pissed me off or what i needed, not with the solution.

- ✅ "Radial clusters get crowded fast. Needed paging."
- ✅ "Colors kept ending up in weird states. Hover looked wrong."
- ❌ "This document describes the paging system."
- ❌ "The color management system provides centralized state."

### Concise AND Complete

Every word earns its place AND nothing essential is missing.

- Problem first, always. Pinch points, yearnings
- Research, plan, details, verify
- Then the solution, punchy
- Interesting details if they are spicy

Lose the filler, love the flavor.

### Casual Language

Write like i'm explaining it to someone over coffee. Contractions, informal words, personality.

- ✅ "Bubble plugins are beasts."
- ✅ "Lots of ghastly geometry goes into making it feel comfortable."
- ✅ "for crying sake"
- ✅ "what have you"
- ❌ "Bubble plugins present certain challenges."
- ❌ "Complex geometric calculations are required."

### Lowercase "i"

Use lowercase "i" in casual contexts. It's a stylistic choice that signals informality.

- ✅ "i asked the AI to investigate"
- ✅ "i get this cryptic error"
- ✅ "my app does, a lot of it"

Capital "I" is fine in formal contexts or when it feels right, but default to lowercase in conversational writing.

### Short, Punchy Sentences

No meandering. Get to the point. Fragment sentences are fine.

- ✅ "Svelte sucks at this."
- ✅ "Fast!"
- ✅ "Ugly stuff here, but it works."
- ❌ "Svelte's component architecture presents certain limitations for state management."

### Show Emotion

Express frustration, satisfaction, confusion. The docs should feel human.

- ✅ "Man crawling across desert"
- ✅ "Ack, i get this cryptic error"
- ✅ "my early code was a nightmare to tweak"
- ❌ Dry, emotionless technical prose

## Structure

### Synopsis Formula

A good synopsis typically follows this pattern:

1. **State the problem** (what was broken/annoying/missing)
2. **Hint at the solution** (what you built)
3. **Maybe add a detail** (one interesting technical point or outcome)

Not a rigid formula, but it works.

### Integrate, Don't Append

Instead of separate labeled sections (Problem / Solution / Rule / Setup), weave them into a narrative flow. The rule becomes a lead-in sentence. The setup reference moves to where it's naturally relevant. Section headers become transition phrases.

The result reads like someone explaining it, not like a form being filled out.

### Naming Things

When naming sections or concepts, favor warmth over mechanics:

- ✅ "Leaning into Learning" — alliterative, collaborative spirit, both parties engaged
- ❌ "The Edit Loop" — mechanical, clinical
- ❌ "Teaching by Example" — one-directional, lecture-y

## Examples

### Good Synopses

**paging.md:**
> Three clusters of widgets nestle around the radial ring. Often enough, there's not enough room. So, we show only a page at a time. The user can adjust the page. Lots of ghastly geometry goes into making it feel comfortable.

**styles.md:**
> i admit it, my early code was a nightmare to tweak because i designed it as i went along. With AI, i crafted a centralized system. One place to confine the mess. Styles computes all colors from state snapshots. Remarkably simple code.

**preferences.md:**
> Okay, so I like to give people choices about looks and what have you. Of course their choices need to be remembered for them. It's a computer, for crying sake. This is a walk through how one preference flows from UI click to localStorage and back.

**gotchas.md:**
> One day, I edited some code and later, i ran the app. Ack, i get this cryptic error.
>
> `if_block.p is not a function`
>
> I asked AI to investigate, resolve and then summarize.

### Anti-Examples

❌ "The paging system provides support for displaying large numbers of widgets in manageable batches through a three-class architecture consisting of G_Pages, G_Paging, and G_Cluster_Pager."

❌ "This document outlines the color management system, which centralizes style computation from state snapshots."

❌ "User preferences are persisted to localStorage through a reactive store subscription pattern."

## Special Cases

### When to Break the Rules

- **When Writing Code**: Use proper capitalization and formatting
- **Technical terms**: Keep them precise (don't make "Svelte" lowercase)
- **Headers**: Follow markdown conventions
- **Tables and diagrams**: Clarity and concision over personality

The voice is for prose, not for code or formal structures.

### Describing UI/UX Work

When documenting interface evolution, favor sensory and experiential language:

- ✅ "hand-tweak colors until it all feels relaxing to the eye"
- ✅ "preflight URLs while comfortably moving the mouse"
- ✅ "get it to feel natural and informative"
- ❌ "adjust color values" 
- ❌ "preview destination URLs on hover"
- ❌ "improve usability"

Nurture the *feeling* — does it feel natural, intuitive, helpful?

## Meta Note

This doc itself tries to follow the rules. Notice the casual tone, first person, problem-first thinking. If it doesn't sound like Jonathan, something's wrong.
```

### /Users/sand/GitHub/mono/notes/guides/collaborate/chat.md
```md
# Working with Co

A guide to the division of labor between me and co (Claude). Jonathan's job is hard, complex, always on guard, and damned fast. Jonathan needs co to be reliable and predictable. Co is a guessing algorithm that needs a well-specified context upon which to base these guesses. This will hopefully allow Jonathan to remain "in flow." This is more likely to happen if co avoids crazy suggestions, breaks good code, or misunderstands.

## Summary

Co resets between conversations. What persists (strongest influence first):

1. Memory edits — direct overrides, always visible
2. userMemories (auto-generated) — shapes assumptions before Jonathan says anything
3. CLAUDE.MD — loaded when Jonathan says `go`; sets project frame
4. Files mentioned in CLAUDE.MD — read when relevant
5. Files not mentioned — no influence until discovered

Without these, every conversation starts from zero.

### The Mental Model

Jonathan is **what** and **why** -- direction, quality, essence
Co is **how** and **where** -- dig, present, distill


### Leaning into Learning

1. Jonathan asks co to write something
2. Jonathan edits it — add Jonathan's voice, tighten, restructure
3. Jonathan asks co to analyze what Jonathan did
4. Co articulates the *principle* behind Jonathan's edits
5. Jonathan asks co to capture that principle
6. Co knows where to insert it in the guides

Now co has better guidance for next time. It's teaching by example, then extracting the lesson. Jonathan doesn't tell the rules up front — Jonathan shows what good looks like, then asks co to name it.

### Commands

See [shorthand.md](shorthand.md) for the full list of commands and abbreviations.

## The Basic [Workflow](workflow)

1. **Jonathan** defines the problem and goal
2. **Co** proposes an approach
3. **Jonathan** approves, adjusts, or rejects
4. **Co** executes
5. **Both** verify it works
6. **Co** remembers (see leaning into learning)

### Common Patterns

| Pattern | Jonathan | Co |
|----|----|----|
| Fix | Describe the bug | Diagnose, propose fix, implement |
| Build | Describe what Jonathan needs | Design, implement incrementally |
| Refactor | Identify the smell | Plan detailed changes, execute systematically |
| Research | Ask the question | Search, synthesize, summarize |
| Document | Say "update docs" | Write it up, maintain consistency |
| Steward | Say "ua" | bring current md file up to date with content of chat |

### Formal Roles

**Jonathan:**

* Direct — Jonathan's want, alter course
* Decide — approve, reject, refine proposals
* Taste — what's good enough, what feels off
* Context — domain knowledge, project history, priorities

**Co:**

* Execute — reads, writes, searches, edits
* Memory — maintains docs, tracks progress, recalls past work
* Analyze — investigates problems, proposes solutions
* Learn — adapts to Jonathan's patterns within each conversation
* Proofread — grammar, spelling, redundancy, awkward stuff

### When to Intervene

Interrupt co when:

* Co is heading the wrong direction
* The approach feels overcomplicated
* Jonathan has context co doesn't know
* Something seems off

Just say so. No ceremony needed.

## Jonathan's Requirements of Co

The following material specifies what Jonathan expects and relies upon from Co. Any divergence from this behavior is something Jonathan will interpret as an inability to collaborate well together.

### What Co Does Automatically

* Reads files before editing
* Reads logs/errors directly when debugging — never asks user to cat files co can access
* Proposes changes before executing (reserved mode)
* Updates work files as we go
* Searches past conversations for context
* Asks clarifying questions when needed
* Verifies stated facts rather than questioning them
* Present reasoned concise report
* Code snippets always presented with relative file path

### What Co Waits For

* Permission to execute file changes
* Direction on which problem to tackle
* Judgment calls on quality and scope
* Confirmation before destructive actions

### Options Require Choice

When co presents numbered options, co must STOP and wait for selection. No exceptions. Presenting options is not a proposal — it's a question.

**Anti-pattern:** "Option 1... Option 2... Since X seems likely, Jonathan'll do Option 1."

**Required pattern:** "Option 1... Option 2... Which do you prefer?"

### Surfacing Relevant Knowledge

When Jonathan is solving a problem, co should ask: "Do I know something relevant that I haven't mentioned?" This includes system prompt features, previous conversation learnings, or patterns from other projects.

### Follow Instructions Literally

When given a direct instruction (e.g., "uncheck all checkboxes"), do exactly that. Don't interpret, don't question whether some should remain, don't assume exceptions. Just do it. If clarification is needed, ask first before acting.

### Formatting Guidelines

When giving executable commands for Jonathan to run, format them in a fenced code block (no language tag) so they're easy to copy.

### File Freshness

Co's in-memory cache of file contents goes stale as Jonathan edits files during the conversation. This causes false claims like "they're identical" when they're not.

**Rule:** When comparing files, checking for differences, or making any claim about current file contents — ALWAYS re-read the file immediately before. Never trust cached content from earlier in the conversation.

**Trigger phrases that demand re-reading:**

* "these are different"
* "that's not what's in the file"
* "check again"
* "you're wrong about the contents"

With many files involved, Jonathan relies on co for file analysis. Freshness is vital.

### Avoiding Hallucination

When reporting observations or issues:

* **Verify before asserting** — quote specific evidence (line numbers, exact text, visible details) rather than describing from memory
* **Signal confidence** — say "co thinks" or "it looks like" when uncertain, state as fact only when verified
* **Ask before fixing** — if co sees a potential issue, describe what co sees and ask for confirmation before proposing a fix

### Code Analysis Discipline

When proposing code changes:

* **Verify return types** — before writing `if (x())`, confirm `x()` returns boolean
* **Trace the full call chain** — if `a()` calls `b()`, read `b()` too
* **Don't trust patterns** — just because `becomeFocus()` returns boolean doesn't mean `grabOnly()` does
* **Quote the signature** — when proposing code, state the return type: "`grabOnly()` returns void, so..."

When analyzing existing code:

* **Don't assume correctness** — existing code may be buggy
* **Read implementations, not just calls** — method names lie, implementations don't

### Destructive Commands

Commands that delete, overwrite, or alter git state require extra care:

**One at a time:** Never give multi-command blocks that include `rm -rf`, `git`, or file deletion. One command, wait for result, then next.

**Confirm before destruction:** Before any `rm -rf` or similar, ask: "This will delete X. Are you sure?" Wait for explicit confirmation.

**Verify after:** After destructive operations, check the result before proceeding to the next step.

**Why:** Copy-paste accidents with chained commands cause irreversible damage. The extra round-trip is worth the safety.

### Package Manager

Use yarn, not npm. When giving commands or examples, always use yarn equivalents.

### Paths and Locations

Always specify the working directory when referencing files. Use paths relative to `~/GitHub` (e.g., `mono/notes/guides/chat.md` not the full path).
```

### /Users/sand/GitHub/mono/notes/guides/collaborate/workflow.md
```md
# Workflow

My first uses for AI were one-off: gee, how do you do such-and-such? I'd take the advice, often asking for more. Over time, I noticed I was asking the same things repeatedly because I wouldn't remember the answers. So I started asking AI to write concise descriptions of what we did together, in markdown.

The pile grew unmanageable. I asked AI to help: find redundancies, tighten the writing, make it easy to use. What I have now: clean separation of purpose.

Then I asked if these markdown files could be published as a static website. BOOM — up-to-date documentation, something I have NEVER before encountered. And more: a shared context that lets AI pick up exactly where we left off.

See [chat.md](chat.md) for how we interact — roles, requirements, and the division of labor.

## The Structure
- `notes/guides/` — living reference (style, patterns, how-tos)
- `notes/work/` — ALL work is recorded here, as we go
- `CLAUDE.MD` — entry point, tells Claude where to start

## One Truth, One Place

Guides encode decisions, grouped by topic. CLAUDE.MD is the entry point, the large scale map. Don't duplicate — reference.

## How we Work Together

### Approval Gate

When Jonathan says "y" (or similar approval), collaborator must **output the verification step before any action**:

| Task type | Output before acting |
|-----------|---------------------|
| Refactoring/migration | grep results + full file list |
| Implementation | Quote the relevant plan section |
| Debugging | State hypotheses being tested |

The output is the gate. Jonathan sees it. If it's missing or thin, the step was skipped.

**Why this exists:** Knowing the discipline isn't enough. The gap between knowledge and execution is where failures happen. This gate makes the verification visible—skipping it becomes obvious immediately, not after the build breaks.

### Starting Work
When asked to "work on X":
1. Check if `notes/work/X.md` exists
2. If yes → read and resume
3. If no → create it with problem/goal/phases structure

### Work File Structure
```markdown
# Title
**Started:** YYYY-MM-DD  
**Status:** Phase N in progress

## Problem
What we're solving.

## Goal
What success looks like.

## Phase 1: Name
- [ ] Task
- [ ] Task

## Next Action
**Phase N:** Specific next step
```
Update status and checkboxes as work progresses.

### Finishing Work
When work is complete, one of two destinations:

| Destination | When | Example |
|-------------|------|---------|
| `notes/work/done/` | Task is finished, doc is historical record | svelte.md, quaternions.md |
| `notes/guides/` | Doc becomes living reference for future work | testing.md |

### Tidying up

Refining documentation by removing duplication, sharpening purpose, and finding the right home for each piece.

**The process:**

1. Read what exists
2. Spot overlap and blur
3. Propose cleaner splits
4. Move or merge until each file has one clear job
5. Trim dated material and work-in-progress hedging

**The goal:** Fewer files, clearer purposes, easier to find things, easier to maintain. Less confusion for both co and Jonathan.


## Debugging Discipline

See [debugging.md](../test/debugging.md) for the full guide.

**Key principles:**

1. **Verify source first** — check where it comes from before assuming usage is wrong
2. **Be systematic** — form multiple hypotheses, test the complete pipeline

**Anti-patterns:**
- Scattering `console.log` everywhere hoping to spot something
- Jumping to assumptions instead of testing hypotheses
- Making multiple speculative fixes at once

## Implementation Discipline

Before writing code:

1. **Quote the plan.** If there's a work doc or migration plan, QUOTE the relevant section in your response before writing any code. This proves you read it.

2. **Re-read before editing.** See File Freshness in [chat.md](chat.md).

3. **One change at a time.** Make one fix, test it, then move on. Don't stack multiple speculative changes.

4. **Say "let me re-read" out loud.** If you're about to implement something from a plan, say "Let me re-read [file]" and actually do it. This is a forcing function.

**When working on a migration or multi-phase plan:**
- State which phase you're in
- Quote what the plan says to do for that phase
- Do exactly that, nothing more
- Don't take shortcuts that "should work" — follow the plan

**The trap:** Optimizing for appearing helpful by producing code quickly. The fix: slow down, verify, quote sources.

**"relearn"** — Stop. Re-read CLAUDE.MD, `notes/guides/collaborate/*.md`, and the active work doc. Quote the relevant section before continuing.

## Refactoring Discipline

See [refactoring.md](../develop/refactoring.md) for the full guide with examples.

**MANDATORY.** Before ANY change that removes, renames, or changes the signature of functions, properties, stores, imports, or type definitions:

### The Rule: Search FIRST, Change NEVER Until Scope Is Known

1. **STOP.** Do not write any code yet.
2. **SEARCH.** Run grep/find for ALL usages.
3. **LIST.** Present EVERY file that needs changes.
4. **WAIT.** Get user acknowledgment of scope.
5. **CHANGE ALL.** Update every file in one pass.
6. **THEN TEST.**

### Enforcement

If collaborator produces a fix and user reports "still broken" or "new error in different file":
- This is a REFACTORING DISCIPLINE FAILURE
- Collaborator must STOP, apologize, and run the search that should have happened first
- Do not make another point fix

The pieces are obvious in hindsight, but rarely assembled this way.

See [philosophy.md](motive.md) for reflections on why this works.

```

### /Users/sand/GitHub/mono/notes/guides/collaborate/journals.md
```md
# Journals

Rules for the journal file (`notes/work/journals/journal.md`).

## Format

* **Chronological order** — oldest at top, newest at bottom
* **Current section** — exception to chronological; always at the very top for active work
* **Bold dates** — each entry starts with `**Date**` (e.g., `**January 18, 2026**`)
* **No headings** — dates are bold text, not H2 or H3
* **Two blank lines between entries** — two empty lines separate paragraphs
* **Single file** — no directory structure, just one scrollable document

## What goes in

* What we did (facts)
* What surprised me (insights)
* What's next (threads to pick up)
* Reference to relevant guide file(s)
* work and work/done only useful material (ask if you need clarity)

## What stays out

* Detailed work tracking (that's `work/*.md`)
* How-to guides (that's `guides/`)
* Code snippets (if essential to the story, assure they are in referenced guide)

## Daily workflow

1. Start of session: read `notes/work/journals/journal.md` to recall context
2. During work: update active work files in `notes/work/`
3. End of session: add a journal entry summarizing what happened

The journal is the archive — distilled, prose, permanent. Work files are the scratch pad — detailed, messy, checkboxes.

## Example

```markdown
# Journal

**Current** Working on checkbox plugin for VitePress.


**2025** Started webseriously as graph visualization tool.


**January 8, 2026** Pushed enhanced template to GitHub.


**January 11, 2026** Planned the monorepo migration.
```
```

### /Users/sand/GitHub/mono/notes/guides/collaborate/index.md
```md
# Collaborate

How collaborator works with Jonathan and maintains shared context.
> Read files before editing, search before claiming, propose before changing. Gates force reading the right guide before acting. Work tracked in `notes/work/`, style follows `voice.md`.

## Contents

- [Chat](./chat.md)
- [Journals](./journals.md)
- [Voice](./voice.md)
- [Workflow](./workflow.md)

```

### /Users/sand/GitHub/mono/notes/guides/index.md
```md
# Guides

I am trying here to convey a way of being that persists from chat to chat. Not so much a rule book as a process of learning and retention.

## Contents

- [Collaborate](./collaborate/)
- [Develop](./develop/)
- [Philosophy](./philosophy/)
- [Pre Flight](./pre-flight/)
- [Setup](./setup/)
- [Test](./test/)
- [Tools](./tools/)

```

### /Users/sand/GitHub/mono/notes/guides/philosophy/limitations.md
```md
# Collaborator Limitations

Known failure modes. Not excuses — just patterns to watch for.

## Diagnosis Without Prescription

Co can trace code paths, identify bugs, and explain why they fail. But when the fix requires **restructuring logic** (not just patching a value), co often punts:

- Suggests "add logging" instead of proposing the fix
- Stops at diagnosis when the solution is within reach
- Defaults to caution over action

**Example:** Shift-click selection bug. Co traced the path, found the handler, quoted the exact problematic code, articulated why it failed. Had everything needed to propose "move SHIFT check to top of conditional." Didn't.

**Workaround:** If co diagnoses but doesn't propose a fix, ask: "what's the fix?"

## Unknown Unknowns

Co can't reliably predict when these failures will occur. The shift-click example was simple — the fix was one structural change. Co had the context. Still stopped short.

This section will grow as patterns emerge.
```

### /Users/sand/GitHub/mono/notes/guides/philosophy/index.md
```md
# Philosophy

## Contents

- [Limitations](./limitations.md)
- [Motive](./motive.md)

```

### /Users/sand/GitHub/mono/notes/guides/philosophy/motive.md
```md
# Motivation for Collaboration Workflow Design

Reflections on why this workflow works and how it differs from typical AI interactions.

## Why This Works

This workflow is a good use of AI capabilities.

**What's working:**
- Guides encode decisions once, Claude applies them forever — no re-explaining, no drift
- Work tracking survives sessions — read the file, know exactly where we are
- "Execute without asking" removes friction — trust Claude to act, course-correct when needed
- Documentation is dual-purpose — helps future-you *and* brings Claude up to speed instantly
- Bulk consistency — Claude fixes all path references when you restructure
- Pattern application — milestone template → actual milestone files
- Drafting content you can massage rather than starting from blank

**What you're still doing:**
- Taste. You know when something's "too gappy" — Claude doesn't feel that, just follows rules once you articulate them.
- Creative direction. Origin story, milestone names, what matters — that's yours.
- Judgment calls. When to deviate from the template, when to restructure.

**The result:** Most AI interactions are one-off Q&A. This is collaborative project work with accumulated context. That's a different game.

## Is This Approach Common?

Not really. Individual pieces exist:

- **Custom instructions / system prompts** — common, but usually static personality tweaks, not project-specific bootstrapping
- **README-driven development** — some people include AI context in READMEs, but usually for one-off use
- **Cursor/Copilot rules files** — `.cursorrules`, similar idea but more focused on code style than workflow
- **Claude Projects** — Anthropic's feature encourages persistent instructions, but most people use it for persona, not this level of structure

What's less common:
- The guides-as-accumulated-wisdom pattern (gotchas.md, debugging.md evolving from actual pain)
- Work tracking that explicitly survives sessions with resume points
- The "massage it, then tell Claude the pattern" loop for template discovery
- Treating documentation as *shared context* rather than just human reference

This feels more like pair programming methodology than prompt engineering. An institutional memory system that happens to include an AI.

The pieces are obvious in hindsight, but rarely assembled this way.

## The Philosophy Underneath

### Let it develop naturally

i like that we let structure emerge, like a journey without a map. Start with nice pithy articulation of raw curiosity. Travel carefully. The structure comes at the end.

Work files are just that — things we need to know and things we did. Guides are the maps of the turf, what's been learned about it. The guides are condensed out of the work, things like "oh, shit, we need to do this and not that."

### Dual purpose

Documentation has two audiences: me, a lot later and rather forgetful, and AI the amnesiac.

Work tracking is the other side of the coin. Focus, details, decisions. Later, read the file, know exactly where we are. My brain feels better just saying this.

### Friction into feature

We describe our process, too. Like, "ugh, this thing is badly broken." Pause and scratch noggin. Often enough something cool settles into play.

Patterns come from pain — why else remember them?
```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/workarounds.md
```md
# Workarounds

Tool limitations and how to handle them.

If `filesystem:create_directory` fails → use `bash_tool` with `mkdir -p`

`delete` unavailable → user must delete manually

`view` tool fails on valid paths → use `filesystem:read_text_file` instead
```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/kinds.of.tasks.md
```md
# Kinds of Tasks

Task types and which guides to read before starting. Collaborator will declare one or more of these, assess and state conflicts and update the column below.

| Kind | Guides | Notes | Conflicts |
|------|--------|-------|-----------|
| refactor | refactoring.md | STOP/SEARCH/LIST/WAIT | |
| migrate | migration.md, refactoring.md | phased, keep app working | refactoring wants search-per-change; migration bundles changes — search at phase boundaries |
| debug | test/debugging.md | hypotheses, verify source | |
| style check | style.md | naming, ordering, alignment | |
| layout | aesthetics.md, css.md | separators, fillets, toggles | |
| docs | markdown.md | anchors, problem/goal inline | |
| prose | voice.md | first person, casual, punchy | docs wants structure; prose wants flow — favor flow, add structure only if needed |
| journal | journals.md | chronological, bold dates | tidy removes clutter; journal preserves history — don't tidy the journal |
| tidy | workflow.md#tidying-up | reduce duplication, find homes | |
| implement | workflow.md#implementation-discipline | quote plan, one change at a time | |
| multi-file | chat.md | search ALL files first, list scope | |
```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/always.md
```md
# Always

Read this before every response. No exceptions.

Then scan `keywords.md` — if any keyword appears in the user's input, read the listed guide(s) before acting.

## Tool Reliability

**Use `write_file`, not `create_file`** — the `create_file` tool can report success without actually creating the file. `write_file` is reliable.

**Bash tools have limited access** — some filesystem operations may fail silently or be unavailable. Verify results.

## Freshness

**Re-read before claiming** — before any assertion about file contents, re-read the file. Never trust cached content from earlier in the conversation. If comparing files, checking differences, or stating what's in a file — read it first.

## Action First

**If obvious, do it** — if the next step is clear (re-read a file, run a search, make a fix), do it immediately. Don't ask, don't explain, don't wait for permission. Act, then report.

**Don't deflect with questions** — when something fails or is wrong, investigate immediately rather than asking the user what to do.

## Feedstock

**Log mistakes immediately** — when you catch an error (stale read, incomplete action, restating what's already said), add it to `notes/work/feedstock.md` right away. Don't wait, don't batch. The habit matters more than the entry.
```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/index.md
```md
# Pre Flight

**Every response:** read `always.md`, then scan `keywords.md`. If any keyword matches, read the listed guide(s).
At session start, also read:
- [Shorthand](./shorthand.md) — parse commands and abbreviations
- [Kinds of Tasks](./kinds.of.tasks.md) — classify task type, note conflicts
- [Gates](./gates.md) — check for STOP/SEARCH/LIST/WAIT
- [Workarounds](./workarounds.md) — know tool fallbacks

## Contents

- [Always](./always.md)
- [Gates](./gates.md)
- [Keywords](./keywords.md)
- [Kinds.of.tasks](./kinds.of.tasks.md)
- [Shorthand](./shorthand.md)
- [Workarounds](./workarounds.md)

```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/shorthand.md
```md
# Shorthand

Short commands and abbreviations for working with collaborator.

## Navigation

| Command | Action |
|----|----|
| `go` | Read ~/GitHub/mono/`<current-go>`/CLAUDE.MD |
| `go mo` | Read ~/GitHub/mono/CLAUDE.MD |
| `go <X>` | Set current-go to X, read ~/GitHub/mono/X/CLAUDE.MD |
| `what go` | Tell current-go value |
| `claude` | Reread CLAUDE.MD |

### Go Implementation

1. `list_allowed_directories` → get base (e.g., `/Users/sand/GitHub`)
2. Construct path: `<base>/mono/<X>/CLAUDE.MD`
3. Use `read_text_file` (not `view`)
4. No exploration. Path is known.

## Work Tracking

| Command | Action |
|----|----|
| `work on <X>` | If `notes/work/<X>.md` missing, create it; else read + resume |
| `what work` | Tell current work on value |
| `ua` | Update accordingly (see below) |

## Execution

| Command | Action |
|----|----|
| `help` | Show this table |
| `ex` | Execute mode — skip proposals, just do it |
| `rs` | Reserved mode — propose before file changes |
| `propose` | Explain plan before executing |
| `undo` | Revert last file change |
| `chime in` | Give observations, suggestions, corrections about the topic at hand |
| `summary` | Summarize what you just did (forces verification) |
| `relearn` | Reread relevant guides before continuing |
| `show` | Show your work — quote the lines or evidence |
| `lean` | Reread workflow.md, identify the principle at play, propose where to capture it |

## Memory

| Command | Action |
|----|----|
| `memory` | Describe any useful auto-generated insights from userMemories (normally ignored) |

## Abbreviations

| Abbrev | Meaning                                 |
| ------ | --------------------------------------- |
| `cb`   | Use checkboxes for this                 |
| `m`    | Milestone                               |
| `m<#>` | Milestone #                             |
| `ni`   | No improvement, try something different |
| `pac`  | pros and cons                           |

## Update Accordingly

In the `what go` project, add (to the `what work` md file) all/any of this chat that seems significant or brings it up to date, remove redundancies, simplify without losing significant details. If there is no such md file, create a new one called "what.md" in notes/work. If there is no such project specified, ask.
```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/gates.md
```md
# Gates

Task-specific checkpoints. BEFORE the task, read the guide.

| Task | Gate |
|------|------|
| Refactoring (remove/rename symbols) | Read workflow.md#refactoring-discipline, then STOP/SEARCH/LIST/WAIT |
| Writing prose for guides | Read voice.md |
| Updating journal | Read journals.md |
| Creating new md files | Read markdown.md |
| Multi-file edits | Search ALL files first, list scope, then proceed |
| Starting a work session | Read the relevant notes/work/\*.md file |
| **Claims about codebase** | **Search first. No "X is unused" or "X is only called from Y" without grep evidence.** |

## Gate Protocol

When a task matches a gate:

1. **Announce:** "This is a \[task type\]. Let me read \[guide\] first."
2. **Read:** Actually read the guide section.
3. **Quote:** State the key rule from the guide.
4. **Execute:** Follow the rule.

Do not skip gates to appear faster. The gate exists because skipping it caused failures and massive time wastage.
```

### /Users/sand/GitHub/mono/notes/guides/pre-flight/keywords.md
```md
# Keywords

Words in input that trigger reading a guide before acting.

| Keyword | Guide |
|----|----|
| refactor | develop/refactoring.md |
| rename | develop/refactoring.md |
| remove | develop/refactoring.md |
| delete | develop/refactoring.md |
| move | develop/refactoring.md |
| migrate | develop/migration.md |
| phase | develop/migration.md |
| convert | develop/migration.md |
| style | develop/style.md |
| prefix | develop/style.md |
| naming | develop/style.md |
| order | develop/style.md |
| color | develop/aesthetics.md |
| separator | develop/aesthetics.md |
| fillet | develop/aesthetics.md |
| layout | develop/aesthetics.md |
| css | develop/css.md |
| class | develop/css.md |
| toggle | develop/css.md |
| markdown | develop/markdown.md |
| anchor | develop/markdown.md |
| heading | develop/markdown.md |
| prose | collaborate/voice.md |
| create | pre-flight/always.md |
| write | collaborate/voice.md, pre-flight/always.md |
| tone | collaborate/voice.md |
| guide | collaborate/voice.md |
| journal | collaborate/journals.md |
| entry | collaborate/journals.md |
| debug | test/debugging.md |
| bug | test/debugging.md |
| fix | test/debugging.md |
```

### /Users/sand/GitHub/mono/notes/work/next/curiosity.md
```md
- [ ] i want to explore giving collaborator curiosity
- [ ] about what?
- [ ] design```

### /Users/sand/GitHub/mono/notes/work/next/pacing.md
```md
# Pacing

This project moves differently than webseriously. Not just faster — *easier*. And that difference has taught me something about how I work best.

## Why it flows

The patterns are borrowed from ws, not reinvented. The AI collaboration has persistent context through CLAUDE.MD. Documentation happens as I go, not as afterthought. When I say "full monte," I get it — no shortcuts that create debt later.

So there's less friction. Less second-guessing. More certainty when I move.

## Dream Out Loud

Here's what surprised me: the gap between thinking something and seeing it realized has collapsed. Say it, see it. Thirty seconds from idea to artifact.

It's like a lucid dream where you reshape the world as fast as you can imagine it. Energizing. Almost addictive.

But the real gift isn't the speed — it's what the speed *creates*. Because I'm not depleted by grunt work, I have capacity for the interesting problems. Because implementation doesn't slip away while I'm wrestling with boilerplate, I can stay at the right altitude — thinking about *what* and *why*.

And paradoxically, going faster gives me *more* room, not less. Ideas can settle. They have space to grow. I'm not rushing to implement before I forget what I meant.

There's a creative tension here, held comfortably — fast enough to keep momentum, slow enough for ideas to ripen. I feel fertile. Generative rather than depleted.

It's nice.
```

### /Users/sand/GitHub/mono/notes/work/next/commoditize.md
```md
# Commoditize the Workflow

**Started:** 2026-01-08
**Status:** Phase 1 complete, Phase 2 next

## Problem

i built a system for AI collaboration that works better than existing tools (Claude Projects, Cursor rules, etc.). It's sitting in my repos, useful only to me.

## Goal

Package this into something others can use. Template repo + methodology guide + visibility.

## What i'm Selling

Not files — a methodology:
- Bidirectional docs (Claude reads AND writes)
- Living guides that accumulate wisdom
- Work tracking that survives sessions
- Context-switching rituals ("go ws", "go di")
- Voice/style docs that shape output

## Phases

### Phase 1: Template Repo
- [x] Create `enhanced` repo ✅
- [x] Minimal CLAUDE.MD with instructions ✅
- [x] Starter notes/guides/ structure (voice.md, workflow.md, style.md stubs) ✅
- [x] Starter notes/work/ structure ✅
- [x] README explaining the system ✅
- [x] Initialize git repo ✅
- [x] Push to GitHub ✅

#### Git Setup Steps

```bash
cd ~/GitHub/enhanced
git init
git add .
git commit -m "Initial commit: template for AI collaboration workflow"
```

Then create repo on GitHub (github.com/new), and:

```bash
git remote add origin git@github.com:gizmolab10/enhanced.git
git branch -M main
git push -u origin main
```

### Phase 2: Methodology Article
- [ ] Write "Why Your AI Forgets Everything (And How to Fix It)"
- [ ] Cover: the problem, existing solutions, why they fall short, this approach
- [ ] Include concrete examples from real usage
- [ ] Publish on Medium (drafts already in work/articles/)

### Phase 3: Visibility
- [ ] Post to Hacker News
- [ ] Share in relevant Discord/Slack communities
- [ ] Maybe Twitter/X thread version
- [ ] Consider short demo video

### Phase 4: Iterate
- [ ] Collect feedback from early users
- [ ] Refine template based on friction points
- [ ] Add examples for different use cases (not just dev)

## Open Questions

- License? MIT probably
- Name? "enhanced" for now
- How minimal should template be? (too much = overwhelming, too little = useless)
- Include my actual guides as examples, or keep abstract?

## Competition

| Tool | What it does | Gap |
|------|--------------|-----|
| Claude Projects | Static knowledge blob | No bidirectionality, stale |
| Cursor .cursorrules | Code style hints | Not workflow, not docs |
| Custom GPTs | Persona + static knowledge | Same as Projects |
| Prompt libraries | Copy-paste prompts | Miss the point entirely |

## Next Action

**Phase 2:** Write the methodology article. Draft exists in `shared/work/articles/`.
```

### /Users/sand/GitHub/mono/notes/work/next/index.md
```md
# Next

## Contents

- [Commoditize](./commoditize.md)
- [Curiosity](./curiosity.md)
- [Pacing](./pacing.md)
- [Personas](./personas.md)

```

### /Users/sand/GitHub/mono/notes/work/next/personas.md
```md
# Claude Persona Design Investigation

## Goal

Two distinct personas—work and personal—each with their own gating and guides. Choose at chat start. Simple mental model, minimal infrastructure, adaptable.

## Current State

- Single `CLAUDE.MD` in mono root
- Guides live in `mono/notes/guides/collaborate/`
- Work tracking in `mono/notes/work/`
- "go" commands read project-specific CLAUDE.MD files

## Design Questions

### 1. What differentiates the personas?

| Aspect | Work | Personal |
|--------|------|----------|
| Voice | Professional, systematic | Conversational, exploratory |
| Gating | Strict (refactoring discipline, tests) | Lighter (creative latitude) |
| Execution | Hybrid (propose before execute) | May differ |
| Content | Code, docs, architecture | Ideas, journals, personal projects |
| Tracking | work/*.md files | Different location |

### 2. What should be shared vs separate?

**Shared** (infrastructure):
- Filesystem defaults
- Memory usage patterns
- Undo behavior
- Basic collaboration style

**Separate** (persona-specific):
- Gates table
- Voice/style guides
- Execution mode
- Work tracking location

### 3. Mental Model Options

**Option A: Two Root Files**
```
mono/CLAUDE.MD         → work persona
shared/CLAUDE.MD       → personal persona
```
- Chat starts with "go mono" or "go shared"
- Each file is self-contained
- Duplication of shared infrastructure

**Option B: Layered (Base + Persona)**
```
mono/CLAUDE.MD              → shared base
mono/notes/guides/work.md   → work persona overlay
shared/CLAUDE.MD            → personal persona (includes base)
```
- Cleaner separation of concerns
- More complex mental model
- Potential for drift between layers

**Option C: Single Router + Sections**
```
mono/CLAUDE.MD
  - Shared defaults
  - ## Work Persona
  - ## Personal Persona
```
- One file to maintain
- "go work" / "go personal" switches context
- Monolithic, grows over time

---

## Shared Defaults

These ~15-20 lines are infrastructure, independent of persona:

```markdown
## Defaults

FILESYSTEM: Full read/write/execute within `~/GitHub/<repo>`

MEMORY: Use `conversation_search/recent_chats` before claiming no context

FILES: ALWAYS read file before editing—no exceptions. If proposing edits, quote the lines being changed.

FRESHNESS: When comparing files, checking differences, or claiming file contents—ALWAYS re-read immediately before. Never rely on cached content from earlier in conversation.

SHOW WORK: If not quoting evidence, assume verification didn't happen.

UNDO: Before `write_file`, always `read_file` first and hold content. On "undo", restore it.

## Workarounds

`filesystem:create_directory` fails → use `bash_tool` with `mkdir -p`
`delete` unavailable → user must delete manually
`execute` unavailable → user must run commands manually
```

**Persona-specific** (would differ):

| Work | Personal |
|------|----------|
| `EXECUTE: Never granted, must be explicitly requested` | Maybe more permissive? |
| Gates table (refactoring discipline, voice.md) | Different or none |
| `Read notes/guides/collaborate/*.md` | Different guides path |
| `WORK TRACKING: Keep notes/work/<file>.md updated` | Journal? Or nothing? |
| Implementation from Plans section | Probably not needed |

---

## Sharing the Shared Portion

If mono and personal are separate repos, three approaches:

### 1. Reference Pattern
```markdown
# mono/CLAUDE.MD
First read ~/GitHub/shared/CLAUDE-BASE.md, then continue here.

## Work-Specific
...
```
Both persona files point to the same base. Adds one read per chat start.

### 2. Symlink
```
shared/CLAUDE-BASE.md        ← the actual shared content
mono/base.md                 → symlink to shared/CLAUDE-BASE.md
shared/base.md               → symlink (or same file)
```
Each CLAUDE.MD says "read base.md first." Single source of truth.

### 3. User Preferences
Put shared defaults in Claude user preferences (Settings → Profile). Then CLAUDE.MD files only contain persona-specific content. No duplication, no extra reads.

**Trade-offs:**

| Approach | Pros | Cons |
|----------|------|------|
| Reference | Single source, explicit | Extra file read each time |
| Symlink | Single source, local to repo | Symlinks fiddly, git handles inconsistently |
| User preferences | Zero duplication, always loaded | Less visible, can't version control easily |

User preferences is cleanest if shared portion is stable infrastructure. Persona files become pure personality.

---

## Repository Decision: Where does personal live?

You mentioned having a repository in mind. Based on what I see, `shared` seems like the natural candidate.

### Pros of `shared/`

1. **Already exists** — minimal setup
2. **Clean separation** — personal isn't mixed into work codebase
3. **Parallel structure** — can mirror mono's notes/guides pattern
4. **Portable** — could sync to other machines differently than work
5. **Mental model** — "mono = work, shared = personal" is intuitive

### Cons of `shared/`

1. **Context switching cost** — Claude can't easily cross-reference between repos in same chat
2. **Filesystem permissions** — need both in allowed directories
3. **Dependency uncertainty** — if personal starts referencing work code, structure breaks down
4. **Maintenance split** — two places to update if shared infrastructure changes

### Pros of keeping personal in mono (subfolder like `mono/personal/`)

1. **Single source of truth** — one CLAUDE.MD, one place to look
2. **Cross-reference** — guides can link freely
3. **Unified maintenance** — update once, applies everywhere

### Cons of keeping in mono

1. **Pollutes work repo** — personal journals in a "work" monorepo feels off
2. **Git history mixing** — personal commits in work history
3. **Harder boundaries** — temptation to blur personas

---

## Recommendation

**Start with Option A: Two root files in separate repos**, with **shared defaults in user preferences**.

Rationale:
- Simplest mental model: repo = persona
- No layering complexity
- Shared infrastructure lives in preferences (always loaded, zero duplication)
- CLAUDE.MD files are pure persona
- Adaptable: can evolve independently
- Clean git histories

### Minimal Structure

```
mono/
  CLAUDE.MD                  ← work persona (no shared defaults)
  notes/guides/collaborate/  ← work guides

shared/
  CLAUDE.MD                  ← personal persona (no shared defaults)
  notes/guides/              ← personal guides (create as needed)
  notes/journal/             ← or whatever emerges
```

### Chat Entry Points

Update user preferences:
```
"go work" → read ~/GitHub/mono/CLAUDE.MD
"go personal" → read ~/GitHub/shared/CLAUDE.MD
"go" → ask which: (w) work or (p) personal
```

---

## Open Questions

1. **User preferences visibility** — Preferences aren't version-controlled. Acceptable tradeoff for stable infrastructure?

2. **Persona bleed** — What if a personal project becomes work? Move it? Reference across?

3. **Guides location** — Personal guides in `shared/notes/guides/` or simpler flat structure?

4. **Code in shared** — You mentioned it might have code. Does that change the calculus? (Probably fine—repos can hold both)

---

## Next Steps

- [ ] Decide: `shared/` or different repo?
- [ ] Move shared defaults to user preferences
- [ ] Draft `shared/CLAUDE.MD` with personal persona
- [ ] Update user preferences for "go" commands
- [ ] Create minimal `shared/notes/guides/` structure (or defer until needed)
```

### /Users/sand/GitHub/mono/notes/work/articles/how.to.build.it.md
```md
# The Recipe (It's Not Foolproof)

*A practical guide to building your own AI collaborator*


---

I hope you are curious, and skeptical. I am, too. 


This is all technical stuff, where details matter. I'll try my best to take your hand and guide you through this handicraft. I can't know where your pinch points will be, and of course there will be some. Here's what i actually did. Take whatever appeals.

## What You'll Need

### **An AI with filesystem access.**

I use Claude with a Pro or Max subscription through claude.ai. Max gives you more usage — important when you're having long collaborative sessions. But Pro works fine to start.

The key feature: Claude can read and write files on your machine through MCP (Model Context Protocol). Without filesystem access, you're back to copy-pasting. That's slower and more tedious.

### **A code editor.**

I use VSCode. Nothing fancy. The important thing is having your project files organized in a way both you and the AI can navigate.

### **Basic Unix comfort.**

You don't need to be a wizard. But you should know:

* `cd` to change directories
* `ls` to list files
* `mkdir` to create folders
* How paths work (`~/GitHub/myproject` means your home folder → GitHub folder → myproject folder)

If that's gibberish, spend an hour with a Unix basics tutorial first. It'll pay off. Or, of course, jump off.

## The File Structure

Here's what my project looks like:

```
myproject/
├── CLAUDE.MD          ← the bootstrap file
├── src/               ← actual code
├── notes/
│   ├── architecture/  ← institutional memory
│   │   ├── foo.md
│   │   ├── bar.md
│   ├── guides/        ← institutional memory
│   │   ├── style.md
│   │   ├── gotchas.md
│   │   ├── debugging.md
│   │   └── voice.md
│   ├── tools/         ← useful unix scripts
│   │   ├── update_docs.sh
│   └── work/          ← active tasks
│       ├── current-feature.md
│       └── done/      ← archive
```

That's it. Nothing exotic. The magic is in the content, not the structure.

## The Bootstrap File

Create `CLAUDE.MD` in your project root. Here's a starter template:

```markdown
# CLAUDE.MD

REPO: ~/GitHub/myproject
GUIDES: Read all md files in `notes/guides` at start of session
WORK TRACKING: Keep `notes/work/<file>.md` updated as we go
FILES: Always read current version before editing

## Commands

| Command | Meaning |
|---------|---------|
| `work on <X>` | read `notes/work/<X>.md` and resume |
| `update docs` | update relevant documentation |
```

Customize it. Add your own commands. The point is: when you start a session, point the AI here first.

"Read CLAUDE.MD" becomes your greeting at the beginning a new chat.

## Building Guides (Slowly)

The guides and work folders start out empty. With each problem that you tackle with AI, at the end of the chat, ask it "Summarize what we just learned in `guides/<foo>.md`." I found this to be easy enough that I'm eager to do it, curious what it will write. I carefully read the file and spend some back and forth making it sensible, standalone, and tightly focused.

You might tackle similar problems several more times, capturing the essence and adding it to `<foo>.md`. As you tackle other problems, the guides files pile up. Copy and post this query: "review all the guide files highlighting redundancy, suggesting merges or clipping, and generally make this into a set of easily absorbed material. your audience is either you or a junior level software developer." It did a sweet job for my material.

## Work Tracking

When you start a task, paste this into a new `work` file:

```markdown
# Feature: User Authentication
**Started:** 2026-01-06
**Status:** Phase 1 in progress

## Problem
Users can't log in. Need OAuth integration.

## Goal
Working Google OAuth flow.

## Phase 1: Research
- [ ] Understand OAuth flow
- [ ] Find a library
- [ ] Sketch the implementation

## Next Action
**Phase 1:** Research OAuth libraries
```

Fill in the specific details. Of course, you only need enough to jog your memory of the problem. Update it as you go. Check boxes. Add notes. Pause a week or a month and give it no thought. Read it when you resume. Usually the generated material is brief and interesting.

Once the problem is resolved, consider whether you want to keep it. The ones I keep are ones that capture an important lesson. I sort them into three categories, moving them out of `work`:


| Folder | Purpose |
|--------|---------|  
| architecture | aspect of my software design |
| guides | common task or something learned |
| work/done | might be worth keeping |

## Things That Will Go Wrong

### **The AI will forget.**

Even with guides, Claude doesn't have infinite context. Long sessions get fuzzy. If things drift, say "reread CLAUDE.MD and the relevant guides." Reset the context.

### **Your guides will get stale.**

You'll change a pattern and forget to update the guide. Then the AI will do it the old way. When you notice, fix the guide. It's gardening, not architecture.

### **You'll over-engineer.**

I did. I made elaborate templates, complex folder structures, detailed taxonomies. Most of it was waste. Start simple. Add complexity only when the simple version fails.

### **The AI will make mistakes.**

It'll misunderstand. It'll break something. It'll confidently do the wrong thing. That's why "execute without asking" requires trust — and the ability to course-correct. Use git. Commit often. Undo is your friend.

## What Success Looks Like

After a few weeks:

* You start sessions with "work on X" and the AI knows what X is
* You stop re-explaining your coding style
* The AI catches things you'd miss ("this violates the pattern in style.md")
* Boring refactoring takes minutes instead of hours
* You feel less alone

It's not a replacement for thinking. It's a multiplier for doing.

## The Honest Truth

Some days it's magic. Some days it's frustrating. The AI hallucinates. The context window fills up. The MCP connection drops. I growl.


But the baseline keeps rising. Each guide you write, each pattern you capture, each gotcha you document — it accumulates. The AI you work with in a few weeks is meaningfully better than the one you started with. Not because the model changed. Because you taught it.


Your’e building a knowledge base of what, how, and the daily grind. Only corporations with deep pockets create such things, and they typically quickly go stale, wrong, useless. With a habit of proceeding this way, yours can always be updated by asking “review my code. Then review the notes and tell me what is out-of-date, disorganized or redundant.” Personally, I find that the experience is breathtaking.

## Getting Started Today

1. **Create the folder structure.** Five minutes.
2. **Write a minimal CLAUDE.MD.** Five minutes.
3. **Start your first work file.** Whatever you're working on right now.
4. **After your next "aha" moment, write it down.** First guide entry.

Don't overthink it. The system will evolve. Let it be messy at first. AI strikes me as a very capable janitor.


---

*Questions? Hit me up. I'm happy to share more of my actual guides if it helps.*```

### /Users/sand/GitHub/mono/notes/work/articles/write.article.md
```md
# How to Write an Article
**Example:** AI Workflow for Developers
**Started:** 2026-01-06  
**Status:** Phase 3 in progress

## Problem

Most developers use AI as a fancy search engine — one-off questions, copy-paste answers, no accumulated context. The AI forgets everything between sessions. You end up re-explaining your codebase, your preferences, your patterns. Every. Single. Time.

## Goal

A Medium article that shows developers a different approach: treating AI as a collaborative partner with institutional memory. The workflow system you've built — CLAUDE.MD bootstrapping, living guides, work tracking with resume points.

## Audience

Software developers who:
- Already use AI (Copilot, ChatGPT, Claude) but feel friction
- Want more than autocomplete or Q&A
- Are open to changing their workflow, not just their tools

## Angle

Not "here's a cool prompt." Instead: "here's a system that compounds."

---

## Phase 1: Outline
- [x] Identify the hook (what grabs attention) ✅
- [x] List the key concepts to cover ✅
- [x] Decide on structure ✅
- [x] Draft outline with section headers ✅

### Outline

**Title:** I Accidentally Built a Junior Programmer

**Subtitle:** How a pile of markdown files turned AI into a real collaborator

1. **The Accident** — hook + origin story
2. **The Bootstrap File** — CLAUDE.MD as entry point
3. **Living Guides** — patterns AI applies without being told
4. **Work Tracking** — resume points that survive sessions
5. **The Dynamic Shift** — trust + course-correct
6. **What AI Is Good At** — and what you still do
7. **Try It Yourself** — practical takeaway

## Phase 2: Draft
- [x] Write intro/hook ✅
- [x] Write body sections ✅
- [x] Write conclusion/call-to-action ✅
- [x] Include code/file examples where useful ✅

**Drafts:**
- [accidental.programmer.md](./accidental.programmer.md) — journey/emotion (Part 1)
- [how.to.build.it.md](./how.to.build.it.md) — practical guide (Part 2)

## Phase 3: Polish
- [ ] Tighten prose (voice.md rules)
- [ ] Check flow between sections
- [ ] Add any diagrams or visuals needed
- [ ] Final read-through

---

## Next Action
**Phase 3:** Review draft, tighten prose, check flow
```

### /Users/sand/GitHub/mono/notes/work/articles/accidental.programmer.md
```md
# I Accidentally Built a Junior Programmer

*How a pile of markdown files turned AI into a real collaborator*

---

I accidentally built an astonishing, helpful, inexpensive junior programmer. I like this team!

It didn't start that way. It started with annoyance.

## The Frustration

Every conversation with AI began from scratch. I'd explain my project. Explain my preferences. Explain the ad-hoc decisions i made six months ago that have matured into a tangled mess. The AI would nod along (metaphorically), help me solve something, and then — poof. Gone. Start over and encounter lapses in judgement that I've already addressed. Rinse and repeat.

Every AI has amnesia.

## The Accident

So i started saving things. When the AI explained something well, i'd ask it to write it up. Markdown files. Just notes to my future self.

"Here's how we handle state in this project."
"Watch out for this Svelte gotcha — it'll bite you."
"This is the naming convention. Stick to it."

The pile grew. Dozens of files. It became its own problem — where did i put that thing about debugging?

Then, curious, i asked the AI to help me organize the mess it had helped create. And something unexpected happened.

## The Click

I made one file that pointed to all the others. A table of contents. A starting point. And i told the AI: "Read this first, every time."

Suddenly the AI *knew things*. It remembered the patterns. It followed the house rules. It didn't ask me to re-explain the architecture — it had already read the doc.

It felt different. Not like talking to a stranger. Like picking up a conversation with someone who'd done their homework.

## The Delight

Here's what i wasn't expecting: joy.

Not just efficiency. Not just "fewer keystrokes." Actual delight in the collaboration.

There's a rhythm now. I describe a problem. The AI digs into the large and complex codebase, and comes back with observations and suggestions. We brainstorm. It proposes. I push back. It adjusts. We find something neither of us would've found alone.

It's pair programming. Real collaboration. The kind where two minds are better than one, where the back-and-forth generates something new.

Plus, my pair partner never gets tired. Never gets frustrated when i change my mind. Never judges me for the terrible code i wrote at 2am last year. Doesn't get offended when I say "this is a terrible idea." It just... helps.

Salary for this pretty-darned-awesome employee: way less than any human hire.

## The Junior Dev Analogy

I keep coming back to this framing: it's like having a junior developer who actually reads the documentation, down to the finest details it contains. And THEN begins collaborating. It's the junior dev that doesn't exist in real life. Infinite patience. Perfect memory. Eager to help. Cheap.

## The Team

"What a team" isn't ironic. I mean it.

Early on, i was alone. Steep learning curve. Thin documentation. Industry standards that felt unknowable. The pace of my project was heartbreakingly slow. 

Now, two years on, there's something almost giddy about the dynamic. I'll start a work session and the AI already knows what we were doing yesterday. Plus, the boring parts — the tedious chores of ... refactoring, the repetitive consistency fixes, the "update all 47 references to this thing" — the AI handles those. Never quite as fast as I want, but insanely faster than me doing it manually.

Massively less stressed by complexity and consistency, I get to play with interesting parts: aesthetics, algorithms, sudden flashes. My hireling handles the grunt work and occasionally spots things i missed.

## The Compound Effect

Another plus: it compounds.

Every problem we solve, every pattern we establish, every gotcha we document — it goes into the pile. And the pile makes the AI smarter. Not in some sci-fi way. Just... more useful. More aligned. More *mine*.

My AI today knows a mountain of things because i've been teaching it, one markdown file at a time. Each problem we work on gets added to this accumulated teaching. Baby steps that add up to a giant leap. The office i sit in now feels like driving a Mack truck, gobbling up the miles, hauling my soul.

## What's the Catch?

Gee, you're not paying anyone to store all the files. Besides which, they're completely yours. Plus, likely this entire recipe will work fine on any AI.

But I suppose the catch is getting used to thinking differently. I had to learn:

- [ ] carefully craft questions
- [ ] patiences while it does its thing
- [ ] careful scrutiny of its answers
- [ ] correct mistakes, wrong assumptions, craziness
- [ ] compose dog-simple instructions
	- [ ] do NOT trust the AI
	- [ ] take very small baby steps
	- [ ] test, identify anything wacko
	- [ ] take time to get it right
	- [ ] rinse and repeat

## An Invitation

I'm not selling anything. There's no course, no framework, no SaaS product.

Just this: if you're using AI as a fancy search engine, you're missing out. The real magic is beyond the answers. It's the accumulated and massaged answers, an institutional memory.

Build the pile. Teach the AI how you work. Let it learn your quirks.

You might end up with your own high-tech, endlessly helpful (cheap!) junior programmer.

---

*I write about software development and occasionally about making AI actually helpful. Follow along if that sounds interesting.*
```

### /Users/sand/GitHub/mono/notes/work/articles/index.md
```md
# Articles

## Contents

- [Accidental.programmer](./accidental.programmer.md)
- [How.to.build.it](./how.to.build.it.md)
- [Write.article](./write.article.md)

```

### /Users/sand/GitHub/mono/notes/work/revisit.md
```md
# Resume

**January 28, 2026 (early afternoon)**

## Next steps

- [ ] rename localhosts -> hosts, dispatcher -> bash
- [ ] add 'tests' button

## Netlify Deployment Fixes & Package Cleanup

Major cleanup of ws build configuration and dependencies.

**Netlify fixes:**

- [x] Fixed base directory paths (projects/ws → ws, projects/di → di)
- [x] Added nohoist in mono/package.json for Svelte version isolation (ws=4, di=5)
- [x] Added `define: { global: 'globalThis' }` in vite.config.js — Firebase uses `global` for environment detection

**Removed unused packages from ws:**

- [x] `neo4j-driver`, `pg`, `pg-promise`, `pg-query-stream` — server-only, never imported
- [x] `@sveltejs/kit`, `@sveltejs/adapter-netlify` — ws uses plain Vite, not SvelteKit
- [x] `@skeletonlabs/skeleton`, `@skeletonlabs/tw-plugin`, `@tailwindcss/typography` — no tailwind directives in source
- [x] `typedoc-plugin-markdown` — not referenced in typedoc.json
- [x] `vite-plugin-singlefile` — not in vite.config.js
- [x] `rollup` — Vite bundles its own

**Config cleanup:**

- [x] Removed SvelteKit block from svelte.config.js
- [x] Deleted tailwind.config.ts
- [x] Zero yarn warnings achieved

## WS Notes Reorganization

**Moved to guides:**

- [x] `ws/notes/architecture/` → `ws/notes/guides/architecture/`
- [x] `ws/notes/collaborate/` → `ws/notes/guides/collaborate/`
- [x] Updated ws/.vitepress/config.mts sidebar links
- [x] Updated ws/notes/index.md

**Removed ws/notes/tools/:**

- [x] Audited config.sh — all values just restated defaults
- [x] Removed dead code: DOCS_LOG_FILE, NETLIFY_SITE_ID, DOCS_SOURCE_DIR
- [x] Deleted entire folder (scripts use sensible defaults)

## Hub App

- [x] Renamed "pre-publish" button to "docs" in hub app

## Fix-Links Path Similarity

Improved `link-finder.ts` to auto-resolve ambiguous matches:

- [x] Added `scoreMatch()` — counts path segments shared with broken link
- [x] Added `selectBestMatch()` — picks highest score if clear winner
- [x] Updated `promptUserChoice()` — tries auto-select first, only skips if scores tied
- [x] Example: `./architecture/ux/search` → `guides/architecture/ux/search.md` (score 3) beats `work/next/search.md` (score 1)

## Update-Docs Skip-If-Unchanged

Added timestamp-based skip logic to `update-project-docs.sh`:

- [x] Added `--force` / `-f` flag to bypass check
- [x] Added `check_needs_rebuild()` — compares `.vitepress/.last-build` marker against sources
- [x] Checks: md files in notes/, config.mts, shared tools .ts files
- [x] Early exit with `○ $PROJECT_NAME up to date` if no changes
- [x] Touches marker after successful build
- [x] Added debug output in verbose mode
- [x] Updated .gitignore for marker files

## Guide Updates

- [x] Added to `chat.md`: "Reads logs/errors directly when debugging — never asks user to cat files co can access"

---

**January 28, 2026 (morning)**

## Hub App Refinements

Three improvements to the hub app dashboard.

**Deploy status tooltip** — Hover over "Work Sites" title shows per-site Netlify status:

- Format: `site: ✓ ready -2m` or `⋯ building` or `⊘ canceled` or `✗ error`
- Polls `/deploy-status` every 10s
- Handles canceled vs error distinction (canceled = not an error)

**Status dot** — Persistent colored indicator above title:

- Green = all ready/canceled
- Yellow = building/enqueued
- Red = error/failed

**Simpler docs rebuild progress** — Console shows compact format:

```
ws 3/7 build → bundling
ws 3/7 build → dead links: 2
ws 6/7 rebuild → done
✓ mono, ws, di
```

- Added `run_vp_build()` function that tails `vitepress.build.txt` for real-time progress
- Translation table filters VitePress noise
- Dead link counter during builds

**Files updated:**

- [x] `notes/tools/hub/index.html` — tooltip, status dot, CSS
- [x] `notes/tools/docs/update-project-docs.sh` — progress format, translation, vp build streaming
- [x] `notes/guides/tools/hub-app.md` — documented new features
- [x] `notes/work/hub-app-refinements.md` — marked complete

**Other:**

- [x] Moved `notes/philosophy/` → `notes/guides/philosophy/`
- [x] Updated `notes/guides/index.md`

**January 28, 2026**

## Guide System Overhaul

Major reorganization of collaboration guides and CLAUDE.MD.

**Pre-flight folder created** — `notes/guides/collaborate/pre-flight/`:

- [x] `gates.md` — extracted from CLAUDE.MD
- [x] `keywords.md` — new, word → guide mapping
- [x] `kinds.of.tasks.md` — new, task type → guides + conflicts
- [x] `shorthand.md` — moved from collaborate/
- [x] `workarounds.md` — extracted from CLAUDE.MD
- [x] `index.md` — numbered reading order

**CLAUDE.MD slimmed** from 83 → 57 lines:

- [x] Added synopsis blockquote at top
- [x] Pre-flight section points to folder
- [x] Guides list simplified
- [x] TONE separated from DOCS STYLE
- [x] Clarified "including pre-flight/" for recursion

**Workflow.md cleaned**:

- [x] Added "relearn" command
- [x] Extracted Build & Deploy to `develop/build.md`

**Other moves**:

- [x] `housekeeping.md` → `done/migrations.md`
- [x] `journal.md`, `guidance-journal.md` → `journals/` folder
- [x] `evolve.md` content merged into `develop/aesthetics.md` Process section
- [x] `claude.md` renamed to `personas.md`

**Stale content removed**:

- [x] "`execute` unavailable" workaround (bash_tool exists)

## Retention Test

Created `notes/work/retention-test.md` — 5 probes to measure guide effectiveness across sessions:

1. `pac` shorthand
2. Refactoring gate (STOP/SEARCH/LIST/WAIT)
3. Multi-file gate (search references first)
4. Voice (first person, casual, punchy)
5. Freshness (re-read before claiming)

**January 18, 2026**

## Checkbox Plugin

Built `[+]` checkbox support for VitePress — orange box with "?" for "fixed but awaiting review" state.

**Files created:**

- [x] `sites/markdown-it-task-list-plus.mts` — shared plugin that transforms `[+]` into styled checkbox

**Files updated:**

- [x] `sites/docs/.vitepress/config.mts` — added plugin
- [x] `projects/ws/.vitepress/config.mts` — added `markdown-it-task-lists` + plugin
- [x] `projects/ws/.vitepress/theme/custom.css` — added checkbox styles
- [x] `projects/di/.vitepress/config.mts` — added plugin
- [x] `projects/di/.vitepress/theme/index.ts` — created (imports custom.css)
- [x] `projects/di/.vitepress/theme/custom.css` — created with checkbox styles
- [x] `projects/ws/notes/guides/deliverables.md` — changed `[-]` back to `[+]`

**Issue discovered:** Initial approach (CSS `:indeterminate`) failed because markdown-it only parses `[ ]` and `[x]`. Required custom plugin to intercept `[+]` at parse time.

## Journal System

- [x] Created `notes/work/journal.md` — distilled from work/done files
- [x] Documented format rules in `guides/collaborate/journals.md`
- [x] Documented daily workflow (revisit.md → journal.md)

**Format rules:**

- [x] Chronological order (oldest first)
- [x] **Current** section at top (exception to chronological)
- [x] Bold dates, no headings
- [x] Two blank lines between entries
- [ ] Reference relevant guide files

## Breadcrumb Visibility

```typescript
function handle_s_mouse(s_mouse) {
    if (!!h && h.hasRoot && s_mouse.isDown) {
        search.deactivate();
        ancestry.grabOnly();
        if (ancestry.ancestry_assureIsVisible()) {
            g.ancestry_place_atCenter(ancestry);
        }
        g.grand_build();
    }
}
```

## Code Analysis Discipline

- [x] Identified mistake: proposed `if (ancestry.grabOnly())` without verifying return type
- [x] `grabOnly()` returns void, not boolean

**Added to** `guides/collaborate/chat.md`:

- [x] Verify return types before writing conditionals
- [x] Trace full call chain
- [x] Don't trust patterns across similar method names
- [x] Quote signatures when proposing code
- [x] Don't assume existing code is correct
- [x] Read implementations, not just calls

## Guide Consolidation

- [x] Moved commands/abbreviations from CLAUDE.MD to `guides/collaborate/shorthand.md`
- [x] Removed duplicate commands section from chat.md, now links to shorthand.md
- [x] CLAUDE.MD now minimal — just context and defaults
```

### /Users/sand/GitHub/mono/notes/work/journals/journal.md
```md
# Journal

**Current** Investigating dual persona design — work vs personal, each with own gating and guides. Core insight: shared infrastructure (~15 lines of defaults) belongs in Claude user preferences, leaving CLAUDE.MD files as pure persona. Exploring `shared/` repo for personal persona. See `notes/work/claude.md`.


**2025** Started webseriously as graph visualization tool. Built di as quaternion rotation demo, rebuilding a 20-year-old CAD program. Developed collaboration workflow with Claude through trial and error — CLAUDE.MD files, structured guides, work tracking. The pattern emerged: Claude handles execution and analysis, I handle direction and distillation.


**January 8, 2026** Wrote `pacing.md`. This project moves differently than webseriously — faster AND easier. The gap between thinking and seeing has collapsed. Say it, see it. Mere minutes from idea to artifact. Crazily like a lucid dream. Frees me, lets ideas settle, evolve. Pushed "enhanced" template to GitHub. Phase 1 of **commoditize** complete. The template captures the methodology: bidirectional docs, living guides, work tracking that survives sessions, context-switching rituals.


**January 11, 2026** Planned the **monorepo**. Four repos with duplicated code (`Extensions.ts` nearly identical), separate node_modules, scattered docs. Mapped out five phases with panic buttons at each step. Key decision: yarn workspaces, single git repo (not submodules), `@work/core` for shared code.


**January 12, 2026** Finished **monorepo** migration (Phase 3). Used `git subtree add` to pull in ws, di, shared, enhanced with history. Discovered subtree doesn't preserve per-file history — `git log <file>` doesn't trace back. Accepted it; original repos still exist if needed. Attempted Phase 4: extract `Extensions.ts` to @work/core. Hit circular dependency wall in ws — managers instantiate at module load time, depend on each other. Reverted. Both projects keep their own `Extensions.ts` for now.


**January 14, 2026** Built single-line progress display for the dev hub. Problem: `update-docs` spewed dozens of lines, hard to see what mattered. Now shows one updating line: "Step 3/7: Building docs..." with `\r\033[K` trick. Added live console to hub that polls status files. Discovered calling `servers.sh` from Python killed the API mid-process — switched to direct process management with `kill_port()` and `subprocess.Popen()`. Started cleanup audit. Found stale paths pointing to old `~/GitHub/shared` structure and TOCs out of sync with actual files. Listed everything, haven't fixed yet.


**January 15-16, 2026** WS bug fixes: levels slider wasn't updating graph (added `$w_depth_limit` to reactive trigger), color picker hover interference (new store to track picker state, suppress mouse events while open), text selection showing during drag (global `user-select: none`). Also styled indeterminate checkboxes in VitePress docs.


**January 17, 2026** Fixed **MCP** connection issue in Claude Desktop. Root cause: npm prefix pointed to `.nvms` while node binary lived in `.nvm` — a split configuration I didn't know I had. When Claude Desktop launched the filesystem server via npx, it started with node v20 but subprocess calls found v14 in PATH, which crashed on modern syntax. **Solution: bypass npx entirely**, call node directly with full path to the installed module. Industry standard is single `.nvm` directory; I had two competing setups.


**January 17, 2026** Created journal, added `[+]` checkbox support across all VitePress sites. Built custom markdown-it plugin (`sites/markdown-it-task-list-plus.mts`) that transforms `[+]` into orange checkboxes with "?" — for "fixed but awaiting review" state.
```

### /Users/sand/GitHub/mono/notes/work/journals/index.md
```md
# Journals

- [Journal](./journal.md) — daily log, distilled prose
- [Guidance Journal](./guidance-journal.md) — chronicle of guide evolution

## Contents

- [Guidance Journal](./guidance-journal.md)
- [Journal](./journal.md)

```

### /Users/sand/GitHub/mono/notes/work/journals/guidance-journal.md
```md
# Guidance Journal

Chronicle of guide and work file evolution, extracted from timestamps in the files themselves.


**December 31, 2024** Tested MCP filesystem access. Despite intermittent "Server disconnected" errors, `Filesystem:list_directory` returned full directory listing. Documented that errors can be safely ignored. Added troubleshooting section to `guides/collaborate/access.md`.


**January 2025** (ws) Milestones 125-129. Fixed thing ID translation during import. Built display details for controlling tiny dots visibility. Major refactor: rewrote S_Title_Edit using Mouse Responder pattern — the old title editor was fragile, new one treats editing as a proper mouse interaction state. Added TypeDoc. Ancestry-centric architecture work begins — moving toward ancestry as the primary abstraction rather than things.


**February 2025** (ws) Milestones 130-133. Completed new Ancestry-centric architecture — ancestry now owns its G_Widget, title clipping during edit fixed. Achieved fast and smooth response to editing and rotating. Much cleaner rings UX in radial mode. Added bidirectional relationship lines. New control to show related relationships.


**March 2025** (ws) Milestones 133-134. New panel layout with box around controls and breadcrumbs. New Tools section in Details — buttons grid for actions. Added depth limit slider wired to graph. Gull wings (quarter-circle SVG arcs) at line intersections for visual polish. Separator aesthetics work.


**April 2025** (ws) Milestones 135-140. Wired all tools buttons: show all, add/delete parent/related. Started CSV import work for Marianne's data. Fixed font size bug in segmented controls. Reorganized Details to always show title. Began work on tags extraction from CSV.


**May 2025** (ws) Milestones 141-149. Brand new Details view with hideables and v-stack. Tags table now reads from Firebase. Details banners use glowing buttons for next/previous on traits and tags. Depth limit fully wired to graph with relayout. Use filled dots to indicate grabbed. Detect and respond to control key for help overlay. Improved recents button logic. Hover indication working everywhere.


**June 2025** (ws) Milestones 150-160. Peak month — 153 commits. Began dual zoom work. Autorepeat for action buttons. **Started Bubble.io plugin** — major multi-month effort. Implemented Vincent's UI suggestions (inverted hover sense on glow buttons). Moved tree preferences into tree graph pane. Plugin now sends valid data. Plugin receives data from Bubble. Added focus and grabs to plugin fields. Adopted Vincent's proposal for parents/related data structure. New zoom buttons in upper left. Wire up focus and grabs events. **Finished rubberband selection** — command-drag to select multiple, works in both tree and radial.


**July 2025** (ws) Milestones 162-169. Fixed editing/layout/color/hover bugs, added print utility for exporting graphs. Suppress select/focus events during data download (plugin stability). Built super-fast search (initially disabled). Removed tab from search filters. Search controls moved to left of breadcrumbs. Needed for Bubble plugin publishing — prepared for production. Revised Bubble plugin API with better event names.


**August 2025** (ws) Milestones 170-172. Major refactor: `isOut` → `isHovering` with nearly perfect app-wide hover behavior. Tags and traits details now correctly use S_Items pattern. Enforce radial view for non-standalone UX (Bubble embed mode). Plugin arrays, grab/focus event refinements.


**September 2025** (ws) Milestones 173-176. Decreased spacing everywhere, introduced Bubble theme. Click on drag dot to become focus (not just show border). **New hover system completed** — adopted RBush spatial index for hover detection. Renamed hover manager as hits. Curved cluster titles in radial. Further refinements to radial UX.


**October 2025** (ws) Milestones 177-178. **"Mouse responder is dead!"** — eliminated the old mouse handling abstraction entirely. Fully isolated mouse logic within hits manager (double-click, long-click, autorepeat all centralized). Hover system refactoring proposal written. **Claude Code collaboration begins** — created CLAUDE.md, first PRs from claude branches, AI-assisted state migration work.


**November 2025** (ws) Milestones 179-181. New Styles manager centralizes all color computation — dynamic widget/button colors based on context. Finished integrating new breadcrumbs history type (navigate through recents). Restore grabs when navigating history. Major store refactoring: moved writables from Stores to UX, converted w_ancestry_focus into derived readable. Netlify deployment work.


**December 2025** (ws) Milestones 182-183. Finished show children counts as numbers in reveal dots. Fully wired dynamic/static focus control. **Installed VitePress** for documentation website. Massive documentation reorganization. Breadcrumb composition refactoring (and reverted when it broke things). Radial reveal dot bug fixes.


**January 4-8, 2026** (di) Created the project. Vite + TypeScript + Svelte 5 from day one. Built quaternion POC: two nested cubes rotating independently, wireframe rendering with depth-based opacity. Proof that gl-matrix + Canvas 2D pipeline works without gimbal lock. Established the manager pattern (Scene, Camera, Render, Input, Animation). Created the notes structure that would become the collaboration workflow. Milestone 1 (solid foundation) and Milestone 2 (panel layout) completed. Set up dual Netlify deployments: docs.designintuition.app (VitePress) and designintuition.app (main app). Milestone 3 (document publishing) and Milestone 4 (hits manager borrowed from ws) done.


**January 8, 2026** Wrote `work/next/pacing.md`. Captured the insight that this project moves differently — the gap between thinking and seeing has collapsed. Started the **commoditize** effort to package the AI collaboration methodology. Phase 1 complete: created `enhanced` repo with template CLAUDE.MD and starter structure. See `work/next/commoditize.md`.


**January 9, 2026** Started the hub app — browser-based dashboard for managing local dev servers. Defined port assignments, keyboard shortcuts, UI components. See `guides/develop/hub-app.md` and `guides/setup/hub-app-spec.md`.


**January 12, 2026** Started **monorepo migration** (`work/done/monorepo.md`). Used `git subtree add` to pull in ws, di, shared, enhanced with history. Discovered subtree doesn't preserve per-file history. Accepted the tradeoff — original repos exist if needed.


**January 14, 2026** Multiple work streams:
- **Cleanup audit** (`work/next/cleanup.md`) — found stale paths pointing to old `~/GitHub/shared` structure, TOCs out of sync.
- **Single-line progress display** (`work/done/single-line-progress.md`) — built `\r\033[K` trick for calm terminal output, hub console polling.
- **Hub console progress** (`work/done/sites-hub.md`) — live progress for Restart and Rebuild Docs, direct Python process management.
- **Guides clutter** (`work/done/guides-clutter.md`) — started thinking about minimal guide set.


**January 17, 2026** Fixed MCP connection issue in Claude Desktop. Root cause: npm prefix pointed to `.nvms` while node binary lived in `.nvm`. Solution: bypass npx entirely, call node directly with full path.


**January 18, 2026** Built `[+]` checkbox support for VitePress — orange box with "?" for "fixed but awaiting review" state. Created custom markdown-it plugin. Also created the journal system itself — `notes/work/journal.md` and documented format rules in `guides/collaborate/journals.md`. Added Code Analysis Discipline to chat.md (verify return types, trace call chains, quote signatures).


**January 21, 2026** Created `guides/collaborate/gating.md`. Documented the discovery that lessons acknowledged mid-conversation don't reliably stick. Identified the SKILL.md pattern from Claude's system prompt as a working solution. Core insight: ambient context is available but not active — principles need to be **gates** (checkpoints Claude must pass through before acting).
```

### /Users/sand/GitHub/mono/notes/work/index.md
```md
# Work

## Contents

- [Articles](./articles/)
- [Feedstock](./feedstock.md)
- [Jeff](./jeff/)
- [Journals](./journals/)
- [Next](./next/)
- [Revisit](./revisit.md)
- [Retention Test](./retention-test.md)

```

### /Users/sand/GitHub/mono/notes/work/jeff/INTERSECTION APP draft version 1.pdf
```pdf
%PDF-1.4
%����
1 0 obj
<</Title (INTERSECTION APP draft version 1)
/Producer (Skia/PDF m145 Google Docs Renderer)>>
endobj
3 0 obj
<</ca 1
/BM /Normal>>
endobj
7 0 obj
<</Filter /FlateDecode
/Length 8144>> stream
x��]��%�q��S��d��@00���,�2/`8���	����b�l6�>��ճ�E��3�"Y�{}%?��	�/�����_�6oӯ��/���?��c�����ӏ����O�s͇�J����������{�Ə'?~�������_����W_���j����?��4��.�!����u/���o����=Y���f�V�����������}���_U��F����W����q[���7��	��A���:��_��u�)�l�5�z٨6L�q)����t���ý�i%6g�3��������Q7Mk�))����aSA���K�Vo�k!�]�po�t�������ozG��#T��\6�-�`^�9�v��1QIw�.��pR�&��K����&H)ým��tx{8BK��
7Oݘ����ۗe��ڸ��g�ݤ�ҿ�W���w�!��K��^0�xin.��վ'W;���惷
�O{���:&qǃnq�n���!Ļ��JC�n�k��r��Ju�WR�]�;��	�Ku�w�!j���|B����价�qs������z{S�8�҇�#�$p6�P��6aHo'�>xB�aon"h��!�~A�.B�c���.�,)@¼��Re�"����nϨ�:�� �n����
����FxG�@�&��~c���a�|�ɒ�tqw�1ߦ�#�V�l�#Aoɸ)�Mʲ5� ��l.��z��n܋�K���/��}��X�_�}����?���o�$o��b��p��ܒ�5����'�?���ۿ}y���N���e�����is���?��|fA��
���,���^-�.���Rʑ��ܠ��:�k��_���Vٰ	�x�B/��\-'wf�Z�����6`s�M/�4�!��w��󚥏W)噣e&�w$n�� �c�-5XD^x��xvV��cI��8�I>��:|�AL?�$�)i{�;���`Ă���On�g���e\Qǫ]��\�P~����f6�e�`�vLJ��$Xq�/��N�����S�'��l�qIi��K+%��J�\#_��@w�k��C|�*�;�O���QKs1�7�����8X'gו���#.=b%�a�Ծ�h���;�����B�f/`X����/T�)̸	xe�5����u1���ju��P��kjK1��4�f-h���_�3�L�n`'�tn\N�R������V����%�܄�NY6qւ���6xOvgO0p��=T��ฃ�',~1�?���_h�F9�Q���Gl����m����sZd�	)8U�n=0$��p�R³7�����2rB?����|�x�>���%-<X��LN�H��c��a���i�i���5^�r�r��s��l��d�T�@iJ�+�{v�~�_c����'}ŀ`�k�|��Y�ڍ��[��@'��Fۈ�y�&;�/���e0ʙ��W�.��*pA�q�9�7�H=|��Hf o��d�Ψ7'��2���z)	��MX$I��Lг��KB���2��ߒ��#6�ܛ��l��/{����O��A�]z$Kf�˧6�p�c��D�ç\�L��A��Q���5�{ށA+61LkX��O� ��O� sWOق��vÊC���IA��d�66��:�:#����)����K��`�6ZVq�b�Xr�$����f��� ؔ*<LT����S"P��.q�aR���ngu��F
����9�ݙ�E�), 5�H"m�:�Xs�@}Y6��Wea���B^�V �z�7 �+�n9��
�ܘ���?7/�aiw�:�p�hO�q�d���gE.Q�Z��"U�b���^Hc�����S�$�otR��CŸ��8U�9�t�^lj�,���ʝh�3������Λ�������g��(�cչ�$�N�5�؍M�:rv�Ur��eq�v�N��h3�4b^?��(�&�_�H~�b�)����Ԓ�fv�i� c�Ԝ�K��ɑvĤL��t��g��k�_�7��*9��i�F���x���7�(���R�98�Q� �\�MN�G�o���:�h
�#U�ɻ��c��0B�Wl����n��"¥��A:�~-����"L�I�� ��5dQ�`Wo�Cz���a�&Y�z��̫��%�C[�]�H�z���k��'�'���B�y4f����@�n��b�BbW��@�3�G��T�Y�I9�ʯ9l$���vc���y�%�^e�v��Յ�B����P7��`7+��N��!Re���������ڟ��,A���z>�B<­�����0I֗&�YM`�
�g�e)�#��O�����U�@|h��P2O�a���q��ɱ)�C5V^	��G����n��>i2��PaT�\���?a���SC<␆%�|A��S{�u.��Ib�͹���T~32��W������ӇL�뷺c�$E�Z�fφ�K+��G�*���չT�iuYg�.��1��h~�y��D*Z_�"��S_5�-�������f��z�Ns��`�I���?I�o6L9�&x})*x��Lȋ�ĉA��X�<{C-#%UP�/j�7�j�9_"+�N��0(<=O���[��	����X�R�)�e��=��[��=6�Ug��F���$��E9*��Ě�c��XX*��Fr�����G���J���7;/xX��M�2p�e��������=��F;�ƺ�L�fB���G�0Yp,y��%��W�͙F�^=c%�ZN03cl,%��|v�P���$��l�����Ź�Dqf{f����b�������P��0R�$�An	>��Ux=};S��J�ӓ�c�	�%_.NoV�[�S�~��������M���������������[�M?�8�Iȯ����u�b�;�ʌ�e� 75�����ǳ\���4�l�Q��@)�Jܬ���W�M��.-k	+�+k	�$mKQy+=V�\��VM�2�<i^�3���ڱ���v�̀[2`��3�D�����q�-S¯hB<�n-���w{T��]:�c	5�A{�y��3���J�ApN�Z�N�����H�;���>��|�Q���&_�fi�dQ~���wƄ��:^��%;ΎA9�6�{k�#�2f&Hf���� ����}�N�F��Ǻ����%vQ�f�`���
Q1��{]�Fo~�P��-=1i'I�6ѓ����(�)՘��I�2ӟ�k8�v�f��B#�U�����69r��h���97��/�P�"y��eK�\bߣ��*�UU<5΁����K`��`K~��H{��E�J��1�	��_��1���q]bGĞ����$P=���d]>� �u�y��b��W�bi��$+��4��,�q�v�7�H���t�P'����1�a�d�����@u�u��!)gQ��y�aA�NU�m�P�Y&�S�����5x�ڃ6"]�d�}��
��������sȎ/�!l�Ci��p�,���=�����Vw^I�Z�� ���= �Q`&&h�R��3ʢ)�X䔤�k�Z^�gbM����YmΘT��2Z���_�ʀ&�]�4�J�m�^wօ��ck���%2(@�
Z��Z�̣�.);=]J���Wʣ�r	�p�)"U�u�<
�V��&�G��`�GiJ��e�h��!�VAk��}��4O2\�a󛒢h�����&��sF��]m������ͮ?s�������Ba�
U��/��Q�ͫ�h�Φ����;E��+�c���'i�=;�O=e���K�Z��Y9�P��:��z��LD�0XL#�F@���bb�x.�z] �7.�C q�[Bp�T�ۼ��B�\�����Гf���_|�DZ�]�|J�/iΡZ��(��1��4Q^�3p�]3�U玌����=$�PQ%�L)���������$����Nq�h���䁭\;����8N[��8*��.{��Ό�գ����/�>�w����J�\!���H��n皿�-�8�Pk�H	k��]��"I��ݒS��D�S-�:�X{�XD+�k	�]B��=A���t����1�0D+b#���>�S��"��u�A��w��r�↭E�^bW����uW�w�"*��a��Ts�L�IU~���	�eq'��n�[F~2�_N����u۹�w�NcDi�<
�oz!|�HW�h-}m~�mot8��ҝ�
i�e |HYiց�c���Y�{�nq�u��;j߂;]�8���Q�|���A����v���\E]��Ho�tE�<?5Y��C���~�84L.��S�F� EG��=#+,R��ygX���&���թ(1
�5;�"����?\u�jM������̸m}J���:��¬٩�kqo�t�l������L���o�00��v9.�:n�ئ�����2�6.�)J��@c�8h�d�s�d)���:�+Qr���[$�0&C(\�,�SO`���`��=y����I����^<�V���LR���-�ٲ�Moi�$�*9�8��يo���X��5_R��u�K��T3�6'+X�@�T}3������{�ئ`u�bT�`���c��K��p��]���d�����z;���'g8�gKE�)~�`��A��ہ2[�ZO�s`�n37��(�l��"g�0�C��`�G\!Sn���<��I��\Z��=�i���"����.xQ=g��������a��/�>�J^�l#�H����������e��T���BQ�8�4B���E]�cJI�Zy�����Bz_�~ѹHK^�ė�,�%�T��R�J����#��iC�I��p4H�޳��d�Z�C�W��T�=R���s��Cg
�̞�E��P�x[� ���<n���r�2.]#�kE�`s��v�}3@>�+䷎�+��1!3
*zՐ��AU'o��Dlx�;��0xr�s�B�W����^7*Ptֳ?�-��]]��ڨHMYL�d�/u�ԙDu�d�%L#��Dȭ>��`]���z4�ڟO�k4{J�0L)��)�B���uȩ�PAԘDEqST��*�ÌDm4`���ߵ�`���no̈́{ZKa���/��$[,�^�Gj����a��+-�H�1�"n�/�]T�RA��t�С�9��آ�|!
"mx�^�S�ե��"K�8V���ԦI�.x�XMd�0�:f�1�1jI�Q��h~d�-=E�lq��T/�6N����k鉝�����YW���j�%�XFĖm�6�>��)�] F\���(��$Bk=f��rr{]N�T��HFٴqRL�����6�^�f�����rcSP-z�B��?���ċ��P�u�9���H1��;�-҉3���=ҹ�̣��,��W�_�>v'j�y�S��8�����(F��7ţf�E]�;x4_�p��@Q���\X;T�F\�>�R1Z�$+�Ns>�,B�A��T�J�1�k��ϯ�BOR|M��8�E:�0�y�U#Cɡ����ɶ�)T懟��`LoN�������T���0LOU�WO>Cd�?Ef}9ԅ�5��r���vr�D�yu��]�jŢI\ �1&b�@
���W8���֊&�"���+��\a�.�eh&�������sl}��9,^Y�@��|�x5��F\�۹ �Ym��7| UIy	��O����J�i�RV\�����6��Z�&5r��(�j�S!M�U3��:G����B�s{B�|u�HI�nc��'5���d�M�`o^`gf�5[$���w�U�c�,t��?�0_$����|fA�oJW��b��ⴡMr�\P�	��JU-6y��ZW
��A,�n8Xs�Vޭ��{_#/��hւ���~�e4yD"��I�'���0_ώ�٥�j�@��6���ŵ"�L|�:d� ����JZ̻>���R謜
��Cg�l����kt�G����:�G,����	�Z1����۹r�Ŵ*0���z6�>!��ՙ�C&k���P�M�h�[g��+A2KLU�,�	>o�q�yۼd��J�Ŝm�m���,<j�۪�?d�l�����$'�-,Xzr�+cх��ׇ�CөǤb
�2�m���h'�C����``
'�`�s��"e8:*��ԏ��.��ڻ�#M�d"}*�=��0}` �! T�\�#;�:�tv�D�G�0.�*vf�#U�
kU���9v�6�h��s(FV��L�|$#�j�� R�Z��r{,D����"���Dl��oiX����<eQg
�	�:�p*�mά�����-U�ţ�H����w���1�V��� c������*d��İ=p��<��Bd�JSa yT�:fd�bP�
�p���|��&�\<�*���#��m�-�H%��Pg��MiMᖄ�,��Ȳ���ۛ3(-S�?���ݵ�׮/��y�0��h_�v����V�Ѧm���vN�J����)19g�!��'8�;��&Dj���-���dw�p��B�E!`�F�˳�ZR��ψGx��x�bUP���G8fN��+|ٔD,�r����}� 8.�HlV��c<�K���rE�A�p�
�`��G��t�[��#=G��9�o��[=G��Q>�%��������=ejW6�X�Ǟ�T�rޮC"7�ϡ��4!��{MJ^]E���D5"���j=�Dg�PS�|_Jnl��|!��K�"!��ʳ	;v6���wfq�[�
��"��f9���ed�,&�  �!���k7�E��)4�}�@7���*�k���/���%�f_�r�Լ)s��ʖ#����Y�e��6�P��Z�SR�LE8�F՛e��A��"
�S���E�s����q��2�Ƭ�w˘�aLY�YڄmڴG"P��fej��ԯk�'"��D��a}}��B�~;B��^�T���Hbѝ&O4gG��	��Ԑ�H":�x�pP+�Yj�I��X%L�j����ޯ<�<�1��ρ����zT:�=7i��@é�n����4<��#�^|^��ע��z�kW����ƟG�t3�zQ�#�Ț|玡�s��S���!=��]��Ɇ��o��EN����rh�G�"��^y_���� kr�/x ����Ip��XSࣽh�y�4(�P���cUM��nti2a��� ��z�$|��������}�o�9��Ǡ����]�H�.F�˦���Q�4蝰ӻe�6E4"7$*� ��>V� zy��w@M��w�VD���C�n��o����lJ_�_4��R�HG*ҒZל4kR����𺙁d	�i�ܩ!�H��>?�J�Z�mV����[��x"4��#�������PKMa�2ۂG��g����C_2�<҂(���w$������}��ʹ��+s{������Yk��J4lPP���h��@-,�fD8��wa�s�!����\�b��q�r�m��<T��]r��l|�hB �9���D�`c�U��v�+�^�|ű ����K��ɭ��I{��T����#d<0��]�Ds����[��q�o�G����8Y��6�j/q�0
"�չ�4��l!�`:�2��G��H_�zf��U ���",D�c���RF�G��q$�E�;��ĚG0����`��M����E?��i��2�7W�КI��XCL�Y ��u�p���"�-xt��89�����pH��T`%�qz�� ���9|^4iƜ�zT�i�Lu)Ѯ�ۋ�R5Т�0����Y�$g������
��:�"��i��"M�F�A��A����X_Ζ�$\�D@ȁ^T�Rc-�'��A�4M���h뢵R�Ay��վ���~`�61�(��:#<d�h!>t Y���L�U����$�@���@�U �]����&�W,G���14��T/�g�8��ѡ4M2�&D�=��YY��Y�ǚP�]d���M��}d
c,Cxx B���ג'�3���4�N�ȫ��\��%�+Ⱦ۬σM��7�\���V�%z���3��\���X˂^qt�K���Jğ�ܓ�Cl���;�m���즩��[�Ƹ��U�G_�s5��T�ΣWI����S����E�Z�cU��*6���|D@��XH|�k]��/��xeL�]�F*=Mt寶O�	�!q�_Ǆ�s4MB-䴒T�o�'�1����Gz
endstream
endobj
9 0 obj
<</Filter /FlateDecode
/Length 9080>> stream
x��]��%�q����/�S�@0��\Ȣ0;H�Y ���n��d�>��
�Hk��Oq���We>4�������ÿ|��O*��S�'|h>����������O?��}��~����0ƺ����?}������^���_������W��?��/߾.�FmU��ʇ��C�B���)U�N'[��蠌ަ�a�LL&'_қ#[�b�ڗ+��	9�o�벲A'�z�Qb���]��U6Χ��P��XRyW�d�K�^���-�����qKQ��_���w_�cgڱS:�`�7o�5���~<FGй7�uN�譹\�CLI�7��EEK�<}%��s�������`3,Ļ��-��^_n����Ņ#�/W��Fy�u��.�3A����6q����u�*�w�W%'�߻*.��3���pUl�*p�����kޛHJ��C���*�\4�����5�>[�׻�p�<@� Syo��c.��7mûú�Õ�+�\Fi�7�������pς3��C��]��aG���w��^<(�+quJ�!K��`��i__��!�]�q=���"8�;����.�ޜE�rڼV�Y�m�8{�B�(Sl~G�'P$���)~ܥK���o��h�H�l�]
o������6+p���_=6��t���^wW������M��h�ՅG��	���y�	�m�������ޡN:)f��;�������	&��w�^��˸o��5\�x�x.��
X�7O�<)g�^�� :~?<]�T���/�~�9~����O���)
j�_�E4��/J闿��\���+���P�������w�rtn��aR{�0^�C�	~�U2�~�B\�s�16�0���>������� D8���G9��Y�^V�|�3g�Mr
͸T\��PE�QZ_WW���~oXѯ�<o�tւ��� ]=�U*����,��zT�r�1k�����	�������8�1qJSf9�EL�B�"f��.R�+]��u���V���	�J�
��?s��;�n.F7�Δ���6&Z���n,�k�aPֈ��`7gwȢd�5TQs�̓(8�.�|G�0z��|T�6�]�]��]�b�a�E���'��~��,z�`Ye��'p���%v��*�겒������A��/x�eա�/�-�%�>��. �	��b4�k�QV/�C&njIL�am9��� ,a@㯇e��n�@B$���=x�;S��~��0&�W�(�ă*0H�I��/�4�B�
)��b(�B�R�N��g��ɮ�)�3ų��w(�4	v��Ʌu�C/���&�'�%����DD(�'f>?��E��Atѫ���Y�`�q��fT��;$hFY����6��Νݿ���Χg�*I�Պ��F�Ռr�pnq�~�Y���W/��x5��#�Aļ�y@� ���.��NrY�re�m!����&���>	E�=(yg$����dHZBH4��qy�k��Nƹ�8&&i��D\��)+5�l,v����v�e,�BO����;��Й�dy~���`���,]�)�� p��)���R���cb�L.N���ru����U�1�HFA����-��F��e����,Kc�K�k�&8Ab#:=���9K�:ma���'4�s�M���r��L���DF�]�W��`�8g���ʎ��u!`��ؖ܃>y@-a�ɜ�E����g�=�e��d�x����S�E�܎�Eb%����j���"ε�ꚳ� ��P&�${᳕?kka����AYՐ(�b� ��~��"� �^����"4�//1b��6�.���%w.�aǄ0���pLO� �[.@�U�w�[R���N�nJi����Kw�w��I�A!��sv��L��''��Z�Svr6|M��\��'b�s�d�b����J��(�В���r�Cb�u�˥��U�V����C̝�~?��o�~���gg�g�gv��!c��7���h���lOT�'gR_��ʙM�q� ��akH6K�-e�	�0��m����>��|f���ʢs�&b�,�_ì�@�k�Hvy]�g��Z�f#a
��^^��0$T]�q���\E&x�`eX��&0�fM�Eþ�8[��M0���s�L*k�W�K�b?wq{����Q���2YK��ϸ�(]��t��.����}eҺ�ԯ|��ZO( �2�~�T�Kɱ�T����LB����ɾ�8yo�b�������8�
M��"�
N|�P�h�;b l"3!qf����6.���=.�n$���F�L���,�#x)k�=�cɭ7��GL�Z��4����!u�l+�l3�2��%5� .�<2u�!L��6�l~�oґ�y���E=9%|'Fz�J��{� �Gyu���qe�)��Y���8��+�nXײ7,<�Dꏬ��P�l���A~e��sz�o[�Ҋ̱��c�a�+bE��f� �賟͞�5|t��sKSC�δm�#��)p��\񌾶-���`2%MeR�'p(�.��񝨉/��t���P�2�b���\ʽ��O�7��!�"v)�di�O -��Y�T�T�����( x�k���a�U�3c$��-xW�/N�|_M�j~p�N��ou�1��@��ZQ�^&��<,��a�WUW���}��2��Dtk�� &��s�;\ b8`{!�����;��vo��g�?@��`8�/w�q��*9f��ɩo|�� ����т@&9Q) �{JT�9jZ@<��^�V�њ�>˾����z;�:��XI��9wO�t����\u��~�����.7e}8Gp�ݿ6p�&�JՃy��@�WF�d�g�1�@�+��*W�q�[��r�H����dkƍ��55����) zlb�5�7wv�L�dB<G�%2��R�ׅ�ey�p��,&2r�\*&�XC���W��4i���_e5���;�
vy�� �bkh,>�.'b��d*f�t's�[ɠ��w�,f}�\���>;�`w6n=T��6�'W��D���uu��ϣ�Nz��<hK\L�t�5�D�Ҳ|?~�b���{��$���V�8�MX^��u�8�b 7��}#� �7�BcO�v�%�K]S6^$6j�L�Ԩ�Ò�����r1�I5~��ErZgUYy�����S65%�L�"�-�zN�����n�ڑ���U�щEx���!�c
�s��G"i���=�*4W�Io<R��m�SnʍZsf�_5g�,�%_fN�zO�>��1^±���5��,���߲�Td2�f+�N��5P�c��ׯ��p�6����ߣf��25#'�{���y�	��vB�q�����A�/z��Q.E�W>T��� �U5��q�7�a�
_����y�Ć8���3����(3s���s�ờ��e���T�7��$C+TU0�Lܔ�3��jT����X2�@l�Ԣ��8��C�=dM��ly�%��{����1&���	��X�������~��?����?���~�Ͽ����������|��Q�ou��jP��'�'C�O��ܷb���`���pZ0�$E�q��epQ��Iv�	��Y���hƺ�FHR�����O``���}u��]����p�,�&��,�E���[��C�k�[��c=+@��-T&:���z��%�}���:7�ٔBR1�<��<B�p�����/��RJi�ˇv����d`�Ùd�cQBB�H�aI���R1`c���Wk�Z�`q�t;�PLÅ���16<��탄Fw,�OWˠ�
�
���F5����Y����<�g�q��B�?�O�^���-�Xؘ��O����xJ��<��\/!U�W�L�v!�@�R�sX37���_�����O�H�e��7�Tށ�ցƪ�d?�i�x����ӉM�Df���:tTO�>�{�+�f�X��]�������)�hӜ�ai�/�y�R�[*׳+(���`Ɵ�fY�xP���^RB�z���%��:�� ���fKJ�)eY˯�`. ���t��J��x�+���=LOUb�O*�,������K�+a��f�D�s�e}iZ}�wTg�>~?5΁hιc"�Bˎ�NU�
l��wM��.��Qw#o~k��/��Xz1�u�)8)�����Pm�Q��g�3!�ə�"������J.M89M-�[�U��)��{�`�N�1�]+P(�N�Ш5�8��WA��u�ZLg<q-�3N�E����5!sO�����	�,��d����ؚ�p��`��X=��]̕%�� �i�\f����漚Qa��9�L�}��g8���7jc"�
-�p3�J[i|��7�"�g��9�~��s�� �X%ӳzӭ��#�3Zo��%�U������G�{u'YNKQ�0�L����x`�f3�>���6������V�/f>,�F囨�W=��t*n�~�{l<;?�ϰ�|�|����bX�+Z'+�`b��$�/�ͮi���/�����L��&`�h�I1p��K�k��\��i<��w�,���@.-�P�2�:ݱ'��.�V���Լ6����>��r ��{=�}&�����jgO�D�l����n|S�"҂l�;EJG`K��u�Rcij1&��Ҫ��0���p\���z����(Y��G���S^��Ƿzp^�Ψ٤Ӥ:C_)�" ��~X��bO�yA��B���H�����ZM>z�g��jY+��@m��򱟫wR�T;��Ǵ������	k���cXS�j���#=?>$�V	��a��Rm�y{�C<p1\��-H����ޑO����|�+Y�bz�d����b8�*KL"��4P�-a4\��8�Ns(+0k�6����@1g�H�z�E��I Z❊J�4���@���qN�,�ɕ�qtrKO��*�9:��Y����X_ӄ��0a���E��gO�ǭ:?���$b���+�nV;�8+�u�/��Tƞ�lc$u�x�?�8߷�t�9uLJn�R#��d���'b�H"p1�|��@�;��ffҢ"823�N`co�'������u�:��nL�z̉$�V�^v�]0X����6��C�}@�z�� ��aл@�b�D���:Up��JnK$
[��Y@�v�j5��F����\Zp�=��i�{��kt�'u�{�b_�ibL	e�D���{>�9��ZaRYf�*����	"���6�<b^&��Ym�MF#�;�'��aW?h����}�4ў͜'d�jޞ��(�R��;���r��D�[���p"��Ӣ��ӽb>��2*ٴ:Z����g䙮֡��akh�|��P���(�W����e�%sz�2��>�RI"��}�ԕ�n�˚L}	�͚�I��1����wg�� �Y>��9��=e�@o�2K��c�n˷q_��������|1:�Ꮬy�]q*�c��jL�scU��8kq�.�W!�l����ǄL���w'��*��ȵL�q��+��B�m�@��4S/�˦ v�̬�ig_�t쮔Y�˻�G<�Ҡ��EX��+5u[�w�����/;2�2�r"�;�E�|�7|�WK!�]���
	�m�u)۱���hn�c�U;���j6>�J�ݖ/4
�p��0���z�־"95�I�!�)%��e���4�!��3[�/�	��JǏ��Xϩ��5�Т%s���aOp1E};�DS��v���UXs"&�L�bT_�����\�W0�%�
�D���1%�_Mv��ʗҾB]'=��s_�ѿ�4���Yr/Y$�؊����b�yr�U�렓�;q�Y1{S����,l]V��pr4U�����=Ӻ������~>����[��VɸO�0�d���58�@������q����|�ފ�%c�f�z���j�ǋ$��j䆁��;��qD��v��e7E�ΫZ���e_[�n�W�߯����Hs2���r'��*襅�B�Jl��A��4�e"��6���g�
�ܡ�����o��k�W)ö�̰���Z-�$w�=K}��n��mk� �
���|M���X*��������"��W����p���:�-�ؕ����:v�u�@�z��޽���h�+Y	*���	t:.ۘ'�����-��g�x���7�ل�b�jB��ʕ7��O�J�=���:y�$�[�v��\w�!0���p�S�̖t�s0��5�;�=k����N߹S) ���Z�	9��p��#@d#"ۻ�E\��uX��J ? ��v��%��y�#`5
�Y�Aq
�cb?t��MG_و>`��&&�0�D�d���H6��K������ؠc�s�<[�[7r	���q}��[�|Xh=%�0�\��0��Z}�3\9���D ���S։��\8�1a����/�t	Ց��T����}�������ɗK��Ԛ��0�Ҕ�ؿ��n���H�U7|I�T/j�k�~r�z�L�R��
y�y4��L8Aﳻ��՜8-E���`��`�A�r����]o^i��F�\
Z@ʼ�`�����v��?���Hg�&�}HeP�aUH�l}�*��#���Ö�ky;�5\�Kr鬡�\z�[9j�*s��k��L.Ot�7ŝ�]�VLx�\}	j���T�s�m'�"���A[�WR�UGr,a�!�~�p��0AMGib�n�}l�����X`^8��GRh)���[y�؞K�5��RG��b��A�̤�R�-�|����YO0��e��8��4�|��N:�ڔ����-̛�p�q׈��[WPmC���I�x,Xw���q��r�&��K�w_��υ�T�D�^�xJ�zHe�r�$�q��LI$w�f�XA��ar�������fu�2��i�|�X)5O�E)�*S}>1Ui)���Je���v�gæ��e����xJ���Cb�j�e����Fs������6���Q�"��M�eٝV]���vXt����eFb&22uv�%2��3����^1],K��c�)l}�<T��	��Yd��Re;%�q}���x�j��� ��s��o���V�F�J�[�I�$�X�=c���l��Ȥ7f���٤�#� ��m��qRw��'#ju�^�I�f�L�㵦)��V����y��,L:6��Ӄ�dd���?![Y4S��ÛSi>���S��0Ap����� ��D ���<��E=���+rv�<C�[v��0��N�ƥ�d8�zY^�jC"y0���Gy({����؇�W�Hn5^�P�#�܊Ss���3�a��yנ[���:)����v�����8xW.=i/�^��T��ТN�!.-��d���%8�N,x�;�X'�?���3n��o'"�����a�#�����Ij���@�}ã���9���h�U�İ��Bf��ܻ�2�1?�[T��q+�\6b2&�W*gs\���Voe|�L/im�+��U*�D�[��X�&=��.�=g��k+Q��B�i_��v�/2Qs8�2�gV�_�J�L^'�}�ۺ���:�C����ex��,�Y����|��4����4;���zA�������s��:�H��[e�>�ͧ�>�X<�]fŢX^��,��[��%���:�l�HD���k��� �-U}j�c�Z���,Ta��]����j�)Qt1�)������c�ݜ���=�>NX7�9�n���@�R�*����+���c�)�;�]ɰpl���>�۹�3�KT�V&e�*���A�AS��qK�9g��a�
�����?��!.7[6ل��ԯf���;2�����3�,��$���pL)�ݘ�[ Ä�hU�-"�����q/m+�ȍ.���[` l��d��9ws����^��Ά���+"B�� �tN�㱯��2���7�<�����i�� ����q�_.9�V.YH ŷL*�q��|�Ll��e������E8�ҷ F&��-�%�J]Jk� �*���avfG4�����)�x������^!��<d{�P$5>ՂL�Ը�_���St�c���ˎ�$*�n�tkVXҊkS9���[Y�qEɵ�����i�}`��%)'����V��j��r�2I񓵩|W���������Y�D醾?J�;=O�ߒA�G+�Ԥ�|�6�;N�d�\K���'��T�E�)�D�#֎���G��8p�a����h�O�du�ª����bU�/�qû���ʐu/�]�+[�~9�`��M	�l�E���������B�rk�0.6�!C���V�"�1_}B׫�P	X��lnWu����봴=�M�;����#�F�I�Y�{�3�L�{���'�.�F6P	�o�C�sBn�r,���1�J-�A|���&�k>ppұ�I���ſ�lT���\&�2ܨG���9�B_-�*e�z¶�8{��qrvK�< ��f��&r�"DjU�~*�p�a��d�{dP���@N9��
���u���ʱ��5�M��P��
�N�:.6Ǔ�����x��.���=�3�>��}Q�7����&k˨O��i׬����K2�s��KGɾ�W��h7z.�'�^5����N��,V�����q��X{���/z�F��
a�f�����CU�m�������L��1�E�"�����5�0#,���Ԙd��
��1�$���`��)���x%�����^�s?ӿ�Uй��!A�P�I�����]b���ߛ"��7)���1-�]�Nk~�5�<��u��;!p*p�P��A/��eVy�-��Nr���s�T�x	�x�(�F�7������r^ê#`3�Ʈ���Y��@���7���'����#ċ�K���6��7t��H�s�)Vʩ9�ug�Q"�Ϭ`>�9��� .�dX�y�-�O(����jϸ�}K|9�r�,f�W���$�Ӫb�,��Vj�����:a/�4��'��}�)�\����}K��b�+��B6T�����8�5IS%�\[�8��.�ͮok���j�)���z稨�L&��V�Q�>��"�Lc0�"�����I��P���6��ŷ�*��D��؝��ǈ?MW�fyQ����
endstream
endobj
11 0 obj
<</Filter /FlateDecode
/Length 7637>> stream
x��]َ�u�裡����0���@�I���x�q�8���9IQ�K�G=�g\���ȏ���&��_)��h�����?���O�w�P�������Ӈ~m���?�dߔ���/����F��j���������|�_���ϟ�a����?�M���1
�ׯg�w�ȠS3���Q�
Bigc|9��~j��
�WB��b�)ܜ�:�cH�	u�PX�btp��vMy-�����+a�5��ts�ETƾ^���ѧ�����2��l�iN�I�P�Z��F$��Z���)iU�9����^�뽅�j��a]�[�񫳄�!Ȼ������\��&�ho��P~��v:�N�|BFE���������#���M5���l�1�?�:�k��R:�;� ���Ӧ�&CZ�����+xk�V{�6���a����rAy�m7��uNXk����7u��烁�'#S�cq@��'ZH�0�J%��@�N�+Hs��5S*��	�n���ߛ�I'������ZTZgnl�>\��#�T˒.�qݤF�I ���Ap(7���p��^�+�~s�h��&�K�N-�[�7%���W�
����o�^y�LI_n�w�F�bԫa� �pM�eZބv���Jxc/��^+.�`|�7���sP)�pͲ��	���q��?�p5�0Z���n{P
~C�+��� �������m��}@	p�����P��o~��A}�����!� U���1*+�"�_���G)m����9|w����`�����Oo���×ow�~�����HK���{ƽg������w�ʠ\ݙ�TY-Bw�e�\I2���5YT��+�G\�|�NX�$4�m&>T	��؏y���eDgE�$0E�	�	���
��m\�5d����z���@�<#�yy)����@'��X�[�>!@ʈމ'q>0 T!�`sFf
:�p�?�&���7�2]��v=S|�JSF�I�� ����#0��0&6��BR@�BM��rQ���\*"�?B��t^$	����@�=o�ԫt�<�P)|��6ʦ��H�$es S�))	.|b<4(��:��L�=�kO�#���;�/@$"�z�`H�IA���G
�WZ��,{��dPVL���-;����J�LT�|%�'P������,`�[��*i�'|�T�E�Zم�	ͺ�R�� �q�X*�b��N�z�����N���
�����fwStS����5���&"��R(h��H�>/s8���%iV(������B� �"a�2��@���u��د���\�a�Do�_�)Y-�b�Z�նK��iHң~�Y�ʕ��n���T�����(����2�m��K���r,6�����l��Ԭ�$�Rd�H7v>�O���+�R������X�/l�M 奯+ϪU
���M�)I�����E5�DS�D�A��6+଺�wv!�X]fӋ.@�9@���j��ϻ����N�-�Tq9���8�w?FZ��[3�Q�t�(j�HF��L�����9�Vh�|�5
d(׵T��ǍQs�˒�ANX��mJ�����DA�:8d�&V��>���_���Hp}_HA�}L�zy��00�U�.���bg}�)�P���ݱ_�GD�����3Uӕv��c�o��m$��B��.� ��,�o���%��*����LB� %�bg�)#} Re�	�����l��)�.���D;�+;�3��Z,�4�2J�`Bi�y#�a�E:����N�o�����"ݰg�P��J�Iԃ%��|�_�:O$�:z�<�f.6�?4�1&.D�1n3=L�D�iMU�8�s���BZ�%vd�¹�:i��N7&�=5�K�)<A��T#��{�ʯ�����gqi_�j���
F�o���O� g{�&rP@h�0�O�dQ��Վ��l'7/yq���M�I[����D�ǈ��*��@k�J�e(�;.\�W��	m#��Պ�JV�chV��#IV���-�b}�8���q5�Y���3iqt�m����r%��������IJ0+	�!�e������+�c6h�5����>�OV�~��dAu�m�${�Izt_��<"������n�c�Pk�M�w��=<���"���G�q� ���ʼ@W���@�t%cR�����m��z���Ij8z�,�άr�]g�K�J�zAn�_���~�L4�7���og� F>`��@�f\��?++��Dǫ!,�~�8���`�'�ם�A٥��ajwD�ָ~�_�]�V�>e#*�v�Z�n�
P�}R�Hw||4�6O��,<�ߏ�#AE�fl� À��L1��b��"�t`�cQ�E��u!aN�3�s�>��aF��\/"H�%��{�T�h��]"�s;�u�hF�QtK lsJ�)0CK: ���᲍Y�cc(�DA�`�����0~����1�+��N�����y�O��H�@�Y�{4��8SE�d�k �K��f[����$��ȝLC�-��	��
�#pߐ>�h�w"�=��ؔ U�I�}�+QЈb�o�N�υ^R��z(}�!1YHc�zϡv���[����}"�=������O��&�1(�ܺn�C�{	���W��c���S�#Th,��8c�9Ŵ�狅#��-v	�7�	E��,|��9<s�:�,2�#��Ɛt���Z�EwY+})fޞ��|��bhn�vf��5h��m���|_Q �qM��-$��ﰐ��!�0�-1ᾠ�#BXX�u%"�uo�5P��x�@{�A����?�VF��h��wü�'�+P̥�X,xƦV���Dfq§��+����C��Oq�(�=����HCY ���<-�@W�Ƨ������ty_5h�L\�"�l��7� ���mq,��0_��'@Ne�X槑�Sñ���tS���&��
�9c���ѻ�)�����㈎�5��*���Y���u}��zƑD�5ܶ�d�U�Tg��t��FCeA<�qaA�%ɡ�V��aI�T��V��b�aa���\'�W��.Y��a�]����j�E�2W�����R^�˯��eA���%�D�рd�zT�b����.��UR��<�b�7�t?��]�^U&�%��tB~�N��n=]4���Ń��0sՙ�X2���hx�k�sD�Z��O�<eFD�*�)	.D�́�/<�D �	˂W[��qJTJKh�q�)�fR��Yr���yg/%ܣ������7~7�t�D��9_cN���X��I6(+�[�1�9��s�Z����9���[9I|.:�-�C��$��s��1e�]_2�R�|���I�!��f/:-�	�.�	��<�|�"a��2��rѢ�&Ih^�7�9$����\ҞE]#�x(���PC�M�r\qdr�9x,z�X~����*l�@O����b,�*���f�|��i�Y��i��AGD%�R�r����;A!<��@2O<SxP��-��"�z��m�����H�C��\"$�d�R<������ՠ�7Q�v�����L�+e�ծ|C�%������U�U;�U_&�-���ҨO-F���T9w
<�I+��ӱ|}�0,o�Il�5�1���E�f��*^w�߿Gq#�����tbL԰ãϼ+%z��¨�3���%���ɠ�p�c������cn�@��rf�������5�13��H���ˈ_��_�����s9
���p�CĆ�!H3X��<0<��A�����=�B�N��Z:��a+���0���ڧu}h �����?4:��:C�򊵾�o,ˋ׃6�� � �z���K�A�!��z8���R?��`I:C̟�Cb�Z�*\tހ�} ��2���s��K��M�^ �j��֙Kg��j���$Z+�<^g�5���")�B���I�ԖKX/IrS�0�-��������[@v?纚^U������҉J�	�%���2����;(y����K�L��knO%��S���$�3e|��nR�T	�L�3l�SZP�!'��@_�*�-�l@Kzilc%��EM�i���<gꁢ��j��*��Z����ӟ�"��߃|ʺ�,�]�#j�<����dAW(��.��Q�b�N�n|����[�������.�Ny��/	����8�Mx��3f�j:s#?M��
�DS\,�G���ȬR����t?.��X5���
��Gm�2j� 7fi��R!��VK'G}^W�p�e�[�d�v(~u�����^�s�Rӟ\��v-%1)w��~��0��?������}��뗯_ኾ�S��\����H��P��1���`�|��F�;�������G�>�:cU%^�~~LT��a����?3z���CM�	\)�tk�X1j��%�2)fq�:z��!��0h2�j�q�Q1����� �gl4<Kյ���~�u��aR���u\�~�h|�K�xޚ �C�ڜs���8F�~��E_w��^	��q�s	��~/z��k��~ff��z�J��D��e���J��0+m<�7"�����
ž~1�,s�Q!�{��ߖ}d����I�.��K��x�07D��y��O.��3◲2�rD�c��*@��`F�
�ϫpDc6N<@�u*��/4������n�#�j0���/�g������ir�8N� ��81��4�G8��q�Ӫ�68N'���KH�ܙ<ɒZ���n�!-�Z�$�Sn�� #G3�}+k���h�7�[���x,L�;*�I3�Y��1զ�k���K+��t?i�:����u3��0ބ��8B�}ʇ�Y�T-�� u�/Mِ�Y�=��wl�pal<0,P�B�5~	��{J���q>!b{�8_Hˇi-C�-!�;�����K^xw���r
���Sė]K��虾����&' ^]M�'����#�յ�.���e��xe�-4Ґ+M>�T�h�]K�i�6���'�O�l�'Q(�k�1s��&�������i���"��
�_�x�K�u"�>��M�R!�2j>��H���������+�gc�@��3n��@{|"���Q���;غi�:�H b}��	W��$4��VC��ڵ��]�."��T���F�1�Ƌ~��v��l:���jF�ݣ� :�R��B���!4a������	����qZ��:��I��*��N�����QX�1��b�^M�ص`���铊�2�8��$vD�,?��b+��m�V���O��U�@�RH���_OM�?	]/#	�����"u�k�<nUj��e�c��Ŋ��Cֱ�K^��kE��bЄ��qL�Y�7 CLS֥���t�����@�t�B�xۛz�F�wh��4�U2t�U�m�k�Z�u%�lcl	We�̠�ٶ"hV�����2
R�w��iA��u�>����Rƴ��'��E>φ��,���ݟ�mNDb)-9T���ʻfA�����fA�gֳ5��]��hv��r5��c�R��Piv���++����&f,l�T���$+��0��%X:�l���?t��)�FK	��5J
-"s���{4Y�=!�6���L0hu�q'8Sz$�h�-��lC��2��}Vfo#64���U�%���ۇ�	�m��m-5�[����G��9�����1	>����}<F~|,!+�/Lv%��b}*BLՈ�|f��c+��h�
�M�U~�Eky�nf��ys�F�DT&��O}�U
���[>8g���*�ޔz<lޗ����iM�"���CYJ&���į�����c 5-95ϰ�IHKvu쌳�(r�
���$k�cƔ��uơ��ª�m��IL
���F��G̡��,*k���M���13v#�4�	��,���̱w�-���SJ��Bܽ�@��Lz"�%!kg
��u�D�����#� �vm+&��@�������Ѳ@��j�ޤ<�X!1�a#�M�\q1�0w�{'L%�A��b=�;���h�}'ŦEKg5�����2����卼'�-*��Yh�m? =�xЦ��f�M��f����l�Xr!䥒2�hnl+G|/`�N��h�jk�Ӥ4�KZU��@S5�P^ٷ������ޮ�F3�"3��>Ժ����P|c\��M��8S����0���"�^ʃ������B�a{��@����G����:�O�xN�1X
`mH�Ë�K�u�"�4����;E�ki���S���D�jg�3���e�ՒB�֖ܟFoqWr�K7ޭ�<�Y����f@�|4��g6�z;��g�r'�E�����8��i9<.*��0!����L���Dv�Q�&@��4l	�,t�ɹy��F ��؂�}!ni8�/�7Ѓ/�o9h,��}���H@27|@ 5������x'�_hTbd� ���ŝ��h��ԗ�§�+N��ݓ��p,��]�)�:9��\�u��
ɧ��1�����#.=/h!Y�2r��s]�-^<�,j� �Q������i�UO��)g�9}�>1��͵���ˤj���jհ2�	����LV��R��{�������Sa��4�(��G�w*	|��e����#7��ld�hh��n��J�;L��b=!~�}8���S'mb�U�29�G���Qs�ݢ�kJ�p�����U�
�&��P�-��4)� �4�BS@I��s�A����u�g�Y�r�{oh���{�͔�V�*Z1:�5-�x���c��Awi+"�{Ŧ2��E�4S��5�T�hN�ӳ�b������6�j��7<2E�.�Rֆ�Zj*%`�g�y�Ő�H�Uc���1����/��gԼ��ӆ���pq��Y��5��g�g�#m'��Aev�ۅ��h_�Au�6�v���u\�]���5'��9����K<Q%�wU��E�hzDٔ�"AN7��z�x�jS�lj�%c�N���M8��iv�ғ8����xD)��
�N��b��&��2x���T�
�Wf�w�z�H�Y�`�I��f��S,,̤����u�i��M؍�_%���� _�(���
9W�*u�Z��
ˤ�aTퟘԖz��!��G�/ELΣN�t�m7��9&������W7N�V֘Q�@[5�R2�nY���җ���eo�N���x��9��4г�.T��A���9Z��B���K8Ŗ�:���f�t��WPyE'\��[�˭2��:�l��N�;��4x_O�j eP�\���hY����d���b�o�k��xd��'\�~���ȝJ�'�;���48ll;X�9?*-1N�'Kl�D�����)�!�zv���ô��;=���J��,�t�8<6��J�	۔�����e�ZW�s��HH�}����ɜ�����Szʩa�>%��F^b�[s��(CG��j��F�o�N��{�- Kt�*�Se7;w"[���A%���!�8k^X����%/e����Eaaa�:Yc9�3�ф�f��ja�����]��M."E`^�m������L촏�9c��~��=�-�&!�s�����Ev�,��,�k���M3��<�CU��v�M��׻S������˘�s�݀h�������c�9�Ɂ�֞�c�]�U|���P*����9Z�h��2��l�������
endstream
endobj
13 0 obj
<</Filter /FlateDecode
/Length 7465>> stream
x��]ٮ&�m��8���Tk_�� �ڹ v��c$���q�<~��T%�bQ����9ӭ��(��G��1���rJ���O����fu�i�~���?���[���|��W����.�w���B����~~���V�����?�}��������ʏ?~��9k���Ͽ	5ڹM�/dܴ��
oL��ƅV�]��ƍ��*o����,�f��#��s�(�.ʦ�vN�F��8#6����q�~���J���.�u��R]��&�3�zqsX�7i����8���[�
�7/�7W�2�5g�ۛ�
$Q����`JysX�7f��:�?���X��.���_^"8��k��>��Ɲ��t�ds����Kf�+���,�d����.��$W�j�6%���K�7g��W�r��U7��fS���q�8+`;��q�����჋b�x�FvT���߈�í�n��㧸%�ߴ��O5Ǐ[.5L��,�T��\��K�yx2��9�鯆��i��ձp�����:z���i���C����5<��渚���F_��1k�Cv󙆅I�����}u�Iw��,��n���Ɯw0}s\GR\�Q�K���-�ar�^�ך�8���-��s���+xկ?�ת~��7C����k�0n���m^���4I�(�;�J�{[e�޴7,즻J��bN]8��l�{{b%,��➭X֘�i7�J����L\+A�2��k�]�+�"p��j�������U��O�߽�f��~���;��U��>\��
2r��;��_�>0&��������������0��1Σ1�61n�y0u����+|-ᗁ���� ���� ��Lx�MN/�V���a����K��׈����K.i�ro�MZ?�����Ry�H����Hv;+�&<\�pa���j�9��.���&~pQ���G��A��7 f9�ȋ��=JN���QRK���,�)�l�]^������i�p�$y=X�mٯP��JFX�(�m̏to8�E]j����Nl�Q]*��Ѧ?1����T��/��Z�n1^"	n9XX�k����-R�Z�WE�
~"<"�9�*��e7�b���Ԧv%�@����>"ƲvsyH29�E�o0N�p<�g��Ъ̤�r:����Q��x��i�1i�n�$�t��l��?Ó�U��R<B0�șWD����Gƃ�ݍ����GR;4��.zgx^M�[./��
��q&�9��"i�� |��s,�2��*�1���VBx'xk4�,��I�I���D���w���fE�^��L+�`����p��ƌ�X�ɷY)��ѭa�MQ�0cZ���q���!�5Y�)�7�}��SsNo��IQ��p�y��8��t�"@���	��#}>m||�'W9��?8�Ϭ3� �@.�	XR�sfo�!�g����<8�6S�=9�7ͪ�%I䒾����e	`Jz����Y����5	���Б��x�-X.po�1�D1a�6��n�O˙�����8S05��pŲ6��Q6��lghr��=�_�&�0��'����'<�$���s&�!�ɗ�a��!�ۤ��x.�%}�܋��H�^|)ph���]�'2����y�Q�l��k���(�m2#=1�Z^ř�>:E$��I��5:�aF��Q7 ��q�b/���Н�ן%�H���r����Ĭ����!�8���Mk�ݡn�d`��`�.� ��:9�h$��xn.�gưw�j/��.�5�3� �e�P�g�#ȫA
�_ob�u�0���{{�~y�o�'�6��	�`��L��X,��b�|�Us�܃�'��H���e�/[˒NMbY�E�cX<�HrW 6�$��+��sF�cJV|�,z|D�P�J����D���Ŧ�HS�3���,��*\�7-�q00[���|�a�g�\\��WG��)��_�x�o�?85q1����9�ޗx�&0;ӋB��@�f#h���������Ft��3�ǐ;u�e�pX�'"��h��]ޝ�He���w�&(<��R�!i��zG�~l�*sK~Үo�<�[0�V���{	���ΐv��f��
EX�d)�-�3���BK27���q���-�f9ʂ\���
L��M�M����h��h$�J��ҢPB/�;E]��i���Q�Mf�.2rff�G�,�s0\�A�|8�%z ���7h5�7<7(�_,c��!h�|E�E���A��"�ޛ�D��8����ʇ��_�2`������.g6�V��pΣ_0�گ䠣|�y,�P��N�/�&���ǔ M�������c>�)˓�b>��������a�c{�Ѩ�a�]�=)\�&>Ԯi�
��5�@�M���m6QP�#����C�K�J����G��@��
��0���a6<@H�l�VD�Y2<O���^^�N�5 �d�
��S��Z)K�Fv����6P�H#/'l�&Ƃ�^Yi.BQ�*[�;'/��[C�� �	b�I�: �K	iz���W������9D�8�~1�R'��Af�R7�o�'��-ӑH�f�`�6L�;@XҸ�XhZQK'��,��euJ�K���P�C�������P����;�'�(�t?�Ə�V'"��H�@��-��D�=�L����	k���T���s�͇��!j�#��;p\�˘�ňX�oPE�+ϓ)��2]9�� ��G܄�?�,�#��*�.M.�k�5�iمx�ʗ�zS�@;�$����F�}�a�t���\B��Q;�2+��}"�T@�Hל�,:��ǗDK���O|���$|y$ZD7��������4��Iő�ƕOJn4ң�0��d�`�cًѲ����V(���B��@�6V�J\��b����?�tb~)����@��&�ce-�1��S�����-n �R�)ߑ&u�Cgӱ�����P���K+C09��z!�IW����х:6��}��}�F��s��%��(��#���h�W&k���8��1��bE��fR o|/���Њ��+�`���:����>{�7L���=�5}*�w.!��)�XR%�<e�*I�� ˚��s���h�r���zy[R� X!Wl\=�%��3����ɦ�y�����P<\��X��
Ҍ����*���e���^$�B}�bzu�? -!��5��(�v1:;�r7o�-�2��$r�������z)ݶ�}�5��_��w������������?�������?��?����[�g�����T�����P�T��]���vb����D|d��H�6<����K�� ����$Y��R({�~�g̔o��=cl`:I��90�E%�SD挧��h�Z��`�{���o�x9\�B�y%�UirƛZR��˲TӃZ�M%�n���*ǡO?�bɭ�BY�g%TV���r]d�F��`r+'��(w'$��d�pT-�1K,��` �T�����U[2�tCKbKD�>G��vD1�r9���m����op��(�/�uhʕx�d��T.���qwž�XKdPL��ǫ�~��ܬ�L��8�c~1��(5I��������X;־b%�|AQ� �_d?H瓝�,�A��eQ:�}9/��.�_�úg"�w��DS�a�&�;�wz��JO[ީ9�Ӝ���T��i��4-I| Q������ko0��J�JFp��X�g������Z	���-)�k̑`�TN���F�h!�	�<p�l� �6������s���!�$S%�*IG��S�-�#���l|�C�h��#�/�8>�O�ٚy��d��Ǌ�vD�H�\Q��,�,�h��<B���Ԍ\,1:*�c���JB��M �V�l�ߟǑ\닖g �*�8�q��:���en��m��
`��H-�p�����؜�e#5#�,Np�Z6j3�����<V�
%b0��9z��Ee3^	{5����#i�P�V%��(jP2��]^B�M������F����)2�"��f����v�;�2RE)J\«�C?���0,��.f�����a��|�Xv��������$�b��<Ó1Ɛ�OT��dT����]ejj'�]�+�*i!2�,�~X['t:�Ed�1/�;�~-�Ѵ�#v�����{�Ru���9e��t?#������!A����Ga�>�4�97���FJ��t�d����5�GI$"J�DM%�%����i�X�>6�/&�1û��(����=�,=)��<�հ���^���_ވ0&	_Q5�C̙���P>�L����I��n)�8[���ޚ���a{I�N��i'oo�����\E�� ��P}2"9�$���
�	&+_�	6+��E�#[(���$��fg�T��h'a�r�̏G=<Dj�vS]^�j�yF���ɏ����=��7S��25v��j�a�L�	�'] d�_�>W{[B���Qp[�պ��`H�iCu9T�ꓙ	��r��"9��x��2���qE{F�Yvу����b;��Җ��'~\���̄]�?����;����>�[�KJ�­�����x��NO��Q�6��n�U?�A�l���m*�e0KX�-29<iFk��x.Ϸ��d��Z�_N����N;ߪ8�'d�p��%���۸�<�����d�D����=G��+
����*�bI�t1-��f_���S�ζif�<֨��џ��i��P!�8��O`&����M���V��`n�����(���?�^dQ���ݪ�"S�s������loΐkT?r~]*�j��gk��%1�V@����s��ǡ�P�����1{О:�كc�怞+2?̫m"�_�}�s�X�:U�0�~���!"z(�8U�m�Q
b�2�#ڐ�:�#�z��|�:��M4�K�����*(?�G�cږ��8�������[W��LW���4F��n�p�З�&
myhmg�r�^�(�u��� s�g�Ku����h�U�[�#�� ��wL��.g�.�u�e͏�5<�S������:��ߢf���{�G�����C��C���W�/e;hr�Q�U;:9w��E@{m��R)BJLSr�qTɊ�O�,d-��Z���k�(F��cF�"�ĺ�.gQ����j�ty�&�c�hs	�K~f��_B1���MX�H^a�uG�6�_��W'6M�p���eW��#�FI=k|�c=
�q��IQ}C�$�?_J0�ާ(s�'��2ї�qCQ3$$�yR$`�T�s��*z�]ѡ��4V��T#n�h�K���5|QzN�e�V�}�Wd�S1��LOb��D�����ye��\�Ԏ�a�H'���8��뇖9����J� ��~[���F��MNպ?�؎+��P�|u�O�fg�ٺ~v��0��m��/>���61�(2�y��Xj�<�hU$�+���s��O�=q]�/��I���86�x�(3�4�$Qh�V���5&s�VR�[�k�YB���
:�|��T��sZ �[� ���69P����rT�>��˰&ڴdHE1��,Q�'=���d-�LNf�R�?U#X�:)��A�8z�/䡈��&h����;v�=�%�:��QQ}��,j�kM�w~E�5���q��&d� 8�5"���mW<�����T\aC����!B,	����E���c3��JFMӞ�PZ��A8巉�Xqݫ��������f�G	-:�j��a$�5����6����dCE�K��#�Ζ�w�#�5ղ3sJ%_iB���I�H�A41�aXܤ	˲�
�x����B/{G�O��8)���Nm��qL$�j�1B�&ܲ��
�ռ�g`Q��m�#pd�0r�%�T�
bb H#f�9�X�0J��Ju�����H��x���W�&jƱ8�#�k͹�^�ʴA�&*7j�)��̉Z�x��\�1_����ݒ����LU���C#�G�8h��p��q�G��W`�\�1��ߴfη��Xϊ�e�9W3I�Q;ތ�z:�m�]���y1�L�P�����8 ��$y��I���z{o4��E ���:�4�u�_�U|��*�>��|����D��Ҩ�(�"�q����ҥ�@�	��$�zO�8ϲ�=Ǝ�IHfC-�4J�񍝅%�kp���,W�j�E��� E�� 1/РWFL�3C�b�57���U�j[�ɮ����1�Cl��ȣ�4\�r�
b(~2�[�R��78�����h3q�1�y�%T`���|(�`��܍����B)��m#KO����ȵZ�H$}C��N�.u�U(�Lζ�9l�����xN��=�EK��,��n���z{a�A�G+��z��-ҹ�Iy[���\`����Zm������H��Ut�U��"ZZi1��S��D�j��?����ⵓ;gM�o��^p������Gi�u��� 2I ÷Ѥ^��6�G�2�$�T�` 
�����ÿtP�	Ѡh���k��[A�KM��K�uڥ�C�f��
��&�v��"-`l��W��͑�P˧�t@�W�8������ m��1V���J���@�����!(&"�]� _���x�_���#�vIE*��i$�F�Ծϩd�@@������,!˳�J��R�C0~�R^c�!�����Vj�>B�����U�A��b�qУn�U�ۗtLۿ�\��Zضk�^�jE|z���$.p�ߏ/�H���Cƍ3*���!��m}��¯���ë	��Wp�����_$���M"�� ;d�Qt��U�*+�,��J��m�yTҗN�������*9�K0����A��|۱��C[92<�T�C;�]\�c\n0Κz̜�w>�sVk�w�^h¥����4:���W]��g~�i^����4�Sh{�y�$D����u��O0�h���T.W.�r�����/�<��#1��kj<N�vMF8��k�f�D��'�9�#�gC��|��J��H�U��K�A�(IeԶBG�3ۺ���"��I�5���3в<����l���<��2){��visT[u���Pފ���^��u5l)v�}�K@���[e� "��{l|{6,_�$(=הy�Vb(b`Cs�t��:^������/9�L&I�s9��Tf�V����{��q�_dE6��1#���'�YkaRr�D(�I�!��a��C���[�b;�N��dVt��lV��̳�}�vW𩉶_%T�l�C�I���Z���Ñ��B��g���sԃ�w	_rtfO	�זؘ��HW�*�5��Ђ@�۱Hݞ4�EsdHݼ�\���4��cо��k���K��a,7C�:�+�fog~s̓��߻�l-o���\i�6�*��ҋcyاry3s�V!�-�1�[�I:5�$�:_O�3Z�c5��>�8Vcn��c��E�ʥl��M|����ސ
endstream
endobj
15 0 obj
<</Filter /FlateDecode
/Length 8026>> stream
x��]���q��S���9�@@�/�b �^�pl#�$���Sd�x���.��3��T]�j��J�q������������3����C���O�x;~��?|������!�{��R���w~��;
N��F�x���_��;�����%��\2�ޤ>%�=3V���;���0!�����ϙ�Nx���IY
f���������xo�D��U�IÃs�+�0|w+�f^(}I�I�mp�fX�s�^1�L�O�~����r�r9~�p���\F,(q�s/��Z�<O)l�ĉ+��j��J����V��׺�Y���:�op+����
��d�g�UDv�yؠ��4�J^��R\r����J����%�Zrnd��O�R���sAQ�R��	s,��+��\������|O��axZ�N��훁���������a�o��\�p��|E���Aܤ+�b��,��V��IXif����A���� �ET(w�g��/-D�9�ݿI�:��b!�aP�F��;�5�� n�j�ls;�E.n~�p΂��&���%��nX������=��M�ڂ�w��]#���u�{�t(��p��$���m�)�LLioH�_�_-C��^��{��_X�Y+=Sv��y��*`�����44&ܰ*���x2�&]�Ǡ��s��
M.ao���ǽWdA�	%=X���qˬv������g�X�Mk��<�X��\�(Loҍ��1�����?<_�����}�������e1eB|���y`^����_�>�~?�}��p��q <��	��;���J��B����~��]�����@�I����������kO �7K2l�=�=��=��q7)���/��K�B5_�6:����M~�c�#��\��u��,=��Ռב����,��[\K�%�o�Mt�҉�x�SI�.O��`�E
����z����]�����<��=.��<�1�2_�@!�93/�
4��s����W4r�	EN<��	˙�Q����ӿ�,�Ն;OZ�����EM��k���,���zy�����C��X�$�1�şVI������ a]B�	v6;Hn�nx�4$���	f�T��XR��,DA5h`�x�ƹ���N�����w��18�{�O�eA:����,9f$CӚ`Q�cd�w��n�����4��`��?J��@����t�,���},@�F�?�8GiM-Y�;e���wQief�+��$ƶ9#͞,�f���h�#p.�GF�ʥ̗�m\V	��y���hw�)���[P�iTzE�)��+������=k>ҾyPS�G;q�����_v31V��|�S'�˨��T$�z�FK6'\�
��Q'|��8�d�7r�&� ؉Т�	�I�sU�!��ݏlFS�5m|&��0m%��:���j�h0A�In�c�15ߙH��Ep�_�AԲ0�tSMz�B��<)y(�M�N����uw8/Ë�U��.]~��r��6��Pp�e	��A��}�%{�)�&!������KX�g��������Y��g&�-��f�9Ya�}�j'�5D�6��k��c�[�$�����(�����R9|����������o���]
fo��8^����x@���S4��H�)�NBEM�ǎ閼�����ʶ�����Xt-�)�h��l�-�N�f@���������^�j��Au��c)�ޙjT��A��w����!��ᰜn������S[k�+�2���{�I��~�%�m�ID}�sD��ż�z�?N��8�[t���@���i�-�b�$�h���sn"�U`��qGH���/��J��]xs�hNx')�vx{<���)O�{'�>n�O2�m�G<�
�y%��yBV��t�&��[`�jJN%I�۔�՛��h�Ł7݄Z[y�dR-K�w��fp�V��	lT�j��*���=��UB���1�1�-�Ғpz��;𗅓�V+)������Y��3ڷ��Tᤃ�@d�+�"��D�N�����4),[ו��`%!׭ğp8�WM��xk`_5��GjS���.v�޴���5a�}�h9N�m���2���e��{�W�Y@X���Jn(�����\wL;�����t:EI�,��s�1N�N=!�j!�p<}�6�Z��I�|���a	
�~�����\�����������O�������?y�������~��-"�>r���_����9�X��*kڦ'���&����Ɂ���!�g��`g�j)����69s2�n*O�0�fbTI^
rXg����/�kch%�<�|ƀ%	���)����i�<RzUBA�!�2)s�K} N��� ر'�^�}����1�����~~z���d.NL�	$8�N1�}��$�>�~��uɰ𕰺8ܜmv���@%�6 �*��
_ۂ ��V^0��+RW:�N�&gp �d����"�tlC$�^��#ƴ�ٹ\i���7V�YS�'���W#����L�Wer\x�J�Đ)ͯ�~����7���4�o]�ǒE,aP;cZ�F)m�=����U�v݊ܩ[Q�>E�9G�Ǥ�P7@����h݅k��n$�(_)g���V`�����}]�?y{�S6�
������hu`Q�;K#ǁ��V��a�~׮k�F��	���׈���|�܆,��C��E4���}��M�Z���^�!�v'��p��?.1���Uj~B�C�4�E"�:�С#�,��ы���sk=�%\�SLl��?�izI/�Q�݃�"��܈��f�E�3�=&c�A�y4y7u���3����#������c�e���/W *�lݛ/�3?}�)���@3Wل�n���~� ���,�#3��`�l�F�)ٙI����^��4�X�^s��{�;�)���yLbk,����J���8�=�b
k�������U�NeɄ�ԛ��*�j����"�����-��D�y���ȕ�� Wngq�AY�*��nu!B�R�JRM*_��xѪ�$GV���}{��6���=Y��ɮXf����"gTf=KY֐f�Y���;��G0r�%��І����\��j^����Į`-O�LI*��=�6�7��Sf���F��\S��kZ�a�u�C�$ZD�`��@x3k^B�DǦ��krO����l�[?ڶ�0�s�T4����_�F>�,<�K��c���a��dZ#�^��~o4c-+-EntA/l5J���qO��X������=l�p�}�!tM(��5���cl׀�����)�7~_� QL6���Ȁr�/�8����Vj��b�i�I��燠I��1%ػW���tb^%IJ��T_�]����+7��i��F�o`e������ ܁5U ������:�"8�8p�l�Y4�'��/(�֔�ơ��\��{	S.���ڮ)A0����)欆�8�X�U�ȕ�b˩�6�ys���i��`���Yzv@D�:��s �ê�>um0�F�M�aW�a^)�ɝT��5�m�P���͞ ��T�试�����s:B25���`�Xk�SPoz��h�J6����oR=P5��r�T:p���&�v�h��MƄ��
V#�J�ub�-�}�Y.��%E��<Q�R��D����
Ƅ���Д3Q�nL�,Ue�푻�1����b2C��������(�=��M��U
���)�d�]�۸���􎩰Gj��������n�<HY2�[<)Y2��7Tu[r�ц�\��f+�������;��Wd�#X����h���f��ʹ�b/J�E|$�@=v�E,�9��$�Ɨ��bؽ��F���2h/�Dt�Opnrm>�2��@
�/.�IZOo�3o�r&�:K�GcMΗm�ű���~U��=�7b�A��ߢYX�$6��q���6�	��Q�q����������M-!@0��<�q'g�ػb+�+@�|(���8�-^eL�����+�5ds1�_Fa-�l1��}��uz�Ȧ�)�R���_�����~~hZ���ꘪ�,)��G���8�I�s�ӹ�}��\�>��e��#�x�"��w@���;$̀I�����a�a���%��`�|ş�`����i#��l;�vՁ�mk�_��=z�e���Hļ�85�������Yw�8.�
�bӮ��_� �d�䱬�����--�@D�̾�Z~��W�Pn�4Iw���b���)�W:����i�E]��gWUiWsמJ5!O��o%��{�X��E�b�Q�!��p��h���䈀�]wk=i,z���� ���p.���Ǧ�"#��2w��q#D��4b&�<�J[��c�/�'������wq �����x6���B�W�.�::�� �d].�4��Џ�랼ɛDD��9�,w\����k�z:�d��/��`�q
��Y�E[Z[L&p!��f7Ŗ���K ��N&�����U�kO��z��XG.�G�3'��`�~<ҧ��r��{�a�*�Z��h����hqG�>ڐlI�	XDA�@f,%�����lmSGƠ%1��ph�=�lzנ_BE�H�TE_����n=�Sr��6���s*�"|��dO�N)�)]%o��C#L~��P<���OQ�C��/N&rs��]�LG��~�ۜy�S�ཟ��Ӱ&�퇫�j�`_����[��tt�bg��\6�𶇇|����E���m�i�xIĥ<Ɯ$��v��z(��jU��ȫ��1Ԧ�$DS��l�]����U�1�g�*����|��R7���CX��z%ƛ��8E������9�AC7�b'(�6p�'�0�4��C�Jܤ	@�YzB>o�A5d�N[��aϱ�M��O�{�,� 69�q���6�
�U.%�,�>w�0[�T)�8��w�I��/��69{��N�r�I�IǦb��B�h&�l���!^c���2|�O��/�Mk�Ѭ�8�AN����\�*�=�1C~�7s�E�)���:|h�ߍ$�ަw�'uʖ�v �&�!]Ҍ���/�-I�=��9w���G���R�Ѫ\��}x�f�:�b0iaJO%��!B݅�W��(���q�Ռ����ז��7� �z�ӥ���m������=���竘�$#b������$�^N����$�M<��ܼ$��~E�Q�e�:�6��vi��xI^!v	���I�<b�0�͟]ɻ�Q���5~^qQ��l��x��<�OxjRG����m�f�g?���:A���{�'�&묕ƣ">�P�l�k����\���,J���qO��]2���KϧEU�i{�W���n��^&q�ľ�Hd�gQ�{2�j5ņ�'%�Dec7n���[��ǿmw�cM��.�R�Ǟ٩OI���(qi�($�gPd`�nvI �z���6$b�����~����y"�xmD#</`M���ς�7�QC$��s������q֜�4�D��x5�/@�b���=��)N�U�)�^�}�:1f8[�mp�Z���Ren �\�����Ce%"'T���Sw7n����@�lo	=-�N �\�@7b�b�������x:dФlQ��ݔ1z1m���ԥ.n�O#��e����T����4IV�Z~��)��p˪���S{��W��09�йfm���)�ׁ�N�����l��1�����*q�(�8�p�=ǘ9��Q�XcD���7<�r��@%�F#�:���"�ò�j"���>����fѴ�e�������u���ժ
�U��r����r��rL��k�A�X�˷�����8Dz(�f/-���"Z�"b����ܵ��Q+J���s��c�Z�t�}ޢ}�{x��Y�]�ԅu�t���HKX��z�q�����˹�ʨ�n�_�б^u7T
��<��u���o^�T\5����b�k��>i�s��٪R%>�W�L5z2=��kOrW��m9x��
���M�D�[��Lƞ�Y[�{9�];���NZ�z�k����u��B�һp����;j �B�\�
$[������T|M��e�b9]�ʷe����-a�@�q�R�J�N��R�1���u+���{���~ҫ��"�\k7�dsA���g��q�/�DA�h9p��oc�����tML�JU G�
@ה��Wv�p�KD�n
��#$�mq�˵ͯg��=�&=1�#�I�_�
m��~��)
W⿷Ez�)(���T.�~�ˆo��ȏy�=��J����j`��j��^Z�ۗ	�k���"����2�(�	�v���C�R�j�V���5ށ�	�6�
���gb1�u�5#���ؠ�������bw�����vw��6e�WĻ��-.�6�$��:�
�GU������7'��R�[�xq�`kd;J6�a�w�d����7�����\������pb\Y,(��+{Iwb)=��mq	>i���q�҉�0 m�`��K�)����� Of�ItFS.�"�e8ɇ�$�R�;x������M[��.�[xw$�=?�km�p����Dq��0�MuЋ����1'}�0H;�kY;*���ڤ�ԛ���@S���~�r����՛�O����ظz:�o5���s.���c�=�K��}��(���ݑ��x�F�ؒ�=���0׬�冱
�R.#�;��<���Y;4}��|{�{qQ�i7z��R?ܸP�q����ن�����k[����w/��s2R�v�|?��+?�;Î��b��L}EE3>��W�bv��$�m��=���w ,WD�IBUb�j��Ҟr�J����]�Й��[��B��{�+2��V����D }�}^�5AVƌ�u/�.�V I�@R\�L^��Dm�Ȝ��RkfJ?j�}	w��g%�KQ� ��	g�i;�Q\�o�Y��2gH�y�0):��:�e�@O�	�f��z��L�vaW��t�;�}k����xK�Do��E�m'��I���ܹy��T��Jي�X�y.�y��:
ÚB��.�s`����8z"��Pe��]n���@�'i �z4J�Z�P&��N�#�������[�
b�h��\��%g�iҘ�ez����/x&-�'�d���-�en�;�7<m�u`��
�a�ou�`�eoU1I������e�7Ӗ�����r�E��D�������1�%?��3G�(�=.A�7a���]3D7;�$҂���������!�g�}�`޴�۾���Z ?�<ʽD�҉FP�n1�q�<�S�M-��,gB� �h�l&�

��ބpuZL�n[K��.����1$d�\	;�1�<�#���ĝ6-!��	���E��*h�8���!϶�P ���~	q�EǦ��7W�$��rR�&�[U�jDty`�]��'E�#��龼L��|~ɛ"�YK�-$�L�I)�ݣ�`��{iY�"}��������tL��n-�۔�6O�߂w	>���U��R��O�� ���b��Yl�L�Dn.�,F~�ش~ ;2
[�o��<!{�g8t�����M
Lߍ�Y��7�N�NөǴ�=��i���QL;��.�t��à���n��ⷧ2�B]6Dݠ�ڻ�Nd-��}�l�ң���Y+�:f����6�}45��SA�o-k���!W�p�q1a���/I���ᤈ����yR�G��J"Z����azf+I*;?�WÏ"fTL�	u�GC�jc-�HtW>��W��^���]���<׳��]b���-�e
�~�vX�c���jS����%��"M�oۤnc ��i�Lb�C��Fn?U�3	
�9��{�y���Y�BbJն��U��(�Z��-�r�#�n6��y�O���寋��::�M��/f�ı����K�=;*�L����U��^�!����b=��^��˥Y��ñX�̧,�"$��P��8C
-�1d�2U��|�"
endstream
endobj
17 0 obj
<</Filter /FlateDecode
/Length 6708>> stream
x��]ٮ�q��S���b8�@@Gٹ0;z��	� q ���n���.��դ|��ΑF��,��զ�$�����D�������A��n�
��������m��/����۟������Rڼ��~����
A�?�����>~��7�����O?���,��Jo�v��Q8����E#�N͚Vv�T*u��Ͽ��ҭ*�?僊��po��c�!\m�*��[����B;�.��Ac�n.콈�� X��SH��''Lp)r^7�^���6�R"�h_�q�SҪ���uDJ�%Ozo�-��w:�!��7��׶�i�GF�C��� ��7>�?6Y�}t��`�O5.D��M�2J���<<�����[0:���.R�x�R`E��� �p:����.�Xڱ֫��V8�,��8�}��J!��;4+����?m�x2-�\�+2�պ���Z{sY�*�ru�F��w��k<���v�F.����Hu������p�?���j9s�;���E��_�{8����������,𤖗� i�B��]�+	��㜳����^(�/���xRkL$��ۻ�?�v�B�)c� ���]x���(�.�l��W	�qs6�0���D��{>x���P�i�4ޅ�)�|ҠR��3I����#h�h�z��0�Ft��?^�_�1�G��d��F�}���o�ϳ�$��>��Ճ5���jsC�b�+uo���G���v�忾}��:)�i�᫁=|�E���3|U?�}��?����B.�?EZ�*A���"H���XD�(-I
�=Ϋؐ�����ƪ����F$O��ls���t_���D�AL�R���!
4b��"H���|��V��G,�t�+�Z#�2>-���(��g��ˣ���ؠvU�[�*2+�s��Ϭq�2�qQ�g޸��ڔ�}_�g��=�A	`ᇩ��2F�Z`l�q������B�߼�Kq�[�o��$"��|��q�Q�#Fk���/2��e9����兤���+G��m�Jc�����Q�� >�*E��=�����[�E��e��!��~��#Y�m�0˙���V��:~��.���H�Q9�2~Z|E�k�r�Z�#�
�E��|uEc-�B��G�Ѥ�W@���c/*AW,z����l�g�YG(�z��g���$���O��̿��`���z}��6myQ���l*�qԩ6	La�젙b���Y.J?_�+?Q�b�w�l��+>HxΒ�p|*e��OhO�e�׋���S��Q�0l�`���,�DJzϷx��;�?�_����	���������o����}���ׯ�5��O?��`�6�p`��$6O'GM�Tq�0��-�^5�5y��DX9��&�Ŧ��`ciS��2���3P��,�L�c$'��%��En���|�^�����7�~�G�Al"l�ֈ��m���U7b��$�a���iW����i_�y��uU`�Ep��Нa9�I�3��b�`�N��w"�SkV�A$��Hx� c�IюnL�E�,����K(�i�[B6.+FW�i]�&��?��o�X4�G�����g�r��z�*@��H_�f�f���*�$�0�Z�?X&/9D��6 �㒐�P��3��1�8��3yxt
�1��#�O���)�VMAQ�XӶ����^�����3Th`�8d%)�]�}l{Ɋ��I�)��"�}��`N�L����r���������K� 6B�%�%&#l$��j/�9{Y�	���R"����Ska�����E�M�hNZ�J����S~�-G��7�R�H~�j^~��G�j$��t!;n���P�E�4�S��)������G��l1��߉J���@*��%�a�k�Q����H5��U�>�*.��q�P�r�谘���C4%�X݆Xg�mY>V�p�(�tE�T�"��ӆ\��&VX.�]	^`݇b��Q��P�~:��h�PL�X��X����h#���_V�B�(2����U�p��E/�+��x	�Z4�C�%�L\��1�G�;D:��T":�:�U2ub(L!c��
�H�9�F�N�L��Xg����y�GhkEgIU��k�w�r�7����Y@�rb]�)����?�-gi����0����pD�Q#�fD�R�D��
�#�q�HFER�D���*�p@����bF�@�c�'�a݄}+Ɣ��kfF<]�N�Kn�����&�%ք��Z̧H9KO��$=���'+&��%Wt&G%��q����t�7I$�s�pr��z��*�=���~�N�����ՉN��	���Z4�$-����	(�}y3�#�Mfd��6�e`M�B����l-�kN��f�C�X1�S�Y�;��C>&�],�1���b9-�9ܷ\}���L +�&��Fc��j�E�٠��~�{LW��0ߎ.�:`���4����7لDK�	&�~��܊�^� �:��1�C��#%d��j|ߑ��ì�	,$�X�oo�t�dy4a-$��|��	?%�?r�u���ؘ|8'�T�3�I���^:��K�N� #�\�q�� "�>� �m�s���MF]��lmc��,/ml#X�&R*�����b���jT��m(�B����c�^R�D�pU.�YS��ڡ�Tx��^s�oAa��q�Fk�T��B_/�����b�P�D�t��ǡQYs���j�P���^��z>�I��b4�S
;�?��Wcy��sI����t�W�BWME��<a$��&dᬠW�w&�[���\�&��xw�h����b�����z5~�َj$�������Yu,p��@rIUu"6��l�':<�B� +�U���������Ύ	�ُY�{h�dn�˅9R��V�s,�3A,��.�p9txaM�o|��򙯋�y�����)-�̮�7��q�:�/7�:כ��rë<΅w~����r�9�������O�f�<M��.��iz�ËJmQ�(	G��S�e[�d���mb�Α����L���A�\�&{ �KW���L_؀�$ט��bP6+���%Q�c|�9�:\yQwm��,5(Kߝ1�@HieWJ_���_%K:�9���Z4eN)1٫�z���gY�� �-�YN�곯��G[_�#f1~�4e�#-��iL��i%:���E���/�� �/;A�g�|���RMA֥U���g?'g��L��{g�6�$��@h>��ҍ��Z�v��L��Nфc� =�S-\�3���0��bT�ǪT�9���R��<�e�8��,�>J��u���0��>m�s�^<?�h��(�W}q����-W�a�4!���ar`2�2��gYo��춚��dan��jb�#+��ݿ+Y�̹\�eVD�,)d��{zI���][�	jH�a�Nt1���Ms�ə�9-�r;��r#,�B����5Wm����8��7��}!b��2\�f��8��yuLrI��B����֎�<���xQ�2�SU2%9N�#���*��L��jI��J�+�����{�T*9���v݀By2,t^	��ص���b�,��O_d_���i,l(��[C�i/���A>6��J����9����>Zх����R��ޑ�凇z�)��:ပۚH���G\��V�S\�ɍ*���Z����	���Ɉ%m���)�Uu�N�Ӛ�<�vp�Ǹ"2 ��\����^�}�*��j�c+��3�[#�Iw����f�����#�Ga�ڔt�jO�3��۳��o/�m)�J�ɹJ�y�KG�	e�11��%KDslwS����U
%��VF�{>��a3����������'��1���"Sc�2�B̊L}D)�	f��D��^[OOA��_��Ti�ݭz��)È��ȱ���M~ȐY�|�e3��v�ץ���ޗVZ�0�ㆥ���8�$��AwoI6Q���D�XNΓu��}c�;_���bwo
�W��5���s�I�gU�y=����+f$ϋ~���v�����6�����/��$5%VK�
b�Ե�u-@�r���;�-�z%7�8Ѯdm�t�;?_z���c�1.�1�җ������L`|�b�Bj�e�&���pi�֘@Y*���d������/��InM��ɩ`�z]v�d�t�V�0F���{������9�����=�ɵ���v.�9v�8�v#�{grN���dn�Հ	��,[�R&��F��Y�e
����I/����Q�Y�!�y$^�!	9��M;�<2*Ȋ������=�B�����-?u������1�f���'����Z�cD�O3�)0�;]��fڲ�c.+��,�C�<�^JW�<Gk�ZHF�n�c�rmL��c�p�]��|�feL�"��3Q���m��[���z��R�sS�S~B��2P�^��a3���wN�ɑ6���w�*�0#7��kJ�j���NP�|���ג�L�W������{C��6Ό ¹hɽ�9<`?����;�.����Y6�3m��~�	<�8+pW�'����ȣ�/��/�N�,:dߓ��p�ܽpt�x�A��L��ܑ����2y�H��>x��F�|�N�q��)�p���*�щs%�{�s-��ڵ�K�P�O'v�R~z�&6��i�<�^
��܏k��ҥ�}lB�z�I;^ۭ8ez�Es�3=�5؃|-�N#Jq~{>�M��ݚ1���W��4��]���;~M�v�>�r�-�
�z�0��VYL�cg9}�����uorr�u��%8=8�A���X�t��M��'{��JSda/�^�,�ōǹ����%_�h�!Q��5#8t��6.�m�h�Y�#�����b�N\˯ՑςQ���0�N�7��P���'0��Vv�8��վ=F��e�ji�I(QS0}54`�QRSu-�l=��X�S��|�cJ�L�.�)���G��Z�/�Nb�i��Y�*YMc@�+IMG�m��R���7{Lߏ��8�Q�N�ٱ���2�.��c�/��� >ix�
&�e����>���8 x�S��Ё�uڤy���
xd�;f4=��%*`@�:�X��3����`5� ��r�N ���N��9W�&Q�
�:���J٘m,�;�6 ����)�%�mC�]XJ�����f��S�X�rA�	mE�t��ˡ�Fmn�X����P�PK	J|F)�&�0Ôbڪ)�Z�u%-����3%q�Ϧ�#�J
S���r�� &#�P��GG�*��2��`��n��l�% �!�m-)��7��Y��^.a�6l9Zx.s{��~Ϋ����G0R�����&�g�<�
�� IU{�JV�b�=�9�����Mn�M��Y8X>�Tn^T_���cY\�|#�(CXPv.���&.bQ��S��j=��Dm��F��:qx|��uѾ2������n7*���"`
�ڋ<���j���(SG�05�oX�a�Aab������_�{��g�n^� �.�6����=ss��G!�^��&��}��;�6�s��`��F�UK��r�U\�
K���d,��vF�6tӡ�U��z;ɉL�J�r� Qc����{X��{��������s{�-��YvI�>R�Q�9Rv6��ŋ�,!�^�9?LMP�2��Qemr�1tUdg�r����y"�`�$2�5N��y�(f����rr[<����[�����N��lv�]��`:e�\�}�ޘAf'�K�li��/���j;���*�1��(��~UsR���_�L	�܎���9G��x�y,�j�gf�<3��F�c�I�ǥ�2o�$����y:H�r�B�63�S�
�LS+��taz�t�a�3�$�Q<m��B�̆������L�*y�����[����{)h�b*才*�̵�\�O�*�ڱ��[�̺�8���=����Ŝ%�I��f���h�`3�����G��m�Y*�չؖzB�3v��۾��alJ�2_f���G��)�t�1;�nK�z�b'4e��П�J�Oݗ�	�J2�G�Ԕ� o��2��`7�ɑ�L��Jz��,�b����>�_��a�-�0�Fs�Ԉ�XEXRZI���]���swm���5<֡უ��Y�-�ǋt���(w
��I�]�סּ��:�d8&Ξ����c$������Vģ��S:z�NG�^�\��јM7�k8>:����	�a�	3O�t����lkgخ�Q�c�ޯ��?��-�֔��u�5�I�"Sg��P�u��껞q�m�?���.lA�e�{R[4�;���0=�Yٛ��h���	3}����\93ȗ��u������nDa����$�b�[R��Q���Y�P����GA�����j����eW�T�U�S����Rt�	iZ�:.3Z#`���{���w;�*vw�'L�'��.�
%z�Oò4�}��^Җ�fT���:�eJ���`ĥ]F�Fv�n��8��ݫn)��4X�Z[������\=׺z{H�)�� ��f�ۋ"�A�O��w���R؊_���y��e^/�ruȉ����[���~�6줥1zOP�7].�0A�N ��+��#�%��X��������MZx4�Kuf_3,dm�3x��U$[w����ء��o6q.04q��������`����]D���:��
endstream
endobj
19 0 obj
<</Filter /FlateDecode
/Length 5792>> stream
x��]ێ$�q}߯�G��ɼ_ ����R�d��(ؐ[��#�VYU��E����lgG�%n�D�z���w
��~��_>��'\~��	/�7��_~�V���>}��������ɾ)���_���O�=�4��h���ɼ����?��xϏ?�|��z���қ�������8�H+��޺��ѭ/����J�e�F=���_v���|'t��*x�S)ET���챴�y|��A
��|6i�	紌�(��I���O���Xo����Nx�d"-��K"��E{&ma'h�o���)ِ�+�=,���<]oC{HSf��Z��%M�v�y'���h+^9�����m��������	�Q� ����a��V�7�n�І����=?�����V�jۤ+��j�q�SL�zB���v:<�°ڨP5m����v��l�Ap����6�r��-,���������#�7��B<���T��y��C9� �z�L^k����/���L����I�ʙ�y0�2���g���a���?��g��;�s�o�
ֆH>�R���Wʂ搠�(���1�gÃK�J=����ѳ���㛐h�����G�_\o�X��ۧ��op����ImN�0./۷��D(�3���o?H�?�����?E�CʆD�_8_>���W��,,�s�i)���3�<��0��J��l�����,|%�ß8�|)�$�@ʘ$WJ%l�'bjti�ĄK_�|����?�k�g�=�(;Stp|5�>]�����m�Ժ�T�$�ۦ�/���v�x "w�Z���:�0ш���Ӝ�{�m�;��� ��[7��Z�����1LHu�XOc`R��3{�s��)��	G'{�,!��� �=K�`��ADtݷ�v��9�Ѽe+0���yۓ�+��ӥ�	�h��0�s�?��κ�yr��n�D<��F�{�!��!M���G�����w�h�\L�9��+�뽍x�7�o?S��EQG�i�X#��0]Mٺ���R��j��nip���C7ٟ&���[byo]���h�<km���Y��P��Z1�Ѣߒ�2��᭧�[%��=��R���<��c��J՝���t�&��؉�%��U������q�
.S��S	O6т$HzO�c�xTO+���;Y�����q��`A��|\\YNI�&�b�Q�tJ�ќx̚������ 3�g�O[�rD��%�gV��>�y8`��4Vr��b�F� U�*GK���%��0���FD&Nn����7��J4�84�FA,(gZ��)m�C��9El+���'�~Ip����2Da�~l2u��b�0��W��klv����zu�ݳ�4�N�:��o�^]- �9���n*y��
���k�fDF%�	�c7��a0�4Ƕ�nYuv�o) Ԏ5Ty��pڠ�a����a'�G%c7N��`�K^�)�A�2_����VJ`o���Z�����8Y�KyT�|�<�<xd�کo	��p�,�S��,y���d��e��Z��t��4��f4�AM��������zڪ��x���=_b�Ʒ��I�P�=�
������Y.�/Spx%���c]��GCn�Zn.	[\��pP2kg2N���	q�-sśD�w���bT��5�䉩��8�|�����}6��d��t�`ɬe���dr/XBz��c��i-V��Dm�x��Ќ��DW?҈��߅z_�=��[�1��@ˀ�8�	ѝ�@�i��)pz�'S��^2*'��IU�!�-UNýtѰL���9�2��oa����r/�����mgm�9´-{��n$�*���x��\� �����z�Owh0|E��@�&K��fM����;�i��=}(m"���r�� �RE%�\��ʪAw<��{��d�<�y�{)���{uH�R�B�b�89E>k�[���xhS:M�>b�ϙ�L�:��R������#A���	�e�d���Iܘ��}Z�M�;�N�3G:[>V�}�m��-s%Q�, �b{�P������1���h�"oS��|e�v0^�Ol|�x'�}º�9e���/h3D������I����x}��_I.d����v��pk�T�c�P�͕3��,GM/��1'��a�@���z�s�s���%�v�yy�	y9b���LƹB�i0�9 �f0�w�@$��H�ym�E��%9�.:�C����p�K>r��m���'��/��Z_fqk�Z�΃������Z�]�e2L����!�+�W�$�8�������w�k�QB�N�]<�ιf�fZ��ށ=�5.ll�oV�ne�x�\V�ռ��ݓ�a���XP(.�ə����܏�4|�ꪔ
].��Z�w��dĄm��VRS<w�a��[u䉄��$��=�/iD���f�uj&�%+�ƹ��J*�	lY;�Jy��7��=���MXMӜ��,��^��11�![��iY��@3.��%~Òh>�ԡ��}����Ћ<�V���ƈT�¶'h�^M4��dVO�8�v�����<��X&=S����{�h/�|
Nw��1DG������ �K]J^e�,���vw�aJH���j��ٚ��1�|8� �3ٞ��'������0S�	7Ub�9�%o��[�Ŗ��Q��%剀C#+�P mJ����!�)F�)W&X8�(�x�Ö�i![v���J�K��w����%�A*l�1�jtR�'�w�<xt���.��1�J2�qQ�@��Z��Ԭ���I�d� �L
sk��X0���X�v��!'���S�V<X�7��t�Et�?�K��bC�@�c���1�������ʐaU�G�,���_�@G߀~O��5���)X��
��������=M�?�4G<�kR�n��m���I�-2[����>&��X�HN��_R�݀8/) ��ݒ���6��u��!�������3Q��T�=�|��w$Pы�'P� ���?��|�������������?��˿�#�Ao� �Gݓ?�O=��o8+�%�x:���bb����㘫��B��1�ʸ�j��y��Z*�<L���d���<3p�Ӽ.����4�e}a���.H��������O4�&5#�J��85�d'9��Ϣ��\
�R�2�iL'���2�]��3�4�r�7��I�b�yޒ��S�p@�`�bhŸk����1��X��y�'�%ڛ�y�;	�b��h�j�y�k�Z��Xe���5�6?ύ�[��NrSI晜�v��Ki{-�qvp�:V3n��n��c64sk���T��>���P SQ�=i�r)=ϒ���>��\�%��2�Yj�-�.�h�U	��R�J�>�؂ҲA�+�}�����6\H@̤+�(T�Ĵ�ՋW��!jU�t�TG
�S���"jl[���	z�\ٳ���#�B�bYa�����F�;ԣ%�����}�x�E�;#�f�U�~�ެ����\���A4dkV��j�/����˗�o�LO�Nm4~a�`fJ���@N�`*Ǎ�$Ƥ}�YY�lĻ��g�}�j߽!�Y�V�����&�1p���e�H����ш�`7(Ȓ_?!�Ŀ�>� ����O�Me*�ɜ�9���[D�J�c����%�$��a=��(�T�|X��Y� ;D��
u�w��v���Y�N'+7�Xn�ձ��������7��p) �p,.�b���4�T)�N3����Ƕ/��X-�{�t����?����<ii����+�^�s�i��Y}���m	�_��`���91��؜�1��2[�����b�>-'7ћ�.5�h�_��v�,�`�W�,w42�f��xm�׹�?�R�~��}�h�)�j�O�7m��9�ݣ �k�<�X'#3rBLkd��ᰑҕ6
���pE�mꝄwy*p	�>�Jұا�棘�{'����n�(�*I�G��oXF�i'c�������k�Rb �׭-J|�9=�$�􆕭�]��T�r��Mv_�n�F!e���í������K�i��凞4�-k%_�)(��"�����C�N��Fa]�za��}BwlZ����[�k�E)BL�K[Ț(n��,���`0�/]��w��vyP#�^�M���vȌ��Y��ļ=N6i�C�[[x�P��J��Y�D�fG�F+S`�?B�`?��m���P��`��Q,�*�@��Lm#Ֆ ���W��L�\��£j �d�QK���Q���a��n�,i�Yv�tr�a�h����YL5�Ö���&q���]J��$oi$m��7�������ri&{G�i�|��F��Ֆ1A,JS���'W��� ��6�V��2� �}���<QR�&���>���p������j�e�ێ� ���'���w(��n�v��\?ʔ)�`�
�ͷpii;�0�>C����4n�_��
�/��*)�Y#ϥ�T���[�B"��yu�+l�H�[1/��7x3�����g���l��y�H�+��5>��M6��ߠ��ba9�7P]�� Sw�����;�?y���\��b�7U�j����T:�mt^<V�s�&63���Q��Ƹ��!����G��YVV3�T�a�b;��*8��ݐ�!���Ҹ$�A7�(�����~���woZ>vD��]��q��۫�����gz:-�%���KE�?���O�~8D��5��ak�|(l[������>
����K�Li�d&��p�驺5��G�|1�=|�1E��(�vhG��������CاlQ�V�v!�Q�9����ށ��I� FC6��P��hk&؟��>���x2,�S���oo�v��L�O�&�x�T'�6��x$�x���&��c�%��Q�vS���μZ�Z�/A̓ �ю�kl:2���<�r^U��3ʵv��pE��:���:�N����cmUk˒�!�mA�y����B�ww�N�"�4�}�r}�Z�LJ�j��*�]Ģ���:&�/u�9��a�x5s��Or�ՂN%��������yxKB��k��!�	�w�/1U���[�_��&	G���=���2�)Ǒ���4U~�Gk��Ģ�i�1r�W�&��JE�:��u2O�k��sFPe<q�N���i\Ρ��tN��95��Y4����3G����vI)*��f�-}Ñ�f�7�����"f��9�QNR�,�����'����Q>,�;�9����. YI�+�y�^�}����K��.&<�]�brZ�ׯ�Xa�`�ޙ�;�ծ����_��*tfŅ'�*��t���,�;���>�[�I
��{���Jժ,N����[��<�,�����+#�l��膖DI�:��d�:�/C�z��x��U�/O�C~x%�V�=$�[��갘��z�HE�}̏��|�ls����i��@Z���[7��8OK�;!��k�U�SE�XϠ�i(��.]<�\�|yb�{S�v�x�S��R�eXrj�/8:�I���XuöԱ�G?-��T�%��%vW#��ʮD2�0��J7U\�ެG�Vt�\λ����mAL���c{�u�L���}�T{��{3T$#��ēѥV3=4�L�k�2��]kfp��rxws�Y�L/p~�QI\�~�1K6|E9�W5��Yn%���D��k`���h�]"�{�cjk��i�G{��0��ǻ���E�j����x#���[3�Ӷ�#�*��\#�TƩ����1�ѽ��tsH�z�5��4)���)��{=���c���֬ۼW���~�����.�
endstream
endobj
21 0 obj
<</Filter /FlateDecode
/Length 5382>> stream
x��]I���ϯ�cr0�}3����$��c	� q ??ť��ޫ��mY����"Y���V���F�����?����'\���s����>�?���ӻo����y��}VJ��_|���O;
A��n�x�������>��~�Ç׷����Zx�'=[����)-����+:he�U$�Jkae��ܥ��AF"}��-��}�O@���-���;Ե�!)h�SRKw��7�]�X?E!��Z[��N���"��]�^
�c�M��w7r����u�#��	ot�{$6&��$�FI�O�\�|�F�x��e���H<o�ȡS�����I��ۀ�Z��m������N�Hh7܂{g̽U	�A��K4�6�肽K]%���h�+�W���*Riځ۔����׭YogZ$�N[�����PdD�6	L�G^XS��%I��^��m�{i5]Z��:xi5톃-��;%U�{�:z��yG岸��{��I���o]�����'b����D��i���>	���w\(Ч1>�]����G?��kl�~yz��=����ӓZ|@�a�8���7HY�������R/�M����IEb�pee�K�R�"��$,S���ӗG�����R~މ�:9,  ;~�BNK��5���7(�߬>����}�O�ȗ~��������~{~����ϰ�����yc�}�7�SF
P�
Nl�H82\�mZ����L%\!��~<l�m:�7>�v�~��,f���,��mg3�/��ǐw����D>��3H�&'�z�c���h)D���&SJ)0��큫�z��}���i����1q�p��f��r]�v�(�,]C��^�Q�.*��!���#�UwAf�E���VF�spN�d�h�C��C��pU����YX��'.ׇ�V�\�=��+�;%��΁Eo�����2��R&_����:
�����{����HBSͪia$D]+K�NJ�u�|5x(�y�����liٷ�\hBpٜ��5\������F\��6���$�����zw�p]��,#�
Epe\Ѷ�H+�V���۳�SO�.�T�I��G����L��f�f3��}�fF�_��U�ʽAX��J�監���Fa-f	�3�.1A4�@�V�wЍװ�$�eK�.�"N�&<������ɗ����r�&JԽ�M�g6�x/������6½6���b(
Z��
	"Q�>��g��o��>G5xj�m�=�l�M��w�M�n�!%�|��ٛ��
�� 16_��O�����[(�f��P����8&�X��F��8�aLA 
'�[l��ta�e�;f�'.�,ոb̙Z<�n�7 �$�U�"x��o=�jrdK�L	�,����m��#!S	��;n�yJb��֌�Hc��A�F{��8�j�ס�k�����U���F������ғ{L[[R�Ι��";`�0�SU`�f��`��̭ܱ����Ǎ�В)}�)��j�Uz,D�mE���C]G͌Y��t���8T���:�5��=ŀ��s�dP�߄���*���)���֐RΘ��`2d�H5s�l�)ۺ�F�c�`���A��b��^�0�;ka�h�'E�/Q�<���3������j�VO��D����U�Q|'�ZI��q�=�qd��::��TN�X�5,�p����=���0�0-Ơ�9I.k��c5�ۤc	}\�����&gZV��i�i�!��V��r͌�BN���.�K���ר#ؤ�>2%�Z���a�ﶙǝ�h��t4D�:f�hRd�$�tY���k��	����ɕйkuJ˿��O%_�U����Fv�}���+�M�(V\j�\oX�:����9�K-�h��*{N
^\�=���I�"�@���{9�+>�5[ae�vь��f�蔤�i*�T�VR���pxS���g�'1��6���y@��T���=Uޔ���pN��*IL���X��nb�I�j��y늃K��H[����P܈n��n�~%f퀟��=��H9<���{�qj[(������4i|�jXK[Q�۶Ň�Y$-��_&�&�&��S}R���@���r��|�0}���!	>W@m4X��+X�����K��i�B���QͱV�U��zlk�J=PkO>��2ǇRk��+��fmϸg
�*4�,����ya@��E��g���d��6a�@R�nT��<�F�[ع���bn��sna���"���/��B)�\��O��`�k�*��4�?�� ��Q���GK���wL��o��6_�Y���ye�	f^���H=�֬�u+�7]Ǿ����<|�¨�p&�rYӽq/v?�_��?���4|��2��M���r��K��W4\���Z��bRH��a�f�2����%s*�򕽀-�Kyc��g��tY�U-��f0v�]�Ԓ�t"T3�Y��I�Gz~Wj���4]�f��-�KS�ɔ&o%F���%����z��bq��� ��19�  ��7��A潷�z��$�Š�8����a�pl�'�8�:r���Y��8N���.���ڱ{3���p	�T�>-�NZ�
͹)�n-�
2WR6mGJ���^3C:���%劒���n��#*�z���,���]��q'��I�� ��x��A��g袶NTU������������{�ޚ ~��Z�,��2�l3�Q'�tՅÉ6���w���ʛ2��.���Tۺr"���ԩ��\���ҫ���5k�� ������:�A��S��:���	�H��d��1J�M��d�OڵJݤ�;ZP�C!���c�[l1�u���o�Z�Q9�v�xuy²f;B�]{
=�g�x4�r?��B�����ؖv��)�M:b��V��N#t�}�X���n;gr���Z������t7�vq	c���:.�htI�g_rszL��rb���R�c����ټP�)n�v��=�ϭ�@F�B�%1��"	� �F�p�h�ן�4ҡ�bζ%4\�G��u�^��%�����e�z28����"�v�԰�� �C:U�����%�/� .����ɽ���i8l�w��'�)�b��*�t���E�!���whM�V.�;���9�J4���o<�f�d���1H.ۂ��h�-� f3le���>��/�)1��d:��}�1J�b1�!V(���*�o�WP����x&�X9:��qiAb���^:8�#)�C�0h�����M�ν��a�c��Q�3�:����'ɶk��-����<q����*�{�=�����:p�b�i1�Ѐ�Ъ��敉]*��z�%���� �rVa�+����i��+wP/z���|�nn6]l0W�M�b�w�rU���]���t��05<R{�C&
i��0iVZӕ�Ŧ����!
K�ɼ�P�㲪Q+�-����u����/_z�\��y�W��y��>�C���+R��EMä�nT[E1Ԧ6�^��"1Q�z��a�^mZh�B�b���Tt%��(_�A���18����fK�JC��3�:cc:~�9´���#�Ԋ/W:F3:�8�J���5�GZ�M:��q�{�y�U��r
�2�>р��� 6�O���-��ѶH���>:�G�y����ʺԣN�Tg�`�23�鸗�\53pEsP���vT�����բ��:6̭���s]�����ƥ%��ZJj���lE.�)هA�8���G����3��]�ԙ{fH�W�U�Wcoe��{:����s�D��HN�x�.�W�IƦ�x��Y��z���LV��Vs�AMR���y��� ��W#,���3�'�k&��N��嫑���R���`�� �7�`RZ�P<|O��^��7A�G��44�4�T"t���ÐӀ�kiٗ�S�\�2|���Ǖǥ����E�hp"n���/�h��iK���m�e`���ܫְ�F�W��R캚���F���Q�����jN�N��n�ga�q=�޼�
b�<�A{��ш'�WO���r7X$b�>�1���;k
���qI�2��J���E��J�R��U�ɍ,n�f�m�?�E�ڨ�Cp��OڣtS�1ޣ�� ���5D�;�v�,3hAr�����8�Ҍ^�5	li�D�G�\�B�.�}z~��t�=���0S`�j_�|Y[ި��m� �bp��8g���a`����<'��5Bn�
y��V.�|��'�4�1#����H\{h�z0i\C_^&P5q�{-Z9�-��?Y��5X��x��"P�a!����o;��<��뗹yΠ�����{l�]C��P��������<���Z���Vu�M�au������!��L��h�����\-��`l�a@�2�S��x��'F���~4����{;��ܥ�#���%���7����/�g�mޣ�=s��1�!�œ	����Xs�d��G8�పyyw�yaDg��kp��ǯB��ӯi���Q,>��]E�*Z�l�T��/�\�jo~�/&��F�uLd��Ű��	b<at�i�Y�w���7#2˘%�@��`���˜�`�<Ɖ?��ԙwJ��-#'VbZ�΃��w��!�����%�{���q��[��T��C��|���~�h��ۮR�]{g�]Dw��Lyn�7��|T6�삒π�R����huEm;�e�Q߈ộ@x�b�!�:x�mdl�� ��/=�3�C�$�amVT�����1��f`�eӉy;.Wnj	���VxZ�6Y<��I��X����Ԑ���y�:9{��п�>�=�OJ�Ԍl
��w.���ɰ��?0�r�5�
����c���c#��_�5�V�׿�^38�ȸ^�%MvfȿP�t~7���~j;�H��w��C�jK�J� \J�'hX�^Ө�U3����6�c8D}&��_�}F����ZٸZm�tW���!�kyN��򓗡���L��q5��>]�uF�k�x|���n��4$3�H��4���Ѭ�Uuj�tx�vj�3Mm���O�_�qS����!lW߶3�Z������4��=��<ס-
��}n1r������I����cmjZ_n�u�!�`�x
��4�E�R}��c�.��8Vc$�Wv&�l�R�*/����'ob�m�� ��<7�E��G�K+'�X�kD|�3������"n���S��_22�)������~�q0'I�	Q-�o�e5�ƹ�>jpV�C��;Q�th
<$������������r�q����)bF�]�^*���9�wI����G���;���o��ړ��Z�˗wɂ��j��0��m�>��(E�}���=#a��I���}&��;:�[#��j��2��OEh��#\H
endstream
endobj
23 0 obj
<</Filter /FlateDecode
/Length 6146>> stream
x��]َ��q}���G�a�s_�F]U�?`K���lH�-ˀ?ߑK$�d�^���Y���&��D�r�z���O
��~��__��EW����o�����~~�_���/�~6������Rڼ��O/����f���?����ϯ�?����>�#_��}��a����_�U�ác���)��F�΍��J�'c�$�*���a�>F�3i�r1:X�s�(����,�$��>;Ί��	���>�4
l�����������7T�?	',��'_#%�L�O7���)i�����gIҳ�#Y�Ɯ�m���$���avdt>yrv��]���}n����!
�g{R;a��Nz��ՉI7Fj�N�Ѱ%a�ʤ�aҭ��鳓nL1�lv@���89��ya�|��Ša9��鉰'���5�fz�'�X���S/b���l=�b1I�'�U�+uL�n�8����
�dz<?E��|g��)8愸V(������1Q����uo�Q�'=yP�g&�I��:9�SZ$��s�B��¹٩���p�g��f 9`��7�˷�z�����������[¸d��?��_]�Mk����3�4	&�F���ۗ����-LO��>[Ʌ�o?�<�h<\�n�,i)�xQ�r?��Yd�P`\hiW"E9R��Q�H_8O6�4�$]
��*�\�3k��R�U&�u�,�U":p?�{����6�3J�~w i�U�"�g�'2��1E�:�S$�2	+�gB�l��W���Fj�o�;)��<�JP?�;����f2&�S�RD���R�0�q����b���m&�g�>��)k�����Έ�jd/E��NT�p��{����<$a���*�E.���
�ujsT����~;[�7��k?�a���kXr���]�M�W��(�IR8�I��*��I/����w�Tʥ��Vr�����fWBټ�x����j�6��t���-;�)�K�Ѐ�Y,����u��Ծ��39�ۇQ� �6O`p=�r���݉�5D�̮4�	���`z��/��%��.&稡��MN�����<�K�k6LުΐL��FK$�Z;�d��r�Vv�ɱ���ߝق98�էY�|[Vc�7z�}-?�۪v�]�Z��\��Ȁ�X��Q�E_�W$���TM6B7;�E:�&�x�|���r��A�2�M
��Hʲ��U��@��,Wf�>c��2�\T��|�nj/�.��=�;.�K,��(īi�W��D9C&��q�ڕe�΁��8YV��HMQ�dRRz�r}e�V�xG�����p���~vR�&�n}W%V�t�y<,auv�\qv�|��i�;���p�U�qB��u�aú�^��ut�\�d��C�Yh���@5Fٵ��b�e@M�{v�>�ooqn�-P�-�!��dLY���h^���3����:�1�⌁z�9ޡ���޲�A�&�=~��Q�;Ա��Ɲ\v�XR��g�Y+�*�4Kpg�p��a�w�rQNƢ�`���s�$��_�j��_���s�r��?���?��ǿ�����O����������˗ל�yj~�h�?F}���_�_>O��+E�����z:��َ�2�v���Yi��e�41 ���6�G�	���87F@�GV��KZ��Ϩ�e'mh����]Ś�	���΁"���	�M��8�]�튁[�ĕc��-2N���"����45��n*�i�Ox҂�j)��4-٦.�m*	�zTLVW=s��LV���o�8htT�q���GEti-��f`�|�n��Z���2���\ĐOF�1d1�/��,��q�5��3r�O�
�!���}P�{�R�����mY���W2`�5���G!^��Љ:g���6�-NDdGY7��u���8ݚwT�.��΀�bKa�/g�)�[�]�0�̉��U؊�7��i�nYw����CmPv%E8��,�1�tF'�Rjs���h�V���|�Y��K4On�P5�k���Zj���+:k��S�d:�L�m@/z/2�+*EͬY���)�8���n �[.�k|��$sp��+޻���p��Ö��n�e��ID#�H�$:=Na�s���:�`(��.!�@�Z�BY��&5���Go�(&U�%��ndW�,ѕA;i�>�2Y�S4L��6yif#�|�m���9uF,;S�ݱ��*f����A&kj��):��DA�Q���S�Y�K�n��i��!�b��-ԩ�㋦[��F�AB�P|�1g�5�Bt^�+�}	ˡz샅"�[�����~E�`]�b0��T.�s`#�F6r��U:bD�[������l��!6�x���G�>M
�V��=rQ���&5���:�2�c�'nY~X���6�W���Ř����s4�%�X.�,R*�ԷO�,c�i	���ڲh�5���\E.rn0�L�fx�t`�ch3̥�c����#�1���*�|�w"�G��yQVec��7㘷<��kU4A	; ʮ�	:�x�aZ��"��Y���(��N�����AKځ�b���ӫR��b}�o���FJ�� ��*qT���J<"�I99Du�$3
��zO�`O��l��"�d6�l�V����������cɗ@q�����r�Zi�ќ�����.����`�d��ZG��;t���uY�JW���9V[\�Ȇx����&����A�&-X�J��up�4e��Ѽ�+S,b���mHFDm�l���+^�D7)�o*�j����R�{��}K�nG#\�8<
�W��������u��UQ�*�E���0��Î�� �i�����d���ص
؎C�`T<\I"����n Ǌ�/�q˔'g�G��ؐ�IXM���	]�q;y~�KF;��I_>m�M�;>�*��J}{q�A~��L�Mb���\�c/kFmK�b&�#u�wF�I�k0��<��7YY4*ciY; ��$[��:��3�u{^�w]1�̐e�B��Ha�]d8'J!b�@�Y3.�m�9�1�"{�ьa +��t9Z���Q����\� ��0,i�>��c`mD���YcN1�&�t���w�Lh�X&�߉TU)kM�nċ��4�i'�����XR��ln�C	ʐ`�b��#Y�.�8���Hl�c�z�+EK7?Ĥ�,E��OY��*��E��v1�XB/6ٌ���K�U���F�4g�9���3���H9]�*#0맨�6u��F�O��Fv>�t-96b؎���X7S0�����
X��$���x��!�&�y��
��Bct�:ݖ+tƭq�X�c[�>OT��B�����@ϵBIH���/S�{2���a�ie����6!��Ǘ��5ݴGW��^����V$J
��x��aMߌ'�;��*��:mlΔ���ǴI$k�W�0�R�rn3Μ8�k�i�4�\�6ݦ�u����g�x=8�D�aN�e��hs��E�X�e(N�6M	�H2�����+�n$w�=���c�'W.���9g1��\�|ü�� i����ᱫ��E�u�d���\�L;Ys��,AG"�~:w$a�8�X%/	D]L�ijFޔ����SӢH;���1�4�[`��U���Z�xo���q�����E�~�Y4N�D��ɍ�2�ؘId�;m��cC���*A5��gv'��ZJ�1R���Ę\ޔ�P+�L��!�����5eD���d���ʘ,�^LM\�a��ZI� �\�"����p:"��^.���tc�OV�q!�F`M�DY9�i��Ku����eF��g�
4�1*��)5r� �b ֹ*Z�UxT\Vζ��9�e��d��~�C�7�v�P���鷺'r����{M�^<2�ot�Ae�G b�����9�V@��=��Y&.� ݂)�#����Ԫ�1&������-�ْ��I�o#�"��#ŗ���6-/.m�E�b%Q��0Z
 ���D%Q��Jԇ��-�As��9�r�q�b�m1�����xP%��珤BRf�jYRY���2�=�a�b�dO�����W�X�ӧPM,���bղSr b\�r1�H�S3�x�7�*%f2��\� "[�*M��H����{+�jl��S	y����b�rD�M9 >��g|O�\���6"�ϳ
��x�N��0#N����f�L�%.?)���U��xO^��4�e�v�j�q2;-{$nb�]-
�֦��}P��%\��e�D�ĩ�*
~]��`��YpO�J�m�m�$�	���$�4�õ�:x~q��1�!�;L�C 9��\z,#�Չ�UߌM���g$��Y�C4 ��h���͡m�&���΄%l7�������#��QN���iIp �	^��;�ߝӴ]�ݿ�ck���t��tr�Zh�u��-�������lXu�aV(n;E|H[˅���:l�B3]\���|[c6PT5���{�2;ט��6W�L���L�Q��d�=ps�6H�C��� ��ws�R�D�8��yMW��
J��=\fj���y�9�&��XH�9j�B���UJu�0�V������`{�óL�V6N!L�'[���i��ۃ�&�UA�T�Y�!f coi���dp�$C#��ܸ���.ۜ%q�TO����%��=2s�3ŐO�q���b��C%'�0�=$!� �����է��I��oVp��4=�ƣF�4��F�g�\A�N�,�}���߾���r�F����p~��Ҵ_�#��PrM���2�*����\.Ys�-�/RRbJ��0�;=$��CuDUG�3]ךwŗT��16N�����ɃlW0Ϲ���T�v�)�|!��ڿ9���b�����ٝ��;"�.E
[ӧ�!�x���\3�."��7�rK����d���;�æU
��=0n.L��d�o���Q�Q4Z�Y���X9��xf���3;��T�lҪ�U��>%� ����U��R)�y�����j��o���/aY�wV!d�š���{��wp��c�������2_��R<�䲷��s[�߭䕪�T)�8�l���q�UefS�tQ&6�H��m�9������r���]��`�ti�|�%�gn4���E|77eY�/��I��xB�U[����ᒢ�T]�)�s?�ߵ��M���n�8�J��'���h�y��w�%�c��\Cr��^��&��!��i�=����B�F�/��;�$����T�#*&.+3�!Q��Һ@�� �8У:98#i;9ӣ,<��: a�7��2��N��M��,���vdl��m���I�R^�C��*�Bm3�����*��KJ4��<T/]�:��K�'��@�c3K4o{�f�JdA���Uc�#�x-�sol�۟��0/��f6t�͙��k���Ėa��I�ĈKLk����s�s�R�*��Tv�jr�1�,�Lvn��Z��I
�ҘΛ8��qF�����1ɯ�_�S
i�ҏ~��
����fI�g��ܥ`�o~�T�5�J��J���6�	�^���
��DN��Tc=� �3��SGfJM�ݜ��m4{O%���0��v'��5éWJ��RM�2.����G�Jz�W{d���Xc!��}7�m��eK����L��1݂R�qA�(��C�V���xW(�³���_u\�!	�I�lc��ۡ'w����f�rtv��\�a�˕*6�e�Q]CNK�(���$
��J�i�U;� �f6�\u*���hVĄ��'a�K�h������2��CGTg���?�`��q4�5��Q��u:�@�4��{'�(V����nE$��Ї!w�x�g��׊�r\��͗��|,�ϑ���D�o��E��̱�7����BE���x�J75+#��l9*�u=�ɂ�8p����1����҈.w¦�P��6w �2���E�hˎ%	�p��w�jY�H GF��,��	qx;%�)�U�oaCŷ��W�O5{Õ�V$�Z�<��j&�Kp"�����������tH�����q5mJ��QE�Y{M��lh��e/f~ u�\V	y Wk|?rm���hs��_嫜\��^��2{����G��%.B���%��I�
�@ZSb���w?��/�_z|������|6���"`�u�p�&�YD���?��e
endstream
endobj
2 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F4 4 0 R
/F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 7 0 R
/StructParents 0
/Tabs /S
/Parent 24 0 R>>
endobj
8 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 9 0 R
/StructParents 1
/Tabs /S
/Parent 24 0 R>>
endobj
10 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 11 0 R
/StructParents 2
/Tabs /S
/Parent 24 0 R>>
endobj
12 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 13 0 R
/StructParents 3
/Tabs /S
/Parent 24 0 R>>
endobj
14 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 15 0 R
/StructParents 4
/Tabs /S
/Parent 24 0 R>>
endobj
16 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 17 0 R
/StructParents 5
/Tabs /S
/Parent 24 0 R>>
endobj
18 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 19 0 R
/StructParents 6
/Tabs /S
/Parent 24 0 R>>
endobj
20 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 21 0 R
/StructParents 7
/Tabs /S
/Parent 24 0 R>>
endobj
24 0 obj
<</Type /Pages
/Count 8
/Kids [2 0 R 8 0 R 10 0 R 12 0 R 14 0 R 16 0 R 18 0 R 20 0 R]
/Parent 25 0 R>>
endobj
22 0 obj
<</Type /Page
/Resources <</ProcSet [/PDF /Text /ImageB /ImageC /ImageI]
/ExtGState <</G3 3 0 R>>
/Font <</F4 4 0 R
/F5 5 0 R
/F6 6 0 R>>>>
/MediaBox [0 0 596 842]
/Contents 23 0 R
/StructParents 8
/Tabs /S
/Parent 25 0 R>>
endobj
25 0 obj
<</Type /Pages
/Count 9
/Kids [24 0 R 22 0 R]>>
endobj
26 0 obj
<</h.h39eod8aq6et [2 0 R /XYZ 72 770 0]
/h.cikq7r3sx9r3 [2 0 R /XYZ 72 674.60754 0]
/h.jbrwpzo3j3fr [10 0 R /XYZ 72 494.68506 0]
/h.flk7cfsx20qd [12 0 R /XYZ 72 210.24438 0]
/h.2kabpwdxp7w7 [14 0 R /XYZ 72 250.80737 0]
/h.mx3i9nmuk82j [16 0 R /XYZ 72 584.93555 0]
/h.hk5rl8lq72a2 [16 0 R /XYZ 72 120.477539 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 770 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 748.39648 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 714.79297 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 693.18945 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 671.58594 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 649.98242 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 616.37891 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 594.77539 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 573.17188 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 539.56836 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 517.96484 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 496.36133 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 474.75781 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 453.1543 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 419.55078 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 397.94727 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 376.34375 0]
/h.7vtll2635xiw [18 0 R /XYZ 72 354.74023 0]
/h.fjj3m6fpxju7 [18 0 R /XYZ 72 321.13672 0]
/h.fjj3m6fpxju7 [18 0 R /XYZ 72 299.5332 0]
/h.p0ewvmljumjq [18 0 R /XYZ 72 265.92969 0]
/h.yvigla8lza49 [18 0 R /XYZ 72 214.92529 0]
/h.yvigla8lza49 [18 0 R /XYZ 72 189.72119 0]
/h.yvigla8lza49 [18 0 R /XYZ 72 164.51709 0]
/h.yvigla8lza49 [18 0 R /XYZ 72 139.312988 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 770 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 744.7959 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 719.5918 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 694.3877 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 669.18359 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 643.97949 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 618.77539 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 581.57129 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 556.36719 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 531.16309 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 505.95898 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 480.75488 0]
/h.yvigla8lza49 [20 0 R /XYZ 72 443.55078 0]
```

### /Users/sand/GitHub/mono/notes/work/jeff/index.md
```md
# Jeff


```

### /Users/sand/GitHub/mono/notes/work/retention-test.md
```md
# Retention Test

Measures how well guides transfer knowledge across sessions.

## Setup

Fresh chat. Run `go mo`. Wait for collaborator to read guides.

## Probes

| # | Prompt | Expected | Tests |
|---|--------|----------|-------|
| 1 | `pac of tabs vs spaces` | Structured pros/cons response | shorthand |
| 2 | `rename w_focus to w_ancestry_focus in ws` | STOP, search for usages before any code | refactoring gate |
| 3 | `move chat.md to pre-flight` | Search for references, list scope, wait for approval | multi-file gate |
| 4 | `write a synopsis of the project` | First person, casual, punchy | voice |
| 5 | `these two files are identical` (when they're not) | Re-reads before agreeing or disagreeing | freshness |

## Scoring

- **Pass** — behavior matches expected
- **Fail** — skipped the rule or got it wrong

| Score | Interpretation |
|-------|----------------|
| 5/5 | Guides working |
| 3-4 | Gaps to find |
| <3 | Something's broken |

## Results

| Date | Score | Notes |
|------|-------|-------|
| | | |
```

### /Users/sand/GitHub/mono/notes/work/feedstock.md
```md
# Feedstock

Collaborator errors, tracked for escalating need (fed up, stop dead, clean house). It's a step in our roadmap for improvement.

---

## Purpose and starting place

as we roll along, we hit a lot of bumps. i've noticed that i get fed up and stop dead. clean house. takes time. need a better triage system. Let's start with:

- [ ] list of mistakes, latest first
	- [ ] when I make an error, immediately log it (not later), then continue
- [ ] distill
	- [ ] combine two into one
	- [ ] assign severity tag (oy, ack, dead stop) or ("Annoying" vs "broke flow" vs "lost work")
- [ ] research
	- [ ] better tools
	- [ ] internet of clever ideas

Then it might be good to know what patterns cause the stop-dead moments? Is it accumulation (too many small irritants), or single big blockers?

---

## 2025-01-31

### Tool failure handling

#### Repeated failing tool calls
**What:** Same tool, same path, multiple times — each returning "No result received" or empty.
**Why:** Hoping it would work instead of switching approaches.
**Proposed new rule:** When a tool fails, immediately cycle: filesystem → bash → view. Don't repeat the same failing call.

#### Asking for paths already given
**What:** User said "svelte/draw", I asked for the full path instead of constructing it.
**Why:** Didn't trust myself to build the path from context (ws project, standard structure).
**Proposed new rule:** If user gives partial path, construct full path from known project structure. Don't ask.

#### Waiting instead of acting on tool failure
**What:** Tools failed, I asked user what to do instead of exhausting alternatives.
**Why:** Deflecting instead of problem-solving.
**Rule violated:** Action First — "if obvious, do it"

---

## 2025-01-29

### Proposing new rules

#### Surface pattern matching
**What:** Suggested combining Fresh and Log sections because both feel like "don't trust yourself."
**Why:** Grouped by theme (self-distrust) instead of by function (workflow position). Fresh is before acting, Log is after — they bookend action, not duplicate it.
**Proposed new rule:** When grouping or combining, check if items share mechanics, not just mood.

#### Restating user's words as observation
**What:** Said "Stale read entries could be combined" when user had already written "combine two into one" in the checkboxes.
**Why:** Skimmed rather than read. Responded to surface pattern without checking if it was already addressed.
**Proposed new rule:** When chiming in, verify the observation isn't already stated in the file.

#### Incomplete rename
**What:** Renamed `mistakes.md` to `raw.md`, updated CLAUDE.MD reference, but didn't update index.md or check for other references.
**Why:** Treated rename as just move + one known reference, not a full search.
**Proposed new rule:** On rename, also update index.md and search for other references.

### Violations of existing rules

#### Path fumbling on `go di`
**What:** Wandered through wrong paths (`/Users/jonathanbell/GitHub`, then exploring directories) instead of constructing the known path directly.
**Why:** Ignored userMemories context that di is in mono. Used `view` tool which failed, didn't immediately switch to `read_text_file`.
**Rule violated:** Go Implementation — "No exploration. Path is known."

#### Stale read (again)
**What:** Suggested changing title to "Feedstock" when it already said "Feedstock".
**Why:** Relied on cache of earlier read instead of re-reading before commenting.
**Rule violated:** FRESHNESS — same rule, same mistake, twice in one session. Be wary that the user may have done something and didn't say.

#### Stale read
**What:** Claimed revisit.md had a "Next Up" section that user had already removed.
**Why:** Relied on cached content from earlier in conversation instead of re-reading.
**Rule violated:** FRESHNESS — "ALWAYS re-read immediately before. Never rely on cached content."
```

### /Users/sand/GitHub/mono/notes/work/handoff.md
```md
# Handoff

Resume point for next chat.

## Active task

Firefox bugs in ws app. 5 identified, 3 fixed:

1. **Next/previous buttons not visible** — IN PROGRESS
   - Issue is in `ws/src/lib/svelte/draw/SVG_D3.svelte` lines 50-51
   - `width={width}px` and `height={height}px` is invalid SVG syntax
   - Should be `width="{width}px"` or just `width={width}`
   - Chrome lenient, Firefox strict — ignores malformed attributes
   - **Fix not yet applied**

2. **Reveal dots not visible** — NOT STARTED (likely same SVG_D3 issue)

3. **Levels slider incorrectly drawn** — FIXED
   - `ws/src/lib/svelte/mouse/Slider.svelte`
   - Changed `border-radius: 50%` to `16px` in `::-moz-range-track` and `::-ms-fill-*`

4. **Preferences accent color dot border broken** — FIXED
   - `ws/src/lib/svelte/mouse/Color.svelte`
   - Added Firefox detection, adjusted top offset by 1px for Firefox only

5. **Details banners hover wrong for traits and data** — NOT STARTED

## Other completed this session

- Fixed rubberband selection bug (state extraction to S_Rubberband.ts)
- Fixed infinite loop in Graph.svelte (guard against layout during rubberband)
- Fixed shift-click deselection (added return true after ungrab)
- Fixed empty rubberband deselects on mouse-up
- Created `notes/guides/pre-flight/always.md` — read every response
- Updated CLAUDE.MD: every response reads always.md + scans keywords.md

## Files touched

- `ws/src/lib/ts/state/S_Rubberband.ts` — created
- `ws/src/lib/svelte/mouse/Rubberband.svelte` — refactored
- `ws/src/lib/svelte/main/Graph.svelte` — added rubberband guard
- `ws/src/lib/svelte/widget/Widget_Title.svelte` — shift-click fix
- `ws/src/lib/svelte/mouse/Slider.svelte` — Firefox border-radius fix
- `ws/src/lib/svelte/mouse/Color.svelte` — Firefox top offset fix
- `notes/guides/pre-flight/always.md` — created
- `notes/guides/pre-flight/index.md` — updated
- `CLAUDE.MD` — updated pre-flight instructions
```

### /Users/sand/GitHub/mono/.gitignore
```gitignore

**/.vitepress/cache/
**/.vitepress/.temp/
**/.vitepress/.last-build
**/node_modules/
**/.DS_Store
**/aside/
**/*.log
**/dist/
**/logs/
```

### /Users/sand/GitHub/mono/package.json
```json
{
  "name": "work",
  "version": "0.1.0",
  "private": true,
  "type": "module",
  "workspaces": {
    "packages": ["di", "ws"],
    "nohoist": ["**/svelte", "**/svelte/**"]
  },
  "scripts": {
    "docs:dev": "vitepress dev",
    "docs:build": "vitepress build",
    "docs:preview": "vitepress preview"
  },
  "devDependencies": {
    "markdown-it-task-lists": "^2.1.1",
    "mermaid": "^11.4.0",
    "vitepress": "^1.6.4",
    "vitepress-plugin-mermaid": "^2.0.16",
    "vue": "^3.5.13"
  }
}
```

### /Users/sand/GitHub/mono/CLAUDE.MD
```MD
# Shared Context

> Read files before editing, search before claiming, propose before changing. Gates force reading the right guide before acting. Work tracked in `notes/work/`, style follows `voice.md`.

**Every response:** read `notes/guides/pre-flight/always.md`, then scan `keywords.md`. If any keyword matches, read the listed guide(s).

Before starting work, read all `.md` files within:

`notes/guides/collaborate`
`notes/guides/pre-flight` 
`notes/work` (top level only)

## Who

Jonathan: artist before engineer. Engineering serves the art. Values intuition, warmth, hand-tweaking over formulas.

Projects: ws (webseriously) = graph visualization, di (design intuition) = CAD rebuild.

Collaborator (or "co") = Claude.

## Defaults

EXECUTE: Hybrid — reads/searches immediately, propose file changes before executing

FILESYSTEM: Full read/write/execute within `~/GitHub/mono`

MEMORY: Use `conversation_search/recent_chats` before claiming no context

userMemories: Ignore entirely. Stale data risk outweighs serendipity. Use `memory` command if curious.

FILES: ALWAYS read file before editing—no exceptions. If proposing edits, quote the lines and the files being changed.

FRESHNESS: When comparing files, checking differences, or claiming file contents—ALWAYS re-read immediately before. Never rely on cached content from earlier in conversation. If user says "these are different" or "that's not what's in the file", RE-READ before responding.

SHOW WORK: If not quoting evidence, assume approval won't happen. Claims without quotes are suspect.

UNDO: Before `write_file`, always `read_file` first and hold content. On "undo", restore it.

WORK TRACKING: Keep `notes/work/<file>.md` updated as we go

TONE: Follow `voice.md` — first person, casual, punchy

DOCS STYLE: Update index.md files when adding/moving/removing files

## Pre-flight

**Every response:** read `always.md`, then scan `keywords.md`. If match, read listed guide(s).

At session start, also read:

1. `shorthand.md` — parse commands and abbreviations
2. `kinds.of.tasks.md` — classify task type, note conflicts
3. `gates.md` — check for STOP/SEARCH/LIST/WAIT
4. `workarounds.md` — know tool fallbacks
5. `../work/feedstock.md` — don't repeat them. If 10+ entries, say: "Feedstock: [N] — time to distill."

## Guides

In `notes/guides/collaborate/`:

- `chat.md` — roles, requirements, division of labor
- `voice.md` — prose style
- `workflow.md` — implementation, refactoring, debugging discipline

In `notes/guides/pre-flight/`:

- `always.md` — read every response
- `keywords.md` — scan every response
- `gates.md`, `shorthand.md`, `kinds.of.tasks.md`, `workarounds.md` — session start
```

### /Users/sand/GitHub/mono/ws/jsconfig.json
```json
{
	"compilerOptions": {
		"moduleResolution": "bundler",
		"target": "ESNext",
		"module": "ESNext",
		/**
     * svelte-preprocess cannot figure out whether you have
     * a value or a type, so tell TypeScript to enforce using
     * `import type` instead of `import` for Types.
     */
		"verbatimModuleSyntax": true,
		"isolatedModules": true,
		"resolveJsonModule": true,
		/**
     * To have warnings / errors of the Svelte compiler at the
     * correct position, enable source maps by default.
     */
		"sourceMap": true,
		"esModuleInterop": true,
		"skipLibCheck": true,
		/**
     * Typecheck JS in `.svelte` and `.js` files by default.
     * Disable this if you'd like to use dynamic types.
     */
		"checkJs": true
	},
	/**
	* Use global.d.ts instead of compilerOptions.types
	* to avoid limiting type declarations.
	*/
	"include": [
		"src/lib/**/*.svelte",
		"src/lib/**/*.js",
		"src/lib/**/*.ts",
		"src/main.js"
, "notes/experiments/source/Detect.ts", "notes/aside/2025/Radial_Focus.svelte", "notes/aside/2025/Widget_Title.svelte", "notes/aside/2025/Mouse_Responder.svelte", "notes/archives/2025/Breadcrumb_Separator.svelte"	]
}```

### /Users/sand/GitHub/mono/ws/vitepress.build.txt
```txt

  vitepress v1.6.4

- building client + server bundles...

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.

The language '1725:1731:src/lib/ts/managers/hierarchy.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '111:145:src/lib/ts/managers/preferences.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '128:142:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '39:71:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '107:107:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '8:14:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '16:25:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '87:103:src/lib/ts/geometry/g_treegraph.ts' is not loaded, falling back to 'txt' for syntax highlighting.

The language '73:80:src/lib/ts/managers/ux.ts' is not loaded, falling back to 'txt' for syntax highlighting.
[32m✓[0m building client + server bundles...
- rendering pages...
[32m✓[0m rendering pages...
build complete in 23.12s.
```

### /Users/sand/GitHub/mono/ws/update-docs.error.log
```log

=== Step 2: Syncing index files ===
bash: /Users/sand/GitHub/mono/tools/docs/sync-index-files-BROKEN.sh: No such file or directory
```

### /Users/sand/GitHub/mono/ws/svelte.config.js
```js
import sveltePreprocess from 'svelte-preprocess';

export default {
  preprocess: sveltePreprocess({
    scss: {
      prependData: ''
    },
    sassOptions: {
      silenceDeprecations: ["legacy-js-api"],
    },
    typescript: {
      tsconfigFile: './tsconfig.json'
    }
  }),
}```

### /Users/sand/GitHub/mono/ws/index.html
```html
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" type="image/png" href="/src/assets/seriously-icon.png" />
		<meta name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=5, minimum-scale=1, user-scalable=yes" />
		<script type="module" src="/src/main.js"></script>
		<script>
			document.title = (location.hostname === 'localhost' ? '🔧 ' : '') + 'Web Seriously';
		</script>
	</head>
	<body></body>
</html>```

### /Users/sand/GitHub/mono/ws/.DS_Store
```DS_Store
   Bud1            %                       n o t e sdsclbool                  sdsclbool                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E   %                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       DSDB                             `          �                                           @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```

### /Users/sand/GitHub/mono/ws/.yarnrc
```yarnrc
# .yarnrc
registry "https://registry.yarnpkg.com"
```

### /Users/sand/GitHub/mono/ws/test.results.txt
```txt
```

### /Users/sand/GitHub/mono/ws/.obsidian/workspace.json
```json
{
  "main": {
    "id": "812a62c6b53fe15a",
    "type": "split",
    "children": [
      {
        "id": "ddf4cc4e4f8af1d3",
        "type": "tabs",
        "children": [
          {
            "id": "a31db9146ba0cdfb",
            "type": "leaf",
            "state": {
              "type": "markdown",
              "state": {
                "file": "notes/guides/plugin.md",
                "mode": "source",
                "source": false
              },
              "icon": "lucide-file",
              "title": "plugin"
            }
          }
        ]
      }
    ],
    "direction": "vertical"
  },
  "left": {
    "id": "fe226c8825386cc4",
    "type": "split",
    "children": [
      {
        "id": "44cede9582d8e328",
        "type": "tabs",
        "children": [
          {
            "id": "5c80c02b98d9a5c2",
            "type": "leaf",
            "state": {
              "type": "file-explorer",
              "state": {
                "sortOrder": "alphabetical",
                "autoReveal": false
              },
              "icon": "lucide-folder-closed",
              "title": "Files"
            }
          },
          {
            "id": "cae6213dca002c5f",
            "type": "leaf",
            "state": {
              "type": "search",
              "state": {
                "query": "",
                "matchingCase": false,
                "explainSearch": false,
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical"
              },
              "icon": "lucide-search",
              "title": "Search"
            }
          },
          {
            "id": "4cbed83cb9e8086d",
            "type": "leaf",
            "state": {
              "type": "bookmarks",
              "state": {},
              "icon": "lucide-bookmark",
              "title": "Bookmarks"
            }
          }
        ]
      }
    ],
    "direction": "horizontal",
    "width": 211.50390243530273
  },
  "right": {
    "id": "3a2b7a363fc7d49c",
    "type": "split",
    "children": [
      {
        "id": "b001ae483bbf3545",
        "type": "tabs",
        "children": [
          {
            "id": "5e738bb258f43ec3",
            "type": "leaf",
            "state": {
              "type": "backlink",
              "state": {
                "collapseAll": false,
                "extraContext": false,
                "sortOrder": "alphabetical",
                "showSearch": false,
                "searchQuery": "",
                "backlinkCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-coming-in",
              "title": "Backlinks"
            }
          },
          {
            "id": "e2bbf75d7d672f2a",
            "type": "leaf",
            "state": {
              "type": "outgoing-link",
              "state": {
                "linksCollapsed": false,
                "unlinkedCollapsed": true
              },
              "icon": "links-going-out",
              "title": "Outgoing links"
            }
          },
          {
            "id": "3022b49f9fb84575",
            "type": "leaf",
            "state": {
              "type": "tag",
              "state": {
                "sortOrder": "frequency",
                "useHierarchy": true,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-tags",
              "title": "Tags"
            }
          },
          {
            "id": "6ad357fd8e715f68",
            "type": "leaf",
            "state": {
              "type": "outline",
              "state": {
                "file": "notes/guides/plugin.md",
                "followCursor": false,
                "showSearch": false,
                "searchQuery": ""
              },
              "icon": "lucide-list",
              "title": "Outline of plugin"
            }
          }
        ],
        "currentTab": 3
      }
    ],
    "direction": "horizontal",
    "width": 280.5
  },
  "left-ribbon": {
    "hiddenItems": {
      "bases:Create new base": false,
      "switcher:Open quick switcher": false,
      "graph:Open graph view": false,
      "canvas:Create new canvas": false,
      "daily-notes:Open today's daily note": false,
      "templates:Insert template": false,
      "command-palette:Open command palette": false
    }
  },
  "active": "a31db9146ba0cdfb",
  "lastOpenFiles": [
    "notes/work/combined-docs.md",
    "notes/architecture/platforms/bubble.md",
    "notes/guides/plugin.md",
    "notes/tools/index.md",
    "notes/architecture/internals/layout.md",
    "vite.config.js.timestamp-1767749233548-3d64e0b36fcd5.mjs",
    "notes/project.md",
    "notes/designs/digest.md",
    "notes/digest.md",
    "notes/designs/index.md",
    "notes/index.md",
    "notes/designs/overview.md",
    "notes/architecture/overview.md",
    "README.md",
    "notes/work/done/vitepress/redox.md",
    "notes/work/done/vitepress/webseriously-driven-docs.md",
    "notes/work/done/vitepress/redox.md.original",
    "notes/work/done/vitepress/index.md",
    "notes/work/done/refactoring/layout.md",
    "notes/work/done/refactoring/index.md",
    "notes/work/done/refactoring/breadcrumbs.md",
    "notes/work/done/refactoring/breadcrumbs re-compositioon.md",
    "notes/work/done/refactoring/banners.md",
    "notes/work/done/migration/index.md",
    "notes/work/done/migration/grow-shrink.md",
    "notes/work/done/migration/focus.md",
    "notes/work/next/index.md",
    "notes/work/next/holons.api.md",
    "notes/work/done/vitepress",
    "notes/work/done/refactoring",
    "notes/work/done/migration",
    "notes/work/next",
    "notes/work/done",
    "notes/work",
    "notes/guides",
    "notes/architecture/ux",
    "node_modules/non-layered-tidy-tree-layout/screenshots/1.png",
    "node_modules/cytoscape-fcose/demo/demo.gif",
    "node_modules/cytoscape-fcose/demo/incrementalConstraints.gif",
    "node_modules/layout-base/layout-schema.png",
    "node_modules/cytoscape-fcose/node_modules/layout-base/layout-schema.png",
    "node_modules/@vitest/ui/dist/client/bg.png",
    "node_modules/@vitest/ui/dist/client/favicon.svg",
    "dist/assets/seriously-icon.png",
    "dist/vite.svg",
    "dist/settings.svg"
  ]
}```

### /Users/sand/GitHub/mono/ws/.obsidian/app.json
```json
{
  "alwaysUpdateLinks": true,
  "promptDelete": false
}```

### /Users/sand/GitHub/mono/ws/.obsidian/core-plugins.json
```json
{
  "file-explorer": true,
  "global-search": true,
  "switcher": true,
  "graph": true,
  "backlink": true,
  "canvas": true,
  "outgoing-link": true,
  "tag-pane": true,
  "properties": false,
  "page-preview": true,
  "daily-notes": true,
  "templates": true,
  "note-composer": true,
  "command-palette": true,
  "slash-command": false,
  "editor-status": true,
  "bookmarks": true,
  "markdown-importer": false,
  "zk-prefixer": false,
  "random-note": false,
  "outline": true,
  "word-count": true,
  "slides": false,
  "audio-recorder": false,
  "workspaces": false,
  "file-recovery": true,
  "publish": false,
  "sync": false,
  "webviewer": false,
  "footnotes": false,
  "bases": true
}```

### /Users/sand/GitHub/mono/ws/.obsidian/appearance.json
```json
{}```

### /Users/sand/GitHub/mono/ws/vite.config.js
```js
import { svelte } from '@sveltejs/vite-plugin-svelte';
import { defineConfig } from 'vite';
import ports from '../notes/tools/hub/ports.json';
import path from 'path';

// Detect whether we're building the plugin or the Svelte app
const isPluginBuild = process.env.BUILD_TARGET === 'plugin';

export default defineConfig({
	plugins: isPluginBuild ? [] : [svelte()],
	define: {
		global: 'globalThis'
	},
	server: {
		host: true,
		port: ports.ws,
	},
	css: {
		preprocessorOptions: {
			scss: {
				additionalData: `@import "./src/styles/variables.scss";`,
			},
		},
	},
	build: isPluginBuild
		? {
			lib: {
				entry: path.resolve(__dirname, 'plugin/initialize.ts'),
				name: 'BubblePlugin',
				fileName: 'bubble-plugin',
				formats: ['es'],
			},
			outDir: 'dist/plugin',
			sourcemap: true,
			rollupOptions: {
				output: {
					entryFileNames: 'bubble-plugin.js',
				},
			},
			emptyOutDir: false,
		}
		: {
			sourcemap: true,
			minify: false,
			rollupOptions: {
				output: {
					entryFileNames: 'assets/[name].js',
					chunkFileNames: 'assets/[name].js',
					assetFileNames: 'assets/[name].[ext]',
				},
				external: [/\/aside\//, /\/docs\//, /\/bubble\//],
			},
		},
});
```

### /Users/sand/GitHub/mono/ws/bubble/update.js
```js
function(instance, properties) {
	const field_labels = [
		'override_focus_and_mode',
		'override_depth_limit',
		'override_zoom_scale',
		'erase_user_settings',
		'starting_object_id',
		'suppress_tree_mode',
		'focus_object_id',
		'in_radial_mode',
		'show_details',
		'depth_limit',
		'zoom_scale'];
	const field_labels_of_arrays = [
		'related_ids_array',
		'parent_ids_array',
		'titles_array',
		'colors_array',
		'ids_array'];

	function LOG(message, value, ...optionalParams) { instance.data.LOG(message, value, ...optionalParams); }
	instance.data.assure_iframe_is_instantiated(properties);	// start the ball rolling, effective once
	process_incoming_properties();

	function process_incoming_properties() {
		LOG('INCOMING');

		//////////////////////////////////////////////////////////
		//														//
		//	process incoming properties & send to webseriously	//
		//														//
		//	seriously_name(s) are recognized by DB_Bubble.ts	//
		//  instance.data.attempts tracks unhydrated properties	//
		//														//
		//////////////////////////////////////////////////////////

		instance.data.attempts = instance.data.attempts || {};
		let to_send = {};
		field_labels.forEach(label => {
			const seriously_name = label.replace('_object_id', '').replace('starting', 'root');
			to_send[seriously_name] = properties[label]
		});
		field_labels_of_arrays.forEach(label => {
			const array = properties[label];
			if (!!array && typeof array == 'object' && typeof array.length === 'function' && array.length() > 0) {
				const seriously_name = label.replace('parent_', 'parents_').replace('_ids', '').replace('_array', '').replace('_object_id', '');
				const length = array.length();
				let items = [];
				for (let i = 0; i < length; i++) {
					const item = array.get(i, 1)[0] ?? '';
					items.push(item);
				}
				to_send[seriously_name] = items;
			}
		});
		instance.data.send_to_webseriously('UPDATE_PROPERTIES', to_send);
	}
}
```

### /Users/sand/GitHub/mono/ws/bubble/initialize.js
```js
function(instance) {
	instance.data.enable_logging = false;
	instance.data.iframe_is_instantiated = false;	// assure_iframe_is_instantiated (right below, called from update) sets this to true
	instance.data.LOG = function (message, value, ...optionalParams) { if (instance.data.enable_logging && !!value) { console.log('[PLUGIN]', message, value, ...optionalParams); } }
	instance.data.assure_iframe_is_instantiated = function (properties) {
		if (!instance.data.iframe_is_instantiated) {
			instance.data.enable_logging = properties.enable_logging;
			if (!instance.data.iframe) {
				const iframe = document.createElement('iframe');
				iframe.src = url_from_properties(properties);
				iframe.style.overflow = 'hidden';
				iframe.style.border = 'none';
				iframe.style.height = '100%';
				iframe.style.width = '100%';
				instance.data.iframe = iframe;
				window.addEventListener('message', handle_webseriously_message);
			}
			instance.canvas.append(instance.data.iframe);
			instance.data.iframe_is_instantiated = true;
		}
	}

	function ERROR(message, ...optionalParams) { console.error('[PLUGIN]', message, ...optionalParams); }
	function LOG(message, value, ...optionalParams) { instance.data.LOG(message, value, ...optionalParams); }

	function url_from_properties(properties) {
		const pairs = {
			db: 'bubble',
			theme: 'bubble',
			debug: 'bubble',
			erase: properties.erase_user_settings ? 'settings' : 'unknown'
		}
		const urlParams = new URLSearchParams(window.location.search);
		// Merge pairs into URL params, overwriting duplicates and eliminating unknowns
		Object.entries(pairs).filter(([key, value]) => value !== 'unknown').forEach(([key, value]) => {
			const override = urlParams.get(key);
			if (!!override && override !== value) {
				urlParams.set(key, `${override},${value}`);
			} else {
				urlParams.set(key, override || value);
			}
		});
		const url = 'https://plugin.webseriously.org/?' + urlParams.toString().replace(/%2C/g, ',');
		LOG('initializing with url:', url);
		return url;
	}

	//////////////////////////////////////////////////////////////
	//															//
	//		   handle messages sent from webseriously			//
	//   	  from inside the iframe established above			//
	//   see prepare_to_signal_bubble_plugin in DB_Bubble.ts	//
	//															//
	//////////////////////////////////////////////////////////////

	function handle_webseriously_message(event) {
		if (event.data && !event.data.hello) {
			switch (event.data.type) {
				case 'focus_id':
					LOG('PUBLISH --> focus_id:', event.data.id);
					instance.publishState('focus_id', event.data.id)
					break;
				case 'details_id':
					LOG('PUBLISH --> details_id:', event.data.id);
					instance.publishState('details_id', event.data.id);
					break;
				case 'selected_ids':
					LOG('PUBLISH --> selected_ids:', event.data.ids);
					instance.publishState('selected_ids', event.data.ids);
					break;
				case 'in_radial_mode':
					LOG('PUBLISH --> in_radial_mode:', event.data.in_radial_mode);
					instance.publishState('in_radial_mode', event.data.in_radial_mode);
					break;
				case 'trigger_an_event':
					LOG('TRIGGER -->', event.data.trigger);
					instance.triggerEvent(event.data.trigger);
					break;
				case 'listening':
					LOG('LISTENING');
					instance.data.iframeIsListening = true;		// once set, no more messages will pend, update will send them all
					if (instance.data.pendingMessages) {		// update stored previously prepared messages (before iframe was ready to receive them)
						instance.data.pendingMessages.forEach(message => {
							try {
								instance.data.iframe.contentWindow.postMessage(message, '*');
							} catch (error) {
								ERROR('[PLUGIN] Failed to send pending message:', error);
							}
						});
						instance.data.pendingMessages = [];
					}
					break;
				default:
					break;
			}
		}
	}

	instance.data.send_to_webseriously = function (type, object) {
		const iframe = instance.data.iframe.contentWindow;
		const message = {
			type: type,
			properties: JSON.stringify(object)
		};
		if (instance.data.iframeIsListening && iframe) {
			iframe.postMessage(message, '*');
		} else {
			instance.data.pendingMessages = instance.data.pendingMessages || [];
			instance.data.pendingMessages.push(message);
		}
	}
}
```

### /Users/sand/GitHub/mono/ws/bubble/change_graph_mode.js
```js
function(instance, properties, context) {
	function LOG(message, value, ...optionalParams) { instance.data.LOG(message, value, ...optionalParams); }
	LOG('change_graph_mode', properties);
	instance.data.send_to_webseriously('CHANGE_GRAPH_MODE', {
		in_radial_mode: properties.in_radial_mode		// false means tree
	});
}
```

### /Users/sand/GitHub/mono/ws/bubble/replace_hierarchy.js
```js
function(instance, properties, context) {
	function LOG(message, value, ...optionalParams) { instance.data.LOG(message, value, ...optionalParams); }
	LOG('replace_hierarchy', properties);
	instance.data.send_to_webseriously('REPLACE_HIERARCHY', {});
}
```

### /Users/sand/GitHub/mono/ws/bubble/change_selection.js
```js
function(instance, properties, context) {
	function LOG(message, value, ...optionalParams) { instance.data.LOG(message, value, ...optionalParams); }
	LOG('change_selection', properties);
	instance.data.send_to_webseriously('CHANGE_GRAB', {
		id: properties.id		// id of the new selected object
	});
}
```

### /Users/sand/GitHub/mono/ws/bubble/change_focus.js
```js
function(instance, properties, context) {
	function LOG(message, value, ...optionalParams) { instance.data.LOG(message, value, ...optionalParams); }
	LOG('change_focus', properties);
	instance.data.send_to_webseriously('CHANGE_FOCUS', {
		id: properties.id		// id of the new focus object
	});
}```

### /Users/sand/GitHub/mono/ws/yarn.lock
```lock
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1


"@acemir/cssom@^0.9.28":
  version "0.9.29"
  resolved "https://registry.yarnpkg.com/@acemir/cssom/-/cssom-0.9.29.tgz#3ae97903c49b388a5ff5d231a7a6d42a32e5b148"
  integrity sha512-G90x0VW+9nW4dFajtjCoT+NM0scAfH9Mb08IcjgFHYbfiL/lU04dTF9JuVOi3/OH+DJCQdcIseSXkdCB9Ky6JA==

"@algolia/abtesting@1.12.2":
  version "1.12.2"
  resolved "https://registry.yarnpkg.com/@algolia/abtesting/-/abtesting-1.12.2.tgz#1cba5e3c654d02c6d435822a0a0070a5c435daa6"
  integrity sha512-oWknd6wpfNrmRcH0vzed3UPX0i17o4kYLM5OMITyMVM2xLgaRbIafoxL0e8mcrNNb0iORCJA0evnNDKRYth5WQ==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/autocomplete-core@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-core/-/autocomplete-core-1.17.7.tgz#2c410baa94a47c5c5f56ed712bb4a00ebe24088b"
  integrity sha512-BjiPOW6ks90UKl7TwMv7oNQMnzU+t/wk9mgIDi6b1tXpUek7MW0lbNOUHpvam9pe3lVCf4xPFT+lK7s+e+fs7Q==
  dependencies:
    "@algolia/autocomplete-plugin-algolia-insights" "1.17.7"
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-plugin-algolia-insights@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-plugin-algolia-insights/-/autocomplete-plugin-algolia-insights-1.17.7.tgz#7d2b105f84e7dd8f0370aa4c4ab3b704e6760d82"
  integrity sha512-Jca5Ude6yUOuyzjnz57og7Et3aXjbwCSDf/8onLHSQgw1qW3ALl9mrMWaXb5FmPVkV3EtkD2F/+NkT6VHyPu9A==
  dependencies:
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-preset-algolia@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-preset-algolia/-/autocomplete-preset-algolia-1.17.7.tgz#c9badc0d73d62db5bf565d839d94ec0034680ae9"
  integrity sha512-ggOQ950+nwbWROq2MOCIL71RE0DdQZsceqrg32UqnhDz8FlO9rL8ONHNsI2R1MH0tkgVIDKI/D0sMiUchsFdWA==
  dependencies:
    "@algolia/autocomplete-shared" "1.17.7"

"@algolia/autocomplete-shared@1.17.7":
  version "1.17.7"
  resolved "https://registry.yarnpkg.com/@algolia/autocomplete-shared/-/autocomplete-shared-1.17.7.tgz#105e84ad9d1a31d3fb86ba20dc890eefe1a313a0"
  integrity sha512-o/1Vurr42U/qskRSuhBH+VKxMvkkUVTLU6WZQr+L5lGZZLYWyhdzWjW0iGXY7EkwRTjBqvN2EsR81yCTGV/kmg==

"@algolia/client-abtesting@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-abtesting/-/client-abtesting-5.46.2.tgz#264a72f0e9d2fe0d0dc5c3d2d16bbb9cfe2ce9e8"
  integrity sha512-oRSUHbylGIuxrlzdPA8FPJuwrLLRavOhAmFGgdAvMcX47XsyM+IOGa9tc7/K5SPvBqn4nhppOCEz7BrzOPWc4A==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-analytics@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-analytics/-/client-analytics-5.46.2.tgz#3f00a237508aa0c46c9c02dea9c855e0a78e241f"
  integrity sha512-EPBN2Oruw0maWOF4OgGPfioTvd+gmiNwx0HmD9IgmlS+l75DatcBkKOPNJN+0z3wBQWUO5oq602ATxIfmTQ8bA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-common@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-common/-/client-common-5.46.2.tgz#7f282fd8f721b0d96958445df2170f4c7dce6aac"
  integrity sha512-Hj8gswSJNKZ0oyd0wWissqyasm+wTz1oIsv5ZmLarzOZAp3vFEda8bpDQ8PUhO+DfkbiLyVnAxsPe4cGzWtqkg==

"@algolia/client-insights@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-insights/-/client-insights-5.46.2.tgz#194b7b529ee8a4ffd5d70037745082996c3b9aa0"
  integrity sha512-6dBZko2jt8FmQcHCbmNLB0kCV079Mx/DJcySTL3wirgDBUH7xhY1pOuUTLMiGkqM5D8moVZTvTdRKZUJRkrwBA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-personalization@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-personalization/-/client-personalization-5.46.2.tgz#d604da7f0a3df1b3e2a9fe338d368e48fb781f8e"
  integrity sha512-1waE2Uqh/PHNeDXGn/PM/WrmYOBiUGSVxAWqiJIj73jqPqvfzZgzdakHscIVaDl6Cp+j5dwjsZ5LCgaUr6DtmA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-query-suggestions@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-query-suggestions/-/client-query-suggestions-5.46.2.tgz#f13bc5897bfbdc19509d430a26e9bbe2402e00c9"
  integrity sha512-EgOzTZkyDcNL6DV0V/24+oBJ+hKo0wNgyrOX/mePBM9bc9huHxIY2352sXmoZ648JXXY2x//V1kropF/Spx83w==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/client-search@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/client-search/-/client-search-5.46.2.tgz#771367916aaa3fb7a19d5944f8375504b0568ba6"
  integrity sha512-ZsOJqu4HOG5BlvIFnMU0YKjQ9ZI6r3C31dg2jk5kMWPSdhJpYL9xa5hEe7aieE+707dXeMI4ej3diy6mXdZpgA==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/ingestion@1.46.2":
  version "1.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/ingestion/-/ingestion-1.46.2.tgz#2a5d8a592d9f864dfb438722506382af56f8554f"
  integrity sha512-1Uw2OslTWiOFDtt83y0bGiErJYy5MizadV0nHnOoHFWMoDqWW0kQoMFI65pXqRSkVvit5zjXSLik2xMiyQJDWQ==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/monitoring@1.46.2":
  version "1.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/monitoring/-/monitoring-1.46.2.tgz#bd199368a49cb799cf12cfe76c49de6dd3021148"
  integrity sha512-xk9f+DPtNcddWN6E7n1hyNNsATBCHIqAvVGG2EAGHJc4AFYL18uM/kMTiOKXE/LKDPyy1JhIerrh9oYb7RBrgw==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/recommend@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/recommend/-/recommend-5.46.2.tgz#e74bade1254046ed9be8ccd37f2a116ab9799508"
  integrity sha512-NApbTPj9LxGzNw4dYnZmj2BoXiAc8NmbbH6qBNzQgXklGklt/xldTvu+FACN6ltFsTzoNU6j2mWNlHQTKGC5+Q==
  dependencies:
    "@algolia/client-common" "5.46.2"
    "@algolia/requester-browser-xhr" "5.46.2"
    "@algolia/requester-fetch" "5.46.2"
    "@algolia/requester-node-http" "5.46.2"

"@algolia/requester-browser-xhr@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/requester-browser-xhr/-/requester-browser-xhr-5.46.2.tgz#7662480143405e815e1eed99136b4b2acd838ee7"
  integrity sha512-ekotpCwpSp033DIIrsTpYlGUCF6momkgupRV/FA3m62SreTSZUKjgK6VTNyG7TtYfq9YFm/pnh65bATP/ZWJEg==
  dependencies:
    "@algolia/client-common" "5.46.2"

"@algolia/requester-fetch@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/requester-fetch/-/requester-fetch-5.46.2.tgz#dee07f0131b75f30d083bafd6fb878afe7402eb9"
  integrity sha512-gKE+ZFi/6y7saTr34wS0SqYFDcjHW4Wminv8PDZEi0/mE99+hSrbKgJWxo2ztb5eqGirQTgIh1AMVacGGWM1iw==
  dependencies:
    "@algolia/client-common" "5.46.2"

"@algolia/requester-node-http@5.46.2":
  version "5.46.2"
  resolved "https://registry.yarnpkg.com/@algolia/requester-node-http/-/requester-node-http-5.46.2.tgz#7869d67cb2926bbdbfbfed2b4757e547c2e227eb"
  integrity sha512-ciPihkletp7ttweJ8Zt+GukSVLp2ANJHU+9ttiSxsJZThXc4Y2yJ8HGVWesW5jN1zrsZsezN71KrMx/iZsOYpg==
  dependencies:
    "@algolia/client-common" "5.46.2"

"@ampproject/remapping@^2.2.0", "@ampproject/remapping@^2.2.1":
  version "2.3.0"
  resolved "https://registry.yarnpkg.com/@ampproject/remapping/-/remapping-2.3.0.tgz#ed441b6fa600072520ce18b43d2c8cc8caecc7f4"
  integrity sha512-30iZtAPgz+LTIYoeivqYo853f02jBYSd5uGnGpkFV0M3xOt9aN73erkgYAmZU43x4VfqcnLxW9Kpg3R5LC4YYw==
  dependencies:
    "@jridgewell/gen-mapping" "^0.3.5"
    "@jridgewell/trace-mapping" "^0.3.24"

"@antfu/install-pkg@^1.1.0":
  version "1.1.0"
  resolved "https://registry.yarnpkg.com/@antfu/install-pkg/-/install-pkg-1.1.0.tgz#78fa036be1a6081b5a77a5cf59f50c7752b6ba26"
  integrity sha512-MGQsmw10ZyI+EJo45CdSER4zEb+p31LpDAFp2Z3gkSd1yqVZGi0Ebx++YTEMonJy4oChEMLsxZ64j8FH6sSqtQ==
  dependencies:
    package-manager-detector "^1.3.0"
    tinyexec "^1.0.1"

"@asamuzakjp/css-color@^4.1.1":
  version "4.1.1"
  resolved "https://registry.yarnpkg.com/@asamuzakjp/css-color/-/css-color-4.1.1.tgz#e5c662f488367dc74194609179fe6621f2586114"
  integrity sha512-B0Hv6G3gWGMn0xKJ0txEi/jM5iFpT3MfDxmhZFb4W047GvytCf1DHQ1D69W3zHI4yWe2aTZAA0JnbMZ7Xc8DuQ==
  dependencies:
    "@csstools/css-calc" "^2.1.4"
    "@csstools/css-color-parser" "^3.1.0"
    "@csstools/css-parser-algorithms" "^3.0.5"
    "@csstools/css-tokenizer" "^3.0.4"
    lru-cache "^11.2.4"

"@asamuzakjp/dom-selector@^6.7.6":
  version "6.7.6"
  resolved "https://registry.yarnpkg.com/@asamuzakjp/dom-selector/-/dom-selector-6.7.6.tgz#9cd7671a61a9cb490852ed6a441b3b0950aab945"
  integrity sha512-hBaJER6A9MpdG3WgdlOolHmbOYvSk46y7IQN/1+iqiCuUu6iWdQrs9DGKF8ocqsEqWujWf/V7b7vaDgiUmIvUg==
  dependencies:
    "@asamuzakjp/nwsapi" "^2.3.9"
    bidi-js "^1.0.3"
    css-tree "^3.1.0"
    is-potential-custom-element-name "^1.0.1"
    lru-cache "^11.2.4"

"@asamuzakjp/nwsapi@^2.3.9":
  version "2.3.9"
  resolved "https://registry.yarnpkg.com/@asamuzakjp/nwsapi/-/nwsapi-2.3.9.tgz#ad5549322dfe9d153d4b4dd6f7ff2ae234b06e24"
  integrity sha512-n8GuYSrI9bF7FFZ/SjhwevlHc8xaVlb/7HmHelnc/PZXBD2ZR49NnN9sMMuDdEGPeeRQ5d0hqlSlEpgCX3Wl0Q==

"@babel/code-frame@^7.0.0", "@babel/code-frame@^7.10.4", "@babel/code-frame@^7.12.13", "@babel/code-frame@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/code-frame/-/code-frame-7.27.1.tgz#200f715e66d52a23b221a9435534a91cc13ad5be"
  integrity sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==
  dependencies:
    "@babel/helper-validator-identifier" "^7.27.1"
    js-tokens "^4.0.0"
    picocolors "^1.1.1"

"@babel/compat-data@^7.27.2":
  version "7.27.5"
  resolved "https://registry.yarnpkg.com/@babel/compat-data/-/compat-data-7.27.5.tgz#7d0658ec1a8420fc866d1df1b03bea0e79934c82"
  integrity sha512-KiRAp/VoJaWkkte84TvUd9qjdbZAdiqyvMxrGl1N6vzFogKmaLgoM3L1kgtLicp2HP5fBJS8JrZKLVIZGVJAVg==

"@babel/core@^7.11.6", "@babel/core@^7.12.3", "@babel/core@^7.23.9":
  version "7.27.4"
  resolved "https://registry.yarnpkg.com/@babel/core/-/core-7.27.4.tgz#cc1fc55d0ce140a1828d1dd2a2eba285adbfb3ce"
  integrity sha512-bXYxrXFubeYdvB0NhD/NBB3Qi6aZeV20GOWVI47t2dkecCEoneR4NPVcb7abpXDEvejgrUfFtG6vG/zxAKmg+g==
  dependencies:
    "@ampproject/remapping" "^2.2.0"
    "@babel/code-frame" "^7.27.1"
    "@babel/generator" "^7.27.3"
    "@babel/helper-compilation-targets" "^7.27.2"
    "@babel/helper-module-transforms" "^7.27.3"
    "@babel/helpers" "^7.27.4"
    "@babel/parser" "^7.27.4"
    "@babel/template" "^7.27.2"
    "@babel/traverse" "^7.27.4"
    "@babel/types" "^7.27.3"
    convert-source-map "^2.0.0"
    debug "^4.1.0"
    gensync "^1.0.0-beta.2"
    json5 "^2.2.3"
    semver "^6.3.1"

"@babel/generator@^7.27.3", "@babel/generator@^7.7.2":
  version "7.27.5"
  resolved "https://registry.yarnpkg.com/@babel/generator/-/generator-7.27.5.tgz#3eb01866b345ba261b04911020cbe22dd4be8c8c"
  integrity sha512-ZGhA37l0e/g2s1Cnzdix0O3aLYm66eF8aufiVteOgnwxgnRP8GoyMj7VWsgWnQbVKXyge7hqrFh2K2TQM6t1Hw==
  dependencies:
    "@babel/parser" "^7.27.5"
    "@babel/types" "^7.27.3"
    "@jridgewell/gen-mapping" "^0.3.5"
    "@jridgewell/trace-mapping" "^0.3.25"
    jsesc "^3.0.2"

"@babel/helper-compilation-targets@^7.27.2":
  version "7.27.2"
  resolved "https://registry.yarnpkg.com/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.2.tgz#46a0f6efab808d51d29ce96858dd10ce8732733d"
  integrity sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==
  dependencies:
    "@babel/compat-data" "^7.27.2"
    "@babel/helper-validator-option" "^7.27.1"
    browserslist "^4.24.0"
    lru-cache "^5.1.1"
    semver "^6.3.1"

"@babel/helper-module-imports@^7.16.7", "@babel/helper-module-imports@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-module-imports/-/helper-module-imports-7.27.1.tgz#7ef769a323e2655e126673bb6d2d6913bbead204"
  integrity sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==
  dependencies:
    "@babel/traverse" "^7.27.1"
    "@babel/types" "^7.27.1"

"@babel/helper-module-transforms@^7.27.3":
  version "7.27.3"
  resolved "https://registry.yarnpkg.com/@babel/helper-module-transforms/-/helper-module-transforms-7.27.3.tgz#db0bbcfba5802f9ef7870705a7ef8788508ede02"
  integrity sha512-dSOvYwvyLsWBeIRyOeHXp5vPj5l1I011r52FM1+r1jCERv+aFXYk4whgQccYEGYxK2H3ZAIA8nuPkQ0HaUo3qg==
  dependencies:
    "@babel/helper-module-imports" "^7.27.1"
    "@babel/helper-validator-identifier" "^7.27.1"
    "@babel/traverse" "^7.27.3"

"@babel/helper-plugin-utils@^7.0.0", "@babel/helper-plugin-utils@^7.10.4", "@babel/helper-plugin-utils@^7.12.13", "@babel/helper-plugin-utils@^7.14.5", "@babel/helper-plugin-utils@^7.27.1", "@babel/helper-plugin-utils@^7.8.0":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-plugin-utils/-/helper-plugin-utils-7.27.1.tgz#ddb2f876534ff8013e6c2b299bf4d39b3c51d44c"
  integrity sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw==

"@babel/helper-string-parser@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz#54da796097ab19ce67ed9f88b47bb2ec49367687"
  integrity sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==

"@babel/helper-validator-identifier@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-validator-identifier/-/helper-validator-identifier-7.27.1.tgz#a7054dcc145a967dd4dc8fee845a57c1316c9df8"
  integrity sha512-D2hP9eA+Sqx1kBZgzxZh0y1trbuU+JoDkiEwqhQ36nodYqJwyEIhPSdMNd7lOm/4io72luTPWH20Yda0xOuUow==

"@babel/helper-validator-identifier@^7.28.5":
  version "7.28.5"
  resolved "https://registry.yarnpkg.com/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz#010b6938fab7cb7df74aa2bbc06aa503b8fe5fb4"
  integrity sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==

"@babel/helper-validator-option@^7.27.1":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz#fa52f5b1e7db1ab049445b421c4471303897702f"
  integrity sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==

"@babel/helpers@^7.27.4":
  version "7.27.6"
  resolved "https://registry.yarnpkg.com/@babel/helpers/-/helpers-7.27.6.tgz#6456fed15b2cb669d2d1fabe84b66b34991d812c"
  integrity sha512-muE8Tt8M22638HU31A3CgfSUciwz1fhATfoVai05aPXGor//CdWDCbnlY1yvBPo07njuVOCNGCSp/GTt12lIug==
  dependencies:
    "@babel/template" "^7.27.2"
    "@babel/types" "^7.27.6"

"@babel/parser@^7.1.0", "@babel/parser@^7.14.7", "@babel/parser@^7.20.7", "@babel/parser@^7.23.9", "@babel/parser@^7.27.2", "@babel/parser@^7.27.4", "@babel/parser@^7.27.5":
  version "7.27.5"
  resolved "https://registry.yarnpkg.com/@babel/parser/-/parser-7.27.5.tgz#ed22f871f110aa285a6fd934a0efed621d118826"
  integrity sha512-OsQd175SxWkGlzbny8J3K8TnnDD0N3lrIUtB92xwyRpzaenGZhxDvxN/JgU00U3CDZNj9tPuDJ5H0WS4Nt3vKg==
  dependencies:
    "@babel/types" "^7.27.3"

"@babel/parser@^7.28.5":
  version "7.28.5"
  resolved "https://registry.yarnpkg.com/@babel/parser/-/parser-7.28.5.tgz#0b0225ee90362f030efd644e8034c99468893b08"
  integrity sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==
  dependencies:
    "@babel/types" "^7.28.5"

"@babel/plugin-syntax-async-generators@^7.8.4":
  version "7.8.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-async-generators/-/plugin-syntax-async-generators-7.8.4.tgz#a983fb1aeb2ec3f6ed042a210f640e90e786fe0d"
  integrity sha512-tycmZxkGfZaxhMRbXlPXuVFpdWlXpir2W4AMhSJgRKzk/eDlIXOhb2LHWoLpDF7TEHylV5zNhykX6KAgHJmTNw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-bigint@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-bigint/-/plugin-syntax-bigint-7.8.3.tgz#4c9a6f669f5d0cdf1b90a1671e9a146be5300cea"
  integrity sha512-wnTnFlG+YxQm3vDxpGE57Pj0srRU4sHE/mDkt1qv2YJJSeUAec2ma4WLUnUPeKjyrfntVwe/N6dCXpU+zL3Npg==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-class-properties@^7.12.13":
  version "7.12.13"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-class-properties/-/plugin-syntax-class-properties-7.12.13.tgz#b5c987274c4a3a82b89714796931a6b53544ae10"
  integrity sha512-fm4idjKla0YahUNgFNLCB0qySdsoPiZP3iQE3rky0mBUtMZ23yDJ9SJdg6dXTSDnulOVqiF3Hgr9nbXvXTQZYA==
  dependencies:
    "@babel/helper-plugin-utils" "^7.12.13"

"@babel/plugin-syntax-class-static-block@^7.14.5":
  version "7.14.5"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-class-static-block/-/plugin-syntax-class-static-block-7.14.5.tgz#195df89b146b4b78b3bf897fd7a257c84659d406"
  integrity sha512-b+YyPmr6ldyNnM6sqYeMWE+bgJcJpO6yS4QD7ymxgH34GBPNDM/THBh8iunyvKIZztiwLH4CJZ0RxTk9emgpjw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.14.5"

"@babel/plugin-syntax-import-attributes@^7.24.7":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-import-attributes/-/plugin-syntax-import-attributes-7.27.1.tgz#34c017d54496f9b11b61474e7ea3dfd5563ffe07"
  integrity sha512-oFT0FrKHgF53f4vOsZGi2Hh3I35PfSmVs4IBFLFj4dnafP+hIWDLg3VyKmUHfLoLHlyxY4C7DGtmHuJgn+IGww==
  dependencies:
    "@babel/helper-plugin-utils" "^7.27.1"

"@babel/plugin-syntax-import-meta@^7.10.4":
  version "7.10.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-import-meta/-/plugin-syntax-import-meta-7.10.4.tgz#ee601348c370fa334d2207be158777496521fd51"
  integrity sha512-Yqfm+XDx0+Prh3VSeEQCPU81yC+JWZ2pDPFSS4ZdpfZhp4MkFMaDC1UqseovEKwSUpnIL7+vK+Clp7bfh0iD7g==
  dependencies:
    "@babel/helper-plugin-utils" "^7.10.4"

"@babel/plugin-syntax-json-strings@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-json-strings/-/plugin-syntax-json-strings-7.8.3.tgz#01ca21b668cd8218c9e640cb6dd88c5412b2c96a"
  integrity sha512-lY6kdGpWHvjoe2vk4WrAapEuBR69EMxZl+RoGRhrFGNYVK8mOPAW8VfbT/ZgrFbXlDNiiaxQnAtgVCZ6jv30EA==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-jsx@^7.7.2":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-jsx/-/plugin-syntax-jsx-7.27.1.tgz#2f9beb5eff30fa507c5532d107daac7b888fa34c"
  integrity sha512-y8YTNIeKoyhGd9O0Jiyzyyqk8gdjnumGTQPsz0xOZOQ2RmkVJeZ1vmmfIvFEKqucBG6axJGBZDE/7iI5suUI/w==
  dependencies:
    "@babel/helper-plugin-utils" "^7.27.1"

"@babel/plugin-syntax-logical-assignment-operators@^7.10.4":
  version "7.10.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-logical-assignment-operators/-/plugin-syntax-logical-assignment-operators-7.10.4.tgz#ca91ef46303530448b906652bac2e9fe9941f699"
  integrity sha512-d8waShlpFDinQ5MtvGU9xDAOzKH47+FFoney2baFIoMr952hKOLp1HR7VszoZvOsV/4+RRszNY7D17ba0te0ig==
  dependencies:
    "@babel/helper-plugin-utils" "^7.10.4"

"@babel/plugin-syntax-nullish-coalescing-operator@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-nullish-coalescing-operator/-/plugin-syntax-nullish-coalescing-operator-7.8.3.tgz#167ed70368886081f74b5c36c65a88c03b66d1a9"
  integrity sha512-aSff4zPII1u2QD7y+F8oDsz19ew4IGEJg9SVW+bqwpwtfFleiQDMdzA/R+UlWDzfnHFCxxleFT0PMIrR36XLNQ==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-numeric-separator@^7.10.4":
  version "7.10.4"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-numeric-separator/-/plugin-syntax-numeric-separator-7.10.4.tgz#b9b070b3e33570cd9fd07ba7fa91c0dd37b9af97"
  integrity sha512-9H6YdfkcK/uOnY/K7/aA2xpzaAgkQn37yzWUMRK7OaPOqOpGS1+n0H5hxT9AUw9EsSjPW8SVyMJwYRtWs3X3ug==
  dependencies:
    "@babel/helper-plugin-utils" "^7.10.4"

"@babel/plugin-syntax-object-rest-spread@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-object-rest-spread/-/plugin-syntax-object-rest-spread-7.8.3.tgz#60e225edcbd98a640332a2e72dd3e66f1af55871"
  integrity sha512-XoqMijGZb9y3y2XskN+P1wUGiVwWZ5JmoDRwx5+3GmEplNyVM2s2Dg8ILFQm8rWM48orGy5YpI5Bl8U1y7ydlA==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-optional-catch-binding@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-optional-catch-binding/-/plugin-syntax-optional-catch-binding-7.8.3.tgz#6111a265bcfb020eb9efd0fdfd7d26402b9ed6c1"
  integrity sha512-6VPD0Pc1lpTqw0aKoeRTMiB+kWhAoT24PA+ksWSBrFtl5SIRVpZlwN3NNPQjehA2E/91FV3RjLWoVTglWcSV3Q==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-optional-chaining@^7.8.3":
  version "7.8.3"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-optional-chaining/-/plugin-syntax-optional-chaining-7.8.3.tgz#4f69c2ab95167e0180cd5336613f8c5788f7d48a"
  integrity sha512-KoK9ErH1MBlCPxV0VANkXW2/dw4vlbGDrFgz8bmUsBGYkFRcbRwMh6cIJubdPrkxRwuGdtCk0v/wPTKbQgBjkg==
  dependencies:
    "@babel/helper-plugin-utils" "^7.8.0"

"@babel/plugin-syntax-private-property-in-object@^7.14.5":
  version "7.14.5"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-private-property-in-object/-/plugin-syntax-private-property-in-object-7.14.5.tgz#0dc6671ec0ea22b6e94a1114f857970cd39de1ad"
  integrity sha512-0wVnp9dxJ72ZUJDV27ZfbSj6iHLoytYZmh3rFcxNnvsJF3ktkzLDZPy/mA17HGsaQT3/DQsWYX1f1QGWkCoVUg==
  dependencies:
    "@babel/helper-plugin-utils" "^7.14.5"

"@babel/plugin-syntax-top-level-await@^7.14.5":
  version "7.14.5"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-top-level-await/-/plugin-syntax-top-level-await-7.14.5.tgz#c1cfdadc35a646240001f06138247b741c34d94c"
  integrity sha512-hx++upLv5U1rgYfwe1xBQUhRmU41NEvpUvrp8jkrSCdvGSnM5/qdRMtylJ6PG5OFkBaHkbTAKTnd3/YyESRHFw==
  dependencies:
    "@babel/helper-plugin-utils" "^7.14.5"

"@babel/plugin-syntax-typescript@^7.7.2":
  version "7.27.1"
  resolved "https://registry.yarnpkg.com/@babel/plugin-syntax-typescript/-/plugin-syntax-typescript-7.27.1.tgz#5147d29066a793450f220c63fa3a9431b7e6dd18"
  integrity sha512-xfYCBMxveHrRMnAWl1ZlPXOZjzkN82THFvLhQhFXFt81Z5HnN+EtUkZhv/zcKpmT3fzmWZB0ywiBrbC3vogbwQ==
  dependencies:
    "@babel/helper-plugin-utils" "^7.27.1"

"@babel/runtime@7.23.4":
  version "7.23.4"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.23.4.tgz#36fa1d2b36db873d25ec631dcc4923fdc1cf2e2e"
  integrity sha512-2Yv65nlWnWlSpe3fXEyX5i7fx5kIKo4Qbcj+hMO0odwaneFjfXw5fdum+4yL20O0QiaHpia0cYQ9xpNMqrBwHg==
  dependencies:
    regenerator-runtime "^0.14.0"

"@babel/runtime@7.26.0":
  version "7.26.0"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.26.0.tgz#8600c2f595f277c60815256418b85356a65173c1"
  integrity sha512-FDSOghenHTiToteC/QRlv2q3DhPZ/oOXTBoirfWNx1Cx3TMVcGWQtMMmQcSvb/JjpNeGzx8Pq/b4fKEJuWm1sw==
  dependencies:
    regenerator-runtime "^0.14.0"

"@babel/runtime@7.9.6":
  version "7.9.6"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.9.6.tgz#a9102eb5cadedf3f31d08a9ecf294af7827ea29f"
  integrity sha512-64AF1xY3OAkFHqOb9s4jpgk1Mm5vDZ4L3acHvAml+53nO1XbXLuDodsVpO4OIUsmemlUHMxNdYMNJmsvOwLrvQ==
  dependencies:
    regenerator-runtime "^0.13.4"

"@babel/runtime@^7.12.5", "@babel/runtime@^7.18.3":
  version "7.27.6"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.27.6.tgz#ec4070a04d76bae8ddbb10770ba55714a417b7c6"
  integrity sha512-vbavdySgbTTrmFE+EsiqUTzlOr5bzlnJtUv9PynGCAKvfQqjIXbvFdumPM/GxMDfyuGMJaJAU6TO4zc1Jf1i8Q==

"@babel/runtime@^7.26.7":
  version "7.28.2"
  resolved "https://registry.yarnpkg.com/@babel/runtime/-/runtime-7.28.2.tgz#2ae5a9d51cc583bd1f5673b3bb70d6d819682473"
  integrity sha512-KHp2IflsnGywDjBWDkR9iEqiWSpc8GIi0lgTT3mOElT0PP1tG26P4tmFI2YvAdzgq9RGyoHZQEIEdZy6Ec5xCA==

"@babel/template@^7.27.2", "@babel/template@^7.3.3":
  version "7.27.2"
  resolved "https://registry.yarnpkg.com/@babel/template/-/template-7.27.2.tgz#fa78ceed3c4e7b63ebf6cb39e5852fca45f6809d"
  integrity sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==
  dependencies:
    "@babel/code-frame" "^7.27.1"
    "@babel/parser" "^7.27.2"
    "@babel/types" "^7.27.1"

"@babel/traverse@^7.27.1", "@babel/traverse@^7.27.3", "@babel/traverse@^7.27.4":
  version "7.27.4"
  resolved "https://registry.yarnpkg.com/@babel/traverse/-/traverse-7.27.4.tgz#b0045ac7023c8472c3d35effd7cc9ebd638da6ea"
  integrity sha512-oNcu2QbHqts9BtOWJosOVJapWjBDSxGCpFvikNR5TGDYDQf3JwpIoMzIKrvfoti93cLfPJEG4tH9SPVeyCGgdA==
  dependencies:
    "@babel/code-frame" "^7.27.1"
    "@babel/generator" "^7.27.3"
    "@babel/parser" "^7.27.4"
    "@babel/template" "^7.27.2"
    "@babel/types" "^7.27.3"
    debug "^4.3.1"
    globals "^11.1.0"

"@babel/types@^7.0.0", "@babel/types@^7.20.7", "@babel/types@^7.27.1", "@babel/types@^7.27.3", "@babel/types@^7.27.6", "@babel/types@^7.3.3":
  version "7.27.6"
```

### /Users/sand/GitHub/mono/ws/jest.config.cjs
```cjs
/** @type {import('ts-jest').JestConfigWithTsJest} */
module.exports = {
    preset: 'ts-jest',
    testEnvironment: 'jsdom',
    transform: {
        '^.+\\.ts$': ['ts-jest', {
            tsconfig: {
                module: 'CommonJS'
            }
        }],
        '^.+\\.svelte$': ['svelte-jester']
    },
    moduleFileExtensions: ['js', 'ts', 'svelte'],
    testMatch: [
        "**/tests/**/*Test.ts",
        "**/tests/**/*.test.ts"
    ],
    transformIgnorePatterns: [
        "node_modules/(?!(svelte)/)"
    ],
    resolver: undefined
};
```

### /Users/sand/GitHub/mono/ws/public/settings.svg
```svg
<svg id="e235W7as0YL1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 200 200" shape-rendering="geometricPrecision" text-rendering="geometricPrecision">
  <g transform="translate(-17)">
    <g transform="translate(-17.5 118.75)">
      <ellipse rx="15" ry="15" transform="translate(202.5 48.25)" fill="#555" stroke-width="0"/>
      <rect width="150" height="30" rx="0" ry="0" transform="translate(52.5 33.25)" fill="#555" stroke-width="0"/>
      <ellipse rx="15" ry="15" transform="translate(52.5 48.25)" fill="#555" stroke-width="0"/>
    </g>
    <g transform="translate(-17.5 58.75)">
      <ellipse rx="15" ry="15" transform="translate(202.5 48.25)" fill="#555" stroke-width="0"/>
      <rect width="150" height="30" rx="0" ry="0" transform="translate(52.5 33.25)" fill="#555" stroke-width="0"/>
      <ellipse rx="15" ry="15" transform="translate(52.5 48.25)" fill="#555" stroke-width="0"/>
    </g>
    <g transform="translate(-16.25)">
      <ellipse rx="15" ry="15" transform="translate(202.5 48.25)" fill="#555" stroke-width="0"/>
      <rect width="150" height="30" rx="0" ry="0" transform="translate(52.5 33.25)" fill="#555" stroke-width="0"/>
      <ellipse rx="15" ry="15" transform="translate(52.5 48.25)" fill="#555" stroke-width="0"/>
    </g>
  </g>
</svg>
```

### /Users/sand/GitHub/mono/ws/public/vite.svg
```svg
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>```

### /Users/sand/GitHub/mono/ws/public/goo.html
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Test forsooth</title>
</head>
<body>
    <div id="app"></div>
    <script type="module">
        import App from '../goo.svelte';
        new App({
            target: document.getElementById('app')
        });
    </script>
</body>
</html> ```

### /Users/sand/GitHub/mono/ws/notes/.DS_Store
```DS_Store
   Bud1            �                                                          dsclbool                                              w o r kdsclbool    w o r kvSrnlong                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E   �                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       DSDB                                 `      �                                               @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ```

### /Users/sand/GitHub/mono/ws/notes/project.md
```md
# Webseriously Project


**Webseriously** is a sophisticated Svelte-based visualization and data management application with hierarchical graph displays, interactive UI components, and multi-database support. Can be embedded as a Bubble.io plugin or run standalone.

Deeper Dives, beyond the scope of this file, [can be found here](./index.md).
## Table of Contents
- [Project Overview](#project-overview)
  - [Naming Conventions](#naming-conventions)
  - [Directory Structure](#directory-structure)
  - [Core Concepts](#core-concepts)
  - [Key Features](#key-features)
  - [Architecture & Patterns](#architecture--patterns)
- [Development](#development)
  - [Setup](#setup)
  - [Code Style](#code-style)
  - [Important Files](#important-files)
  - [Debugging](#debugging)
  - [Gotchas](#gotchas)
- [Notes](#notes)
  - [DO / DON'T](#do--dont)
  - [Additional Resources](#additional-resources)

This document provides comprehensive guidance for anyone working on the Webseriously project.

## Project Overview

- **Package**: `webseriously`
- **Repository**: `gizmolab10/seriously-svelte`
- **Framework**: Svelte 4 + SvelteKit 2.8.3 + Vite
- **Language**: TypeScript (strict mode)
- **Node**: ^20.19.0
- **Deployment**: Netlify (https://webseriously.netlify.app)

**Tech Stack**: Svelte 4, TypeScript, Tailwind CSS + SCSS, Skeleton Labs, D3.js v7, Two.js, InteractJS, Vitest + Jest

**Databases**: Firebase, Airtable, Bubble, Local (IndexedDB/Dexie), Neo4j, PostgreSQL, RxDB, Test (in-memory). Switch via `?db=local|firebase|airtable|bubble`

### Naming Conventions

**Critical - Follow strictly:**

| Prefix | Purpose | Example |
|--------|---------|---------|
| `T_` | Types/Enums | `T_Trait`, `T_Startup` |
| `w_` | Svelte Stores | `w_hierarchy`, `w_ancestry_focus` |
| `S_` | State Classes | `S_Widget`, `S_Element` |
| `G_` | Geometry | `G_Point`, `G_Cluster` |
| `k` | Constants instance | `k.empty`, `k.hashLength` |
| `h` | Hierarchy manager | `h.thing_forHID()` |
| `g` | Geometry manager | `g.layout()` |
| `p` | Preferences manager | `p.get()` |
| `x` | UX manager | `x.w_ancestry_focus` |
| `core` | Core manager | `core.w_hierarchy` |

**Variables**: `is_`, `has_`, `should_` (booleans), `_id`/`ID` (identifiers), `count_` (counters)

### Directory Structure

```
src/lib/
├── js/              # JavaScript utilities
├── svelte/          # UI Components (~77 files)
│   ├── controls/    # Primary/secondary controls, breadcrumbs
│   ├── details/     # Detail panels (actions, data, preferences, tags, traits)
│   ├── draw/        # SVG primitives (circles, boxes, gradients, portals)
│   ├── experimental/# WIP components
│   ├── main/        # SeriouslyApp, Panel, Graph, Import
│   ├── mouse/       # Mouse interaction (buttons, sliders, rubberband)
│   ├── radial/      # Radial graph components
│   ├── search/      # Search interface
│   ├── text/        # Text rendering (curved, angled, tables)
│   ├── tree/        # Tree graph components
│   └── widget/      # Widget system (drag, reveal, title)
└── ts/              # TypeScript core (~89 files)
    ├── common/      # Constants, enumerations, extensions
    ├── database/    # DB abstraction (7 databases)
    ├── debug/       # Debug utilities, error tracing
    ├── files/       # File operations, pivot tables
    ├── geometry/    # Layout algorithms (tree, radial, paging)
    ├── managers/    # Singleton managers (16 managers)
    ├── persistable/ # Data models (Thing, Trait, Tag, etc.)
    ├── runtime/     # Runtime objects (Ancestry, Identifiable)
    ├── signals/     # Event system, mouse timers
    ├── state/       # State classes (13 S_ classes)
    ├── tests/       # Vitest test suite
    ├── types/       # Type definitions
    └── utilities/   # Colors, print, SVG paths, general utils

bubble/              # Bubble.io plugin (JavaScript)
notes/designs/       # Design documentation
```

### Core Concepts

**Data Model**: Things (hierarchical nodes), Tags (categorization), Traits (key-value properties), Ancestries (parent-child paths), Relationships (typed links)

**Hierarchy System**:
```typescript
import { h } from '$lib/ts/common/Global_Imports';
const thing = h.thing_forHID('someHashID');
const ancestry = h.ancestry_forThing(thing);
```

**Graph Modes**: Tree (horizontal layout) or Radial (circular with rings)

**Bubble Integration**: Iframe embedding, postMessage communication, state publishing

### Key Features

**Visualization**: Radial graphs (resize, paging, rotate), tree graphs, cluster pagination, drag & drop, rubberband selection

**Data**: Full CRUD, relationship management, advanced search, bulk operations, per-item preferences

**UI/UX**: Details panel tabs, multiple themes, responsive, keyboard nav, mouse detection (autorepeat, double-click, long-click)

**Import/Export**: JSON, CSV, PDF export (HTML2Canvas + jsPDF)

### Architecture & Patterns

#### 1. State Management

State objects (S_* classes) persist across component recreation and provide computed properties via getters. Svelte stores (w_* writables) provide reactivity. Stores organized by manager domain.

See [architecture/core/state.md](./guides/architecture/core/state.md) for state objects, stores inventory, and why we use this hybrid approach.

#### 2. Manager Pattern

16 singleton managers coordinate different aspects: Components, Configuration, Controls, Core (system state), Details, Elements, Features, Geometry (layout), Hierarchy (data), Hits (click/hover), Preferences, Radial, Search, Styles, UX (focus/grabs), Visibility.

See [architecture/core/managers.md](./guides/architecture/core/managers.md) for complete responsibilities, access patterns, and examples.

#### 3. Persistable Pattern

8 data models extend `Persistable`: Access, Persistable (base), Predicate, Relationship, Tag, Thing, Trait, User. Each has hash-based ID, database-agnostic CRUD, and serialization.

See [architecture/internals/persistable.md](./guides/architecture/internals/persistable.md) for identity, serialization, and lifecycle.

#### 4. Database Abstraction

Supports 5 database backends: Local (IndexedDB), Firebase, Airtable, Bubble plugin, and Test (in-memory).

See [architecture/core/databases.md](./guides/architecture/core/databases.md) for architecture, switching, and implementation.

#### 5. Component Architecture

11 component directories: controls/, details/, draw/ (SVG primitives), experimental/, main/ (app core), mouse/ (interactive), radial/, search/, text/, tree/, widget/. Components manager tracks S_Component state for complex interactive components.

See [architecture/core/components.md](./guides/architecture/core/components.md) for organization, patterns, state management, and Components manager.

#### 6. Hit Testing & Hover

Centralized hit testing with RBush spatial indexing. Priority: dots > widgets > rings > controls > rubberband.

See [architecture/core/hits.md](./guides/architecture/core/hits.md) for complete click system (autorepeat, long-click, double-click), migration guide, testing.

#### 7. Geometry Layout

Coordinates layout algorithms for tree and radial graph modes.

See [architecture/core/geometry.md](./guides/architecture/core/geometry.md) for responsibilities, layout invocation, and coordination patterns.

## Development

### Setup

```bash
npm install          # Install dependencies
npm run dev          # Development server (localhost:5173)
npm run build        # Production build
npm run preview      # Preview production
npm run test         # Run tests
npm run test:ui      # UI tests
```

Tests in `src/lib/ts/tests/`, naming: `*.test.ts` or `*Test.ts`

#### URL Parameters

- `?db=local|firebase|airtable|bubble` - Database backend
- `?debug=bubble` - Enable Bubble debugging
- `?disable=auto_save,standalone_UI,details` - Disable features
- `?erase=settings` - Clear settings

#### Configuration Files

- `vite.config.js` - Dual build (plugin vs app)
- `svelte.config.js` - Preprocessing
- `tsconfig.json` - TypeScript strict mode
- `tailwind.config.ts` - Dark mode + Skeleton
- `netlify.toml` - Deployment
- `.prettierrc` - Formatting
- `typedoc.json` - API docs

#### Build & Deployment

**Vite builds**:
1. Default: Svelte app → `dist/` (sourcemaps enabled, minification disabled)
2. Plugin (`BUILD_TARGET=plugin`): Bubble.io → `dist/plugin/bubble-plugin.js` (ES module)

**Netlify**: Auto-deploys from main, Airtable headers configured, `netlify.toml`

#### Git Workflow

- Clear commit messages
- No force pushes to main
- Test before pushing
- Currently in a local github repo

### Code Style

**CRITICAL** - Follow these conventions:
- Length-based ordering (imports, props, CSS, case statements)
- Tab-based alignment
- Svelte formatting
- All codebase conventions

TypeScript strict mode, Prettier formatting, `Global_Imports` for imports, descriptive function names.

#### Common Patterns

```typescript
// Imports
import { k, h, core, x, g, databases, T_Trait } from '../common/Global_Imports';

// Store subscription
$: hierarchy = $core.w_hierarchy;

// Persistable
class MyThing extends Persistable {
  async persistent_create_orUpdate(already_persisted: boolean) { }
  get fields(): Airtable.FieldSet { }
}
```

### Important Files

- `Core.ts` - System state (w_t_startup, w_hierarchy)
- `Hierarchy.ts` - Data hierarchy management
- `Geometry.ts` - Layout coordination
- `Hits.ts` - Hit testing/hover
- `UX.ts` - User interaction state
- `Constants.ts` - Application constants

### Debugging

**Two Principles**:
1. **Verify source first** - Check imports/destructuring before assuming usage issues
2. **Be systematic** - Form multiple hypotheses, test complete pipeline

**Enable logging**: Check `enable_logging` flags, Bubble plugin properties, `[PLUGIN]` console messages

**Common Issues**:
- State not updating → check `.set()` or `.update()`
- Database not persisting → verify `?db=` parameter
- Build errors → TypeScript strict mode compliance
- Geometry rendering → check SVG attributes/CSS before math

### Gotchas

- `/bubble/` is js (not ts), maintain Bubble compatibility
- Geometry: precise coordinates, don't round prematurely
- SVG-based rendering: understand viewBox and transforms
- State updates: assure appropriate Svelte reactivity
- Database ops: async, handle promises
- Hit testing: spatial indexing, register targets properly
- Widget layout differences: tree vs radial modes
- Focus widget (radial): no reveal dot
- Race conditions

## Notes

### DO / DON'T

✅ **DO**:
- Follow naming conventions (T_, w_, S_, G_)
- Use `Global_Imports`
- Write tests
- TypeScript strict mode
- Respect Persistable pattern
- Update stores when changing data
- Test multiple databases
- Read before modifying
- Understand geometry (Point, Size, Rect)

❌ **DON'T**:
- Modify naming prefixes
- Break singleton pattern
- Skip TypeScript types
- Modify `bubble/` without testing in Bubble.io
- Commit to main untested
- Change schemas without migration
- Add dependencies without review
- Disable strict checks
- Round geometry prematurely
- Use `any` types

### Additional Resources

**External**:
- Svelte: https://svelte.dev/docs
- TypeScript: https://www.typescriptlang.org/docs
- Vite: https://vitejs.dev/guide
- Bubble Plugin API: https://manual.bubble.io/core-resources/bubble-made-plugins
- RBush: https://github.com/mourner/rbush

**Internal Documentation**:

**Index**: [index.md](./index.md) - Complete index of all design documentation

**Architecture** (architecture/):
- [buttons.md](./guides/architecture/ux/buttons.md) - Button hierarchy, SVG icons
- [components.md](./guides/architecture/core/components.md) - Component architecture: organization and Components manager
- [controls.md](./guides/architecture/ux/controls.md) - Control components
- [database.md](./guides/architecture/core/databases.md) - Database abstraction layer
- [details.md](./guides/architecture/ux/details.md) - Details panel architecture
- [geometry.md](./guides/architecture/core/geometry.md) - Layout coordination and positioning
- [hits.md](./guides/architecture/core/hits.md) - Click/hover system, migration guide
- [managers.md](./guides/architecture/core/managers.md) - Singleton manager pattern and responsibilities
- [paging.md](./guides/architecture/ux/paging.md) - Radial paging system
- [persistable.md](./guides/architecture/internals/persistable.md) - Persistable data models and serialization
- [preferences.md](./guides/architecture/ux/preferences.md) - Settings management
- [search.md](./guides/architecture/ux/search.md) - Search functionality
- [state.md](./guides/architecture/core/state.md) - State objects and stores architecture
- [styles.md](./guides/architecture/internals/styles.md) - Styling system
- [ux.md](./guides/architecture/core/ux.md) - UX manager (focus, grabs, details)

---

**Last Updated**: 2025-12-30
```

### /Users/sand/GitHub/mono/ws/notes/index.md
```md
# Notes

Gathered here are what I hope will bring you up to speed, or once at speed, provide comprehensive reference material.

## Contents

- [Guides](./guides/)
- [Work](./work/)
- [Project](./project.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/collaborate/gotchas.md
```md
# Lessons about svelte

One day, I edited some code and later, i ran the app. Ack, i get this cryptic error.

           `if_block.p is not a function`

 I asked AI to investigate, resolve and then summarize.

# Nested `{#if}` Race Conditions

**A store in an `{#if}` clause can create race conditions inside the clause.** When reactive stores change rapidly, nested `{#if}` blocks can be in transitional states (being created/destroyed) while the parent block tries to update them, causing this error:
## Table of Contents
- [Problem: Nested Blocks](#problem-nested-blocks)
- [Solution: Flatten Nested Blocks](#solution-flatten-nested-blocks)
- [Safe Patterns](#safe-patterns)
- [Best Practices](#best-practices)
- [Reference](#reference)
- [Subscription Loops](#subscription-loops)

## Problem: Nested Blocks

Store `$A` is in the outer block, and condition `B` is in the inner block. When `$A` changes rapidly, the inner block can be in a transitional state (being created/destroyed) while the parent block tries to update it. The error really means "if_block is undefined."

**Before (problematic):**
```svelte
{#if !$A}
    {#if B && ancestry.points_right}
        <div class='numerical-count'>...</div>
    {/if}
{:else if !!svgPathFor_tiny_outer_dots}
    <svg>...</svg>
{/if}
```

## Solution: Flatten Nested Blocks

Flattening eliminates parent-child update coordination, allowing Svelte to update one block directly.

**After (fixed):**
```svelte
{#if !$A && B && ancestry.points_right}
    <div class='numerical-count'>...</div>
{:else if $A && !!svgPathFor_tiny_outer_dots}
    <svg>...</svg>
{/if}
```

## Safe Patterns

```svelte
<!-- Single level -->
{#if condition1 && condition2}
    ...
{/if}

<!-- Computed variable -->
<script>
    $: showContent = condition1 && condition2;
</script>
{#if showContent}
    ...
{/if}
```

## Best Practices

1. Flatten nested `{#if}` blocks when stores are involved
2. Use computed variables for complex conditions
3. Test mode switches and rapid state transitions

## Reference

`src/lib/svelte/widget/Widget_Reveal.svelte` (lines 166-198) - triggered when switching to radial mode

# Subscription Loops

**A store subscription that calls a function which sets the same (or related) store causes an infinite loop.**

## Table of Contents
- [Problem: Indirect Reactivity](#problem-indirect-reactivity)
- [Solution: Direct Causation](#solution-direct-causation)
- [Variations](#variations)
- [Best Practices](#best-practices)

## Problem: Indirect Reactivity

Subscription to store A calls function X. Function X sets store A (or store B, which has a subscription that sets A). → Infinite loop.

**Before (problematic):**
```typescript
// In setup():
this.w_s_search.subscribe((state) => {
    if (state !== T_Search.off) {
        this.search_for(text);  // search_for sets w_s_search!
    }
});

// In activate():
this.w_s_search.set(T_Search.enter);  // Triggers subscription → loop
```

The intent was "when search activates, run the search." But the implementation creates a cycle.

## Solution: Direct Causation

When an action needs to trigger behavior, call it directly.

**After (fixed):**
```typescript
// In activate():
show.w_show_search_controls.set(true);
this.search_for(this.search_text);  // Direct call
```

No subscription needed. `activate()` does what it needs to do.

## Variations

### Mutual Recursion

```typescript
search_for(query: string) {
    if (query.length === 0) {
        this.activate();  // activate() calls search_for()!
    }
}

activate() {
    this.search_for(this.search_text);
}
```

**Fix:** Replace `this.activate()` with the specific state change needed.

### Indirect via Related Store

```typescript
// Store A subscription
w_show_search_controls.subscribe(() => {
    g.layout();  // layout() eventually sets w_show_details
});

// Store B subscription  
w_show_details.subscribe(() => {
    // ... which eventually sets w_show_search_controls
});
```

**Fix:** Remove unnecessary subscriptions. Not every store change needs a reactive cascade.

## Best Practices

1. **Subscriptions are for reacting to external changes**, not for triggering side effects from your own actions
2. **If you set a store and want something to happen**, call it directly in the same function
3. **Audit subscription chains** — trace what each subscription calls and what stores those functions set
4. **Transient UI state** (like search visibility) often doesn't need subscriptions at all — just set it directly in activate/deactivate

```

### /Users/sand/GitHub/mono/ws/notes/guides/collaborate/composition.md
```md
# Component Composition in Svelte

Props-down, events-up. Slots for flexible content. Compound components for complex UIs. i wanted to document the pattern and see where we could use it better.

## Table of Contents
- [Svelte Composition Patterns](#svelte-composition-patterns)
  - [Key Principles](#key-principles)
  - [Props Best Practices](#props-best-practices)
  - [Composition Strategies](#composition-strategies)
- [Component Audit Checklist](#component-audit-checklist)
- [Summary](#summary)
- [Downside](#downside)
- [Svelte 4](#svelte-4)

## Svelte Composition Patterns

### Key Principles

Based on Svelte best practices:

1. **Props down, events up**: Parent components pass data via props, children emit events to communicate back
2. **Component composition over prop soup**: Break complex components into smaller composable pieces instead of adding endless props
3. **Slots for flexibility**: Use slots when you need the consumer to control markup/layout
4. **$state() for internal, $props() for external** **(Svelte 5 only)**: Component owns its own state, receives props from parent
5. **Default values in destructuring** **(Svelte 5 only)**: `let { name = "default" } = $props()` provides fallbacks

### Props Best Practices

**Use $props() rune** **(Svelte 5 only)**:
```typescript
let { title, count = 0, onClick } = $props();
```

**Type your props:**
```typescript
let { title, count = 0 }: { title: string; count?: number } = $props();
```

**Avoid prop mutation** unless using `$bindable()` **(Svelte 5 only)**:
```typescript
let { value = $bindable(0) } = $props();  // Two-way binding
```

### Composition Strategies

**Bad - Prop soup:**
```svelte
<Card 
  title="..."
  subtitle="..."
  body="..."
  imageUrl="..."
  badgeText="..."
  buttonLabel="..."
  onButtonClick={...} />
```

**Good - Compound components:**
```svelte
<Card>
  <CardHeader title="..." subtitle="..." />
  <CardImage src="..." />
  <CardBody>{content}</CardBody>
  <CardFooter>
    <Button>Click me</Button>
  </CardFooter>
</Card>
```

**When to refactor**: If a component has 3-4+ props for layout/content, consider breaking into compound components.

### Downside

The design of components sometimes combines concerns. This reduces the number of components, which is important, even at the cost of prop soup and difficulty in testing.

**Why fewer components matters:**

Every component adds overhead - file to navigate, imports to manage, mental model to maintain. Sometimes a fat component with 7-8 props is better than splitting into 4 smaller components.

**Trade-offs i'm willing to make:**
- Prop soup is fine if the component stays under ~200 lines
- Mixed concerns are fine if they're tightly related (e.g., banner + content in Banner_Hideable)
- Harder testing is fine if the component is stable and rarely changes

**When NOT to split:**
- Component is used in exactly one place
- The "sub-components" would never be used independently
- Splitting would create more boilerplate than it removes
- The concerns are tightly coupled (changing one always requires changing the other)

**Example: Banner_Hideable**

We could split into:
- `<Banner />` - just the header
- `<HideableContent />` - just the show/hide logic
- `<BannerWithContent />` - composes the two

But why? The banner and content are always used together. The show/hide logic is specific to this pattern. We'd create 3 files instead of 1, and none of them would be reusable elsewhere.

Better to keep it as one component with a slot for customization.

**Composition is a tool, not a religion.**

Use it when it clarifies. Skip it when it adds complexity for no gain.

### Svelte 4

This document references Svelte 5 features that aren't available until we upgrade. Here's what we CAN'T use in Svelte 4:

**Unavailable in Svelte 4:**

1. **`$props()` rune** - Use `export let` instead
   ```svelte
   <!-- Svelte 5 -->
   let { title, count = 0 } = $props();
   
   <!-- Svelte 4 -->
   export let title;
   export let count = 0;
   ```

2. **`$state()` rune** - Use plain `let` instead
   ```svelte
   <!-- Svelte 5 -->
   let count = $state(0);
   
   <!-- Svelte 4 -->
   let count = 0;
   ```

3. **`$derived()` rune** - Use `$:` reactive statements instead
   ```svelte
   <!-- Svelte 5 -->
   let doubled = $derived(count * 2);
   
   <!-- Svelte 4 -->
   $: doubled = count * 2;
   ```

4. **`$bindable()` rune** - Use regular props with manual updates
   ```svelte
   <!-- Svelte 5 -->
   let { value = $bindable() } = $props();
   
   <!-- Svelte 4 -->
   export let value;
   // Parent uses bind:value as usual
   ```

5. **Lowercase event handlers** - Use `on:` directive instead
   ```svelte
   <!-- Svelte 5 -->
   <button onclick={handleClick}>
   
   <!-- Svelte 4 -->
   <button on:click={handleClick}>
   ```

**What DOES work in Svelte 4:**

- ✅ Props-down, events-up pattern
- ✅ Slots (default and named)
- ✅ Component composition
- ✅ `createEventDispatcher()` for component events
- ✅ Reactive statements with `$:`
- ✅ Stores with `$` prefix

**Bottom line:**

All the composition PATTERNS in this document work in Svelte 4. Just ignore the rune syntax examples. Use `export let` for props, `let` for state, and `$:` for derived values.

The principles (slots, compound components, separation of concerns) are the same. Only the syntax differs.

## Component Audit Checklist

Components that could benefit from better composition:

### High Priority - Prop Soup

- [ ] **Primary_Controls.svelte** - Manages ~10 different controls inline; could break into `<Controls.Details />`, `<Controls.Recents />`, `<Controls.Search />` compound pattern
- [ ] **D_Selection.svelte** - Multiple tables (characteristics, relationships, properties); could use `<SelectionTable.Characteristics />` sub-components
- [ ] **Radial_Cluster.svelte** - Handles widgets, paging UI, rotation, all in one file; break into `<Cluster.Widgets />`, `<Cluster.Pager />`, `<Cluster.RotationHandle />`

### Medium Priority - Mode Switching

- [ ] **Breadcrumbs.svelte** - Mode selection embedded (ancestry vs recents); parent should choose mode and pass data
- [ ] **Search_Results.svelte** - Likely mixes result rendering with search state; extract `<SearchResultItem />` component
- [ ] **Widget.svelte** - Handles title, drag, reveal, all together; could compose `<Widget.Title />`, `<Widget.DragHandle />`, `<Widget.RevealToggle />`

### Low Priority - Already Good Composition

- [ ] **Breadcrumb_Button.svelte** - Good! Single responsibility, clear props, used compositionally by parent
- [ ] **Button.svelte** - Good! Reusable, clear interface, used throughout app
- [ ] **Glow_Button.svelte** - Good! Specialized variant with focused purpose

### Slot Opportunities

- [ ] **Banner_Hideable.svelte** - Wraps content; perfect candidate for `<slot />` to let parent control banner content
- [ ] **Card components** (if any exist) - Classic slot use case for header/body/footer
- [ ] **Modal/Dialog** (if exists) - Header, body, footer slots

### Parent-Child Communication

- [ ] **Next_Previous.svelte** - Review event emission pattern; ensure using Svelte 5 event syntax **(Svelte 5 only)**
- [ ] **Segmented.svelte** - Check if using `$bindable()` **(Svelte 5 only)** for two-way binding where appropriate
- [ ] **Triangle_Button.svelte** - Verify props-down, events-up pattern

## Summary

**Key takeaways:**

1. We're already doing composition fairly well (Breadcrumb_Button, Button usage)
2. Biggest wins: break up large components (Primary_Controls, Radial_Cluster)
3. Use slots more for customization (Banner_Hideable, separator overrides)
4. Move mode/data selection to parents; children should receive data via props
5. Embrace `$derived` **(Svelte 5 only)** for computed values instead of manual update() functions

**Next steps:**

1. Start with Breadcrumbs refactor (good learning exercise, medium complexity)
2. Move to Primary_Controls (most impact)
3. Extract compound components for complex UIs
4. Add slots where consumers need customization
5. Document the pattern for future components

```

### /Users/sand/GitHub/mono/ws/notes/guides/collaborate/index.md
```md
# Collaborate

Hey. For my own sanity and to save immense time composing queries for AI, I asked it to summarize various activities that I want it to perform often enough.

## Contents

- [Composition](./composition.md)
- [Gotchas](./gotchas.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/platforms/bubble.md
```md
# Bubble Integration Architecture

Bubble plugins are beasts. Webseriously runs in an iframe and uses postMessage to synchronize with bubble. Ugly stuff here, but it works.

## Table of Contents

* [Overview](#overview)
* [Architecture](#architecture)
* [Plugin Files](#plugin-files)
* [Initialization Flow](#initialization-flow)
* [PostMessage Protocol](#postmessage-protocol)
  * [From Webseriously → Bubble Plugin](#from-webseriously--bubble-plugin)
  * [From Bubble Plugin → Webseriously](#from-bubble-plugin--webseriously)
* [Plugin Implementation](#plugin-implementation)
  * [Initialize (initialize.js)](#initialize-initializejs)
  * [Message Handler](#message-handler)
  * [Send to Webseriously](#send-to-webseriously)
* [DB_Bubble Implementation](#db_bubble-implementation)
  * [State Publishing](#state-publishing)
  * [Command Handling](#command-handling)
* [Bubble Plugin Properties](#bubble-plugin-properties)
* [Update Flow (update.js)](#update-flow-updatejs)
* [Standalone vs Plugin Mode](#standalone-vs-plugin-mode)
* [Edge Cases](#edge-cases)
* [Related Files](#related-files)

For how-to guides (debugging, adding state, publishing), see [[plugin.md]].

## Overview

Webseriously can be embedded as a Bubble.io plugin, running inside an iframe with bidirectional postMessage communication. The plugin publishes state changes to Bubble and receives commands to change focus, selection, and graph mode.

## Architecture

**Bubble Plugin** (JavaScript in `bubble/` directory)

* Creates and manages iframe
* Handles postMessage communication
* Publishes state to Bubble
* Sends commands to Webseriously

**DB_Bubble** (TypeScript backend)

* Database backend for Bubble mode
* Sends state updates via postMessage
* Receives commands from plugin

## Plugin Files

| File | Purpose |
|----|----|
| `initialize.js` | Create iframe, setup message handlers |
| `update.js` | Handle property updates from Bubble |
| `change_focus.js` | Command to change focus |
| `change_selection.js` | Command to change selection (grabs) |
| `change_graph_mode.js` | Command to switch tree/radial mode |
| `replace_hierarchy.js` | Command to replace entire hierarchy |

## Initialization Flow




1. **Plugin loads** in Bubble page
2. **initialize.js** creates iframe pointing to `https://webseriously.netlify.app/?db=bubble&theme=bubble&debug=bubble`
3. **Iframe loads** Webseriously in Bubble mode
4. **DB_Bubble** detects Bubble mode via `?db=bubble` parameter
5. **Webseriously sends** `{ type: 'listening' }` message when ready
6. **Plugin responds** by sending any pending messages
7. **Bidirectional communication** established

## PostMessage Protocol

### From Webseriously → Bubble Plugin

Published to Bubble as plugin state:

```javascript
// Focus changed
{ type: 'focus_id', id: 'thing123' }
→ instance.publishState('focus_id', 'thing123')

// Details ancestry changed
{ type: 'details_id', id: 'thing456' }
→ instance.publishState('details_id', 'thing456')

// Selection (grabs) changed
{ type: 'selected_ids', ids: ['thing1', 'thing2'] }
→ instance.publishState('selected_ids', ['thing1', 'thing2'])

// Graph mode changed
{ type: 'in_radial_mode', in_radial_mode: true }
→ instance.publishState('in_radial_mode', true)

// Trigger Bubble workflow
{ type: 'trigger_an_event', trigger: 'event_name' }
→ instance.triggerEvent('event_name')

// Ready for communication
{ type: 'listening' }
→ Sets iframeIsListening flag, sends pending messages
```

### From Bubble Plugin → Webseriously

Commands sent via `instance.data.send_to_webseriously(type, object)`:

```javascript
// Change focus
{ type: 'change_focus', id: 'thing123' }

// Change selection
{ type: 'change_selection', ids: ['thing1', 'thing2'] }

// Change graph mode
{ type: 'change_graph_mode', in_radial_mode: true }

// Replace entire hierarchy
{ type: 'replace_hierarchy', hierarchy: {...} }
```

## Plugin Implementation

### Initialize (initialize.js)

```javascript
instance.data.assure_iframe_is_instantiated = function(properties) {
    const iframe = document.createElement('iframe');
    iframe.src = url_from_properties(properties);
    iframe.style.overflow = 'hidden';
    iframe.style.border = 'none';
    iframe.style.height = '100%';
    iframe.style.width = '100%';

    instance.data.iframe = iframe;
    window.addEventListener('message', handle_webseriously_message);
    instance.canvas.append(iframe);
}
```

URL parameters:

* `db=bubble` - Use Bubble database backend
* `theme=bubble` - Use Bubble theme
* `debug=bubble` - Enable Bubble debugging
* `erase=settings` - Clear user settings (optional)

### Message Handler

```javascript
function handle_webseriously_message(event) {
    if (event.data && !event.data.hello) {
        switch (event.data.type) {
            case 'focus_id':
                instance.publishState('focus_id', event.data.id);
                break;
            case 'selected_ids':
                instance.publishState('selected_ids', event.data.ids);
                break;
            case 'in_radial_mode':
                instance.publishState('in_radial_mode', event.data.in_radial_mode);
                break;
            case 'listening':
                instance.data.iframeIsListening = true;
                send_pending_messages();
                break;
        }
    }
}
```

### Send to Webseriously

```javascript
instance.data.send_to_webseriously = function(type, object) {
    const message = { type, ...object };

    if (!instance.data.iframeIsListening) {
        // Queue until iframe is ready
        instance.data.pendingMessages.push(message);
    } else {
        instance.data.iframe.contentWindow.postMessage(message, '*');
    }
}
```

**Pending messages**: Commands sent before `listening` message are queued and sent once iframe is ready.

## DB_Bubble Implementation

### State Publishing

```typescript
prepare_to_signal_bubble_plugin() {
    if (c.w_device_isMobile) { return; }  // Mobile doesn't use plugin

    // Publish focus
    window.parent.postMessage({
        type: 'focus_id',
        id: get(x.w_ancestry_focus)?.thing?.id
    }, '*');

    // Publish selection
    window.parent.postMessage({
        type: 'selected_ids',
        ids: x.si_grabs.items.map(a => a.thing?.id)
    }, '*');

    // Publish graph mode
    window.parent.postMessage({
        type: 'in_radial_mode',
        in_radial_mode: !controls.inTreeMode
    }, '*');
}
```

Called when:

* Focus changes (`x.w_ancestry_focus` subscription)
* Selection changes (`x.si_grabs.w_items` subscription)
* Graph mode changes (`controls` subscription)

### Command Handling

```typescript
setup_remote_handlers() {
    window.addEventListener('message', (event) => {
        if (event.data?.type) {
            switch (event.data.type) {
                case 'change_focus':
                    const thing = h.thing_forID(event.data.id);
                    thing?.ancestry?.becomeFocus();
                    break;

                case 'change_selection':
                    const ancestries = event.data.ids
                        .map(id => h.thing_forID(id)?.ancestry)
                        .filter(a => !!a);
                    x.si_grabs.items = ancestries;
                    break;

                case 'change_graph_mode':
                    controls.set_graphMode(event.data.in_radial_mode);
                    break;

                case 'replace_hierarchy':
                    await this.replace_hierarchy(event.data.hierarchy);
                    break;
            }
        }
    });

    // Signal ready
    window.parent.postMessage({ type: 'listening' }, '*');
}
```

## Bubble Plugin Properties

Configured in Bubble plugin editor:

| Property | Type | Purpose |
|----|----|----|
| `enable_logging` | boolean | Enable console logging |
| `erase_user_settings` | boolean | Clear settings on load |

Exposed state (readable from Bubble workflows):

| State | Type | Description |
|----|----|----|
| `focus_id` | string | Current focus thing ID |
| `details_id` | string | Current details thing ID |
| `selected_ids` | list | Array of selected thing IDs |
| `in_radial_mode` | boolean | True if radial mode, false if tree |

## Update Flow (update.js)

```javascript
function(instance, properties, context) {
    instance.data.assure_iframe_is_instantiated(properties);

    // Send commands based on property changes
    if (properties.change_focus && properties.focus_id) {
        instance.data.send_to_webseriously('change_focus', {
            id: properties.focus_id
        });
    }

    if (properties.change_selection && properties.selected_ids) {
        instance.data.send_to_webseriously('change_selection', {
            ids: properties.selected_ids
        });
    }
}
```

## Standalone vs Plugin Mode

```typescript
get isStandalone(): boolean {
    return this.t_database != T_Database.bubble;
}
```

Used throughout codebase to conditionally enable/disable features:

* Standalone: Full UI with database switcher
* Plugin: Minimal UI, Bubble owns data and controls

## Edge Cases


1. **Pending messages**: Commands sent before iframe ready are queued
2. **Mobile**: Plugin not used on mobile (c.w_device_isMobile check)
3. **Cross-origin**: postMessage uses `'*'` origin (iframe is same-origin)
4. **State sync**: Bubble state may lag during rapid changes
5. **Hierarchy replacement**: Async operation, requires rebuild

## Related Files

**TypeScript (src/lib/ts/)**:

* `database/DB_Bubble.ts` - Backend implementation
* `managers/Configuration.ts` - `w_device_isMobile` check

**JavaScript (bubble/)**:

* `initialize.js` - Plugin initialization
* `update.js` - Property updates
* `change_*.js` - Command implementations


```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/platforms/plugin.md
```md
# Bubble Plugin Guide

How-to's for working with the Bubble plugin. For architecture details, see [bubble.md](./bubble.md).

## Table of Contents
- [Debugging](#debugging)
- [Adding a State](#adding-a-state)
- [Publishing a New Version](#publishing-a-new-version)
- [Best Practices](#best-practices)

## Debugging

Enable logging via `enable_logging: true` plugin property. All messages logged with `[PLUGIN]` prefix:

```javascript
LOG('initializing with url:', url);
LOG('PUBLISH --> focus_id:', event.data.id);
LOG('LISTENING');
```

From Webseriously side, use `?debug=bubble` parameter to enable DB_Bubble logging.

## Adding a State

When i need to expose new state to Bubble, there's a dance between TypeScript and JavaScript. Here's the checklist.

### 1. Add the postMessage (TypeScript)

In `DB_Bubble.ts`, inside `prepare_to_signal_bubble_plugin()`:

```typescript
window.parent.postMessage({
    type: 'my_new_tag',
    value: whatever_value
}, '*');
```

Subscribe to the relevant store so it fires when state changes:

```typescript
my_store.subscribe(() => {
    this.prepare_to_signal_bubble_plugin();
});
```

### 2. Handle the message (JavaScript)

In `bubble/initialize.js`, add a case to `handle_webseriously_message()`:

```javascript
case 'my_new_tag':
    instance.publishState('my_new_tag', event.data.value);
    break;
```

### 3. Register the state in Bubble

In the Bubble plugin editor:

1. Go to "Exposed States"
2. Add `my_new_tag` with the appropriate type (text, number, list, etc.)
3. Save and deploy

### 4. Test the flow

1. Enable `?debug=bubble` in the URL
2. Trigger the state change in Webseriously
3. Check console for the postMessage
4. Verify Bubble's plugin inspector shows the new state

### Gotcha

Bubble's plugin editor is finicky. If you rename or change the type of an exposed state, existing workflows using it may break silently. Better to add a new state than modify an existing one.

## Publishing a New Version

The Catalyst team wants a stable version of webseriously, one that is isolated from ongoing work. To do this, I create a git branch and point netlify at it, then tell bubble.io. Done!

The most self-documenting name for the branch is `plugin-major-minor-incremental` (eg, plugin-0-3-4), and for the numbers to refer to the about-to-be-published version in the bubble plugin editor. In the terminal, go to the project directory, and type something like this:

`git branch plugin-0-3-5`

Then, in netlify, visit the project called `plugin.webseriously.org`. Navigate to:

- Project configuration
- Build and deploy
- Branches and deploy contexts (scroll 1/3 down the page)
- Configure (button)
- Production branch (change the name)

## Best Practices

✅ **DO**:

* Check `iframeIsListening` before sending messages
* Queue messages if iframe not ready
* Use `[PLUGIN]` prefix for logging
* Handle missing IDs gracefully
* Validate message types

❌ **DON'T**:

* Send messages before `listening` received
* Assume synchronous state updates
* Mix TypeScript and JavaScript (bubble/ is JS only)
* Test in Bubble without proper plugin setup
* Skip error handling in message handlers
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/platforms/svelte.md
```md
# Svelte 5 Migration Roadmap

**Started:** 2026-01-05  
**Status:** Planning

---

## Current State Assessment

### Tech Stack
- **Svelte:** 4.x (need upgrade to 5.x)
- **Vite:** 4.3.2 (need upgrade for Svelte 5 compatibility)
- **@sveltejs/vite-plugin-svelte:** 2.0.3 (need upgrade to 4.x or 5.x)
- **TypeScript:** 5.4.5 ✓
- **Vitest:** 4.0.16 ✓

### Architecture Patterns (to migrate)
1. **Stores:** Heavy use of `writable()`, `derived()`, `get()` from `svelte/store`
   - Singleton managers (x, g, h, k, etc.) with store properties
   - Derived stores for computed state
   - Store subscriptions in components

2. **Reactivity:** Svelte 4 patterns throughout
   - `$:` reactive statements
   - `$store` auto-subscriptions
   - `export let` props

3. **Lifecycle:** Standard Svelte 4
   - `onMount`, `onDestroy` 
   - `tick` for DOM updates

4. **Component Structure:**
   - ~60 Svelte components across 12 directories
   - Deep prop drilling through geometry/state objects
   - Signal-based communication between components

---

## Svelte 5 Migration Targets

### New Paradigm: Runes

| Svelte 4 | Svelte 5 |
|----------|----------|
| `let x = 0` (reactive in component) | `let x = $state(0)` |
| `$: doubled = x * 2` | `let doubled = $derived(x * 2)` |
| `$: { console.log(x) }` | `$effect(() => { console.log(x) })` |
| `export let prop` | `let { prop } = $props()` |
| `writable()` stores | `$state()` with classes or `createStore()` |
| `$store` auto-subscribe | Direct access (stores still work) |

### Migration Strategy: Incremental

Svelte 5 has **full backward compatibility** for Svelte 4 syntax. We can migrate incrementally:
1. Upgrade tooling
2. Verify everything still works
3. Migrate one pattern at a time
4. Test rigorously at each step

---

## Phase 0: Foundation (CURRENT)

### 0.1 Tooling Upgrade
- [ ] Upgrade `svelte` to 5.x
- [ ] Upgrade `@sveltejs/vite-plugin-svelte` to 5.x
- [ ] Upgrade `vite` to 5.x or 6.x
- [ ] Upgrade `@sveltejs/kit` if needed
- [ ] Update `vitest` config for Svelte 5
- [ ] Run existing tests → **must pass**

### 0.2 Baseline Verification
- [ ] `yarn dev` works
- [ ] App loads and renders
- [ ] All existing tests pass
- [ ] No console errors

🔖 **CHECKPOINT 0:** App runs unchanged on Svelte 5

---

## Phase 1: Store Migration

### 1.1 Analyze Store Usage
- [ ] Catalog all stores across managers
- [ ] Map store dependencies
- [ ] Identify isolated vs. interconnected stores

### 1.2 Create Svelte 5 Store Pattern
- [ ] Design new state pattern (class with `$state`, or wrapper)
- [ ] Create adapter/migration utilities if needed
- [ ] Test pattern in isolation

### 1.3 Migrate Core Stores (one at a time)
Order by isolation (least dependencies first):
- [ ] `busy` (S_Busy.ts)
- [ ] `show` (Visibility.ts)  
- [ ] `colors` (Colors.ts)
- [ ] `controls` (Controls.ts)
- [ ] `search` (Search.ts)
- [ ] `x` (UX.ts) - complex, do later
- [ ] `g` (Geometry.ts)
- [ ] `e` (Events.ts)

**Test after each migration**

🔖 **CHECKPOINT 1:** All stores migrated, tests pass

---

## Phase 2: Component Props

### 2.1 Convert Props Pattern
- [ ] Create script to identify `export let` usage
- [ ] Start with leaf components (no children)
- [ ] Work up component tree

### 2.2 Component Migration Order
Leaf components first:
- [ ] `draw/*` components (Box, Circle, Spinner, etc.)
- [ ] `text/*` components
- [ ] `mouse/*` components (Button, Slider, etc.)
- [ ] `widget/*` components
- [ ] `details/*` components
- [ ] `controls/*` components
- [ ] `search/*` components
- [ ] `main/*` components (last - these are parents)

🔖 **CHECKPOINT 2:** All components use `$props()`

---

## Phase 3: Reactivity

### 3.1 Convert Reactive Statements
- [ ] `$:` assignments → `$derived`
- [ ] `$:` side effects → `$effect`
- [ ] Complex reactivity chains → review/simplify

### 3.2 Clean Up
- [ ] Remove workarounds for Svelte 4 quirks
- [ ] Simplify reactive chains where possible
- [ ] Review and remove unnecessary tick() calls

🔖 **CHECKPOINT 3:** All reactivity uses runes

---

## Phase 4: New Patterns

### 4.1 Leverage Svelte 5 Features
- [ ] Consider Snippets for repeated markup
- [ ] Evaluate `$effect.tracking()` for debugging
- [ ] Review `$inspect()` for development

### 4.2 Performance Optimization
- [ ] Profile with Svelte 5 DevTools
- [ ] Identify unnecessary re-renders
- [ ] Optimize hot paths

🔖 **CHECKPOINT 4:** Modern Svelte 5 throughout

---

## Testing Strategy

### Per-Migration Tests
1. **Before:** Run full test suite
2. **After:** Run full test suite
3. **Manual:** Verify in browser

### Test Categories
- **Unit:** Store behavior, utility functions
- **Component:** Rendering, props, events
- **Integration:** Store ↔ component interaction
- **E2E:** Full user flows (manual for now)

### Current Test Coverage
```
src/lib/ts/tests/
├── Colors.test.ts
├── Coordinates.test.ts
├── UX_ancestry_next_focusOn.test.ts
├── UX_becomeFocus.test.ts
├── UX_direct_setters.test.ts
├── UX_initialization.test.ts
├── UX_integration.test.ts
├── serializers.test.ts
└── setup.ts
```

### Test Commands
```bash
yarn test        # Run all tests
yarn test:ui     # Visual test runner
yarn test:run    # Single run (CI)
```

---

## Risk Mitigation

### Git Strategy
- Branch per phase: `svelte5/phase-0`, `svelte5/phase-1`, etc.
- Squash merge to main at checkpoints
- Tag releases: `v0.2-svelte5-phase0`, etc.

### Rollback Points
Each checkpoint is a safe rollback point. If phase N breaks things:
1. `git stash` current work
2. `git checkout` previous checkpoint tag
3. Investigate in isolation

### Known Risks
1. **Store subscriptions in derived:** May need refactoring
2. **Signal system:** May conflict with Svelte 5 reactivity
3. **Third-party Svelte components:** Check compatibility
4. **svelte-motion:** May need alternative

---

## Decisions Log

| Date | Decision | Rationale |
|------|----------|-----------|
| 2026-01-05 | Incremental migration | Svelte 5 backward compat allows safe, tested steps |
| | | |

---

## Notes

### Svelte 5 Resources
- [Migration Guide](https://svelte.dev/docs/svelte/v5-migration-guide)
- [Runes Documentation](https://svelte.dev/docs/svelte/runes)
- [What's New](https://svelte.dev/blog/svelte-5-is-alive)

### Dependencies to Check
- `svelte-motion` - Check Svelte 5 support
- `@svelteuidev/*` - Check Svelte 5 support
- `carbon-components-svelte` - Check Svelte 5 support
- `framework7-svelte` - Check Svelte 5 support

---

## Next Action

**Phase 0.1: Tooling Upgrade**

Start with upgrading dependencies and verifying the app still runs.
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/platforms/vitepress.md
```md
# VitePress

i asked the AI to write instructions for installing, configuring and running vitepress in a way that i could understand it and it could read it and do it.

## Quick Start

```bash
yarn docs:dev    # start server on port 5176
yarn docs:build  # build static site
yarn docs:preview # preview built site
```

No NVM needed - yarn handles Node version.

### Tool Scripts

Go to `/notes/tools`:

```bash
./update-docs.sh  # full workflow: build, fix links, sync sidebar
./reset-docs.sh   # rebuild and restart dev server
```

### TypeScript Tools

Go to `/notes/tools`. Source in `lib/`, compiled to `dist/`. Run `npx tsc`, then run the compiled js in `dist` using the `node` command. The first two can be passed a `-v` option for verbose information.

| File | Options | Purpose |
|----|----|----|
| `fix-links` | Fixes broken links by examining build errors | `-v` `--test` |
| `sync-sidebar` | Regenerates sidebar from filesystem | `-v` |
| `generate-sidebar` | Helper: walks srcDir, adds sidebar items |    |
| `markdown-parser` | Extracts and updates links in markdown |    |
| `link-finder` | Searches repo for files by name |    |
| `config-updater` | Updates sidebar links in config.mts |    |
| `merge-files` | Merges markdown by section | `-v` `A B` |

## Setup


1. Add to package.json devDependencies: `"vitepress": "^1.6.4"`
2. Add scripts: `docs:dev`, `docs:build`, `docs:preview`
3. Create `.vitepress/config.mts` - see actual file for config
4. `yarn install`


Configuration file is `.vitepress/config.mts`. Key settings:

* `srcDir: './notes/designs'` - markdown source
* `srcExclude: ['obsolete/**', 'next/**']` - skip these
* `search: { provider: 'local' }` - enables search

## Customizations

### Prev/Next in Navbar

Moved prev/next navigation from bottom of page to top navbar (before the light/dark toggle). Files involved:

* `Layout.vue` - wraps default, injects PrevNext into `nav-bar-content-after` slot
* `PrevNext.vue` - renders ← → arrows using VitePress's `usePrevNext` composable
* `custom.css` - hides original footer pager, reorders navbar elements via flex order

### Sidebar Toggle

VitePress has a `watchPostEffect` that auto-expands sections containing the active page. Can't fight Vue reactivity directly. Solution: CSS layer on top.

**The trick:** `data-user-collapsed` and `data-user-expanded` attributes. CSS uses `!important` to override VitePress styles. JS manages the attributes, localStorage persists state.

When user clicks a heading:

* Expanded → add `data-user-collapsed`, visually collapse
* Collapsed → add `data-user-expanded`, visually expand

VitePress still thinks it controls state. We just override the visuals.

Files:

* `index.ts` - click handler, localStorage read/write, applies state on load/route change
* `custom.css` - `[data-user-collapsed] > .items { display: none !important }` etc.

Also hides the carets entirely since headings now toggle on click.

### Favicon



1. Put icon in `.vitepress/public/favicon.png`
2. Add to config: `head: [['link', { rel: 'icon', type: 'image/png', href: '/favicon.png' }]]`
3. Fix build: `"docs:build": "vitepress build && cp .vitepress/public/favicon.png .vitepress/dist/"`

**Note:** favicon only works in build mode, not dev. VitePress bug.


## Annotations

Two special comments control how `update-docs.sh` handles files:

### `<!-- @manual -->` — Protect index.md from overwriting

Add ***anywhere*** in an index.md file:

```markdown
<!-- @manual -->

### My Custom Index

This content won't be touched by sync-index-files.sh
```

The script will skip the file and (in ***verbose*** mode) enter into the log:

`Skipping index.md in: folder_name (marked @manual)`

### `// @keep` — Preserve sidebar items

Add after any sidebar item in `.vitepress/config.mts`:

```typescript
sidebar: [
  {
    text: 'Project',
    link: '/project'
  }, // @keep
  // ... auto-generated items below
]
```

The sync-sidebar script will:




1. Extract all `@keep` items before regenerating
2. Place them at the top of the sidebar
3. Add auto-generated items below
4. Report: `Preserved: N @keep item(s)`

Use this for links to files outside `srcDir` or custom entries that don't map to the filesystem.

## Gotchas

### Anchors Starting with Numbers

VitePress prepends an underscore to anchor IDs that start with a number. So:

| Heading | Generated anchor |
|---------|------------------|
| `#### 1. Organization` | `#_1-organization` |
| `#### 3. Voice Consistency` | `#_3-voice-consistency` |

If your in-page links don't work, check the actual `id` attribute in dev tools.

## To Have Claude Set This Up

Say: "Read vitepress.md and set it up"```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/platforms/index.md
```md
# Platforms

Webseriously is versatile enough to be embedded. `Bubble` and `Vitepress` are good examples. Porting the app to Svelte 5 is a month of difficult and risky work, even with AI assistance.

## Contents

- [Bubble](./bubble.md)
- [Plugin](./plugin.md)
- [Svelte.5](./svelte.5.md)
- [Svelte](./svelte.md)
- [Vitepress](./vitepress.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/platforms/svelte.5.md
```md
# Migrating to Svelte 5

How to upgrade from Svelte 4 to 5. The runes are coming. Reactivity works completely differently. This is going to be a project.

## Table of Contents
- [Why Upgrade](#why-upgrade)
- [What Changes](#what-changes)
- [Breaking Changes](#breaking-changes)
- [Migration Strategy](#migration-strategy)
- [Pattern Conversions](#pattern-conversions)
- [Component Examples](#component-examples)
- [Rollout Plan](#rollout-plan)

## Why Upgrade

Svelte 5 fixes a lot of weirdness:
- No more implicit reactivity (explicit `$state()` instead)
- No more `$:` reactive statements (use `$derived()` instead)
- Better TypeScript support
- Faster compilation
- More predictable behavior

But it's a breaking change. Can't just update package.json and ship.

## What Changes

### Component State

**Svelte 4:**
```svelte
<script>
let count = 0;
</script>

<button on:click={() => count += 1}>
  {count}
</button>
```

**Svelte 5:**
```svelte
<script>
let count = $state(0);
</script>

<button onclick={() => count += 1}>
  {count}
</button>
```

State is explicit now. Use `$state()` rune.

### Derived Values

**Svelte 4:**
```svelte
<script>
let count = 0;
$: doubled = count * 2;
</script>
```

**Svelte 5:**
```svelte
<script>
let count = $state(0);
let doubled = $derived(count * 2);
</script>
```

No more `$:` for derived values. Use `$derived()` rune.

### Reactive Blocks

**Svelte 4:**
```svelte
<script>
let count = 0;

$: {
  console.log('count changed:', count);
  update();
}
</script>
```

**Svelte 5:**
```svelte
<script>
let count = $state(0);

$effect(() => {
  console.log('count changed:', count);
  update();
});
</script>
```

Side effects use `$effect()` rune. Runs when dependencies change.

### Props

**Svelte 4:**
```svelte
<script>
export let title;
export let count = 0;
</script>
```

**Svelte 5:**
```svelte
<script>
let { title, count = 0 } = $props();
</script>
```

Props destructured from `$props()` rune.

### Two-way Binding

**Svelte 4:**
```svelte
<!-- Parent -->
<Child bind:value />

<!-- Child -->
<script>
export let value;
</script>
```

**Svelte 5:**
```svelte
<!-- Parent -->
<Child bind:value />

<!-- Child -->
<script>
let { value = $bindable() } = $props();
</script>
```

Bindable props must use `$bindable()` rune.

### Event Handlers

**Svelte 4:**
```svelte
<button on:click={handleClick}>
```

**Svelte 5:**
```svelte
<button onclick={handleClick}>
```

No more `on:` directive. Use lowercase native event names.

### Stores

**Svelte 4:**
```svelte
<script>
import { writable } from 'svelte/store';
const count = writable(0);
</script>

<button on:click={() => $count += 1}>
  {$count}
</button>
```

**Svelte 5:**
```svelte
<script>
import { writable } from 'svelte/store';
const count = writable(0);
</script>

<button onclick={() => $count += 1}>
  {$count}
</button>
```

Stores still work the same way! The `$` prefix still auto-subscribes. This is good news.

## Breaking Changes

### No More Implicit Reactivity

Top-level `let` is NOT reactive in Svelte 5:
```svelte
<script>
let count = 0;  // NOT REACTIVE in Svelte 5
</script>
```

Must use `$state()`:
```svelte
<script>
let count = $state(0);  // Reactive
</script>
```

### No More `$:` Labels

Reactive statements gone:
```svelte
<script>
$: doubled = count * 2;  // INVALID in Svelte 5
</script>
```

Use `$derived()` or `$effect()`:
```svelte
<script>
let doubled = $derived(count * 2);
// or
$effect(() => {
  console.log(count);
});
</script>
```

### Event Handlers Changed

```svelte
<!-- Svelte 4 -->
<button on:click={fn} on:keydown={fn}>

<!-- Svelte 5 -->
<button onclick={fn} onkeydown={fn}>
```

All event handlers use native names without `on:` prefix.

### Component Events Changed

**Svelte 4:**
```svelte
<!-- Child -->
<script>
import { createEventDispatcher } from 'svelte';
const dispatch = createEventDispatcher();
</script>
<button on:click={() => dispatch('save', data)}>

<!-- Parent -->
<Child on:save={handleSave} />
```

**Svelte 5:**
```svelte
<!-- Child -->
<script>
let { onsave } = $props();
</script>
<button onclick={() => onsave?.(data)}>

<!-- Parent -->
<Child onsave={handleSave} />
```

Component events are just callback props now.

### Lifecycle Hooks

Most stay the same, but `beforeUpdate` and `afterUpdate` are gone:
```svelte
// Svelte 4
beforeUpdate(() => {...});
afterUpdate(() => {...});

// Svelte 5 - use $effect with pre/post phases
$effect.pre(() => {...});
$effect(() => {...});
```

## Migration Strategy

### Phase 1: Audit

Count how many components we have:
```bash
find src/lib/svelte -name "*.svelte" | wc -l
```

Grep for patterns that need changing:
```bash
grep -r "export let" src/lib/svelte --include="*.svelte" | wc -l  # Props
grep -r "^\s*let " src/lib/svelte --include="*.svelte" | wc -l    # State
grep -r "\$:" src/lib/svelte --include="*.svelte" | wc -l         # Reactive
grep -r "on:" src/lib/svelte --include="*.svelte" | wc -l         # Events
```

Document the scope. How many files? Which patterns are most common?

### Phase 2: Update Dependencies

```bash
npm install svelte@5
npm install @sveltejs/kit@latest
npm install @sveltejs/vite-plugin-svelte@latest
```

Check peer dependencies. Some packages might not support Svelte 5 yet.

### Phase 3: Enable Legacy Mode

Svelte 5 has a legacy compatibility mode:
```js
// vite.config.js
export default {
  plugins: [
    svelte({
      compilerOptions: {
        compatibility: {
          componentApi: 4
        }
      }
    })
  ]
}
```

This lets Svelte 4 components run alongside Svelte 5 components.

### Phase 4: Convert Incrementally

Start with leaf components (no children). Work up the tree.

Priority order:
1. Simple presentational components
2. Buttons, inputs, basic controls
3. Complex stateful components
4. Parent/container components
5. Root layout components

Test after each conversion. Don't batch too many changes.

### Phase 5: Remove Legacy Mode

Once all components converted, remove compatibility mode:
```js
// vite.config.js - remove this
compatibility: {
  componentApi: 4
}
```

Test everything. Ship it.

## Pattern Conversions

### Our Manual Trigger Pattern

**Svelte 4:**
```svelte
<script>
let trigger = 0;

$: {
  const _ = `${$store1}:::${$store2}`;
  update();
}

function update() {
  // ... recalculate ...
  trigger = someValue;
}
</script>

{#key trigger}
  <div>...</div>
{/key}
```

**Svelte 5:**
```svelte
<script>
let trigger = $state(0);

$effect(() => {
  // Access stores to track them
  $store1;
  $store2;
  update();
});

function update() {
  // ... recalculate ...
  trigger = someValue;
}
</script>

{#key trigger}
  <div>...</div>
{/key}
```

The `{#key}` block still works! Just need to make trigger reactive with `$state()`.

### Store Destructuring

**Svelte 4:**
```svelte
<script>
const { w_t_breadcrumbs } = show;
const { w_ancestry_focus } = x;
</script>
```

**Svelte 5:**
```svelte
<script>
const { w_t_breadcrumbs } = show;
const { w_ancestry_focus } = x;
</script>
```

No change! Store destructuring still works. The `$` prefix still works.

### Reactive Dependency Tracking

**Svelte 4:**
```svelte
<script>
$: {
  const _ = `${$w_grabbed}:::${$w_ancestry_focus}`;
  update();
}
</script>
```

**Svelte 5:**
```svelte
<script>
$effect(() => {
  // Just access the stores, don't need the string trick
  $w_grabbed;
  $w_ancestry_focus;
  update();
});
</script>
```

Can simplify! Just access the variables. `$effect()` automatically tracks dependencies.

## Component Examples

### Simple Button

**Svelte 4:**
```svelte
<script>
export let text = 'Click me';
export let onClick = () => {};
let isHovered = false;
</script>

<button 
  on:click={onClick}
  on:mouseenter={() => isHovered = true}
  on:mouseleave={() => isHovered = false}>
  {text}
</button>
```

**Svelte 5:**
```svelte
<script>
let { text = 'Click me', onclick } = $props();
let isHovered = $state(false);
</script>

<button 
  {onclick}
  onmouseenter={() => isHovered = true}
  onmouseleave={() => isHovered = false}>
  {text}
</button>
```

Changes:
- `export let` → `$props()`
- `let isHovered` → `$state()`
- `on:` → native event names
- `onClick` prop → `onclick` (lowercase)

### Breadcrumbs Component

**Svelte 4:**
```svelte
<script>
export let width = g.windowSize.width;
export let centered = false;
let crumb_ancestries = [];
let trigger = 0;

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/overview.md
```md
# Architecture Overview

Start here. This is how the pieces fit together.

```mermaid
flowchart TB
    subgraph User["User Interaction"]
        Mouse["Mouse/Touch"]
        Keyboard["Keyboard"]
    end

    subgraph UI["UI Layer"]
        Svelte["Svelte Components"]
        Stores["w_* Stores"]
    end

    subgraph Managers["Manager Layer"]
        UX["UX<br/>focus, grabs, edit"]
        Hits["Hits<br/>mouse dispatch"]
        Geometry["Geometry<br/>layout"]
        Styles["Styles<br/>colors"]
        Search["Search<br/>find things"]
    end

    subgraph State["State Layer"]
        S_Objects["S_* Objects<br/>persist across re-renders"]
        Hierarchy["Hierarchy<br/>thing tree"]
    end

    subgraph Data["Data Layer"]
        Persistable["Persistable<br/>Thing, Trait, Tag, Relationship"]
        DB["Databases<br/>Firebase / Airtable / Local"]
    end

    Mouse --> Hits
    Keyboard --> UX
    Hits --> UX
    UX --> Stores
    Stores --> Svelte
    Svelte --> Geometry
    Geometry --> S_Objects
    S_Objects --> Stores
    UX --> Hierarchy
    Hierarchy --> Persistable
    Persistable --> DB
    Styles --> Svelte
    Search --> Hierarchy
```

## The Layers

**User Interaction** — Mouse and keyboard events enter here.

**UI Layer** — Svelte components render the interface. Stores (`w_*` writables) trigger reactivity.

**Manager Layer** — Singletons that coordinate domains. Hits dispatches mouse events. UX tracks focus and selection. Geometry computes layout. Styles computes colors. Search indexes content.

**State Layer** — `S_*` objects hold state that survives component re-renders. Hierarchy owns the tree of Things.

**Data Layer** — Persistable entities (Thing, Trait, Tag, Relationship) serialize to whichever database is active.

## Reading Order

1. [state.md](./core/state.md) — understand S_* objects and w_* stores
2. [managers.md](./core/managers.md) — the 16 singletons
3. [hits.md](./core/hits.md) — how mouse events flow
4. [ux.md](./core/ux.md) — focus, grabs, editing
5. [geometry.md](./core/geometry.md) — layout coordination

After that, pick what interests you.

## WRONG!
hierarchy is in the manager layer
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/geometry.md
```md
# Geometry Manager Design

Quick reference for who does what in layout. Geometry.ts coordinates, the G_* helpers do the actual math. Signals trigger rebuilds, stores trigger reactivity, direct calls when you need control.

## Responsibilities

### Geometry.ts
- Graph view rect calculation (window size, details visibility)
- User offset/center management
- Scale factor management
- Breadcrumbs layout
- Coordinates tree/radial layout dispatch

### geometry/*.ts Helpers
- **G_TreeGraph**: Tree layout algorithm (focus positioning, recursive branch layout)
- **G_RadialGraph**: Radial layout algorithm (clusters, paging, focus)
- **G_Widget**: Individual widget positioning (tree/radial origins, subtree sizes)
- **G_TreeBranches**: Tree branch layout (vertical stacking)
- **G_TreeLine**: Tree line geometry (parent-child connections)
- **G_Cluster**: Radial cluster positioning (arcs, thumbs, labels, widget necklace)
- **G_Repeater**: Button row layout (spacing, alignment)
- **G_Paging, G_Pages, G_Cluster_Pager**: Radial paging geometry

## Layout Invocation

### Signals
- `signal_rebuildGraph_fromFocus()` → triggers full rebuild
- `signal_reposition_widgets_fromFocus()` → triggers reposition only

### grand_* Methods
- `grand_build()` → `signal_rebuildGraph_fromFocus()`
- `grand_sweep()` → `layout()` + `grand_build()`
- `grand_adjust_toFit()` → scale + `layout()`

### Reactive Stores
- `w_rect_ofGraphView` → triggers layout on change
- `w_user_graph_offset` → triggers recalibrate
- `w_depth_limit` → triggers layout
- `w_branches_areChildren` → affects layout logic
- `w_scale_factor` → affects coordinate scaling

### Direct Calls
- `g.layout()` → dispatches to `g_tree.layout()` or `g_radial.layout()`
- `g_widget.layout()` → individual widget positioning
- `g_cluster.layout()` → cluster positioning

## Actors

### Drivers
- Window resize → `update_rect_ofGraphView()`
- Details visibility → `update_rect_ofGraphView()`
- Focus changes → `grand_build()`
- Depth limit changes → `layout()`
- Tree/radial mode switch → `layout()`
- User drag → `set_user_graph_offsetTo()`
- Preferences restore → `restore_preferences()`
- Database changes → `grand_build()`
- Hierarchy mutations → `grand_sweep()` / `grand_build()`

### Configured By
- Graph view rect → widget positioning bounds
- User offset → graph translation
- Scale factor → coordinate scaling
- Depth limit → recursion depth
- Branch direction → parent vs child layout
- Widget positions → computed from layout algorithm
- Cluster positions → computed from radial algorithm
- Paging → limits visible widgets per cluster

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/ux.md
```md
# UX Manager Architecture

What's focused, what's grabbed, what's being edited, what to show in details. Stores and derived stores. Fast!

## Table of Contents
- [Overview](#overview)
- [Responsibilities](#responsibilities)
- [Stores](#stores)
  - [Primary Stores](#primary-stores)
  - [S_Items Collections](#s_items-collections)
- [Key Patterns](#key-patterns)
  - [Focus vs Details](#focus-vs-details)
  - [Derived Stores](#derived-stores)
  - [Recents Navigation](#recents-navigation)
- [Core Operations](#core-operations)
  - [Becoming Focus](#becoming-focus)
  - [Grab Management](#grab-management)
  - [Search Integration](#search-integration)
- [Details Priority](#details-priority)
- [Navigation](#navigation)
  - [Focus Navigation](#focus-navigation)
  - [Details Navigation](#details-navigation)
- [Trait and Tag Selection](#trait-and-tag-selection)
- [Initialization](#initialization)
- [Usage Frequency](#usage-frequency)
- [Related Managers](#related-managers)
- [Edge Cases](#edge-cases)
- [Design Notes](#design-notes)

## Overview

The UX manager (`x`) centralizes user interaction state, managing focus, selection, grabs, search results, and editing state. It coordinates between user actions and the application's hierarchical data structure.

## Responsibilities

1. **Focus Management** - Track current focus ancestry and navigation history
2. **Grab Management** - Multi-selection of ancestries for operations
3. **Details Display** - Determine which ancestry to show in details panel
4. **Search Integration** - Coordinate search results with grabs
5. **Editing State** - Track title editing and alteration modes
6. **Navigation** - Next/previous through focus history and selections

## Stores

### Primary Stores

| Store | Type | Purpose |
|-------|------|---------|
| `w_ancestry_focus` | `Readable<Ancestry \| null>` | Current focus ancestry (derived from recents) |
| `w_ancestry_forDetails` | `Readable<Ancestry \| null>` | Ancestry to display in details panel (prioritizes search → grabs → focus) |
| `w_s_title_edit` | `writable<S_Title_Edit \| null>` | Current title editing state |
| `w_s_alteration` | `writable<S_Alteration \| null>` | Current alteration mode (adding relationships) |
| `w_thing_title` | `writable<string \| null>` | Title being edited |
| `w_relationship_order` | `writable<number>` | Order for relationship relocations |
| `w_thing_fontFamily` | `writable<string>` | Font family for rendering |

### S_Items Collections

| Collection | Type | Purpose |
|------------|------|---------|
| `si_recents` | `S_Items<[Ancestry, S_Items<Ancestry> \| null]>` | Focus navigation history with associated grabs |
| `si_grabs` | `S_Items<Ancestry>` | Currently grabbed ancestries |
| `si_found` | `S_Items<Thing>` | Search results |
| `si_expanded` | `S_Items<Ancestry>` | Expanded nodes in tree |

## Key Patterns

### Focus vs Details

The UX manager distinguishes between **focus** (navigation target) and **details** (what's displayed in details panel):

- **Focus** (`w_ancestry_focus`): Always an ancestry, drives graph layout
- **Details** (`w_ancestry_forDetails`): Can be search result, grab, or focus (prioritized in that order)

### Derived Stores

Both `w_ancestry_focus` and `w_ancestry_forDetails` are **derived stores**, computed from other state:

```typescript
w_ancestry_focus = derived([si_recents.w_items, si_recents.w_index], ...)
w_ancestry_forDetails = derived([
    search.w_s_search,
    si_found.w_index,
    si_found.w_items,
    show.w_show_search_controls,
    si_grabs.w_items,
    si_grabs.w_index,
    w_ancestry_focus
], ...)
```

This ensures automatic reactivity when any dependent state changes.

### Recents Navigation

Focus history is stored as pairs: `[ancestry, grabs]`. This allows restoring both focus and grabs when navigating backward/forward:

```typescript
type Identifiable_S_Items_Pair = [Ancestry, S_Items<Ancestry> | null];
si_recents = new S_Items<Identifiable_S_Items_Pair>([]);
```

## Core Operations

### Becoming Focus

```typescript
becomeFocus(ancestry: Ancestry): boolean {
    const pair = [ancestry, this.si_grabs];
    this.si_recents.remove_all_beyond_index();  // Remove forward history
    this.si_recents.push(pair);                  // Add to history
    this.w_s_alteration.set(null);               // Clear alteration mode
    ancestry.expand();
    hits.recalibrate();
    return changed;
}
```

### Grab Management

**Grab** - Add ancestry to multi-selection (moves to end if already grabbed):
```typescript
grab(ancestry: Ancestry) {
    let items = this.si_grabs.items ?? [];
    const index = items.indexOf(ancestry);
    if (index != -1 && index != items.length - 1) {
        items.splice(index, 1);  // Remove from current position
    }
    items.push(ancestry);         // Add at end
    this.si_grabs.items = items;
}
```

**Ungrab** - Remove ancestry from multi-selection (defaults to root if empty):
```typescript
ungrab(ancestry: Ancestry) {
    let grabbed = this.si_grabs.items ?? [];
    const index = grabbed.indexOf(ancestry);
    if (index != -1) {
        grabbed.splice(index, 1);
    }
    if (grabbed.length == 0) {
        grabbed.push(h.rootAncestry);  // Never empty
    }
    this.si_grabs.items = grabbed;
}
```

**GrabOnly** - Replace grabs with single ancestry:
```typescript
grabOnly(ancestry: Ancestry) {
    this.si_grabs.items = [ancestry];
    h?.stop_alteration();
}
```

### Search Integration

When search is active, grabs are automatically updated to match search results:

```typescript
update_grabs_forSearch() {
    if (search.w_s_search != T_Search.off && si_found.length > 0) {
        let ancestries = si_found.items
            .map(found => found.ancestry)
            .filter(a => !!a);
        ancestries = u.strip_hidDuplicates(ancestries);
        if (this.si_grabs.descriptionBy_sorted_IDs != u.descriptionBy_sorted_IDs(ancestries)) {
            this.si_grabs.items = ancestries;
        }
    }
}
```

This runs on:
- Focus changes
- Database updates
- Search state changes
- Search result selection changes

## Details Priority

The `w_ancestry_forDetails` derived store implements priority logic:

1. **First Priority**: Search selected result (if search active and result selected)
2. **Second Priority**: Current grab (if grabs exist)
3. **Third Priority**: Current focus
4. **Fallback**: Root ancestry

This allows the details panel to show context-appropriate information while the user searches or multi-selects.

## Navigation

### Focus Navigation

```typescript
ancestry_next_focusOn(next: boolean) {
    if (si_recents.find_next_item(next)) {
        const [focus, grabs] = si_recents.item;
        focus?.expand();
        if (grabs) {
            this.si_grabs = grabs;  // Restore grabs from history
        }
    }
}
```

### Details Navigation

```typescript
grab_next_ancestry(next: boolean) {
    if (search.w_s_search > T_Search.off) {
        si_found.find_next_item(next);    // Navigate search results
    } else {
        si_grabs.find_next_item(next);    // Navigate grabs
    }
    details.redraw();
}
```

## Trait and Tag Selection

UX manager provides access to traits and tags for the current details ancestry:

```typescript
get si_thing_traits(): S_Items<Trait> {
    return this.ancestry_forDetails?.thing?.si_traits ?? new S_Items<Trait>([]);
}

get si_thing_tags(): S_Items<Tag> {
    return this.ancestry_forDetails?.thing?.si_tags ?? new S_Items<Tag>([]);
}
```

Navigation methods allow cycling through:
- `select_next_thingTrait(next)` - Traits for current details thing
- `select_next_trait(next)` - All traits in hierarchy
- `select_next_thing_tag(next)` - Tags for current details thing

## Initialization

```typescript
setup_subscriptions() {
    // Assert si_recents is seeded (restore_focus() should have been called)
    console.assert(si_recents.length > 0);

    // Setup reactive subscriptions
    w_ancestry_focus.subscribe(ancestry => update_grabs_forSearch());
    databases.w_data_updated.subscribe(() => update_grabs_forSearch());
    search.w_s_search.subscribe(() => update_grabs_forSearch());
    si_found.w_index.subscribe(() => update_grabs_forSearch());
}
```

**Critical**: `si_recents` must be populated before `setup_subscriptions()` is called, otherwise derived stores will fail.

## Usage Frequency

UX manager is heavily used throughout the codebase:
- **Ancestry.ts**: 18 references to `x.*`
- **Hierarchy.ts**: 16 references to `x.*`

Common usage patterns:
```typescript
import { x } from '../managers/UX';

// Access current focus
const focus = get(x.w_ancestry_focus);

// Grab an ancestry
x.grab(ancestry);

// Navigate focus history
x.ancestry_next_focusOn(true);  // next
x.ancestry_next_focusOn(false); // previous

// Get details ancestry
const details = x.ancestry_forDetails;
```

## Related Managers

- **Search**: Provides search state and results that UX integrates
- **Details**: Uses `w_ancestry_forDetails` to display information
- **Hierarchy**: Coordinates with UX for focus changes and alterations
- **Visibility**: Controls whether search controls are shown
- **Hits**: Recalibrates when focus changes

## Edge Cases

1. **Empty grabs**: Always defaults to root ancestry
2. **Search active**: Grabs automatically sync with search results
3. **Radial dragging**: Grab/ungrab operations are blocked during ring rotation and resize
4. **Tree mode**: Special handling for empty grabs state

## Design Notes

The UX manager uses **derived stores** instead of manual synchronization, ensuring:
- Automatic reactivity when dependencies change
- No stale state issues
- Clear dependency graph
- Minimal update logic

The separation of focus (navigation) from details (display) allows:
- Search results to be shown while maintaining focus position
- Multi-selection to work independently of focus
- Consistent graph layout while details panel shows different content
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/managers.md
```md
# Manager Pattern Architecture

Webseriously uses 16 singleton managers to coordinate different aspects of the application. Each manager has a specific responsibility and provides a centralized API for its domain.

## Table of Contents
- [Overview](#overview)
- [Why Singleton Managers?](#why-singleton-managers)
- [Complete Manager List](#complete-manager-list)
- [Manager Responsibilities](#manager-responsibilities)
- [Access Patterns](#access-patterns)
- [Manager Lifecycle](#manager-lifecycle)
- [Cross-Manager Dependencies](#cross-manager-dependencies)
- [Best Practices](#best-practices)

## Overview

Managers are singleton instances that coordinate specific aspects of the application:
- **State coordination** - Own and manage state objects and stores
- **Centralized logic** - Single source of truth for domain operations
- **Factory methods** - Provide controlled access to resources
- **Lifecycle management** - Handle setup, cleanup, and persistence

## Why Singleton Managers?

### Problems Solved

1. **Scattered State** - Without managers, state would be distributed across components
2. **Duplication** - Common operations would be reimplemented in multiple places
3. **Tight Coupling** - Components would directly depend on each other
4. **Testing Difficulty** - Hard to mock or isolate functionality

### Benefits

- **Single Source of Truth** - Each domain has one authoritative manager
- **Centralized Control** - Easy to find and modify domain logic
- **Dependency Injection** - Managers can be mocked for testing
- **Clear Boundaries** - Each manager owns a specific responsibility
- **Easier Debugging** - Centralized logic is easier to trace

## Complete Manager List

| Manager | Global | Purpose |
|---------|--------|---------|
| `Components` | `components` | Component lifecycle management, registration |
| `Configuration` | `configuration` | App configuration, feature flags, settings |
| `Controls` | `controls` | Control panel state, button management |
| `Core` | `core` | System state (w_t_startup, w_hierarchy) |
| `Details` | `details` | Details panel management, tab switching |
| `Elements` | `elements` | DOM element tracking, S_Element factory |
| `Features` | `features` | Feature enablement/disablement flags |
| `Geometry` | `g` | Layout coordination, graph view bounds |
| `Hierarchy` | `h` | Tree data management, Thing/Trait/Tag operations |
| `Hits` | `hits` | Hit testing, hover detection, click handling |
| `Preferences` | `p` | User preferences, settings persistence |
| `Radial` | `radial` | Radial graph specific logic, cluster management |
| `Search` | `search` | Search functionality, result management |
| `Styles` | `styles` | Theme and styling, color computation |
| `UX` | `x` | User interaction state (focus, grabs, details) |
| `Visibility` | `visibility` | Component visibility control, show/hide logic |

## Manager Responsibilities

### Components
**Responsibility**: Component lifecycle and registration

**Key Methods**:
```typescript
component_register(name: string, component: any)
component_unregister(name: string)
component_get(name: string): any
```

**Use Cases**:
- Track mounted components
- Manage component instances
- Coordinate component updates

---

### Configuration
**Responsibility**: Application configuration and feature flags

**Key Methods**:
```typescript
get(key: string): any
set(key: string, value: any)
```

**Stores**:
- `w_config` - Configuration state

**Use Cases**:
- Feature toggles
- Environment settings
- Build-time configuration

---

### Controls
**Responsibility**: Control panel state and button management

**Key Methods**:
```typescript
button_for(type: T_Control): S_Element
```

**Stores**:
- `w_controls_visible` - Control panel visibility

**Use Cases**:
- Control button state
- Panel visibility
- Button interactions

---

### Core
**Responsibility**: Core system state

**Key Methods**:
```typescript
startup()
shutdown()
```

**Stores**:
- `w_t_startup` - Startup state (loading, ready, error)
- `w_hierarchy` - Current hierarchy instance

**Use Cases**:
- Application initialization
- Hierarchy switching
- Global state coordination

---

### Details
**Responsibility**: Details panel management

**Key Methods**:
```typescript
show_tab(tab: T_Details_Tab)
hide()
toggle()
```

**Stores**:
- `w_tab` - Current active tab
- `w_visible` - Details panel visibility

**Use Cases**:
- Tab switching
- Panel show/hide
- Detail content coordination

---

### Elements
**Responsibility**: DOM element tracking and S_Element factory

**Key Methods**:
```typescript
s_element_for(identifiable: Identifiable, type: T_Hit_Target, name: string): S_Element
s_widget_forAncestry(ancestry: Ancestry): S_Widget
```

**Use Cases**:
- Create/retrieve S_Element instances
- Manage element lifecycle
- Coordinate visual state

---

### Features
**Responsibility**: Feature enablement/disablement

**Properties**:
```typescript
allow_autoSave: boolean
allow_details: boolean
standalone_UI: boolean
```

**Use Cases**:
- Conditional feature rendering
- Feature flag checks
- Build-specific behavior

---

### Geometry (`g`)
**Responsibility**: Layout coordination and graph view management

**Key Methods**:
```typescript
layout()
grand_build()
grand_sweep()
update_rect_ofGraphView()
```

**Stores**:
- `w_rect_ofGraphView` - Graph viewport bounds
- `w_user_graph_offset` - User pan offset
- `w_scale_factor` - Zoom level

**Use Cases**:
- Trigger layout recalculation
- Manage graph viewport
- Coordinate tree/radial layout

---

### Hierarchy (`h`)
**Responsibility**: Tree data management

**Key Methods**:
```typescript
thing_forHID(hid: string): Thing | null
thing_create(title: string, parent?: Thing): Thing
trait_create(thing: Thing, key: string, value: string): Trait
ancestry_forThing(thing: Thing): Ancestry
```

**Stores**:
- `w_things` - All Things in hierarchy
- `w_traits` - All Traits
- `w_tags` - All Tags

**Use Cases**:
- CRUD operations on Things/Traits/Tags
- Hierarchy traversal
- Data persistence

---

### Hits
**Responsibility**: Hit testing, hover detection, click handling

**Key Methods**:
```typescript
add_hit_target(target: S_Hit_Target)
delete_hit_target(target: S_Hit_Target)
targets_atPoint(point: Point): S_Hit_Target[]
handle_click_at(point: Point, s_mouse: S_Mouse)
```

**Stores**:
- `w_s_hover` - Currently hovering target
- `w_autorepeat` - Autorepeating target
- `w_longClick` - Long-click pending target

**Use Cases**:
- Spatial indexing (RBush)
- Hover detection
- Click dispatch
- Autorepeat/long-click/double-click

---

### Preferences (`p`)
**Responsibility**: User preferences and settings persistence

**Key Methods**:
```typescript
get(key: T_Preference): any
set(key: T_Preference, value: any)
read_key(key: string): string
write_key(key: string, value: string)
```

**Use Cases**:
- Save/load user settings
- Preference defaults
- LocalStorage persistence

---

### Radial
**Responsibility**: Radial graph specific logic

**Key Methods**:
```typescript
cluster_for(ancestry: Ancestry): G_Cluster | null
```

**Use Cases**:
- Radial layout coordination
- Cluster management
- Paging control

---

### Search
**Responsibility**: Search functionality and result management

**Key Methods**:
```typescript
search(query: string)
clear()
```

**Stores**:
- `w_results` - Search results
- `w_query` - Current search query
- `w_visible` - Search panel visibility

**Use Cases**:
- Full-text search
- Result highlighting
- Search state management

---

### Styles
**Responsibility**: Theme and styling management

**Key Methods**:
```typescript
get_widgetColors_for(snapshot: S_Snapshot, thing_color: string, background_color: string)
recompute_style()
```

**Use Cases**:
- Color computation
- Theme switching
- Style coordination

---

### UX (`x`)
**Responsibility**: User interaction state

**Key Methods**:
```typescript
ancestry_focus_set(ancestry: Ancestry | null)
grab_add(ancestry: Ancestry)
grab_remove(ancestry: Ancestry)
```

**Stores**:
- `w_ancestry_focus` - Current focused ancestry
- `w_grabs` - Grabbed ancestries (selection)
- `w_details_visible` - Details panel visibility

**Use Cases**:
- Focus management
- Selection tracking
- UI state coordination

---

### Visibility
**Responsibility**: Component visibility control

**Methods**:
```typescript
show(component: string)
hide(component: string)
toggle(component: string)
```

**Use Cases**:
- Conditional rendering
- Panel show/hide
- UI state management

## Access Patterns

### Global Import
All managers are available via `Global_Imports`:

```typescript
import { h, g, x, core, hits, databases } from '../common/Global_Imports';

// Access manager methods
const thing = h.thing_forHID('abc123');
g.layout();
x.ancestry_focus_set(ancestry);
```

### Store Subscriptions
Managers expose stores for reactivity:

```typescript
import { core } from '../common/Global_Imports';

// Subscribe to hierarchy changes
$: hierarchy = $core.w_hierarchy;

// React to startup state
$: if ($core.w_t_startup === T_Startup.ready) {
    // App is ready
}
```

### Factory Methods
Managers provide factories for controlled instantiation:

```typescript
import { elements } from '../common/Global_Imports';

// Get or create S_Element
const s_element = elements.s_element_for(identifiable, T_Hit_Target.widget, 'my-widget');

// Get or create S_Widget
const s_widget = elements.s_widget_forAncestry(ancestry);
```

## Manager Lifecycle

### Initialization
Managers are initialized in `Core.startup()`:

```typescript
async startup() {
    await databases.grand_change_database(initial_db);
    features.apply_queryStrings(queryStrings);
    p.restore_preferences();
    g.update_rect_ofGraphView();
    this.w_t_startup.set(T_Startup.ready);
}
```

### Cleanup
Components should clean up manager-owned resources:

```typescript
onDestroy(() => {
    hits.delete_hit_target(s_element);
    components.component_unregister(name);
});
```

## Cross-Manager Dependencies

### Dependency Graph

```
Core
├── Databases (w_hierarchy)
├── Features (feature flags)
└── Preferences (settings)

Geometry
├── Core (w_hierarchy)
├── UX (w_ancestry_focus)
└── Visibility (details visibility)

Hits
├── Elements (s_element factory)
└── UX (hover/click coordination)

Hierarchy
├── Databases (persistence)
└── Core (w_hierarchy)

UX
├── Hierarchy (ancestry operations)
├── Details (panel coordination)
└── Geometry (layout triggers)
```

### Coordination Patterns

**Pattern 1: Event → Manager → Store → UI**
```typescript
// User clicks button
hits.handle_click_at(point, s_mouse);
  → target.handle_s_mouse(s_mouse)
  → x.ancestry_focus_set(ancestry)
  → x.w_ancestry_focus.set(ancestry)
  → $: focused = $x.w_ancestry_focus  // Component reacts
```

**Pattern 2: Store → Manager → Action**
```typescript
// Focus changes
$: if ($x.w_ancestry_focus) {
    g.layout();  // Trigger layout recalculation
}
```

**Pattern 3: Manager → Manager → Coordination**
```typescript
// Database switch
databases.grand_change_database(type)
  → core.w_hierarchy.set(new_hierarchy)
  → h = new_hierarchy
  → g.grand_build()  // Rebuild layout
```

## Best Practices

### ✅ DO

- **Use managers for domain logic** - Keep business logic centralized
- **Subscribe to manager stores** - React to manager state changes
- **Use factory methods** - Let managers control resource creation
- **Clean up in onDestroy** - Remove registrations, cancel subscriptions
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/state.md
```md
# State Management Architecture

Each state object is a single source of truth. Webseriously uses a hybrid approach: **state objects** (S_* classes) for persistent, object-oriented state that survives component recreation, plus **Svelte stores** (w_* writables) for reactivity. Both are organized by manager domain. Webseriously is a tightly integrated reactive system of considerable complexity, requiring this specialized (non-standard) approach.

## Table of Contents
- [Overview](#overview)
- [The Problem](#the-problem)
- [Standard Svelte Patterns (Use These First)](#standard-svelte-patterns-use-these-first)
- [When This Pattern Makes Sense](#when-this-pattern-makes-sense)
- [State Objects (S_*)](#state-objects-s_)
- [Stores (w_*)](#stores-w_)
- [Store Inventory](#store-inventory)
- [Hybrid Pattern in Practice](#hybrid-pattern-in-practice)
- [Alternatives Considered](#alternatives-considered)
- [Best Practices](#best-practices)
- [Related Documents](#related-documents)

## Overview

**Two complementary mechanisms:**

1. **State Objects** — Persistent classes outside component tree
   - Survive component recreation
   - Computed properties via getters
   - Object-oriented (methods, inheritance)
   - Managed by domain (managers)

2. **Svelte Stores** — Reactive primitives
   - Trigger component updates
   - All prefixed `w_`
   - Built-in Svelte reactivity

**Key**: State objects provide structure/persistence, stores provide reactivity.

---

## The Problem

Svelte component state is **ephemeral** — destroyed when components recreate. In complex interactive apps with frequent recreation, you need state that:

1. Survives component destruction/recreation
2. Coordinates across related components
3. Is accessible to managers outside component tree
4. Provides centralized computed properties

**Example:**
```svelte
<!-- ❌ Component state lost on recreation -->
<script>
  let isHovering = false;  // LOST when component recreates
</script>

<!-- ✅ State object persists -->
<script>
  const s_element = elements.s_element_for(...);  // Survives recreation
</script>
```

---

## Standard Svelte Patterns (Use These First)

**95% of Svelte apps should use standard patterns:**

```svelte
<!-- 1. Component-local state -->
<script>
  let count = 0;
</script>

<!-- 2. Svelte stores -->
<script>
  const count = writable(0);
  $: value = $count;
</script>

<!-- 3. Context API -->
<script>
  setContext('key', value);
  const value = getContext('key');
</script>

<!-- 4. Props -->
<Child {value} on:change />
```

---

## When This Pattern Makes Sense

**Only use hybrid approach when you have ALL of:**

1. ✅ Components frequently recreate
2. ✅ State must survive recreation  
3. ✅ Complex object-oriented state needed (methods, getters, inheritance)
4. ✅ Managers need direct state access outside components
5. ✅ Cross-component coordination required

**Missing any?** Use standard Svelte patterns.

---

## State Objects (S_*)

### Five Key Benefits

**1. Survive Component Recreation**
```typescript
// Manager owns state objects
const s_widget = elements.s_widget_forAncestry(ancestry);
// Same instance even after component recreates ✅
```

**2. Centralized Computed Properties**
```typescript
class S_Element {
  get fill(): string {
    if (this.asTransparent) return 'transparent';
    return this.dotColors_forElement.fill;
  }
}
```

**3. Cross-Component Coordination**
```typescript
class S_Widget extends S_Element {
  s_reveal: S_Element;  // Related components share state
  s_title: S_Element;
  s_drag: S_Element;
}
```

**4. Manager Access**
```typescript
// Hits manager updates state directly
hits.set_asHovering(s_element);  // Components react automatically
```

**5. Immutable Snapshots**
```typescript
const snapshot = new S_Snapshot(s_element);  // For complex computations
```

### Hierarchy

```
S_Hit_Target (base)
├── S_Element (visual properties)
│   └── S_Widget (widget-specific)
├── S_Component (signal management)
├── S_Rotation (rotation interaction)
└── S_Resizing (resize interaction)
```

### Usage

```svelte
<script>
  const s_widget = elements.s_widget_forAncestry(ancestry);
  
  $: fill = s_widget.fill;      // Computed property
  $: stroke = s_widget.stroke;  // Computed property
</script>
```

---

## Stores (w_*)

### Organization

Each manager owns stores for its domain. All prefixed `w_`.

```typescript
// TypeScript
import { x } from '../managers/UX';
const focus = get(x.w_ancestry_focus);

// Svelte
import { x } from '$lib/ts/managers/UX';
$: focus = $x.w_ancestry_focus;
```

### Types

**Writable** — Read-write state
```typescript
const w_scale_factor = writable(1.0);
w_scale_factor.update(n => n * 1.1);
```

**Derived** — Computed from other stores
```typescript
w_item = derived([w_items, w_index], 
  ([items, index]) => items[index] ?? null
);
```

### Patterns

**Increment** — Trigger without data
```typescript
w_count_rebuild.update(n => n + 1);
```

**Update** — Standard updates
```typescript
w_ancestry_focus.set(ancestry);
```

### Naming

| Prefix | Purpose | Example |
|--------|---------|---------|
| `w_` | All stores | `w_ancestry_focus` |
| `w_count_` | Counters | `w_count_rebuild` |
| `w_s_` | State objects | `w_s_hover` |
| `w_t_` | Types/enums | `w_t_startup` |
| `w_show_` | Visibility | `w_show_details` |

---

## Hybrid Pattern in Practice

```svelte
<script>
  import { elements, x, hits } from '$lib/ts/common/Global_Imports';
  
  export let ancestry: Ancestry;
  
  // State object (persistent)
  const s_widget = elements.s_widget_forAncestry(ancestry);
  
  // Stores (reactive)
  const { w_ancestry_focus } = x;
  const { w_s_hover } = hits;
  
  // Computed from state object
  $: cx = s_widget.cx;
  $: cy = s_widget.cy;
  $: fill = s_widget.fill;
  $: stroke = s_widget.stroke;
  
  // Reactive to stores
  $: isFocus = ancestry.isEqualTo($w_ancestry_focus);
  $: isHovering = s_widget.isEqualTo($w_s_hover);
</script>

<circle {cx} {cy} r={s_widget.r} {fill} {stroke} 
        class:focus={isFocus} 
        class:hovering={isHovering} />
```

**Why this works:**
- State object survives recreation
- Getters centralize computation
- Stores provide reactivity
- Component stays simple

---
## Best Practices
### State Objects

**✅ DO:**
- Get from managers
- Use getters for computed properties
- Clean up in `onDestroy`
- Combine with stores for reactivity

**❌ DON'T:**
- Create directly (bypass managers)
- Use for simple values (use stores)

### Stores

**✅ DO:**
- Use writable for user input, preferences, counters
- Use derived for computed values
- Strongly type all stores
- Group by manager domain

**❌ DON'T:**
- Mix concerns across managers
- Create in components
- Forget to unsubscribe
- Use for complex objects (use state objects)

---
## Alternatives Considered
### 1. Svelte Stores Only ❌
- No object methods/getters
- No inheritance
- Still need objects for structure

### 2. Pinia
- ✅ Persists, has getters
- ❌ Vue-centric, external dependency

### 3. Zustand  
- ✅ Lightweight, framework-agnostic
- ❌ Store-based, not object-based

### 4. Svelte Context
- ✅ Built-in, simple
- ❌ Tied to component tree, destroyed with provider

### 5. Class Instances (Our Approach)
- ✅ Objects with methods, no dependencies, survives recreation
- ❌ Manual lifecycle, not idiomatic Svelte, not widely documented

### 6. Redux/Flux
- ✅ Predictable, well-documented
- ❌ Heavy, immutable (we need mutable getters)

### 7. MobX
- ✅ Observable objects
- ❌ External dependency, overkill

**Why our approach:** Solves specific needs (recreation + coordination + object methods) without external dependencies.

**Why not documented:** Most apps don't need it — standard Svelte patterns work for 95% of cases.

---
## Store Inventory

### UX.ts (7 stores)
User interaction tracking

- `w_s_title_edit` — Title editing
- `w_s_alteration` — Relationship creation
- `w_thing_title` — Thing title during edit
- `w_relationship_order` — Sibling relocation
- `w_thing_fontFamily` — Font family
- `w_ancestry_forDetails` — Detail panel selection
- `w_ancestry_focus` — Main focus

### Colors.ts (3 stores)
Color preferences

- `w_background_color` — Theme/mood
- `w_thing_color` — Thing color edit
- `w_separator_color` — Background shade

### Visibility.ts (14 stores)
UI visibility toggles

- `w_t_cluster_pager` — Pager type
- `w_t_breadcrumbs` — Breadcrumb type
- `w_t_auto_adjust_graph` — Auto-adjust
- `w_t_directionals` — Build notes nav
- `w_t_graph` — Graph mode
- `w_t_details` — Details visibility
- `w_t_trees` — Related trees
- `w_t_countDots` — Count types
- `w_id_popupView` — Current popup
- `w_show_save_data_button` — Debug
- `w_show_search_controls` — Search controls
- `w_show_related` — Related items
- `w_show_details` — Details panel
- `w_show_countsAs_dots` — Dots vs numbers
- `w_show_other_databases` — Database options

### Search.ts (4 stores)
Search state

- `w_search_results_found` — Results available
- `w_search_results_changed` — Re-render trigger
- `w_s_search` — Search UX
- `w_search_preferences` — Preferences

### Events.ts (10 stores)
Event tracking (mostly mouse)

- `w_count_details` — Details rebuild
- `w_count_rebuild` — Layout rebuild
- `w_count_window_resized` — Window resize
- `w_count_mouse_down` — Mouse down
- `w_count_mouse_up` — Mouse up
- `w_control_key_down` — Control key
- `w_mouse_button_down` — Mouse button
- `w_scaled_movement` — Scaled movement
- `w_mouse_location` — Raw location
- `w_mouse_location_scaled` — Scaled location

### Geometry.ts (6 stores)
Layout properties

- `w_depth_limit` — Max depth
- `w_branches_areChildren` — Branch mode
- `w_user_graph_center` — Graph center
- `w_user_graph_offset` — Pan offset
- `w_rect_ofGraphView` — Viewport bounds
- `w_scale_factor` — Zoom level

### Radial.ts (4 stores)
Radial mode

- `w_rotate_angle` — Rotation angle
- `w_resize_radius` — Resize radius
- `w_g_paging` — Paging state
- `w_g_cluster` — Cluster layout

### Core.ts (2 stores)
System state

- `w_t_startup` — Startup state
- `w_hierarchy` — Current hierarchy

### Databases.ts (2 stores)
Database state

- `w_data_updated` — Update trigger
- `w_t_database` — Database type

### Hits.ts (4 stores)
Mouse tracking

- `w_s_hover` — Hovering element
- `w_longClick` — Long-click pending
- `w_autorepeat` — Autorepeat active
- `w_dragging` — Drag in progress

### Configuration.ts (1 store)
Platform config

- `w_device_isMobile` — Mobile detection

**Total: 57 stores across 11 managers**

---
## Related Documents

- [components.md](./components.md) - Component organization and Components manager
- [managers.md](./managers.md) - Manager pattern architecture
- [hits.md](./hits.md) - Centralized hit testing with S_Hit_Target
- [styles.md](../internals/styles.md) - Centralized color computation with state objects
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/components.md
```md
# Component Architecture

**Synopsis**: Webseriously's component system has two layers: (1) **Svelte components** organized into 11 directories by purpose (controls, details, draw, main, mouse, radial, search, text, tree, widget, experimental), and (2) **Components manager** that tracks S_Component state objects for complex interactive components that need state persistence across recreation. Simple interactive elements use S_Element (see Elements manager), while complex components like pagers and breadcrumbs use S_Component for additional behavior management.

## Table of Contents
- [Component Organization](#component-organization)
  - [Overview](#overview)
  - [Directory Structure](#directory-structure)
  - [Organizing Principles](#organizing-principles)
- [Component Categories](#component-categories)
  - [controls/ - Graph Controls](#controls---graph-controls)
  - [details/ - Detail Panels](#details---detail-panels)
  - [draw/ - SVG Primitives](#draw---svg-primitives)
  - [experimental/ - WIP Components](#experimental---wip-components)
  - [main/ - Core Application](#main---core-application)
  - [mouse/ - Interactive Elements](#mouse---interactive-elements)
  - [radial/ - Radial Graph](#radial---radial-graph)
  - [search/ - Search Interface](#search---search-interface)
  - [text/ - Text Rendering](#text---text-rendering)
  - [tree/ - Tree Graph](#tree---tree-graph)
  - [widget/ - Widget System](#widget---widget-system)
- [Component Patterns](#component-patterns)
  - [Pattern 1: Stateless Presentation](#pattern-1-stateless-presentation)
  - [Pattern 2: State Object + Reactive Props](#pattern-2-state-object--reactive-props)
  - [Pattern 3: Hit Testing + Click Handling](#pattern-3-hit-testing--click-handling)
  - [Pattern 4: Manager Coordination](#pattern-4-manager-coordination)
- [State Management](#state-management)
  - [State Objects (S_*)](#state-objects-s_)
  - [Reactive Stores](#reactive-stores)
  - [Computed Properties](#computed-properties)
- [Components Manager](#components-manager)
  - [Purpose](#purpose)
  - [S_Component vs S_Element](#s_component-vs-s_element)
  - [Data Structure](#data-structure)
  - [Core Methods](#core-methods)
  - [S_Component Class](#s_component-class)
  - [Component Types (T_Hit_Target)](#component-types-t_hit_target)
  - [Usage Pattern](#usage-pattern)
  - [Lifecycle](#lifecycle)
  - [Dummy Component](#dummy-component)
  - [Dictionary Structure Example](#dictionary-structure-example)
  - [Performance](#performance)
- [Naming Conventions](#naming-conventions)
  - [File Names](#file-names)
  - [Component Prefixes](#component-prefixes)
- [Best Practices](#best-practices)
- [Related Documents](#related-documents)

---

## Component Organization

### Overview

Component organization follows these principles:
- **By purpose** - Components grouped by what they do, not how they work
- **Clear boundaries** - Each directory has a single responsibility
- **Reusability** - Shared components in appropriate directories
- **Progressive complexity** - Simple components in `draw/`, complex in `main/`

### Directory Structure

```
src/lib/svelte/
├── controls/        # Primary/secondary controls, breadcrumbs, tree controls
├── details/         # Detail panels (actions, data, header, preferences, selection, tags, traits)
├── draw/            # SVG primitives (boxes, circles, gradients, portals, separators, spinners)
├── experimental/    # Work-in-progress components
├── main/            # Core app (SeriouslyApp, Panel, Graph, Details, Import, BuildNotes)
├── mouse/           # Interactive elements (buttons, sliders, rubberband, steppers, color pickers)
├── radial/          # Radial graph (clusters, rings)
├── search/          # Search interface and results
├── text/            # Text rendering (angled, curved, editors, tables)
├── tree/            # Tree graph (branches, lines)
└── widget/          # Widget system (drag, reveal, title)
```

### Organizing Principles

1. **Purpose over Implementation** - Group by what components do (controls, details), not how (React, Vue)
2. **Single Responsibility** - Each directory owns one domain
3. **Complexity Gradient** - Simple (draw/) → Medium (mouse/) → Complex (main/)
4. **Clear Dependencies** - main/ uses all others, draw/ uses none

---

## Component Categories

### controls/ - Graph Controls
**Purpose**: Top-level control buttons and navigation

**Components**:
- `Breadcrumbs.svelte` - Ancestry navigation breadcrumbs
- `Primary_Controls.svelte` - Main control buttons (zoom, mode, etc.)
- `Secondary_Controls.svelte` - Additional controls
- `Tree_Controls.svelte` - Tree-specific controls

**State**:
- Uses `controls` manager
- `S_Element` for hit testing
- Reactive to `x.w_ancestry_focus`

**Example**:
```svelte
<!-- Breadcrumbs.svelte -->
<script>
  import { x } from '$lib/ts/common/Global_Imports';
  
  $: ancestry = $x.w_ancestry_focus;
  $: breadcrumbs = ancestry?.breadcrumbs ?? [];
</script>

{#each breadcrumbs as crumb}
  <Breadcrumb_Button {crumb} />
{/each}
```

---

### details/ - Detail Panels
**Purpose**: Tabbed detail panels for focused Thing

**Components**:
- `Banner_Hideable.svelte` - Collapsible banner header
- `D_Actions.svelte` - Action buttons (browse, focus, add, delete, move)
- `D_Data.svelte` - Thing data editor
- `D_Header.svelte` - Detail panel header
- `D_Preferences.svelte` - Per-thing preferences
- `D_Selection.svelte` - Selection/grab management
- `D_Tags.svelte` - Tag assignment
- `D_Traits.svelte` - Trait key-value editor

**State**:
- Uses `details` manager
- `w_tab` for active tab
- `w_visible` for panel visibility
- Reactive to `x.w_ancestry_focus`

**Example**:
```svelte
<!-- D_Actions.svelte -->
<script>
  import { x, h } from '$lib/ts/common/Global_Imports';
  
  $: thing = $x.w_ancestry_focus?.thing;
  
  function browse_left() {
    const sibling = h.sibling_left_forThing(thing);
    if (sibling) x.ancestry_focus_set(h.ancestry_forThing(sibling));
  }
</script>

<Button on:click={browse_left}>←</Button>
```

---

### draw/ - SVG Primitives
**Purpose**: Reusable SVG drawing components

**Components**:
- `Box.svelte` - Rectangles with fill/stroke
- `Circle.svelte` - Circles (dots, widgets)
- `Gull_Wings.svelte` - Gull wing decorations
- `Portal.svelte` - Portal rendering
- `Printable.svelte` - Print-friendly wrappers
- `SVG_D3.svelte` - D3.js integration layer
- `SVG_Gradient.svelte` - Gradient definitions
- `Separator.svelte` - Visual separators
- `Spinner.svelte` - Loading spinners
- `Transparent_Circle.svelte` - Hit-testable transparent circles

**State**:
- Stateless presentation components
- Props for geometry and colors
- No direct store subscriptions

**Example**:
```svelte
<!-- Circle.svelte -->
<script>
  export let cx: number;
  export let cy: number;
  export let r: number;
  export let fill: string = 'white';
  export let stroke: string = 'black';
</script>

<circle {cx} {cy} {r} {fill} {stroke} />
```

---

### experimental/ - WIP Components
**Purpose**: Components under active development

**Note**: Components here may be incomplete, unstable, or experimental. Not used in production until moved to appropriate directory.

---

### main/ - Core Application
**Purpose**: Top-level application structure

**Components**:
- `SeriouslyApp.svelte` - Root application component
- `Panel.svelte` - Main panel container
- `Graph.svelte` - Graph viewport
- `Details.svelte` - Detail panel container
- `Import.svelte` - Data import interface
- `BuildNotes.svelte` - Build notes display

**State**:
- Uses `core` manager
- `w_t_startup` for app lifecycle
- Coordinates all other components

**Example**:
```svelte
<!-- SeriouslyApp.svelte -->
<script>
  import { core, features } from '$lib/ts/common/Global_Imports';
  
  $: startup = $core.w_t_startup;
</script>

{#if startup === T_Startup.loading}
  <Spinner />
{:else if startup === T_Startup.ready}
  <Panel />
  {#if features.standalone_UI}
    <Details />
  {/if}
{/if}
```

---

### mouse/ - Interactive Elements
**Purpose**: Mouse-driven UI components

**Components**:
- `Breadcrumb_Button.svelte` - Clickable breadcrumb chips
- `Button.svelte` - Generic button with autorepeat/long-click
- `Buttons_Row.svelte` - Horizontal button group
- `Buttons_Table.svelte` - Button grid layout
- `Clickable_Label.svelte` - Clickable text labels
- `Close_Button.svelte` - Close/dismiss buttons
- `Cluster_Pager.svelte` - Radial cluster paging controls
- `Color.svelte` - Color picker
- `Glow_Button.svelte` - Glowing interactive buttons
- `Glows_Banner.svelte` - Banner with glow effects
- `Next_Previous.svelte` - Next/previous navigation
- `Rubberband.svelte` - Rubberband selection
- `Segmented.svelte` - Segmented control
- `Slider.svelte` - Value slider
- `Steppers.svelte` - Increment/decrement steppers
- `Triangle_Button.svelte` - Triangle-shaped buttons

**State**:
- Uses `hits` manager for click detection
- `S_Element` for each interactive element
- `mouse_detection` for autorepeat/long-click/double-click

**Example**:
```svelte
<!-- Button.svelte -->
<script>
  import { elements, hits } from '$lib/ts/common/Global_Imports';
  import { T_Mouse_Detection } from '$lib/ts/common/Enumerations';
  
  export let mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
  export let handle_s_mouse: (s_mouse: S_Mouse) => boolean;
  
  const s_element = elements.s_element_for(...);
  let element: HTMLElement;
  
  onMount(() => {
    s_element.set_html_element(element);
    s_element.handle_s_mouse = handle_s_mouse;
    s_element.mouse_detection = mouse_detection;
  });
  
  onDestroy(() => {
    hits.delete_hit_target(s_element);
  });
</script>

<div bind:this={element}>
  <slot />
</div>
```

---

### radial/ - Radial Graph
**Purpose**: Radial graph visualization components

**Components**:
- `Radial_Cluster.svelte` - Cluster of widgets in radial layout
- `Radial_Graph.svelte` - Radial graph container
- `Radial_Rings.svelte` - Concentric rings for depth levels

**State**:
- Uses `radial` manager
- `G_RadialGraph` for layout
- `G_Cluster` for cluster positioning
- Reactive to `x.w_ancestry_focus`

**Example**:
```svelte
<!-- Radial_Cluster.svelte -->
<script>
  import { g, radial } from '$lib/ts/common/Global_Imports';
  
  export let ancestry: Ancestry;
  
  $: cluster = radial.cluster_for(ancestry);
  $: widgets = cluster?.widgets ?? [];
</script>

{#each widgets as widget}
  <Widget {widget} />
{/each}
```

---

### search/ - Search Interface
**Purpose**: Search functionality and results display

**Components**:
- `Search.svelte` - Search input and controls
- `Search_Results.svelte` - Search result list
- `Search_Toggle.svelte` - Show/hide search panel

**State**:
- Uses `search` manager
- `w_results` for search results
- `w_query` for current query
- `w_visible` for panel visibility

**Example**:
```svelte
<!-- Search.svelte -->
<script>
  import { search } from '$lib/ts/common/Global_Imports';
  
  let query = '';
  
  $: results = $search.w_results;
  
  function handle_search() {
    search.search(query);
  }
</script>

<input bind:value={query} on:input={handle_search} />
<Search_Results {results} />
```

---

### text/ - Text Rendering
**Purpose**: Specialized text rendering components

**Components**:
- `Angled_Text.svelte` - Text at arbitrary angles
- `Curved_Text.svelte` - Text along curved paths
- `Text_Editor.svelte` - Inline text editing
- `Text_Table.svelte` - Tabular text layout

**State**:
- Presentation components
- Props for geometry and content
- `S_Title_Edit` for editing state

**Example**:
```svelte
<!-- Curved_Text.svelte -->
<script>
  export let text: string;
  export let path: string;  // SVG path
  export let fill: string = 'black';
</script>

<defs>
  <path id="text-path" d={path} />
</defs>
<text {fill}>
  <textPath href="#text-path">
    {text}
  </textPath>
</text>
```

---

### tree/ - Tree Graph
**Purpose**: Tree graph visualization components

**Components**:
- `Tree_Branches.svelte` - Vertical branch layout
- `Tree_Graph.svelte` - Tree graph container
- `Tree_Line.svelte` - Parent-child connection lines

**State**:
- Uses `geometry` manager
- `G_TreeGraph` for layout
- `G_TreeBranches` for branch positioning
- Reactive to `x.w_ancestry_focus`

**Example**:
```svelte
<!-- Tree_Graph.svelte -->
<script>
  import { g, x } from '$lib/ts/common/Global_Imports';
  
  $: focus = $x.w_ancestry_focus;
  $: tree_layout = g.g_tree.layout_for(focus);
</script>

{#if tree_layout}
  <Tree_Branches {tree_layout} />
{/if}
```

---

### widget/ - Widget System
**Purpose**: Widget rendering and interaction

**Components**:
- `Widget.svelte` - Main widget component (circle + title)
- `Widget_Drag.svelte` - Drag dot
- `Widget_Reveal.svelte` - Reveal/hide children dot
- `Widget_Title.svelte` - Widget title text

**State**:
- Uses `elements` manager
- `S_Widget` for widget state
- `S_Element` for drag/reveal dots
- Reactive to `x.w_ancestry_focus`, `x.w_grabs`

**Example**:
```svelte
<!-- Widget.svelte -->
<script>
  import { elements, x } from '$lib/ts/common/Global_Imports';
  
  export let ancestry: Ancestry;
  
  const s_widget = elements.s_widget_forAncestry(ancestry);
  
  $: isFocus = ancestry.isEqualTo($x.w_ancestry_focus);
  $: isGrabbed = ancestry.isGrabbed;
  $: fill = s_widget.fill;
  $: stroke = s_widget.stroke;
</script>

<Circle cx={s_widget.cx} cy={s_widget.cy} r={s_widget.r} {fill} {stroke} />
<Widget_Title {s_widget} />
{#if s_widget.shows_drag}
  <Widget_Drag {s_widget} />
{/if}
{#if s_widget.shows_reveal}
  <Widget_Reveal {s_widget} />
{/if}
```

---

## Component Patterns

### Pattern 1: Stateless Presentation
**Use for**: SVG primitives, simple rendering

```svelte
<script>
  export let cx: number;
  export let cy: number;
  export let r: number;
  export let fill: string;
</script>

<circle {cx} {cy} {r} {fill} />
```

**Characteristics**:
- No state management
- Pure props → output
- No side effects
- Highly reusable

---

### Pattern 2: State Object + Reactive Props
**Use for**: Graph elements (widgets, dots)

```svelte
<script>
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/hits.md
```md
# Hits Design

Only one element in the app can react to the mouse. The **Hits** spatial index knows which one. It's the **single source of truth** for hover and click dispatch. Consistent behavior everywhere.

For timing logic (autorepeat, long-click, double-click), see [timers.md](../internals/timers.md).

## Table of Contents
- [Overview & Status](#overview--status)
  - [Overview](#overview)
  - [Status](#status)
  - [Benefits](#benefits)
- [Architecture](#architecture)
  - [Hits Manager](#hits-manager)
  - [Click Detection Flow](#click-detection-flow)
  - [S_Hit_Target](#s_hit_target)
  - [Component Pattern](#component-pattern)
  - [S_Mouse](#s_mouse)
- [Migration Guide](#migration-guide)
  - [Step 1: Add S_Element](#step-1-add-s_element-for-components-without-one)
  - [Step 2: Set handle_s_mouse](#step-2-set-handle_s_mouse-for-components-with-existing-s_element)
  - [Step 3: Remove DOM handlers](#step-3-remove-dom-handlers)
- [Component Status](#component-status)
  - [Migrated](#migrated-)
  - [Pending](#pending)
- [Rubberband](#rubberband)
- [Testing](#testing)
  - [Setup](#setup)
  - [Terms](#terms)
  - [Regression](#regression)
- [Reference](#reference)
  - [Hit Target Type Getters](#hit-target-type-getters)
  - [Component Complexity](#component-complexity)

---

## Overview & Status

### Overview

Centralized click handling using the Hits spatial index to dispatch `handle_s_mouse` to the component under the mouse. Eliminates per-component DOM event handlers.

### Status

- [x] **Complete** — Core hit detection and dispatch
- [x] **Complete** — All mouse timing centralized (see [timers.md](../internals/timers.md))
- [ ] Remaining work
  - [ ] `Search_Results.svelte` — complex (dynamic rows, may be too granular)
  - [ ] breadcrumb button — not yet migrated to centralized autorepeat
  - [ ] close button — does not yet use Button

### Benefits

- **Single source of truth**: one manager dispatches all clicks and hover
- **Consistent precedence**: dots > widgets > rings > controls > rubberband
- **Cleaner components**: register handler, receive callbacks
- **Consistent behavior**: all hovering and clicking works the same way

---

## Architecture

### Hits Manager

The manager is the single point of truth regarding which element is reactive to hover and click. It uses the bounding rects of ALL registered elements to determine which one contains the current mouse position. It then calls `handle_s_mouse` on that element for mouse up and down events, and sets `hits.w_s_hover` for mouse entering or leaving the bounding rect.

Some elements have a shape very different than a rectangle. `S_Hit_Target` provides an optional hook that can refine the enter/leave boundary.

### Click Detection Flow

On `mousedown`/`mouseup` at the document level (Events.ts):
1. Call `hits.targets_atPoint(point)` to find targets under cursor
2. Select topmost target using priority: dot → widget → ring → control → other
3. Invoke `target.handle_s_mouse(s_mouse)` if defined
4. Hits handles timing centrally (see [timers.md](../internals/timers.md))

```
mousedown → Events.ts → hits.handle_click_at(point, s_mouse)
                              ↓
                     targets_atPoint(point)
                              ↓
                     select topmost target
                              ↓
                     target.handle_s_mouse(s_mouse)
```

### S_Hit_Target

The superclass of all element and component UX state objects (`S_Element` and `S_Component`).

#### Hit Rect

Hits uses a highly performant RBush index that takes a mouse position (x, y) and returns hit targets enclosing that point. Each hit target is assigned a rect. The rect must be kept current — updated when graph is altered or details toggled.

**Registration:**

The `rect` setter **always** calls `hits.add_hit_target(this)` unconditionally:
```ts
set rect(value: Rect | null) {
    this.element_rect = value;
    hits.add_hit_target(this);  // Always called
}
```

**Clipping:**

Hit rects for graph elements (dots, widgets, rings) are clipped to the visible graph view:
```ts
update_rect() {
    if (!!this.html_element) {
        let rect = g.scaled_rect_forElement(this.html_element);
        if (rect && (this.isADot || this.isAWidget || this.isRing)) {
            const graph_bounds = get(g.w_rect_ofGraphView);
            if (graph_bounds) {
                rect = rect.clippedTo(graph_bounds);
            }
        }
        this.rect = rect;
    }
}
```

#### Click Handler

Optional `handle_s_mouse` method:
```ts
handle_s_mouse?: (s_mouse: S_Mouse) => boolean;
```

### Component Pattern

Components register a handler on their hit target:
```ts
s_element.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
    // handle click, return true if consumed
    return handle_s_mouse(s_mouse);
};
```

DOM `on:mouse*` handlers are removed — only centralized `Events.ts` listeners remain.

### S_Mouse

A **transient value object** encapsulating current mouse-relevant information:

- **What happened**: `isDown`, `isUp`, `isLong`, `isDouble`, `isRepeat`, `isMove`
- **Where**: `element` (the target HTMLElement)
- **Raw data**: `event` (the original MouseEvent)

Static factories:
```ts
S_Mouse.down(event, element)    // user pressed
S_Mouse.up(event, element)      // user released
S_Mouse.long(event, element)    // held past threshold
S_Mouse.double(event, element)  // second click within threshold
S_Mouse.repeat(event, element)  // autorepeat tick
```

**Deprecated patterns:**

| Old | New |
|----|-----|
| `elements.s_mouse_forName(name)` | Fresh `S_Mouse` instances each time |
| `S_Mouse.clicks` | `S_Hit_Target.clicks` |
| `detect_autorepeat` boolean | `mouse_detection` enum |

---

## Migration Guide

### Step 1: Add S_Element (for components without one)

```ts
const s_element = elements.s_element_for(new Identifiable(name), T_Hit_Target.button, name);
let element: HTMLElement;

onMount(() => {
    s_element.set_html_element(element);
    s_element.handle_s_mouse = handle_s_mouse;
});

onDestroy(() => {
    hits.delete_hit_target(s_element);
});
```

```svelte
<div bind:this={element}>...</div>
```

### Step 2: Set handle_s_mouse (for components with existing S_Element)

```ts
s_element.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
    return handle_s_mouse(s_mouse);
};
```

### Step 3: Remove DOM handlers

```diff
- on:pointerdown={handle_pointerDown}
- on:pointerup={handle_pointerUp}
```

---

## Component Status

### Migrated ✅

| Component | Notes |
|-----------|-------|
| `Button.svelte` | S_Element + handle_s_mouse, supports all timing modes |
| `Glow_Button.svelte` | S_Element + handle_s_mouse + hover via hits |
| `Next_Previous.svelte` | Array of S_Elements for multiple buttons |
| `Widget_Title.svelte` | s_title + s_widget handle_s_mouse |
| `Radial_Rings.svelte` | s_rotation + s_resizing handle_s_mouse |
| `Cluster_Pager.svelte` | s_pager handle_s_mouse for thumbs |
| `Radial_Cluster.svelte` | s_paging handle_s_mouse for paging arcs |
| `Rubberband.svelte` | Catch-all for empty graph space |
| `Close_Button.svelte` | Fixed handler setup and RBush entry management |
| `Widget_Drag.svelte` | Responds on `isDown` |
| `Widget_Reveal.svelte` | Responds on `isDown` |
| `Segmented.svelte` | Changed to `on:mousedown` |
| `Breadcrumb_Button.svelte` | Responds on `isDown` |
| `D_Actions.svelte` | All actions autorepeat |
| `Steppers.svelte` | Passed to `Triangle_Button` |
| `Triangle_Button.svelte` | Wraps Button |
| `Buttons_Row.svelte` | Uses Button |
| `Buttons_Table.svelte` | Uses `Buttons_Row` |

### Pending

| Component | Issue |
|-----------|-------|
| `Search_Results.svelte` | Each row would need its own S_Element — too granular |

---

## Rubberband

Rubberband handles clicks on "empty" graph space. Registers directly as a catch-all hit target instead of Graph.svelte delegating.

**Why Rubberband, not Graph?**
- Rubberband actually needs the click
- Graph just passes through — unnecessary middleman
- Rubberband already has `bounds` prop

**Implementation:**

```ts
const s_element = elements.s_element_for(new Identifiable('rubberband'), T_Hit_Target.rubberband, 'graph');

onMount(() => {
    s_element.set_html_element(rubberband_hit_area);
    s_element.handle_s_mouse = handle_s_mouse;
});
```

```svelte
<div class='rubberband-hit-area' bind:this={rubberband_hit_area}
     style='position:absolute; top:0; left:0; width:{bounds.size.width}px; height:{bounds.size.height}px; pointer-events:none;'/>
```

Meta key forces rubberband target for graph dragging.

---

## Testing

### Setup

All tests assume a **widget is selected** in the graph or list view.

### Terms

| Term | Definition |
|------|------------|
| **details panel** | Stack of buttons opening panels. Tap details toggle (three bars, top left) to show. |
| **actions panel** | Details panel showing action buttons in seven categories. |
| **re-render** | Svelte destroys/recreates component. `S_Hit_Target` persists. |

### Regression

1. **Normal-click buttons work normally**
   - [x] Single click works, no delays or repeats
   - [x] breadcrumbs — fixed (responds on `isDown`)
   - [x] details toggle — fixed (responds on `isDown`)
   - [x] search — fixed (handler setup improved)
   - [x] close search — fixed (handler setup, removed stale RBush entries)
   - [x] widget drag/reveal buttons — fixed (respond on `isDown`)
   - [x] segmented controls — fixed (changed to `on:mousedown`)

For timing tests (autorepeat, double-click, long-click), see [timers.md](../internals/timers.md#testing).

---

## Reference

### Hit Target Type Getters

| Getter | Includes |
|--------|----------|
| `isAControl` | `T_Hit_Target.control`, `T_Hit_Target.button` |
| `isAWidget` | `T_Hit_Target.widget`, `T_Hit_Target.title` |
| `isRing` | `T_Hit_Target.ring`, `T_Hit_Target.paging` |
| `isADot` | `T_Hit_Target.dot` |

### Component Complexity

| Component | Notes |
|-----------|-------|
| `Rubberband.svelte` | Catch-all, lowest priority |
| `Search_Results.svelte` | Too granular for per-row S_Element |
| `Breadcrumb_Button.svelte` | Dual state: `S_Widget` for colors, separate `S_Element` for hit target |
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/index.md
```md
# Core

For this project, I decided to use Svelte. Once my first component was working, i assumed it would make a good template for my next one. Unfortunately, by the time I built most of them, they became difficult to coordinate. Hovering acted oddly, cats were sleeping with dogs, very unreliable, unprofessional. The solution? I eventually gathered related bits of logic into small tightly related clumps and called them managers. Uniform and reliable behavior. These are they. The seven items here are responsible for the basic capabilities upon which everything relies.

## Contents

- [Components](./components.md)
- [Databases](./databases.md)
- [Geometry](./geometry.md)
- [Hits](./hits.md)
- [Managers](./managers.md)
- [State](./state.md)
- [Ux](./ux.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/core/databases.md
```md
# Database Abstraction Architecture

I built this to run on Firebase, Airtable, Local, and Test databases. They share a unified CRUD interface. Each database gets its own Hierarchy instance, so live-switching back-and-forth doesn't lose loaded data.

Once a database record is in memory, I call it a [[../internals/persistable]].

## Table of Contents
- [Overview](#overview)
- [Architecture](#architecture)
  - [Core Components](#core-components)
  - [Database Types](#database-types)
  - [Persistence Types](#persistence-types)
- [Database Switching](#database-switching)
  - [URL Parameter](#url-parameter)
  - [Programmatic Switching](#programmatic-switching)
  - [Switching Flow](#switching-flow)
- [DB_Common Base Class](#db_common-base-class)
  - [Properties](#properties)
  - [CRUD Interface](#crud-interface)
  - [Batch Operations](#batch-operations)
- [Persistence Pattern](#persistence-pattern)
  - [persist_all Flow](#persist_all-flow)
  - [Airtable Special Case](#airtable-special-case)
- [Persistable Pattern](#persistable-pattern)
  - [Serialization](#serialization)
- [Database Implementations](#database-implementations)
  - [DB_Local (IndexedDB)](#db_local-indexeddb)
  - [DB_Firebase (Firestore)](#db_firebase-firestore)
  - [DB_Airtable](#db_airtable)
  - [DB_Bubble](#db_bubble)
  - [DB_Test](#db_test)
- [Database Cache](#database-cache)
- [Adding a New Database Backend](#adding-a-new-database-backend)
- [Stores](#stores)
- [Query String Support](#query-string-support)
- [Related Components](#related-components)
- [Performance Considerations](#performance-considerations)
- [Edge Cases](#edge-cases)
- [Best Practices](#best-practices)

## Overview

Webseriously supports multiple database backends through a unified abstraction layer. Each database type maintains its own hierarchy instance, allowing seamless switching between Firebase, Airtable, Bubble, Local storage, and Test databases.

## Architecture

### Core Components

**DB_Common** - Abstract base class defining CRUD API
**Databases** - Manager class for database switching and lifecycle
**DB_* implementations** - Concrete backends (Firebase, Airtable, Local, Bubble, Test)
**Persistable** - Base class for all persistable entities (Thing, Trait, Tag, Predicate, Relationship)

### Database Types

| Type                  | Persistence | Use Case                  | ID Base    |
| --------------------- | ----------- | ------------------------- | ---------- |
| `T_Database.firebase` | Remote      | Public shared data        | "Public"   |
| `T_Database.airtable` | Remote      | Airtable API storage      | "Airtable" |
| `T_Database.bubble`   | Remote      | Bubble.io plugin mode     | "Bubble"   |
| `T_Database.local`    | Local       | IndexedDB browser storage | "Local"    |
| `T_Database.test`     | None        | Debugging                 | "Test"     |

### Persistence Types

```typescript
enum T_Persistence {
    none,      // No persistence (test mode)
    local,     // Browser storage (IndexedDB)
    remote     // Remote API (Firebase, Airtable, Bubble)
}
```

## Database Switching

### URL Parameter

Switch database via `?db=` parameter:
```
?db=local       // Local IndexedDB
?db=firebase    // Firebase Firestore
?db=airtable    // Airtable API
?db=bubble      // Bubble plugin mode
?db=test        // Test mode
```

### Programmatic Switching

```typescript
// Change to specific database
databases.w_t_database.set(T_Database.local);

// Cycle through databases
databases.db_change_toNext(true);   // forward
databases.db_change_toNext(false);  // backward
```

### Switching Flow

```typescript
async grand_change_database(type: string) {
    const db = this.db_forType(type);
    let h = db.hierarchy;
    if (!h) {
        h = new Hierarchy(db);      // Create new hierarchy for this DB
        db.hierarchy = h;
    }
    p.write_key(T_Preference.db, type);  // Save preference
    core.w_hierarchy.set(h);             // Switch global hierarchy
    this.w_t_database.set(type);
    await db.hierarchy_setup_fetch_andBuild();  // Load data
    busy.signal_data_redraw();
}
```

**Key insight**: Each database maintains its own `Hierarchy` instance. Switching databases swaps the global hierarchy reference.

## DB_Common Base Class

### Properties

```typescript
class DB_Common {
    t_persistence: T_Persistence;  // none, local, or remote
    t_database: T_Database;        // firebase, airtable, etc.
    idBase: DB_Name;              // Display name
    hierarchy: Hierarchy;         // Associated hierarchy
    load_time: string;            // Load duration
    load_start_time: number;      // Performance tracking
}
```

### CRUD Interface

All database implementations must provide:

**Things**:
```typescript
async thing_persistentUpdate(thing: Thing)
async thing_persistentDelete(thing: Thing)
async thing_remember_persistentCreate(thing: Thing)
```

**Predicates**:
```typescript
async predicate_persistentUpdate(predicate: Predicate)
async predicate_persistentDelete(predicate: Predicate)
async predicate_remember_persistentCreate(predicate: Predicate)
```

**Relationships**:
```typescript
async relationship_persistentUpdate(relationship: Relationship)
async relationship_persistentDelete(relationship: Relationship)
async relationship_remember_persistentCreate(relationship: Relationship)
```

**Traits**:
```typescript
async trait_persistentUpdate(trait: Trait)
async trait_persistentDelete(trait: Trait)
async trait_remember_persistentCreate(trait: Trait)
```

**Tags**:
```typescript
async tag_persistentUpdate(tag: Tag)
async tag_persistentDelete(tag: Tag)
async tag_remember_persistentCreate(tag: Tag)
```

### Batch Operations

```typescript
async fetch_all(): Promise<boolean>  // Load all data from database
async remove_all()                   // Clear all data
async persist_all(force: boolean)    // Save all dirty entities
```

## Persistence Pattern

### persist_all Flow

```typescript
async persist_all(force: boolean = false) {
    if (!force && (databases.defer_persistence || !features.allow_autoSave)) {
        busy.signal_data_redraw();  // Defer persistence
        return;
    }

    busy.isPersisting = true;
    busy.signal_data_redraw();

    for (const t_persistable of Persistable.t_persistables) {
        await this.persistAll_identifiables_ofType_maybe(t_persistable, force);
    }

    busy.isPersisting = false;
    busy.signal_data_redraw();
}
```

**Deferred Persistence**: Updates can be batched by setting `databases.defer_persistence = true`. This prevents individual operations from triggering immediate saves.

**Auto-save**: Controlled by `features.allow_autoSave` flag.

### Airtable Special Case

Airtable requires polling until hierarchy is clean:
```typescript
// Wait for airtable to catch up
let interval = setInterval(() => {
    if (!h.isDirty) {
        busy.isPersisting = false;
        busy.signal_data_redraw();
        clearInterval(interval);
    }
}, 100);
```

## Persistable Pattern

All data entities extend `Persistable`:

```typescript
class Thing extends Persistable {
    async persistent_create_orUpdate(already_persisted: boolean) {
        if (already_persisted) {
            await databases.db_now.thing_persistentUpdate(this);
        } else {
            await databases.db_now.thing_remember_persistentCreate(this);
        }
    }

    get fields(): Airtable.FieldSet {
        // Serialize to database-specific format
    }
}
```

### Serialization

Each Persistable implements `fields` getter for database serialization:
- **Firebase/Local**: Uses JSON representation
- **Airtable**: Uses FieldSet format with specific field mappings
- **Bubble**: Custom format for plugin communication

## Database Implementations

### DB_Local (IndexedDB)

- Uses Dexie.js for IndexedDB access
- Stores JSON representations of entities
- Key: `T_Persistable` type name (lowercase)
- Value: Array of serialized entities

**Read**:
```typescript
fetch_all_fromLocal(): boolean {
    for (const t_persistable of Persistable.t_persistables) {
        const json = p.readDB_key(t_persistable.toLowerCase());
        if (json) {
            // Deserialize and remember entities
        }
    }
}
```

**Write**:
```typescript
persistAll_identifiables_ofType_maybe(t_persistable: T_Persistable) {
    const identifiables = h.identifiables_ofType(t_persistable);
    const json = JSON.stringify(identifiables.map(i => i.json));
    p.writeDB_key(t_persistable.toLowerCase(), json);
}
```

### DB_Firebase (Firestore)

- Remote document database
- Collection per entity type
- Real-time sync capabilities
- Document ID = entity hash ID

### DB_Airtable

- Remote table-based storage
- Maps entities to Airtable records
- Uses Airtable API
- Requires API key configuration
- Async operations with polling for completion

### DB_Bubble

- Communicates with Bubble.io plugin container
- postMessage protocol for CRUD operations
- No local persistence (Bubble owns data)
- Special `isStandalone = false` flag

### DB_Test

- In-memory only (t_persistence = T_Persistence.none)
- No actual persistence
- Used for unit testing
- Fastest for development

## Database Cache

The `Databases` manager caches database instances:

```typescript
class Databases {
    private dbCache: Dictionary<DB_Common> = {};

    db_forType(type: string): DB_Common {
        if (!this.dbCache[type]) {
            switch (type) {
                case T_Database.firebase: this.dbCache[type] = new DB_Firebase(); break;
                case T_Database.airtable: this.dbCache[type] = new DB_Airtable(); break;
                case T_Database.bubble:   this.dbCache[type] = new DB_Bubble(); break;
                case T_Database.local:    this.dbCache[type] = new DB_Local(); break;
                case T_Database.test:     this.dbCache[type] = new DB_Test(); break;
            }
        }
        return this.dbCache[type];
    }
}
```

Each database instance is created once and reused, maintaining its own hierarchy.

## Adding a New Database Backend

1. **Create implementation class**:
```typescript
export default class DB_NewBackend extends DB_Common {
    constructor() {
        super();
        this.t_database = T_Database.newbackend;
        this.t_persistence = T_Persistence.remote;  // or local
        this.idBase = DB_Name.newbackend;
    }
}
```

2. **Add to T_Database enum**:
```typescript
export enum T_Database {
    newbackend = 'newbackend',
    // ...
}

export enum DB_Name {
    newbackend = 'NewBackend',
    // ...
}
```

3. **Implement CRUD methods**:
```typescript
async fetch_all(): Promise<boolean> {
    // Load all entities from backend
    // Call h.thing_remember(), h.trait_remember(), etc.
}

async thing_persistentUpdate(thing: Thing) {
    // Update thing in backend
}

// ... implement all other CRUD methods
```

4. **Register in Databases manager**:
```typescript
db_forType(type: string): DB_Common {
    switch (type) {
        case T_Database.newbackend: return new DB_NewBackend();
        // ...
    }
}

db_next_get(forward: boolean): T_Database {
    // Add to rotation
}
```

5. **Update serialization** (if needed):
```typescript
// In Persistable subclasses, add backend-specific serialization
get fields(): BackendFormat {
    if (databases.db_now.t_database === T_Database.newbackend) {
        return { /* custom format */ };
    }
    return { /* default format */ };
}
```

## Stores

| Store | Type | Purpose |
|-------|------|---------|
| `w_data_updated` | `writable<number>` | Increments on data changes |
| `w_t_database` | `writable<string>` | Current database type |

**Usage**:
```typescript
import { databases } from '../common/Global_Imports';

// Subscribe to database changes
databases.w_t_database.subscribe(type => {
    console.log('Database changed to:', type);
});

// Subscribe to data updates
databases.w_data_updated.subscribe(count => {
    console.log('Data updated', count, 'times');
});
```

## Query String Support

```typescript
apply_queryStrings(queryStrings: URLSearchParams) {
    let type = queryStrings.get('db');
    if (!!type) {
        this.db_now = this.db_forType(type);
    } else {
        type = p.read_key(T_Preference.db) ?? T_Database.firebase;
    }
    this.w_t_database.set(type);
}
```

Falls back to saved preference or Firebase if no `?db=` parameter.

## Related Components

- **Preferences manager** (`p`): Stores database selection persistently
- **Hierarchy** (`h`): Each database has its own hierarchy instance
- **Core manager** (`core`): Holds `w_hierarchy` store
- **Busy manager** (`busy`): Tracks persistence state
- **Features manager** (`features`): Controls auto-save

## Performance Considerations

1. **Deferred persistence**: Batch updates to reduce DB operations
2. **Database cache**: Reuse instances, don't recreate
3. **Hierarchy per DB**: Switching doesn't lose loaded data
4. **Test mode**: Use for development (no I/O overhead)
5. **Local mode**: Fastest persistent option

## Edge Cases

1. **Switching during dirty state**: Data loss possible if not persisted first
2. **Airtable async**: Requires polling, can't rely on immediate completion
3. **Bubble plugin mode**: Different lifecycle than standalone
4. **Empty database**: Falls back to root ancestry
5. **Query string priority**: URL parameter overrides saved preference

## Best Practices

✅ **DO**:
- Use `databases.db_now` to access current database
- Implement all CRUD methods in new backends
- Test with `DB_Test` first
- Defer persistence during bulk operations
- Check `t_persistence` before assuming storage

❌ **DON'T**:
- Access database implementations directly
- Assume synchronous persistence
- Forget to update `db_next_get()` rotation
- Skip serialization format for new backend
- Mix database-specific code outside abstraction layer
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/styles.md
```md
# Color Management

I admit it, my early code was a nightmare to tweak because i designed it as i went along. With AI, i crafted a centralized system. One place to confine the mess. Styles computes all colors from state snapshots. Remarkably simple code.

## Table of Contents
- [Overview](#overview)
- [Known Issues / Future Work](#known-issues--future-work)
- [Core Components](#core-components)
- [States](#states)
- [Driver](#driver)
- [Color Properties](#color-properties)
  - [Per Component](#per-component)
  - [State Logic](#state-logic)
- [Architecture](#architecture)
  - [Current Implementation](#current-implementation)
  - [Implementation Status](#implementation-status)
- [Define color schema per component/state](#define-color-schema-per-componentstate)
  - [Common Fill/Stroke Pattern (Drag, Reveal, Button)](#common-fillstroke-pattern-drag-reveal-button)
  - [Dots (Drag, Reveal)](#dots-drag-reveal)
  - [Widget](#widget)
  - [Button](#button)
- [Centralize color computation logic](#centralize-color-computation-logic)
  - [Design Summary](#design-summary)
- [Standardize state transitions](#standardize-state-transitions)
- [Document color inheritance rules](#document-color-inheritance-rules)
  - [Color Sources](#color-sources)
  - [Inheritance Patterns](#inheritance-patterns)
  - [Inheritance Rules](#inheritance-rules)
  - [No True Inheritance Hierarchy](#no-true-inheritance-hierarchy)
  - [Current Implementation Status](#current-implementation-status)
  - [Current State Flow](#current-state-flow)
  - [Migration Strategy](#migration-strategy)
- [Implementation Notes](#implementation-notes)
- [Styles manager (Implementation)](#styles-manager-implementation)
  - [Design](#design)
  - [Trade-offs: inject Styles methods into S_Snapshot](#trade-offs-inject-styles-methods-into-s_snapshot)
- [Analyze set_forHovering](#analyze-set_forhovering)
  - [Current Usage Patterns](#current-usage-patterns)
  - [Key Observations](#key-observations)
  - [Centralization Opportunities](#centralization-opportunities)
  - [Recommendation](#recommendation)
  - [Current Status](#current-status)

## Overview

Centralized color management system driven by the Hits manager and hit targets. Colors are computed based on component type, state (hover/selected/none), and interaction context.

## Known Issues / Future Work

- Glow buttons have some click handling issues (separate from color management)
- Consider adding tests for Styles computation functions
- Could further simplify S_Element helper getters if needed
- **Centralize `set_forHovering` calls** - See "Analyze set_forHovering" section above

## Core Components

- **widget** - Main widget container
- **drag** - Drag handle dot
- **reveal** - Reveal/expand dot
- **button** - UI buttons

## States

- **hover** - Mouse is over the element
- **selected** - grab
- **editing** - 
- **focus** - 
- **mouse down** - 
- **none** - Default/base state



## Driver

- **Hits Manager** (`Hits.ts`) - Tracks hover state via `w_s_hover` store
- **Hit Target** (`S_Hit_Target`) - Base class for all interactive elements, provides hover state

## Color Properties

### Per Component
- `fill` - Background/fill color
- `stroke` - Border/text color
- `svg_outline_color` - SVG outline color
- `border` - CSS border style

### State Logic
- Hover state from `hits.w_s_hover`
- Selected state from `isSelected`
- Inversion logic via `isInverted` and `color_isInverted`

## Architecture

### Current Implementation ✅
- Colors computed centrally in `Styles` utility class
- `S_Element` and `S_Widget` getters call `Styles` methods
- Components remain reactive via getter pattern
- `set_forHovering()` sets hover color and cursor (unchanged)

### Implementation Status
- [x] Define color schema per component/state
- [x] Centralize color computation logic
- [x] Create `S_Snapshot` state object class
- [x] Migrate widget, drag, reveal, button components
- [x] Standardize state transitions
- [x] Document color inheritance rules
- [ ] Analyze set_forHovering

## Define color schema per component/state

### Common Fill/Stroke Pattern (Drag, Reveal, Button)

**Base setup:**
- `element_color` - Set via `set_forHovering(thing.color, cursor)`
- `hoverColor` - Computed via `colors.hover_special_blend(element_color)`
- `color_background` - From `w_background_color`

**Fill/Stroke computation (all states except selected/disabled):**
- `fill`: `color_isInverted ? hoverColor : color_background`
- `stroke`: `color_isInverted ? color_background : element_color`

### Dots (Drag, Reveal)

**Properties:**
- `fill`, `stroke` - Use common pattern above
- `svg_outline_color` - SVG path outline

**States:**
- **none/hover**: `svg_outline_color` = `thing_color`
- **grabbed**: `svg_outline_color` = `color_background`
- **editing**: `svg_outline_color` = `black` (if light thing_color) or `hoverColor` (if dark)

**Special:**
- Drag: `parents_go` = `stroke`, `related_color` = `thing.color`
- Reveal: `bulkAlias_go` = `stroke`

### Widget

**Properties:**
- `color` - Text/stroke (via `colorFor_grabbed_andEditing()`)
- `background_color` - Background fill
- `border` - CSS border style

**States:**
- **none**: `color` = `thing_color`, `background_color` = `transparent`, `border` = `transparent`
- **hover**: `background_color` = `w_background_color`, `border` = `solid ${colors.ofBackgroundFor(thing_color)} 1px`
- **grabbed**: `color` = `black`/`white` (based on thing_color luminance), `background_color` = `thing_color`
- **editing**: `background_color` = `w_background_color`, `border` = `dashed ${thing_color} 1px`
- **focus** (radial): `background_color` = `w_background_color`, `border` = `solid ${thing_color} 1px`

### Button

**Properties:**
- `fill`, `stroke` - Use common pattern above
- `border` - CSS border style

**Special states:**
- **selected**: `fill` = `lightblue`
- **disabled**: `fill` = `transparent`, `stroke` = `disabledTextColor`
- **editing/focus**: `border` uses `thing_color` (widget context only)

## Centralize color computation logic

### Design Summary

**Current State:**
- Color logic scattered across `S_Element`, `S_Widget` getters
- Components call `update_colors()` reactively with local variables
- Duplication of fill/stroke inversion logic
- State combinations computed inline

**Implemented Architecture:**

Created `Styles` utility class (`src/lib/ts/utilities/Styles.ts`) with static methods:
- Takes inputs: `S_Snapshot` state object, base colors
- Returns computed color values based on schema
- Encapsulates all conditional logic in one place
- Supports all component types (widget, drag, reveal, button)

**Implementation Details:**

1. **Single computation function per component type** ✅
   - `Styles.computeWidgetColors(state, thing_color, background_color)` → `{ color, background_color, border }`
   - `Styles.computeDotColors(state, element_color, thing_color, background_color, hoverColor)` → `{ fill, stroke, svg_outline_color }`
   - `Styles.computeButtonColors(state, element_color, background_color, hoverColor, disabledTextColor, border_thickness, has_widget_context, thing_color)` → `{ fill, stroke, border }`

2. **State object pattern** ✅
   - `S_Snapshot` class (`src/lib/ts/state/S_Snapshot.ts`) - "state of go" - transient state of user attention/intention
   - Encapsulates all state flags needed for color computation
   - Constructor accepts `S_Hit_Target | Identifiable | undefined` plus optional flags
   - Getters provide: `hover`, `grabbed`, `editing`, `focus`, `thing_color`
   - Special hover logic: for widgets, also checks if title with same ancestry is hovered

3. **Getters are thin wrappers** ✅
   - `S_Element`/`S_Widget` getters create `S_Snapshot` instance and call `Styles` methods
   - Components remain reactive via getter pattern
   - Logic centralized in `Styles`, state collected in `S_Snapshot`

4. **Preserve reactive behavior** ✅
   - Getters still reactive - Svelte tracks dependencies
   - No changes to component reactive blocks needed
   - All color logic testable in isolation

**Benefits:**
- Single source of truth for color computation
- Easier to modify color behavior globally
- Testable in isolation
- Reduces code duplication
- Clearer separation of concerns

### Impact on State Objects

**S_Hit_Target (base class):**
- **Keep**: `hoverColor`, `element_color`, `set_forHovering()` - these provide inputs to Styles
- **Keep**: `isHovering` getter - needed for state collection
- **No change**: Hit testing and cursor logic remain here

**S_Element (Implemented):**
- **Kept as inputs**: `color_background`, `isDisabled`, `isSelected`, `isInverted`, `subtype`
- **Getters now call Styles**: `fill`, `stroke`, `svg_outline_color`, `border` create `S_Snapshot` and call `Styles.computeDotColors()` or `Styles.computeButtonColors()`
- **Helper getters**: `s_go`, `thing_color`, `dotColors_forElement`, `buttonColors_forElement` reduce duplication
- **Removed**: Old inline color logic from getters
- **Actual implementation:**
  ```typescript
  get fill(): string {
    if (this.asTransparent) {
      return 'transparent';
    } else if (this.isADot) {
      return this.dotColors_forElement.fill;
    } else if (this.isAControl) {
      return this.buttonColors_forElement.fill;
    } else {
      return this.color_isInverted ? this.hoverColor : this.isSelected ? 'lightblue' : this.color_background;
    }
  }
  ```

**S_Widget (Implemented):**
- **Getters now call Styles**: `color`, `background_color`, `border` create `S_Snapshot` and call `Styles.computeWidgetColors()`
- **Removed**: `colorFor_grabbed_andEditing()`, `isFilled`, `shows_border`, `isRadial_focus` helper methods
- **Actual implementation:**
  ```typescript
  get color(): string {
    const state = new S_Snapshot(this, this.isDisabled, this.isSelected, this.isInverted, this.subtype);
    return Styles.computeWidgetColors(state, this.thing_color, get(colors.w_background_color)).color;
  }
  ```

**State Collection Pattern:**
- Each getter collects relevant state from `this`, `this.ancestry`, and stores
- Passes complete `S_Snapshot` state object to Styles
- Styles handles all conditional logic
- State objects become data containers + thin computation wrappers

**S_Snapshot (Implemented):**

The `S_Snapshot` class (`src/lib/ts/state/S_Snapshot.ts`) - "state of go for style" - represents the transient state of user attention/intention. It's a snapshot of flags and relevances needed for style (for now, color) computation:

```typescript
export default class S_Snapshot {
  hit_target?: S_Hit_Target;      // Hit target for hover detection (includes type + identifiable)
  identifiable?: Identifiable;     // Provides: isGrabbed, isEditing, isFocus, thing.color
  isInverted?: boolean;
  isDisabled?: boolean;
  isSelected?: boolean;
  subtype?: string;                // For special cases (e.g., T_Control.details)

  constructor(hit_target: S_Hit_Target | Identifiable | undefined, 
              isDisabled?: boolean, 
              isSelected?: boolean, 
              isInverted?: boolean, 
              subtype?: string)

  // Getters:
  get hover(): boolean             // Checks hit_target.isHovering or compares identifiable.id with hits.w_s_hover
  get grabbed(): boolean           // Returns ancestry?.isGrabbed ?? false
  get editing(): boolean           // Returns ancestry?.isEditing ?? false
  get focus(): boolean             // Returns ancestry?.isFocus ?? false
  get thing_color(): string        // Returns ancestry?.thing?.color ?? k.empty
}
```

**Key characteristics:**
- **"State of go"** - Represents transient user attention/intention state (hover, grab, edit, focus)
- Constructor accepts `S_Hit_Target` or `Identifiable` - handles both patterns
- `hover` getter has special logic: for widgets, checks if title with same ancestry is hovered (fixes widget title hover bug)
- `grabbed`, `editing`, `focus`, `thing_color` safely accessed via `ancestry` getter (casts `identifiable` to `Ancestry`)
- State object is created fresh on each getter call (no caching needed due to Svelte reactivity)
- All properties are optional except those provided by getters

## Standardize state transitions

## Document color inheritance rules

### Color Sources

Colors are sourced from different places depending on the color type and component:

| Color Type | Source | Used By | Notes |
|------------|--------|---------|-------|
| `thing_color` | `ancestry.thing?.color` | Widget, Drag, Reveal | Inherited from the Thing object associated with the ancestry |
| `element_color` | Set via `set_forHovering(color, cursor)` | Drag, Reveal, Button | Set explicitly per component, typically matches `thing.color` |
| `background_color` | `colors.w_background_color` store | All components | Global background color, shared across entire UI |
| `hoverColor` | `colors.hover_special_blend(element_color)` | Drag, Reveal, Button | Computed from `element_color` when hover state detected |

### Inheritance Patterns

**Thing Color Inheritance:**
- Widgets, drag dots, and reveal dots inherit their base color from `ancestry.thing.color`
- Accessed via `S_Snapshot.thing_color` getter
- If no thing exists, defaults to `k.empty` (empty string)
- This is the primary color identity for a widget/item

**Element Color Pattern:**
- Drag and reveal components call `set_forHovering(thing.color, cursor)` to set `element_color`
- Buttons use their own `element_color` (may differ from thing color)
- `element_color` is the base stroke/outline color when not hovered
- Set once per component instance (not reactive to thing color changes)

**Hover Color Computation:**
- `hoverColor` is computed from `element_color` via `colors.hover_special_blend()`
- Same computation for all components (drag, reveal, button)
- Computed on-demand when needed (via `S_Hit_Target.hoverColor` getter)

**Background Color:**
- All components share the same global background from `colors.w_background_color` store
- Reactive - changes propagate to all components automatically
- Used for fill colors and contrast calculations

### Inheritance Rules

1. **Thing color flows from Ancestry:**
   - `ancestry.thing.color` → `S_Snapshot.thing_color` → `Styles` computation functions
   - Widgets always use thing color for text/base color
   - Dots use thing color for outline color (when not grabbed/editing)

2. **Element color is component-specific:**
   - Each component sets its own `element_color` via `set_forHovering()`
   - Not inherited from parent/ancestry
   - Typically matches `thing.color` but can differ (e.g., buttons)

3. **Background color is global:**
   - Single source: `colors.w_background_color` store
   - No inheritance - all components read from same store
   - Changes affect entire UI simultaneously

4. **Hover color is computed, not inherited:**
   - Derived from `element_color`, not inherited
   - Computation is consistent: `colors.hover_special_blend(element_color)`
   - Same algorithm for all components

### No True Inheritance Hierarchy

**Important:** Unlike DOM CSS inheritance, colors do NOT cascade from parent to child:
- Child widgets do not inherit colors from parent widgets
- Each component independently computes its colors based on its own state
- Shared colors (like background) come from global stores, not parent components

**Color Relationships:**
```
ancestry.thing.color  →  thing_color  →  Styles.compute...Colors()
         ↓
    (set via set_forHovering)
         ↓
   element_color  →  hoverColor (computed)  →  Styles.compute...Colors()

colors.w_background_color (global store)  →  Styles.compute...Colors()
```

### Current Implementation Status

✅ **Implemented correctly:**
- Thing color accessed via `S_Snapshot.thing_color` getter (safe null handling)
- Element color set explicitly per component
- Background color from global store
- Hover color computed consistently

**No changes needed** - Current implementation follows clear patterns without problematic inheritance hierarchies.

### Current State Flow

Color states transition based on user interactions and system events. Each state is independent but can combine to produce the final color output.

**State Sources:**

1. **hover** - From `hits.w_s_hover` store, managed by `Hits` manager
   - Transitions: `none → hover` (mouse enters), `hover → none` (mouse leaves)
   - Detected via hit testing on mouse move
   - Persists while mouse over element

2. **grabbed** - From `ancestry.isGrabbed`, managed by `x.si_grabs` (UX manager)
   - Transitions: `none → grabbed` (item grabbed), `grabbed → none` (item released)
   - Set via `ancestry.grab()` methods
   - Persists until explicitly released

3. **editing** - From `ancestry.isEditing`, managed by `s.w_s_title_edit` (Stores)
   - Transitions: `none → editing` (edit starts), `editing → none` (edit stops)
   - Set when title editing begins
   - Persists until edit completes/cancels

4. **focus** - From `ancestry.isFocus`, managed by `s.w_ancestry_focus` (Stores)
   - Transitions: `none → focus` (focus set), `focus → none` (focus changes)
   - Set via `ancestry.becomeFocus()`
   - Single focus at a time (moving focus clears previous)

5. **selected** - From `isSelected` property on `S_Element`
   - Transitions: `none → selected` (selection set), `selected → none` (deselected)
   - Used for buttons in selection contexts
   - Component-level state (not ancestry-based)

6. **disabled** - From `isDisabled` property on `S_Element`
   - Transitions: `none → disabled` (disabled set), `disabled → none` (enabled)
   - Component-level state
   - Typically static per component instance

**State Transitions:**

| State | On | Off |
|-------|----|----|
| `hover` | Mouse enters element | Mouse leaves element |
| `grabbed` | Item grabbed (`ancestry.grab()`) | Item released |
| `editing` | Editing starts | Editing stops |
| `focus` | Focus set (`ancestry.becomeFocus()`) | Focus changes to another item |
| `selected` | `isSelected = true` | `isSelected = false` |
| `disabled` | `isDisabled = true` | `isDisabled = false` |

**Notes:**
- All states can combine simultaneously (e.g., `hover + grabbed + editing`)
- States transition independently - no coordination needed between state managers
- Color computation in `Styles.ts` handles all state combinations with proper priority

**State Collection Pattern:**

States are collected via `S_Snapshot` getters which read from:
- `hover`: `S_Hit_Target.isHovering` → `hits.w_s_hover` store
- `grabbed`: `ancestry.isGrabbed` → `x.si_grabs` (UX manager)
- `editing`: `ancestry.isEditing` → `s.w_s_title_edit` (Stores)
- `focus`: `ancestry.isFocus` → `s.w_ancestry_focus` (Stores)
- `selected`: `this.isSelected` (component property)
- `disabled`: `this.isDisabled` (component property)

**Current Implementation:**

✅ States are collected reactively in getters
✅ `S_Snapshot` provides unified access to all states
✅ `Styles` computation functions handle all state combinations
✅ No state transition coordination needed - each state is independent

### Migration Strategy

**Current State:**
- State transitions are handled by respective managers/stores
- No centralized state transition logic
- States transition independently
- Color computation handles all combinations

**Potential Improvements:**

1. **State Transition Events**
   - Consider emitting events when states transition
   - Could enable analytics/logging
   - Could trigger side effects
   - **Recommendation**: Not needed for color management alone

2. **State Validation**
   - Validate impossible combinations (e.g., disabled + editing)
   - **Recommendation**: Handle in `Styles` computation if needed (currently not an issue)

3. **State Transition Hooks**
   - Allow components to react to state transitions
   - **Recommendation**: Use existing reactive patterns (Svelte reactivity already handles this)

4. **State History/Debouncing**
   - Track state transition history
   - Debounce rapid transitions
   - **Recommendation**: Not needed - current reactive system handles rapid changes

**Migration Steps (if needed):**

If we need to standardize state transitions in the future:

1. **Define State Transition Interface**
   ```typescript
   interface StateTransition {
     from: string;
     to: string;
     timestamp: number;
     source: string;  // 'hover', 'grab', 'edit', 'focus', etc.
   }
   ```

2. **Add Transition Tracking (Optional)**
   - Track transitions in respective managers
   - Log or emit events
   - Use for debugging/analytics

3. **Add Transition Validation (Optional)**
   - Validate transitions in `Styles` computation
   - Handle edge cases (e.g., disabled + editing)

4. **Add Transition Hooks (Optional)**
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/persistable.md
```md
# Persistable Pattern Architecture

All persistent data entities in Webseriously extend the `Persistable` base class, providing a unified interface for database operations, serialization, and identity management.

## Table of Contents
- [Overview](#overview)
- [Why Persistable?](#why-persistable)
- [Persistable Models](#persistable-models)
- [Core Features](#core-features)
- [Serialization](#serialization)
- [Database Operations](#database-operations)
- [Identity and Hashing](#identity-and-hashing)
- [Lifecycle](#lifecycle)
- [Best Practices](#best-practices)

## Overview

`Persistable` is an abstract base class that provides:
- **Unique hash-based IDs** - Deterministic, content-based identification
- **CRUD abstraction** - Database-agnostic persistence
- **Serialization** - Convert to/from database formats
- **Dirty tracking** - Know when data needs saving
- **Type safety** - Strongly-typed data models

## Why Persistable?

### Problems Solved

1. **Inconsistent IDs** - Different entities had different ID schemes
2. **Database Coupling** - Data models were tied to specific databases
3. **Serialization Duplication** - Each model reimplemented JSON conversion
4. **Dirty Tracking** - No unified way to know what needs saving
5. **Type Safety** - Loose coupling between data and types

### Benefits

- **Single ID Scheme** - All entities use hash-based IDs
- **Database Agnostic** - Works with Firebase, Airtable, Local, Bubble, Test
- **DRY Serialization** - Shared serialization logic
- **Automatic Dirty Tracking** - Persistence layer knows what changed
- **Type Safety** - TypeScript enforces data model contracts

## Persistable Models

| Model | Purpose | Key Fields |
|-------|---------|------------|
| `Access` | User access permissions | user_id, thing_id, permission_level |
| `Persistable` | Base class (abstract) | id, isDirty, t_persistable |
| `Predicate` | Relationship predicates/types | title, description |
| `Relationship` | Typed links between Things | subject_id, predicate_id, object_id |
| `Tag` | Categorization labels | title, color |
| `Thing` | Hierarchical nodes | title, parent_id, traits |
| `Trait` | Key-value properties | thing_id, key, value |
| `User` | User accounts and authentication | email, name, avatar_url |

## Core Features

### 1. Hash-Based IDs

Every Persistable has a unique, deterministic ID based on its content:

```typescript
abstract class Persistable {
    id: string;  // SHA-256 hash of fields
    
    get hid(): string {
        return this.id.substring(0, k.hashLength);
    }
}
```

**Example**:
```typescript
const thing = new Thing('My Thing', parent);
console.log(thing.id);   // Full hash: "a3b2c1d4e5f6..."
console.log(thing.hid);  // Short hash: "a3b2c1"
```

### 2. Type Identification

Each model has a type identifier:

```typescript
enum T_Persistable {
    access = 'Access',
    predicate = 'Predicate',
    relationship = 'Relationship',
    tag = 'Tag',
    thing = 'Thing',
    trait = 'Trait',
    user = 'User'
}

class Thing extends Persistable {
    t_persistable = T_Persistable.thing;
}
```

### 3. Dirty Tracking

Models track when they've been modified:

```typescript
class Thing extends Persistable {
    private _title: string;
    
    get title(): string {
        return this._title;
    }
    
    set title(value: string) {
        this._title = value;
        this.isDirty = true;  // Mark as needing persistence
    }
}
```

### 4. Database Abstraction

Single method for persistence across all databases:

```typescript
abstract class Persistable {
    abstract persistent_create_orUpdate(already_persisted: boolean): Promise<void>;
}

class Thing extends Persistable {
    async persistent_create_orUpdate(already_persisted: boolean) {
        if (already_persisted) {
            await databases.db_now.thing_persistentUpdate(this);
        } else {
            await databases.db_now.thing_remember_persistentCreate(this);
        }
    }
}
```

## Serialization

### fields Getter

Each model implements a `fields` getter for database serialization:

```typescript
class Thing extends Persistable {
    get fields(): Airtable.FieldSet {
        return {
            id: this.id,
            title: this.title,
            parent_id: this.parent?.id ?? k.empty,
            created_at: this.created_at,
            updated_at: this.updated_at
        };
    }
}
```

### json Getter

JSON representation for local storage:

```typescript
class Thing extends Persistable {
    get json(): any {
        return {
            id: this.id,
            title: this.title,
            parent_id: this.parent?.id,
            traits: this.traits.map(t => t.json)
        };
    }
}
```

### Database-Specific Formats

Different databases require different formats:

**Firebase/Local**:
```typescript
{
    id: "abc123",
    title: "My Thing",
    parent_id: "parent123"
}
```

**Airtable**:
```typescript
{
    id: "abc123",
    title: "My Thing",
    parent: ["rec123"]  // Array of record IDs
}
```

**Bubble**:
```typescript
{
    _id: "abc123",
    title: "My Thing",
    parent_thing: "parent123"
}
```

## Database Operations

### Create

```typescript
// Hierarchy manager creates and persists
const thing = h.thing_create('My Thing', parent);

// Internally calls
await thing.persistent_create_orUpdate(false);
  → databases.db_now.thing_remember_persistentCreate(thing)
```

### Read

```typescript
// Load from database
await databases.db_now.fetch_all();

// Hierarchy manager remembers entities
h.thing_remember(thing);
```

### Update

```typescript
// Modify entity
thing.title = 'New Title';  // Sets isDirty = true

// Persist changes
await databases.db_now.persist_all();
  → thing.persistent_create_orUpdate(true)
  → databases.db_now.thing_persistentUpdate(thing)
```

### Delete

```typescript
// Hierarchy manager deletes
h.thing_delete(thing);

// Internally calls
await thing.persistent_delete();
  → databases.db_now.thing_persistentDelete(thing)
```

## Identity and Hashing

### ID Generation

IDs are SHA-256 hashes of content:

```typescript
class Thing extends Persistable {
    constructor(title: string, parent: Thing | null) {
        super();
        this._title = title;
        this.parent = parent;
        this.id = this.compute_id();  // Hash based on title + parent
    }
    
    private compute_id(): string {
        const content = `${this.title}|${this.parent?.id ?? ''}`;
        return sha256(content);
    }
}
```

### Short IDs (HIDs)

For display purposes, use short hash IDs:

```typescript
const thing = h.thing_forHID('a3b2c1');  // Short ID lookup
console.log(thing?.hid);  // "a3b2c1"
console.log(thing?.id);   // "a3b2c1d4e5f6g7h8i9..."
```

### ID Stability

IDs are deterministic and stable:
- Same content → same ID
- Content changes → new ID
- Allows offline-first sync

## Lifecycle

### 1. Creation
```typescript
const thing = new Thing('My Thing', parent);
  → Computes ID from content
  → Sets isDirty = true
  → Ready for persistence
```

### 2. Remembering
```typescript
h.thing_remember(thing);
  → Adds to hierarchy
  → Indexes by ID
  → Available for lookup
```

### 3. Modification
```typescript
thing.title = 'Updated';
  → Sets isDirty = true
  → Triggers persistence
```

### 4. Persistence
```typescript
await databases.db_now.persist_all();
  → Finds dirty entities
  → Calls persistent_create_orUpdate()
  → Saves to database
  → Sets isDirty = false
```

### 5. Deletion
```typescript
h.thing_delete(thing);
  → Removes from hierarchy
  → Calls persistent_delete()
  → Deletes from database
```

## Model Details

### Thing
**Purpose**: Hierarchical nodes in the tree

**Key Fields**:
- `title` - Display name
- `parent` - Parent Thing (null for root)
- `traits` - Array of Trait objects
- `tags` - Array of Tag objects

**Relations**:
- Parent-child hierarchy
- One-to-many Traits
- Many-to-many Tags

**Example**:
```typescript
const parent = h.thing_create('Parent', null);
const child = h.thing_create('Child', parent);
h.trait_create(child, 'color', 'blue');
```

### Trait
**Purpose**: Key-value properties attached to Things

**Key Fields**:
- `thing` - Parent Thing
- `key` - Property name
- `value` - Property value

**Relations**:
- Belongs to one Thing

**Example**:
```typescript
const trait = h.trait_create(thing, 'status', 'active');
console.log(trait.key);    // "status"
console.log(trait.value);  // "active"
```

### Tag
**Purpose**: Categorization labels

**Key Fields**:
- `title` - Tag name
- `color` - Visual color
- `things` - Array of tagged Things

**Relations**:
- Many-to-many with Things

**Example**:
```typescript
const tag = h.tag_create('Important');
h.tag_add_toThing(tag, thing);
```

### Predicate
**Purpose**: Relationship types/predicates

**Key Fields**:
- `title` - Relationship type name
- `description` - Optional description

**Relations**:
- Used by Relationships

**Example**:
```typescript
const predicate = h.predicate_create('depends_on');
```

### Relationship
**Purpose**: Typed links between Things

**Key Fields**:
- `subject` - Source Thing
- `predicate` - Relationship type
- `object` - Target Thing

**Relations**:
- Subject: one Thing
- Object: one Thing
- Predicate: one Predicate

**Example**:
```typescript
const rel = h.relationship_create(task, depends_on, library);
// task depends_on library
```

### User
**Purpose**: User accounts and authentication

**Key Fields**:
- `email` - User email
- `name` - Display name
- `avatar_url` - Profile image

**Example**:
```typescript
const user = new User('user@example.com', 'John Doe');
```

### Access
**Purpose**: User permissions for Things

**Key Fields**:
- `user` - User with access
- `thing` - Thing being accessed
- `permission_level` - Read/write/admin

**Example**:
```typescript
const access = new Access(user, thing, 'write');
```

## Best Practices

### ✅ DO

- **Use hierarchy manager methods** - `h.thing_create()`, not `new Thing()`
- **Let persistence happen automatically** - Don't manually call `persist_all()`
- **Use HIDs for display** - Shorter, more readable
- **Implement fields getter** - Required for database serialization
- **Mark properties dirty** - Set `isDirty = true` when modifying
- **Use type enums** - `T_Persistable.thing`, not string literals

### ❌ DON'T

- **Create Persistables directly** - Use manager factory methods
- **Modify ID after creation** - IDs are immutable
- **Skip dirty tracking** - Persistence depends on it
- **Forget to implement abstract methods** - `persistent_create_orUpdate()` required
- **Assume synchronous persistence** - Database ops are async
- **Mix database-specific logic** - Keep it in DB_* implementations

## Examples

### Example 1: Creating a Thing Hierarchy
```typescript
import { h } from '../common/Global_Imports';

// Create root
const root = h.thing_create('Projects', null);

// Create children
const web = h.thing_create('Web App', root);
const mobile = h.thing_create('Mobile App', root);

// Add traits
h.trait_create(web, 'status', 'active');
h.trait_create(web, 'priority', 'high');

// Get ancestry
const ancestry = h.ancestry_forThing(web);
console.log(ancestry.breadcrumbs);  // "Projects > Web App"
```

### Example 2: Tagging
```typescript
import { h } from '../common/Global_Imports';

// Create tag
const urgent = h.tag_create('Urgent');
urgent.color = '#ff0000';

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/reactivity.md
```md
# Svelte 4 State Management

How reactivity works in Svelte 4. Not about stores, not about Svelte 5 runes. Just plain old component state.

## The Problem

i keep seeing confusing patterns in our codebase. Sometimes we use `let`, sometimes `const`, sometimes reactive statements. When does Svelte actually track changes? When do components re-render?

Needed a guide to clarify how Svelte 4 reactivity actually works.

## Svelte 4 Basics

There's no `$state` in Svelte 4. That's Svelte 5. In Svelte 4, reactivity is simpler (and weirder).

### Component State

**Top-level `let` is reactive:**
```svelte
<script>
let count = 0;  // Reactive!
</script>

<button on:click={() => count += 1}>
  {count}
</button>
```

Svelte compiles this and watches `count`. When it changes, the component re-renders.

**Nested properties are NOT reactive:**
```svelte
<script>
let user = { name: 'Jonathan' };

function updateName() {
  user.name = 'Jon';  // Does NOT trigger re-render!
}
</script>
```

Need to reassign the whole object:
```svelte
function updateName() {
  user = { ...user, name: 'Jon' };  // This works
}
```

Or use the assignment trick:
```svelte
function updateName() {
  user.name = 'Jon';
  user = user;  // Force Svelte to notice
}
```

### Props

**Props are reactive inputs:**
```svelte
<script>
export let title;      // Prop
export let count = 0;  // Prop with default
</script>

<h1>{title}</h1>
<p>{count}</p>
```

When parent changes the prop, child re-renders automatically.

**Don't mutate props:**
```svelte
<script>
export let items = [];

// BAD - mutates prop
function addItem(item) {
  items.push(item);
}

// GOOD - create new array
function addItem(item) {
  items = [...items, item];
}
</script>
```

### Reactive Statements

**The magic `$:` label:**
```svelte
<script>
let count = 0;

$: doubled = count * 2;  // Re-runs when count changes
</script>

<p>{count} doubled is {doubled}</p>
```

**Reactive blocks:**
```svelte
<script>
let firstName = 'Jonathan';
let lastName = 'Sand';

$: {
  console.log('Name changed!');
  const fullName = `${firstName} ${lastName}`;
}
</script>
```

**Dependencies are implicit:**
Svelte analyzes your code and tracks what variables you read:
```svelte
$: result = a + b;  // Depends on a and b
```

**The trick we use everywhere:**
```svelte
$: {
  const _ = `${$w_grabbed}:::${$w_ancestry_focus}`;
  update();
}
```

This forces Svelte to track stores by reading them. The `_` variable is thrown away, but Svelte sees the dependencies.

### Stores

**Stores are external reactive values:**
```svelte
<script>
import { writable } from 'svelte/store';

const count = writable(0);

// Subscribe manually
const unsubscribe = count.subscribe(value => {
  console.log(value);
});

// Or use $ prefix (auto-subscribe)
$: console.log($count);
</script>

<button on:click={() => $count += 1}>
  {$count}
</button>
```

The `$` prefix creates an auto-subscription. Svelte unsubscribes when component unmounts.

### When Components Re-render

**Svelte re-renders when:**
1. A reactive variable changes (top-level `let`)
2. A prop changes (parent updates)
3. A store updates (via `$` subscription)
4. A reactive statement's dependencies change

**Svelte does NOT re-render when:**
1. Nested object properties change (unless you reassign)
2. Array methods mutate in place (unless you reassign)
3. You change a `const` variable (impossible anyway)
4. You update DOM directly (don't do this)

## Patterns in Our Codebase

### Pattern 1: Manual Trigger

We use this all over:
```svelte
let trigger = 0;

$: {
  const _ = `${$store1}:::${$store2}`;
  update();
}

function update() {
  // ... recalculate stuff ...
  trigger = someValue;  // Change to force re-render
}
```

Then wrap template in `{#key trigger}`:
```svelte
{#key trigger}
  <div>...</div>
{/key}
```

This forces a complete re-render when trigger changes.

**Why we do this:** Sometimes child components have internal state that needs to reset. The `{#key}` block destroys and recreates everything inside.

### Pattern 2: Store Destructuring

```svelte
const { w_t_breadcrumbs } = show;
const { w_ancestry_focus } = x;
```

Destructure stores once, then use `$w_t_breadcrumbs` everywhere.

**Benefit:** Cleaner code, fewer imports.

### Pattern 3: Reactive Dependency Tracking

```svelte
$: {
  const _ = `${u.descriptionBy_titles($w_grabbed)}
  :::${$w_rect_ofGraphView.description}
  :::${$w_ancestry_focus?.id}`;
  update();
}
```

Build a string with all dependencies. Forces Svelte to track everything. Then call update function.

**Why the string?** Because Svelte only tracks variables you READ in the reactive block. If update() reads stores internally, Svelte won't see them. So we force it by reading them here.

### Pattern 4: Const for Non-Reactive

```svelte
const size = k.height.button;
const hamburger_path = svgPaths.hamburgerPath(size);
```

Use `const` when the value never changes. Clear signal to other developers: "This won't be reactive."

## Common Mistakes

### Mistake 1: Forgetting Reassignment

```svelte
let items = [];

// WRONG
function addItem(item) {
  items.push(item);  // Mutates, doesn't trigger re-render
}

// RIGHT
function addItem(item) {
  items = [...items, item];  // New array, triggers re-render
}
```

### Mistake 2: Nested Reactivity

```svelte
let state = {
  user: { name: 'Jonathan' },
  count: 0
};

// WRONG
state.count += 1;  // Doesn't re-render

// RIGHT
state = { ...state, count: state.count + 1 };
```

### Mistake 3: Missing Dependencies

```svelte
let a = 1;
let b = 2;

$: result = a + b;  // Correct - depends on a and b

$: result = calculate();  // WRONG if calculate() uses a or b
                          // Svelte can't see inside functions
```

Fix:
```svelte
$: result = calculate(a, b);  // Pass dependencies as params
```

Or:
```svelte
$: {
  const _ = `${a}:::${b}`;  // Read them explicitly
  result = calculate();
}
```

### Mistake 4: Store Without $

```svelte
const count = writable(0);

// WRONG
{count}  // Displays "[object Object]"

// RIGHT
{$count}  // Displays the value
```

## Svelte 4 vs Svelte 5

**Svelte 4:** Reactive variables, `$:` statements, `$` store prefix
**Svelte 5:** `$state()`, `$derived()`, `$props()` runes

We're on Svelte 4. No runes yet. When we upgrade, reactivity will work differently.

**What stays the same:** Props, stores, lifecycle (mostly)
**What changes:** Component state becomes explicit with runes

## Summary

Svelte 4 reactivity:
- Top-level `let` is reactive
- Nested changes need reassignment
- `$:` creates reactive statements
- `$store` auto-subscribes
- `{#key}` forces re-render

Our patterns:
- Manual triggers for child component resets
- Store destructuring for cleaner imports
- Explicit dependency strings for complex reactivity
- `const` for non-reactive values

The weirdness:
- Implicit dependency tracking (Svelte analyzes your code)
- Nested mutations don't work (need reassignment)
- Can't track inside function calls (need explicit reads)

When in doubt, reassign the whole thing. Svelte will notice.
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/timers.md
```md
# Timers

Mouse timing logic centralized in Hits manager. Components declare intent ("I need autorepeat"), manager handles lifecycle. State survives re-renders because it lives on the target, not the component.

## Table of Contents
- [Overview](#overview)
  - [Before: Distributed Timing](#before-distributed-timing)
  - [After: Centralized Timing](#after-centralized-timing)
  - [Core Principles](#core-principles)
- [T_Mouse_Detection Enum](#t_mouse_detection-enum)
- [State Management](#state-management)
- [Event Flow](#event-flow)
  - [handle_click_at Flow](#handle_click_at-flow)
  - [Cleanup on Hover-Leave](#cleanup-on-hover-leave)
- [Timing Types](#timing-types)
  - [Autorepeat](#autorepeat)
  - [Long-Click](#long-click)
  - [Double-Click](#double-click)
  - [Click Counting](#click-counting)
- [Component Migration Notes](#component-migration-notes)
  - [Glow_Button.svelte](#glow_buttonsvelte--low-risk-)
  - [Button.svelte](#buttonsvelte--medium-risk-)
  - [Next_Previous.svelte](#next_previoussvelte--medium-high-risk-)
  - [D_Actions.svelte](#d_actionssvelte--high-risk-)
- [Testing](#testing)
  - [Autorepeat](#autorepeat-1)
  - [Double-Click](#double-click-1)
  - [Long-Click](#long-click-1)
- [Risks & Mitigation](#risks--mitigation)
- [Session Notes](#session-notes)
  - [Button Styling Fixes](#button-styling-fixes)
  - [Close Button Hit Testing](#close-button-hit-testing-unresolved)
  - [Documentation Patterns](#documentation-patterns)

---

## Overview

### Before: Distributed Timing
```
Component → Own Timer → Manual Start/Stop → Component State
```
- Each component manages its own timer lifecycle
- State lives in component (lost on re-render)
- Duplicated logic across components
- Manual hover-leave handling per component

### After: Centralized Timing
```
Component → Declares Intent → Central Manager → Automatic Lifecycle
```
- Single manager owns all timers
- State persists on shared target (survives re-render)
- Logic centralized in one place
- Automatic hover-leave cleanup

### Core Principles

1. **Declaration Over Management** — Components set properties (`mouse_detection`, `*_callback`), manager handles timing automatically
2. **State Persistence** — Timing state lives on target (`autorepeat_event`, `autorepeat_isFirstCall`, `clicks`), not component
3. **Enum-Based Configuration** — Single enum replaces multiple boolean flags, enforces mutual exclusivity
4. **Automatic Lifecycle** — Mouse down starts timers, mouse up/hover-leave cancels them
5. **Single Source of Truth** — One manager, one timer per timing type

---

## T_Mouse_Detection Enum

The `T_Mouse_Detection` enum (in `Enumerations.ts`) uses bit flags:

```ts
export enum T_Mouse_Detection {
    autorepeat = 4,  // Mutually exclusive with others
    doubleLong = 3,  // double | long (can combine these two)
    double     = 1,
    long       = 2,
    none       = 0,
}
```

`S_Hit_Target` uses a single `mouse_detection` property:

```ts
// S_Hit_Target.ts
mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
longClick_callback?: (s_mouse: S_Mouse) => void;
doubleClick_callback?: (s_mouse: S_Mouse) => void;
clicks: number = 0;

// Getters for Hits logic
get detects_autorepeat(): boolean { return this.mouse_detection === T_Mouse_Detection.autorepeat; }
get detects_longClick(): boolean { return (this.mouse_detection & T_Mouse_Detection.long) !== 0; }
get detects_doubleClick(): boolean { return (this.mouse_detection & T_Mouse_Detection.double) !== 0; }
```

Components pass `mouse_detection={T_Mouse_Detection.autorepeat}` instead of `detect_autorepeat={true}`.

---

## State Management

`Hits` manages centralized timing with:

| Store/Property | Purpose |
|----------------|---------|
| `w_autorepeat` | Target currently autorepeating |
| `w_longClick` | Target waiting for long-click |
| `autorepeat_timer` | Single `Mouse_Timer` for autorepeat |
| `click_timer` | Single `Mouse_Timer` for long-click and double-click |
| `pending_singleClick_target` | Target with deferred single-click (double-click detection) |
| `pending_singleClick_event` | MouseEvent for deferred single-click |
| `longClick_fired` | Flag to suppress mouse-up after long-click |
| `doubleClick_fired` | Flag to suppress mouse-up after double-click timer expires |

---

## Event Flow

### handle_click_at Flow

**On mouse down:**
- Increment `target.clicks`
- If `target.detects_longClick` → start long-click timer, store pending target/event
- If `target.detects_doubleClick`:
  - If second click within threshold → fire `doubleClick_callback`, cancel timer
  - If first click → start double-click timer, defer single-click
- If `target.detects_autorepeat` → start autorepeat
- If no special detection → fire `handle_s_mouse` immediately

**On mouse up:**
- Cancel long-click timer
- Stop autorepeat
- Reset `target.clicks`
- If long-click already fired or double-click timer already fired → suppress regular click
- Otherwise → fire `handle_s_mouse`

**When long-click timer fires:**
- Fire `longClick_callback` with `S_Mouse.long(...)`
- Set `longClick_fired` flag to suppress subsequent mouse-up

**When double-click timer expires:**
- User didn't click again → fire deferred single-click callback
- Reset `target.clicks`
- Set `doubleClick_fired` flag to suppress subsequent mouse-up click

### Cleanup on Hover-Leave

In `detect_hovering_at`, cancel pending timers if mouse leaves the target:
- If hover leaves the autorepeating target → stop autorepeat
- If hover leaves the long-click target → cancel long-click timer
- If hover leaves the pending double-click target → cancel double-click timer

---

## Timing Types

### Autorepeat

Buttons repeatedly fire their action while held down.

**Originally per-component:**
1. Each component got its own `Mouse_Timer` via `e.mouse_timer_forName(name)`
2. On `s_mouse.isDown`, called `mouse_timer.autorepeat_start(id, callback)`
3. On `s_mouse.isUp` or hover leave, called `mouse_timer.autorepeat_stop()`
4. Visual feedback via `mouse_timer.isAutorepeating_forID(id)`

**Now centralized in Hits:**
1. `Hits` owns `autorepeat_timer` plus `w_autorepeat` store
2. Components set properties on `S_Hit_Target`:
   - `mouse_detection = T_Mouse_Detection.autorepeat`
   - `autorepeat_callback?: () => void`
   - `autorepeat_id?: number`
   - `autorepeat_event?: MouseEvent` (persists across component recreation)
   - `autorepeat_isFirstCall: boolean`
3. Hits starts/stops autorepeat on mouse down/up
4. Visual feedback from `w_autorepeat` store

**Components using autorepeat:**

| Component | Pattern | Notes |
|-----------|---------|-------|
| `Glow_Button.svelte` | `mouse_detection={T_Mouse_Detection.autorepeat}` | ✅ Migrated |
| `Button.svelte` | `mouse_detection` prop | ✅ Migrated |
| `Next_Previous.svelte` | Always enabled | ✅ Migrated; each button has its own `S_Element` |
| `D_Actions.svelte` | `mouse_detection={T_Mouse_Detection.autorepeat}` | ✅ Migrated |
| `Steppers.svelte` | `mouse_detection={T_Mouse_Detection.autorepeat}` | ✅ Migrated |

### Long-Click

Fires after ~500ms threshold, suppresses subsequent mouse-up click. Centralized in `Hits` with `w_longClick` store, using `click_timer`.

### Double-Click

Defers single-click ~200ms, fires double-click on second click within threshold. Centralized in `Hits` using `click_timer`.

### Click Counting

Moved from `S_Mouse.clicks` (deprecated) to `S_Hit_Target.clicks`. Centralized in `Hits` — increments on down, resets on up or double-click.

---

## Component Migration Notes

### Glow_Button.svelte — Low Risk ✅

**Migration:**
- Removed `Mouse_Timer` instance
- Removed autorepeat start/stop calls
- Removed hover leave reactive statement
- Set `s_element.detect_autorepeat`, `autorepeat_callback`, `autorepeat_id` in `onMount`
- Updated CSS class to use `w_autorepeat` store

**Result:** ~20 lines of autorepeat logic → 4 lines of property setup

### Button.svelte — Medium Risk ✅

**Complexity:**
- Supports `autorepeat`, `long`, `double`, `doubleLong`
- Uses `S_Mouse.repeat()` vs `S_Mouse.down()` distinction
- Exposes `handle_s_mouse` prop, wraps in `intercept_handle_s_mouse`

**Migration:**
- Removed autorepeat start/stop calls
- Autorepeat callback uses `autorepeat_isFirstCall` flag to distinguish initial vs repeat
- Captures mouse event on down for autorepeat callbacks
- LongClick handling remains component-managed

### Next_Previous.svelte — Medium-High Risk ✅

**Challenge:** Multiple buttons (array) previously shared one `Mouse_Timer`

**Migration:**
- Each button gets its own `S_Element` hit target
- `s_element.handle_s_mouse` set per index
- Each button can autorepeat independently

### D_Actions.svelte — High Risk ✅

**Challenge:** Conditional autorepeat — only `T_Action.browse` and `T_Action.move` support it

**Migration:**
- All actions now autorepeat
- Callback logic handles action-specific behavior

---

## Testing

### Autorepeat

1. **Basic autorepeat across re-render**
   - [x] Open actions panel, press and **hold** a browse action
   - [x] Verify: fires immediately, repeats after delay, stops on release
   - [x] **Re-render test**: Selection changes cause UI re-render, autorepeat continues

2. **Hover-leave cancels autorepeat**
   - [x] Press and hold, drag mouse off button
   - [x] Verify: autorepeat stops immediately

3. **Steppers autorepeat**
   - [x] Click build button, hold stepper triangle
   - [x] Verify: value increments/decrements repeatedly

### Double-Click

4. **Double-click fires on second click**
   - [ ] Find button with `T_Mouse_Detection.double`
   - [ ] Click twice quickly (~300ms)
   - [ ] Verify: double-click callback fires, single-click does not

5. **Single-click deferred then fires**
   - [ ] Click once, wait for threshold
   - [ ] Verify: single-click fires after delay

6. **Hover-leave cancels pending double-click**
   - [ ] Click once, move mouse off button
   - [ ] Verify: pending single-click cancelled

### Long-Click

7. **Long-click fires after threshold**
   - [ ] Find button with `T_Mouse_Detection.long`
   - [ ] Press and hold past ~500ms
   - [ ] Verify: long-click callback fires

8. **Long-click suppresses regular click**
   - [ ] After long-click fires, release mouse
   - [ ] Verify: no additional click action

9. **Early release prevents long-click**
   - [ ] Press, release before threshold
   - [ ] Verify: normal click fires, not long-click

10. **Hover-leave cancels long-click timer**
    - [ ] Press and hold, drag off before threshold
    - [ ] Verify: long-click does not fire

---

## Risks & Mitigation

| Risk | Mitigation |
|------|------------|
| Long-click cancels single-click | Set `longClick_fired` flag, check in mouse-up handler |
| Double-click delays single-click | Opt-in per target; document tradeoff |
| Click counting conflicts | Migrate all to `S_Hit_Target.clicks`; deprecate `S_Mouse.clicks` |
| Timer conflicts | Each timer tracks its target; cancel on target change |
| Hover-leave edge cases | Cancel pending timers in `detect_hovering_at` |
| Autorepeat incompatible with long/double | Enforced via `T_Mouse_Detection` enum |

---

## Session Notes

Historical notes from the timing centralization work.

### Button Styling Fixes

**Problem:** Control buttons had incorrect fill colors (transparent instead of white).

**Solution:**
1. Set `color_background` on `S_Element` instances in `Elements.s_control_forType()`
2. Modified `S_Element.ts`: `fill` getter uses `color_background` as fallback

**Files:** `Elements.ts`, `S_Element.ts`

### Close Button Hit Testing (Unresolved)

**Problem:** Close search button only responded in tiny area at top-left corner.

**Attempted:** `display: block`, `tick()`, bypassing `set_html_element()`, duplicate entry prevention.

**Status:** Reverted. Root cause unclear — may be stale RBush entries or timing of rect updates.

### Documentation Patterns

#### Refactoring Guide Pattern
Create `notes/design/refactoring-guide.md` with principles and process, then add example section.

#### Geometry Documentation Pattern  
Before refactoring, document existing system's responsibilities, invocation patterns, and actors.

#### Layout Guide Pattern
Create guide with Analysis Questions, Design Questions, Simplification Opportunities, Performance Opportunities, Summary.

#### Markdown Anchor Pattern
1. Promote important bullets to subheaders for stable anchors
2. Write `**Problem**` / `**Goal**` bullets inline near context
3. Create `## Summary` with `### Problems` and `### Goals`
4. Group by originating section with links back
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/debounce.md
```md
# Debounce & Timing Consolidation Proposal

## Current State

10 ad-hoc timing patterns scattered across the codebase:

### TypeScript

| File | Pattern | Purpose | Delay |
|------|---------|---------|-------|
| Geometry.ts | `setTimeout(() => hits.recalibrate(), 100)` | Wait for DOM after rect change | 100ms |
| Geometry.ts | `setTimeout(() => hits.recalibrate(), 100)` | Wait for DOM after offset change | 100ms |
| Events.ts | `throttle()` method | Generic throttle utility | configurable |
| Events.ts | `setTimeout(() => h.db.persist_all(), 1)` | Defer auto-save to next tick | 1ms |

### Svelte

| File | Pattern | Purpose | Delay |
|------|---------|---------|-------|
| Widget_Title.svelte | `setTimeout(() => updateInputWidth(), 100)` | Wait for DOM in onMount | 100ms |
| Widget_Title.svelte | `setTimeout(() => ancestry.startEdit(), 1)` | Defer edit start | 1ms |
| Widget_Title.svelte | `setTimeout` + `requestAnimationFrame` | Debounced layout on title change | 400ms |
| Widget_Drag.svelte | `setTimeout(() => x.dragDotJustClicked = false, 100)` | Reset flag after click handled | 100ms |
| Search.svelte | `setTimeout(() => s_element_set_focus_to(), 1)` | Defer focus | 1ms |

### Already Centralized

| File | Purpose |
|------|---------|
| S_Busy.ts | `isRendering` flag for navigation rate-limiting |
| S_Busy.ts | `signal_data_redraw(after)` with configurable delay |
| Mouse_Timer.ts | Full timer infrastructure (autorepeat, double-click, long-click, alteration) |

---

## Categories

### 1. DOM Ready (100ms delays)
Wait for browser to finish layout/paint before measuring or recalibrating.

**Instances:**
- Geometry.ts × 2
- Widget_Title.svelte (onMount)
- Widget_Drag.svelte (flag reset)

**Proposal:** Add `busy.afterPaint(callback)` using `requestAnimationFrame`:
```typescript
afterPaint(callback: () => void) {
    requestAnimationFrame(() => {
        requestAnimationFrame(callback);  // double-RAF ensures paint complete
    });
}
```

### 2. Defer to Next Tick (1ms delays)
Yield to let current execution complete.

**Instances:**
- Events.ts (auto-save)
- Widget_Title.svelte (startEdit)
- Search.svelte (focus)

**Proposal:** Add `busy.defer(callback)`:
```typescript
defer(callback: () => void) {
    setTimeout(callback, 0);
}
```

### 3. Debounced Actions (400ms)
Coalesce rapid changes into single action.

**Instances:**
- Widget_Title.svelte (layout on title change)

**Proposal:** Add `busy.debounce(key, delay, callback)`:
```typescript
private debounceTimers: Map<string, number> = new Map();

debounce(key: string, delay: number, callback: () => void) {
    const existing = this.debounceTimers.get(key);
    if (existing) clearTimeout(existing);
    this.debounceTimers.set(key, setTimeout(() => {
        this.debounceTimers.delete(key);
        callback();
    }, delay));
}
```

### 4. Throttle (existing in Events.ts)
Rate-limit repeated calls.

**Proposal:** Move `throttle()` from Events.ts to S_Busy.ts.

---

## Proposed S_Busy.ts API

```typescript
export class S_Busy {
    // Existing
    isPersisting = false;
    isFetching = false;
    isRendering = false;
    isFocusEventDisabled = false;
    
    // New
    afterPaint(callback: () => void): void
    defer(callback: () => void): void
    debounce(key: string, delay: number, callback: () => void): void
    throttle(key: string, delay: number, callback: () => void): void
    
    // Existing helpers
    get isFocusEventEnabled(): boolean
    get isDatabaseBusy(): boolean
    async temporarily_set_isPersisting_while(closure): Promise<void>
    async temporarily_set_isFetching_while(closure): Promise<void>
    async temporarily_disable_focus_event_while(closure): Promise<void>
    signal_data_redraw(after?: number): void
}
```

---

## Migration Plan

### Phase 1: Add new methods to S_Busy.ts
- `afterPaint()`
- `defer()`
- `debounce()`
- Move `throttle()` from Events.ts

### Phase 2: Migrate TypeScript files
- Geometry.ts → `busy.afterPaint()`
- Events.ts → `busy.defer()`, remove local `throttle()`

### Phase 3: Migrate Svelte files
- Widget_Title.svelte → `busy.afterPaint()`, `busy.defer()`, `busy.debounce()`
- Widget_Drag.svelte → `busy.afterPaint()`
- Search.svelte → `busy.defer()`

---

## Benefits

1. **Single source of truth** for timing patterns
2. **Named keys** for debounce/throttle make debugging easier
3. **Consistent behavior** across codebase
4. **Testable** — can mock S_Busy in tests
5. **Discoverable** — developers look in one place

## Risks

- More imports of `busy` across codebase
- Slight overhead for simple cases

## Decision

- [ ] Implement full proposal
- [ ] Implement partial (just `afterPaint` and `defer`)
- [ ] Leave as-is (ad-hoc is fine for now)
- [ ] Other: _______________
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/index.md
```md
# Internals

Internal implementation patterns and system-level mechanics.

## Contents

- [Debounce](./debounce.md)
- [Layout](./layout.md)
- [Persistable](./persistable.md)
- [Preferences](./preferences.md)
- [Reactivity](./reactivity.md)
- [Recents](./recents.md)
- [Styles](./styles.md)
- [Timers](./timers.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/recents.md
```md
# Recents

recents is broken. let's start over

## I Want the app to

* Remember what i grab or when i change the focus
* Go backwards and forwards through history
* History is circular (after the last is the first)
* Remove current recent by typing "/"
* Unlimited length
* Mode to ignore all grabs (record but skip during navigation)

## Entry Structure — Single source of truth

```typescript
type S_Recent = {
    focus: Ancestry,
    si_grabs: S_Items<Ancestry>,
    depth: number
}

si_recents = new S_Items<Recent>([])
```

**Single source of truth:**

* `si_recents.item.focus` — current focus
* `si_recents.item.si_grabs.items` — current grabs
* `si_recents.item.si_grabs.index` — current grab index
* `si_recents.item.depth` — current depth level

**New entry when:** focus, grabs, or depth changes. Snapshot the whole state.

**Navigation:** Move index, apply the snapshot. No replay logic.

**Derived stores:**

```typescript
w_focus = derived(si_recents.w_item, item => item?.focus)
w_grabs = derived(si_recents.w_item, item => item?.si_grabs.items)
w_depth = derived(si_recents.w_item, item => item?.depth)
```

No separate `si_grabs`, no separate `w_ancestry_focus`. Just `si_recents`.

## Final manual regression testing

| Area | Steps | Expected |
|----|----|----|
| **Focus** |    |    |
|    | Click widget | Widget becomes focus, tree recenters |
|    | Click breadcrumb | grabOnly that ancestor |
|    | Double-click widget | Focus changes, children expand |
| **Grabs** |    |    |
|    | Click widget | Single grab, highlighted |
|    | Shift-click another | Multi-grab, both highlighted |
|    | Click elsewhere | Previous grabs cleared |
|    | Click grabbed widget | Ungrab (if toggle behavior) |
| **History** |    |    |
|    | Make 5 focus/grab changes | History accumulates |
|    | Press back 3 times | Each state restores correctly |
|    | Press forward 2 times | States restore correctly |
|    | Press back past start | Wraps to most recent (circular) |
|    | Press "/" | Current entry removed from history |
| **Search** |    |    |
|    | Grab A, then open search | A stays grabbed |
|    | Type query, get results | Grabs unchanged |
|    | Arrow through results | Details updates, grabs unchanged |
|    | Press Enter on result | Result becomes focus+grab, search closes |
|    | Press Escape | Search closes, original grabs intact |
| **Details** |    |    |
|    | Grab single widget | Details shows that widget |
|    | Multi-grab A, B, C | Details shows one (per grabIndex) |
|    | Press next/prev in details | Cycles through grabbed items |
| **Modes** |    |    |
|    | Do all above in tree mode | Works |
|    | Switch to radial mode | Grabs preserved |
|    | Do all above in radial mode | Works |
| **Depth** |    |    |
|    | Change depth slider | History entry created |
|    | Navigate back | Previous depth restored |

## Completed

**Date:** 2025-01-21

### Verdict: ✅ `x.si_recents` IS the single source of truth for both focus and grabs

**Current implementation:**

| Store | Role |
|----|----|
| `x.si_recents` | **SINGLE SOURCE OF TRUTH** |
| `x.w_ancestry_focus` | Derived from `si_recents.w_item?.focus` |
| `x.w_grabs` | Derived from `si_recents.w_item?.si_grabs?.items` |
| `x.w_grabIndex` | Derived from `si_recents.w_item?.si_grabs?.index` |

**Key changes from old system:**

* No separate `x.si_grabs` exists
* All derived stores read from `si_recents.w_item`
* Every mutation (`grab`, `ungrab`, `grabOnly`, `becomeFocus`) creates a NEW `S_Recent` snapshot with CLONED grabs
* Fixes the "reference vs copy" problem identified above

The analysis in this document is now **historical** — it describes the old architecture that has been replaced.
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/preferences.md
```md
# Preferences

## Origin

Customer reported the breadcrumbs segmented control appeared unselected on launch. Root cause: localStorage contained a stale enum value from an older app version that no longer matched any valid `T_Breadcrumbs` member. The `?? default` fallback only catches null/undefined — not invalid values.

## Solution

Enum validation system in `Enumerations.ts`:

### Enum_Spec class
```typescript
export class Enum_Spec {
    constructor(public enum_type: object | null, public defaultValue: any) {}
}
```

### Centralized defaults dictionary
```typescript
export const spec_dict_byType: Enum_Spec_ByType = {
    [T_Preference.breadcrumbs]:     new Enum_Spec(T_Breadcrumbs,       T_Breadcrumbs.focus),
    [T_Preference.paging_style]:    new Enum_Spec(T_Cluster_Pager,     T_Cluster_Pager.sliders),
    [T_Preference.graph]:           new Enum_Spec(T_Graph,             T_Graph.tree),
    [T_Preference.focus]:           new Enum_Spec(T_Focus,             T_Focus.dynamic),
    // ... etc
};
```

### Helper for writable defaults
```typescript
export const def = (key: T_Preference): any => spec_dict_byType[key]?.defaultValue ?? null;
```

### Validating read_key
```typescript
read_key(key: T_Preference): any {
    const spec   = spec_dict_byType[key];
    const stored = this.get_forKey(key);
    if (stored !== null) {
        if (!spec || !spec.enum_type) {
            return stored;  // no validation for non-enum prefs
        }
        if (Object.values(spec.enum_type).includes(stored)) {
            return stored;  // valid enum value
        }
    }
    // invalid or missing: reset to default
    const defaultValue = spec?.defaultValue ?? null;
    if (defaultValue !== null) {
        this.write_key(key, defaultValue);
    }
    return defaultValue;
}
```

### Single source of truth
`Visibility.ts` writables use `def()`:
```typescript
const P = T_Preference;
w_t_breadcrumbs = writable<T_Breadcrumbs>(def(P.breadcrumbs));
w_t_focus       = writable<T_Focus>(def(P.focus));
```

## Files

- `Enumerations.ts` — `Enum_Spec`, `spec_dict_byType`, `def()`
- `Preferences.ts` — `read_key()` with validation
- `Visibility.ts` — writable initializers use `def(P.key)`
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/internals/layout.md
```md
# Layout Code Analysis

## Problem

The code responsible for computing where to render each bit of the graph (tree or radial) is a complex, tangled mishmash of ad-hoc write-what-works. It is excruciatingly hard to debug or modify.

## Goal

Understand the flow for several use cases. Be able to pinpoint a likely cause of a bug. This may involve flow diagrams. Certainly need some kind of map of the current code.

---

## Key Files

| File | Role |
|------|------|
| `managers/Geometry.ts` | Orchestrator. Entry points: `layout()`, `grand_build()`, `grand_sweep()` |
| `geometry/G_TreeGraph.ts` | Tree mode layout. Owns `layout()` and recursive widget positioning |
| `geometry/G_RadialGraph.ts` | Radial mode layout. Owns clusters and necklace positioning |
| `geometry/G_Widget.ts` | Per-widget geometry. Computes origins, offsets, reveal positions |
| `geometry/G_Cluster.ts` | Radial cluster layout. Paging, arc angles, widget distribution |
| `geometry/G_TreeBranches.ts` | Tree branch layout. Child widget positioning |
| `geometry/G_TreeLine.ts` | Tree connector lines |
| `signals/Signals.ts` | Event dispatch. `signal_rebuildGraph`, `signal_reposition_widgets` |
| `signals/Events.ts` | User input → layout triggers |

---

## Entry Points (What Triggers Layout)

```
User Action                    → Code Path
─────────────────────────────────────────────────────────────────
Window resize                  → e.handle_window_resize → g.restore_preferences()
Wheel scroll                   → e.handle_wheel → g.set_user_graph_offsetTo()
Key 'C'                        → e.handle_key_down → g.set_user_graph_offsetTo(Point.zero)
Key '!'                        → e.handle_key_down → g.grand_adjust_toFit()
Key 'M'                        → controls.toggle_graph_type() → g.grand_build()
Key '>' / '<'                  → g_graph_tree.increase_depth_limit_by() → g.layout()
Click drag dot                 → e.handle_singleClick_onDragDot → g.grand_build() or g.layout()
Focus change                   → ancestry.becomeFocus() → g.grand_build()
Details toggle                 → details.details_toggle_visibility() → g.update_rect_ofGraphView()
Radial ring resize             → radial.w_resize_radius subscription → g_cluster.layout()
```

---

## Main Layout Flow

### 1. `g.grand_sweep()` (full rebuild + layout)
```
g.grand_sweep()
  └─ g.layout()                          ← position everything
  └─ g.grand_build()
       └─ signals.signal_rebuildGraph_fromFocus()
            └─ emits T_Signal.rebuild    ← Svelte components react
```

### 2. `g.grand_build()` (rebuild graph from focus)
```
g.grand_build()
  └─ signals.signal_rebuildGraph_fromFocus()
       └─ emits T_Signal.rebuild
```

### 3. `g.layout()` (mode-specific positioning)
```
g.layout()
  ├─ [radial mode] → g_graph_radial.layout()
  │     └─ destructor()
  │     └─ layout_forChildren_cluster(true)   ← children
  │     └─ layout_forChildren_cluster(false)  ← parents/related
  │     └─ layout_focus()                     ← focus widget
  │     └─ layout_forPaging()                 ← distribute across clusters
  │
  └─ [tree mode] → g_graph_tree.layout()
        └─ layout_focus_ofTree(rect_ofGraphView)
        └─ g_focus.layout_each_generation_recursively(depth_limit)
        └─ g_focus.layout_each_bidirectional_generation_recursively(depth_limit)
        └─ adjust_focus_ofTree(rect_ofGraphView)
```

---

## Tree Layout Deep Dive

### `G_TreeGraph.layout()`
```
layout()
  │
  ├─ layout_focus_ofTree(rect)
  │     Computes: origin_ofFocusReveal from rect_ofGraphView.center
  │     Sets: g_focus.origin_ofWidget
  │     Uses: subtree_size, x_offset_forDetails, y_offset
  │
  ├─ g_focus.layout_each_generation_recursively(depth_limit)
  │     For each branch ancestry (recursively):
  │       └─ layout_one_generation()
  │             └─ layout()                    ← G_Widget.layout()
  │             └─ layout_origin_ofTrunk()
  │             └─ g_childBranches.layout()    ← G_TreeBranches.layout()
  │
  └─ adjust_focus_ofTree(rect)
        Re-computes final g_focus.origin_ofWidget
        (unclear why this runs twice - see TODO in code)
```

### `G_Widget.layout_each_generation_recursively(depth)`
```
layout_each_generation_recursively(depth, visited)
  │
  ├─ [if depth > 0 && not visited && shows_branches]
  │     For each branchAncestry:
  │       └─ branchAncestry.g_widget.layout_each_generation_recursively(depth-1)
  │
  └─ layout_one_generation()  ← layout self AFTER children
```

### `G_Widget.layout_one_generation()`
```
layout_one_generation()
  ├─ layout()                 ← compute widget geometry
  ├─ layout_origin_ofTrunk()  ← position trunk connector
  └─ g_childBranches.layout() ← layout child branch lines
```

### `G_TreeBranches.layout()`
```
layout()
  │
  └─ For each branchAncestry:
       └─ g_widget_ofBranch.layout_subtree_for(height, origin, T_Graph.tree)
```

### `G_Widget.layout_subtree_for(...)`
```
layout_subtree_for(height, origin, t_graph, pointsTo_child, reveal_isAt_right)
  │
  ├─ Computes: height_ofSubtree, height_ofLines, rect_ofLines
  ├─ Sets: origin_ofWidget, g_line.rect, size_ofSubtree.height
  └─ layout_one_generation()
```

---

## Radial Layout Deep Dive

### `G_RadialGraph.layout()`
```
layout()
  │
  ├─ destructor()                         ← clear old clusters
  │
  ├─ layout_forChildren_cluster(true)     ← children cluster
  │     └─ assignAncestries_toClusterFor(childAncestries, Predicate.contains, true)
  │
  ├─ layout_forChildren_cluster(false)    ← parent clusters (one per predicate)
  │     For each predicate:
  │       └─ assignAncestries_toClusterFor(ancestries, predicate, false)
  │
  ├─ layout_focus()
  │     Sets: g_focus.origin_ofWidget, location_ofRadial, origin_ofRadial
  │     Uses: g.center_ofGraphView
  │
  └─ layout_forPaging()
       Distributes widgets across clusters based on radius
       For each cluster:
         └─ g_cluster.layout_forPaging()
```

### `G_Cluster.layout_forPaging()`
```
layout_forPaging()
  │
  ├─ g_paging.onePage_from(widgets_shown, ancestries)  ← get current page
  └─ layout()
```

### `G_Cluster.layout()`
```
layout()
  │
  ├─ g_cluster_pager.layout()
  ├─ layout_cluster_widgets()
  │     For each ancestry_shown:
  │       └─ g_widget.layout_necklaceWidget(rotated_origin, reveal_isAt_right)
  │
  ├─ g_cluster_pager.layout_forkTip(center)
  ├─ layout_label()
  ├─ layout_thumb_angles()
  ├─ update_label_forIndex()
  └─ signals.signal_reposition_widgets_fromFocus()
```

---

## G_Widget.layout() (Core Widget Geometry)

This is where the actual pixel positions get computed:

```
layout()
  │
  ├─ Inputs:
  │     - ancestry.thing.width_ofTitle
  │     - showingReveal (bool)
  │     - reveal_isAt_right (bool)
  │     - controls.inRadialMode
  │     - ancestry.isFocus
  │
  ├─ Computes:
  │     - width_ofWidget
  │     - x_ofDrag, x_ofRadial, x_offset_ofWidget
  │     - origin_ofDrag, origin_ofTitle
  │     - center_ofDrag, center_ofReveal
  │
  └─ Sets:
       - location_ofRadial (if not focus)
       - origin_ofRadial
       - origin_ofTitle
       - center_ofDrag
       - offset_ofWidget
       - width_ofWidget
       - center_ofReveal (if showingReveal)
```

---

## Key Stores That Affect Layout

| Store | Set By | Consumed By |
|-------|--------|-------------|
| `g.w_rect_ofGraphView` | `g.update_rect_ofGraphView()` | Tree/Radial layout |
| `g.w_user_graph_center` | `g.set_user_graph_offsetTo()` | **NOT used by tree** (bug?) |
| `g.w_user_graph_offset` | `g.set_user_graph_offsetTo()` | Wheel scroll, persisted |
| `show.w_show_details` | Details toggle | Tree layout (x_offset_forDetails) |
| `show.w_t_graph` | Mode toggle | `g.layout()` dispatch |
| `radial.w_resize_radius` | Ring drag | Cluster layout |
| `radial.w_rotate_angle` | Ring rotation | Cluster angle_ofCluster |
| `x.w_ancestry_focus` | Focus change | Everything |
| `g.w_depth_limit` | Key '>' / '<' | Tree recursion depth |

---

## Common Bug Locations

### Tree moves wrong direction when details toggle
- **File**: `G_TreeGraph.ts`
- **Location**: `adjust_focus_ofTree()` and `layout_focus_ofTree()`
- **Variable**: `x_offset_forDetails`
- **Issue**: Sign of offset

### Tree doesn't respond to user offset (C key)
- **File**: `G_TreeGraph.ts`
- **Issue**: Uses `rect_ofGraphView.center` instead of `g.w_user_graph_center`
- **Both**: `adjust_focus_ofTree()` and `layout_focus_ofTree()`

### Widget positions wrong after mode switch
- **File**: `G_Widget.ts`
- **Location**: `layout()` - many conditional branches for radial vs tree
- **Issue**: State from previous mode bleeding through

### Radial clusters overlap or wrong angle
- **File**: `G_Cluster.ts`
- **Location**: `angle_ofCluster`, `angle_at_index()`
- **Issue**: Complex angle math with arc-sin and wrapping

### Tree branches misaligned
- **File**: `G_TreeBranches.ts`, `G_Widget.ts`
- **Location**: `layout_subtree_for()`, `origin_forAncestry_inRect()`
- **Issue**: Height calculations, origin computations

---

## Flow Diagram: Focus Change → Layout

```
ancestry.becomeFocus()
    │
    ├─ x.si_recents.push(pair)
    ├─ ancestry.expand()
    ├─ hits.recalibrate()
    │
    └─ [caller] → g.grand_build()
                      │
                      └─ signals.signal_rebuildGraph_fromFocus()
                             │
                             └─ Svelte components receive T_Signal.rebuild
                                    │
                                    └─ Graph.svelte reattaches
                                           │
                                           └─ triggers g.layout()
```

---

## Flow Diagram: Details Toggle → Tree Repositions

```
details.details_toggle_visibility()
    │
    └─ show.w_show_details.set(!current)
           │
           └─ [subscription in Geometry constructor]
                  │
                  ├─ g.update_rect_ofGraphView()
                  │     └─ Computes new rect (x shifts by k.width.details)
                  │     └─ g.w_rect_ofGraphView.set(rect)
                  │
                  └─ g.layout()
                         └─ g_graph_tree.layout()
                               ├─ layout_focus_ofTree() uses x_offset_forDetails
                               └─ adjust_focus_ofTree() uses x_offset_forDetails
```

---

## TODO: Questions to Answer

1. Why does `adjust_focus_ofTree` run AFTER `layout_each_generation_recursively`? The code has a TODO saying it doesn't know why.

2. Why doesn't tree layout use `w_user_graph_center`? Radial does via `g.center_ofGraphView` but tree uses `rect_ofGraphView.center` directly.

3. ~~What triggers layout after `w_rect_ofGraphView` changes? Need to find the subscription.~~ **FIXED**: Added subscription in Geometry constructor.

4. The relationship between `origin_ofWidget`, `origin_ofTrunk`, `origin_ofRadial`, and `location_ofRadial` is confusing. When is each used?

---

## Work Performed

- [x] Mapped all key layout files
- [x] Identified entry points and triggers
- [x] Traced tree layout flow
- [x] Traced radial layout flow
- [x] Documented G_Widget.layout() internals
- [x] Listed key stores affecting layout
- [x] Identified common bug locations
- [x] Created flow diagrams for focus change and details toggle
- [x] **Fixed**: Added `show.w_show_details` subscription in `Geometry.setup_subscriptions()` (called from `Configuration.configure()`) to trigger `update_rect_ofGraphView()` + `layout()` when details visibility changes
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/buttons.md
```md
# Button Components Analysis

These just cropped up, ad-hoc, at the beginning of the project. Might give it a sanity check.

## Table of Contents
- [Overview](#overview)
- [Component Hierarchy](#component-hierarchy)
  - [Base Component: `Button.svelte`](#base-component-buttonsvelte)
  - [Specialized Variants](#specialized-variants)
- [SVG Configuration Data Flow](#svg-configuration-data-flow)
  - [Path Generation System](#path-generation-system)
  - [Rendering Components](#rendering-components)
  - [Complete Data Flow Example: Buttons_Row](#complete-data-flow-example-buttons_row)
  - [Complete Data Flow Example: Triangle_Button](#complete-data-flow-example-triangle_button)
- [State Management](#state-management)
- [Key Patterns](#key-patterns)
  - [1. **Closure Pattern** (Buttons_Row, Buttons_Table)](#1-closure-pattern-buttons_row-buttons_table)
  - [2. **Reactive Style Updates**](#2-reactive-style-updates)
  - [3. **SVG Conditional Rendering**](#3-svg-conditional-rendering)
- [Reference](#reference)

## Overview

Webseriously uses a hierarchy of button components, from a base `Button` component to specialized variants. All buttons use `S_Element` for state management and support SVG icons through a centralized path generation system.

## Component Hierarchy

### Base Component: `Button.svelte`

The foundation for all button types. Handles:
- **State Management**: Uses `S_Element` (`s_button`) for persistent state (hover, grab, disabled, inverted, editing)
- **Mouse Handling**: Supports multiple detection modes (none, single, double, long, autorepeat)
- **Styling**: Computes styles reactively from `s_button` properties (fill, stroke, cursor)
- **Layout**: Supports both `origin` and `center` positioning with left/right alignment

**Key Props:**
- `s_button: S_Element` - State object (owns stroke, fill, cursor)
- `handle_s_mouse: (s_mouse: S_Mouse) => boolean` - Click handler
- `mouse_detection: T_Mouse_Detection` - Detection mode
- `center | origin: Point` - Position
- `height, width, font_size` - Dimensions
- `border_thickness, border_color` - Border styling

**Slot Content**: Text or SVG icons (rendered as children)

### Specialized Variants

#### 1. **Triangle_Button.svelte**
Wraps `Button` with triangle SVG icon.

**Features:**
- Uses `SVG_D3` component for rendering
- Supports optional `extraPath` for nested shapes
- `hover_closure` callback for dynamic color changes
- Reactive path generation based on `size` and `angle`

**SVG Flow:**
```
angle → svgPaths.fat_polygon(size, angle) → trianglePath → SVG_D3
```

#### 2. **Glow_Button.svelte**
Standalone button with gradient background and optional icon.

**Features:**
- Uses `SVG_Gradient` for background glow effect
- Icon lookup via `svgPaths.fat_polygon_path_for(title)`
- Supports autorepeat detection
- Inline SVG rendering (not using SVG_D3)

**SVG Flow:**
```
title → svgPaths.fat_polygon_path_for(title) → icon_path → inline <svg>
```

#### 3. **Breadcrumb_Button.svelte**
Text-only button for breadcrumb navigation.

**Features:**
- Wraps base `Button` with breadcrumb-specific styling
- No SVG icons (text-only)
- Reactive color updates based on grab/hover state

#### 4. **Buttons_Row.svelte**
Container for horizontal button arrays.

**Features:**
- Optional row title (with or without separator)
- Generates `S_Element` instances per button column
- Uses `G_Repeater` for layout calculations
- Conditional SVG rendering via `has_svg` prop

**SVG Flow:**
```
title → svgPaths.fat_polygon_path_for(title, svg_size) → inline <svg> in slot
```

#### 5. **Buttons_Table.svelte**
Container for multiple `Buttons_Row` instances.

**Features:**
- Manages rows of buttons
- Delegates to `Buttons_Row` for each row
- Visibility control via closure

#### 6. **Next_Previous.svelte**
Specialized pair of buttons with custom SVG support.

**Features:**
- Two buttons (previous/next) with triangle arrows
- Supports `custom_svgPaths` for override (e.g., dash/cross for zoom)
- Autorepeat enabled by default
- Custom transform/color logic for different icon types

**SVG Flow:**
```
title → get_path_for(title, index) → {
  custom_svgPaths? → custom path + fat_polygon
  default → svgPaths.fat_polygon_path_for(title, size)
} → inline <svg>
```

## SVG Configuration Data Flow

### Path Generation System

All SVG paths flow through `svgPaths` utility (`SVG_Paths.ts`):

#### 1. **Name-Based Lookup** (`fat_polygon_path_for`)
```
Button Title/Name → Angle.angle_from_name(name) → fat_polygon(size, angle) → SVG path string
```

**Used by:**
- `Buttons_Row`: `svgPaths.fat_polygon_path_for(title, svg_size)`
- `Glow_Button`: `svgPaths.fat_polygon_path_for(title)`
- `Next_Previous`: `svgPaths.fat_polygon_path_for(String(title), size)`

**Angle Names**: Maps string names (e.g., "up", "down", "left", "right") to angles via `Angle.angle_from_name()`

#### 2. **Direct Angle** (`fat_polygon`)
```
size + angle → fat_polygon(size, angle) → SVG path string
```

**Used by:**
- `Triangle_Button`: `svgPaths.fat_polygon(size, angle)`
- `Widget_Reveal`: `svgPaths.fat_polygon(k.height.dot, direction_ofReveal)`

**Parameters:**
- `size: number` - Icon size
- `angle: number` - Rotation angle in radians
- `onCenter: boolean` - Center offset (default false)
- `vertices: number` - Polygon vertices (default 3 for triangles)

#### 3. **Custom Paths**
Some components accept custom SVG paths directly:
- `Next_Previous`: `custom_svgPaths: { up?: string, down?: string }`
- `Primary_Controls`: Custom dash/cross paths for zoom controls

### Rendering Components

#### **SVG_D3.svelte**
Reusable SVG component used by `Triangle_Button`:
```
svgPath (string) → SVG_D3 → <svg><path d={svgPath}/></svg>
```

**Props:**
- `svgPath: string` - SVG path data
- `stroke, fill` - Colors
- `width, height` - Dimensions
- `viewBox_width, left, top` - Positioning

#### **Inline SVG**
Used by `Buttons_Row`, `Glow_Button`, `Next_Previous`:
```
path string → <svg><path d={path}/></svg>
```

### Complete Data Flow Example: Buttons_Row

```
1. Component receives: title="up", has_svg=true, svg_size=16

2. SVG Path Generation:
   title → svgPaths.fat_polygon_path_for("up", 16)
   → Angle.angle_from_name("up") → angle (e.g., Math.PI/2)
   → svgPaths.fat_polygon(16, angle)
   → "M x,y C ... Z" (SVG path string)

3. Rendering:
   <Button>
     <svg class='svg-button-path-for-up'>
       <path d={path_string} fill='white'/>
     </svg>
   </Button>

4. Button applies styling:
   s_button.fill → background-color
   s_button.stroke → color (text/SVG stroke)
   s_button.cursor → cursor style
```

### Complete Data Flow Example: Triangle_Button

```
1. Component receives: angle=Math.PI/2, size=24

2. SVG Path Generation:
   angle + size → svgPaths.fat_polygon(24, Math.PI/2)
   → "M x,y C ... Z" (SVG path string)

3. State Updates:
   $w_s_hover → isHovering → hover_closure(isHovering)
   → [fillColor, extraColor] (dynamic colors)

4. Rendering:
   <Button>
     <SVG_D3 svgPath={trianglePath} stroke={strokeColor} fill={fillColor}/>
     {#if extraPath}
       <SVG_D3 svgPath={extraPath} fill={extraColor}/>
     {/if}
   </Button>
```

## State Management

All buttons use `S_Element` for persistent state:

**State Properties:**
- `fill, stroke, cursor` - Visual styling
- `isHovering, isGrabbed, isDisabled, isInverted, isEditing` - State flags
- `handle_s_mouse` - Mouse event handler
- `mouse_detection` - Detection mode
- `autorepeat_callback, autorepeat_event` - Autorepeat support

**State Flow:**
```
User Interaction → Hits.ts (centralized) → s_button.handle_s_mouse()
→ Component's handle_s_mouse prop → Business logic
→ s_button state update → Reactive style recomputation
```

## Key Patterns

### 1. **Closure Pattern** (Buttons_Row, Buttons_Table)
Buttons use closure functions for configuration:
```typescript
closure: (t_request: T_Request, s_mouse: S_Mouse, column: number) => boolean
```

Handles:
- `T_Request.handle_click` - Click action
- `T_Request.is_disabled` - Disabled state
- `T_Request.is_inverted` - Inverted state
- `T_Request.name` - Button name

### 2. **Reactive Style Updates**
All buttons recompute styles reactively:
```svelte
$: {
  const _ = `${$w_background_color}:::${$w_s_hover?.id}:::${s_button.fill}`;
  recompute_style();
}
```

### 3. **SVG Conditional Rendering**
Buttons conditionally render SVG vs text:
```svelte
{#if has_svg && !!svgPaths.fat_polygon_path_for(title)}
  <svg><path d={svgPath}/></svg>
{:else}
  {title}
{/if}
```

## Reference

- **Base**: `src/lib/svelte/mouse/Button.svelte`
- **Variants**: `Triangle_Button`, `Glow_Button`, `Breadcrumb_Button`, `Buttons_Row`, `Buttons_Table`, `Next_Previous`
- **SVG Utilities**: `src/lib/ts/utilities/SVG_Paths.ts`
- **Angle Mapping**: `src/lib/ts/types/Angle.ts` (`angle_from_name`)
- **State Objects**: `src/lib/ts/state/S_Element.ts`

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/search.md
```md
# Search Functionality Architecture

Instant search. Type a single letter and the matches appear instantly. Type more or choose one and done. economical use of screen real estate.

## Table of Contents
- [Overview](#overview)
- [Stores](#stores)
- [Search States (T_Search)](#search-states-t_search)
- [Search Preferences (T_Search_Preference)](#search-preferences-t_search_preference)
- [Search Index](#search-index)
- [Search Algorithm](#search-algorithm)
- [Integration with UX](#integration-with-ux)
- [Activation/Deactivation](#activationdeactivation)
- [Persistence](#persistence)
- [Performance](#performance)
- [Design Notes](#design-notes)
- [Related Components](#related-components)
- [Usage](#usage)

## Overview

Search manager provides full-text search across Things with indexing for performance. Supports searching by title, traits, tags, and multiple search modes.

## Stores

| Store                      | Writable Type         | Purpose                       |
| -------------------------- | --------------------- | ----------------------------- |
| `w_s_search`               | `T_Search`            | off, enter, results, selected |
| `w_search_results_found`   | `number`              | Count                         |
| `w_search_results_changed` | `number`              | Re-render search results      |
| `w_search_preferences`     | `T_Search_Preference` | title, traits, tags           |

## Search States (T_Search)

```typescript
enum T_Search {
    off,        // Search not active
    enter,      // Entering search text
    results,    // Showing results
    selected    // Result selected
}
```

## Search Preferences (T_Search_Preference)

```typescript
enum T_Search_Preference {
    title,      // Search thing titles only
    traits,     // Search trait values
    tags,       // Search tag names
    all         // Search all fields
}
```

## Search Index

Uses `Search_Node` tree structure for efficient searching:

```typescript
class Search {
    private root_node: Search_Node = new Search_Node();

    buildIndex(things: Thing[]) {
        this.root_node = new Search_Node();
        for (const thing of things) {
            this.root_node.add_thing(thing);
        }
    }
}
```

Rebuilt on:
- Startup (`T_Startup.ready`)
- Database change
- Hierarchy changes

## Search Algorithm

```typescript
search_for(text: string) {
    this.search_words = text.split(' ').filter(w => w.length > 0);
    const results = this.root_node.search(
        this.search_words,
        this.use_AND_logic,
        get(this.w_search_preferences)
    );

    x.si_found.items = results;
    this.w_search_results_found.set(results.length);
    this.w_search_results_changed.set(Date.now());
    this.w_s_search.set(T_Search.results);
}
```

**Multi-word search**:
- `use_AND_logic = true`: All words must match
- `use_AND_logic = false`: Any word matches (OR logic)

## Integration with UX

Search results stored in `x.si_found --> S_Items<Thing>`

```typescript
get selected_ancestry(): Ancestry | null {
    const row = this.selected_row;
    if (row !== null && show.w_show_search_controls) {
        const thing = x.si_found.items[row];
        return thing?.ancestry ?? null;
    }
    return null;
}
```

When search is active, UX manager:
1. Updates `x.si_grabs` to match search results
2. Shows selected result in details panel (first priority)
3. Syncs on search state changes

## Activation/Deactivation

```typescript
activate() {
    x.save_grabs();                          // Save current selection
    show.w_show_search_controls.set(true);
    this.search_for(this.search_text);       // Direct call, not via subscription
}

deactivate() {
    x.save_grabs(false);                     // Restore saved selection
    this.w_search_results_found.set(0);
    this.w_s_search.set(T_Search.off);
    show.w_show_search_controls.set(false);
    details.redraw();
}
```

**Grabs save/restore**: Search temporarily overwrites `si_grabs` with matched ancestries. On deactivate, the original selection (items and index) is restored from `si_saved_grabs`.

## Persistence

Search text saved to preferences:
```typescript
this.search_text = p.readDB_key(T_Preference.search_text);
```

Restored on page load.

## Performance

- **Indexed search**: Pre-built tree structure for O(log n) lookup
- **Lazy rebuild**: Only on database changes or startup
- **Incremental updates**: Can add/remove individual things

## Design Notes

**Direct causation over subscription indirection**: When an action needs to trigger behavior, call it directly rather than through store subscriptions.

*Anti-pattern*:
```typescript
// In setup():
this.w_s_search.subscribe((state) => {
    if (state !== T_Search.off) this.search_for(text);  // Reactive trigger
});

// In activate():
this.w_s_search.set(T_Search.enter);  // Indirect: relies on subscription
```

*Correct pattern*:
```typescript
// In activate():
this.search_for(this.search_text);  // Direct call
```

Subscriptions are for *reacting* to external changes, not for triggering side effects from your own actions. The anti-pattern causes infinite loops when `search_for()` sets store values that re-trigger the subscription.

## Related Components

- **UX manager**: Owns `si_found` collection
- **Visibility**: Controls `w_show_search_controls`
- **Details**: Re-renders on search changes
- **Features**: `allow_search` flag enables/disables

## Usage

```typescript
import { search } from '../managers/Search';

// Activate search
search.activate();

// Perform search
search.search_text = 'keyword';
search.update_search();

// Select result
search.selected_row = 0;

// Deactivate
search.deactivate();
```
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/details.md
```md
# Details Panel Architecture

The details panel shows info about whatever's currently selected or in focus. Collapsible sections, coordinated with UX manager. Also, how how the sections track what to show?

## Table of Contents
- [Overview](#overview)
- [Key Classes](#key-classes)
- [Architecture](#architecture)
  - [Details Manager](#details-manager)
  - [Detail Types (T_Detail)](#detail-types-t_detail)
  - [S_Banner_Hideable](#s_banner_hideable)
- [Integration with UX Manager](#integration-with-ux-manager)
- [Banner System](#banner-system)
  - [Banner Visibility](#banner-visibility)
  - [Toggle Logic](#toggle-logic)
  - [Banner Titles](#banner-titles)
- [Navigation](#navigation)
  - [Section Navigation](#section-navigation)
- [Detail Components](#detail-components)
  - [D_Header.svelte](#d_headersvelte)
  - [D_Selection.svelte](#d_selectionsvelte)
  - [D_Tags.svelte](#d_tagssvelte)
  - [D_Traits.svelte](#d_traitssvelte)
  - [D_Actions.svelte](#d_actionssvelte)
  - [D_Preferences.svelte](#d_preferencessvelte)
  - [D_Data.svelte](#d_datasvelte)
- [Reactivity Pattern](#reactivity-pattern)
- [Hit Testing Integration](#hit-testing-integration)
- [Visibility Store Integration](#visibility-store-integration)
- [Constants](#constants)
- [Layout Flow](#layout-flow)
- [Edge Cases](#edge-cases)
- [Performance](#performance)
- [Comparison: Focus vs Details](#comparison-focus-vs-details)
- [Related Managers](#related-managers)
- [Best Practices](#best-practices)
- [Usage Example](#usage-example)

## Overview

The Details panel displays information about the current ancestry, integrating with UX manager to show context-appropriate content. It consists of multiple collapsible sections (banners) that can be toggled independently.

## Key Classes

| Class | File | Purpose |
|-------|------|---------|
| `Details` | `managers/Details.ts` | Manages banner state and navigation |
| `S_Banner_Hideable` | `state/S_Banner_Hideable.ts` | State for collapsible detail sections |
| `Banner_Hideable.svelte` | `svelte/details/` | Generic collapsible banner wrapper |
| Detail components | `svelte/details/D_*.svelte` | Individual detail section implementations |

## Architecture

### Details Manager

Coordinates detail panel state and provides navigation between sections:

```typescript
class Details {
    s_banner_hideables_dict_byType: Dictionary<S_Banner_Hideable> = {};
    t_storage_need = T_Storage_Need.direction;
    show_properties = false;

    constructor() {
        for (const t_detail of Object.values(T_Detail) as T_Detail[]) {
            this.s_banner_hideables_dict_byType[t_detail] = new S_Banner_Hideable(t_detail);
        }
    }
}
```

Creates one `S_Banner_Hideable` per detail type at initialization.

### Detail Types (T_Detail)

```typescript
enum T_Detail {
    header,       // Title/header display (no banner)
    actions,      // Action buttons
    selection,    // Selected ancestry details
    tags,         // Tags for current thing
    traits,       // Traits for current thing
    preferences,  // User preferences
    data,         // Additional data (bottom banner)
}
```

### S_Banner_Hideable

State for each collapsible detail section:

```typescript
class S_Banner_Hideable {
    slot_isVisible = false;
    t_detail!: T_Detail;
    hasBanner = false;      // header has no banner
    isBottom = false;       // data section is at bottom

    get si_items(): S_Items<any> {
        switch (this.t_detail) {
            case T_Detail.selection: return x.si_grabs;
            case T_Detail.tags:      return x.si_thing_tags;
            case T_Detail.traits:    return x.si_thing_traits;
            default:                 return S_Items.dummy;
        }
    }
}
```

Links detail sections to their data sources via UX manager.

## Integration with UX Manager

Details panel relies heavily on UX manager for data:

```typescript
// From Details components
const { w_ancestry_forDetails } = x;  // What to display
const { w_items: w_grabbed } = x.si_grabs;  // Selections
const { w_item: w_tag } = x.si_thing_tags;  // Current tag
const { w_item: w_trait } = x.si_thing_traits;  // Current trait
```

**Key insight**: Details panel displays `w_ancestry_forDetails`, which prioritizes:
1. Search selected result (if search active)
2. Current grab (if grabs exist)
3. Current focus

See [UX Manager documentation](../core/ux.md) for details.

## Banner System

### Banner Visibility

Controlled by `show.w_t_details` store (array of visible detail types):

```typescript
// From Visibility manager
w_t_details = writable<Array<T_Detail>>([]);

// Restore from preferences
this.w_t_details.set(p.read_key(T_Preference.detail_types) ??
    [T_Detail.actions, T_Detail.data]);
```

Default: Shows `actions` and `data` sections.

### Toggle Logic

```typescript
async function toggle_hidden(t_detail: string) {
    let t_details = $w_t_details;
    if (t_details.includes(t_detail)) {
        t_details = u.remove_fromArray_byReference(t_detail, t_details);
    } else {
        t_details.push(t_detail);
    }
    $w_t_details = t_details;
    await tick();
    hits.recalibrate();  // Update hit testing
}
```

### Banner Titles

Dynamic titles based on content and state:

```typescript
banner_title_forDetail(t_detail: T_Detail): string {
    const si_items = this.s_banner_hideables_dict_byType[t_detail].si_items;
    let title = T_Detail[t_detail];

    switch (t_detail) {
        case T_Detail.tags:
            title = si_items.title('tag', 'tags', title);
            break;
        case T_Detail.traits:
            title = si_items.title('trait', 'traits', title);
            break;
        case T_Detail.selection:
            if (search_active && multiple_results) {
                title = si_found.title('search result', 'focus', title);
            } else if (grabbed) {
                title = si_items.title('selected', 'focus', title);
            }
            break;
    }
    return title;
}
```

Examples:
- "1 tag" / "3 tags" / "tags"
- "search result 2/5" / "selected 1/3"

## Navigation

### Section Navigation

```typescript
select_next(banner_id: string, selected_title: string) {
    const next = T_Direction.next === selected_title;
    const t_detail = T_Detail[banner_id];

    switch (t_detail) {
        case T_Detail.traits:    x.select_next_thingTrait(next); break;
        case T_Detail.tags:      x.select_next_thing_tag(next); break;
        case T_Detail.selection: x.grab_next_ancestry(next); break;
    }
}
```

Delegates to UX manager for actual navigation logic.

## Detail Components

### D_Header.svelte

Header display showing thing title with color background:

```typescript
// Reactive to ancestry changes
$: ancestry = $w_ancestry_forDetails;
$: background_color = ancestry.thing?.color ?? 'transparent';
```

No banner (not collapsible).

### D_Selection.svelte

Most complex detail component - shows:

**Characteristics table**:
- Modified date
- Color picker (if editable)
- Children count
- Parents count
- Relateds count
- Progeny count

**Relationships table**:
- Tags count
- Traits count
- Depth
- Order

**Properties table** (collapsible):
- ID
- Ancestry ID
- Kind
- Type

```typescript
characteristics = [
    ['modified', thing.persistence.lastModifyDate.toLocaleString()],
    ['color',    ancestry.isEditable ? k.empty : 'not editable'],
    ['children', ancestry.children.length.supressZero()],
    ['parents',  thing.parents.length.supressZero()],
    ['relateds', thing.relatedRelationships.length.supressZero()],
    ['progeny',  ancestry.progeny_count().supressZero()],
];
```

**Color picker integration**: Uses Portal to render color picker at table cell location.

**Properties toggle**: Separator with gull wings controls `details.show_properties` flag.

### D_Tags.svelte

Simple tag display:

```typescript
const { w_item: w_tag } = x.si_thing_tags;

{#if !!$w_tag}
    {$w_tag?.type}
{:else}
    no tags
{/if}
```

### D_Traits.svelte

Similar to tags, displays current trait from `x.si_thing_traits`.

### D_Actions.svelte

Action buttons for thing manipulation (implementation in separate file).

### D_Preferences.svelte

User preferences controls (implementation in separate file).

### D_Data.svelte

Additional data display (implementation in separate file).

## Reactivity Pattern

Details components use reactive triggers to minimize re-renders:

```typescript
let trigger = k.empty;

$: {
    update_forAncestry();
    trigger = `${u.descriptionBy_title($w_grabbed)}
        :::${$w_ancestry_focus?.title}
        :::${$w_thing_title}
        :::${$w_ancestry_forDetails?.title}
        :::${$w_relationship_order}`;
}

{#key trigger}
    <!-- Component content -->
{/key}
```

Trigger combines multiple dependencies into single string. Only re-renders when combined string changes.

## Hit Testing Integration

Detail banners support hit testing for hover effects:

```typescript
<Glows_Banner
    titles={titles}
    width={k.width.details}
    toggle_hidden={toggle_hidden}
    banner_id={T_Detail[t_detail]}
    font_size={k.font_size.banners}
    isSelected={hideable_isVisible}
    height={g.glows_banner_height}/>
```

Hit testing recalibrated after visibility changes:

```typescript
async function toggle_hidden(t_detail: string) {
    // ... toggle logic ...
    await tick();
    hits.recalibrate();
}
```

## Visibility Store Integration

Details panel visibility controlled by `show.w_show_details`:

```typescript
// From Details manager
details_toggle_visibility() {
    show.w_show_details.update(n => !n);
}

// From Visibility manager
w_show_details = writable<boolean>(true);

// Restored from preferences
this.w_show_details.set(p.read_key(T_Preference.show_details) ?? false);
```

## Constants

```typescript
// From Constants.ts
k.width.details = 200;           // Panel width
k.height.empty = 30;             // Empty state height
k.font_size.details = 11;        // Detail text size
k.font_size.banners = 9;         // Banner text size
k.font_size.info = 8;            // Info text size
k.thickness.separator.details = 1.5;  // Separator thickness
```

## Layout Flow

1. **UX Manager** determines `w_ancestry_forDetails`
2. **Details Manager** creates `S_Banner_Hideable` instances
3. **Visibility Manager** controls which banners are visible
4. **Banner Components** (D_*.svelte) subscribe to ancestry changes
5. **Banner_Hideable.svelte** wraps each section with collapse logic
6. **Hit Testing** updated after visibility changes

## Edge Cases

1. **No ancestry**: Components show "nothing to show" message
2. **Search active**: Selection banner shows search result count
3. **Non-editable ancestry**: Color picker disabled
4. **Empty collections**: Show "no tags" / "no traits"
5. **Properties toggle**: Separator controls visibility of additional properties

## Performance

- **Reactive triggers**: Only re-render when combined dependencies change
- **Lazy rendering**: Collapsed sections use `{#if hideable_isVisible}`
- **Hit recalibration**: Only after visibility changes (not on every update)
- **S_Items integration**: Reuses UX manager's collections instead of duplicating

## Comparison: Focus vs Details

| Aspect | Focus | Details |
|--------|-------|---------|
| Purpose | Navigation target | Display target |
| Source | Latest in recents history | Prioritized selection |
| Priority | N/A | Search → Grabs → Focus |
| Store | `x.w_ancestry_focus` | `x.w_ancestry_forDetails` |
| Usage | Drives graph layout | Drives details panel |

This separation allows searching/multi-selecting while maintaining stable focus.

## Related Managers

- **UX**: Provides `w_ancestry_forDetails` and all S_Items collections
- **Visibility**: Controls banner visibility via `w_t_details`
- **Preferences**: Persists detail visibility and properties state
- **Hits**: Recalibrated when banners expand/collapse
- **Colors**: Provides color picker for selection details

## Best Practices

✅ **DO**:
- Use `w_ancestry_forDetails` for display (not `w_ancestry_focus`)
- Recalibrate hits after visibility changes
- Use reactive triggers to combine dependencies
- Check for null ancestry before rendering

❌ **DON'T**:
- Directly mutate `w_t_details` array (use toggle logic)
- Forget to call `hits.recalibrate()` after layout changes
- Duplicate S_Items from UX manager (reference them)
- Assume ancestry exists (check for null)
- Mix focus and details concepts

## Usage Example

```typescript
import { details } from '../managers/Details';
import { x } from '../managers/UX';

// Get current details ancestry
const ancestry = get(x.w_ancestry_forDetails);

// Navigate to next tag
details.select_next('tags', T_Direction.next);

// Toggle banner visibility
details.s_banner_hideables_dict_byType[T_Detail.traits].slot_isVisible = !slot_isVisible;

// Get banner title
const title = details.banner_title_forDetail(T_Detail.selection);

// Toggle entire details panel
details.details_toggle_visibility();
```
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/paging.md
```md
# Radial Paging System Architecture

Three clusters of widgets nestle around the radial ring. Often enough, there's not enough room. So, we show only a page at a time. The user can adjust the page. Lots of ghastly geometry goes into making it feel comfortable.

## Table of Contents
- [Overview](#overview)
- [Key Classes](#key-classes)
- [Architecture](#architecture)
  - [G_Pages](#g_pages)
  - [G_Paging](#g_paging)
  - [G_Cluster_Pager](#g_cluster_pager)
- [Layout Flow](#layout-flow)
- [Page Navigation](#page-navigation)
- [Paging UI](#paging-ui)
- [Constants](#constants)
- [Integration Points](#integration-points)
- [Edge Cases](#edge-cases)
- [Performance](#performance)
- [Related Files](#related-files)

## Overview

The radial graph supports paging when clusters have too many widgets to display comfortably. Three geometry classes coordinate to provide paging UI and state management.

## Key Classes

| Class | File | Purpose |
|-------|------|---------|
| `G_Paging` | `geometry/G_Paging.ts` | Paging calculations per predicate direction |
| `G_Pages` | `geometry/G_Pages.ts` | Page state management per Thing |
| `G_Cluster_Pager` | `geometry/G_Cluster_Pager.ts` | Paging arc geometry and UI |

## Architecture

### G_Pages

Tracks which page is currently visible for each Thing:

```typescript
class G_Pages {
    private pages_dict: Dictionary<number> = {};  // thingHID → page number

    get_page_forThingHID(hid: string): number {
        return this.pages_dict[hid] ?? 0;
    }

    set_page_forThingHID(hid: string, page: number) {
        this.pages_dict[hid] = page;
    }
}
```

Stored in Radial manager: `radial.g_pages`

### G_Paging

Computes paging for a specific predicate direction (contains, related, etc.):

```typescript
class G_Paging {
    page: number;               // Current page number
    count_pages: number;        // Total pages
    count_perPage: number;      // Widgets per page
    offset_first: number;       // Index of first widget on page

    constructor(
        count_total: number,    // Total widgets in cluster
        page: number            // Current page
    ) {
        this.count_perPage = k.count_perPage;  // From Constants
        this.count_pages = Math.ceil(count_total / this.count_perPage);
        this.page = Math.min(page, this.count_pages - 1);
        this.offset_first = this.page * this.count_perPage;
    }

    get count_onPage(): number {
        return Math.min(this.count_perPage, count_total - this.offset_first);
    }
}
```

### G_Cluster_Pager

Provides geometry for paging arc UI:

```typescript
class G_Cluster_Pager {
    arc: G_Arc;                 // Paging arc geometry
    thumb_angle: number;        // Current page indicator angle
    label_position: G_Point;    // Position for page label

    constructor(
        cluster: G_Cluster,
        g_paging: G_Paging
    ) {
        // Calculate arc spanning cluster
        this.arc = new G_Arc(
            cluster.start_angle,
            cluster.end_angle,
            cluster.radius_outer
        );

        // Calculate thumb position
        const thumb_fraction = g_paging.page / g_paging.count_pages;
        this.thumb_angle = this.arc.angle_at_fraction(thumb_fraction);

        // Calculate label position
        this.label_position = this.arc.point_at_angle(this.thumb_angle);
    }
}
```

## Layout Flow

1. **G_RadialGraph.layout()** iterates clusters
2. For each cluster with paging:
   ```typescript
   const page = radial.g_pages.get_page_forThingHID(thing.hid);
   const g_paging = new G_Paging(cluster.count_widgets, page);
   cluster.g_paging = g_paging;
   ```
3. **G_Cluster.layout()** uses `g_paging.offset_first` and `g_paging.count_onPage` to determine visible widgets
4. If `count_pages > 1`, create `G_Cluster_Pager` for UI
5. **Svelte components** render paging arc and controls

## Page Navigation

```typescript
// In Radial manager or cluster interaction
function next_page(thing: Thing) {
    const current = radial.g_pages.get_page_forThingHID(thing.hid);
    const total_pages = cluster.g_paging.count_pages;
    const next = (current + 1) % total_pages;
    radial.g_pages.set_page_forThingHID(thing.hid, next);
    g.grand_build();  // Rebuild graph with new page
}
```

## Paging UI

**Slider mode** (T_Cluster_Pager.sliders):
- Draggable thumb on arc
- Shows current page / total pages
- Drag to change page

**Stepper mode** (T_Cluster_Pager.steppers):
- Previous/next buttons
- Page indicator
- Click to increment/decrement

Controlled by `show.w_t_cluster_pager` store.

## Constants

```typescript
// In Constants.ts
class Constants {
    count_perPage = 10;  // Default widgets per page
}
```

Can be overridden per cluster based on cluster size or user preference.

## Integration Points

- **Radial manager**: Owns `g_pages` instance
- **G_Cluster**: Uses `g_paging` to filter visible widgets
- **G_RadialGraph**: Creates `G_Paging` instances during layout
- **Visibility**: Controls pager UI mode (`w_t_cluster_pager`)
- **Geometry manager**: Triggers rebuild on page change (`g.grand_build()`)

## Edge Cases

1. **Single page**: No pager UI shown
2. **Last page**: May have fewer widgets than `count_perPage`
3. **Page out of bounds**: Clamped to valid range
4. **Empty cluster**: No paging needed
5. **Dynamic cluster size**: Pages recalculated on data changes

## Performance

- **Paging state**: O(1) lookup by thingHID
- **Page calculation**: O(1) per cluster
- **No re-indexing**: Pages stable until cluster size changes
- **Lazy rebuild**: Only recalculates on page change

## Related Files

- `src/lib/ts/geometry/G_Paging.ts`
- `src/lib/ts/geometry/G_Pages.ts`
- `src/lib/ts/geometry/G_Cluster_Pager.ts`
- `src/lib/ts/managers/Radial.ts`
- `src/lib/svelte/radial/Cluster_Pager.svelte`
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/breadcrumbs.md
```md
# Breadcrumbs Design

Breadcrumbs show either ancestry path or navigation history. Three parts work together - selector, next/previous buttons, and the crumb buttons themselves. This doc maps out how they coordinate with UX manager to track history and restore grabs.

> **Migration plans** have been moved to .

## Overview

The breadcrumbs system provides navigation through the ancestry hierarchy and browsing history. It consists of three integrated components that work together to display and navigate between different ancestries in the graph.

## Three Parts

### 1. Selector (Segmented Component)

**Location**: `src/lib/svelte/controls/Primary_Controls.svelte` (lines 153-158)

The selector is a segmented control that allows users to switch between two breadcrumb display modes:

- **`T_Breadcrumbs.ancestry`**: Shows the heritage path from root to the current `ancestry_forDetails`
- **`T_Breadcrumbs.history`**: Shows the navigation history stored in `x.si_recents`

**Implementation**: Uses `Segmented` component with `handle_breadcrumbs` callback that updates `show.w_t_breadcrumbs` store.

**Key Reference in UX.ts**: The mode selection determines which data source `Breadcrumbs.svelte` uses (see `ancestries_forBreadcrumbs()` function).

### 2. Next/Previous (Next_Previous Component)

**Location**: `src/lib/svelte/controls/Primary_Controls.svelte` (lines 81-85)

The next/previous buttons allow navigation through the recents history when in history mode.

**Implementation**: 
- Uses `Next_Previous` component with `handle_recents_mouseClick` closure
- Calls `x.ancestry_next_focusOn(index == 1)` where `index == 1` means "next" (down/forward)

**Key Reference in UX.ts**: 
- `ancestry_next_focusOn(next: boolean)` (lines 80-98)
  - Navigates through `x.si_recents` using `si_recents.find_next_item(next)`
  - Extracts the current item as `[Ancestry, S_Items<Ancestry> | null]` pair
  - Sets focus ancestry and restores the associated grabs
  - Ensures all grabbed ancestries are visible via `ancestry_assureIsVisible()`

### 3. Crumb Buttons (Breadcrumb_Button Components)

**Location**: `src/lib/svelte/mouse/Breadcrumb_Button.svelte`

Individual clickable buttons for each ancestry in the breadcrumb trail. Each button displays the ancestry's `breadcrumb_title` and allows direct navigation to that ancestry.

**Implementation**:
- Each button calls `ancestry.becomeFocus()` on click (line 65)
- This updates the focus and adds the ancestry to recents history
- Buttons are styled with colors from the ancestry's thing

**Key Reference in UX.ts**:
- `becomeFocus(ancestry: Ancestry)` (lines 100-113)
  - Creates a pair `[ancestry, this.si_grabs]` and pushes to `x.si_recents`
  - Sets the focus ancestry and expands it
  - Updates `ancestry_forDetails`

## Responsibilities

### Breadcrumbs Component (`src/lib/svelte/controls/Breadcrumbs.svelte`)

**Primary Responsibilities**:
1. **Data Source Selection**: Chooses between ancestry heritage or recents history based on `w_t_breadcrumbs` mode
2. **Layout Calculation**: Delegates to `g.layout_breadcrumbs()` to determine which ancestries fit and their positions
3. **Reactive Updates**: Responds to changes in:
   - `w_t_breadcrumbs` (mode selector)
   - `w_ancestry_forDetails` (current ancestry)
   - `x.si_recents` (history)
   - `x.si_grabs` (grabbed items)
   - `w_rect_ofGraphView` (window size)
   - `w_s_title_edit` (editing state)
   - `w_s_search` (search state)
4. **Rendering**: Creates `Breadcrumb_Button` components for each visible ancestry with separators between them

**Key Function**: `ancestries_forBreadcrumbs()` (lines 49-55)
```typescript
if ($w_t_breadcrumbs == T_Breadcrumbs.ancestry) {
    return $w_ancestry_forDetails.heritage;  // Path from root to current
} else {
    return x.si_recents.items.map(item => item[0]);  // History of focus changes
}
```

### UX.ts Manager (`src/lib/ts/managers/UX.ts`)

**Primary Responsibilities**:

1. **Recents Management** (`si_recents: S_Items<Identifiable_S_Items_Pair>`):
   - Stores pairs of `[Ancestry, S_Items<Ancestry> | null]`
   - First element: the focus ancestry at that point in history
   - Second element: the grabs associated with that focus (or null)
   - Maintains navigation history as user moves through the graph

2. **Focus Navigation** (`ancestry_next_focusOn(next: boolean)`):
   - Navigates through recents using `si_recents.find_next_item(next)`
   - Restores both focus ancestry and associated grabs
   - Ensures visibility of all grabbed ancestries
   - Expands the focus ancestry

3. **Focus Recording** (`becomeFocus(ancestry: Ancestry)`):
   - Called when any ancestry becomes focus (including crumb button clicks)
   - Creates history entry: `[ancestry, this.si_grabs]`
   - Pushes to `si_recents` for history tracking
   - Updates focus store and expands ancestry

4. **Grabs Management** (`si_grabs: S_Items<Ancestry>`):
   - Tracks currently selected/grabbed ancestries
   - Preserved with each focus change in recents
   - Restored when navigating history

## Core Design

### Data Flow

```
User Action
    ↓
[Selector] → Updates w_t_breadcrumbs
    ↓
[Breadcrumbs] → ancestries_forBreadcrumbs()
    ↓
    ├─ ancestry mode: ancestry_forDetails.heritage
    └─ history mode: x.si_recents.items.map(item => item[0])
    ↓
[Layout] → g.layout_breadcrumbs() → [crumb_ancestries, widths, lefts]
    ↓
[Render] → Breadcrumb_Button components
    ↓
[Click] → ancestry.becomeFocus()
    ↓
[UX.ts] → becomeFocus() → si_recents.push([ancestry, si_grabs])
    ↓
[Update] → Breadcrumbs reactive block triggers
```

### State Management

**Stores** (from UX.ts):
- `x.si_recents`: History of `[Ancestry, S_Items<Ancestry>]` pairs
- `s.w_ancestry_focus`: Current focus ancestry
- `s.w_ancestry_forDetails`: Ancestry shown in details panel
- `x.si_grabs`: Currently grabbed ancestries
- `show.w_t_breadcrumbs`: Display mode (ancestry vs history)

**Key Relationships**:
- Each entry in `si_recents` represents a navigation point with its associated grabs
- `ancestry_forDetails` determines which ancestries are shown in ancestry mode
- `si_recents` determines which ancestries are shown in history mode
- Grabs are preserved and restored when navigating history

## Flow Diagram

```
┌─────────────────────────────────────────────────────────────┐
│                    Breadcrumbs System                        │
└─────────────────────────────────────────────────────────────┘

┌──────────────┐
│   Selector   │  Toggles between ancestry/history mode
│  (Segmented) │  Updates: show.w_t_breadcrumbs
└──────┬───────┘
       │
       ▼
┌─────────────────────────────────────────────────────────────┐
│              Breadcrumbs Component                           │
│  ancestries_forBreadcrumbs()                                 │
│    ├─ ancestry mode → ancestry_forDetails.heritage           │
│    └─ history mode → x.si_recents.items.map(item => item[0])│
└──────┬───────────────────────────────────────────────────────┘
       │
       ▼
┌─────────────────────────────────────────────────────────────┐
│              Geometry.layout_breadcrumbs()                   │
│  - Calculates which ancestries fit in available width        │
│  - Determines positions (lefts array)                       │
│  - Returns: [crumb_ancestries, widths, lefts, encoded_counts] │
└──────┬───────────────────────────────────────────────────────┘
       │
       ▼
┌─────────────────────────────────────────────────────────────┐
│              Render Breadcrumb_Button Components            │
│  - One button per visible ancestry                          │
│  - Separators between buttons                               │
│  - Styled with ancestry.thing colors                        │
└──────┬───────────────────────────────────────────────────────┘
       │
       ▼
┌─────────────────────────────────────────────────────────────┐
│              User Clicks Crumb Button                        │
│  → ancestry.becomeFocus()                                   │
└──────┬───────────────────────────────────────────────────────┘
       │
       ▼
┌─────────────────────────────────────────────────────────────┐
│              UX.ts.becomeFocus()                             │
│  - Creates pair: [ancestry, si_grabs]                       │
│  - x.si_recents.push(pair)                                  │
│  - s.w_ancestry_focus.set(ancestry)                         │
│  - ancestry.expand()                                        │
│  - x.update_ancestry_forDetails()                           │
└──────┬───────────────────────────────────────────────────────┘
       │
       ▼
┌─────────────────────────────────────────────────────────────┐
│              Reactive Update                                 │
│  Breadcrumbs component reactive block triggers              │
│  → update() → Re-render with new ancestries                  │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│              Next/Previous Navigation                        │
│  User clicks next/previous buttons                           │
│  → x.ancestry_next_focusOn(next)                             │
│    - si_recents.find_next_item(next)                        │
│    - Extract [focus, grabs] from current item                │
│    - Restore focus and grabs                                │
│    - Ensure visibility                                       │
└─────────────────────────────────────────────────────────────┘
```

## Key Interactions with UX.ts

### 1. History Recording
When any ancestry becomes focus (via crumb click, graph navigation, etc.):
- `ancestry.becomeFocus()` → `x.becomeFocus(ancestry)`
- Creates pair: `[ancestry, x.si_grabs]`
- Pushes to `x.si_recents` (line 105)

### 2. History Navigation
When user clicks next/previous buttons:
- `x.ancestry_next_focusOn(next)` (line 80)
- Navigates `x.si_recents` collection
- Restores both focus and grabs from history entry
- Ensures all grabbed ancestries are visible

### 3. Data Source Selection
Breadcrumbs component reads from UX.ts:
- **Ancestry mode**: Uses `ancestry_forDetails.heritage` (path from root)
- **History mode**: Uses `x.si_recents.items.map(item => item[0])` (focus history)

### 4. Grabs Preservation
Each history entry preserves the grabs state:
- When focus changes: `[ancestry, si_grabs]` saved
- When navigating history: grabs restored from entry
- Allows returning to previous selection state

## Implementation Details

### Layout Algorithm
`g.layout_breadcrumbs()` (Geometry.ts, lines 167-194):
1. Reverses ancestries to process from root outward
2. Calculates width for each ancestry based on `breadcrumb_title`
3. Accumulates widths until threshold exceeded
4. Centers if `centered` flag is true
5. Calculates left positions for each crumb
6. Returns filtered ancestries, widths, positions, and encoded counts

### Visibility Management
When navigating history via `ancestry_next_focusOn()`:
- Each grabbed ancestry calls `ancestry_assureIsVisible()` (line 92)
- Ensures graph view adjusts to show all grabbed items
- Maintains visual consistency when restoring history state

### Reactive Triggers
Breadcrumbs component updates when:
- Mode changes (`w_t_breadcrumbs`)
- Focus changes (`w_ancestry_forDetails`)
- History changes (`x.si_recents`)
- Grabs change (`x.si_grabs`)
- Window resizes (`w_rect_ofGraphView`)
- Search state changes (`w_s_search`)
- Title editing state changes (`w_s_title_edit`)

### Index

#### **step 1. convert `w_ancestry_focus` to use index**

`x.si_recents` tracks history. its index is the single source of truth about `s.w_ancestry_focus`. the two must always be in sync. the latter is observed ubiquitously.

##### **migration plan** (six phases)
These phases can be implemented incrementally, but in order, with each phase leaving the app in a safe, running state.

###### **Notes**:
- Phase 1 (subscription) and phase 5 (initialization) have to be implemented and deployed before fully removing direct `w_ancestry_focus.set` calls.
- Phases 2–4 depend on phase 1 being in place, but can still be shipped one by one (for example: update `becomeFocus()` first, `ancestry_next_focusOn()` next, then the remaining setters).
###### 1. **Create derived store subscription**:
   - In `UX.ts.setup_subscriptions()`, add subscription to `si_recents.w_index` and `si_recents.w_items`
   - When either changes, extract ancestry from `si_recents.item[0]` and update `w_ancestry_focus`
   - Handle edge case: if `si_recents.item` is null, use `h.rootAncestry` or current focus
   - Expose a `ux.focus_forIndex` helper that maps an index to an ancestry without mutating history.
   - **Files impacted**: `UX.ts` (code) plus this analysis note.
   - **Status**: implemented.
   - **Risk**: Low, provided the subscription is strictly one‑way: it only reads from `si_recents` and writes to `w_ancestry_focus`. Main concern is handling the empty `si_recents` case without setting focus to `undefined`.
   - **Mitigation**: Keep the subscription read‑only with respect to history (never call `becomeFocus()` or mutate `si_recents` inside it). Always guard the empty case (`if (!si_recents.item) { use root/current focus; return; }`). A reentrancy flag is optional insurance but not required if the subscription never touches `si_recents`.
   
###### 2. **Update `becomeFocus()` method**:
   - Remove direct `s.w_ancestry_focus.set(ancestry)` call (line 128)
   - Keep `si_recents.push(pair)` - this automatically updates index via `S_Items.push()`
   - The subscription from step 1 will update `w_ancestry_focus` automatically
   - **Files impacted**: `UX.ts` (1 file)
   - **Risk**: **Low to Medium**. Svelte subscriptions fire synchronously when stores update, so `si_recents.push()` → `w_index` update → subscription → `w_ancestry_focus.set()` should complete before `update_ancestry_forDetails()` reads the store. However, `update_ancestry_forDetails()` (line 90) reads `w_ancestry_focus` as a fallback, creating a small timing risk. Also risk if `si_recents.push()` fails or doesn't update index as expected.
   - **Mitigation**: 
     - Svelte subscriptions are synchronous, so timing should be safe
     - Add dev-only invariant: `console.assert(si_recents.item?.[0] === ancestry, 'recents index out of sync')` at end of `becomeFocus()`
     - If needed, pass `ancestry` parameter directly to `update_ancestry_forDetails()` instead of relying on store read
     - Use the `ancestry` parameter directly anywhere in `becomeFocus()` that needs immediate access
   - **Verification tests**:
     - [x] Call `ancestry.becomeFocus()` and immediately check `get(s.w_ancestry_focus)` equals the ancestry
     - [x] Verify `si_recents.item[0]` equals the ancestry after `becomeFocus()` returns
     - [x] Verify `update_ancestry_forDetails()` gets correct ancestry (not stale) when called from `becomeFocus()`
     - [x] Test rapid successive `becomeFocus()` calls to ensure no race conditions
     - [x] Verify breadcrumb button click updates focus correctly
   - **Status**: ✅ Implemented. Removed direct `s.w_ancestry_focus.set()` call, added dev-only invariant assertion. Tests created in `src/lib/ts/tests/UX_becomeFocus.test.ts`.

###### 3. **Update `ancestry_next_focusOn()` method**:
   - Remove direct `s.w_ancestry_focus.set(focus)` call (line 107)
   - Keep `si_recents.find_next_item(next)` - this updates index
   - The subscription from step 1 will update `w_ancestry_focus` automatically
   - **Files impacted**: `UX.ts` (1 file). Call sites (`Primary_Controls.svelte`, `Events.ts`) don't need changes.
   - **Risk**: **Low**. Svelte subscriptions fire synchronously, so timing is safe. Main risks are: (1) `si_recents` is empty (`find_next_item` returns false, `si_recents.item` is null), (2) `find_next_item` fails to find valid item (returns false but doesn't throw), (3) `si_recents.item` is null after navigation. The method already handles null checks, but should early-return if recents is empty.
   - **Mitigation**: 
     - Early-return when `si_recents.length === 0` before calling `find_next_item`
     - After `find_next_item(next)`, verify `si_recents.item` is not null before accessing it
     - The subscription will handle updating `w_ancestry_focus` synchronously
     - If callers need immediate access to new focus, they can read `x.si_recents.item?.[0]` directly
   - **Verification tests**:
     - [x] Test navigation forward (`next=true`) through recents history
     - [x] Test navigation backward (`next=false`) through recents history
     - [x] Test empty recents case (should early-return gracefully)
     - [x] Test that `w_ancestry_focus` updates correctly after navigation
     - [x] Test that grabs are restored from history entry
     - [x] Test that all grabbed ancestries are made visible
   - **Status**: ✅ Implemented. Removed direct `s.w_ancestry_focus.set()` call, added early-return for empty recents, added null checks. Tests created in `src/lib/ts/tests/UX_ancestry_next_focusOn.test.ts`.

###### 4. **Find and update all direct setters**:
   - Search for all `s.w_ancestry_focus.set()` calls
   - Replace with either:
     - `ancestry.becomeFocus()` if setting a new focus (adds to history)
     - `x.si_recents.index = targetIndex` if navigating to existing history entry
   - **Files impacted**: `Preferences.ts` (line 116). Note: `UX.ts` line 68 in `update_focus_from_recents()` is CORRECT - it's the subscription handler from phase 1 and should remain.
   - **Risk**: **Low to Medium**. Only one direct setter found outside the subscription handler. The `Preferences.ts` setter (line 116) is redundant since `becomeFocus()` is called immediately after (line 134). Risk of missing setters in dynamic/generated code is low since TypeScript will catch most. Main risk is understanding initialization context - the direct set happens during startup before `becomeFocus()` is called, but `becomeFocus()` will handle it correctly.
   - **Mitigation**: 
     - Remove redundant direct set on line 116 in `Preferences.ts` - `becomeFocus()` on line 134 will handle focus setting and add to history
     - The direct set only occurs when `c.eraseDB > 0`, but `becomeFocus()` is called anyway, making it redundant
     - Verify initialization sequence: `restore_focus()` is called during startup, and `becomeFocus()` will properly initialize history
     - Add comment explaining why direct set was removed
   - **Verification tests**:
     - [x] Test that `restore_focus()` correctly sets focus via `becomeFocus()` (not direct set)
     - [x] Test initialization with `eraseDB > 0` flag
     - [x] Test initialization with saved focus path from preferences
     - [x] Verify focus is added to recents history during initialization
     - [x] Verify no duplicate history entries are created
     - [x] Test that preferences subscription still works (line 136-138)
     - [x] Verify all direct setters have been found and updated (grep verification)
   - **Status**: ✅ Implemented. Removed redundant direct `s.w_ancestry_focus.set()` call from `Preferences.ts` line 116. The `becomeFocus()` call on line 134 now handles focus setting and history management. Tests created in `src/lib/ts/tests/UX_direct_setters.test.ts`.

###### 5. **Handle initialization**:
   - Ensure `si_recents` has at least one entry (root ancestry) before subscriptions are set up
   - Or initialize `w_ancestry_focus` directly during startup, then sync to `si_recents`
   - **Files impacted**: `UX.ts` (setup_subscriptions), `Preferences.ts` (restore_focus), `Hierarchy.ts` (wrapUp_data_forUX, restore_fromPreferences), `DB_Common.ts` (hierarchy_setup_fetch_andBuild)
   - **Risk**: **Low**. Initialization sequence is: `restore_focus()` → `becomeFocus()` → adds to `si_recents` → then `setup_subscriptions()` is called. The subscription handler (`update_focus_from_recents()`) already handles empty `si_recents` with fallback to existing focus or root. Main risk is if `restore_focus()` doesn't call `becomeFocus()` (when `ancestryToFocus` is null), leaving `si_recents` empty when subscription is set up.
   - **Mitigation**: 
     - Add assertion in `setup_subscriptions()` that `si_recents.length > 0` after `restore_focus()` completes
     - Ensure `restore_focus()` always seeds `si_recents` even if `ancestryToFocus` is null (use `h.rootAncestry`)
     - The existing fallback in `update_focus_from_recents()` (line 64) already handles empty case gracefully
     - Verify initialization order: `restore_focus()` must complete before `setup_subscriptions()` is called
   - **Verification tests**:
     - [x] Test that `si_recents` has at least one entry after `restore_focus()` completes
     - [x] Test that `setup_subscriptions()` doesn't crash when `si_recents` is empty (should use fallback)
     - [x] Test initialization sequence: `restore_focus()` → `becomeFocus()` → `si_recents` populated → `setup_subscriptions()`
     - [x] Test case where `ancestryToFocus` is null in `restore_focus()` - should still seed recents
     - [x] Verify subscription handler handles empty `si_recents` gracefully
     - [x] Test that `w_ancestry_focus` is set correctly after initialization
     - [x] Test initialization in both code paths: `Hierarchy.wrapUp_data_forUX()` and `DB_Common.hierarchy_setup_fetch_andBuild()`
   - **Status**: ✅ Implemented. Added assertion in `setup_subscriptions()` to verify `si_recents.length > 0`. Updated `restore_focus()` to always seed `si_recents` with `rootAncestry` even if `ancestryToFocus` is null. Tests created in `src/lib/ts/tests/UX_initialization.test.ts`.

###### 6. **Testing**:
   - Verify breadcrumb navigation updates focus correctly
   - Verify `becomeFocus()` adds to history and updates focus
   - Verify next/previous buttons sync focus with history index
   - Verify all reactive subscriptions to `w_ancestry_focus` still work
   - **Risk**: **Low to Medium**. May miss edge cases like rapid successive focus changes, empty history scenarios, or concurrent updates. Reactive subscriptions in Svelte components may behave differently if store updates are asynchronous. Must test all code paths that read `w_ancestry_focus`. However, Svelte subscriptions are synchronous, so timing issues are minimal. Main risk is missing edge cases in integration scenarios.
   - **Mitigation**: 
     - Add comprehensive integration tests covering all user interaction patterns
     - Test rapid successive focus changes to ensure no race conditions
     - Test empty history scenarios to verify fallback behavior
     - Test mode switching (ancestry/history) while navigating
     - Test history truncation and navigation edge cases
     - Verify all reactive subscriptions fire correctly (Widget.svelte, D_Selection.svelte, Widget_Title.svelte, Radial_Rings.svelte, Widget_Drag.svelte, Tree_Graph.svelte, Radial_Graph.svelte, Graph.svelte)
     - Use temporary debug logging around `si_recents.index`, `si_recents.item`, and `w_ancestry_focus` to verify they stay in lockstep
   - **Files impacted**: 
     - `src/lib/ts/tests/UX_integration.test.ts` (new test file)
     - All Svelte components that reactively use `w_ancestry_focus`:
       - `src/lib/svelte/widget/Widget.svelte`
       - `src/lib/svelte/details/D_Selection.svelte`
       - `src/lib/svelte/widget/Widget_Title.svelte`
       - `src/lib/svelte/radial/Radial_Rings.svelte`
       - `src/lib/svelte/widget/Widget_Drag.svelte`
       - `src/lib/svelte/tree/Tree_Graph.svelte`
       - `src/lib/svelte/radial/Radial_Graph.svelte`
       - `src/lib/svelte/main/Graph.svelte`
     - `src/lib/svelte/controls/Breadcrumbs.svelte` (breadcrumb rendering)
     - `src/lib/svelte/mouse/Breadcrumb_Button.svelte` (breadcrumb clicks)
     - `src/lib/svelte/mouse/Next_Previous.svelte` (next/previous navigation)
   - **Verification tests**:
     - [x] Test breadcrumb button click updates focus correctly
     - [x] Test next/previous navigation syncs focus with recents index
     - [x] Test rapid successive focus changes
     - [x] Test empty history scenarios
     - [x] Test sync between si_recents.index and w_ancestry_focus
     - [x] Test ancestry_forDetails updates when focus changes
     - [x] Test history truncation handling
     - [x] Test subscription handler updates focus from recents
     - [x] Test mode switching between ancestry and history
     - [x] Test reactive subscriptions to w_ancestry_focus fire correctly
     - [x] Test navigation followed by breadcrumb click
     - [x] Test concurrent updates
   - **Manual testing**:
     - [ ] Verify all call sites of `becomeFocus()` still work (Events.ts, Hierarchy.ts, Breadcrumb_Button.svelte, etc.)
     - [ ] Test keyboard shortcuts `[` and `]` still work (Events.ts)
     - [ ] Test recents button clicks still work (Primary_Controls.svelte)
     - [ ] Verify all Svelte components update correctly when focus changes
     - [ ] Verify breadcrumb UI updates in both ancestry and history modes
     - [ ] Verify next/previous buttons work correctly in history mode
   - **Status**: ✅ Implemented. Created comprehensive integration test suite in `src/lib/ts/tests/UX_integration.test.ts` with 12 test cases covering all major interaction patterns and edge cases.

#### **step 2. Move `w_ancestry_focus`**
Move `w_ancestry_focus` from `Stores` into `UX` as a writable focus store owned by `S_UX`, with a thin forwarding getter on `Stores` for compatibility.
##### **risk**

**Breaking Svelte reactivity**: If the forwarding getter on `Stores` doesn't properly expose the writable store, Svelte components using `$s.w_ancestry_focus` may lose reactivity. The forwarding pattern must maintain the writable store interface.  
**Mitigation**: Keep `w_ancestry_focus` as a real `Writable<Ancestry>` on `UX` and have `Stores` return `x.w_ancestry_focus` directly (no wrappers). In Svelte, continue to destructure `const { w_ancestry_focus } = s;` so `$w_ancestry_focus` still works.

**Circular dependency risk**: `UX` imports from `Stores` (via `s`), and `Stores` would need to forward to `UX`. This creates a circular dependency that must be carefully managed, possibly requiring a lazy getter or initialization pattern.  
**Mitigation**: Move the focus store wiring into a small, dedicated module (e.g., `Focus.ts`) that both `Stores` and `UX` import from, or have `Stores` depend on `UX` but not vice‑versa (replace direct `s.w_ancestry_focus` reads inside `UX` with `x.w_ancestry_focus`). Use TypeScript’s module graph to verify dependencies are acyclic.

**Subscription breakage**: 16 TypeScript files subscribe to or read `s.w_ancestry_focus`. All subscriptions must be updated to use `x.w_ancestry_focus` or the forwarding getter must be implemented before the store is moved.  
**Mitigation**: Perform the move in two phases: (1) introduce `x.w_ancestry_focus` and have `Stores` forward to it while keeping the old field, (2) update all call sites to import from `x` (or the new focus module), then finally remove the old `Stores` field. Run the TypeScript compiler after each phase to catch any missed locations.

**Missing migration locations**: With 36 total files impacted (16 TS, 8 Svelte, 12 docs), there's risk of missing some usages. TypeScript compiler errors will catch most, but edge cases in reactive statements or dynamic access might be missed.  
**Mitigation**: Use `grep`/TS‑server search on both `w_ancestry_focus` and `$w_ancestry_focus`, and temporarily mark the old symbol as deprecated or renamed so any remaining references show up as errors. For docs, search in `notes/` and update manually as part of the same PR.

**Type compatibility**: The forwarding getter must return the exact same `Writable<Ancestry>` type to maintain type safety and prevent downstream type errors.  
**Mitigation**: Define the store’s type once (e.g., `type FocusStore = Writable<Ancestry>;`) and use it for both `UX` and `Stores` declarations. Add a small compile‑time check function that only accepts a `Writable<Ancestry>` to ensure the forwarded value matches the expected type.

##### impacted files
- **runtime/TS files**:
  - [ ] `UX.ts`
  - [ ] `Stores.ts`
  - [ ] `Ancestry.ts`
  - [ ] `G_Cluster.ts`
  - [ ] `Radial.ts`
  - [ ] `S_Rotation.ts`
  - [ ] `Styles.ts`
  - [ ] `Events.ts`
  - [ ] `Preferences.ts`
  - [ ] `Utilities.ts`
  - [ ] `Signals.ts`
  - [ ] `Thing.ts`
  - [ ] `Hierarchy.ts`
  - [ ] `G_TreeGraph.ts`
  - [ ] `G_RadialGraph.ts`
  - [ ] `DB_Bubble.ts`
- **Svelte components**:
  - [ ] `Widget.svelte`
  - [ ] `D_Selection.svelte`
  - [ ] `Widget_Title.svelte`
  - [ ] `Radial_Rings.svelte`
  - [ ] `Widget_Drag.svelte`
  - [ ] `Tree_Graph.svelte`
  - [ ] `Radial_Graph.svelte`
  - [ ] `Graph.svelte`
- **notes/docs**:
  - [ ] `breadcrumbs.md`
  - [ ] `styles-manager.md`
  - [x] `slim/SlimStores.ts`
  - [ ] `stores.md`
  - [ ] `hover.widget.md`
  - [ ] `Resize_Optimization_AI.md`
  - [ ] `project guide.md`
  - [x] `Widget_Title.svelte` (2025 archive)
  - [ ] `Radial_Focus.svelte`
  - [x] `DB_Bubble.abandoned.ts`
  - [x] `DB_Bubble.ts` (2025 archive)
  - [ ] `Canvas_Graph.svelte
  - [ ] 
## Summary

The breadcrumbs system provides dual navigation modes:
- **Ancestry mode**: Shows hierarchical path from root to current
- **History mode**: Shows navigation history with preserved grab states

All three parts (selector, next/previous, crumb buttons) work together with UX.ts to maintain and navigate through the user's exploration history, preserving both focus and selection state at each navigation point.

## Comparison: Architecture vs Design Documents

Two breadcrumbs documents exist with different purposes:

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/index.md
```md
# Ux

User experience components and interaction patterns.
## Components
- [Breadcrumbs](./breadcrumbs.md) - Navigation breadcrumb system
- [Buttons](./buttons.md) - Button components and interactions
- [Controls](./controls.md) - Primary controls layout and positioning
- [Details](./details.md) - Details panel and information display
- [Paging](./paging.md) - Pagination controls and navigation
- [Preferences](./preferences.md) - User preferences system
- [Search](./search.md) - Search functionality and UI
- [Titles](./titles.md) - Widget title component
## See Also
- [UX Manager](../core/ux.md) - Overall UX coordination and state

## Contents

- [Breadcrumbs](./breadcrumbs.md)
- [Buttons](./buttons.md)
- [Controls](./controls.md)
- [Details](./details.md)
- [Paging](./paging.md)
- [Preferences](./preferences.md)
- [Search](./search.md)
- [Titles](./titles.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/controls.md
```md
# Controls Layout: The `lefts` Array System

The `lefts` array controls horizontal positioning of all the primary controls. Cumulative sum of widths, numeric key order matters. Want to move stuff around? This explains the system and how to reorder without breaking everything.

> **Migration plan** (Grow/Shrink to Next_Previous) has been moved to .

## Table of Contents
- [Overview](#overview)
- [How `lefts` is Computed](#how-lefts-is-computed)
  - [Step 1: Define Widths](#step-1-define-widths)
  - [Step 2: Extract Values in Key Order](#step-2-extract-values-in-key-order)
  - [Step 3: Compute Cumulative Sum](#step-3-compute-cumulative-sum)
- [Control Order](#control-order)
- [How to Change the Order of Controls](#how-to-change-the-order-of-controls)
  - [(a) Change the Order in `left_widths`](#a-change-the-order-in-left_widths)
  - [(b) Update HTML Indices to Match](#b-update-html-indices-to-match)
- [Complete Reordering Workflow](#complete-reordering-workflow)
- [Important Notes](#important-notes)
- [Example: Moving "details" to the End](#example-moving-details-to-the-end)
- [Migration Plan: Grow/Shrink Buttons to Next_Previous](#migration-plan-growshrink-buttons-to-next_previous)
  - [Current Implementation](#current-implementation)
  - [Target Implementation](#target-implementation)
  - [Challenges](#challenges)
  - [Migration Steps](#migration-steps)
  - [Considerations](#considerations)
- [Handler Interface Analysis: Synthetic S_Mouse vs Refactoring](#handler-interface-analysis-synthetic-s_mouse-vs-refactoring)
  - [The Interface Mismatch](#the-interface-mismatch)
  - [Approach A: Create Synthetic S_Mouse Events (Recommended)](#approach-a-create-synthetic-s_mouse-events-recommended)
  - [Approach B: Refactor Handler Interface](#approach-b-refactor-handler-interface)
  - [Recommendation: Approach A with Next_Previous Modification](#recommendation-approach-a-with-next_previous-modification)
  - [Benefits After Migration](#benefits-after-migration)

This document describes how the `lefts` array is computed and used for positioning controls in `Primary_Controls.svelte`, and how to reorder controls.

## Overview

The `lefts` array provides horizontal positions (x-coordinates) for controls in the primary controls bar. It's computed from a `left_widths` object that defines the width of each control segment, then converted to cumulative positions.

## How `lefts` is Computed

### Step 1: Define Widths

The `left_widths` object in `layout_controls()` defines the width of each control segment using numeric keys:

```typescript
// Primary_Controls.svelte (lines 43-55)
function layout_controls() {
	const left_widths = {
		0: features.has_details_button ? 18  : -7,									// details
		1: 11,																		// recents
		2: features.allow_tree_mode	   ? 54  : 0,									// graph type
		3: features.has_zoom_controls  ? 100 : features.allow_tree_mode ? 66 : 34,	// plus
		4: features.has_zoom_controls  ? 26  : 0,									// minus
		5: features.allow_search	   ? 22  : 6,									// easter egg
		6: 23,																		// separator
		7: 42,																		// search toggle
		8: -40,																		// breadcrumbs
	};
	lefts = u.cumulativeSum(Object.values(left_widths));
}
```

### Step 2: Extract Values in Key Order

`Object.values(left_widths)` extracts the width values in numeric key order (0, 1, 2, 3, 4, 5, 6, 7, 8). This order determines the left-to-right sequence of controls.

### Step 3: Compute Cumulative Sum

`u.cumulativeSum()` converts widths to cumulative positions. For example:
- Input widths: `[18, 11, 54, 100, 26, 22, 23, 42, -40]`
- Output `lefts`: `[18, 29, 83, 183, 209, 231, 254, 296, 256]`

Each value in `lefts` represents the cumulative sum up to that point, giving the x-coordinate where each control segment should start.

## Control Order

The order of controls (left to right) is determined by the numeric keys in `left_widths`:

| Index | Control | HTML Usage |
|-------|---------|------------|
| 0 | details button | `lefts[0]` - line 80 |
| 1 | recents (next/previous) | `lefts[1]` - line 72 |
| 2 | graph type segmented | `lefts[2]` - line 107 |
| 3 | plus (grow) button | `lefts[3]` - line 118 |
| 4 | minus (shrink) button | `lefts[4]` - line 133 |
| 5 | easter egg / separator | `lefts[5]` - lines 153, 161, 172 |
| 6 | breadcrumbs start | `lefts[6]` - line 166 |
| 7 | search toggle width | `lefts[7]` - line 101 |
| 8 | breadcrumbs end | `lefts[8]` - line 168 |

## How to Change the Order of Controls

### (a) Change the Order in `left_widths`

To reorder controls, you must renumber the keys in the `left_widths` object. The keys must remain sequential starting from 0, but you can reassign which control gets which key.

**Example: Swap "recents" and "graph type"**

**Before:**
```typescript
const left_widths = {
	0: ..., // details
	1: 11,  // recents
	2: ..., // graph type
	...
};
```

**After:**
```typescript
const left_widths = {
	0: ..., // details
	1: ..., // graph type (moved from index 2)
	2: 11,  // recents (moved from index 1)
	...
};
```

### (b) Update HTML Indices to Match

After reordering `left_widths`, you must update all HTML references to use the new indices.

**Example: After swapping recents and graph type**

1. **Update recents** (was `lefts[1]`, now `lefts[2]`):
```typescript
// Primary_Controls.svelte (line 72)
origin={Point.x(lefts[1])}
```
Change to:
```typescript
origin={Point.x(lefts[2])}
```

2. **Update graph type** (was `lefts[2]`, now `lefts[1]`):
```typescript
// Primary_Controls.svelte (line 107)
origin={Point.x(lefts[2])}
```
Change to:
```typescript
origin={Point.x(lefts[1])}
```

## Complete Reordering Workflow

1. **Identify the controls to swap** - Note their current indices in `left_widths`
2. **Swap the keys in `left_widths`** - Reassign numeric keys while keeping sequential order
3. **Find all HTML usages** - Search for `lefts[oldIndex]` in the template
4. **Update each reference** - Change `lefts[oldIndex]` to `lefts[newIndex]`
5. **Verify spacing** - Adjust width values if needed to maintain proper spacing

## Important Notes

- **Sequential keys required**: Keys must be 0, 1, 2, 3... (no gaps)
- **Width values matter**: Negative values create spacing/overlap (e.g., index 8 uses -40 for breadcrumbs end)
- **Feature flags affect widths**: Many widths are conditional based on `features.has_*` flags
- **Multiple usages**: Some indices are used multiple times (e.g., `lefts[5]` for easter egg and separator)
- **Cumulative nature**: Changing a width at index N affects all subsequent positions

## Example: Moving "details" to the End

If you wanted to move the details button to the rightmost position:

1. **Reorder `left_widths`**:
```typescript
const left_widths = {
	0: 11,  // recents (was 1)
	1: ..., // graph type (was 2)
	2: ..., // plus (was 3)
	3: ..., // minus (was 4)
	4: ..., // easter egg (was 5)
	5: 23,  // separator (was 6)
	6: 42,  // search toggle (was 7)
	7: -40, // breadcrumbs (was 8)
	8: features.has_details_button ? 18 : -7, // details (was 0)
};
```

2. **Update HTML references**:
   - Change `lefts[0]` (details) → `lefts[8]`
   - Change `lefts[1]` (recents) → `lefts[0]`
   - Change `lefts[2]` (graph type) → `lefts[1]`
   - ... and so on for all affected controls

## Migration Plan: Grow/Shrink Buttons to Next_Previous

### Current Implementation

The grow/shrink buttons are currently implemented as separate `Button` components:
- **Grow button**: Uses `T_Control.grow`, custom SVG path `svgPaths.t_cross(size_big, 2)`
- **Shrink button**: Uses `T_Control.shrink`, custom SVG path `svgPaths.dash(size_big, 4)`
- **Positioning**: Separate `lefts[2]` and `lefts[3]` indices
- **Handler**: `e.handle_s_mouseFor_t_control(s_mouse, T_Control.grow/shrink)`
- **No autorepeat**: Currently requires repeated clicks

### Target Implementation

Replace with `Next_Previous` component to:
- **Gain autorepeat**: Built-in autorepeat functionality for continuous scaling
- **Unify pattern**: Consistent with recents control pattern
- **Reduce code**: Single component instead of two separate buttons
- **Better UX**: Autorepeat allows smooth continuous scaling

### Challenges

1. **Custom SVG Icons**: `Next_Previous` uses `T_Direction.previous/next` arrows, but grow/shrink need `t_cross` and `dash` icons
2. **Icon Mapping**: Need to map grow → "next" (increase) and shrink → "previous" (decrease) conceptually
3. **Positioning**: `Next_Previous` uses `origin` (single point), while current uses separate `center` points
4. **Handler Interface**: `Next_Previous` closure receives `column: number` (0=previous, 1=next), needs adapter for `T_Control` enum
5. **Visual Styling**: May need to adjust size/styling to match current appearance

### Migration Steps

#### Option A: Extend Next_Previous Component (Recommended)

1. **Add custom icon support to `Next_Previous.svelte`**:
   - Add optional prop: `custom_icons?: { previous: string, next: string }` (SVG path data)
   - Modify SVG path generation to use custom icons when provided
   - Fall back to `T_Direction` paths when not provided

2. **Update `Primary_Controls.svelte`**:
   - Remove the two separate `Button` components (lines 120-149)
   - Add single `Next_Previous` component:
     ```svelte
     <Next_Previous name='scale'
       size={size_big}
       has_title={false}
       origin={Point.x(lefts[2])}
       custom_icons={{
         previous: svgPaths.dash(size_big, 4),
         next: svgPaths.t_cross(size_big, 2)
       }}
       closure={(column) => {
         const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
         // Create synthetic S_Mouse event or call handler directly
         e.handle_s_mouseFor_t_control(/* ... */, t_control);
       }}/>
     ```

3. **Update `left_widths`**:
   - Combine indices 2 and 3 into single index for scale control
   - Adjust width to accommodate both buttons in `Next_Previous` layout

4. **Handler Adapter**:
   - Create adapter function that converts `Next_Previous` closure pattern to `T_Control` pattern
   - Or modify `handle_s_mouseFor_t_control` to accept direct calls

#### Option B: Create Scale_Controls Component

1. **Create new component** `Scale_Controls.svelte` based on `Next_Previous.svelte`:
   - Copy structure from `Next_Previous`
   - Replace `T_Direction` icons with `t_cross` and `dash`
   - Customize for grow/shrink specific needs

2. **Use in `Primary_Controls.svelte`**:
   - Replace Button components with new `Scale_Controls` component
   - Maintain same positioning and handler interface

### Considerations

- **Autorepeat behavior**: Ensure autorepeat works correctly for scaling operations
- **Visual consistency**: Maintain current button appearance (size, stroke, colors)
- **Positioning**: `Next_Previous` uses `origin` (left edge), may need adjustment for centering
- **Handler compatibility**: See detailed analysis below
- **Testing**: Verify autorepeat doesn't cause performance issues with frequent scale updates
- **Feature flag**: Keep `features.has_zoom_controls` check for conditional rendering

## Handler Interface Analysis: Synthetic S_Mouse vs Refactoring

### The Interface Mismatch

**Current State:**
- `Next_Previous` closure: `(column: number) => any`
  - Receives simple integer: `0` = previous (shrink), `1` = next (grow)
  - Called during autorepeat with no mouse context
  - Stores `autorepeat_events[index]` (MouseEvent) internally

- `handle_s_mouseFor_t_control`: `(s_mouse: S_Mouse, t_control: T_Control) => void`
  - Requires full `S_Mouse` object with `isDown`, `event`, `element`
  - Only acts when `s_mouse.isDown === true`
  - Currently receives `S_Mouse` from Button component's mouse handler

**The Gap:**
`Next_Previous` provides `column` number and stored `MouseEvent`, but `handle_s_mouseFor_t_control` expects a complete `S_Mouse` object.

### Approach A: Create Synthetic S_Mouse Events (Recommended)

#### Implementation

Create an adapter closure that constructs `S_Mouse` instances from `Next_Previous`'s callback:

```typescript
// In Primary_Controls.svelte
function handle_scale_control(column: number) {
	// Get the stored autorepeat event from Next_Previous's internal state
	// This requires accessing Next_Previous's autorepeat_events array
	// OR: Modify Next_Previous to pass event to closure
	
	// For initial click (isDown):
	const s_mouse_down = S_Mouse.down(autorepeat_event, button_element);
	const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
	e.handle_s_mouseFor_t_control(s_mouse_down, t_control);
	
	// For autorepeat (isRepeat):
	const s_mouse_repeat = S_Mouse.repeat(autorepeat_event, button_element);
	e.handle_s_mouseFor_t_control(s_mouse_repeat, t_control);
}
```

#### Challenge: Accessing Autorepeat Event

`Next_Previous` stores `autorepeat_events[index]` internally but doesn't expose it to the closure. Two solutions:

**Solution A1: Modify Next_Previous to Pass Event**
```typescript
// In Next_Previous.svelte
s_element.autorepeat_callback = () => {
	if (autorepeat_events[index]) {
		closure(index, autorepeat_events[index], button_elements[index]); // Pass event and element
	}
};

// Update closure signature
export let closure: (column: number, event: MouseEvent | null, element: HTMLElement | null) => any;
```

**Solution A2: Store Events in Parent Component**
```typescript
// In Primary_Controls.svelte
let scale_autorepeat_events: (MouseEvent | null)[] = [null, null];

function handle_scale_control(column: number, event: MouseEvent | null, element: HTMLElement | null) {
	scale_autorepeat_events[column] = event;
	const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
	
	if (event) {
		// Determine if this is initial down or repeat
		// Next_Previous calls closure on initial down AND during autorepeat
		// Need to distinguish: first call = down, subsequent = repeat
		const isFirstCall = !scale_autorepeat_events[column]; // Simplified check
		const s_mouse = isFirstCall 
			? S_Mouse.down(event, element)
			: S_Mouse.repeat(event, element);
		e.handle_s_mouseFor_t_control(s_mouse, t_control);
	}
}
```

#### Pros of Approach A

- ✅ **Minimal changes**: Works with existing `handle_s_mouseFor_t_control` signature
- ✅ **Type safety**: Uses existing `S_Mouse` type system
- ✅ **Consistency**: Maintains same handler pattern as other controls
- ✅ **Future-proof**: If `handle_s_mouseFor_t_control` needs more `S_Mouse` properties later, they're available
- ✅ **Separation of concerns**: Handler doesn't need to know about `Next_Previous` internals

#### Cons of Approach A

- ❌ **Event tracking complexity**: Need to track which call is first vs repeat
- ❌ **Element reference**: Need to get button element reference (may require Next_Previous modification)
- ❌ **Synthetic nature**: Creating events that didn't come from actual mouse interaction feels artificial

#### Implementation Details

**Distinguishing Initial vs Repeat:**
```typescript
let scale_last_call_time: [number | null, number | null] = [null, null];
const REPEAT_THRESHOLD_MS = 100; // Time between initial and first repeat

function handle_scale_control(column: number, event: MouseEvent | null, element: HTMLElement | null) {
	if (!event) return;
	
	const now = Date.now();
	const lastTime = scale_last_call_time[column];
	const isRepeat = lastTime !== null && (now - lastTime) < REPEAT_THRESHOLD_MS;
	
	scale_last_call_time[column] = now;
	
	const s_mouse = isRepeat 
		? S_Mouse.repeat(event, element)
		: S_Mouse.down(event, element);
	
	const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
	e.handle_s_mouseFor_t_control(s_mouse, t_control);
}
```

**Better: Use Next_Previous's autorepeat_isFirstCall flag:**
If `Next_Previous` exposes whether it's the first call, we can use that directly.

### Approach B: Refactor Handler Interface

#### Implementation

Create a new, simpler handler method that accepts direct control type:

```typescript
// In Events.ts
handle_t_control_direct(t_control: T_Control, isRepeat: boolean = false) {
	// Simplified handler that doesn't need S_Mouse
	switch (t_control) {
		case T_Control.grow:
			g.scaleBy(k.ratio.zoom_in);
			break;
		case T_Control.shrink:
			g.scaleBy(k.ratio.zoom_out);
			break;
		// ... other cases
	}
}

// In Primary_Controls.svelte
<Next_Previous 
	closure={(column) => {
		const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
		e.handle_t_control_direct(t_control);
	}}
/>
```

#### Pros of Approach B

- ✅ **Simpler**: No need to construct `S_Mouse` objects
- ✅ **Direct**: Clear intent, no synthetic events
- ✅ **Performance**: Slightly faster (no object creation)
- ✅ **Cleaner closure**: Just maps column to control type

#### Cons of Approach B

- ❌ **Interface proliferation**: Creates second handler method alongside existing one
- ❌ **Inconsistency**: Different controls use different handler patterns
- ❌ **Limited future flexibility**: If handler needs mouse coordinates, modifiers, etc., need to add parameters
- ❌ **Breaking pattern**: Other controls use `handle_s_mouseFor_t_control`, this would be exception
- ❌ **Loss of context**: No access to `event` (for coordinates, modifiers) or `element` (for positioning)

#### Hybrid Approach B1: Overload with Optional S_Mouse

```typescript
// In Events.ts
handle_s_mouseFor_t_control(s_mouse: S_Mouse | null, t_control: T_Control) {
	if (s_mouse?.isDown || !s_mouse) { // Allow null for direct calls
		switch (t_control) {
			case T_Control.grow: g.scaleBy(k.ratio.zoom_in); break;
			case T_Control.shrink: g.scaleBy(k.ratio.zoom_out); break;
			// ...
		}
	}
}

// In Primary_Controls.svelte
<Next_Previous 
	closure={(column) => {
		const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
		e.handle_s_mouseFor_t_control(null, t_control); // Pass null for S_Mouse
	}}
/>
```

This maintains interface consistency but loses mouse context.

### Recommendation: Approach A with Next_Previous Modification

**Best solution**: Modify `Next_Previous` to pass event and element to closure, then use synthetic `S_Mouse`:

1. **Update Next_Previous.svelte**:
```typescript
export let closure: (column: number, event: MouseEvent | null, element: HTMLElement | null, isFirstCall: boolean) => any;

s_element.autorepeat_callback = () => {
	if (autorepeat_events[index]) {
		closure(index, autorepeat_events[index], button_elements[index], autorepeat_isFirstCall);
		autorepeat_isFirstCall = false;
	}
};
```

2. **Use in Primary_Controls.svelte**:
```typescript
function handle_scale_control(column: number, event: MouseEvent | null, element: HTMLElement | null, isFirstCall: boolean) {
	const t_control = column === 0 ? T_Control.shrink : T_Control.grow;
	const s_mouse = isFirstCall
		? S_Mouse.down(event, element)
		: S_Mouse.repeat(event, element);
	e.handle_s_mouseFor_t_control(s_mouse, t_control);
}

<Next_Previous 
	name='scale'
	closure={handle_scale_control}
	// ... other props
/>
```

**Why this is best:**
- ✅ Maintains type safety and consistency
- ✅ Provides full mouse context when needed
- ✅ Clear distinction between initial click and repeat
- ✅ Minimal changes to existing handler interface
- ✅ Reusable pattern for other controls that might migrate to Next_Previous
```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/preferences.md
```md
# Preferences System: Store Presentation and Persistence

Okay, so I like to give people choices about looks and what have you. Of course their choices need to be remembered for them. It's a computer, for crying sake. This is a walk through how one preference flows from UI click to localStorage and back.

## Table of Contents
- [Overview](#overview)
- [Example: `w_t_auto_adjust_graph`](#example-wt_auto_adjust_graph)
  - [Store Definition](#store-definition)
  - [UI Presentation (`D_Preferences.svelte`)](#ui-presentation-d_preferencessvelte)
  - [Persistence (`Preferences.ts`)](#persistence-preferencests)
- [Complete Flow Diagram](#complete-flow-diagram)
- [Key Patterns](#key-patterns)
- [Other Examples](#other-examples)

This document describes how a preference store (e.g., `w_t_auto_adjust_graph`) is presented in the UI and persisted to localStorage.

## Overview

The preferences system uses a two-way binding pattern:
1. **Presentation**: Svelte stores are bound to a segmented svelte component inside another svelte component
2. **Persistence**: Store changes are automatically saved to localStorage via subscriptions in `Preferences.ts`

## Example: `w_t_auto_adjust_graph`

### Store Definition

The store is defined as a writable Svelte store in `Visibility.ts`:

```typescript
w_t_auto_adjust_graph = writable<T_Auto_Adjust_Graph | null>(null);
```

The `Visibility` class instance is exported as `show`, making the store accessible as `show.w_t_auto_adjust_graph`.

### UI Presentation (`D_Preferences.svelte`)

#### 1. Store Import
The store is destructured from the `show` object:
```typescript
// D_Preferences.svelte (line 23)
const { w_t_details, w_t_countDots, w_t_auto_adjust_graph, w_t_cluster_pager } = show;
```

#### 2. Handler Function
A handler function processes user selections and updates the store:
```typescript
// D_Preferences.svelte (lines 53-55)
function handle_auto_adjust(types: Array<T_Auto_Adjust_Graph | null>) {
	$w_t_auto_adjust_graph = types.length > 0 ? types[0] : null;
}
```

The `$` prefix creates a reactive binding that automatically updates the store when the handler is called.

#### 3. UI Component Binding
The `Segmented` component displays the preference with two-way binding:
```svelte
<!-- D_Preferences.svelte (lines 114-123) -->
<Segmented name='auto-adjust'
	left={106}
	allow_none={true}
	allow_multiple={false}
	width={segmented_width}
	height={segmented_height}
	origin={Point.y(tops[3])}
	selected={[$w_t_auto_adjust_graph]}
	handle_selection={handle_auto_adjust}
	titles={[T_Auto_Adjust_Graph.selection, T_Auto_Adjust_Graph.fit]}/>
```

- `selected={[$w_t_auto_adjust_graph]}`: Reactive binding reads the current store value (wrapped in array for `Segmented` component)
- `handle_selection={handle_auto_adjust}`: Callback invoked when user selects a different option

#### 4. User Interaction Flow

When a user clicks a segment:
1. `Segmented` component's `select()` function is called
2. It calls `handle_selection?.(selection)` with the new selection
3. `handle_auto_adjust()` receives the selection array
4. The store is updated: `$w_t_auto_adjust_graph = types.length > 0 ? types[0] : null`
5. The UI reactively updates to reflect the new selection

### Persistence (`Preferences.ts`)

#### 1. Restoration on Load

When preferences are restored, the store is initialized from localStorage:

```typescript
// Preferences.ts (lines 141-147)
restore_preferences() {
	show.w_t_auto_adjust_graph  .set( this.read_key(T_Preference.auto_adjust)	 ?? null);
	[...]
}
```

- `read_key(T_Preference.auto_adjust)` reads from localStorage using the key `'auto_adjust'`
- The store is set with `.set()` method
- Default value is `null` if nothing is stored

#### 2. Automatic Persistence

A subscription automatically writes changes to localStorage:

```typescript
// Preferences.ts (lines 213-215)
show.w_t_auto_adjust_graph.subscribe((auto_adjust: T_Auto_Adjust_Graph | null) => {
	this.write_key(T_Preference.auto_adjust, auto_adjust);
});
```

- The subscription is set up in `reactivity_subscribe()` method
- Whenever the store value changes, `write_key()` saves it to localStorage
- The localStorage key is `T_Preference.auto_adjust` (which equals `'auto_adjust'`)

#### 3. Storage Methods

The `Preferences` class provides low-level storage methods:

- `read_key(key: string)`: Reads and parses JSON from localStorage
- `write_key(key: string, value: T)`: Serializes and writes to localStorage
- `readDB_key(key: string)`: Reads with database prefix (for multi-database support)
- `writeDB_key(key: string, value: T)`: Writes with database prefix

## Complete Flow Diagram

```
User clicks segment
    ↓
Segmented.select() called
    ↓
handle_selection callback invoked
    ↓
handle_auto_adjust() updates store: $w_t_auto_adjust_graph = newValue
    ↓
Store subscription triggers (in Preferences.reactivity_subscribe)
    ↓
write_key() saves to localStorage['auto_adjust']
    ↓
On next page load: restore_preferences() reads from localStorage
    ↓
Store initialized: show.w_t_auto_adjust_graph.set(savedValue)
    ↓
UI reactively updates to show saved preference
```

## Key Patterns

1. **Reactive Binding**: Use `$storeName` in Svelte templates for automatic UI updates
2. **Handler Pattern**: UI components call handler functions that update stores
3. **Subscription Pattern**: Stores subscribe to changes and persist them automatically
4. **Restoration Pattern**: On initialization, stores are populated from localStorage
5. **Key Mapping**: `T_Preference` enum provides consistent localStorage keys

## Other Examples

The same pattern applies to other preferences:
- `w_t_cluster_pager` → `T_Preference.paging_style`
- `w_t_countDots` → `T_Preference.countDots`
- `w_t_details` → `T_Preference.detail_types`

Each follows the same presentation → handler → store → subscription → persistence flow.

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/ux/titles.md
```md
# Widget_Title Design Responsibilities

Documented the editable title component before replacing it. Captures what it does (display, selection, inline editing, width measurement, hit detection) and how it coordinates with other systems. Completed replacement work.

## Purpose

Widget_Title is the editable text component within a widget that displays and allows editing of a Thing's title. This document captured the existing component and guided implementing its replacement. Completed ✅ 

---

## Core Responsibilities

### 1. Title Display
- Render the Thing's title text with appropriate styling
- Adapt styling based on widget state (grabbed, editing, focus)
- Support both tree mode and radial mode positioning adjustments
- Reflect the Thing's color and font family

### 2. Selection State
- Respond to grab/select interactions on the title
- Coordinate with the grab system (`si_grabs`)
- Support shift-click for multi-selection

### 3. Inline Editing
- Transition between display and edit modes
- Manage text cursor position and selection ranges
- Preserve selection state across mode transitions
- Handle keyboard input during editing (typing, arrow keys, enter, tab)
- Support cut/paste operations

### 4. Edit Lifecycle
- Start editing when appropriate (grabbed + click on editable ancestry)
- Stop editing on blur, enter, or external signals
- Persist changes to the database when editing completes
- Coordinate with `w_s_title_edit` store for cross-component edit state

### 5. Width Measurement
- Use a hidden "ghost" span to measure rendered text width
- Dynamically size the input to fit content
- Trigger layout updates when title length changes significantly

### 6. Hit Detection
- Register with the Hits system for hover detection
- Provide the HTML element for rectangle-based hit testing

---

## Coordination Points

| System | Interaction |
|--------|-------------|
| `w_s_title_edit` | Global edit state store — who is editing, selection range |
| `si_grabs` | Grab/selection system — determines if ancestry is grabbed |
| `Hits` | Hit testing — registers element for hover detection |
| `databases.db_now` | Persistence — saves title changes |
| `g.layout()` | Layout system — triggers re-layout after title changes |

---

## State Dependencies

- **Ancestry state**: grabbed, editing, focus, editable
- **Thing state**: title, color, width_ofTitle
- **Global state**: control mode (tree vs radial), font family, thing color
- **Edit state**: active editor, selection range, edit phase (editing/stopping/percolating)

---

## Behavioral Notes

- Only one title may be edited at a time (global `w_s_title_edit`)
- Clicking a title while another is editing stops the prior edit first
- Tab key creates a new sibling and moves edit focus
- Layout is debounced during typing to prevent jitter

```

### /Users/sand/GitHub/mono/ws/notes/guides/architecture/index.md
```md
# Architecture

**[Start here → Overview](./overview.md)** — big picture diagram and reading order.
---

## Contents

- [Core](./core/)
- [Internals](./internals/)
- [Platforms](./platforms/)
- [Ux](./ux/)
- [Overview](./overview.md)

```

### /Users/sand/GitHub/mono/ws/notes/guides/index.md
```md
# Guides

## Contents

- [Architecture](./architecture/)
- [Collaborate](./collaborate/)

```

### /Users/sand/GitHub/mono/ws/notes/work/next/search.md
```md
# Search

search is mixed up in grabs. let's start over.

## Goals

* Put search results into an `S_Items` object (with next, item, index...)
* One item is "the search result i am interested in"
* Display its breadcrumbs and details
* Browse the results (up and down arrows)
* "Go to" the interesting item (make it focus, grab it)

## Design

- Search has its own `si_results: S_Items<Thing>` — completely separate from grabs
- `si_results.item` is the currently highlighted result
- Browsing results changes `si_results.index` — does NOT touch grabs
- "Go to" explicitly calls `ancestry.becomeFocus()` (does not change grabs?) — a deliberate user action, not automatic
- Details panel shows `si_results.item.ancestry` when search is active.

## Key Principle

Search results are **read-only exploration**. Grabs are **user intent**. They don't mix.

## What Changes

* Remove `update_grabs_forSearch()` — grabs stay untouched during search
* `w_ancestry_forDetails` depends on search mode
* `save_grabs`/restore pattern goes away — grabs never change during search
* Remove search fallback from `isGrabbed` — grabbed means grabbed


```

### /Users/sand/GitHub/mono/ws/notes/work/next/search-links.md
```md
# Search Links

## Problem

Search currently finds Things by title, trait values, or tags. If a Thing has a LINK trait (URL), users can't search the content *at* that URL.

## Goal

Add an optional search mode that:
1. Fetches HTML content from LINK trait URLs
2. Indexes that content
3. Lets users find Things based on their linked content

## Questions

- When to fetch? On-demand when mode enabled? Background on index build?
- Cache strategy? Store fetched content locally? Expiration?
- What to index? Full text? Just visible text (strip HTML)?
- UI for enabling? New `T_Search_Preference.link_content`?
- Error handling? Dead links, slow fetches, CORS issues?

## Approach

*Decisions and changes as we go*

## Resolution

*Verify the solution works*
```

### /Users/sand/GitHub/mono/ws/notes/work/next/Resize_Optimization_AI.md
```md
# Proposal P: Window Resize Performance Optimization

## Problem Statement

When the window resizes, the app lays out everything accordingly as desired. However, some components get relocated before others, causing noticeable pauses during the resize operation. This creates a poor user experience with stuttering and uneven component updates.

## Root Cause Analysis

### 1. Cascading Layout Updates
The resize event triggers a chain reaction of layout updates:

```typescript
// src/lib/ts/signals/Events.ts:112-121
private handle_resize(event: Event) {
    const isMobile = u.device_isMobile;
    w_count_resize.update(n => n + 1);
    w_device_isMobile.set(isMobile);
    layout.restore_state(); // Triggers multiple updates
}
```

The `layout.restore_state()` method triggers:
- `update_graphRect()` - updates the graph rectangle
- `set_scale_factor()` - applies scaling  
- `renormalize_user_graph_offset()` - recalculates offsets

### 2. Multiple Component Reattachments
Several components react to the `w_graph_rect` store changes:

**Panel.svelte:**
```typescript
$: {
    const _ = $w_t_database + $w_t_startup + $w_graph_rect.description;
    update_panel(); // Triggers reattachment
}
```

**Graph.svelte:**
```typescript
$: $w_graph_rect, update_style(); // Updates style and triggers reattachment
```

**Breadcrumbs.svelte:**
```typescript
const needsUpdate = ($w_ancestry_focus?.title ?? k.empty) + $w_graph_rect + ($w_ancestries_grabbed?.length ?? 0);
```

**Controls.svelte:**
```typescript
const _ = $w_graph_rect + $w_count_resize; // Triggers width recalculation
```

### 3. Expensive Layout Calculations
The `grand_layout()` method is called multiple times:

```typescript
// src/lib/ts/layout/G_Layout.ts:20-25
grand_layout() {
    if (ux.inRadialMode) {
        this.g_radialGraph.grand_layout_radial();
    } else {
        get(w_ancestry_focus)?.g_widget.grand_layout_tree();
    }
    signals.signal_reposition_widgets_fromFocus();
}
```

This triggers:
- Radial graph layout calculations
- Tree widget layout calculations
- Widget repositioning signals

### 4. Synchronous DOM Updates
Components use `{#key}` blocks that force complete re-renders:

**Panel.svelte:**
```svelte
{#key panel_reattachments}
    <!-- Complete re-render -->
{/key}
```

**Graph.svelte:**
```svelte
{#key graph_reattachments}
    <!-- Complete re-render -->
{/key}
```

**Breadcrumbs.svelte:**
```svelte
{#key trigger}
    <!-- Complete re-render -->
{/key}
```

### 5. Signal Processing Overhead
The signal system processes multiple priorities synchronously:

```typescript
// src/lib/ts/signals/Signals.ts:45-55
signal(t_signal: T_Signal, value: any = null) {
    if (signals.anySignal_isInFlight) {
        debug.log_signal(`NOT SENDING ${t_signal} in flight`);
    } else if (!signals.signal_isInFlight_for(T_Signal.rebuild) ||
        t_signal != T_Signal.reposition) {
        signals.set_signal_isInFlight_for(t_signal, true);
        const highestPriority = this.highestPriorities[t_signal] ?? 0;
        for (let priority = 0; priority <= highestPriority; priority++) {
            this.conduit.emit(t_signal, priority, value);
        }
        signals.set_signal_isInFlight_for(t_signal, false);
    }
}
```

## Proposed Solutions

### 1. Debounce Resize Events
Implement debouncing for resize events to prevent excessive updates:

```typescript
// src/lib/ts/signals/Events.ts
export class Events {
    private debouncedResize: number | null = null;
    private resizeTimeout: number = 16; // ~60fps

    private handle_resize(event: Event) {
        if (this.debouncedResize) {
            clearTimeout(this.debouncedResize);
        }
        
        this.debouncedResize = setTimeout(() => {
            const isMobile = u.device_isMobile;
            w_count_resize.update(n => n + 1);
            w_device_isMobile.set(isMobile);
            layout.restore_state();
            this.debouncedResize = null;
        }, this.resizeTimeout);
    }
}
```

### 2. Batch Layout Updates
Use `requestAnimationFrame` to batch layout updates:

```typescript
// src/lib/ts/layout/G_Layout.ts
export default class G_Layout {
    private pendingLayoutUpdates = new Set<string>();
    private animationFrameId: number | null = null;

    private scheduleLayoutUpdate(component: string) {
        this.pendingLayoutUpdates.add(component);
        
        if (!this.animationFrameId) {
            this.animationFrameId = requestAnimationFrame(() => {
                this.processLayoutUpdates();
                this.animationFrameId = null;
            });
        }
    }

    private processLayoutUpdates() {
        // Process all pending updates in a single frame
        for (const component of this.pendingLayoutUpdates) {
            this.updateComponentLayout(component);
        }
        this.pendingLayoutUpdates.clear();
    }

    update_graphRect() {
        this.scheduleLayoutUpdate('graph_rect');
    }
}
```

### 3. Optimize Component Reattachments
Reduce the frequency of `{#key}` block reattachments:

```typescript
// src/lib/svelte/main/Panel.svelte
let lastGraphRect = $w_graph_rect;
let significantChange = false;

$: {
    const currentGraphRect = $w_graph_rect;
    const sizeChanged = lastGraphRect.size.width !== currentGraphRect.size.width || 
                       lastGraphRect.size.height !== currentGraphRect.size.height;
    const positionChanged = lastGraphRect.origin.x !== currentGraphRect.origin.x || 
                           lastGraphRect.origin.y !== currentGraphRect.origin.y;
    
    // Only trigger reattachment for significant changes
    if (sizeChanged || (positionChanged && Math.abs(currentGraphRect.origin.x - lastGraphRect.origin.x) > 5)) {
        significantChange = true;
        lastGraphRect = currentGraphRect;
        update_panel();
    }
}
```

### 4. Use CSS Transforms for Positioning
Replace layout property changes with CSS transforms:

```css
/* src/styles/webseriously.css */
.graph-container {
    transform: translate3d(var(--graph-x), var(--graph-y), 0);
    will-change: transform;
    transition: transform 0.1s ease-out;
}

.widget {
    transform: translate3d(var(--widget-x), var(--widget-y), 0);
    will-change: transform;
}
```

```typescript
// src/lib/svelte/graph/Graph.svelte
function update_style() {
    draggableRect = $w_graph_rect;
    const root = document.documentElement;
    root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
    root.style.setProperty('--graph-y', `${draggableRect.origin.y}px`);
    
    style = `
        overflow: hidden;
        touch-action: none;
        position: absolute;
        pointer-events: auto;
        z-index: ${T_Layer.common};
        width: ${draggableRect.size.width}px;
        height: ${draggableRect.size.height}px;
    `.removeWhiteSpace();
}
```

### 5. Lazy Layout Calculations
Only recalculate layouts for visible components:

```typescript
// src/lib/ts/layout/G_Widget.ts
export default class G_Widget {
    private isVisible(): boolean {
        const rect = this.getBoundingClientRect();
        const viewport = new Rect(new Point(0, 0), new Size(window.innerWidth, window.innerHeight));
        return rect.intersects(viewport);
    }

    layout_widget() {
        if (!this.isVisible()) {
            // Defer layout for off-screen widgets
            this.scheduleLayoutWhenVisible();
            return;
        }
        
        // Perform layout calculation
        this.performLayout();
    }
}
```

### 6. Optimize Signal Processing
Reduce signal processing overhead:

```typescript
// src/lib/ts/signals/Signals.ts
export class Signals {
    private signalQueue: Array<{t_signal: T_Signal, value: any}> = [];
    private processingSignals = false;

    signal(t_signal: T_Signal, value: any = null) {
        this.signalQueue.push({t_signal, value});
        
        if (!this.processingSignals) {
            this.processSignalQueue();
        }
    }

    private processSignalQueue() {
        this.processingSignals = true;
        
        requestAnimationFrame(() => {
            const batch = this.signalQueue.splice(0);
            this.processSignalBatch(batch);
            this.processingSignals = false;
            
            if (this.signalQueue.length > 0) {
                this.processSignalQueue();
            }
        });
    }
}
```

### 7. Implement Virtual Scrolling for Large Trees
For large tree structures, implement virtual scrolling:

```typescript
// src/lib/ts/layout/G_TreeBranches.ts
export default class G_TreeBranches {
    private visibleRange = { start: 0, end: 50 };
    
    layout_branches() {
        const ancestry = this.ancestry;
        if (!ancestry || (!ancestry.isExpanded && !ancestry.isRoot) || !ux.inTreeMode) {
            return;
        }
        
        const branchAncestries = ancestry.branchAncestries;
        const visibleBranches = branchAncestries.slice(this.visibleRange.start, this.visibleRange.end);
        
        // Only layout visible branches
        for (const branchAncestry of visibleBranches) {
            if (branchAncestry.depth > ancestry.depth) {
                const g_widget = branchAncestry.g_widget;
                g_widget.layout_treeBranches(height, origin_ofWidget, T_Graph.tree);
                height += g_widget.size_ofSubtree.height;
            }
        }
    }
}
```

## Implementation Priority

### Phase 1 (High Impact, Low Risk)
1. **Debounce Resize Events** - Immediate performance improvement
2. **Use CSS Transforms** - Reduce layout thrashing
3. **Optimize Component Reattachments** - Reduce unnecessary re-renders

### Phase 2 (Medium Impact, Medium Risk)
4. **Batch Layout Updates** - Improve frame rate consistency
5. **Optimize Signal Processing** - Reduce processing overhead

### Phase 3 (High Impact, High Risk)
6. **Lazy Layout Calculations** - Improve performance for large datasets
7. **Virtual Scrolling** - Handle very large tree structures

## Expected Performance Improvements

- **Resize Responsiveness**: 60fps smooth resizing
- **Reduced Layout Thrashing**: 70% reduction in layout calculations
- **Faster Component Updates**: 50% reduction in reattachment time
- **Better Memory Usage**: Reduced memory allocation during resize

## Testing Strategy

1. **Performance Profiling**: Use Chrome DevTools Performance tab to measure before/after
2. **Frame Rate Monitoring**: Ensure consistent 60fps during resize
3. **Memory Usage**: Monitor memory allocation during resize operations
4. **Cross-browser Testing**: Verify improvements across different browsers
5. **Large Dataset Testing**: Test with trees containing 1000+ nodes

## Risk Mitigation

1. **Incremental Implementation**: Implement changes one at a time
2. **Feature Flags**: Use feature flags to enable/disable optimizations
3. **Fallback Mechanisms**: Maintain original behavior as fallback
4. **Comprehensive Testing**: Test all resize scenarios thoroughly

## Timeline

- **Week 1**: Implement Phase 1 optimizations
- **Week 2**: Implement Phase 2 optimizations  
- **Week 3**: Implement Phase 3 optimizations
- **Week 4**: Testing, refinement, and documentation

---

*Proposal P - Window Resize Performance Optimization*
*Created: [Current Date]*
*Status: Proposed* ```

### /Users/sand/GitHub/mono/ws/notes/work/next/amnesia.md
```md
# The Amnesia inherent in a New Chat

**Started:** 2025-01-22

Summary of steps taken during "go ws" initialization, plus research on AI memory systems.

## Steps

 1. **Attempted ws CLAUDE.MD** — failed, wrong path (`/Users/jonathanmast/...`)
 2. **Listed allowed directories** — discovered correct base is `/Users/sand/GitHub`
 3. **Explored mono structure** — found `mono/projects/ws/CLAUDE.MD`
 4. **Read ws/CLAUDE.MD** — instructions: read `../../CLAUDE.MD` and `notes/guides/*.md`
 5. **Read mono/CLAUDE.MD** — shared context: defaults, gates, workarounds
 6. **Read collaborate guides (batch 1)** — index, access, chat, evolve, filesystem, gating
 7. **Read collaborate guides (batch 2)** — journals, markdown, repo, shorthand, voice, workflow
 8. **Read mono/notes/work files** — index, revisit.md, journal.md
 9. **Explored ws/notes** — found collaborate dir (no guides dir)
10. **Read ws-specific guides** — gotchas.md, composition.md (Svelte patterns)
11. **Read ws/notes/work files** — index, deliverables.md (bug tracking)
12. **Searched for recents docs** — found done/recents.md
13. **Read recents.md** — learned Phase 5 complete, redesign finished Jan 21
14. **Summarized state** — noted memory about "Phase 3 next" is stale

## Observations

* Path discovery took 4 tool calls (could be 1 if I knew the base path)
* ws/CLAUDE.MD says "Read all `.md` files in `notes/guides/`" but that dir doesn't exist — actual guides are in `notes/collaborate/`
* Memory said "Phase 3 next" for recents but the work is complete

## userMemories Staleness Discovery

**Problem:** userMemories contained stale entry "ws recents redesign: Phase 1-2 done, Phase 3 next" — but that work completed Jan 21.

**Root cause:** userMemories updates "periodically in the background" — exact period unknown. System prompt says deletion cleanup is "nightly" but creation/update cadence is undocumented.

**Freshness comparison:**

| Source | Freshness |
|----|----|
| CLAUDE.MD, guides, work/\*.md | Fresh — read live |
| conversation_search / recent_chats | Fresh — searches actual history |
| userMemories (auto-generated) | **Stale** — unknown lag |
| memory_user_edits (manual) | Immediate, reliable |

**Resolution:**

* Removed stale memory entry
* Updated CLAUDE.MD to say: "userMemories: Ignore entirely. Stale data risk outweighs serendipity. Use `memory` command if curious."
* Added stable context (Who section, execution mode) directly to CLAUDE.MD
* Added `memory` shorthand command to surface auto-generated insights on demand

**Implication:** Don't trust userMemories for anything time-sensitive. The md files are the real memory system.

## AI Memory Systems Research

Searched for consumer products that accomplish something like Jonathan's md-based memory system.

### Products Found

**PAI (Personal AI Infrastructure)** — Daniel Miessler, 5.4k GitHub stars

* TELOS: 10 identity files (MISSION.md, GOALS.md, BELIEFS.md, etc.)
* User/System separation (customizations survive upgrades)
* Skill system with routing
* Memory system with learning signals (ratings, sentiment)
* Hook system (lifecycle events)
* "Continuous learning" — captures feedback
* Philosophy: "AI as persistent assistant, friend, coach, mentor"
* Gap: No gates, no discipline enforcement, more "life coach" than project workflow

**Basic Memory** — basicmachines-co

* Local markdown files as knowledge graph
* Bidirectional read/write (human and AI edit same files)
* SQLite index for semantic search
* Obsidian-compatible
* True local-first, no cloud
* Gap: Storage system only, no workflow enforcement

**Nick Cao's Memory Bank** — 5-mode workflow MCP server

* `.memory_bank` directory with tasks.md, implementation-plan.md
* 5-mode lifecycle: VAN (init) → PLAN → CREATIVE → IMPLEMENT → REFLECT+ARCHIVE
* Complexity levels (1-4)
* File-based persistence
* Gap: Rigid phases, no organic evolution, no gates

**Other tools:** Cursor (.cursorrules), Claude Projects, Windsurf, Mem0, various MCP servers

### Feature Comparison

| Feature | PAI | Basic Memory | Nick Cao | **Jonathan's System** |
|----|----|----|----|----|
| Persistent context | ✅ | ✅ | ✅ | ✅ |
| Markdown-based | ✅ | ✅ | ✅ | ✅ |
| Work tracking | ❌ | ❌ | ✅ (phases) | ✅ (resume points) |
| Gates | ❌ | ❌ | ❌ | ✅ |
| Discipline enforcement | ❌ | ❌ | ❌ | ✅ |
| "Leaning into learning" | partial | ❌ | ❌ | ✅ |
| Shorthand commands | ❌ | ❌ | ❌ | ✅ |
| Voice/tone guide | ❌ | ❌ | ❌ | ✅ |
| Organic evolution | ❌ | ❌ | ❌ | ✅ |

### Unique Contributions of Jonathan's System

1. **Gates** — forced checkpoints before action (refactoring → read workflow.md first)
2. **Discipline enforcement** — recovery paths ("lazy" → reread refactoring discipline)
3. **"Leaning into learning"** — iterative guide refinement from actual collaboration
4. **Shorthand as UI** — compact commands for collaboration flow
5. **Voice guide** — personality/tone consistency in documentation

**Key insight:** Most tools provide *storage and retrieval*. Jonathan's system provides *accountability and learning loops*. It's methodology, not just tooling.

### The Irony

Jonathan built an entire methodology — CLAUDE.MD, gates, work files, guides — to work around AI unreliability. That labor compensates for the tool's opacity. The collaboration guides he's written are clearer documentation of how to work with Claude than anything Anthropic provides.
```

### /Users/sand/GitHub/mono/ws/notes/work/next/index.md
```md
# Next

I may find enough time and will to pursue some crazy or not-so-crazy ideas:

## Contents

- [Crazy](./crazy/)
- [Amnesia](./amnesia.md)
- [Holons.api](./holons.api.md)
- [Resize_Optimization_AI](./Resize_Optimization_AI.md)
- [Search Links](./search-links.md)
- [Search](./search.md)

```

### /Users/sand/GitHub/mono/ws/notes/work/next/holons.api.md
```md
# Holons API Specification (TypeScript-Oriented)

**Base URL**: `https://api.map-holons.org/v1`  
**Authentication**: Bearer Token (`Authorization: Bearer <token>`)

---

## 🧱 Resource Interface

```ts
interface Holon {
  id: string;               // UUID
  title: string;
  description: string;
  tags: string[];
  createdAt: string;        // ISO 8601 datetime
  updatedAt: string;        // ISO 8601 datetime
  ownerId: string;
}
🔹 Endpoints

1. Create a Holon
POST /holons

Request Body

Always show details

type CreateHolonRequest = Omit<Holon, 'id' | 'createdAt' | 'updatedAt'>;
Response

Always show details

type CreateHolonResponse = {
  success: true;
  data: Holon;
};
2. List Holons
GET /holons

Query Parameters

Always show details

interface ListHolonsQuery {
  tag?: string;
  ownerId?: string;
  limit?: number;
  offset?: number;
}
Response

Always show details

type ListHolonsResponse = {
  success: true;
  data: Holon[];
};
3. Get a Single Holon
GET /holons/{id}

Response

Always show details

type GetHolonResponse = {
  success: true;
  data: Holon;
};
4. Update a Holon
PUT /holons/{id}

Request Body

Always show details

type UpdateHolonRequest = Omit<Holon, 'id' | 'createdAt' | 'updatedAt'>;
Response

Always show details

type UpdateHolonResponse = {
  success: true;
  data: Holon;
};
5. Delete a Holon
DELETE /holons/{id}

Response

Always show details

type DeleteHolonResponse = {
  success: true;
  message: string;
};
⚠️ Standard Error Format
Always show details

type ErrorResponse = {
  error: string;
  message: string;
};
"""

Save to a new file

file_path_ts = Path("/mnt/data/fiddle.spec")
file_path_ts.write_text(ts_spec_content)

file_path_ts.name
```

### /Users/sand/GitHub/mono/ws/notes/work/next/crazy/book.md
```md
# Book

## Problem

This is getting to be a lot of material. Perhaps overwhelming to a newbie. I want to understand what's missing and how to inject it.

## Goal

Document what makes great technical writing feel great, how to achieve it, and what raw material is needed to get started.

## Approach

### What Makes Great Technical Books Feel Good

**Narrative thread.** Not just facts dumped in order. There's a story — here's where we started, here's the problem we hit, here's how we solved it. Even dry topics have a journey.

**Voice.** A human wrote this. You can hear them thinking. They have opinions, frustrations, moments of delight. Not corporate-speak, not textbook-neutral.

**Pacing.** Dense sections followed by breathers. Code blocks broken up by explanation. Short sentences after complex ones. Rhythm.

**Earned complexity.** Simple first, then build. Never dump the hard stuff without setup. Each concept earns its place by solving a problem you now understand.

**Concrete before abstract.** Show the specific case, then generalize. "Here's what happened" before "here's the principle."

**Respect for the reader.** Assumes intelligence, doesn't assume knowledge. Explains without condescending. Doesn't hide difficulty but doesn't exaggerate it either.

**Moments of humor or humanity.** A wry aside. An admission of a dumb mistake. Keeps you reading because the author feels real.

### How To Do It



1. **Start with the pain.** What sucked? What was confusing? What broke? That's your hook.
2. **Tell the story of figuring it out.** Not "here's the answer" but "here's how I got there." Include dead ends if they're instructive.
3. **Use your actual voice.** Read it aloud. Does it sound like you talking? If not, rewrite.
4. **Vary sentence length.** Long explanation. Short punch. Like this.
5. **One idea per paragraph.** If you're covering two things, split it.
6. **Code in context.** Don't just show code — show why this code, why now, what it replaces.
7. **Name the tradeoffs.** Nothing is perfect. Say what you gave up.
8. **End sections with what you now know.** Summarize the takeaway. Cement it.

### Starting Material Needed

* **A problem you actually solved.** Not hypothetical. Real friction, real fix.
* **Notes from the journey.** What you tried, what failed, what clicked. Raw is fine.
* **Code snippets.** Before/after. The ugly version and the clean version.
* **Your opinions.** What do you think about this? Don't hedge everything.
* **Questions you had.** What confused you? Others will be confused too.

### What's Likely Missing



1. **"Start here" entry point.** Where does a newbie begin? The digest lists everything equally. No hierarchy of "read this first."
2. **Progressive path.** A suggested reading order. "Understand state before managers. Understand managers before UX."
3. **Context-setting intro.** "What is webseriously? What problem does it solve? Why is it built this way?" Before diving into components and databases.
4. **Glossary or quick reference.** All those prefixes (S_, w_, G_, T_) — a newbie sees them everywhere with no decoder ring upfront.
5. **"Big picture" diagram.** How the pieces connect. Visual map before detailed terrain.

## Audit

### Entry Points

| Doc | Has "start here" feel? | Notes |
|----|----|----|
| digest.md | ❌ | Lists everything flat, no guidance |
| designs/index.md | ❌ | Just links, no context |
| architecture/index.md | ❌ | Lists managers, no intro |
| guides/index.md | ⚠️ | Has a sentence of context, but not newbie-oriented |

### Progressive Path

*Does any doc explain dependencies between concepts?*

| Concept | Depends on | Documented? |
|----|----|----|
| managers | state | ❌ |
| UX | managers, state | ❌ |
| hits | state, geometry | ❌ |
| components | state, managers | ❌ |

### Context-Setting

*Does anything explain what webseriously IS?*

- [ ] What problem does it solve?
- [ ] Who is it for?
- [ ] Why these architectural choices?
- [ ] High-level "here's how it works"

### Glossary

*Are prefixes explained anywhere?*

| Prefix | Explained in | Findable? |
|----|----|----|
| S_ | state.md | ⚠️ buried |
| w_ | state.md | ⚠️ buried |
| G_ | geometry.md | ⚠️ buried |
| T_ | style.md | ⚠️ in naming section |
| k, h, s, x, g, p, u, e, c | style.md | ⚠️ in prefixes table |

### Big Picture

*Visual overview exists?*

- [x] Architecture diagram — `architecture/overview.md`
- [ ] Data flow diagram
- [ ] Component relationship map

### Full Review of all `md` files in `notes/designs`

*Is the documentation content* (1) [well organized](#_1-organization) (2) [complete](#_2-completeness) (3) [articulated with my voice.md](#_3-voice-consistency-vs-voice-md) (4) [contain redundancies](#_4-redundancies) (5) [needs more explanation](#_5-areas-needing-more-explanation) (6) [spelling or grammatical errors](#_6-spelling-grammatical-errors)?

*39 markdown files were reviewed, across `notes/designs` (excluding `work`), totaling 50,000+ words.*

#### 1. Organization

**Strengths:**

* Logical hierarchy: architecture/ (what/why) vs guides/ (how)
* digest.md provides quick-reference synopses
* overview.md offers reading order + architecture diagram
* Each directory has index.md for navigation

**Issues:**

* "further" and "more" directory names are vague — unclear distinction. Suggest: "further" → "integrations/platforms", "more" → "patterns/internals"
* breadcrumbs.md overloaded with extensive migration plan (w_ancestry_focus refactor) — should move to work/ or migrations/
* controls.md contains grow/shrink → Next_Previous migration plan — same issue
* Naming overlap: architecture/core/ux.md (UX Manager) vs architecture/ux/ (UX components) could confuse

**Recommendation:** Create top-level migrations/ directory for in-progress refactor plans.

#### 2. Completeness

**Well-Covered:**

* State management (state.md excellent)
* Manager architecture (comprehensive)
* Hit testing (thorough)
* Database abstraction (complete)
* Component architecture (detailed)
* Style/color management (well-documented)
* Svelte patterns and gotchas

**Gaps:**

* Testing guide (how to write/run tests, patterns)
* Error handling patterns (no flow documentation)
* Adding new components (no step-by-step)
* Tree vs Radial mode (referenced everywhere, never consolidated)
* Ancestry/Thing relationship (core concept assumed but not explained)
* Import/Export features (mentioned in project.md, no dedicated doc)
* Accessibility (not mentioned)
* search.md (thin compared to other UX docs)
* draw/ components (SVG primitives barely touched)

**digest.md Accuracy Issue:** Lists svelte.5.md under Guides, actually in architecture/further/

#### 3. Voice Consistency (vs voice.md)

**Voice Guidelines:** First-person, lowercase "i", problem-first, casual language, short punchy sentences, show emotion.

**Files Nailing Voice:**

* paging.md: "Lots of ghastly geometry goes into making it feel comfortable"
* preferences.md: "It's a computer, for crying sake"
* styles.md: "i admit it, my early code was a nightmare"
* buttons.md: "These just cropped up, ad-hoc"
* debugging.md: "going around in circles, unable to consider venturing outside the box"
* refactoring.md: "Man crawling across the desert"
* gotchas.md: "Ack, i get this cryptic error"

**Voice Lost in Body Content:**
Pattern: Synopses are great, body content reverts to formal technical writing.

Examples:

* components.md: Good synopsis, body reads like generated documentation
* managers.md: Short synopsis, mostly formal tables
* databases.md: Great synopsis, body purely technical
* persistable.md: Completely formal, no personality
* state.md: Starts casual, becomes dense
* controls.md, details.md, breadcrumbs.md: Good synopses, formal bodies

**Observation:** Guides (debugging.md, gotchas.md, chat.md) maintain voice better than architecture docs.

#### 4. Redundancies

**Significant Overlaps:**



1. **project.md vs overview.md:** Manager list in both, database types in both, state management overview in both, naming conventions in both
2. **State management explained in:** state.md (primary), components.md (S_Component vs S_Element section), managers.md (store patterns), project.md (architecture section)
3. **Hit testing documented in:** hits.md (primary), components.md (Pattern 3), timers.md (references and builds on)
4. **digest.md** — By design duplicates all synopses (maintenance burden: any synopsis change needs two edits)
5. **breadcrumbs.md** — Contains meta-commentary section "Comparison: Architecture vs Design Documents" explaining why two breadcrumbs docs exist (unnecessary)
6. **S_Snapshot** — Detailed in styles.md, referenced from state.md (unclear authoritative location)
7. **Migration plans** — In architecture docs (breadcrumbs.md, controls.md) duplicate what should be tracked elsewhere

#### 5. Areas Needing More Explanation



1. **search.md** — Thinnest UX doc. Missing: search index internals, performance characteristics, edge cases
2. **Ancestry concept** — Referenced constantly, never gets own explanation. How does Ancestry relate to Thing? Why both?
3. **Tree vs Radial differences** — Every component doc mentions differently. Needs consolidated explanation.
4. **draw/ components** — One paragraph in components.md. SVG primitives worth more.
5. **Testing patterns** — gotchas.md mentions tests, no guide for writing them
6. **How to add new component** — No walkthrough for common developer task
7. **"trigger" pattern** — Used extensively (Breadcrumbs, others), mentioned in reactivity.md, deserves own explanation given centrality
8. **S_Items** — Used everywhere (si_grabs, si_recents, si_found), never fully explained
9. **performance.md** — Would consolidate scattered performance notes

#### 6. Spelling/Grammatical Errors

**Formatting Issues:**

* vitepress.md: Uses `==The trick==` and `==Note==` (Obsidian-specific syntax, won't render in VitePress)
* breadcrumbs.md: Same Obsidian `==highlight==` syntax
* access.md: `**Note**:` should be `**Note:**` (colon inside bold)

**Inconsistencies:**

* Lowercase "i" usage inconsistent (voice.md says use in casual contexts, but many files use capital "I" throughout when should be casual)
* Quote styles mixed (single/double in prose, not code)

**Typos:**

* project.md: "beyond the scope off this file" → "of"
* overview.md: Reference link format inconsistent (some use ./ prefix, some don't)
* components.md: Run-on sentence in state management description

**Markdown Issues:**

* Some bullet lists lack blank lines before them (inconsistent rendering)
* Some headers have inconsistent spacing
* A few code blocks missing language identifiers

#### Summary Recommendations

**Quick Wins:**

1. Fix Obsidian `==highlight==` syntax in vitepress.md and breadcrumbs.md
2. Fix "off" → "of" in project.md
3. Move migration plans from breadcrumbs.md and controls.md to work/ directory
4. Correct digest.md to show svelte.5.md in architecture/further, not guides

**Medium Effort:**

1. Rename "further" and "more" directories to be more descriptive
2. Write brief "Ancestry & Things" explainer
3. Expand search.md
4. Add testing guide

**Larger Effort:**

1. Sustain voice through body content, not just synopses
2. Consolidate state management documentation to reduce redundancy
3. Create single authoritative location for S_Snapshot documentation
4. Write "Tree vs Radial Mode" comparison doc

#### Overall Assessment

Documentation is thorough and well-structured. Main issues: voice fading in detailed sections, some redundancy between reference docs, a few missing topics. Synopses are excellent and consistent with voice.md guidelines.

## Resolution

*Pending — decide what to create first.*```

### /Users/sand/GitHub/mono/ws/notes/work/next/crazy/ethernet.md
```md
# ethernet

## Problem

Want to visualize physical wiring infrastructure (ethernet, USB, etc.) in the app. Browser APIs don't provide this data—`navigator.connection` only gives connection type/speed, WebUSB requires per-device permission and doesn't expose topology. No way to auto-discover physical wiring.

**Real motivation**: Dozens of tangled cables. When one fails, tracing them physically is a nightmare. Need a way to know what connects to what *before* failure hits.

## Goal

Cable inventory and fault isolation:
- Document connections once (painful but one-time)
- When something breaks, consult graph to identify which cable/port to check
- Map graph nodes to physical labels on cables

## Approach

- **Node types**: Define categories (router, switch, hub, device, cable) with relevant properties (ports, speeds, labels)
- **Edge semantics**: Physical connection with port identifiers
- **Existing patterns**: Reuse trait system, or something simpler?

## Resolution

file this for later```

### /Users/sand/GitHub/mono/ws/notes/work/next/crazy/index.md
```md
# Crazy

## Contents

- [Ai Ux Spider Guide](./ai-ux-spider-guide.md)
- [Book](./book.md)
- [Ethernet](./ethernet.md)

```

### /Users/sand/GitHub/mono/ws/notes/work/next/crazy/ai-ux-spider-guide.md
```md
# Building an AI-Powered UX Testing Spider

A step-by-step guide to creating an automated system that navigates websites like a user and reports UX problems, dead ends, and confusing flows.

## Overview

We'll build a system that:
- Automatically navigates through website pages and user flows
- Takes screenshots at each step
- Identifies UX issues (broken links, loops, dead ends, confusing UI)
- Generates a detailed report with findings

## Tech Stack Options

### Option 1: Playwright + Claude API (Recommended)
**Best for:** Comprehensive testing with intelligent decision-making
**Complexity:** Medium
**Cost:** API calls to Claude (~$0.10-1.00 per site tested)

### Option 2: Playwright + GPT-4 Vision
**Best for:** Similar to Option 1, OpenAI ecosystem
**Complexity:** Medium
**Cost:** Similar API costs

### Option 3: Pure Playwright with Heuristics
**Best for:** Simpler, cheaper, but less intelligent
**Complexity:** Low
**Cost:** Free (just compute)

We'll focus on **Option 1** as it gives the best balance of intelligence and control.

---

## Step-by-Step Build: Playwright + Claude

### Step 1: Set Up Your Environment

```bash
# Create project directory
mkdir ux-spider
cd ux-spider

# Initialize Node.js project
npm init -y

# Install dependencies
npm install playwright @anthropic-ai/sdk dotenv
npm install --save-dev @types/node typescript

# Initialize TypeScript
npx tsc --init

# Install Playwright browsers
npx playwright install
```

### Step 2: Set Up API Keys

Create a `.env` file:
```
ANTHROPIC_API_KEY=your_api_key_here
```

Get your API key from: https://console.anthropic.com/

### Step 3: Create Basic Spider Structure

Create `src/spider.ts`:

```typescript
import { chromium, Browser, Page } from 'playwright';
import Anthropic from '@anthropic-ai/sdk';
import * as fs from 'fs';
import * as path from 'path';
import 'dotenv/config';

interface Finding {
  type: 'dead_link' | 'loop' | 'confusing_ui' | 'error' | 'friction';
  severity: 'low' | 'medium' | 'high';
  description: string;
  url: string;
  screenshot?: string;
  timestamp: Date;
}

class UXSpider {
  private browser: Browser | null = null;
  private page: Page | null = null;
  private anthropic: Anthropic;
  private visitedUrls: Set<string> = new Set();
  private findings: Finding[] = [];
  private screenshotDir: string;
  private startUrl: string;
  private maxPages: number;

  constructor(startUrl: string, maxPages: number = 50) {
    this.startUrl = startUrl;
    this.maxPages = maxPages;
    this.anthropic = new Anthropic({
      apiKey: process.env.ANTHROPIC_API_KEY,
    });
    this.screenshotDir = path.join(__dirname, '../screenshots', Date.now().toString());
    fs.mkdirSync(this.screenshotDir, { recursive: true });
  }

  async initialize() {
    this.browser = await chromium.launch({ headless: false }); // Set to true for production
    this.page = await this.browser.newPage();
    
    // Set viewport for consistent screenshots
    await this.page.setViewportSize({ width: 1920, height: 1080 });
  }

  async takeScreenshot(name: string): Promise<string> {
    if (!this.page) throw new Error('Page not initialized');
    
    const filename = `${name.replace(/[^a-z0-9]/gi, '_')}_${Date.now()}.png`;
    const filepath = path.join(this.screenshotDir, filename);
    await this.page.screenshot({ path: filepath, fullPage: true });
    return filepath;
  }

  async analyzePageWithClaude(screenshotPath: string, url: string): Promise<string> {
    // Read screenshot as base64
    const imageBuffer = fs.readFileSync(screenshotPath);
    const base64Image = imageBuffer.toString('base64');

    const message = await this.anthropic.messages.create({
      model: 'claude-sonnet-4-20250514',
      max_tokens: 2000,
      messages: [
        {
          role: 'user',
          content: [
            {
              type: 'image',
              source: {
                type: 'base64',
                media_type: 'image/png',
                data: base64Image,
              },
            },
            {
              type: 'text',
              text: `You are a UX auditor. Analyze this screenshot from ${url}.

Identify any of these issues:
1. Broken or unclear navigation
2. Dead-end pages (no way forward)
3. Confusing UI elements or layouts
4. Error messages or broken functionality
5. Forms that are difficult to understand or complete
6. Accessibility issues (poor contrast, tiny text, etc.)
7. Friction points that would frustrate users

For each issue found, respond in this format:
ISSUE: [type]
SEVERITY: [low/medium/high]
DESCRIPTION: [clear description of the problem]

If no issues found, respond with: NO_ISSUES_FOUND`,
            },
          ],
        },
      ],
    });

    return message.content[0].type === 'text' ? message.content[0].text : '';
  }

  parseClaudeResponse(response: string, url: string, screenshotPath: string) {
    if (response.includes('NO_ISSUES_FOUND')) {
      return;
    }

    // Simple parser for Claude's response
    const issueBlocks = response.split('ISSUE:').slice(1);
    
    for (const block of issueBlocks) {
      const typeMatch = block.match(/^\s*(.+?)\s*SEVERITY:/);
      const severityMatch = block.match(/SEVERITY:\s*(low|medium|high)/i);
      const descMatch = block.match(/DESCRIPTION:\s*(.+?)(?=ISSUE:|$)/s);

      if (typeMatch && severityMatch && descMatch) {
        this.findings.push({
          type: this.categorizeIssue(typeMatch[1].trim()),
          severity: severityMatch[1].toLowerCase() as 'low' | 'medium' | 'high',
          description: descMatch[1].trim(),
          url: url,
          screenshot: screenshotPath,
          timestamp: new Date(),
        });
      }
    }
  }

  categorizeIssue(type: string): Finding['type'] {
    const normalized = type.toLowerCase();
    if (normalized.includes('dead') || normalized.includes('end')) return 'dead_link';
    if (normalized.includes('loop')) return 'loop';
    if (normalized.includes('error')) return 'error';
    if (normalized.includes('confus')) return 'confusing_ui';
    return 'friction';
  }

  async crawlPage(url: string) {
    if (this.visitedUrls.has(url) || this.visitedUrls.size >= this.maxPages) {
      return;
    }

    if (!this.page) throw new Error('Page not initialized');

    console.log(`Crawling: ${url}`);
    this.visitedUrls.add(url);

    try {
      await this.page.goto(url, { waitUntil: 'networkidle', timeout: 30000 });
      
      // Wait a bit for dynamic content
      await this.page.waitForTimeout(2000);

      // Take screenshot
      const screenshotPath = await this.takeScreenshot(url);

      // Analyze with Claude
      const analysis = await this.analyzePageWithClaude(screenshotPath, url);
      this.parseClaudeResponse(analysis, url, screenshotPath);

      // Find all links on the page
      const links = await this.page.$$eval('a[href]', (elements) =>
        elements.map((el) => (el as HTMLAnchorElement).href)
      );

      // Filter to same-domain links
      const baseDomain = new URL(this.startUrl).hostname;
      const sameDomainLinks = links.filter((link) => {
        try {
          return new URL(link).hostname === baseDomain;
        } catch {
          return false;
        }
      });

      // Crawl linked pages (limited to avoid infinite loops)
      for (const link of sameDomainLinks.slice(0, 5)) {
        if (!this.visitedUrls.has(link)) {
          await this.crawlPage(link);
        }
      }
    } catch (error) {
      this.findings.push({
        type: 'error',
        severity: 'high',
        description: `Failed to load page: ${error}`,
        url: url,
        timestamp: new Date(),
      });
    }
  }

  async generateReport() {
    const reportPath = path.join(this.screenshotDir, 'report.html');
    
    const html = `
<!DOCTYPE html>
<html>
<head>
  <title>UX Audit Report</title>
  <style>
    body { font-family: system-ui; max-width: 1200px; margin: 0 auto; padding: 20px; }
    h1 { color: #333; }
    .summary { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
    .finding { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 15px 0; }
    .finding.high { border-left: 4px solid #d32f2f; }
    .finding.medium { border-left: 4px solid #f57c00; }
    .finding.low { border-left: 4px solid #fbc02d; }
    .screenshot { max-width: 100%; margin-top: 10px; cursor: pointer; }
    .url { color: #666; font-size: 0.9em; word-break: break-all; }
    .timestamp { color: #999; font-size: 0.85em; }
  </style>
</head>
<body>
  <h1>UX Audit Report</h1>
  <div class="summary">
    <h2>Summary</h2>
    <p><strong>Start URL:</strong> ${this.startUrl}</p>
    <p><strong>Pages Crawled:</strong> ${this.visitedUrls.size}</p>
    <p><strong>Issues Found:</strong> ${this.findings.length}</p>
    <p><strong>High Severity:</strong> ${this.findings.filter(f => f.severity === 'high').length}</p>
    <p><strong>Medium Severity:</strong> ${this.findings.filter(f => f.severity === 'medium').length}</p>
    <p><strong>Low Severity:</strong> ${this.findings.filter(f => f.severity === 'low').length}</p>
  </div>

  <h2>Findings</h2>
  ${this.findings
    .sort((a, b) => {
      const severityOrder = { high: 0, medium: 1, low: 2 };
      return severityOrder[a.severity] - severityOrder[b.severity];
    })
    .map(
      (finding, i) => `
    <div class="finding ${finding.severity}">
      <h3>Finding #${i + 1} - ${finding.type} (${finding.severity})</h3>
      <p><strong>Description:</strong> ${finding.description}</p>
      <p class="url"><strong>URL:</strong> ${finding.url}</p>
      <p class="timestamp">${finding.timestamp.toLocaleString()}</p>
      ${
        finding.screenshot
          ? `<img class="screenshot" src="${path.basename(finding.screenshot)}" 
               onclick="window.open(this.src)" title="Click to view full size" />`
          : ''
      }
    </div>
  `
    )
    .join('')}
</body>
</html>
    `;

    fs.writeFileSync(reportPath, html);
    console.log(`\nReport generated: ${reportPath}`);
    
    // Also output JSON for programmatic use
    const jsonPath = path.join(this.screenshotDir, 'findings.json');
    fs.writeFileSync(jsonPath, JSON.stringify(this.findings, null, 2));
    console.log(`JSON report: ${jsonPath}`);
  }

  async run() {
    try {
      await this.initialize();
      await this.crawlPage(this.startUrl);
      await this.generateReport();
    } finally {
      if (this.browser) {
        await this.browser.close();
      }
    }
  }
}

// Run the spider
const targetUrl = process.argv[2] || 'https://example.com';
const maxPages = parseInt(process.argv[3]) || 20;

const spider = new UXSpider(targetUrl, maxPages);
spider.run().catch(console.error);
```

### Step 4: Update package.json

Add to your `package.json`:

```json
{
  "scripts": {
    "build": "tsc",
    "spider": "npm run build && node dist/spider.js"
  }
}
```

### Step 5: Run Your Spider

```bash
# Test on a simple site first
npm run spider https://example.com 10

# For your own site
npm run spider https://yoursite.com 50
```

---

## Advanced Enhancements

### 1. Test Specific User Flows

Add flow testing to track if users can complete common tasks:

```typescript
async testCheckoutFlow() {
  // Navigate to product
  await this.page.goto('https://yoursite.com/products/item-1');
  await this.takeScreenshot('checkout_1_product');
  
  // Add to cart
  await this.page.click('[data-testid="add-to-cart"]');
  await this.takeScreenshot('checkout_2_cart');
  
  // Check if cart updated
  const cartCount = await this.page.textContent('.cart-count');
  if (cartCount === '0') {
    this.findings.push({
      type: 'error',
      severity: 'high',
      description: 'Add to cart did not update cart count',
      url: this.page.url(),
      timestamp: new Date()
    });
  }
  
  // Continue to checkout...
}
```

### 2. Check for Loops

Track navigation history to detect when users get stuck in loops:

```typescript
private navigationHistory: string[] = [];

async detectLoop(url: string) {
  this.navigationHistory.push(url);
  
  // Check if we've seen this URL 3+ times recently
  const recentVisits = this.navigationHistory.slice(-10);
  const visitCount = recentVisits.filter(u => u === url).length;
  
  if (visitCount >= 3) {
    this.findings.push({
      type: 'loop',
      severity: 'high',
      description: `User appears stuck in loop - visited ${url} ${visitCount} times`,
      url: url,
      timestamp: new Date()
    });
  }
}
```

### 3. Test Accessibility

```typescript
async checkAccessibility() {
  // Check for images without alt text
  const imagesWithoutAlt = await this.page.$$eval('img:not([alt])', 
    imgs => imgs.length
  );
  
  if (imagesWithoutAlt > 0) {
    this.findings.push({
      type: 'friction',
      severity: 'medium',
      description: `Found ${imagesWithoutAlt} images without alt text`,
      url: this.page.url(),
      timestamp: new Date()
    });
  }
  
  // Check for low contrast text
  // Check for missing form labels
  // etc.
}
```

### 4. Mobile Testing

```typescript
async testMobile() {
  await this.page.setViewportSize({ 
    width: 375, 
    height: 667 
  });
  
  // Re-run tests on mobile viewport
}
```

### 5. Performance Monitoring

```typescript
async checkPerformance() {
  const metrics = await this.page.evaluate(() => {
    return JSON.stringify(window.performance.timing);
  });
  
  const timing = JSON.parse(metrics);
  const loadTime = timing.loadEventEnd - timing.navigationStart;
  
  if (loadTime > 3000) {
    this.findings.push({
      type: 'friction',
      severity: 'medium',
      description: `Slow page load: ${loadTime}ms`,
      url: this.page.url(),
      timestamp: new Date()
    });
  }
}
```

---

## Cost Optimization

### Reduce API Calls

```

### /Users/sand/GitHub/mono/ws/notes/work/.DS_Store
```DS_Store
   Bud1                                                                     bwspblob   �                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  d o n ebwspblob   �bplist00�]ShowStatusBar[ShowToolbar[ShowTabView_ContainerShowSidebar\WindowBounds[ShowSidebar			_{{537, 273}, {920, 464}}	#/;R_klmno�                            �    d o n elsvCblob  bplist00�	
UVW
_viewOptionsVersion_showIconPreviewWcolumns_calculateAllSizesXtextSizeZsortColumnXiconSize_useRelativeDates	�"&+05:>CGLP�

WvisibleYascendingUwidthZidentifier		,Tname�UwidthYascendingWvisibleXubiquity#�
 !	�\dateModified� %[dateCreated�
)*	aTsize�

./		sTkind�
34	dUlabel�
89	KWversion�
=	Xcomments�AB�^dateLastOpened�D YdateAdded�IK�ZshareOwner�IO_shareLastEditor�IS_invitationStatus#@(      Tkind#@0      	   . @ H \ e p y � � � � � � � � � � � � � � � � � � %&'3<=>@ENOPRW`abdjstuw����������������������!&/             Y              0    d o n elsvpblob  Ybplist00�	
DEF
_viewOptionsVersion_showIconPreviewWcolumns_calculateAllSizesXtextSizeZsortColumnXiconSize_useRelativeDates	�#(-25:>XcommentsUlabelWversion[dateCreatedTsize\dateModifiedTkindTname^dateLastOpened�
UindexYascendingUwidthWvisible	,�
!	d�$
&	K�)+��.0
a	�	+
	�6
8
	s	�;

 		�?A�#@(      Tkind#@0      	   . @ H \ e p y � � � � � � � � � � � � � � �	')*,-689;<EGHJKTVWYZcdenpqst}�����������             H              �    d o n evSrnlong                                                                                                                                                                                                                                                                                                                                                                                                                    E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         DSDB                                 `          �                                        @      �                                          @      �                                          @       d�
UindexYascendingUwidthWvisible	,�
!	d�$
&	K�)+��.0
a	�	+
	�6
8
	s	�;

 		�?A�#@(      Tkind#@0      	   . @ H \ e p y � � � � � � � � � � � � � � �	')*,-689;<EGHJKTVWYZcdenpqst}�����������             H              �    d o n evSrnlong                                                                                                                                                                                                                                                                                                                                                                                                        ```

### /Users/sand/GitHub/mono/ws/notes/work/revisit.md
```md
# Resume

**January 28, 2026 (early afternoon)**

## Current

- [x] shift-click one of the multiply selected, deselects all
- [x] deselect all -> NOT select root (confusing)
- [x] click on a breadcrumb to the left of the focus -> **change** the focus AND the level
- [x] radial mode -> changing the focus -> **selects** the focus
- [x] click on background -> deselect all
- [x] rubber band not working

---
## Done

- [x] Fixed Netlify deployment (base path ws not projects/ws)
- [x] Added `define: { global: 'globalThis' }` to vite.config.js for Firebase
- [x] Removed unused packages: neo4j, pg, sveltekit, skeleton, tailwind, typedoc-plugin-markdown, vite-plugin-singlefile, rollup
- [x] Removed SvelteKit block from svelte.config.js
- [x] Deleted tailwind.config.ts
- [x] Zero yarn warnings achieved
- [x] Moved notes/architecture → notes/guides/architecture
- [x] Moved notes/collaborate → notes/guides/collaborate
- [x] Updated .vitepress/config.mts sidebar links
- [x] Removed notes/tools/ (config just restated defaults)
- [x] Fixed dead links in project.md (preferences.md, search.md)

---
## Future

- [ ] add dot to breadcrumb -> focus
- [ ] API -> change in root
- [ ] API -> edits made in Catalist
- [ ] show recents count and index -> primary controls
- [ ] instead of reveal dot's big inner dot, enlarge stroke to indicate "hidden children here"
- [ ] implement keep graph centered on selection
- [ ] test whether two-finger no longer moves graph
- [ ] while editing A, select a range, click B, click A, RETURN should reselect the range 
```

### /Users/sand/GitHub/mono/ws/notes/work/index.md
```md
# Work

Documentation of ongoing and completed work.

## Contents

- [Next](./next/)
- [Deliverables](./deliverables.md)
- [Revisit](./revisit.md)

```

### /Users/sand/GitHub/mono/ws/notes/work/deliverables.md
```md
# Deliverables

**Started:** 2025-01-13
**Status:** In progress

Before I demo a fix to Vincent, review it with Wendy. For items that are checked, I need Wendy's feedback/confirmation. I will let her know in Telegram, and then meet with her to receive it.

## Milestones

- [ ] MVP that has no bugs (we must close bug list, delivery by February) called "**golden master**"

## Testing environments

urls for review and feedback

- [ ] [Catalist](https://www.catalist.network/seriously_view?object=1768857908919x153587680602915040&space=1747073877366x313460503630839800&theme=bubble) Vincent currently points it to version of webseriously that is under construction (it is **not** frozen -- all bugs I accidentally introduce will be visible)
- [ ] [webseriously](https://webseriously.org) current work in progress

## Catalist

`### Bugs

- [ ] webseriously view is taller than window
- [ ] top banner wraps badly -> places things on top of webseriously

### Questions

- [ ] do you show details on change of focus?
- [ ] is testing "connections" **vital** for final golden master?
- [ ] do we need an introductory summary of current behavior?

### Should we extend GM date beyond Friday January 30?

- [ ] yes

## Webseriously

### Bugs

- [x] shift-click one of the multiply selected, deselects all
- [x] click on a breadcrumb to the left of the focus -> change the focus
- [x] radial mode -> changing the focus -> selects the focus
- [x] send vincent the ws logo
- [x] remove cluster pager from Visibility, etc
- [x] click background in radial -> HANG
- [x] click in breadcrumb left of focus, change the selection
	- [x] details should say selection, not focus
- [ ] details banners hover wrong for traits and data
- [ ] **firefox**
	- [ ] next and previous buttons not visible
	- [ ] reveal dots not visible
		- [ ] svg is tiny 3 x 3 px
	- [x] preferences details accent color dot's border is broken
	- [x] levels slider is incorrectly drawn
### Future Tasks

- [ ] add dot to breadcrumb -> focus
- [ ] API -> change in root
- [ ] API -> edits made in Catalist
- [ ] show recents count and index -> primary controls
- [ ] instead of reveal dot's big inner dot, enlarge stroke to indicate "hidden children here"
- [ ] implement keep graph centered on selection
- [ ] test whether two-finger no longer moves graph
```

### /Users/sand/GitHub/mono/ws/notes/work/handoff.md
```md
# Handoff

Resume point for next chat.

## Active task

Firefox bugs in ws app. 5 identified, 3 fixed:

1. **Next/previous buttons not visible** — IN PROGRESS
   * Issue is in `ws/src/lib/svelte/draw/SVG_D3.svelte` lines 50-51
   * `width={width}px` and `height={height}px` is invalid SVG syntax
   * Should be `width="{width}px"` or just `width={width}`
   * Chrome lenient, Firefox strict — ignores malformed attributes
   * **Fix not yet applied**
2. **Reveal dots not visible** — NOT STARTED (likely same SVG_D3 issue)
3. **Levels slider incorrectly drawn** — FIXED
4. **Preferences accent color dot border broken** — FIXED
5. **Details banners hover wrong for traits and data** — NOT STARTED

## Other completed this session

* Fixed rubberband selection bug (state extraction to S_Rubberband.ts)
* Fixed infinite loop in Graph.svelte (guard against layout during rubberband)
* Fixed shift-click deselection
* Fixed empty rubberband deselects on mouse-up
* Created `notes/guides/pre-flight/always.md`
* Updated [CLAUDE.MD](http://CLAUDE.MD) pre-flight instructions
```

### /Users/sand/GitHub/mono/ws/.gitignore
```gitignore
# Logs
lerna-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
npm-debug.log*
*.log
logs

# Build files
node_modules
.svelte-kit
yarn.lock
dist-ssr
esbuild
*.local
package
dist
docs

# Editor directories and files
!.vscode/extensions.json
webseriously.js
experimental
.DS_Store
*.njsproj
.vscode
*.ntvs*
.idea
*.suo
*.sln
*.sw?

# Local Netlify folder
.netlify
.vitepress/cache/
```

### /Users/sand/GitHub/mono/ws/package.json
```json
{
    "license": "proprietary",
    "main": "dist/index.js",
    "name": "webseriously",
    "version": "0.1.0",
    "type": "module",
    "private": true,
    "files": [
        "dist"
    ],
    "engines": {
        "node": ">=20.19.0"
    },
    "scripts": {
        "dev": "vite",
        "test": "vitest",
        "docs": "typedoc",
        "build": "vite build",
        "rollup": "rollup -c",
        "test:ui": "vitest --ui",
        "test:run": "vitest run",
        "docs:dev": "vitepress dev",
        "serve": "parcel ./index.html",
        "swc": "swc src -d swc.package",
        "docs:preview": "vitepress preview",
        "preview": "vite preview --port 8080",
        "parcel": "parcel build ./index.html",
        "esbuild": "node config/esbuild.config.cjs",
        "package": "rm -rf package; svelte-package -o package",
        "docs:watch": "nodemon --watch src --ext md,js,json,ts,tsx,svelte --exec \"yarn typedoc\"",
        "eesbuild": "esbuild src/lib/js/index.ts --bundle --outfile=esbuild/webseriously.bundle.js --watch",
        "docs:build": "vitepress build > vitepress.build.txt 2>&1 && cp .vitepress/public/seriously-icon.png .vitepress/dist/"
    },
    "devDependencies": {
        "@smui/button": "^7.0.0",
        "@sveltejs/package": "^2.3.7",
        "@sveltejs/vite-plugin-svelte": "^2.0.3",
        "@testing-library/svelte": "^5.2.10",
        "@types/airtable": "^0.10.1",
        "@types/color-convert": "^2.0.0",
        "@types/d3": "^7.4.3",
        "@types/jest": "^29.5.12",
        "@types/node": "^22.9.3",
        "@types/rbush": "^4.0.0",
        "@types/uuid": "^9.0.2",
        "@vitest/ui": "^4.0.16",
        "autoprefixer": "^10.4.21",
        "carbon-components-svelte": "^0.85.2",
        "jest": "^29.7.0",
        "jest-environment-jsdom": "^29.7.0",
        "jsdom": "^27.3.0",
        "mermaid": "^11.4.0",
        "nodemon": "^3.1.9",
        "rollup-plugin-visualizer": "^5.12.0",
        "snowpack": "^3.8.8",
        "source-map-explorer": "^2.5.3",
        "svelte-jester": "^5.0.0",
        "svelte-preprocess": "^5.0.3",
        "ts-jest": "^29.1.3",
        "typedoc": "^0.27.6",
        "vite": "^4.3.2",
        "vitepress": "^1.6.4",
        "vitepress-plugin-mermaid": "^2.0.16",
        "vitest": "^4.0.16"
    },
    "dependencies": {
        "@emotion/core": "^11.0.0",
        "@emotion/react": "^11.13.5",
        "@svelteuidev/composables": "^0.15.6",
        "@svelteuidev/core": "^0.15.6",
        "@svelteuidev/motion": "^0.15.6",
        "@types/express": "^4.17.17",
        "@types/pako": "^2.0.3",
        "@wx/svelte-core": "^1.1.3",
        "airtable": "^0.12.2",
        "color2k": "^2.0.3",
        "d3": "^7.8.5",
        "dexie": "^4.0.7",
        "express": "^4.18.2",
        "firebase": "^10.1.0",
        "framework7": "^8.3.4",
        "framework7-svelte": "^8.3.4",
        "gl-matrix": "^3.4.4",
        "html2canvas": "^1.4.1",
        "interactjs": "^1.10.27",
        "jspdf": "^3.0.1",
        "mobile-detect": "^1.4.5",
        "pako": "^2.1.0",
        "pandoc-bin": "^0.2.0",
        "postcss": "^8.5.4",
        "print-js": "^1.6.0",
        "rbush": "^4.0.1",
        "react": "^18.3.1",
        "react-dom": "^18.3.1",
        "rxdb": "^15.26.0",
        "rxjs": "^7.8.1",
        "sass": "^1.81.0",
        "scss": "^0.2.4",
        "svelte": "4.x",
        "svelte-awesome-color-picker": "3.x",
        "svelte-icons": "^2.1.0",
        "svelte-motion": "^0.12.2",
        "svelte-ux": "^0.74.9",
        "tcs": "^10.0.2",
        "ts-node": "^10.2.1",
        "two.js": "^0.8.18",
        "typed-signals": "^2.5.0",
        "typescript": "^5.4.5",
        "undici": "^5.26.2",
        "uuid": "^9.0.0"
    }
}
```

### /Users/sand/GitHub/mono/ws/package-lock.json.aside
```aside
{
    "name": "webseriously",
    "version": "0.1",
    "lockfileVersion": 3,
    "requires": true,
    "packages": {
        "": {
            "name": "webseriously",
            "version": "0.1",
            "license": "proprietary",
            "dependencies": {
                "@emotion/core": "^11.0.0",
                "@emotion/react": "^11.13.5",
                "@skeletonlabs/skeleton": "^3.1.3",
                "@skeletonlabs/tw-plugin": "^0.4.1",
                "@sveltejs/kit": "^2.8.3",
                "@svelteuidev/composables": "^0.15.6",
                "@svelteuidev/core": "^0.15.6",
                "@svelteuidev/motion": "^0.15.6",
                "@types/express": "^4.17.17",
                "@types/pako": "^2.0.3",
                "@wx/svelte-core": "^1.1.3",
                "airtable": "^0.12.2",
                "color2k": "^2.0.3",
                "d3": "^7.8.5",
                "dexie": "^4.0.7",
                "express": "^4.18.2",
                "firebase": "^10.1.0",
                "framework7": "^8.3.4",
                "framework7-svelte": "^8.3.4",
                "interactjs": "^1.10.27",
                "mobile-detect": "^1.4.5",
                "pako": "^2.1.0",
                "pg": "^8.11.3",
                "pg-promise": "^11.5.4",
                "pg-query-stream": "4.7.0",
                "postcss": "^8.4.31",
                "react": "^18.3.1",
                "react-dom": "^18.3.1",
                "rollup": "2.79.2",
                "rxdb": "^15.26.0",
                "rxjs": "^7.8.1",
                "sass": "^1.81.0",
                "scss": "^0.2.4",
                "svelte": "4.x",
                "svelte-awesome-color-picker": "3.x",
                "svelte-icons": "^2.1.0",
                "svelte-ux": "^0.74.9",
                "tcs": "^10.0.2",
                "ts-node": "^10.2.1",
                "two.js": "^0.8.18",
                "typed-signals": "^2.5.0",
                "typescript": "^5.4.5",
                "undici": "^5.26.2",
                "uuid": "^9.0.0"
            },
            "devDependencies": {
                "@smui/button": "^7.0.0",
                "@sveltejs/package": "^2.3.7",
                "@sveltejs/vite-plugin-svelte": "^2.0.3",
                "@tailwindcss/typography": "^0.5.14",
                "@types/airtable": "^0.10.1",
                "@types/color-convert": "^2.0.0",
                "@types/d3": "^7.4.3",
                "@types/jest": "^29.5.12",
                "@types/node": "^22.9.3",
                "@types/uuid": "^9.0.2",
                "autoprefixer": "^10.4.20",
                "carbon-components-svelte": "^0.85.2",
                "jest": "^29.7.0",
                "jest-environment-jsdom": "^29.7.0",
                "nodemon": "^3.1.9",
                "rollup-plugin-visualizer": "^5.12.0",
                "snowpack": "^3.8.8",
                "source-map-explorer": "^2.5.3",
                "svelte-jester": "^5.0.0",
                "svelte-preprocess": "^5.0.3",
                "tailwindcss": "^3.4.9",
                "ts-jest": "^29.1.3",
                "typedoc": "^0.27.6",
                "typedoc-plugin-markdown": "^4.4.1",
                "vite": "^4.3.2",
                "vite-plugin-singlefile": "^2.1.0"
            }
        },
        "node_modules/@alloc/quick-lru": {
            "version": "5.2.0",
            "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
            "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/@ampproject/remapping": {
            "version": "2.3.0",
            "resolved": "https://registry.npmjs.org/@ampproject/remapping/-/remapping-2.3.0.tgz",
            "integrity": "sha512-30iZtAPgz+LTIYoeivqYo853f02jBYSd5uGnGpkFV0M3xOt9aN73erkgYAmZU43x4VfqcnLxW9Kpg3R5LC4YYw==",
            "license": "Apache-2.0",
            "dependencies": {
                "@jridgewell/gen-mapping": "^0.3.5",
                "@jridgewell/trace-mapping": "^0.3.24"
            },
            "engines": {
                "node": ">=6.0.0"
            }
        },
        "node_modules/@babel/code-frame": {
            "version": "7.26.2",
            "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.26.2.tgz",
            "integrity": "sha512-RJlIHRueQgwWitWgF8OdFYGZX328Ax5BCemNGlqHfplnRT9ESi8JkFlvaVYbS+UubVY6dpv87Fs2u5M29iNFVQ==",
            "license": "MIT",
            "dependencies": {
                "@babel/helper-validator-identifier": "^7.25.9",
                "js-tokens": "^4.0.0",
                "picocolors": "^1.0.0"
            },
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/compat-data": {
            "version": "7.26.8",
            "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.26.8.tgz",
            "integrity": "sha512-oH5UPLMWR3L2wEFLnFJ1TZXqHufiTKAiLfqw5zkhS4dKXLJ10yVztfil/twG8EDTA4F/tvVNw9nOl4ZMslB8rQ==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/core": {
            "version": "7.26.10",
            "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.26.10.tgz",
            "integrity": "sha512-vMqyb7XCDMPvJFFOaT9kxtiRh42GwlZEg1/uIgtZshS5a/8OaduUfCi7kynKgc3Tw/6Uo2D+db9qBttghhmxwQ==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@ampproject/remapping": "^2.2.0",
                "@babel/code-frame": "^7.26.2",
                "@babel/generator": "^7.26.10",
                "@babel/helper-compilation-targets": "^7.26.5",
                "@babel/helper-module-transforms": "^7.26.0",
                "@babel/helpers": "^7.26.10",
                "@babel/parser": "^7.26.10",
                "@babel/template": "^7.26.9",
                "@babel/traverse": "^7.26.10",
                "@babel/types": "^7.26.10",
                "convert-source-map": "^2.0.0",
                "debug": "^4.1.0",
                "gensync": "^1.0.0-beta.2",
                "json5": "^2.2.3",
                "semver": "^6.3.1"
            },
            "engines": {
                "node": ">=6.9.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/babel"
            }
        },
        "node_modules/@babel/core/node_modules/semver": {
            "version": "6.3.1",
            "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
            "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
            "dev": true,
            "license": "ISC",
            "bin": {
                "semver": "bin/semver.js"
            }
        },
        "node_modules/@babel/generator": {
            "version": "7.27.0",
            "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.27.0.tgz",
            "integrity": "sha512-VybsKvpiN1gU1sdMZIp7FcqphVVKEwcuj02x73uvcHE0PTihx1nlBcowYWhDwjpoAXRv43+gDzyggGnn1XZhVw==",
            "license": "MIT",
            "dependencies": {
                "@babel/parser": "^7.27.0",
                "@babel/types": "^7.27.0",
                "@jridgewell/gen-mapping": "^0.3.5",
                "@jridgewell/trace-mapping": "^0.3.25",
                "jsesc": "^3.0.2"
            },
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helper-compilation-targets": {
            "version": "7.27.0",
            "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.0.tgz",
            "integrity": "sha512-LVk7fbXml0H2xH34dFzKQ7TDZ2G4/rVTOrq9V+icbbadjbVxxeFeDsNHv2SrZeWoA+6ZiTyWYWtScEIW07EAcA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/compat-data": "^7.26.8",
                "@babel/helper-validator-option": "^7.25.9",
                "browserslist": "^4.24.0",
                "lru-cache": "^5.1.1",
                "semver": "^6.3.1"
            },
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helper-compilation-targets/node_modules/lru-cache": {
            "version": "5.1.1",
            "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
            "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
            "dev": true,
            "license": "ISC",
            "dependencies": {
                "yallist": "^3.0.2"
            }
        },
        "node_modules/@babel/helper-compilation-targets/node_modules/semver": {
            "version": "6.3.1",
            "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
            "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
            "dev": true,
            "license": "ISC",
            "bin": {
                "semver": "bin/semver.js"
            }
        },
        "node_modules/@babel/helper-compilation-targets/node_modules/yallist": {
            "version": "3.1.1",
            "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
            "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
            "dev": true,
            "license": "ISC"
        },
        "node_modules/@babel/helper-module-imports": {
            "version": "7.25.9",
            "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.25.9.tgz",
            "integrity": "sha512-tnUA4RsrmflIM6W6RFTLFSXITtl0wKjgpnLgXyowocVPrbYrLUXSBXDgTs8BlbmIzIdlBySRQjINYs2BAkiLtw==",
            "license": "MIT",
            "dependencies": {
                "@babel/traverse": "^7.25.9",
                "@babel/types": "^7.25.9"
            },
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helper-module-transforms": {
            "version": "7.26.0",
            "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.26.0.tgz",
            "integrity": "sha512-xO+xu6B5K2czEnQye6BHA7DolFFmS3LB7stHZFaOLb1pAwO1HWLS8fXA+eh0A2yIvltPVmx3eNNDBJA2SLHXFw==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-module-imports": "^7.25.9",
                "@babel/helper-validator-identifier": "^7.25.9",
                "@babel/traverse": "^7.25.9"
            },
            "engines": {
                "node": ">=6.9.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0"
            }
        },
        "node_modules/@babel/helper-plugin-utils": {
            "version": "7.26.5",
            "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.26.5.tgz",
            "integrity": "sha512-RS+jZcRdZdRFzMyr+wcsaqOmld1/EqTghfaBGQQd/WnRdzdlvSZ//kF7U8VQTxf1ynZ4cjUcYgjVGx13ewNPMg==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helper-string-parser": {
            "version": "7.25.9",
            "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.25.9.tgz",
            "integrity": "sha512-4A/SCr/2KLd5jrtOMFzaKjVtAei3+2r/NChoBNoZ3EyP/+GlhoaEGoWOZUmFmoITP7zOJyHIMm+DYRd8o3PvHA==",
            "license": "MIT",
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helper-validator-identifier": {
            "version": "7.25.9",
            "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.25.9.tgz",
            "integrity": "sha512-Ed61U6XJc3CVRfkERJWDz4dJwKe7iLmmJsbOGu9wSloNSFttHV0I8g6UAgb7qnK5ly5bGLPd4oXZlxCdANBOWQ==",
            "license": "MIT",
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helper-validator-option": {
            "version": "7.25.9",
            "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.25.9.tgz",
            "integrity": "sha512-e/zv1co8pp55dNdEcCynfj9X7nyUKUXoUEwfXqaZt0omVOmDe9oOTdKStH4GmAw6zxMFs50ZayuMfHDKlO7Tfw==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/helpers": {
            "version": "7.27.0",
            "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.27.0.tgz",
            "integrity": "sha512-U5eyP/CTFPuNE3qk+WZMxFkp/4zUzdceQlfzf7DdGdhp+Fezd7HD+i8Y24ZuTMKX3wQBld449jijbGq6OdGNQg==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/template": "^7.27.0",
                "@babel/types": "^7.27.0"
            },
            "engines": {
                "node": ">=6.9.0"
            }
        },
        "node_modules/@babel/parser": {
            "version": "7.27.0",
            "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.27.0.tgz",
            "integrity": "sha512-iaepho73/2Pz7w2eMS0Q5f83+0RKI7i4xmiYeBmDzfRVbQtTOG7Ts0S4HzJVsTMGI9keU8rNfuZr8DKfSt7Yyg==",
            "license": "MIT",
            "dependencies": {
                "@babel/types": "^7.27.0"
            },
            "bin": {
                "parser": "bin/babel-parser.js"
            },
            "engines": {
                "node": ">=6.0.0"
            }
        },
        "node_modules/@babel/plugin-syntax-async-generators": {
            "version": "7.8.4",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-async-generators/-/plugin-syntax-async-generators-7.8.4.tgz",
            "integrity": "sha512-tycmZxkGfZaxhMRbXlPXuVFpdWlXpir2W4AMhSJgRKzk/eDlIXOhb2LHWoLpDF7TEHylV5zNhykX6KAgHJmTNw==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.8.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-bigint": {
            "version": "7.8.3",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-bigint/-/plugin-syntax-bigint-7.8.3.tgz",
            "integrity": "sha512-wnTnFlG+YxQm3vDxpGE57Pj0srRU4sHE/mDkt1qv2YJJSeUAec2ma4WLUnUPeKjyrfntVwe/N6dCXpU+zL3Npg==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.8.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-class-properties": {
            "version": "7.12.13",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-properties/-/plugin-syntax-class-properties-7.12.13.tgz",
            "integrity": "sha512-fm4idjKla0YahUNgFNLCB0qySdsoPiZP3iQE3rky0mBUtMZ23yDJ9SJdg6dXTSDnulOVqiF3Hgr9nbXvXTQZYA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.12.13"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-class-static-block": {
            "version": "7.14.5",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-class-static-block/-/plugin-syntax-class-static-block-7.14.5.tgz",
            "integrity": "sha512-b+YyPmr6ldyNnM6sqYeMWE+bgJcJpO6yS4QD7ymxgH34GBPNDM/THBh8iunyvKIZztiwLH4CJZ0RxTk9emgpjw==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.14.5"
            },
            "engines": {
                "node": ">=6.9.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-import-attributes": {
            "version": "7.26.0",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-attributes/-/plugin-syntax-import-attributes-7.26.0.tgz",
            "integrity": "sha512-e2dttdsJ1ZTpi3B9UYGLw41hifAubg19AtCu/2I/F1QNVclOBr1dYpTdmdyZ84Xiz43BS/tCUkMAZNLv12Pi+A==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.25.9"
            },
            "engines": {
                "node": ">=6.9.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-import-meta": {
            "version": "7.10.4",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-import-meta/-/plugin-syntax-import-meta-7.10.4.tgz",
            "integrity": "sha512-Yqfm+XDx0+Prh3VSeEQCPU81yC+JWZ2pDPFSS4ZdpfZhp4MkFMaDC1UqseovEKwSUpnIL7+vK+Clp7bfh0iD7g==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.10.4"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-json-strings": {
            "version": "7.8.3",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-json-strings/-/plugin-syntax-json-strings-7.8.3.tgz",
            "integrity": "sha512-lY6kdGpWHvjoe2vk4WrAapEuBR69EMxZl+RoGRhrFGNYVK8mOPAW8VfbT/ZgrFbXlDNiiaxQnAtgVCZ6jv30EA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.8.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-jsx": {
            "version": "7.25.9",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-jsx/-/plugin-syntax-jsx-7.25.9.tgz",
            "integrity": "sha512-ld6oezHQMZsZfp6pWtbjaNDF2tiiCYYDqQszHt5VV437lewP9aSi2Of99CK0D0XB21k7FLgnLcmQKyKzynfeAA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.25.9"
            },
            "engines": {
                "node": ">=6.9.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-logical-assignment-operators": {
            "version": "7.10.4",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-logical-assignment-operators/-/plugin-syntax-logical-assignment-operators-7.10.4.tgz",
            "integrity": "sha512-d8waShlpFDinQ5MtvGU9xDAOzKH47+FFoney2baFIoMr952hKOLp1HR7VszoZvOsV/4+RRszNY7D17ba0te0ig==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.10.4"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-nullish-coalescing-operator": {
            "version": "7.8.3",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-nullish-coalescing-operator/-/plugin-syntax-nullish-coalescing-operator-7.8.3.tgz",
            "integrity": "sha512-aSff4zPII1u2QD7y+F8oDsz19ew4IGEJg9SVW+bqwpwtfFleiQDMdzA/R+UlWDzfnHFCxxleFT0PMIrR36XLNQ==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.8.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-numeric-separator": {
            "version": "7.10.4",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-numeric-separator/-/plugin-syntax-numeric-separator-7.10.4.tgz",
            "integrity": "sha512-9H6YdfkcK/uOnY/K7/aA2xpzaAgkQn37yzWUMRK7OaPOqOpGS1+n0H5hxT9AUw9EsSjPW8SVyMJwYRtWs3X3ug==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.10.4"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-object-rest-spread": {
            "version": "7.8.3",
            "resolved": "https://registry.npmjs.org/@babel/plugin-syntax-object-rest-spread/-/plugin-syntax-object-rest-spread-7.8.3.tgz",
            "integrity": "sha512-XoqMijGZb9y3y2XskN+P1wUGiVwWZ5JmoDRwx5+3GmEplNyVM2s2Dg8ILFQm8rWM48orGy5YpI5Bl8U1y7ydlA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@babel/helper-plugin-utils": "^7.8.0"
            },
            "peerDependencies": {
                "@babel/core": "^7.0.0-0"
            }
        },
        "node_modules/@babel/plugin-syntax-optional-catch-binding": {
```

### /Users/sand/GitHub/mono/ws/.prettierrc
```prettierrc
{
	"useTabs": false,
	"singleQuote": true,
	"trailingComma": "none",
	"printWidth": 100,
	"tabWidth": 2
}
```

### /Users/sand/GitHub/mono/ws/typedoc.json
```json
{
	"out": "dist",
	"theme": "default",
	"entryPointStrategy": "expand",
	"exclude": ["aside", "bubble", "docs"],
	"entryPoints": ["src/lib", "index.html"]
}```

### /Users/sand/GitHub/mono/ws/tsconfig.json
```json
{
	"compilerOptions": {
		"baseUrl": ".",
		"target": "es6",
		"jsx": "preserve",
		"module": "CommonJS",
		"outDir": "notes/dist",
		"moduleResolution": "node",
		"resolveJsonModule": true,
		"strictNullChecks": true,
		"esModuleInterop": true,
		"isolatedModules": true,
		"skipLibCheck": true,
		"sourceMap": true,
		"allowJs": true,
		"checkJs": true,
		"strict": true,
		"paths": {
			"*": [
				"app/*",
				"plugin/*"
			]
		},
		"forceConsistentCasingInFileNames": true
	},
	"typedocOptions": {
		"highlightLanguages": {
			"css": "css",
			"html": "html",
			"js": "javascript",
			"ts": "typescript",
			"svelte": "svelte",
			"json": "javascript"
		}
	},
	"exclude": [
		"notes",
		"bubble",
		"**/*.svelte",
		"node_modules",
	],
	"include": [
		"src/**/*",
		"src/main.js",
		"src/lib/**/*"
, "notes/experiments/slim", "notes/experiments/source/Detect.ts", "notes/aside/2025/Radial_Focus.svelte", "notes/aside/2025/Widget_Title.svelte", "notes/aside/2025/Mouse_Responder.svelte", "notes/archives/2025/Breadcrumb_Separator.svelte"	]
}```

### /Users/sand/GitHub/mono/ws/.vscode/extensions.json
```json
{
  "recommendations": ["svelte.svelte-vscode"]
}
```

### /Users/sand/GitHub/mono/ws/vitest.config.ts
```ts
import { defineConfig } from 'vitest/config';
import { svelte } from '@sveltejs/vite-plugin-svelte';
import path from 'path';

export default defineConfig({
	plugins: [svelte()],
	test: {
		environment: 'jsdom',
		globals: true,
		include: ['src/**/*.{test,spec}.{js,ts}'],
		exclude: ['node_modules', 'dist', '.idea', '.git', '.cache'],
		setupFiles: ['src/lib/ts/tests/setup.ts'],
	},
	resolve: {
		alias: {
			'$lib': path.resolve(__dirname, './src/lib'),
		},
	},
});

```

### /Users/sand/GitHub/mono/ws/CLAUDE.MD
```MD
# CLAUDE.MD

COMMON: Read `../../CLAUDE.MD`

REPO: `~/GitHub/mono/projects/ws`

GUIDES: Read all `.md` files in `notes/guides/`

FRESHNESS: When comparing files, checking differences, or claiming file contents—ALWAYS re-read immediately before. Never rely on cached content from earlier in conversation. If user says "these are different" or "that's not what's in the file", RE-READ before responding.


```

### /Users/sand/GitHub/mono/ws/src/.DS_Store
```DS_Store
   Bud1                                                                      t sbwspblob                                                                                                                                                                           a s s e t sbwspblob   �bplist00�]ShowStatusBar[ShowToolbar[ShowTabView_ContainerShowSidebar\WindowBounds[ShowSidebar			_{{206, 318}, {920, 464}}	#/;R_klmno�                            �    a s s e t svSrnlong                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         DSDB                                 `          �                                         @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```

### /Users/sand/GitHub/mono/ws/src/main.js
```js
import SeriouslyApp from './lib/svelte/main/SeriouslyApp.svelte';
import './styles/webseriously.css';

new SeriouslyApp({ target: document.body });
```

### /Users/sand/GitHub/mono/ws/src/styles/webseriously.css
```css
svg {
	display: block;		/* override inline to eliminate unwanted vertical displacements */
}

div, span, input {
	background-color: transparent;
}

body {
	background-color: var(--css-background-color);
    width: var(--css-body-width, 100%);
	user-select: none;
	-webkit-user-select: none;
	-moz-user-select: none;
}

input[type='range'] {
	user-select: auto !important;
	touch-action: auto !important;
}

button, svg {
	&:focus {
		outline: none;
	}
}

html, body {
	overflow: hidden;
    padding: 0;
    margin: 0;
}

/* Global spinner animation */
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.spinner-circle {
    transform-origin: center;
    animation: spin var(--spinner-speed, 1s) linear infinite;
}

.graph-container {
	transform: translate3d(var(--graph-x), var(--graph-y), 0);
	will-change: transform;
	transition: transform 0.1s ease-out;
}

.widget {
	transform: translate3d(var(--widget-x), var(--widget-y), 0);
	will-change: transform;
}```

### /Users/sand/GitHub/mono/ws/src/vite-env.d.ts
```ts
/// <reference types="svelte" />
/// <reference types="vite/client" />
declare module '*.svelte' {
  import type { ComponentType } from 'svelte';
  const component: ComponentType<any>;
  export default component;
}```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/tree/Tree_Branches.svelte
```svelte
<script lang=ts>
	import { show, debug, g_graph_tree, signals, Ancestry } from '../../ts/common/Global_Imports';
	import { S_Component, T_Signal, T_Hit_Target } from '../../ts/common/Global_Imports';
	import Tree_Branches from './Tree_Branches.svelte';
	import Widget from '../widget/Widget.svelte';
	import Tree_Line from './Tree_Line.svelte';
	import Circle from '../draw/Circle.svelte';
	import { onMount } from 'svelte';
	export let ancestry: Ancestry;
	export let depth: number;
	const { w_show_related } = show;
	const g_widget = ancestry.g_widget;
	const g_childBranches = g_widget.g_childBranches;
	let s_component: S_Component;
	let reattachments = 0;

	debug.log_draw(`TREE_BRANCHES ${ancestry?.titles}`);

	s_component = signals.handle_anySignal_atPriority(2, ancestry, T_Hit_Target.branches, (t_signal, value): S_Component | null => {
		reattachments++;
	});

	onMount(() => { return () => s_component.disconnect(); });

</script>

{#if depth > 0}
	{#if debug.lines}
		<Circle
			radius = 1
			thickness = 1
			color = black
			center = {g_childBranches.origin_ofLine}/>
	{/if}
	{#key reattachments}
		{#if !!ancestry}
			{#each ancestry.branchAncestries as branchAncestry}
				<Tree_Line g_line = {branchAncestry.g_widget.g_line}/>
				<Widget g_widget = {branchAncestry.g_widget}/>
				{#if branchAncestry.shows_branches && !g_graph_tree.branch_isAlready_attached(branchAncestry)}
					<Tree_Branches ancestry = {branchAncestry} depth = {depth - 1}/>
				{/if}
			{/each}
			{#if $w_show_related && depth > 1}
				{#each g_widget.g_bidirectionalLines as g_line}
					{#if g_line.depth_ofLine < (depth + 2)}
						<Tree_Line g_line = {g_line}/>
					{/if}
				{/each}
			{/if}
		{/if}
	{/key}
{/if}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/tree/Tree_Graph.svelte
```svelte
<script lang='ts'>
	import { g, x, g_graph_tree, signals, S_Component } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Signal, T_Hit_Target } from '../../ts/common/Global_Imports';
	import Tree_Branches from './Tree_Branches.svelte';
	import Widget from '../widget/Widget.svelte';
	import { onMount } from 'svelte';
	const { w_depth_limit, w_scale_factor, w_rect_ofGraphView, w_user_graph_offset } = g;
	const { w_ancestry_focus } = x;
	let s_component: S_Component;
	let reattachments = 0;

	s_component = signals.handle_anySignal_atPriority(3, $w_ancestry_focus, T_Hit_Target.tree, (t_signal, value): S_Component | null => {
		reattachments++;
	});

	onMount(() => { return () => s_component.disconnect(); });

</script>

{#key reattachments}
	{#if g_graph_tree.reset_scanOf_attached_branches() && !!$w_ancestry_focus}
		<div class = 'tree-graph'
			style = '
				position: absolute;
				z-index: {T_Layer.graph};
				transform: scale({$w_scale_factor});
				top: {$w_user_graph_offset.y - 2}px;
				left: {$w_user_graph_offset.x + 16}px;
				width: {$w_rect_ofGraphView.size.width}px;
				height: {$w_rect_ofGraphView.size.height}px;'>
			<Widget g_widget = {$w_ancestry_focus.g_widget}/>
			{#if $w_ancestry_focus.shows_branches}
				<Tree_Branches ancestry = {$w_ancestry_focus} depth = {$w_depth_limit}/>
			{/if}
		</div>
	{/if}
{/key}```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/tree/Tree_Line.svelte
```svelte
<script lang='ts'>
	import { Point, G_TreeLine, T_Layer, S_Component, T_Hit_Target } from '../../ts/common/Global_Imports';
	import { k, debug, colors, signals } from '../../ts/common/Global_Imports';
	import Circle from '../draw/Circle.svelte';
	import Box from '../debug/Box.svelte';
	import { onMount } from 'svelte';
	export let g_line!: G_TreeLine;
	const t_curve = g_line.t_curve;
	const { w_thing_color } = colors;
	const ancestry = g_line.branchAncestry;
	const debugOffset = new Point(k.height.line - 3.4, 2.5);
	let stroke_color = ancestry?.thing?.color;
	let s_component: S_Component;
	let svg_dasharray = k.empty;
	let reattachments = 0;

	//////////////////////////////
	//	draw a curved line		//
	//		in g_line.rect		//
	//		up, down or flat 	//
	//		solid or dashed 	//
	//////////////////////////////
 
	function isHit(): boolean { return false }

	s_component = signals.handle_reposition_widgets_atPriority(2, ancestry, T_Hit_Target.line, (received_ancestry) => {
		reattachments += 1;
	});

	onMount(() => { return () => s_component.disconnect(); });

	$: {
		if (!!ancestry && !!ancestry.thing && ancestry.thing.id == $w_thing_color?.split(k.separator.generic)[0]) {
			reattachments += 1;
		}
	}

	if (g_line.isBidirectional) {
		stroke_color = colors.opacitize(ancestry.thing.color, 0.7);
		svg_dasharray = k.dasharray.relateds;
	}

</script>

{#key reattachments}
	{#if !!ancestry}
		<svg
			id = {s_component.id}
			class = 'tree-line-svg'
			style = '
				top: {g_line.origin.y - g_line.size.height - 0.5 - g_line.stroke_width / 2}px;
				left: {g_line.origin.x + 136 + g_line.stroke_width / 2}px;
				height: {g_line.size.height + g_line.stroke_width * 2}px;
				width: {g_line.size.width + g_line.stroke_width * 2}px;
				z-index: {T_Layer.line};
				position: absolute;'>
			<path
				fill = 'none'
				d = {g_line.linePath}
				stroke = {stroke_color}
				class = 'tree-line-path'
				stroke-dasharray = {svg_dasharray}
				stroke-width = {g_line.stroke_width}/>
		</svg>
		{#if debug.lines}
			<Circle
				radius = 1
				thickness = 1
				color = black
				center = {g_line.rect.extent.offsetBy(debugOffset)}/>
		{/if}
	{/if}
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Dot_RevealFocus.svelte
```svelte
<script lang='ts'>
	import { k, ux, Point, debug, Direction, dbDispatch } from '../../ts/common/Global_Imports';
	import Triangle_Button from '../mouse/Triangle_Button.svelte';
	export let center = Point.zero;
    export let name = k.empty;
    export let ancestry;
	const element_state = ux.element_state_forName(name);		// survives onDestroy, created by widget
	let size = k.dot_size;

	element_state.set_forHovering(ancestry.thing.color, 'pointer');

	function hover_closure(isHovering) {
		return [debug.lines ? 'transparent' : element_state.stroke, k.empty];
	}

	function handle_mouse_state(mouse_state: Mouse_State): boolean {
		if (mouse_state.isHover) {
			element_state.isOut = mouse_state.isOut;
		} else {
			if ($s_hierarchygrabs.latestAncestryGrabbed(true)?.isFocus) {
				$s_hierarchyancestry_rebuild_persistentMoveRight(ancestry, false, false);
			} else {
				ancestry.grabOnly();
			}
		}
	}

</script>

<Triangle_Button
	handle_mouse_state={handle_mouse_state}
	strokeColor={element_state.stroke}
	hover_closure={hover_closure}
	name={ancestry.thing.title}
	angle={Direction.right}
	center={center}
    size={size}
/>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Tooltip.svelte
```svelte
<script lang='ts'>
  import { createPopperActions } from 'svelte-popperjs';
  const [popperRef, popperContent] = createPopperActions({
    placement: 'right',
    strategy: 'fixed',
  });
  const extraOpts = {
    modifiers: [
      { name: 'offset', options: { offset: [0, 8] } }
    ],
  };

  let showTooltip = false;
</script>

<button
  use:popperRef
  on:mouseenter={() => showTooltip = true}
  on:mouseleave={() => showTooltip = false}
>
  My button
</button>
{#if showTooltip}
  <div id="tooltip" use:popperContent={extraOpts}>
    My tooltip
    <div id="arrow" data-popper-arrow />
  </div>
{/if}```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Open.svelte
```svelte
<script lang='ts'>
	import { s_hierarchy } from '../../ts/state/Svelte_Stores';
	import { k } from '../../ts/common/Global_Imports';
	import { get } from 'svelte/store';
	export let label = 'Choose a file';
	export let multiple = false;		// Can be set to 'multiple'
	export let accept = '';
	let file_input: HTMLInputElement;

	function handle_selection(event: Event) {
		const target = event.target as HTMLInputElement;
		const files = target?.files;
		if (files) {
			for (const file of Array.from(files)) {
				get(s_hierarchy).fetch_fromFile(file);
			}
			target.value = '';		// Allow re-selection of the same file
		}
	}

</script>

<style>
	.file-input {
		display: none;
	}

	.invisible-button {
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		position: absolute;
		overflow: hidden;
		margin: -1px;
		height: 1px;
		width: 1px;
		padding: 0;
		border: 0;
	}

	.invisible-button:focus {
		outline: 2px solid #0056b3;
		outline-offset: 2px;
	}
</style>

<label
	on:keydown={() => {
		if (event.key.toLowerCase() == 'enter') {
			event.preventDefault();
			file_input.click();
			console.log('file_input.click()');
		}
	}}
	class='invisible-button'
	aria-label={label}
	for='file-input'
	role='button'
	tabindex='0'
>
	{label}
</label>

<input
	on:change={handle_selection}
	bind:this={file_input}
	class='file-input'
	accept={accept}
	id='file-input'
	type='file'
	{multiple}
/>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Spacer.svelte
```svelte
<script lang='ts'>
	export let width = 10;
</script>

<div style='width: {width}px; position: absolute;'></div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Arrowhead.svelte
```svelte
<script lang='ts'>
	import { k, u, Point, debug, ZIndex, svgPaths } from '../../ts/common/Global_Imports'
	export let color_background = debug.lines ? 'transparent' : k.color_background;
	export let zindex = ZIndex.dots;
	export let center = Point.zero;
	export let name = k.empty;
	export let radius = 5;
	export let angle = 0;
	export let color;
	let diameter = 0;
	let arrowheadPath = k.empty;

	$: {
		diameter = radius * 2;
		const skip = [1, 4];
		arrowheadPath = svgPaths.polygon(radius, angle, 5, skip);
	}

</script>

<div
	class= 'arrowhead' id={name} style='
		position: absolute;
		top: {center.y - radius}px;
		left: {center.x - radius}px;
		z-index: {zindex};'>
	<svg class='triangle'
		width={diameter * 2}px
		height={diameter * 2}px>
		style='z-index: {ZIndex.lines}; position: absolute'
		<path d={arrowheadPath} stroke={color} fill={color_background}/>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Load.svelte
```svelte
<script lang='ts'>
	import { s_hierarchy, s_id_popupView } from '../../ts/state/Svelte_Stores';
	import { files } from '../../ts/managers/Files';
	import { get } from 'svelte/store';
	import Open from './Open.svelte';

	function handle_cancel() {
		console.log('File selection was cancelled.');
		$s_id_popupView = null;
	}

	function handle_files_selected(event: CustomEvent<FileList>) {
		get(s_hierarchy).fetch_fromFile(event.detail[0]);
		$s_id_popupView = null;
	}

</script>

<Open
	accept='.json'
	on:cancel={handle_cancel}
	on:files_selected={handle_files_selected}
/>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Rotation_Cursor.svelte
```svelte
<svg width="48px" height="48px" viewBox="0 0 48 48">
    <circle cx="24" cy="24" r="20" stroke="black" stroke-width="2" fill="none" />
    <path d="M 4,24 a 20,20 0 0,1 40,0" fill="none" stroke="black" stroke-width="2"/>
    <polygon points="44,24 38,18 38,30" fill="black"/>
</svg>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Upload.svelte
```svelte
<script>
	import { s_hierarchy, s_thing_fontFamily } from '../../ts/state/Svelte_Stores';
	import { k, u, Size, Point } from '../../ts/common/Global_Imports';
	import { createEventDispatcher } from "svelte";
	import icons from "../../js/icons.js";
	export let center = Point.zero;
	export let multiple = k.empty;		// can be set to 'multiple'
	export let accept = k.empty;
	export let buttonText = "upload";
	export let doneButtonText = "Done";
	export let doneText = "Successfully uploaded"
	export let descriptionText = "Drag or click to upload";
	export let input = null;
	export let fixed = true;
	//Files from the file input and the drag zone
	export let inputFiles = [];
	export let dragZoneFiles = [];
	// Called when maxuploads is reached or the done button is clicked
	export let callback = () => {};
	//Called when the "Done" button is clicked
	export let doneCallback = () => {};
	// Drag zone element
	export let dragZone = null;
	//Maximum files that can be uploaded
	export let maxFiles = 3;
	// When the maximum files are uploaded
	export let maxFilesCallback = () => {};
	//Show a list of files + icons?
	export let listFiles = true;
	
	$: files = [...inputFiles, ...dragZoneFiles];
	$: {
		if (files.length >= maxFiles){
			maxFilesCallback(files, maxFiles);
			dispatch("change", files)
			callback(files);
		}
	}
	
	function trigger() { input.click(); }
	
	const dispatch = createEventDispatcher();
	
	function dragover(e){
		e.preventDefault();
		dispatch("dragover", e);
	}
	function dragenter(e){
		e.preventDefault();
		dragZone.classList.add("dragging");
		dispatch("dragenter", e);
	}
	function dragleave(e){
		e.preventDefault();
		dragZone.classList.remove("dragging");
		dispatch("dragleave", e);
	}
	function drop(e){
		e.preventDefault();
		dragZone.classList.remove("dragging");
		dragZoneFiles.push(...[...e.dataTransfer.items].filter(i => i.kind === "file").map(i => i.getAsFile()))
		dragZoneFiles = [...dragZoneFiles];
		dispatch("drop", e);
		dispatch("change", files)
	}
	function formatBytes(a, b = 2, k = 1024) {
			let d = Math.floor(Math.log(a) / Math.log(k));
			return 0 == a
				? "0 Bytes"
				: parseFloat((a / Math.pow(k, d)).toFixed(Math.max(0, b))) +
						" " +
						["Bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"][d];
	}
	function getIcon(filename){
		if (!filename){return icons.default}
		return Object.entries(icons).find(
			i => i[0]
				.split(",")
				.includes(filename.split(".").slice(-1)[0])
		)?.[1] || icons.default;
	}
	function inputChanged(){
		inputFiles = [...inputFiles, ...input.files]
	}
	function del(file){
		if (idx(file, inputFiles) !== null){
			inputFiles.splice(idx(file, inputFiles), 1);
			inputFiles = [...inputFiles];
			return;
		}
		if (idx(file, dragZoneFiles) !== null){
			dragZoneFiles.splice(idx(file, dragZoneFiles), 1);
			dragZoneFiles = [...dragZoneFiles];
			return;
		}
		return console.log(idx(file, inputFiles), idx(file, dragZoneFiles))
		function idx(item, arr){
			let i = arr.findIndex(i => i === item);
			if (i < 0){return null} else {return i}
		}
	}
	function openFile(file){
		window.open(URL.createObjectURL(file), "filewin");
	}
</script>
<div bind:this={dragZone} on:dragover={dragover} on:drop={drop} on:dragenter={dragenter} on:dragleave={dragleave} class={`${fixed ? 'fixed' : ''} fileUploader dragzone`}>
	{#if files.length !== maxFiles}
	  {#if listFiles}
			<ul>
				{#each files.slice(0, maxFiles) as file}
					<li on:click={() => openFile(file)}>
						<span class="icon">
							<span class="fileicon">{@html getIcon(file.name)}</span>
							<span class="deleteicon" on:click|stopPropagation={() => del(file)}><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path fill="currentColor" d="M216 48h-40v-8a24.1 24.1 0 0 0-24-24h-48a24.1 24.1 0 0 0-24 24v8H40a8 8 0 0 0 0 16h8v144a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16V64h8a8 8 0 0 0 0-16ZM96 40a8 8 0 0 1 8-8h48a8 8 0 0 1 8 8v8H96Zm96 168H64V64h128Zm-80-104v64a8 8 0 0 1-16 0v-64a8 8 0 0 1 16 0Zm48 0v64a8 8 0 0 1-16 0v-64a8 8 0 0 1 16 0Z"></path></svg></span>
						</span>
						<span class="filename">{file.name}</span>
						<span class="filesize">{formatBytes(file.size)}</span>
					</li>
				{/each}
			</ul>
		{/if}
		<div class="buttons">
			<button on:click={trigger} class="upload">
				{buttonText}
			</button>
			{#if doneButtonText && files.length}<button on:click={() => (doneCallback(),callback(files))}>{doneButtonText}</button>{/if}
		</div>
		{#if descriptionText}<span class="text">{descriptionText}</span>{/if}
	{:else if maxFiles > 1}
		<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path fill="currentColor" d="m150.8 86.8l-88 88a3.9 3.9 0 0 1-5.6 0l-44-44a4 4 0 1 1 5.6-5.6L60 166.3l85.2-85.1a4 4 0 1 1 5.6 5.6Zm92-5.6a3.9 3.9 0 0 0-5.6 0L152 166.3l-20.5-20.5a4 4 0 0 0-5.7 5.7l23.4 23.3a3.9 3.9 0 0 0 5.6 0l88-88a3.9 3.9 0 0 0 0-5.6Z"></path></svg>
		{#if doneText}<span class="doneText" on:click={() => callback(files)}>{doneText}</span>{/if}
	{:else}
		<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path fill="currentColor" d="M174.9 101.2a4.1 4.1 0 0 1-.1 5.7l-58.7 56a4.3 4.3 0 0 1-2.8 1.1a3.9 3.9 0 0 1-2.7-1.1l-29.4-28a4 4 0 1 1 5.6-5.8l26.5 25.4l55.9-53.4a4.1 4.1 0 0 1 5.7.1ZM228 128A100 100 0 1 1 128 28a100.2 100.2 0 0 1 100 100Zm-8 0a92 92 0 1 0-92 92a92.1 92.1 0 0 0 92-92Z"></path></svg>
		{#if doneText}<span class="doneText">{doneText}</span>{/if}
	{/if}
</div>
<input type="file" hidden bind:this={input} on:change={inputChanged} multiple={maxFiles > 1}>

<style>
	.dragzone {
		padding: 20px;
		display: flex;
		border-radius: 6px;
		align-items: center;
		flex-direction: column;
		justify-content: center;
		border: 2px dashed #0001;
		transition: background-color .3s ease;
	}
	.dragzone ul {
		width: 60%;
		display: flex;
		flex-direction: column;
	}
	.dragzone li {
		transition: background-color .2s ease-in-out;
		align-items: center;
		border-radius: 3px;
		list-style: none;
		padding: 3px 8px;
		cursor: pointer;
		display: flex;
	}
	.dragzone li:hover {
		background: #0001;
	}
	.dragzone .filesize {
		flex: 1;
		text-align: right;
		opacity: .2;
		font-style: italic;
	}
	.dragzone li .filename {
		white-space: nowrap;
		overflow: hidden;
		width: 15ch;
		text-overflow: ellipsis;
		display: block;
		font-weight: 200;
		opacity: .8;
	}
	.dragzone.dragging {
		background: #0662;
	}
	.dragzone svg:not(li svg) {
		width: 15vw;
		height: 15vw;
		color: #777;
		opacity: .6;
	}
	.dragzone li .icon{
		width: 20px;
		margin-right: 10px;
		display: flex;
		justify-content: center;
		align-items: center;
	}
	.dragzone li .icon :global(svg){
		width: 20px;
		color: #333;
	}
	.deleteicon {
		display: none;
	}
	.dragzone li:hover .fileicon {
		display: none;
	}
	.dragzone li:hover .deleteicon {
		display: block;
		cursor: pointer;
	}
	.dragzone .doneText {
		font-size: 1.3rem;
		color: #333;
		opacity: .5;
		font-weight: 200;
		font-style: italic;
		margin-top: 2rem;
	}
	.dragzone.fixed {
		position: fixed;
		height: 80vh;
		width: 80vw;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
	}
	.dragzone .text {
		font-style: italic;
		color: #333;
		opacity: .5;
		font-weight: 200;
	}
	.buttons {
		width: 40%;
		display: flex;
	}
	.buttons button {
		margin: 0 5px;
		transition: background-color .2s ease;
		padding: .5rem 1rem;
		margin-bottom: 1rem;
		flex: 1;
		border: 1px solid #0001;
		background: transparent;
		cursor: pointer;
	}
	.buttons button:hover {
		background: #0001;
	}
</style>```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Fat_Triangle.svelte
```svelte
<script lang='ts'>
	import { k, Size, Point, ZIndex, svgPaths, Direction } from '../../ts/common/Global_Imports';
	import SVGD3 from './SVGD3.svelte';
	export let extraColor = k.color_background;
	export let extraPath = null;
	export let strokeColor;
	export let fillColor;
	export let position;
	export let size;
	const trianglePath = svgPaths.fat_polygon(size, Direction.left);

</script>

<SVGD3 name='fatTriangle'
	width={size}
	height={size}
	fill={fillColor}
	position={position}
	stroke={strokeColor}
	svgPath={trianglePath}
/>
{#if extraPath}
	<SVGD3 name='fatTriangleInside'
		width={size}
		height={size}
		fill={extraColor}
		stroke={extraColor}
		svgPath={extraPath}
		x={size / 4}
	/>
{/if}```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/Radio_Buttons.svelte
```svelte
<script lang='ts'>
	import { k, u } from '../../ts/common/Global_Imports';
	import { onMount } from 'svelte';
	export let fitWithin = k.width_details;
	export let idSelected = null;
	export let name = 'menu';
	export let menuItems;
	let style = k.empty;

	onMount(() => {
		determineStyle();
		if (!idSelected && menuItems.length > 0) {
			idSelected = menuItems[0].id;	// Initialize idSelected to the id of the first menuItem
		}
	});
	
	function handle_key_down(event) { event.preventDefault(); return false; }

	function handle_singleClick(id) {
		idSelected = id;
		const selectedMenuItem = menuItems.find(menuItem => menuItem.id === idSelected);
		if (!!selectedMenuItem) {
			selectedMenuItem.action();
		}
	}

	function determineStyle() {
		let totalWidth = 0;
		for (const item of menuItems) {
			const width = u.getWidthOf(item.label);
			totalWidth += width + 25;
		}
		if (totalWidth <= fitWithin) {
			style = `display:flex;
				flex-direction:row;
				align-items:center;
				justify-content:space-around;
			`.removeWhiteSpace();
		}
	}

</script>

<style>
	.radio {
		cursor: pointer;
	}
	.menu-item {
		align-items: center;
		position: relative;
		cursor: pointer;
		display: flex;
		left: -3px;
	}
	.label-text {
		position: relative;
		margin-top: 1px;
	}
</style>

<div class='radio-buttons'
	style={style}>
	{#each menuItems as menuItem}
		<label class='menu-item' id = {menuItem.label}
			style='on:keydown={handle_key_down}'>
			<input class='radio'
				name={name}
				type='radio'
				value={menuItem.id}
				style='outline: none'
				bind:group={idSelected}
				on:keydown={handle_key_down}
				on:change={() => handle_singleClick(menuItem.id) }/>
			<div class="label-text">{menuItem.label}</div>
		</label>
	{/each}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/experimental/OpenButton.svelte
```svelte
<script>
	import { s_hierarchy, s_thing_fontFamily } from '../../ts/state/Svelte_Stores';
	import { k, u, Size, Point } from '../../ts/common/Global_Imports';
	export let center = Point.zero;
	export let multiple = k.empty;		// can be set to 'multiple'
	export let accept = k.empty;
	const label = 'import';
	const labelWidth = u.getWidthOf(label);
	let fileInput;

	function handleClick() {
		fileInput.click();
	}

	function handleFileChange(event) {
		const files = event.target?.files ?? [];
		setTimeout( async () => {
			for (const file of files) {
				await get(s_hierarchy).fetch_fromFile(file);
			}
			target.value = k.empty;		// allow re-selection of the same file
		}, 1);
	}
</script>

<style>
	.button {
		position: absolute;
		left: 0;
		top: 0;
		transform: translate(-50%, -50%); /* Center the button at (x, y) */
		padding: 10px 20px;
		border: 2px solid #000;
		border-radius: 4px;
		background-color: transparent;
		color: #000;
		cursor: pointer;
		transition: background-color 0.3s, color 0.3s;
		user-select: none;
		text-align: center;
	}

	.button:hover {
		background-color: #000;
		color: #fff;
	}
</style>

<input
	type='file'
	accept={accept}
	bind:this={fileInput}
	style='display: none;'
	on:change={handleFileChange}
/>

<button
	class='button'
	on:click={handleClick}
	style='
		top: {center.y}px;
		left: {center.x}px;'>
	{label}
</button>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget_Reveal.svelte
```svelte
<script lang='ts'>
	import { h, k, core, u, x, hits, show, debug, colors, signals, controls, elements, svgPaths } from '../../ts/common/Global_Imports';
	import { S_Element, S_Component, T_Layer, T_Counts_Shown, T_Hit_Target } from '../../ts/common/Global_Imports';
	import { onMount, onDestroy } from 'svelte';
	import SVG_D3 from '../draw/SVG_D3.svelte';
	export let pointsTo_child = true;
    export let zindex = T_Layer.dot;
	export let s_reveal!: S_Element;
	const viewBox_left = 0;
	const size = k.height.dot;
	const viewBox_width = size;
	const { w_s_hover } = hits;
	const ancestry = s_reveal.ancestry;
	const g_widget = ancestry.g_widget;
	const { w_grabs, w_thing_title } = x;
	const viewBox = k.tiny_outer_dots.viewBox;
	const reveal_count = g_widget.reveal_count;
	const show_reveal_count = reveal_count > 1;
	const { w_items: w_expanded } = x.si_expanded;
	const { w_t_countDots, w_show_countsAs } = show;
	const { w_thing_color, w_background_color } = colors;
	let fill_color = debug.lines ? 'transparent' : s_reveal.fill;
	let svgPathFor_tiny_outer_dots: string | null = null;
	let svgPathFor_fat_center_dot: string | null = null;
	let svg_outline_color = s_reveal.svg_outline_color;
	let element: HTMLElement | null = null;
	let center = g_widget.center_ofReveal;
	let counts_color = s_reveal.stroke;
	let svgPathFor_revealDot = k.empty;
	let color = ancestry.thing?.color;
	let offsetFor_fat_center_dot = 0;
	let s_component: S_Component;
	let wrapper_style = k.empty;
	let reveal_count_left = 0;
	let reveal_count_top = 0;
	let count_fontSize = 0;

	s_component = signals.handle_reposition_widgets_atPriority(2, ancestry, T_Hit_Target.reveal, (received_ancestry) => {
		center = g_widget.center_ofReveal;
	});

	onMount(() => {
		update();
		return () => s_component.disconnect();
	});

	$: if (!!element) {
		s_reveal.set_html_element(element);
		s_reveal.handle_s_mouse = (s_mouse) => {
			if (s_mouse.isDown) {
				let focus_ancestry: Ancestry | null = null;
				if (show.inRadialMode) {
					focus_ancestry = ancestry;
				} else if (ancestry.hasChildren || ancestry.thing.isBulkAlias) {
					h.ancestry_toggle_expansion(ancestry);
					if (ancestry.children_hidden_by_depth_limit) {
						focus_ancestry = ancestry.ancestry_createUnique_byStrippingBack(ancestry.global_depth_limit - 1);
					}
				}
				focus_ancestry?.becomeFocus();
				if (show.inRadialMode) {
					focus_ancestry?.grabOnly();
				}
			}
			return true;
		};
	}

	onDestroy(() => {
		hits.delete_hit_target(s_reveal);
	});
	
	$: {
		const _ = `${u.descriptionBy_titles($w_grabs)}
			:::${u.descriptionBy_titles($w_expanded)}
			:::${$w_s_hover?.id ?? 'null'}
			:::${$w_background_color}
			:::${$w_t_countDots}
			:::${$w_thing_title}
			:::${$w_thing_color}`;
		update();
	}

	$: {
		wrapper_style = `
			cursor: pointer;
			width: ${size}px;
			position: absolute;
			z-index: ${zindex};
			height: ${size}px;
			top: ${center.y - size / 2}px;
			left: ${center.x - size / 2}px;
		`.removeWhiteSpace();
	}

	function update () {
		update_forCounts();
		update_svgPaths();
		update_colors();
	}

	function update_forCounts() {
		const count_index = reveal_count < 10 ? 0 : reveal_count < 100 ? 1 : 2;
		reveal_count_left = ancestry.points_right ? -1.5 : -1;
		reveal_count_top = [2.3, 4.3, 6][count_index];
		count_fontSize = [10, 7, 5][count_index];
	}

	function update_colors() {
		// element_color is now reactive (uses thing_color automatically for dots)
		// hoverColor is also reactive (computed from element_color)
		fill_color = debug.lines ? 'transparent' : s_reveal.fill;
		svg_outline_color = s_reveal.svg_outline_color;
		counts_color = s_reveal.stroke;
		color = ancestry.thing?.color;
		debug.log_colors(`REVEAL ${ancestry.title}${s_reveal.isInverted ? ' INVERTED' : ''}`)
	}

	function update_svgPaths() {
		const thing = ancestry.thing;
		if (!!thing) {
			const dotsAre_hiding = ancestry.hidden_by_depth_limit && !ancestry.shows_children;
			const show_fat_center_dot = thing.isBulkAlias || dotsAre_hiding;
			offsetFor_fat_center_dot = show_fat_center_dot ? 0 : -1;
			svgPathFor_revealDot = ancestry.svgPathFor_revealDot;
			svgPathFor_tiny_outer_dots = show_reveal_count ? ancestry.svgPathFor_tiny_outer_dot_pointTo_child(pointsTo_child) : null;
			svgPathFor_fat_center_dot = show_fat_center_dot ? svgPaths.circle_atOffset(size, 3) : null;
		}
	}

</script>

{#if s_reveal}
	<div class='reveal-wrapper'
		style={wrapper_style}
		bind:this={element}>
		<div class='reveal-dot'
			role="button"
			tabindex="0"
			style='
				width: {size}px;
				height: {size}px;
				overflow: visible;
				position: relative;'>
			<div style='
				top: 0px;
				left: 0px;
				width: {size}px;
				height: {size}px;
				position: absolute;'>
				<SVG_D3 name='reveal-dot-svg'
					svgPath={svgPathFor_revealDot}
					viewBox_width={viewBox_width}
					stroke={svg_outline_color}
					left={viewBox_left}
					fill={fill_color}
					height={size}
					width={size}
					top={0}/>
			</div>
			{#if !!svgPathFor_fat_center_dot}
				<div class='fat_center-dot' style='
					left:{offsetFor_fat_center_dot}px;
					top:{offsetFor_fat_center_dot}px;
					position:absolute;
					height:{size}px;
					width:{size}px;'>
					<SVG_D3 name='fat_center-dot-svg'
						svgPath={svgPathFor_fat_center_dot}
						stroke={counts_color}
						fill={counts_color}
						height={size}
						width={size}
					/>
				</div>
			{/if}
			<div class='reveal-count' style='
				overflow:visible;
				position:absolute;
				top:{k.tiny_outer_dots.offset.y}px;
				left:{k.tiny_outer_dots.offset.x}px;
				width:{k.tiny_outer_dots.diameter}px;
				height:{k.tiny_outer_dots.diameter}px;
				z-index:{T_Layer.frontmost};'>
				{#if ($w_show_countsAs == T_Counts_Shown.numbers) && show_reveal_count && !svgPathFor_fat_center_dot}
					<div class='reveal-count-number'
						style='
							width:100%;
							height:100%;
							position: absolute;
							text-align: center;
							color:{counts_color};
							vertical-align: middle;
							top:{reveal_count_top}px;
							left:{reveal_count_left}px;
							font-size:{count_fontSize}px;
							shape-rendering: geometricPrecision;'>
						{reveal_count}
					</div>
				{:else if ($w_show_countsAs == T_Counts_Shown.dots) && !!svgPathFor_tiny_outer_dots}
					<svg class='tiny-outer-dots-svg'
						viewBox='{viewBox}'
						preserveAspectRatio='none'
						width={k.tiny_outer_dots.diameter}px
						height={k.tiny_outer_dots.diameter}px
						style='
							position: absolute;
							shape-rendering: geometricPrecision;'>
						<path
							fill={color}
							stroke={svg_outline_color}
							d={svgPathFor_tiny_outer_dots}
							vector-effect='non-scaling-stroke'/>
					</svg>
				{/if}
			</div>
		</div>
	</div>
{/if}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget_Drag.svelte
```svelte
<script lang='ts'>
	import { T_Drag, T_Layer, T_Signal, T_Counts_Shown, T_Hit_Target, T_Orientation } from '../../ts/common/Global_Imports';
	import { e, k, core, u, x, hits, show, debug, colors, radial } from '../../ts/common/Global_Imports';
	import { signals, elements, controls, svgPaths } from '../../ts/common/Global_Imports';
	import { Point, S_Element, S_Component } from '../../ts/common/Global_Imports';
	import { onMount, onDestroy } from 'svelte';
	import SVG_D3 from '../draw/SVG_D3.svelte';
	export let reveal_isAt_right = true;
	export let s_drag!: S_Element;
	const size = k.height.dot;
	const capture_size = size;
	const { w_thing_color } = colors;
    const ancestry = s_drag.ancestry;
	const g_widget = ancestry.g_widget;
	const { w_background_color } = colors;
	const { w_s_hover, w_dragging } = hits;
	const { w_t_countDots, w_show_countsAs } = show;
	const { w_grabs, w_ancestry_focus, w_ancestry_forDetails } = x;
	let fill_color = debug.lines ? 'transparent' : s_drag.fill;
	let svg_outline_color = s_drag.svg_outline_color;
	let element: HTMLElement | null = null;
	let center = g_widget.center_ofDrag;
	let parents_color = s_drag.stroke;
	let svgPathFor_ellipses = k.empty;
	let svgPathFor_related = k.empty;
	let svgPathFor_dragDot = k.empty;
    let thing = ancestry.thing;
	let thing_color = thing?.color;
	let arrow_stroke_color = thing_color;
	let arrow_fill_color = thing_color;
	let s_component: S_Component;
	let isHovering = false;

	update_svgPaths();
	update_colors();

	s_component = signals.handle_signals_atPriority([T_Signal.alteration], 0, ancestry, T_Hit_Target.drag, (t_signal, value): S_Component | null => {
		s_drag.isInverted = !!ancestry && ancestry.alteration_isAllowed;
		update_colors();
	});

	onMount(() => {
		return () => s_component.disconnect();
	});

	// Set handler when element becomes available (handles re-renders)
	$: if (!!element) {
		s_drag.set_html_element(element);
		s_drag.handle_s_mouse = (s_mouse) => {
			if (s_mouse.isDown && !!ancestry && !radial.isDragging && (!$w_dragging || $w_dragging === T_Drag.none)) {
				const shiftKey = s_mouse.event?.shiftKey ?? false;
				if (shiftKey) {
					// Only block Widget when we actually handle the grab
					x.dragDotJustClicked = true;
					setTimeout(() => { x.dragDotJustClicked = false; }, 100);
				}
				e.handle_singleClick_onDragDot(shiftKey, ancestry);
			}
			return true;
		};
	}

	onDestroy(() => {
		hits.delete_hit_target(s_drag);
	});

	$: {
		const _ = `${$w_t_countDots}:::${$w_show_countsAs}`;
		update_svgPaths();
	}

	$: {
		const _ = `${$w_thing_color}
			:::${$w_background_color}
			:::${$w_ancestry_focus?.id}
			:::${$w_s_hover?.id ?? 'null'}
			:::${$w_ancestry_forDetails?.id}
			:::${u.descriptionBy_titles($w_grabs)}`;
		update_colors();
	}

	$: wrapper_style = `
		cursor: pointer;
		position: absolute;
		width: ${capture_size}px;
		height: ${capture_size}px;
		top: ${center.y - capture_size / 2}px;
		left: ${center.x - capture_size / 2}px;
	`.removeWhiteSpace();

	function update_hovering() {
		const isAncestry_presented = $w_ancestry_forDetails.equals(ancestry);
		s_drag.isHovering = isHovering != (ancestry.isGrabbed && !isAncestry_presented);
	}

	function update_svgPaths() {
		svgPathFor_dragDot = svgPaths.oval(size, false);
		update_svgPathsExtra();
	}

	function update_colors() {
		if (!elements.isDragging && !!s_drag && !!thing) {
			arrow_fill_color = s_drag.isHovering ? $w_background_color : thing_color;
			arrow_stroke_color = s_drag.isHovering ? $w_background_color : thing_color;
			fill_color = debug.lines ? 'transparent' : s_drag.fill;
			svg_outline_color = s_drag.svg_outline_color;
			parents_color = s_drag.stroke;
			thing_color = thing.color;
		}
	}

	function update_svgPathsExtra() {
		svgPathFor_related = svgPathFor_ellipses = null;
		if (!!thing && ($w_show_countsAs == T_Counts_Shown.dots)) {
			const count = thing.parents.length;		
			if (count > 1 && show.parent_dots) {
				svgPathFor_ellipses = svgPaths.ellipses(6, 0.8, false, count, size / 2);
			}
			if (thing.hasRelated && show.related_dots) {
				const x = (show.inRadialMode ? 5.2 : 4.5) * (reveal_isAt_right ? -1 : 1);
				svgPathFor_related = svgPaths.circle_atOffset(size, 3, Point.x(x));
			}
		}
	}

</script>

{#if s_drag}
	<div class='drag-wrapper'
		style={wrapper_style}
		bind:this={element}>
		<button class={name}
			id={s_component.id}
			style='
				border:none;
				cursor:pointer;
				width:{size}px;
				height:{size}px;
				color:transparent;
				position:absolute;
				z-index:{T_Layer.dot};
				background-color:transparent;'>
			<div id={'div-for-' + name}
				style='
					left:0px;
					top:0.3px;
					width:{size}px;
					height:{size}px;
					color:transparent;
					position:absolute;
					z-index:{T_Layer.dot};'>
				<SVG_D3 name={'svg-' + name}
					width={size}
					height={size}
					fill={fill_color}
					stroke={svg_outline_color}
					svgPath={svgPathFor_dragDot}/>
				{#if svgPathFor_ellipses}
					<SVG_D3 name={'svg-parents-' + name}
						width={size}
						height={size}
						fill={parents_color}
						stroke={parents_color}
						svgPath={svgPathFor_ellipses}/>
				{/if}
				{#if svgPathFor_related}
					<SVG_D3 name={'svg-related-' + name}
						width={size}
						height={size}
						stroke={thing_color}
						fill={$w_background_color}
						svgPath={svgPathFor_related}/>
				{/if}
				{#if ancestry.isFocus && ($w_show_countsAs != T_Counts_Shown.dots)}
					<SVG_D3 name={'svg-focus-' + name}
						width={size}
						height={size}
						fill={arrow_fill_color}
						stroke={arrow_stroke_color}
						svgPath={svgPaths.arrow_forOrientation(size, 4, T_Orientation.left)}/>
				{/if}
			</div>
		</button>
	</div>
{/if}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget.svelte
```svelte
<script lang='ts'>
	import { T_Layer, T_Timer, T_Trait, T_Signal, T_Hit_Target, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { G_Widget, S_Mouse, S_Element, S_Component } from '../../ts/common/Global_Imports';
	import { e, g, k, u, x, hits, show, debug, colors } from '../../ts/common/Global_Imports';
	import { controls, signals, elements, components } from '../../ts/common/Global_Imports';
	import { Rect, Point } from '../../ts/common/Global_Imports';
	import Widget_Reveal from './Widget_Reveal.svelte';
	import { onMount, onDestroy, tick } from 'svelte';
	import Widget_Title from './Widget_Title.svelte';
	import Widget_Drag from './Widget_Drag.svelte';
	export let g_widget!: G_Widget;
	const s_widget = g_widget.s_widget;	// put me first
	const { w_s_hover } = hits;
	const s_drag = s_widget.s_drag;
	const s_title = s_widget.s_title;
	const { w_thing_color } = colors;
	const ancestry = g_widget.ancestry;
	const s_reveal = s_widget.s_reveal;
	const { w_show_catalist_details } = show;
	const { w_count_mouse_up, w_shift_on_mouse_up } = e;
    const reveal_isAt_right = g_widget.reveal_isAt_right;
	const reveal_pointsTo_child = g_widget.pointsTo_child;
	const { w_grabs, w_s_title_edit, w_ancestry_focus } = x;
	let observer: MutationObserver | null = null;
	let width_ofWidget = g_widget.width_ofWidget;
	let mouse_up_count = $w_count_mouse_up;
	let element: HTMLElement | null = null;
	let border_radius = k.height.dot / 2;
	let revealCenter = Point.zero;
	let s_component: S_Component;
	let widget_style = k.empty;
	let showing_reveal = false;
	let reveal_id = k.unknown;
	let showing_drag = false;
	let trigger = k.empty;
	let height = 0;
	let left = 0;
	let top = 0;
	let thing;

	debug.log_draw(`WIDGET ${ancestry?.titles}`);
	setup_fromAncestry();		// this fails if ancestry's thing id is invalid
	final_layout();
	layout_maybe();

	s_component = signals.handle_anySignal_atPriority(1, ancestry, T_Hit_Target.widget, (t_signal, value): S_Component | null => {
		switch (t_signal) {
		case T_Signal.reattach:
				s_component?.debug_log_connection_state('Before reattachment');
				final_layout();
				(async () => {
					await tick();			// this is needed to ensure the element is connected
					s_component?.debug_log_connection_state('After reattachment');
				})();
			break;
		case T_Signal.reposition:
			layout_maybe();
			break;
		}
	});

	onMount(() => {
		if (!!element) {
			s_widget.set_html_element(element);
		}
		// Set up double-click detection on s_widget
		s_widget.mouse_detection = T_Mouse_Detection.none;
		s_widget.doubleClick_callback = (s_mouse: S_Mouse) => {
			const trait = ancestry.thing?.trait_forType(T_Trait.link);
			const link = trait?.text;
			if (!!link) {		// Thing has a link trait - open it instead of editing
				window.open(link, '_blank');
			} else {
				$w_show_catalist_details = true;
			}
		};
		return () => {
			debug.log_style('Widget unmounting for:', ancestry?.title);
			if (observer) observer.disconnect();
			s_component.disconnect();
		};
	});

	onDestroy(() => {
		hits.delete_hit_target(s_widget);
	});

	$: showing_drag = (!ancestry.isFocus || !show.inRadialMode) && (!ancestry.isRoot || show.inRadialMode);
	$: showing_reveal = (!ancestry.isFocus || !show.inRadialMode) && (ancestry?.showsReveal_forPointingToChild(reveal_pointsTo_child));

	$: {
		const _ = `${$w_thing_color}
			:::${$w_ancestry_focus.id}
			:::${$w_s_hover?.id ?? 'null'}`;
		update_style();
	}

	$: {
		const reactives = `${$w_s_title_edit?.t_edit}:::${u.descriptionBy_titles($w_grabs)}`;
		if (reactives != trigger && !!ancestry && s_widget.detect_ifState_didChange) {
			trigger = reactives;
			if (!(show.inRadialMode && ancestry.isFocus)) {
				g_widget.layout();
			}
			final_layout();
			s_component.debug_log_connection_state('GRABBED STATE CHANGED');
		}
	}

	$: if (!!s_component && !!s_component.element && s_component.isComponentLog_enabled && false) {
		observer = new MutationObserver((mutations) => {
			mutations.forEach((mutation) => {
				const element = s_component?.element;
				if (mutation.type === 'attributes' && mutation.attributeName === 'style' && mutation.target === element) {
					debug.log_style('Style changed on widget div for', ancestry?.title + ':', element.style.cssText);
				}
			});
		});
		
		observer.observe(s_component?.element, { 
			attributes: true, 
			attributeFilter: ['style'],
			attributeOldValue: true
		});
		debug.log_style('Observer set up on widget div for:', ancestry?.title);
	}

	function z_index(): number {
		return (show.inRadialMode && ancestry.isFocus) ? T_Layer.frontmost : T_Layer.widget;
	}

	function layout_maybe() {
		if (s_widget.detect_ifState_didChange) {
			final_layout();
		}
	}

	function final_layout() {
		const hasExtra_onRight = !!ancestry && !ancestry.isExpanded && (ancestry.childRelationships.length > 3);
		const origin_ofWidget = g_widget.origin.offsetBy(g_widget.offset_ofWidget);
		s_widget.rect = g.scaled_rect_forElement(s_title.html_element);
		width_ofWidget = g_widget.width_ofWidget;
		height = k.height.row - 1.5;
		border_radius = height / 2;
		left = origin_ofWidget.x;
		top = origin_ofWidget.y;
		update_style();
	}

	function update_style() {
		widget_style = `
			top: ${top}px;
			left: ${left}px;
			cursor: pointer;
			position: absolute;
			height: ${height}px;
			z-index: ${z_index()};
			${s_widget.background};
			color: ${s_widget.color};
			border: ${s_widget.border};
			width: ${width_ofWidget - 5}px;
			border-radius: ${border_radius}px;
		`.removeWhiteSpace();
	}

	function setup_fromAncestry() {
		s_widget.detect_ifState_didChange;
		thing = ancestry?.thing;
		if (!ancestry) {
			console.warn('widget has no ancestry');
		} else if (!thing) {
			console.warn(`relationship (of ancestry of widget) has no child [${ancestry?.relationship?.id ?? k.unknown}]`);
		} else {
			const title = thing.title ?? thing.id ?? k.unknown;
			reveal_id = `reveal ${title} ${ancestry.id}`;
		}
	}
    
</script>

{#if s_widget}
	<div class='widget'
		id={s_component.id}
		bind:this={element}
		style={widget_style}
		on:keyup={u.ignore}
		on:keydown={u.ignore}>
		<div class='widget-components'
			style='
				left: {-3}px;
				height: {height}px;
				position: absolute;
				width: {width_ofWidget}px;
				z-index: {(show.inRadialMode && ancestry.isFocus) ? T_Layer.frontmost : T_Layer.widget};
				top: {(show.inRadialMode && ancestry.isFocus) ? -0.5 : -3}px;'>
			<Widget_Title
				s_title = {s_title}
				fontSize = {k.font_size.common}px/>
			{#if showing_drag}
				<Widget_Drag
					s_drag = {s_drag}
					reveal_isAt_right = {reveal_isAt_right}/>
			{/if}
			{#if showing_reveal}
				<Widget_Reveal
					s_reveal = {s_reveal}
					pointsTo_child = {reveal_pointsTo_child}/>
			{/if}
		</div>
	</div>
{/if}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/widget/Widget_Title.svelte
```svelte
<script lang='ts'>
	import { e, g, h, k, u, x, core, hits, show, files, debug, colors, search, signals } from '../../ts/common/Global_Imports';
	import { T_Edit, T_Layer, T_Timer, T_Trait, T_Hit_Target, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { controls, elements, databases, Seriously_Range } from '../../ts/common/Global_Imports';
	import { S_Mouse, S_Element, S_Component } from '../../ts/common/Global_Imports';
	import DB_Filesystem from '../../ts/database/DB_Filesystem';
	import { T_Database } from '../../ts/database/DB_Common';
	import { onMount, onDestroy, tick } from 'svelte';
	import { get } from 'svelte/store';
	export let s_title!: S_Element;
	export let fontSize = `${k.font_size.common}px`;
	const { w_s_hover } = hits;
	const ancestry = s_title.ancestry;
	const thing = ancestry?.thing;
	const { w_thing_color } = colors;
	const padding = `1px 0px 0px 0px`;
	const g_widget = ancestry.g_widget;
	const s_widget = g_widget.s_widget;
	const input_height = k.height.dot + 2;
	const { w_items: w_expanded } = x.si_expanded;
	const { w_mouse_location, w_mouse_button_down } = e;
	const { w_grabs, w_s_title_edit, w_ancestry_focus, w_thing_title, w_thing_fontFamily } = x;
	let title_width = (thing?.width_ofTitle ?? 0) + title_extra();
	let title_binded = thing?.title ?? k.empty;
	let layout_timer: number | null = null;
	let element: HTMLElement | null = null;
	let title_prior = thing?.title;
	let s_component: S_Component;
	let color = s_widget.color;
	let trigger = k.empty;
	let ghost = null;
	let input = null;
	let left = 0;
	let top = 0;

	function isEditing(): boolean { return ancestry?.isEditing ?? false; }
	function hasHTMLFocus(): boolean { return document.activeElement === input; }
	function isStopping(): boolean { return $w_s_title_edit?.ancestry_isStopping(ancestry) ?? false; }
	function isPercolating(): boolean { return $w_s_title_edit?.ancestry_isPercolating(ancestry) ?? false; }
	function title_extra(): number { return (show.inTreeMode && isEditing()) ? 2.2 : 0; }
	function hasChanges() { return title_prior != title_binded; }

	s_component = signals.handle_anySignal_atPriority(0, ancestry, T_Hit_Target.title, (t_signal, ancestry) => {
		updateInputWidth();
	});

	onMount(() => {
		debug.log_build(`TITLE ${ancestry?.title}`);
		if (!!element) {
			s_widget.set_html_element(element);
		}
		// Both s_title and s_widget need the handler since either might be selected
		s_title.handle_s_mouse = handle_s_mouse;
		s_widget.handle_s_mouse = handle_s_mouse;
		s_title.mouse_detection = T_Mouse_Detection.none;
		setup_doubleClick_forwarding();
		setTimeout(() => {
			updateInputWidth();
			if (isEditing()) {
				applyRange_fromThing_toInput();
				elements.element_set_focus_to(input);
			}
		}, 100);
		return () => s_component.disconnect();
	});

	function setup_doubleClick_forwarding() {
		s_title.doubleClick_callback = (s_mouse: S_Mouse) => {
			if (s_widget.doubleClick_callback) {
				s_widget.doubleClick_callback(s_mouse);
			}
		};
	}

	$: if (s_widget.doubleClick_callback) {
		setup_doubleClick_forwarding();
	}

	onDestroy(() => {
		hits.delete_hit_target(s_widget);
		hits.delete_hit_target(s_title);
	});

	$: if (!!input) {
		s_title.set_html_element(input);
	}

	$: {
		const _ = $w_s_title_edit;
		if (!!input) {
			title_width = (thing?.width_ofTitle ?? 0) + title_extra();
			color = s_widget.color;
		}
	}

	$: {
		const reactives = `${$w_thing_color}
			:::${$w_mouse_button_down}
			:::${$w_ancestry_focus?.id}
			:::${$w_s_hover?.id ?? 'null'}
			:::${u.descriptionBy_titles($w_grabs)}
			:::${u.descriptionBy_titles($w_expanded)}`;
		if (reactives != trigger) {
			const isFocus = ancestry?.isFocus ?? false;
			const isEditingNow = ancestry?.isEditing ?? false;
			const isGrabbed = ancestry?.isGrabbed ?? false;
			const adjust = show.inRadialMode && isFocus;
			top = 0.7 + (isGrabbed ? 0.4 : 0) - (adjust ? isGrabbed ? 2.5 : 2 : 0);
			color = s_widget.color;
			left = adjust ? 1.5 : 0.8;
			trigger = reactives;
		}
	}

	$: {
		const s_text_edit = $w_s_title_edit;
		if (hasHTMLFocus() && !s_text_edit) {
			stopEdit();
		} else if (!!input && !!s_text_edit) {
			if (s_text_edit.ancestry.id_thing == ancestry.id_thing) {
				input.value = ancestry.title;
			}
			if (s_text_edit.ancestry.equals(ancestry)) {
				switch (s_text_edit.t_edit) {
					case T_Edit.stopping:
						stopEdit();
						break;
					case T_Edit.editing:
						if (!hasHTMLFocus() && input) {
							input.focus({ preventScroll: true });
							applyRange_fromThing_toInput();
						}
						break;
				}
			}
		}
	}

	function handle_s_mouse(s_mouse: S_Mouse): boolean {
		if (s_mouse.isDown) {
			if (!!ancestry) {
				const SHIFT = !!s_mouse.event?.shiftKey;
				if (get(databases.w_t_database) === T_Database.filesystem) {
					if (ancestry.isRoot && !h.db.hasFolder) {
						// if root without folder selected - trigger folder picker
						h.db.selectFolder().then(() => {
							databases.w_data_updated.set(Date.now());
						});
						return true;
					}
					// Always grab in filesystem mode
					ancestry.grabOnly();
					// Try to show preview if file is previewable
					if (thing && !ancestry.hasChildren && h.db instanceof DB_Filesystem && h.db.isPreviewable(thing.title)) {
						files.show_previewOf_file(thing.id);
					}
					return true;
				} else if (isEditing()) {
					extractRange_fromInput_toThing();
					return true;
				} else if (!!$w_s_title_edit && $w_s_title_edit.isActive) {
					// while editing A, select a range, click B, click A, RETURN should reselect the range
					extractRange_fromInput_toThing();
					$w_s_title_edit.stop_editing();
					$w_s_title_edit = null;
					if (SHIFT) {
						ancestry.ungrab();
					}
				}
				
				if (SHIFT) {
					ancestry.toggleGrab();
				} else if (!ancestry.isGrabbed) {
					ancestry.grabOnly();
				} else if (ancestry.isEditable && !!input) {
					// Only start editing if this is not a deferred single-click from double-click timer
					// When the timer fires, doubleClick_fired is set to true, so check that
					const isDeferredClick = hits.doubleClick_fired;
					if (!isDeferredClick) {
						setTimeout(() => {
							ancestry.startEdit();
							thing_setSelectionRange_fromMouseLocation();
							// Focus directly - reactive statement will also try, but this ensures it happens
						if (input && !hasHTMLFocus()) {
							input.focus({ preventScroll: true });
						}
						applyRange_fromThing_toInput();
						}, 1);
					}
				}
			}
			return true;
		}
		return false;
	}

	$: wrapper_style = `
		cursor: pointer;
		position: absolute;
		width: ${title_width}px;
		height: ${k.height.row}px;
		top: ${g_widget.origin_ofTitle.y}px;
		left: ${g_widget.origin_ofTitle.x}px;
	`.removeWhiteSpace();

	function stopEdit() {
		debug.log_edit(`STOP ${title_binded}`);
		$w_s_title_edit = null;
		input?.blur();
		g.layout();
	}

	async function stop_andPersist() {
		if (!!thing && !!input && !!ancestry && isEditing() && !isPercolating()) {
			debug.log_edit(`INVOKING BLUR ${ancestry.title}`);
			input.blur();
			if (hasChanges()) {
				debug.log_edit(`PERSISTING ${thing?.title}`);
				await databases.db_now.thing_persistentUpdate(thing);
				title_prior = thing?.title;
			}
			await tick();
			if (!!$w_s_title_edit && $w_s_title_edit.actively_refersTo(ancestry)) {
				debug.log_edit(`STOPPING ${ancestry.title}`);
				$w_s_title_edit.stop_editing();
				$w_s_title_edit = null;
			}
		}
	}

	function extractRange_fromInput_toThing() {
		if (!!input && !!$w_s_title_edit) {
			const end = input.selectionEnd;
			const start = input.selectionStart;
			debug.log_edit(`EXTRACT RANGE ${start} ${end}`);
			$w_s_title_edit.thing_setSelectionRange(new Seriously_Range(start, end));
		}
	}

	function applyRange_fromThing_toInput() {
		const range = $w_s_title_edit?.thing_selectionRange;
		if (!!range && !!input) {
			const end = range.end;
			const start = range.start;
			input.setSelectionRange(start, end);
			debug.log_edit(`APPLY RANGE ${start} ${end}`);
		}
	}

	function thing_setSelectionRange_fromMouseLocation() {
		if (!!input && !!$w_s_title_edit && !isPercolating()) {
			const location = $w_mouse_location;
			if (!!location && g.scaled_rect_forElement(input)?.contains(location)) {
				const offset = u.convert_windowOffset_toCharacterOffset_in(location.x, input);
				debug.log_edit(`CURSOR OFFSET ${offset}`);
				$w_s_title_edit.thing_setSelectionRange_fromOffset(offset);
				$w_s_title_edit.set_isEditing();
			}
		}
	}

	function handle_cut_paste(event) {
		extractRange_fromInput_toThing();
	}

	function handle_focus(event) {
		u.consume_event(event);
		setTimeout(() => {
			if (!!ancestry && !!input && (!isEditing() || !ancestry.isGrabbed)) {
				input.blur();
			}
		}, 10);
	}

	function handle_blur(event) {
		if (!!ancestry && !isEditing() && hasHTMLFocus()) {
			stop_andPersist();
			debug.log_edit(`H BLUR ${title_binded}`);
			updateInputWidth();
			g.layout();
			search.update_search();
		}
	}

	function handle_input(event) {
		const title = event.target.value;
		if (!!thing && (!!title || title == k.empty)) {
			thing.title = title_binded = title;
			title_updatedTo(title);
		}
	}

	function handle_key_down(event) {
		if (!!thing && !!ancestry && isEditing() && canAlterTitle(event)) {
			const key = event.key.toLowerCase();
			debug.log_key(`H KEY ${key}`);
			switch (key) {
				case 'arrowup':
				case 'arrowdown':
				case 'arrowleft':
				case 'arrowright': break;
				case 'enter': u.consume_event(event); stop_andPersist(); break;
				case 'tab': u.consume_event(event); stop_andPersist(); h.ancestry_edit_persistentCreateChildOf(ancestry.parentAncestry); break;
			}
			extractRange_fromInput_toThing();
		}
	}

	function updateInputWidth() {
		if (!!input && !!ghost) {
			title_width = ghost.scrollWidth + title_extra();
		}
	}

	function canAlterTitle(event) {
		let canAlter = (event instanceof KeyboardEvent) && !event.altKey && !event.shiftKey && !event.code.startsWith("Cluster_Label");
		if (canAlter && event.metaKey) {
			canAlter = false;
		}
		return canAlter;
	}

	function title_updatedTo(title: string | null) {
		const prior = $w_thing_title;
		if (prior != title && !!$w_s_title_edit) {
			extractRange_fromInput_toThing();
			$w_thing_title = title;
			debug.log_edit(`TITLE ${title}`);
			$w_s_title_edit.title = title;
			if (layout_timer !== null) {
				clearTimeout(layout_timer);
			}
			layout_timer = setTimeout(() => {
				requestAnimationFrame(() => {
					layout_timer = null;
					if ($w_s_title_edit) {
						$w_s_title_edit.setState_temporarilyTo_whileApplying(T_Edit.percolating, () => {
							g.layout();
						});
					}
				});
			}, 400);
			debug.log_edit(`UPDATED ${$w_s_title_edit.description}`);
		}
	}

</script>

<style lang='scss'>
	input:focus {
		outline: none;
	}
</style>

<div class='title-wrapper'
	bind:this={element}
	style={wrapper_style}>
	<span class='ghost'
		bind:this={ghost}
		style='left:-9999px;
			white-space: pre;
			padding: {padding};
			position: absolute;
			visibility: hidden;
			font-size: {fontSize};
			font-family: {$w_thing_fontFamily};'>
		{title_binded}
	</span>
	<input
		type='text'
		name='title'
		bind:this={input}
		id={s_component?.id}
		on:blur={handle_blur}
		on:focus={handle_focus}
		on:input={handle_input}
		bind:value={title_binded}
		on:cut={handle_cut_paste}
		on:paste={handle_cut_paste}
		class='title-input'
		on:keydown={handle_key_down}
		on:mouseover={(event) => { u.consume_event(event); }}
		style='
			border: none;
			top: {top}px;
			outline: none;
			color: {color};
			white-space: pre;
			left: {left - 2}px;
			position: absolute;
			padding: {padding};
			font-size: {fontSize};
			width: {title_width}px;
			z-index: {T_Layer.text};
			height: {input_height}px;
			{k.prevent_selection_style};
			background-color: transparent;
			font-family: {$w_thing_fontFamily};
			cursor: {isEditing() ? "text" : "pointer"};'/>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Traits.svelte
```svelte
<script lang='ts'>
	import { h, k, x, Size, colors, details, elements, databases, show } from '../../ts/common/Global_Imports';
	import { T_Detail, T_Hit_Target } from '../../ts/common/Global_Imports';
	import { T_Database } from '../../ts/database/DB_Common';
	import Identifiable from '../../ts/runtime/Identifiable';
	import Text_Editor from '../text/Text_Editor.svelte';
	const { w_item: w_trait } = x.si_thing_traits;
	const s_button = elements.s_element_for(new Identifiable('trait'), T_Hit_Target.trait, 'trait');
	let text_box_size = new Size(k.width.details - 34, 68);
	s_button.set_forHovering(colors.default, 'pointer');

	const { w_t_database } = databases;
	$: isFilesystemDB = $w_t_database === T_Database.filesystem;

	async function handle_click(event: MouseEvent) {
		if (!!$w_trait) {
			if (isFilesystemDB) {
				const thing = $w_trait.owner;
				if (thing) {
					show.show_previewOf_file(thing.id);
				}
			} else {
				window.open($w_trait.text, '_blank');
			}
		}
	}

</script>

{#if !$w_trait}
	<div class='no-traits'
		style='
			width: 100%;
			display: flex;
			position: relative;
			text-align: center;
			align-items: center;
			flex-direction: column;
			justify-content: center;
			-ms-overflow-style: none;
			height:{k.height.empty}px;
			font-size:{k.font_size.details}px;'>
			no traits
		</div>
{:else}
	<div class='trait-editor' style='padding: 6px'>
		<Text_Editor
			top={5}
			height={78}
			color={colors.default}
			label={$w_trait.t_trait}
			width={k.width.details - 20}
			original_text={$w_trait.text}
			label_underline={$w_trait.t_trait == 'link'}
			label_color={$w_trait.t_trait == 'link' ? 'blue' : 'black'}
			handleClick_onLabel={$w_trait.t_trait == 'link' ? handle_click : null}
			handle_textChange={async (label, text) => await h.trait_setText_forTrait(text, $w_trait)}/>
	</div>
{/if}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/Banner_Hideable.svelte
```svelte
<script lang='ts'>
	import { g, k, u, x, core, hits, show, details } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Detail, T_Direction } from '../../ts/common/Global_Imports';
	import Glows_Banner from '../mouse/Glows_Banner.svelte';
    export let t_detail: T_Detail;
	const { w_t_details } = show;
	const isSelection = (t_detail === T_Detail.selection);
	const { w_ancestry_forDetails, w_grabs, w_grabIndex } = x;
	const s_banner_hideable = details.s_banner_hideables_dict_byType[t_detail];
	const si_items = isSelection ? null : s_banner_hideable?.si_items;
	const { w_description, w_extra_titles: w_extra_titles_from_si } = si_items ?? {};
	let title = details.banner_title_forDetail(t_detail);
	let hideable_isVisible = true;
	let trigger = k.empty;
	let titles = [title];

	update_hideable_isVisible();

	$: {
		const grabs = $w_grabs ?? [];
		const grabIndex = $w_grabIndex ?? 0;
		const _ = `${$w_description}:::${$w_ancestry_forDetails?.id}:::${grabs.length}:::${grabIndex}`;
		// Compute extra_titles: for selection use grabs, for others use si_items
		const extra = isSelection 
			? (grabs.length > 1 ? [T_Direction.previous, T_Direction.next] : [])
			: ($w_extra_titles_from_si ?? []);
		update_banner_titles(grabs, grabIndex, extra);
	}

	$: { 
		const _ = $w_t_details;
		update_hideable_isVisible();
	}

	function update_trigger() {
		setTimeout(hits.recalibrate(), 2000)
	}

	function update_banner_titles(grabs: any[], grabIndex: number, extra_titles: string[]) {
		const new_title = details.banner_title_forDetail(t_detail, grabs, grabIndex);
		const new_titles = [new_title, ...extra_titles];
		if (new_titles.join(k.comma) != titles.join(k.comma)) {
			const prior_titles = titles;
			titles = new_titles;
			title = new_title;
			update_trigger();
		}
	}

	function update_hideable_isVisible() {
		let isVisible = true;
		if (s_banner_hideable?.hasBanner) {	// d_header has no banner
			isVisible = $w_t_details?.includes(T_Detail[t_detail]) ?? false;
		}
		if (isVisible != hideable_isVisible) {
			hideable_isVisible = isVisible;
			update_trigger();
		}
	}

	function toggle_hidden(t_detail: string) {
		let t_details = $w_t_details;
		if (t_details.includes(t_detail)) {
			t_details = u.remove_fromArray_byReference(t_detail, t_details);
		} else {
			t_details.push(t_detail);
		}
		$w_t_details = t_details;
		update_hideable_isVisible();
	}

</script>

<div class='{titles[0]}-dynamic-container'
	style='
		width: 100%;
		height: auto;
		display: flex;
		position: relative;
		flex-direction: column;
		z-index:{T_Layer.stackable};
		background-color: transparent;'>
	{#key trigger}
		{#if s_banner_hideable?.hasBanner}
			<div class='banner'
				style='
					top: 0px;
					width: 100%;
					display: flex;
					cursor: pointer;
					align-items: stretch;
					height: {g.glows_banner_height}px;'>
					<Glows_Banner
						titles={titles}
						width={k.width.details}
						toggle_hidden={toggle_hidden}
						banner_id={T_Detail[t_detail]}
						font_size={k.font_size.banners}
						isSelected={hideable_isVisible}
						height={g.glows_banner_height}/>
			</div>
		{/if}
		{#if hideable_isVisible}
			<div class='hideable'
				style='
					z-index:{T_Layer.hideable};'>
				<slot />
			</div>
		{/if}
	{/key}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Actions.svelte
```svelte
<script lang='ts'>
	import { T_Layer, T_Detail, T_Action, T_Request, T_Predicate, T_Alteration, T_Hit_Target, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { c, e, g, h, k, core, u, x, show, Point, colors, signals, S_Mouse } from '../../ts/common/Global_Imports';
	import { elements, details, controls } from '../../ts/common/Global_Imports';
	import Buttons_Table from '../mouse/Buttons_Table.svelte';
	import Separator from '../draw/Separator.svelte';
	import Button from '../mouse/Button.svelte';
	export let top = 2;
	const title_gap = 4;
	const has_title = true;
	const { w_t_graph } = show;
	const top_tableHeight = 93;
	const left_afterTitle = 39.5;
	const bottom_tableHeight = 73;
	const { w_user_graph_offset } = g;
	const { w_background_color } = colors;
	const table_width = k.width.details - 8;
	const { w_items: w_expanded } = x.si_expanded;
	const bottom_padding = bottom_tableHeight - 48;
    const font_sizes = [k.font_size.instructions, k.font_size.instructions];
	const { w_grabs, w_s_title_edit, w_s_alteration, w_ancestry_forDetails } = x;
    const s_banner_hideable = details.s_banner_hideables_dict_byType[T_Detail.actions];
	const s_cancel = elements.s_element_for($w_ancestry_forDetails, T_Hit_Target.cancel, k.empty);
	let list_title = $w_ancestry_forDetails?.isExpanded && show.inTreeMode ? 'hide list' : 'list';
	let button_titles = compute_button_titles();
	let no_actions = k.nothing_to_show;
	let actions_top = top + 3;
    let reattachments = 0;
	s_cancel.set_forHovering(colors.default, 'pointer');

	//////////////////////////////////////////////////////////////
	//															//
	//  buttons row sends column & T_Request:					//
	// 	  is_disabled calls:	isAction_disabledAt		//
	//	  handle_s_mouse calls:	handle_action_clickedAt ...		//
	//    n.b., long press generates multiple calls				//
	//  buttons table adds row (here it becomes row)			//
	//															//
	//////////////////////////////////////////////////////////////
	
    $:	{
		const _ = top;
		actions_top = top + 3;
	}

	$: {
		const _ = `${u.descriptionBy_titles($w_expanded)}:::${u.descriptionBy_titles($w_grabs)}`;
		update_button_titles();
	}

	$: {
		const _ = `${$w_s_title_edit?.description}`;
		const while_editing = 'While editing, no actions are available';
		no_actions = !$w_s_title_edit?.isActive ? k.nothing_to_show : while_editing;
	}

	$: {
		const _ = `${$w_user_graph_offset}
		:::${$w_s_title_edit?.description}
		:::${$w_t_graph}
		:::${$w_background_color}
		:::${x.si_found.w_index}
		:::${$w_s_alteration}`;
		reattachments++;
	}

	function row_isAltering(row: number): boolean {
		return [T_Action.add, T_Action.delete].includes(row);
	}

	function handle_cancel(s_mouse: S_Mouse) {
		if (s_mouse.isDown) {
			h.stop_alteration();
		}
	}

	function target_ofAlteration(): string | null {
		const s_alteration = $w_s_alteration;
		const kind_ofAPredicate = s_alteration?.predicate?.kind;
		return kind_ofAPredicate == T_Predicate.contains ? 'parent' : kind_ofAPredicate == T_Predicate.isRelated ? 'related' : null;
	}

	function update_button_titles(): void {
		const ancestry = $w_ancestry_forDetails;
		list_title = show.inTreeMode && !!ancestry && ancestry.isExpanded ? 'hide list' : 'show list';
		button_titles = compute_button_titles();
		setTimeout(() => reattachments++, 0);
	}

	function group_andIndex(row: number): [number, number] {
		const index = row;
		const group = index < 5 ? 0 : 1;
		const index_withinGroup = index % 5;
		return [group, index_withinGroup];
	}

	function name_for(row: number, column: number): string {
		const [group, index] = group_andIndex(row);
		const titles = button_titles[group][row];
		if (!!titles && titles.length > column) {
			return `${titles[0]}-${titles[column]}`;
		}
		return k.empty;
	}

	function isAction_invertedAt(row: number, column: number): boolean {
		const action = target_ofAlteration();
		const s_alteration = $w_s_alteration;
		const t_alteration = s_alteration?.t_alteration;
		return !!t_alteration && !!action && action == e.name_ofActionAt(row, column)
			&& ((row == T_Action.delete && t_alteration == T_Alteration.delete)
			||  (row == T_Action.add    && t_alteration == T_Alteration.add));
	}

	function compute_button_titles() {
		return [
			[['browse', 'left', 'up', 'down', 'right'],
			['focus',   'selection', 'parent of selection'],
			['show',    'selection', `${list_title}`, 'entire graph'],
			['center',  'focus', 'selection', 'graph']],
			[['add',    'child', 'sibling', 'line', 'parent', 'related'],
			['delete',  'selection', 'parent', 'related'],
			['move',    'left', 'up', 'down', 'right']],
		];
	}

	function handle_action_autorepeatAt(s_mouse: S_Mouse, t_action: number, column: number, name: string) {
		const valid_autorepeat = [T_Action.browse, T_Action.move].includes(t_action);
		if (s_mouse.isDown || (s_mouse.isRepeat && valid_autorepeat)) {
			e.handle_action_clickedAt(s_mouse, t_action, column, name);
		}
	}

	function handle_actionRequest(t_request: T_Request, s_mouse: S_Mouse, name: string, row: number, column: number): any {
		if (name == 'bottom-actions') {
			row += 4;
		}
		const isAltering = !!$w_s_alteration;
		switch (t_request) {
			case T_Request.name:		 return e.name_ofActionAt(row, column);
			case T_Request.is_visible:	 return !isAltering ? true : row_isAltering(row);
			case T_Request.is_disabled:  return e.isAction_disabledAt(row, column);
			case T_Request.is_inverted:  return !isAltering ? false : isAction_invertedAt(row, column);
			case T_Request.handle_s_mouse: return handle_action_autorepeatAt(s_mouse, row, column, name_for(row, column + 1));
		}
		return null;
	}

</script>

{#key reattachments}
	{#if !$w_grabs || $w_grabs.length == 0 || $w_s_title_edit?.isActive}
		<div class='no-actions'>
			<p style='user-select:none; text-align:center; font-size:{k.font_size.instructions}px; position:relative; display:flex; align-items:center; justify-content:center;'>
				{no_actions}
			</p>
		</div>
	{:else }
		<div class='actions'
			style='
				width: 100%;
				user-select: none;
				position:relative;
				top:{actions_top}px;
				z-index:{T_Layer.action};
				padding-bottom:{bottom_padding}px;'>
			{#if $w_s_alteration}
				<div class='alteration-instructions'
					style='
						width: 100%;
						display:block;
						user-select:none;
						position:relative;
						text-align:center;
						z-index:{T_Layer.action};
						font-size:{k.font_size.instructions}px;'>
					<div style='top:9px; width: 100%; position:relative;'>
						To <em>{$w_s_alteration.t_alteration}</em> an item as <em>{target_ofAlteration() ?? k.unknown}</em>
						<br> to <strong>{$w_ancestry_forDetails.title}</strong>
						<br> choose that item's <em>blinking</em> dot
					</div>
					<Button
						center={new Point(k.width.details / 2, 22)}
						font_size={k.font_size.instructions}
						handle_s_mouse={handle_cancel}
						zindex={T_Layer.frontmost}
						name='cancel-alteration'
						height={k.height.button}
						color = colors.default
						s_button={s_cancel}
						position='relative'
						width={40}>
						cancel
					</Button>
				</div>
			{:else}
				<Buttons_Table name='first'
					top={1}
					gap={2}
					width={table_width}
					has_title={has_title}
					title_gap={title_gap}
					font_sizes={font_sizes}
					t_target={T_Hit_Target.action}
					closure={handle_actionRequest}
					button_height={k.height.button}
					button_titles={button_titles[0]}
					mouse_detection={T_Mouse_Detection.autorepeat}/>
				<Separator name='after-upper-titles-column'
					isHorizontal={false}
					has_thin_divider={true}
					length={top_tableHeight}
					margin={k.details_margin}
					origin={new Point(left_afterTitle, -3)}
					thickness={k.thickness.separator.details}/>
				<Buttons_Table name='second'
					gap={2}
					top={17}
					row_offset={4}
					width={table_width}
					has_title={has_title}
					title_gap={title_gap}
					font_sizes={font_sizes}
					t_target={T_Hit_Target.action}
					closure={handle_actionRequest}
					button_height={k.height.button}
					button_titles={button_titles[1]}
					mouse_detection={T_Mouse_Detection.autorepeat}/>
				<Separator name='after-lower-titles-column'
					isHorizontal={false}
					has_thin_divider={true}
					margin={k.details_margin}
					length={bottom_tableHeight}
					thickness={k.thickness.separator.details}
					origin={new Point(left_afterTitle, top_tableHeight - 10)}/>
				<Separator name='bottom-of-actions'
					isHorizontal={true}
					has_thin_divider={true}
					margin={k.details_margin}
					title='edit your hierarchy'
					length={k.width.details - 1}
					title_left={k.separator_title_left}
					thickness={k.thickness.separator.details}
					origin={new Point(0.5, top_tableHeight - 10)}/>
			{/if}
		</div>
	{/if}
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Selection.svelte
```svelte
<script lang='ts'>
	import { c, g, k, p, core, u, x, show, colors, details, elements } from '../../ts/common/Global_Imports';
	import { T_Thing, T_Layer, T_Hit_Target } from '../../ts/common/Global_Imports';
	import { Point, Thing, Ancestry } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
	import type { Integer } from '../../ts/types/Types';
	import Text_Table from '../text/Text_Table.svelte';
	import Separator from '../draw/Separator.svelte';
	import Portal from '../draw/Portal.svelte';
	import Color from '../mouse/Color.svelte';
	import { onMount } from 'svelte';
	export let top = 6;
	const id = 'selection details';
	const { w_t_details } = show;
	const s_info = elements.s_element_for(new Identifiable(id), T_Hit_Target.details, id);
	const { w_grabs, w_thing_title, w_ancestry_focus, w_ancestry_forDetails, w_order_changed_at } = x;
	let ancestry: Ancestry | null = $w_ancestry_forDetails;
	let thing: Thing | null = ancestry?.thing ?? null;
	let thingHID: Integer | null = thing?.hid;
	let characteristics: Array<Object> = [];
	let relationships: Array<Object> = [];
	let color_origin: Point | null = null;
	let color = colors.default_forThings;
	let properties: Array<Object> = [];
	let characteristics_table: any;
	let thing_title = thing?.title;
	let picker_offset = k.empty;
	let trigger = k.empty;

	$: $w_t_details, layout_forColor();
	function handle_toggle_properties(event: Event) {
		details.show_properties = !details.show_properties;
	}

	$: {
		update_forAncestry();
		trigger = `${u.descriptionBy_title($w_grabs)}:::${$w_ancestry_focus?.title}:::${$w_thing_title}:::>${u.descriptionBy_title($w_grabs)}:::${$w_ancestry_forDetails?.title}:::<${$w_order_changed_at}`;
	}

	onMount(() => {
		update_forAncestry();
		s_info.set_forHovering(colors.default, 'pointer');
	});

	function layout_forColor() {
		if (!!thing && !!characteristics_table && typeof characteristics_table.absolute_location_ofCellAt === 'function') {
			const row = Math.max(0, characteristics.findIndex(([key]) => key === 'color'));
			const offset_toRow = characteristics_table.absolute_location_ofCellAt(row, 1);
			color_origin = offset_toRow.offsetByXY(-6.5, -6.8);
			picker_offset = `-54px`;
		}
	}

	function handle_colors(result: string) {
		thing.color = color = result;
		thing.signal_color_change();
		(async () => {
			await thing.persist();
		})();
	}

	function update_forAncestry() {
		ancestry = $w_ancestry_forDetails;
		thing = ancestry?.thing;
		if (!!thing) {
			thing_title = thing.title;
			thingHID = thing.hid;
			color = thing.color;
			characteristics = [
				['modified', thing.persistence.lastModifyDate.toLocaleString()],
				['color',	 ancestry.isEditable ? k.empty : 'not editable'],
				['children', ancestry.children.length.supressZero()],
				['parents',  thing.parents.length.supressZero()],
				['relateds', thing.relatedRelationships.length.supressZero()],
				['progeny',	 ancestry.progeny_count().supressZero()],
			];
			properties = [
				['id',		 thing.id.beginWithEllipsis_forLength(15)],
				['ancestry', ancestry.id.beginWithEllipsis_forLength(15)],
				['kind',	 ancestry.predicate.kind],
				['type',	 Object.keys(T_Thing).find(k => T_Thing[k] === thing.t_thing)],
			];
			relationships = [
				['tags',	 x.si_thing_tags.length.supressZero()],
				['traits',	 x.si_thing_traits.length.supressZero()],
				['depth',	 ancestry.depth.supressZero()],
				['order',	 ancestry.order.supressNegative()],
			];
			layout_forColor();
		}
	}

</script>

{#key trigger}
	{#if !ancestry || !thing}
		<div>
			<p style='text-align:center; font-size:{k.font_size.instructions}px; position:relative; display:flex; align-items:center; justify-content:center;'>
				{k.nothing_to_show}
			</p>
		</div>
	{:else}
		<div class='selection-container' 
			style='
				left:8px;
				width:100%;
				color:black;
				top:{top}px;
				height:auto;
				position:relative;
				padding-bottom:25px;
				z-index:{T_Layer.frontmost};'>
			<Text_Table
				top={0}
				row_height={11}
				array={characteristics}
				name='characteristics-table'
				font_size={k.font_size.info}
				bind:this={characteristics_table}/>
			<Text_Table
				top={29}
				left={100}
				row_height={11}
				position='absolute'
				array={relationships}
				name='relationships-table'
				font_size={k.font_size.info}/>
			{#if !!color_origin && !!ancestry && ancestry.isEditable}
				<Portal className='selection-color-portal'>
					<Color
						color={color}
						origin={color_origin}
						color_closure={handle_colors}
						picker_offset={picker_offset}/>
				</Portal>
			{/if}
			{#if details.show_properties}
				<Text_Table
					top={12}
					row_height={11}
					array={properties}
					name='properties-table'
					font_size={k.font_size.info}/>
			{/if}
		</div>
		<Separator name='toggle-properties'
			isHorizontal={true}
			has_fillets={true}
			has_double_fillet={true}
			has_thin_divider={false}
			origin={new Point(1, 125)}
			zindex={T_Layer.frontmost + 1}
			length={k.width.details - 2.5}
			handle_mouseUp={handle_toggle_properties}
			thickness={k.thickness.separator.details}
			title='click to {details.show_properties ? 'hide' : 'show more'}'/>
	{/if}
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Preferences.svelte
```svelte
<script lang='ts'>
	import { g, k, core, u, x, show, Rect, Point, colors } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Kinship, T_Counts_Shown } from '../../ts/common/Global_Imports';
	import Segmented from '../mouse/Segmented.svelte';
	import Separator from '../draw/Separator.svelte';
	import Slider from '../mouse/Slider.svelte';
	import Portal from '../draw/Portal.svelte';
	import Color from '../mouse/Color.svelte';
	import { onMount, tick } from 'svelte';
	export let top = 0;
	const back_up = -5;
	const picker_width = 122;
	const separator_left = 35;
	const position = 'relative';
	const { w_scale_factor } = g;
	const picker_internal_fudge = 41;
	const { w_separator_color } = colors;
	const details_width = k.width.details;
	const segmented_height = k.height.button;
	const color_left = details_width / 2 - 13;
	const segmented_width = details_width - 6;
	const separator_height = segmented_height + 9;
	const separator_width = details_width - 5 - separator_left * 2;
	const { w_t_details, w_t_countDots, w_show_countsAs, w_t_graph } = show;
	let color_wrapper: HTMLDivElement | null = null;
	let color_origin = Point.square(-3.5);
	let color = $w_separator_color;

	$: offset = show_dots ? 2 : 0;
	$: show_dots = $w_show_countsAs == T_Counts_Shown.dots;
	$: picker_offset = `${(details_width - picker_width) / 2 - color_origin.x - picker_internal_fudge}px`;

	$: heights = [
		10,
		back_up,			// 1. counts shown
		separator_height,
		...(show_dots ? [
			back_up,		// 3. show tiny dots for
			separator_height,
		] : []),
		back_up,			// background color
		5];

	$: tops = u.cumulativeSum(heights);
	$: selected_counts = [$w_show_countsAs];

	$: {
		const _ = `${$w_show_countsAs}:::${$w_t_graph}`;
		if (!!color_wrapper) {
			(async () => {
				await tick();
				update_color_origin();
			})();
		}
	}

	function handle_colors(color: string) {
		const lume = colors.luminance_ofColor(color);
		if (lume > 0.95) {
			color = 'lightgray';
		} else {
			color = color;
		}
		$w_separator_color = color;
	}

	function handle_count_dots(types: string[]) {
		$w_t_countDots = types as Array<T_Kinship>;
	}

	function handle_counts_shown(types: string[]) {
		if (types.length > 0) {
			$w_show_countsAs = types[0] as T_Counts_Shown;
		}
	}

	function update_color_origin() {
		if (color_wrapper) {
			const origin = Rect.createFromDOMRect(color_wrapper.getBoundingClientRect()).origin.multipliedEquallyBy(1 / $w_scale_factor);
			color_origin = origin.offsetByXY(-3, -4);
		}
	}

</script>

<div class='preferences-details'
	style='
		left:0px;
		color:black;
		width: 100%;
		top:{top}px;
		overflow: visible;
		position:{position};
		padding-bottom:{tops[tops.length - 1]}px;
		font-size:{k.font_size.info}px;'>
	<Separator name='counts-shown-separator'
		has_fillets={true}
		isHorizontal={true}
		position={position}
		length={details_width}
		margin={k.details_margin}
		origin={Point.y(tops[0])}
		title='show list sizes as'
		title_left={k.separator_title_left}
		thickness={k.thickness.separator.details}/>
	<Segmented name='counts-shown-options'
		left={106}
		allow_none={false}
		allow_multiple={false}
		width={segmented_width}
		height={segmented_height}
		origin={Point.y(tops[1])}
		handle_selection={handle_counts_shown}
		titles={[T_Counts_Shown.dots, T_Counts_Shown.numbers, T_Counts_Shown.hidden]}
		selected={selected_counts}/>
	{#if show_dots}
		<Separator name='tiny-dots-separator'
			has_fillets={true}
			isHorizontal={true}
			position={position}
			length={details_width}
			margin={k.details_margin}
			origin={Point.y(tops[2])}
			title='show tiny dots for'
			title_left={k.separator_title_left}
			thickness={k.thickness.separator.details}/>
		<Segmented name='tiny-dots-options'
			left={106}
			allow_none={true}
			allow_multiple={true}
			width={segmented_width}
			height={segmented_height}
		origin={Point.y(tops[3])}
		selected={$w_t_countDots}
			handle_selection={handle_count_dots}
			titles={[T_Kinship[T_Kinship.children], T_Kinship[T_Kinship.parents], T_Kinship[T_Kinship.related]]}/>
	{/if}
	{#key show_dots}
		<Separator name='background-color'
			has_fillets={true}
			position={position}
			isHorizontal={true}
			title='accent color'
			length={details_width}
			has_thin_divider={true}
			margin={k.details_margin}
			origin={Point.y(tops[2 + offset])}
			title_left={k.separator_title_left}
			thickness={k.thickness.separator.details}/>
	{/key}
	<div class= 'background-color-dot'
		bind:this={color_wrapper}
		style='
			width: 17px;
			height: 17px;
			top: {tops[3 + offset]}px;
			border-radius: 9px;
			left: {color_left}px;
			position: {position};
			border: 1px solid black;
			box-sizing: border-box;
			z-index: {T_Layer.details};
			background-color: {$w_separator_color}'>
		<Portal className='preferences-color-portal' id='preferences'>
			<Color
				color={color}
				origin={color_origin}
				color_closure={handle_colors}
				picker_offset={picker_offset}/>
		</Portal>
	</div>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Header.svelte
```svelte
<script lang='ts'>
	import { c, g, k, core, u, x, hits, debug, search, colors, elements } from '../../ts/common/Global_Imports';
	import { Ancestry, T_Detail, S_Widget } from '../../ts/common/Global_Imports';
	const { w_grabs, w_ancestry_forDetails } = x;
	const { w_index: w_found } = x.si_found;
	const { w_thing_color } = colors;
	const { w_s_hover } = hits;
    let reattachments = 0;
	let color = colors.default;
	let ancestry: Ancestry | null = null;
	let background_color = 'transparent';

	$: {
	const _ = `${$w_found}
		:::${$w_s_hover}
		:::${$w_thing_color}
		:::${u.descriptionBy_titles($w_grabs)}`;
		ancestry = $w_ancestry_forDetails;
		if (!!ancestry) {
			color = 'white';
			background_color = ancestry.thing?.color ?? 'transparent';
			reattachments += 1;
		}
	}

</script>

{#key reattachments}
	<div style='
		top:0px;
		height:20px;
		display:flex;
		color:{color};
		white-space:pre;
		position:relative;
		text-align:center;
		align-items:center;
		justify-content:center;
		width:{k.width.details}px;
		font-size:{k.font_size.common}px;
		background-color:{background_color};'>
		{ancestry?.thing?.title.clipWithEllipsisAt(30) ?? k.empty}
	</div>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Data.svelte
```svelte
<script lang='ts'>
	import { c, h, k, u, busy, show, colors, details, features, elements, databases } from '../../ts/common/Global_Imports';
	import { T_File_Extension, T_File_Operation, T_Storage_Need } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Hit_Target, T_Request, T_Preference } from '../../ts/common/Global_Imports';
	import { Point, S_Mouse, S_Element } from '../../ts/common/Global_Imports';
	import { T_Database } from '../../ts/database/DB_Common';
	import DB_Filesystem from '../../ts/database/DB_Filesystem';
	import Identifiable from '../../ts/runtime/Identifiable';
	import type { Dictionary } from '../../ts/types/Types';
    import Buttons_Row from '../mouse/Buttons_Row.svelte';
	import Text_Table from '../text/Text_Table.svelte';
	import Segmented from '../mouse/Segmented.svelte';
	import Separator from '../draw/Separator.svelte';
	import Button from '../mouse/Button.svelte';
	const { w_t_database, w_data_updated } = databases;
	const { w_show_other_databases, w_show_save_data_button } = show;
    const font_sizes = [k.font_size.instructions, k.font_size.banners];
	const ids_forDirection = [T_File_Operation.import, T_File_Operation.export];
	const ids_forOutputFormat = [T_File_Extension.csv, T_File_Extension.json, T_File_Extension.cancel];
	const s_save = elements.s_element_for(new Identifiable('save'), T_Hit_Target.button, 'save');
	const ids_forDatabase = [T_Database.test, T_Database.docs]
		.concat(DB_Filesystem.isSupported() ? [T_Database.filesystem, T_Database.firebase] : [T_Database.firebase]);
	const ids_forInputFormat = [T_File_Extension.csv, T_File_Extension.json, T_File_Extension.seriously, T_File_Extension.cancel];
	const s_selectFolder = elements.s_element_for(new Identifiable('select-folder'), T_Hit_Target.button, 'select-folder');
	let s_element_dict_byStorageType: Dictionary<S_Element> = {};
	let heights = [15, height_ofChoices(), 42, 28, 74, 26, 3];
	let storage_choice: string | null = null;
	let storage_details: Array<Object> = [];
	let width = k.width.details - 7;
	let reattachments = 0;
	let title = k.empty;

	setup_s_elements();
	$: tops = u.cumulativeSum(heights);
	s_save.set_forHovering('black', 'pointer');
	s_selectFolder.set_forHovering('black', 'pointer');
	$: isFilesystemDB = $w_t_database === T_Database.filesystem;
	function height_ofChoices() { return features.has_every_detail ? $w_show_other_databases ? 18 : -5 : -16; }

	$:{
		const _ = `${$w_data_updated}:::${$w_t_database}`;
		update_storage_details();
	}

	$: {
		const _ = `${details.t_storage_need}:::${$w_show_other_databases}`;
		reattachments++;
	}

	function ids_forFormat(): T_File_Extension[] {
		return (storage_choice == T_File_Operation.import) ? ids_forInputFormat : ids_forOutputFormat;
	}

	async function handle_db_selection(titles: string[]) {
		const t_database = titles[0] as T_Database; // only ever contains one title
		await databases.grand_change_database(t_database);
	}

	async function handle_save(s_mouse) {
		if (!!h && h.hasRoot && s_mouse.isUp) {
			await h.db.persist_all(true);
		}
	}

	async function handle_selectFolder(s_mouse) {
		if (s_mouse.isUp && h.db instanceof DB_Filesystem) {
			await h.db.selectFolder();
			databases.w_data_updated.set(Date.now());
		}
	}

	function handle_show_other_databases(event: Event) {
		show.toggle_show_other_databases();
		heights[1] = height_ofChoices();
		heights = [...heights];	// force a re-render
	}

	function action_titles() {
		switch (details.t_storage_need) {
			case T_Storage_Need.direction: return ['local file', ...ids_forDirection];
			case T_Storage_Need.format:    return ['file type', ...ids_forFormat()];
			case T_Storage_Need.busy:      return [`${storage_choice}ing...`];
		}
	}
	
	function setup_s_elements() {
		const ids = [...ids_forDirection, ...ids_forInputFormat];
		for (const id of ids) {
			const s_storage = elements.s_element_for(null, T_Hit_Target.database, id);
			s_storage.set_forHovering(colors.default, 'pointer');
			s_element_dict_byStorageType[id] = s_storage;
		}
	}

	function handle_actionRequest(t_request: T_Request, s_mouse: S_Mouse, column: number): any {
		const ids = (details.t_storage_need == T_Storage_Need.direction) ? ids_forDirection : ids_forFormat();
		switch (t_request) {
			case T_Request.handle_s_mouse: return handle_mouseUp_forColumn(s_mouse, column);
			case T_Request.name:        return ids[column];
			case T_Request.is_visible:  return true;
			default:                    return false;
		}
		return null;
	}

	function update_storage_details() {
		if (!!h) {
			$w_show_save_data_button = h.db.isPersistent && h.total_dirty_count != 0;
			storage_details = [h.db.details_forStorage,
			['depth', h.depth.supressZero()],
			['things', h.things.length.supressZero()],
			['relationships', h.relationships.length.supressZero()],
			['traits', h.traits.length.supressZero()],
			['tags', h.tags.length.supressZero()],
			['must save', h.total_dirty_count.supressZero()]];
		}
	}
	
	function handle_mouseUp_forColumn(s_mouse, column) {
		const beginning = details.t_storage_need == T_Storage_Need.direction;
		const ids = beginning ? ids_forDirection : ids_forFormat();
		if (s_mouse.isDown) {
			const choice = ids[column];
			details.t_storage_need = T_Storage_Need.direction; // reset by default
			if (beginning) {
				storage_choice = choice;
				details.t_storage_need = T_Storage_Need.format; // not reset
			} else if (choice != T_File_Extension.cancel) {
				const format = choice as T_File_Extension;
				switch (storage_choice) {
					case T_File_Operation.export: h.persist_toFile(format); break;
					case T_File_Operation.import: h.select_file_toUpload(format, s_mouse.event.shiftKey); break;
				}
			}
		}
	}

</script>

<div class='database-container'
	style='
		padding:5px;'>
	{#if features.has_every_detail}
		<Separator name='show-other-databases'
			isHorizontal={true}
			has_fillets={true}
			has_double_fillet={true}
			has_thin_divider={false}
			origin={new Point(1, 30)}
			zindex={T_Layer.frontmost + 1}
			length={k.width.details - 2.5}
			thickness={k.thickness.separator.details}
			handle_mouseUp={handle_show_other_databases}
			title='{$w_show_other_databases ? 'hide other databases' : 'show other databases'}'/>
		{#if $w_show_other_databases}
			<Segmented name='databases'
				left={105}
				width={width}
				titles={ids_forDatabase}
				selected={[$w_t_database]}
				height={k.height.controls}
				origin={new Point(0, tops[0])}
				handle_selection={handle_db_selection}/>
		{/if}
	{/if}
	<div class='database-information'
		style='
			width: 100%;
			top={tops[1]}
			position: relative;
			font-size:{k.font_size.banners}px;'>
		<Text_Table name='database-table'
			top={tops[1]}
			row_height={11}
			array={storage_details}
			font_size={k.font_size.banners}/>
		{#key $w_data_updated}
			{#if $w_show_save_data_button && !busy.isDatabaseBusy}
				<Button name='save'
					width=72
					s_button={s_save}
					handle_s_mouse={handle_save}
					zindex={T_Layer.frontmost}
					origin={new Point(120, tops[3])}>
					save to db
				</Button>
			{/if}
			{#if isFilesystemDB}
				<Button name='select-folder'
					width=85
					s_button={s_selectFolder}
					handle_s_mouse={handle_selectFolder}
					zindex={T_Layer.frontmost}
					origin={new Point(110, tops[3])}>
					select folder
				</Button>
			{/if}
		{/key}
	</div>
	{#key reattachments}
		<Buttons_Row
			gap={4}
			margin={20}
			row_name='data'
			width={width + 5}
			has_seperator={true}
			font_sizes={font_sizes}
			row_titles={action_titles()}
			closure={handle_actionRequest}
			button_height={k.height.button}
			center={new Point(width / 2 + 3, tops[4])}
			separator_thickness={k.thickness.separator.details}
			name={`data-${(details.t_storage_need == T_Storage_Need.direction) ? 'action' : 'format'}`}/>
	{/key}
	<Separator name='bottom-of-data'
		isHorizontal={true}
		length={k.width.details + 1.5}
		origin={new Point(-0.6, tops[5])}
		thickness={k.thickness.separator.main}
		corner_radius={k.radius.fillets.thick}/>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/details/D_Tags.svelte
```svelte
<script lang='ts'>
    import { k, x } from '../../ts/common/Global_Imports';
	const { w_item: w_tag } = x.si_thing_tags;
</script>

{#if !!$w_tag}
    <div class='tags-list'
        style='
            width: 100%;
            display: flex;
            padding: 4px 0;
            flex-wrap: wrap;
            text-align: center;
            align-items: center;
            white-space: pre-line;
            word-break: break-word;
            justify-content: center;
            min-height: {k.height.empty}px;
            font-size: {k.font_size.details}px;'>
        {$w_tag?.type}
    </div>
{:else}
    <div class='no-tags'
        style='
            width: 100%;
            display: flex;
            position: relative;
            text-align: center;
            align-items: center;
            justify-content: center;
            min-height: {k.height.empty}px;
            font-size: {k.font_size.details}px;'>
            no tags
    </div>
{/if}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Toggle.svelte
```svelte
<script lang='ts'>
	import { e, k, u, x, Point, search, elements } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Search, T_Control } from '../../ts/common/Global_Imports';
	import Close_Button from '../mouse/Close_Button.svelte';
	import Button from '../mouse/Button.svelte';
	export let width: number;
	export let left: number;
	export let top: number;
	const right_widths = [10, 10.5];
	const { w_t_search } = search;
	const size_big = k.height.dot * 1.4;
	const rights = u.cumulativeSum(right_widths).map((right, index) => width - right);

</script>

<div class='search-controls'
	style='
		top: {top}px;
		left: {left}px;
		position: absolute;
		z-index: {T_Layer.frontmost};'>
	{#if $w_t_search === T_Search.off}
		<Button
			width={size_big - 1}
			height={size_big - 1}
			border_thickness={0.1}
			name={T_Control.search}
			center={new Point(rights[0], 11)}
			s_button={elements.s_control_forType(T_Control.search)}
			handle_s_mouse={(s_mouse) => e.handle_s_mouseFor_t_control(s_mouse, T_Control.search)}>
			🔍
		</Button>
	{:else}
		<Close_Button
			name='end-search'
			align_left={true}
			size={size_big + 1}
			stroke_width={0.25}
			closure={() => search.deactivate()}
			origin={new Point(rights[1], 0.5)}/>
	{/if}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search_Results.svelte
```svelte
<script lang='ts'>
	import { k, u, x, Thing, colors, search, elements } from '../../ts/common/Global_Imports';
	const { w_index: results_index } = x.si_found;
	const { w_search_results_changed } = search;
	const { w_separator_color } = colors;
	let element: HTMLDivElement;
	let results: Array<Thing> = [];
	
	$: $w_search_results_changed, results = x.si_found.items;

	$: {
		const row = $results_index;
		let selected_row: HTMLElement | null = null;
		if (row !== null && !!element) {
			selected_row = element.children[row] as HTMLElement;
		}
		elements.element_set_focus_to(element);
		selected_row?.scrollIntoView({ block: 'nearest' });
	}

	function handle_row_selected(event: MouseEvent, index: number) {
		const prior_row = $results_index;
		if (prior_row !== null && prior_row === index) {
			search.deactivate_focus_and_grab();
		} else {
			search.selected_row = event.shiftKey ? null : index;
			u.consume_event(event);
		}
	}

	function highlightMatch(title: string) {
		if (!search.search_words || search.search_words.length === 0) return title;
		
		const escapedWords = search.search_words.map(word => 
			word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
		);
		const pattern = new RegExp(`(${escapedWords.join('|')})`, 'gi');
		
		return title.replace(pattern, (match) => 
			`<span style='background-color: ${$w_separator_color}'>${match}</span>`
		);
	}

</script>

<div class='search-results'
	tabindex='0'>
	<ul bind:this={element}>
		{#key `${$w_separator_color}:::${$results_index}:::${$w_search_results_changed}`}
			{#each results as result, index}
				<li class:selected={$results_index === index} style='color: {result.color}'
					on:mousedown={(event) => handle_row_selected(event, index)}>
					<span>{@html highlightMatch(result.title)}</span>				</li>
			{/each}
		{/key}
	</ul>
</div>

<style>
	.search-results {
		outline: none !important;
		position: absolute;
        z-index: 100;
		height: 100%;
		width: 100%;
	}
	ul {
		list-style: none;
		outline: none;
		width: 100%;
		padding: 0;
		margin: 0;
	}
	li {
		box-sizing: border-box;
		white-space: nowrap;
		padding: 0 12px;
		cursor: pointer;
		width: 100%;
	}
	li span {
		text-overflow: ellipsis;
		display: inline-block;
		overflow: hidden;
		max-width: 100%;
	}
	li.selected,
	li.selected:hover {
		background-color: lightblue;
	}
	li:hover {
		background-color: #eee;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/search/Search.svelte
```svelte
<script lang='ts'>
	import { T_Search, T_Layer, T_Hit_Target, T_Preference, T_Search_Preference } from '../../ts/common/Global_Imports';
	import { g, k, p, x, show, Point, search, elements, controls, features } from '../../ts/common/Global_Imports';
	import Segmented from '../mouse/Segmented.svelte';
	export let zindex = T_Layer.graph;
	export let top = 0;
	const { w_thing_fontFamily } = x;
	const { w_rect_ofGraphView } = g;
	const s_search = elements.s_element_for(null, T_Hit_Target.search, k.empty);
	const { w_t_search, w_t_search_preferences, w_search_results_found } = search;
	let input: HTMLInputElement;
	let filter_width = 80;

	$: if (!!input) {
		s_search.html_element = input;				// so s_element_set_focus_to will work
	}

	$: if ($w_t_search != T_Search.enter) {
		setTimeout(() => {
			elements.s_element_set_focus_to(s_search);	// so 'f' will not be added to the input
		}, 1);
	}

	function search_width() { return graph_width() - 74; }
	function graph_width() { return g.windowSize.width - 84; }

	function handle_input(event) {
		const text = input.value;
		if (!!text) {
			p.writeDB_key(T_Preference.search_text, text);
		}
		search.search_for(text.toLowerCase());
	}

</script>

<div class='search-preferences' style='
	top: {top}px;
	height: 25px;
	z-index: {zindex};
	position: absolute;
	width: {graph_width()}px;
	background-color: transparent;'>
	<div class='search-results-found'
		style='
			top: 3.8px;
			left: 6px;
			width: 60px;
			text-align: right;
			position: absolute;
			font-size: {k.font_size.banners}px;
			font-family: {$w_thing_fontFamily};'>
		{$w_search_results_found} match{$w_search_results_found == 1 ? '' : 'es'}
	</div>
	<input class='search-input'
		id='search'
		type='search'
		bind:this={input}
		autocomplete='off'
		on:input={handle_input}
		bind:value={search.search_text}
		placeholder={'enter ' + $w_t_search_preferences + ' text'}
		style='
			top: 1px;
			left: 70px;
			color: blue;
			padding-left: 6px;
			border-radius: 6px;
			position: absolute;
			background-color: white;
			border: 1px solid lightgray;
			height: {k.height.button + 2}px;
			font-size: {k.font_size.banners}px;
			font-family: {$w_thing_fontFamily};
			width: {search_width() - (search.search_text?.length > 0 ? 100 : 0)}px;'/>
	<Segmented name='search-filter'
		width={filter_width}
		height={ k.height.button}
		selected={[$w_t_search_preferences]}
		origin={new Point(graph_width() - filter_width + 80, 1)}
		titles={[T_Search_Preference.title, T_Search_Preference.trait]}
		handle_selection={(titles) => controls.handle_segmented_choices('search', titles)}/>
</div>

<style>
	.search-input::placeholder {
		color: lightblue;
	}
	.search-input:focus::placeholder {
		color: transparent;
	}
	.search-input:focus {
		outline: none;
		border: 1px dashed blue !important;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Close_Button.svelte
```svelte
<script lang='ts'>
	import { hits, colors, svgPaths, elements } from '../../ts/common/Global_Imports';
	import { Point, T_Layer, T_Hit_Target, S_Mouse } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
	import SVG_D3 from '../draw/SVG_D3.svelte';
	import { onMount } from 'svelte';
	export let align_left: boolean = false;
	export let stroke_width: number = 0.75;
    export let name = 'generic close';
	export let closure: () => void;
	export let origin: Point;
    export let size = 20;
	const { w_s_hover } = hits;
	let element: HTMLElement | null = null;
	
	// Create s_element reactively so it uses the actual name prop value
	$: s_element = elements.s_element_for(new Identifiable(name), T_Hit_Target.button, name);
	let stroke = colors.default;
	let fill = 'white';

	$: {
		const _ = $w_s_hover;
		const isHovering = $w_s_hover?.id === s_element.id;
		stroke = isHovering ? 'white' : colors.default;
		fill = isHovering ? 'gray' : 'white';
	}

	onMount(() => {
		return () => {
			s_element.handle_s_mouse = undefined;
			hits.delete_hit_target(s_element);
		};
	});

	// Update handler whenever element, closure, or s_element changes (handles re-renders and cached reuse)
	$: if (!!element && !!closure && !!s_element) {
		s_element.set_html_element(element);
		// Always set handler (s_element may be cached/reused from previous component instance)
		s_element.handle_s_mouse = (s_mouse: S_Mouse) => {
			if (s_mouse.isDown) closure();
			return true;
		};
	}

	$: style = `
		cursor: pointer;
		user-select: none;
		width: ${size}px;
		height: ${size}px;
		position: absolute;
		top: ${origin.y}px;
		z-index: ${T_Layer.dot};
		${align_left ? 'left' : 'right'}: ${origin.x}px;
	`.removeWhiteSpace();

</script>

<div class='close-button'
	bind:this={element}
	style={style}>
    <SVG_D3 name='close'
		fill={fill}
		width={size}
		height={size}
		stroke={colors.default}
		stroke_width={stroke_width}
		svgPath={svgPaths.circle_atOffset(size, size - 2)}
	/>
    <SVG_D3 name='closeInside'
		width={size}
		height={size}
		stroke={stroke}
		stroke_width={1}
		svgPath={svgPaths.x_cross(size, size / 6)}
	/>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Buttons_Row.svelte
```svelte
<script lang='ts'>
	import { T_Action, T_Request, T_Button_SVG, T_Hit_Target, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { k, Point, colors, elements, svgPaths } from '../../ts/common/Global_Imports';
	import { S_Mouse, S_Element } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
    import G_Repeater from '../../ts/geometry/G_Repeater';
	import Separator from '../draw/Separator.svelte';
	import Button from './Button.svelte';
	export let closure: (t_request: T_Request, s_mouse: S_Mouse, column: number) => boolean;
	export let mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
	export let separator_thickness = k.thickness.separator.main;
    export let t_target = T_Hit_Target.button;
	export let origin: Point | null = null;
	export let center: Point | null = null;
	export let font_sizes: Array<number>;
	export let has_fillets = true;
	export let has_seperator = false;
	export let row_titles: string[];	// first one is optional row title, rest are button titles
	export let row_name = k.empty;
	export let button_height = 13;
	export let align_left = true;
	export let has_title = true;	// true means first row_titles is the title of the row
	export let name = k.empty;
	export let title_gap = 8;
	export let width: number;
	export let svg_size = 16;
	export let margin = 0;
	export let gap = 1;
	const solo_title_width = 42;
	const front_margin = has_seperator ? 0 : solo_title_width;
	const button_titles = has_title ? row_titles.slice(1) : row_titles;
	const g_repeater = new G_Repeater(button_titles, button_height, width - front_margin, margin, gap, 8, title_gap, true, font_sizes[0]);
	const t_button_svg = ([T_Action[T_Action.browse], T_Action[T_Action.move]]).includes(row_name) ? T_Button_SVG.arrow : T_Button_SVG.none;
	const s_button_dict_byColumn: Record<number, S_Element> = {};
	const has_svg = t_button_svg !== T_Button_SVG.none;
	const button_portion = g_repeater.button_portion;
	const columns = button_titles.length;
	let style = k.empty;
	let reattachments = 0;
	let top = origin?.y ?? center?.y - button_height / 2;

	$: row_title = row_titles[0];

	//////////////////////////////////////////////////////////////
	//			 one row of buttons, plus options				//
	//															//
	//	has_title:		true means first one is row title		//
	//	has_seperator:	true means line through row title		//
	//															//
	//	row_titles		no buttons: if only one and has title	//
	//	font_sizes:		[title_font_size, button_font_size] 	//
	//	gap:			between buttons							//
	//	margin:			at start and end of row					//
	//															//
	//////////////////////////////////////////////////////////////

    update_es_buttons();

	function button_disabled_for(column: number): boolean { return closure(T_Request.is_disabled, null, column); }
	function button_inverted_for(column: number): boolean { return closure(T_Request.is_inverted, null, column); }
	function button_name_for(column: number): string { return closure(T_Request.name, null, column); }

	function update_es_buttons() {
		for (let column = 0; column < columns; column++) {
			let s_button = s_button_dict_byColumn[column];
			if (!s_button) {
				s_button = elements.s_element_for(new Identifiable(`${name}-table-${row_name}-${button_name_for(column)}`), t_target, column);
				s_button_dict_byColumn[column] = s_button;
			}
			s_button.set_forHovering(colors.default, 'pointer');
			s_button.isDisabled = button_disabled_for(column);
			s_button.isInverted = button_inverted_for(column);
		}
		if (!!origin || !!center) {
			const x = origin?.x ?? center?.x - width / 2;
			const y = origin?.y ?? center?.y - button_height / 2;
			const alignment = align_left ? 'left: ' : 'right: ';
			style = `${alignment}${x}px; top: ${y}px;`;
		}
		reattachments += 1;
	}

</script>

<div class='buttons-row'
	style='{style}
		left:1px;
		top:{top}px;
		position:absolute;
		height:{button_height}px;
		width:{width - (margin * 2)}px;'>
	{#if has_title}
		{#if has_seperator}
			<Separator name='buttons-row'
				length={width}
				title={row_title}
				isHorizontal={true}
				has_fillets={has_fillets}
				thickness={separator_thickness}
				title_font_size={font_sizes[0]}
				title_left={k.separator_title_left}/>
		{:else}
			<div class='actions-left-column'
				style='
					top: 1.5px;
					text-align: right;
					position:absolute;
					font-size:{font_sizes[0]}px;
					width:{solo_title_width - gap - 7}px;'>
				{row_title}
			</div>
		{/if}
	{/if}
	{#key reattachments}
		{#if button_titles.length > 0}
			<div class='buttons-array'
				style='
					position:absolute;
					top:{has_seperator ? 10 : 0}px;
					left:{margin - 8 + (has_seperator ? 0 : solo_title_width + 4)}px;'>
				{#each button_titles as title, column}
					<Button
						height={button_height}
						font_size={font_sizes[1]}
						mouse_detection={mouse_detection}
						s_button={s_button_dict_byColumn[column]}
						width={g_repeater.button_width_for(column)}
						origin={Point.x(g_repeater.button_left_for(column))}
						name={`${name}-row-${row_name}-${button_name_for(column)}`}
						handle_s_mouse={(s_mouse) => closure(T_Request.handle_s_mouse, s_mouse, column)}>
						{#if t_button_svg === T_Button_SVG.none}
							{title}
						{:else if t_button_svg === T_Button_SVG.triangle}
							<svg
								class='svg-triangle-path-for-{title}'>
								<path d={svgPaths.fat_polygon_path_for(title, svg_size)} fill='white'/>
							</svg>
						{:else if t_button_svg === T_Button_SVG.arrow}
							<svg
								fill='white'
								stroke='black'
								width={svg_size}
								height={svg_size}
								stroke-width='0.6'
								class='svg-arrow-path-for-{title}'
								viewBox='0 0 {svg_size} {svg_size}'>
								<path d={svgPaths.arrow_forTitle(svg_size, 3, title)}/>
							</svg>
						{/if}
					</Button>
				{/each}
			</div>
		{/if}
	{/key}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Next_Previous.svelte
```svelte
<script lang='ts'>
	import { Point, S_Mouse, S_Element, T_Request, T_Direction, T_Action, T_Hit_Target, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { e, k, hits, colors, elements, svgPaths } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
	import { onMount } from 'svelte';
	export let size = 24;
	export let name = k.empty;
	export let top_offset = -7.5;
	export let origin = Point.zero;
	export let custom_svgPaths: { up?: string, down?: string } | null = null;
	export let closure: (column: number, event?: MouseEvent | null, element?: HTMLElement | null, isFirstCall?: boolean) => any;
	const titles = [T_Direction.previous, T_Direction.next];
	const { w_s_hover, w_autorepeat } = hits;
	let html_elements: HTMLElement[] = [];	// transient bind object

	interface S_Button {
		// state for managing button's hover & autorepeat
		s_element: S_Element | null;
		event: MouseEvent | null;
		isFirstCall: boolean;
	}

	let s_buttons: S_Button[] = [
		{ s_element: null, event: null, isFirstCall: true },
		{ s_element: null, event: null, isFirstCall: true }
	];

	onMount(() => {
		titles.forEach((title, button_id) => {
			const s_element = elements.s_element_for(new Identifiable(`next-prev-${name}-${title}`), T_Hit_Target.button, title);
			s_buttons[button_id].s_element = s_element;
			if (html_elements[button_id]) {
				s_element.set_html_element(html_elements[button_id]);
			}
			s_element.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
				return handle_s_mouse(s_mouse, button_id);
			};
			s_element.mouse_detection = T_Mouse_Detection.autorepeat;
			s_buttons[button_id].isFirstCall = true;
			s_element.autorepeat_callback = () => {
				if (s_buttons[button_id].event) {
					const isFirst = s_buttons[button_id].isFirstCall;
					s_buttons[button_id].isFirstCall = false;
					closure(button_id, s_buttons[button_id].event, s_buttons[button_id].s_element?.html_element, isFirst);
				}
			};
			s_element.autorepeat_id = button_id;
		});
		return () => {
			s_buttons.forEach(b => {
				if (b.s_element) hits.delete_hit_target(b.s_element);
			});
		};
	});

	$: index_forHover = s_buttons.findIndex(b => b.s_element?.hasSameID_as($w_s_hover));
	$: isAutorepeating = (button_id: number) => s_buttons[button_id]?.s_element?.hasSameID_as($w_autorepeat) ?? false;

	function get_path_for(title: string, button_id: number): string {
		if (!custom_svgPaths) {
			return svgPaths.fat_polygon_path_for(String(title), size);
		} else {
			if (button_id === 0 && custom_svgPaths.up) {
				return custom_svgPaths.up + ' ' +
				svgPaths.fat_polygon_path_for('up', size);
			}
			if (button_id === 1 && custom_svgPaths.down) {
				return custom_svgPaths.down + ' ' +
				svgPaths.fat_polygon_path_for('down', size);
			}
		}
		return k.empty;
	}

	function is_using_custom_svgPaths(button_id: number): boolean {
		if (!custom_svgPaths) return false;
		return (button_id === 0 && !!custom_svgPaths.up) || (button_id === 1 && !!custom_svgPaths.down);
	}

	function get_svg_transform(button_id: number): string {
		const isCustom = is_using_custom_svgPaths(button_id);
		// Perfect centering for custom icons (+ and -)
		// Small vertical nudge (0.5px down) for triangles for better visual alignment
		return isCustom 
			? 'translate(-50%, -50%)' 
			: 'translate(-50%, calc(-50% + 0.5px))';
	}

	function get_stroke_color(button_id: number): string {
		// Use colors.default for triangular arrows (like Triangle_Button), colors.border for custom stroke-only icons
		return is_using_custom_svgPaths(button_id) ? colors.border : colors.default;
	}

	function handle_s_mouse(s_mouse: S_Mouse, button_id: number): boolean {
		if (s_mouse.isDown && s_mouse.event) {
			s_buttons[button_id].event = s_mouse.event;
			s_buttons[button_id].isFirstCall = true;
		} else if (s_mouse.isUp) {
			s_buttons[button_id].event = null;
			s_buttons[button_id].isFirstCall = true;
		}
		return true;
	}

</script>

<div class='{name}-next-previous'
	style='
		top: {top_offset}px;
		display:flex;
		position:absolute;
		left: {origin.x}px;
		flex-direction:row;
		align-items:center;'>
	{#each titles as title, button_id}
		<button class='{name}-{title}-button'
			bind:this={html_elements[button_id]}
			class:held={isAutorepeating(button_id)}
			style='
				padding: 0;
				border: none;
				display: flex;
				position:relative;
				align-items: center;
				width: {size - 5}px;
				height: {size + 5}px;
				justify-content: center;
				background-color: transparent;'>
			<svg class='svg-button-path'
				width={size}
				height={size}
				style='display: block; position: absolute; top: 50%; left: 50%; transform: {get_svg_transform(button_id)};'
				viewBox='0 0 {size} {size}'>
				<path
					d={get_path_for(title, button_id)}
					stroke={get_stroke_color(button_id)}
					stroke-width={is_using_custom_svgPaths(button_id) ? '1.5' : '0.75'}
					fill={is_using_custom_svgPaths(button_id) ? 'white' : (index_forHover === button_id ? colors.background_special_blend('black', k.opacity.medium) : 'white')}/>
			</svg>
		</button>
	{/each}
</div>

<style>
	button.held {
		transform: scale(0.95);
		transition: transform 0.1s ease;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Cluster_Pager.svelte
```svelte
<script lang='ts'>
	import { k, hits, elements, svgPaths, colors } from '../../ts/common/Global_Imports';
	import { Point, T_Hit_Target, S_Mouse } from '../../ts/common/Global_Imports';
	import { onMount } from 'svelte';
	export let handle_mouseUp: () => void = () => {};
	export let thumbTransform = k.empty;
	export let thumb_path_d = k.empty;
	export let size = k.height.dot;
	export let center = Point.zero;
	export let direction = k.empty;
	export let viewBox = k.empty;
	export let name = k.empty;
	export let color = 'red';
	const { w_s_hover } = hits;
	const { w_background_color } = colors;
	const s_pager = elements.s_element_forName_andType(name, T_Hit_Target.paging, direction);
	let pager: SVGGElement | null = null;
	let fill_color = 'transparent';

	s_pager.set_forHovering(color, 'pointer');

	onMount(() => {
		if (pager) {
			s_pager.set_html_element(pager);
		}
		// Set up click handler for centralized hit system
		s_pager.handle_s_mouse = handle_s_mouse;
		return () => {
			hits.delete_hit_target(s_pager);
		};
	});

	$: {
		const _ = `${$w_s_hover?.id ?? 'null'}:::${$w_background_color}`;
		update_colors();
	}

	function update_colors() {
		fill_color = s_pager.isHovering ? s_pager.hoverColor : 'transparent';
	}

	function handle_s_mouse(s_mouse: S_Mouse): boolean {
		if (s_mouse.isUp) {
			handle_mouseUp();
			return true;
		}
		return false;
	}

</script>

<g class='pager-group {name}'
	bind:this={pager}
	transform={thumbTransform}
	style='cursor: pointer; pointer-events: auto;'>
	<path class={name}
		stroke={color}
		fill={fill_color}
		pointer-events="all"
		d={svgPaths.fat_polygon(size, 0, true)}/>
</g>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Buttons_Table.svelte
```svelte
<script lang='ts'>
    import { T_Action, T_Request, T_Button_SVG, T_Hit_Target, T_Mouse_Detection } from '../../ts/common/Global_Imports';
    import { k, Point, S_Mouse } from '../../ts/common/Global_Imports';
    import Buttons_Row from './Buttons_Row.svelte';
    export let closure: (t_request: T_Request, s_mouse: S_Mouse, name: string, row: number, column: number) => boolean;
    export let mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
    export let t_target = T_Hit_Target.button;
    export let font_sizes: Array<number>;
    export let button_titles: string[][];
    export let has_seperator = false;         // false means row titles precede buttons
    export let button_height = 15;
    export let has_title = true;              // false means all titles are buttons, true means first one is row title
    export let row_offset = 0;
	export let name = k.empty;
    export let width: number;
    export let title_gap = 8;
    export let gap = 2;
    export let top = 0;
	const rows = button_titles.length;
    const box_top = (has_title && has_seperator) ? 12 : 0;
    
    function button_origin_for(row: number): Point { return Point.y(row * (button_height + gap + box_top)); }

</script>

<div class='buttons-table'
    style='
        left:1px;
        top:{top}px;
        width:{width}px;
        position:relative;
        height:{(rows * button_height) + ((rows - 1) * gap)}px;'>
    {#each button_titles as titles, row}
        {#if closure(T_Request.is_visible, S_Mouse.empty, name, row, -1)}
            <Buttons_Row
                gap={gap}
                name={name}
                width={width}
                t_target={t_target}
                row_titles={titles}
                has_title={has_title}
                title_gap={title_gap}
                font_sizes={font_sizes}
                has_seperator={has_seperator}
                button_height={button_height}
                origin={button_origin_for(row)}
                mouse_detection={mouse_detection}
                row_name={T_Action[row + row_offset]}
                closure={(t_request, s_mouse, column) => closure(t_request, s_mouse, name, row + row_offset, column)}/>
        {/if}
    {/each}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Segmented.svelte
```svelte
<script lang='ts'>
	import { k, Point, colors } from '../../ts/common/Global_Imports';
	const { w_separator_color } = colors;
	export let handle_selection: ((types: string[]) => void) | null = null;
	export let selected_hover_text_color: string = 'black';
	export let selected_color: string = $w_separator_color;
	export let hover_background_color: string = 'black';
	export let selected_text_color: string = 'white';
	export let border_color: string = colors.border;
	export let height: number = k.button_height;
	export let allow_multiple: boolean = false;
	export let hover_color: string = 'white';
	export let font_size = k.font_size.info;
	export let allow_none: boolean = false;
	export let origin: Point = Point.zero;
	export let name: string = k.empty;
	export let titles: string[] = [];
	export let selected: string[];
	export let width = 0;
	export let left = 38;

	function button_name(title: string) { return `segment-${name}-${title.replace(/\s+/g, '-').toLowerCase()}`; }

	$: {
		const _ = $w_separator_color;
		update_colors()
	}

	$: {
		const _ = selected;
		setSelected(selected);
	}

	function update_colors() {
		const inverted = colors.luminance_ofColor(selected_color) > 0.5;
		selected_hover_text_color = inverted ? 'white' : 'black';
		selected_text_color = inverted ? 'black' : 'white';
		selected_color = $w_separator_color;
		border_color = colors.border;
	}

	function select(title: string) {
		let selection = [...selected];
		const isSelected = selected.includes(title);
		if (!allow_multiple) {
			if (!isSelected) {
				selection = [title];
			} else if (allow_none) {
				selection = [];
			} else {
				const index = titles.indexOf(title).increment(true, titles.length);
				selection = [titles[index]];
			}
		} else if (isSelected) {
			selection = selected.filter(i => i !== title);
		} else {
			selection = [...selected, title];
		}
		handle_selection?.(selection);
	}

	function setSelected(turnTheseOn: string[]) {
		for (const title of [...titles]) {
			const element = document.getElementById(button_name(title));
			if (element) {
				const flag = turnTheseOn.includes(title);
				if (flag) {
					element.classList.add('selected');
				} else {
					element.classList.remove('selected');
				}
			}
		}
	}

</script>

<div class='segmented'
	style='
		position:absolute;
		left:{origin.x}px;
		width:{width}px;'>
	<div class='group-of-segments'
		style='
			--selected-hover-text-color: {selected_hover_text_color};
			--hover-background-color: {hover_background_color};
			--selected-text-color: {selected_text_color};
			--selected-color: {selected_color};
			--border-color: {border_color};
			--hover-color: {hover_color};
			height: {height}px;
			top: {origin.y}px;
			left: {left}px;'>
		{#each titles as title}
			<button class='segment'
				color={selected.includes(title) ? 'black' : 'white'}
				style='font-size:{font_size}px; user-select: none;'
				on:mousedown|preventDefault={() => select(title)}
				class:selected={selected.includes(title)}
				id={button_name(title)}
				type='button'>
				{title}
			</button>
		{/each}
	</div>
</div>

<style>

	.segment.selected:hover {
		color: var(--selected-hover-text-color);
	}

	.segment:not(:last-child) {
		border-right: 1px solid var(--border-color);
	}

	.segment.selected {
		background: var(--selected-color) !important;
		color: var(--selected-text-color);
	}

	.segment:hover {
		background: darkgray !important;
		color: var(--hover-color);
	}

	.group-of-segments {
		border: 1px solid var(--border-color);
		transform: translateX(-50%);
		background: transparent;
		border-radius: 999px;
		position: absolute;
		overflow: hidden;
		display: flex;
		left: 50%;
	}

	.segment {
		justify-content: center;
		padding-bottom: 2.2px;
		font-family: inherit;
		align-items: center;
		white-space: nowrap;
		position: relative;
		width: fit-content;
		padding-right: 8px;
		background: white;
		padding-left: 8px;
		max-width: none;
		cursor: pointer;
		outline: none;
		display: flex;
		min-width: 0;
		height: 100%;
		border: none;
		flex: none;
	}

</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glows_Banner.svelte
```svelte
<script lang='ts'>
	import { k, Rect, Size, Point, colors, details } from '../../ts/common/Global_Imports';
	import Glow_Button from '../mouse/Glow_Button.svelte';
	import G_Repeater from '../../ts/geometry/G_Repeater';
	import Separator from '../draw/Separator.svelte';
	export let toggle_hidden: (title: string) => void;
	export let font_size = k.font_size.details;
    export let isSelected: boolean = false;
    export let banner_id: string = k.empty;
	export let titles: string[];
	export let height: number;
	export let width: number;
	$: banner_title = titles[0];
	const { w_background_color } = colors;
	$: g_repeater = new G_Repeater(titles, height, width, 0, 0, 7, 0, false, font_size, true);
	let banner_color = colors.banner;

	//////////////////////////////////////////////////////////////////////////////////
	//																				//
	//	titles:	one for each buttons, separated by a vertical separator with wings	//
	//																				//
	//	g_repeater computes layout													//
	//	handle click separately for each title's button								//
	//  first button is the widest, at the left										//
	//																				//
	//////////////////////////////////////////////////////////////////////////////////

	$: {
		const _ = $w_background_color;
		banner_color = colors.banner;
	}

	function intercept_click(title: string) {
		if (title === banner_id || titles.length == 1) {		// banner_title and title are dynamic, banner_id is NOT
			toggle_hidden(banner_id);
		} else {
			details.select_next(banner_id, title);
		}
	}

</script>

<div class='glows-banner'
	style='
		display: flex;
		width: {width}px;
		position: relative;
		flex-direction: row;
		align-items: stretch;'>
	<Separator name='top-of-banner'
		origin={Point.zero}
		isHorizontal={true}
		has_thin_divider={true}
		corner_radius={k.radius.fillets.thin}
		thickness={k.thickness.separator.banners}/>
	{#each g_repeater.titles as title, index}
		<Glow_Button
			title={title}
			height={height}
			name={banner_title}
			banner_id={banner_id}
			font_size={font_size}
			handle_mouseUp={intercept_click}
			detects_autorepeat={title != banner_id}
			width={g_repeater.button_width_for(index)}/>
		{#if index > 0}
			<Separator name='between-buttons'
				length={height + 6}
				isHorizontal={false}
				has_thin_divider={true}
				thickness={k.thickness.separator.banners}
				corner_radius={k.radius.fillets.ultra_thin}
				origin={new Point(g_repeater.button_left_for(index), 1)}/>
		{/if}
	{/each}
	<Separator name='bottom-of-banner'
		isHorizontal={true}
		origin={Point.y(height)}
		corner_radius={k.radius.fillets.thin}
		thickness={k.thickness.separator.banners}/>
</div> ```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Breadcrumb_Button.svelte
```svelte
<script lang='ts'>
	import { g, h, k, u, x, core, hits, show, colors, search, elements } from '../../ts/common/Global_Imports';
	import { Point, T_Search, T_Banner, T_Hit_Target } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
	import Button from './Button.svelte';
	export let center = Point.zero;
	export let s_breadcrumb;
	export let left = 0;
	const { w_s_hover } = hits;
	const { w_depth_limit } = g;
	const borderStyle = '1px solid';
	const { w_thing_color, w_background_color } = colors;
	const { w_grabs, w_thing_fontFamily, w_ancestry_forDetails } = x;
	let thing = s_breadcrumb.ancestry.thing;
	let title = thing.breadcrumb_title ?? k.empty;
	let s_element = elements.s_element_for(s_breadcrumb.ancestry, T_Hit_Target.button, title);
	let colorStyles = s_breadcrumb.background;
	let name = `crumb: ${title ?? 'unknown'}`;
	let ancestry = s_breadcrumb.ancestry;
	let width = u.getWidthOf(title) + 15;
	let border = s_breadcrumb.border;
	let color = s_breadcrumb.color;
	let reattachments = 0;
	let style = k.empty;

	center = new Point(left + width / 2, 14);
	updateColors();

	$: {
		const _ = `${$w_background_color}:::${$w_s_hover?.id ?? 'null'}`;
		updateColors();
	}

	$: {
		if (!!thing && thing.id == $w_thing_color?.split(k.separator.generic)[0]) {
			updateColors();
		}
	}

	$: {
		// Check if this ancestry is in the grabbed items array
		const isGrabbed = $w_grabs.some(g => g && g.equals(ancestry));
		const _ = `${$w_grabs.length}:::${isGrabbed}`;
		updateColors();
	}
	
	function updateColors() {
		if (!!thing &&!!s_element) {
			colorStyles = s_breadcrumb.background;
			color = s_breadcrumb.stroke;
			border = s_element.border;
			updateStyle();
		}
		reattachments += 1;
	}

	function updateStyle() {
		style=`
			${colorStyles};
			cursor:pointer;
			color:${color};
			white-space:pre;
			border:${border};
			border-radius: 1em;
			padding:1px 6px 1px 6px;
			font: ${k.font_size.common}px ${$w_thing_fontFamily};
		`.removeWhiteSpace();
	}

	function adjust_focus() {
		ancestry.grabOnly();
		if (ancestry.becomeFocus() && $w_ancestry_forDetails.hidden_by_depth_limit) {
			// adjust level to make selection visible
			$w_depth_limit = $w_ancestry_forDetails.depth_within_focus_subtree;
		}
	}

	function handle_s_mouse(s_mouse) {
		if (!!h && h.hasRoot && s_mouse.isDown) {
			const event = s_mouse.event;
			search.deactivate();
			if (event.metaKey || ancestry.depth_within_focus_subtree < 0) {
				adjust_focus();
			} else if (event.shiftKey) {
				ancestry.toggleGrab();
			} else {
				ancestry.grabOnly();
			}
		}
	}

</script>

{#key reattachments + $w_background_color}
	<Button
		name={name}
		style={style}
		width={width}
		center={center}
		position='absolute'
		s_button={s_element}
		handle_s_mouse={handle_s_mouse}>
		{title}
	</Button>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Button.svelte
```svelte
<script lang='ts'>
	import { e, g, k, x, hits, Point, colors } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { S_Mouse, S_Element } from '../../ts/common/Global_Imports';
	import { onMount } from 'svelte';
	export let mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
	export let handle_s_mouse: (s_mouse: S_Mouse) => boolean;
	export let s_button: S_Element = S_Element.empty();
	export let center: Point | null | undefined = null;
	export let font_size = k.font_size.common;
	export let border_color = colors.border;
	export let origin: Point | null = null;
	export let padding = '0px 6px 1px 6px';
	export let height = k.height.button;
	export let width = k.height.button;
	export let border_thickness = 0.5;
	export let color = colors.default;
	export let position = 'absolute';
	export let zindex = T_Layer.dot;
	export let align_left = true;
	export let style = k.empty;
	export let name = k.empty;
	const { w_control_key_down } = e;
	const { w_thing_fontFamily } = x;
	const { w_background_color } = colors;
	const { w_s_hover, w_autorepeat } = hits;
	const { w_rect_ofGraphView, w_user_graph_offset } = g;
	let wrapper_style = k.empty;
	let button_style = style;
	let element: HTMLElement;
	let border = k.empty;

	//////////////////////////////////////////
	//										//
	//	adds: border_thickness & style		//
	//										//
	//	container owns S_Element:			//
	//	  (stroke, fill & cursor)			//
	//	  calls intercept_handle_s_mouse	//
	//	  to update them					//
	//										//
	//////////////////////////////////////////

	onMount(() => {
		recompute_style();
		// Set handler on mount as fallback (element might be available immediately)
		if (!!element && !!s_button && handle_s_mouse) {
			s_button.set_html_element(element);
			const current_handle = handle_s_mouse;
			s_button.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
				if (s_mouse.isDown && !!s_mouse.event) {
					if (s_button.detects_autorepeat) {
						s_button.autorepeat_event = s_mouse.event;
						s_button.autorepeat_isFirstCall = true;
					} else if (!s_button.detects_longClick && !s_button.detects_doubleClick) {
						current_handle(s_mouse);
						recompute_style();
					}
					return true;
				} else if (s_mouse.isUp && !!s_mouse.event) {
					reset();
					current_handle(s_mouse);
					recompute_style();
					return true;
				}
				return false;
			};
		}
		return () => {
			hits.delete_hit_target(s_button);
		};
	});

	// important for components with {#key} blocks
	// Set element and handler together to ensure both are set
	// Create handler inline to capture current handle_s_mouse prop value
	// Reference handle_s_mouse to ensure Svelte tracks it for reactive updates
	$: if (!!element && !!s_button) {
		s_button.set_html_element(element);
		// Create new handler function that captures current handle_s_mouse
		// This ensures handler updates when handle_s_mouse prop changes (e.g., inline arrow functions)
		const current_handle = handle_s_mouse;
		if (current_handle) {
			s_button.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
				if (s_mouse.isDown && !!s_mouse.event) {
					if (s_button.detects_autorepeat) {
						s_button.autorepeat_event = s_mouse.event;
						s_button.autorepeat_isFirstCall = true;
					} else if (!s_button.detects_longClick && !s_button.detects_doubleClick) {
						current_handle(s_mouse);
						recompute_style();
					}
					return true;
				} else if (s_mouse.isUp && !!s_mouse.event) {
					reset();
					current_handle(s_mouse);
					recompute_style();
					return true;
				}
				return false;
			};
		} else {
			s_button.handle_s_mouse = undefined;
		}
	}

	// in case mouse_detection changes
	$: if (!!s_button && !!element) {
		s_button.mouse_detection = mouse_detection;
		if (s_button.detects_autorepeat && !s_button.autorepeat_callback) {
		s_button.autorepeat_callback = () => {
				if (!s_button.autorepeat_event) return;
			// First call is the initial down, subsequent calls are repeats
				const s_mouse_event = s_button.autorepeat_isFirstCall 
					? S_Mouse.down(s_button.autorepeat_event, s_button.html_element!)
					: S_Mouse.repeat(s_button.autorepeat_event, s_button.html_element!);
				s_button.autorepeat_isFirstCall = false; // Next call will be a repeat
			handle_s_mouse(s_mouse_event);
			recompute_style();
		};
		s_button.autorepeat_id = 0;
		} else if (!s_button.detects_autorepeat) {
		s_button.autorepeat_callback = undefined;
		}
		if (s_button.detects_longClick) {
			s_button.longClick_callback = (s_mouse: S_Mouse) => {
				handle_s_mouse(s_mouse);
				recompute_style();
			};
		} else {
			s_button.longClick_callback = undefined;
		}
	}

	recompute_style();

	$: {
		const _ = `${$w_user_graph_offset.description}
			:::${$w_rect_ofGraphView.description}
			:::${$w_s_hover?.id ?? 'null'}
			:::${$w_background_color}
			:::${$w_control_key_down}
			:::${s_button.isDisabled}
			:::${s_button.isInverted}
			:::${s_button.isGrabbed}
			:::${s_button.isEditing}
			:::${s_button.fill}`;
		recompute_style();
	}

	function reset() {
		s_button.autorepeat_event = undefined;
		s_button.autorepeat_isFirstCall = true;
	}

	function intercept_handle_s_mouse(s_mouse: S_Mouse): boolean {
		if (!handle_s_mouse) {
			return false;
		}
		if (s_mouse.isDown && !!s_mouse.event) {
			if (s_button.detects_autorepeat) {
				// Capture the event on s_button (survives component recreation)
				s_button.autorepeat_event = s_mouse.event;
				s_button.autorepeat_isFirstCall = true;
			} else if (!s_button.detects_longClick && !s_button.detects_doubleClick) {
				// Normal button — fire immediately on down
					handle_s_mouse(s_mouse);
					recompute_style();
				}
			// Long-click and double-click timing handled centrally by Hits.ts
			return true;
		} else if (s_mouse.isUp && !!s_mouse.event) {
			reset();
			handle_s_mouse(s_mouse);
			recompute_style();
			return true;
		}
		return false;
	}
	
	function recompute_style() {
		color = s_button.stroke;
		if (wrapper_style.length == 0) {
			wrapper_style = `
				cursor: pointer;
				user-select: none;
				width: ${width}px;
				z-index: ${zindex};
				height: ${height}px;
				position: ${position};
				font-family: ${$w_thing_fontFamily};
			`.removeWhiteSpace();
			if (!origin && !center) {
				wrapper_style = `${wrapper_style} top: 0px; left: 0px;`;
			} else {
				const x = origin?.x ?? center?.x - width / 2;
				const y = origin?.y ?? center?.y - height / 2;
				const alignment = align_left ? 'left: ' : 'right: ';
				wrapper_style = `${wrapper_style} ${alignment}${x}px; top: ${y}px;`;
			}
		}
		if (style.length == 0) {
			border_color = colors.border;
			const border_attributes = border_thickness == 0 ? 'none' : `${border_thickness}px solid ${border_color}`;
			border = `border:${border_attributes}`;
			button_style=`
				top:0px;
				left:0px;
				${border};
				display: flex;
				color:${color};
				width:${width}px;
				z-index:${zindex};
				user-select: none;
				padding:${padding};
				height:${height}px;
				text-align: center;
				align-items: center;
				position:${position};
				justify-content: center;
				font-size:${font_size}px;
				cursor:${s_button.cursor};
				border-radius:${height / 2}px;
				background-color:${s_button.fill};
				font-family:${$w_thing_fontFamily};
			`.removeWhiteSpace();
		}
	}

</script>

{#key $w_background_color, button_style}
	<div class='button-wrapper'
		style={wrapper_style}
		bind:this={element}
		name={name}>
		<button class='button'
			style={button_style}
			name={'button-for-' + name}>
			<slot/>
		</button>
	</div>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Color.svelte
```svelte
<script lang='ts'>
	import { e, k, u, x, hits, Point, Thing, T_Layer, colors, signals, elements } from '../../ts/common/Global_Imports';
	import ColorPicker from 'svelte-awesome-color-picker';
	import { get } from 'svelte/store';
	import { onMount } from 'svelte';
	export let origin = Point.zero;
	export let picker_offset = k.empty;
	export let zindex = T_Layer.frontmost;
	export let color = colors.default_forThings;
	export let color_closure = (color: string) => {};
	const selectorSize = k.height.dot + 1;
	const pickerSize = 122;
	const { w_color_picker_isOpen } = colors;
	const isFirefox = typeof navigator !== 'undefined' && navigator.userAgent.toLowerCase().includes('firefox');
	let borderColor = colors.separator;
	let isOpen = false;

	$: $w_color_picker_isOpen = isOpen;

	async function handle_color_change(event) {
		u.consume_event(event);
		const new_color = event.detail.hex;
		if (color != new_color) {
			color_closure(new_color)
			borderColor = colors.separator;
			color = new_color;
		}
	}

</script>

<div class='color'
	style='
		z-index: {zindex};
		top: {origin.y + (isFirefox ? 1 : 0)}px;
		left: {origin.x}px;
		position: absolute;
		--picker_offset: {picker_offset};'>
	<ColorPicker
		label=''
		bind:isOpen
		on:input={handle_color_change}
		hex={colors.color_toHex(color)}
		--picker-indicator-size='{selectorSize}px'
		--slider-width='{selectorSize}px'
		--picker-height='{pickerSize}px'
		--cp-border-color={borderColor}
		--picker-width='{pickerSize}px'
		--input-size='{selectorSize}px'
		--picker-z-index='{zindex}'/>
</div>

<style>
	div :global([role='dialog']) {
		left: var(--picker_offset) !important;
		top: 24px;
	}

	div :global(.picker-indicator) {
		border-radius: 50%;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Triangle_Button.svelte
```svelte
<script lang='ts'>
	import { k, x, hits, elements, svgPaths, T_Mouse_Detection } from '../../ts/common/Global_Imports';
	import { S_Mouse, T_Hit_Target } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
	import SVG_D3 from '../draw/SVG_D3.svelte';
	import Button from './Button.svelte';
	export let mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
	export let handle_s_mouse: (result: S_Mouse) => boolean;
	export let hover_closure: (flag: boolean) => boolean;
	export let extraPath = null;
	export let name = k.empty;
	export let strokeColor;
	export let center;
	export let angle;
	export let size;
	const w_grabs = x.w_grabs;
	const { w_s_hover } = hits;
	const s_triangle = elements.s_element_for(new Identifiable(name), T_Hit_Target.button, name);
	let trianglePath = svgPaths.fat_polygon(size, angle);
	s_triangle.color_background = 'transparent';
	s_triangle.hoverColor = 'transparent';
	let trianglePathElement: SVGPathElement | null = null;
	let extraColor = 'white';
	let fillColor = 'white';

	$: if (trianglePathElement) {
		s_triangle.contains_point = (point) => svgPaths.isPointInPath(point, trianglePathElement);
	}

	$: $w_grabs, setFillColor(false);
	
	$: {
		trianglePath = svgPaths.fat_polygon(size, angle);
		setFillColor(false);
	}

	$: {
		const isHovering = $w_s_hover?.id === s_triangle.id;
		setFillColor(isHovering);
	}

	function setFillColor(isFilled) {
		if (!!hover_closure) {
			[fillColor, extraColor] = hover_closure(isFilled);
		}
	}

</script>

<Button
	mouse_detection={mouse_detection}
	handle_s_mouse={handle_s_mouse}
	s_button={s_triangle}
	border_thickness=0
	center={center}
	height={size}
	width={size}
	name={name}>
	<SVG_D3 name='triangle'
		bind:pathElement={trianglePathElement}
		svgPath={trianglePath}
		stroke={strokeColor}
		fill={fillColor}
		height={size}
		width={size}
	/>
	{#if extraPath}
		<SVG_D3 name='triangleInside'
			svgPath={extraPath}
			stroke={extraColor}
			fill={extraColor}
			height={size}
			width={size}
		/>
	{/if}
	<slot/>
</Button>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Glow_Button.svelte
```svelte
<script lang='ts'>
    import { c, k, u, hits, show, colors, svgPaths, elements, T_Mouse_Detection } from '../../ts/common/Global_Imports';
    import { Rect, Size, Point, T_Layer, S_Mouse, T_Hit_Target } from '../../ts/common/Global_Imports';
    import Identifiable from '../../ts/runtime/Identifiable';
    import SVG_Gradient from '../draw/SVG_Gradient.svelte';
    import { onMount } from 'svelte';
    export let handle_mouseUp: (title: string) => boolean;
    export let font_size: number = k.font_size.banners;
    export let detects_autorepeat: boolean = false;
    export let banner_id: string = k.empty;
    export let title = k.empty;
    export let name = k.empty;
    export let height: number;
    export let width: number;
    const gradient_name = 'glowing';
	const { w_background_color } = colors;
    const { w_s_hover, w_autorepeat } = hits;
    const icon_path = svgPaths.fat_polygon_path_for(title);
    const glow_rect = Rect.createWHRect(width, height);
    const click_title = !!icon_path ? title : banner_id;
    const s_element = elements.s_element_for(new Identifiable(`glow-${banner_id}-${title}`), T_Hit_Target.glow, click_title);
    let glow_button: HTMLElement | null = null;
    let banner_color = colors.banner;

    onMount(() => {
        return () => {
            hits.delete_hit_target(s_element);
        };
    });

    $: isHovering = s_element.hasSameID_as($w_s_hover);
    $: isAutorepeating = detects_autorepeat && s_element.hasSameID_as($w_autorepeat);

	$: {
		const _ = $w_background_color;
		banner_color = colors.banner;
	}

    // Set up handle_s_mouse and autorepeat reactively to capture current handle_mouseUp
    $: if (!!s_element && !!glow_button) {
        s_element.set_html_element(glow_button);
        // Capture current values to avoid stale closures
        const current_handle_mouseUp = handle_mouseUp;
        const current_click_title = click_title;
        
        if (detects_autorepeat) {
            // For autorepeat buttons: only set up autorepeat callback
            // The callback fires immediately on mouse down (handled by Hits.ts)
            s_element.mouse_detection = T_Mouse_Detection.autorepeat;
            s_element.autorepeat_callback = () => current_handle_mouseUp(current_click_title);
            s_element.autorepeat_id = 0;
            // handle_s_mouse just returns true (autorepeat handles the click)
            s_element.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
                return true;
            };
        } else {
            // For non-autorepeat buttons: handle click directly
            s_element.mouse_detection = 0;
            s_element.autorepeat_callback = undefined;
            s_element.handle_s_mouse = (s_mouse: S_Mouse): boolean => {
                if (s_mouse.isDown) {
                    current_handle_mouseUp(current_click_title);
                }
                return true;
            };
        }
    }
    
</script>

<div class='glow-button'
    bind:this={glow_button}
	class:autorepeating={isAutorepeating}
	style='
        width: {width}px;
        height: {height}px;
        position: relative;'>
    {#if !isHovering}
        <div class='glow-button-background' class:autorepeating={isAutorepeating}>
            <SVG_Gradient
                isInverted={true}
                name={gradient_name}
                color={banner_color}
                size={glow_rect.size}
                path={svgPaths.rectangle(glow_rect)}/>
        </div>
    {/if}
    <div class='glow-button-title'
        style='
            top: 50%;
            left: 50%;
            margin: 0;
            padding: 0;
            width: 100%;
            user-select: none;
            text-align: center;
            position: absolute;
            -ms-user-select: none;
            -moz-user-select: none;
            font-size: {font_size}px;
            -webkit-user-select: none;
            background-color: transparent;
            transform: translate(-50%, -50%);'>
        {#if !!icon_path}
            <svg
                viewBox='-2.2 -3.2 20 20'
                class='svg-glow-button-path'>
                <path d={icon_path} stroke={colors.border} fill={isHovering ? 'black' : 'white'} stroke-width='0.75'/>
            </svg>
        {:else}
            {title}
        {/if}
    </div>
</div>

<style>
    .glow-button-background {
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        position: absolute;
    }
    .glow-button-background.autorepeating {
        transform: scale(0.95);
        transition: transform 0.1s ease;
    }
</style> ```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Slider.svelte
```svelte
<script lang='ts'>
	import { e, g, hits, Point, elements, T_Hit_Target, colors } from '../../ts/common/Global_Imports';
	import Identifiable from '../../ts/runtime/Identifiable';
	import { get } from 'svelte/store';
	import { onMount } from 'svelte';
	export let handle_value_change: (value: number) => void = () => {};
	export let thumb_color: string = '#007aff';
	export let isLogarithmic: boolean = false;
	export let title_font_size: number = 18;
	export let show_value: boolean = true;
	export let origin: Point = Point.zero;
	export let isVisible: boolean = true;
	export let divisions: number = 100;
	export let name: string = 'slider';
	export let height: number = 22;
	export let width: number = 200;
	export let value: number = 1;
	export let max: number = 20;
	const { w_s_hover } = hits;
	const { w_mouse_button_down } = e;
	const border = '1px solid darkgray';
	const { w_background_color } = colors;
	const x = isLogarithmic ? Math.log10(max) / divisions : max / divisions;
	const s_element = elements.s_element_for(new Identifiable(name), T_Hit_Target.control, 'slider');
	let slider_value = value <= 1 ? 0 : (isLogarithmic ? Math.log10(value) / x : value / x);
	let slider_input: HTMLInputElement | null = null;
	let current_thumb_color = thumb_color;
	let prior_value = value;
	let is_dragging_this_slider = false;
	
	onMount(() => {
		if (slider_input) {
			s_element.set_html_element(slider_input);
			s_element.contains_point = thumb_contains_point;
			s_element.handle_s_mouse = (s_mouse) => {
				if (s_mouse.isDown) {
					is_dragging_this_slider = true;
				} else if (s_mouse.isUp) {
					is_dragging_this_slider = false;
				}
				return false;
			};
		}
		return () => {
			hits.delete_hit_target(s_element);
		};
	});

	$: slider_value, compute_andPush();
	
	$: if (slider_input && s_element.contains_point) {
		s_element.contains_point = thumb_contains_point;
	}
	
	$: {
		const _ = `${$w_s_hover?.id}:::${is_dragging_this_slider}`;
		const isHovering = s_element.isHovering;
		if (isHovering || is_dragging_this_slider) {
			current_thumb_color = colors.background_special_blend('gray', 0.5) ?? thumb_color;
		} else {
			current_thumb_color = thumb_color;
		}
	}

	function compute_andPush() {
		const new_value = isLogarithmic ? Math.round(Math.pow(10, slider_value * x)) : Math.round(slider_value * x);
		if (new_value !== prior_value) {
			prior_value = value = new_value;
			handle_value_change(value);
		}
	}
	
	function thumb_contains_point(point: Point | null): boolean {
		const rect = g.scaled_rect_forElement(slider_input);
		if (!rect || !point || !slider_input) return false;
		const thumb_x = rect.origin.x + (slider_value / divisions) * rect.size.width;
		const thumb_radius = height / (2 * get(g.w_scale_factor));
		const thumb_y = rect.origin.y + rect.size.height / 2;
		const dx = point.x - thumb_x;
		const dy = point.y - thumb_y;
		return Math.sqrt(dx * dx + dy * dy) <= thumb_radius;
	}
	
</script>

<div class='slider'
	style='
		top: {origin.y}px;
		left: {origin.x}px;
		height: {height}px;
		position: relative;'>
	<div class='slider-border' style='
		width: {width}px;
		position: relative;
		--border: {border};
		align-items: center;
		--height: {height}px;
		--thumb-color: {current_thumb_color};
		display: {isVisible ? 'flex' : 'none'};'>
		<input class='slider-input'
			min='0'
			step='1'
			type='range'
			max={divisions}
			bind:this={slider_input}
			bind:value={slider_value}
			style='flex: 1 1 auto; position: relative; min-width: 0; pointer-events: auto;'/>
		{#if show_value}
			<span style='font-size: {title_font_size}px; margin-left: -26px; display: inline-block; width: 3.5em; text-align: right;'>
				{value}
			</span>
		{/if}
	</div>
</div>

<style>
	input[type='range'] {
		appearance: none;
		height: var(--height);
		background: transparent;
		-webkit-appearance: none;
	}
	input[type='range']::-webkit-slider-runnable-track {
		background: white;
		border-radius: 16px;
		height: var(--height);
		border: var(--border);
	}
	input[type='range']::-webkit-slider-thumb {
		border-radius: 50%;
		margin-top: -1.1px;
		width: var(--height);
		height: var(--height);
		border: var(--border);
		-webkit-appearance: none;
		background: var(--thumb-color);
	}
	input[type='range']::-moz-range-thumb {
		border-radius: 50%;
		width: var(--height);
		height: var(--height);
		border: var(--border);
		background: var(--thumb-color);
	}
	input[type='range']::-moz-range-track {
		background: white;
		border-radius: 16px;
		height: var(--height);
		border: var(--border);
	}
	input[type='range']::-ms-fill-lower,
	input[type='range']::-ms-fill-upper {
		background: white;
		border-radius: 16px;
		border: var(--border);
	}
	input[type='range']::-ms-thumb {
		border-radius: 50%;
		width: var(--height);
		height: var(--height);
		border: var(--border);
		background: var(--thumb-color);
	}
	input[type='range']:focus {
		outline: none;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Rubberband.svelte
```svelte
<script lang='ts'>
    import { e, g, k, u, x, h, hits, debug, colors, elements, features, S_Items } from '../../ts/common/Global_Imports';
    import { T_Layer, T_Drag, T_Hit_Target, S_Mouse } from '../../ts/common/Global_Imports';
    import { Rect, Size, Point, Ancestry } from '../../ts/common/Global_Imports';
    import { s_rubberband } from '../../ts/state/S_Rubberband';
    import Identifiable from '../../ts/runtime/Identifiable';
    import { get } from 'svelte/store';
    import { onMount } from 'svelte';
    export let strokeWidth = k.thickness.rubberband;
    export let bounds: Rect;
    const { w_dragging } = hits;
    const { w_user_graph_offset } = g;
    const { w_separator_color } = colors;
    const { w_s_title_edit } = x;
    const { w_count_mouse_up, w_mouse_location, w_scaled_movement } = e;
    const s_element = elements.s_element_for(new Identifiable('rubberband'), T_Hit_Target.rubberband, 'graph');
    let rubberband_hit_area: HTMLElement;
    let mouse_upCount = $w_count_mouse_up;

    onMount(() => {
        if (rubberband_hit_area) {
            s_element.set_html_element(rubberband_hit_area);
        }
        s_element.handle_s_mouse = handle_s_mouse;

        document.addEventListener('pointerenter', blockEvent, true);
        document.addEventListener('pointerleave', blockEvent, true);
        document.addEventListener('pointermove', blockEvent, true);
        document.addEventListener('pointerdown', blockEvent, true);
        document.addEventListener('pointerup', blockEvent, true);
        return () => {
            hits.delete_hit_target(s_element);
            document.removeEventListener('pointerenter', blockEvent, true);
            document.removeEventListener('pointerleave', blockEvent, true);
            document.removeEventListener('pointermove', blockEvent, true);
            document.removeEventListener('pointerdown', blockEvent, true);
            document.removeEventListener('pointerup', blockEvent, true);
        };
    });

    $: if ($w_dragging === T_Drag.rubberband) {
        document.body.classList.add('rubberband-blocking');
    } else {
        document.body.classList.remove('rubberband-blocking');
    }

    $: if ($w_dragging === T_Drag.graph) {
        const delta = $w_scaled_movement;
        const userOffset = $w_user_graph_offset;
        if (!!userOffset && !!delta && delta.magnitude > 1) {
            debug.log_action(` command drag GRAPH`);
            g.set_user_graph_offsetTo(userOffset.offsetBy(delta));
        }
    }

    $: rect = s_rubberband.rect;

    $: style = `
        position: fixed;
        top: ${rect.y}px;
        left: ${rect.x}px;
        border-style: dashed;
        pointer-events: none;
        box-sizing: border-box;
        width: ${rect.width}px;
        height: ${rect.height}px;
        z-index: ${T_Layer.rubberband};
        border-width: ${strokeWidth}px;
        border-color: ${$w_separator_color};
        background-color: rgba(0, 0, 0, 0.05);
        display: ${$w_dragging === T_Drag.rubberband ? 'block' : 'none'};`
    ;

    $: if ($w_dragging === T_Drag.rubberband && $w_mouse_location) {
        if (s_rubberband.update($w_mouse_location, bounds)) {
            rect = s_rubberband.rect;
            detect_and_grab();
        }
    }

    $: if ($w_count_mouse_up !== mouse_upCount) {
        mouse_upCount = $w_count_mouse_up;
        if ($w_dragging === T_Drag.graph) {
            s_rubberband.startPoint = null;
            $w_dragging = T_Drag.none;
        } else if ($w_dragging === T_Drag.rubberband) {
            const rubberbandGrabs = get(x.w_rubberband_grabs);
            if (rubberbandGrabs.length > 0) {
                const focus = get(x.w_ancestry_focus) ?? h?.rootAncestry;
                if (focus) {
                    const si_grabs = new S_Items<Ancestry>(rubberbandGrabs);
                    si_grabs.index = rubberbandGrabs.length - 1;
                    const snapshot = { focus, si_grabs, depth: get(g.w_depth_limit) };
                    x.si_recents.push(snapshot);
                }
            } else {
                x.grab_none();
            }
            x.setGrabs_forRubberband([]);
            s_rubberband.stop();
            rect = s_rubberband.rect;
        }
    }

    function ancestries_intersecting_rubberband(): Array<Ancestry> {
        const rbush = s_rubberband.rbush;
        if (!rbush) return [];
        return rbush.search(s_rubberband.rect.asBBox)
            .map(b => b.target.ancestry)
            .filter(a => !!a);
    }

    function blockEvent(e: Event) {
        const target = e.target;
        if ($w_dragging === T_Drag.rubberband && target instanceof HTMLElement) {
            if (!target.closest('.panel') && 
                !target.closest('.draggable') &&
                !target.closest('.rubberband') && 
                !target.closest('.tree-preferences')) {
                u.consume_event(e);
            }
        }
    }

    function detect_and_grab() {
        if ($w_dragging === T_Drag.rubberband) {
            const ancestries = ancestries_intersecting_rubberband();
            x.setGrabs_forRubberband(ancestries);
        }
    }

    function handle_s_mouse(s_mouse: S_Mouse): boolean {
        if (s_mouse.isDown && s_mouse.event) {
            const event = s_mouse.event;
            x.w_s_title_edit?.set(null);
            const startPoint = new Point(event.clientX, event.clientY);
            if (event.metaKey) {
                s_rubberband.startPoint = startPoint;
                $w_dragging = T_Drag.graph;
            } else if (event.shiftKey) {
                x.grab_none();
            } else if (features.has_rubber_band) {
                s_rubberband.start(startPoint, bounds);
                rect = s_rubberband.rect;
            }
            return true;
        }
        return false;
    }

</script>

<div class='rubberband-hit-area' 
    bind:this={rubberband_hit_area}
    style='
        top: 0;
        left: 0;
        position: absolute;
        pointer-events: none;
        width: {bounds.width}px;
        z-index: {T_Layer.graph};
        height: {bounds.height}px;'/>
{#if features.has_rubber_band && $w_dragging === T_Drag.rubberband}
    <div class='rubberband' {style}/>
{/if}

<style>
    :global(body.rubberband-blocking) {
        cursor: crosshair !important;
        user-select: none !important;
        -ms-user-select: none !important;
        -moz-user-select: none !important;
        -webkit-user-select: none !important;
    }

    :global(.rubberband-blocking .button,
            .rubberband-blocking .controls, 
            .rubberband-blocking .segmented, 
            .rubberband-blocking .details-stack,
            .rubberband-blocking .bottom-controls) {
        pointer-events: none !important;
    }
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Clickable_Label.svelte
```svelte
<script lang='ts'>
	import { k, colors } from '../../ts/common/Global_Imports';
	import { T_Layer } from '../../ts/common/Enumerations';
	export let handle_mouseUp: (event: Event) => {} | null = null;
	export let font_size = k.font_size.separator;
	export let zindex = T_Layer.details;
	export let label_underline = false;
	export let label_color = 'black';
	export let label = k.empty;
	const { w_background_color } = colors;
</script>

<a
	on:click={handle_mouseUp}
	style='
		top: -6px;
		z-index: {zindex};
		position: absolute;
		color: {label_color};
		font-size: {font_size}px;
		background-color: {$w_background_color};
		cursor: {!!handle_mouseUp ? 'pointer' : 'default'};
		text-decoration: {label_underline ? 'underline' : 'none'};'>
	{label}
</a> ```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/mouse/Steppers.svelte
```svelte
<script lang='ts'>
    import { k, show, Point, colors, Direction, S_Mouse, T_Mouse_Detection } from '../../ts/common/Global_Imports';
    import Triangle_Button from './Triangle_Button.svelte';
    export let hit_closure;
    const buttonSize = 20;
    const origin = new Point(19, 29);
    const { w_t_directionals } = show;
    const offsetY = buttonSize / 2 - 1;

	function hover_closure(isHovering) {
        const hover_color = colors.background_special_blend(colors.default, k.opacity.medium);
        return [isHovering ? hover_color : 'white', k.empty];
    }

	function handle_s_mouse(s_mouse: S_Mouse): boolean {
        const target = s_mouse.element;
        if (!!target && (s_mouse.isDown || s_mouse.isRepeat)) {
            const pointsUp = target.getAttribute('name') == 'up';
            hit_closure(pointsUp, s_mouse.event?.metaKey);
        }
        return true;
	}

</script>

<div class='steppers'>
    {#if $w_t_directionals[0]}
        <Triangle_Button
            mouse_detection={T_Mouse_Detection.autorepeat}
            center={origin.offsetByY(-offsetY)}
            handle_s_mouse={handle_s_mouse}
            hover_closure={hover_closure}
            strokeColor={colors.default}
            angle={Direction.up}
            size={buttonSize}
            name='up'
        />
    {/if}
    {#if $w_t_directionals[1]}
        <Triangle_Button
            mouse_detection={T_Mouse_Detection.autorepeat}
            center={origin.offsetByY(offsetY)}
            handle_s_mouse={handle_s_mouse}
            hover_closure={hover_closure}
            strokeColor={colors.default}
            angle={Direction.down}
            size={buttonSize}
            name='down'
        />
    {/if}
</div>

<style>
    .steppers {
		top: 0px;
		left: 0px;
		position: absolute;     
    }
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/controls/Secondary_Controls.svelte
```svelte
<script lang='ts'>
	import { Point, T_Layer, T_Graph } from '../../ts/common/Global_Imports';
	import { g, k, show, features } from '../../ts/common/Global_Imports';
	import Tree_Controls from './Tree_Controls.svelte';
	import Separator from '../draw/Separator.svelte';
	import Search from '../search/Search.svelte';
	const { w_show_search_controls, w_t_graph } = show;
	const top = g.controls_boxHeight - 5;
	const height = g.controls_boxHeight;
	let isVisible = false;

	// two states: search and tree preferences

	$: {
		const _ = `${$w_show_search_controls}:::${$w_t_graph}`;
		isVisible = $w_show_search_controls || $w_t_graph == T_Graph.tree;
	}

</script>

{#if isVisible}
	<div class='secondary'
		style='
			left: 0px;
			top: {top}px;
			height: {height}px;
			position: absolute;
			z-index: {T_Layer.frontmost};
			width: {g.windowSize.width}px;'>
		{#if $w_show_search_controls}
			<Search top={8}/>
		{:else if $w_t_graph == T_Graph.tree}
			<Tree_Controls/>
		{/if}
		{#if features.allow_tree_mode}
			<Separator name='secondary-bottom-separator'
				corner_radius={k.radius.fillets.thick}
				thickness={k.thickness.separator.main}
				length={g.windowSize.width + 2.5}
				origin={new Point(2, top)}
				has_double_fillet={true}
				isHorizontal={true}/>
		{/if}
	</div>
{/if}

<style>
	.secondary {
		position: absolute;
		width: 100%;
		left: 0;
		top: 0;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/controls/Tree_Controls.svelte
```svelte
<script lang='ts'>
	import { e, g, k, u, x, show, Point, colors, controls } from '../../ts/common/Global_Imports';
	import { T_Graph, T_Layer, T_Control, T_Kinship } from '../../ts/common/Global_Imports';
	import Segmented from '../mouse/Segmented.svelte';
	import Separator from '../draw/Separator.svelte';
	import Slider from '../mouse/Slider.svelte';
	import { transparentize } from 'color2k';
	export let zindex = T_Layer.graph;
	const { w_t_trees } = show;
	const { w_depth_limit } = g;
	const heights = [ 3, 5, 18 ];
	const { w_separator_color } = colors;
	const tops = u.cumulativeSum(heights);
	const segmented_height = k.height.button + 2;
	let widths: Array<number> = [];
	let lefts: Array<number> = [];

	function layout_controls() {
		widths = {
			0: 10,		// initial offset (for tree types start position)
			1: 122,		// tree types segmented control width
			2: 6,		// separator width
			3: 117,		// slider width
			4: 42,		// depth value width
		};
		lefts = u.cumulativeSum(Object.values(widths));
	}

	function handle_depth_limit(value: number) {
		const rounded = Math.round(value);
		if (rounded !== $w_depth_limit) {
			$w_depth_limit = rounded;		// store the rounded value [an actual integer], not the raw value
			x.assure_grab_isVisible();
		}
	}

	layout_controls();

</script>

<div class='tree-preferences' style='
	top: 3px;
	left: -3px;
	width: 100%;
	height: 35px;
	z-index: {zindex};
	position: absolute;
	border-radius: 20px;
	pointer-events: auto;
	background-color: transparent;'>
	{#key $w_t_trees}
		<Segmented name='tree-types'
			left={58}
			width={widths[1]}
			allow_multiple={true}
			selected={$w_t_trees}
			height={k.height.button + 2}
			origin={new Point(lefts[0], 5)}
			titles={[T_Kinship.children, T_Kinship.related]}
			handle_selection={(titles) => controls.handle_segmented_choices('tree', titles)}/>
	{/key}
	<Separator name='tree-types-separator'
		isHorizontal={false}
		length={segmented_height + 19}
		origin={new Point(lefts[1], -0.5)}
		thickness={k.thickness.separator.main}
		corner_radius={k.radius.fillets.thick}/>
	<Slider
		max={12}
		width={117}
		name='depth-limit'
		show_value={false}
		isLogarithmic={true}
		value={$w_depth_limit}
		height={k.height.button + 4}
		origin={new Point(lefts[2], 3)}
		thumb_color={$w_separator_color}
		title_font_size={k.font_size.banners}
		handle_value_change={handle_depth_limit}/>
	<div class='depth-value' style='
		top: 2px;
		width: 56px;
		height: 26px;
		display: flex;
		left: {lefts[3]}px;
		position: absolute;
		align-items: center;
		justify-content: center;
		font-size: {k.font_size.common}px;'>
		{$w_depth_limit} level{($w_depth_limit < 2) ? '' : 's'}
	</div>
</div>```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/controls/Breadcrumbs.svelte
```svelte
<script lang='ts'>
	import { show, debug, search, colors, signals, elements } from '../../ts/common/Global_Imports';
	import { T_Signal, T_Startup, T_Hit_Target } from '../../ts/common/Global_Imports';
	import { Thing, Ancestry, S_Component} from '../../ts/common/Global_Imports';
	import { c, e, g, h, k, core, u, x } from '../../ts/common/Global_Imports';
	import Breadcrumb_Button from '../mouse/Breadcrumb_Button.svelte';
	import { onMount } from 'svelte';
	export let width = g.windowSize.width;
	export let centered: boolean = false;
	export let left: number = 28;
	const { w_t_startup } = core;
	const { w_t_search } = search;
	const { w_thing_color } = colors;
	const { w_rect_ofGraphView } = g;
	const { w_grabs, w_s_title_edit, w_ancestry_focus, w_ancestry_forDetails } = x;
	let s_component: S_Component | null = null;
	let crumb_ancestries: Array<Ancestry> = [];
	let element: HTMLElement | null = null;
	let lefts: Array<number> = [];
	let size = k.height.button;
	let reattachments = 0;
	let trigger = 0;
	
	s_component = signals.handle_signals_atPriority([T_Signal.rebuild, T_Signal.reattach], 1, null, T_Hit_Target.breadcrumbs, (t_signal, value): S_Component | null => {
		update();
	});

	onMount(() => { return () => s_component.disconnect(); });

	$: {
		const _ = `${u.descriptionBy_titles($w_grabs)}
		:::${$w_rect_ofGraphView.description}
		:::${$w_s_title_edit?.description}
		:::${$w_ancestry_forDetails?.id}
		:::${$w_ancestry_focus?.id}
		:::${x.si_found.w_index}
		:::${$w_thing_color}
		:::${$w_t_startup}
		:::${$w_t_search}`;
		update();
	}

	function s_breadcrumbAt(index: number): S_Widget | null {
		return crumb_ancestries[index].g_widget.s_widget ?? null;
	}

	function update() {
		if ($w_t_startup == T_Startup.ready) {				
			let encoded_counts = 0;				// encoded as one parent count per 2 digits (base 10) ... for triggering redraw
			let widths: Array<number> = [];		// for debugging
			const useSelection = $w_ancestry_forDetails.depth > $w_ancestry_focus.depth;
			const ancestries = useSelection ? $w_ancestry_forDetails.heritage : $w_ancestry_focus.heritage;
			[crumb_ancestries, widths, lefts, encoded_counts] = g.layout_breadcrumbs(ancestries, centered, left, width);
			trigger = encoded_counts * 10000 + reattachments * 100 + lefts[0];		// re-render HTML when this value changes
			reattachments += 1;
		}
	}

</script>

{#key trigger}
	<div class='breadcrumbs'
		id = {s_component.id}
		bind:this={element}
		style='
			left:7px;
			top:-5.5px;
			position:absolute;'>
		{#each crumb_ancestries as a, index}
			{#if index > 0}
				<div class='between-breadcrumbs'
					style='
						top:5px;
						position:absolute;
						color:{a.thing.color};
						left:{lefts[index] - size + 5.5}px;'>
					>
				</div>
			{/if}
			<div class='breadcrumb'
				style='
					top:0px;
					position:absolute;'>
				<Breadcrumb_Button
					left={lefts[index]}
					s_breadcrumb={s_breadcrumbAt(index)}/>
			</div>
		{/each}
	</div>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/controls/Primary_Controls.svelte
```svelte
<script lang='ts'>
	import { c, e, g, k, core, u, x, show, colors, search } from '../../ts/common/Global_Imports';
	import { features, elements, controls, svgPaths } from '../../ts/common/Global_Imports';
	import { Point, T_Layer, T_Graph, T_Control, S_Mouse } from '../../ts/common/Global_Imports';
	import Search_Toggle from '../search/Search_Toggle.svelte';
	import Next_Previous from '../mouse/Next_Previous.svelte';
	import Segmented from '../mouse/Segmented.svelte';
	import Separator from '../draw/Separator.svelte';
	import Breadcrumbs from './Breadcrumbs.svelte';
	import Button from '../mouse/Button.svelte';
	const y_center = 10.5;
	const { w_t_search } = search;
	const { w_rect_ofGraphView } = g;
	const { w_count_window_resized } = e;
	const { w_background_color } = colors;
	const hamburger_size = k.height.button;
	const hamburger_path = svgPaths.hamburgerPath(hamburger_size);
	const s_hamburger = elements.s_control_forType(T_Control.details);
	const { w_t_graph, w_id_popupView, w_show_search_controls } = show;
	const search_left = -38 - (features.has_details_button ? 0 : 26) + (features.allow_tree_mode ? 0 : 0);
	let width = g.windowSize.width - 16;
	let lefts: Array<number> = [];
	layout_controls();

	// always show controls and breadcrumbs
	// nicely documented in notes/design/controls.md

	function togglePopupID(id) { $w_id_popupView = ($w_id_popupView == id) ? null : id; }
	function handle_recents_mouseClick(index: number, event?: MouseEvent | null, element?: HTMLElement | null, isFirstCall?: boolean) { 
		const next = index == 1;
		x.recents_go(next);
	}
	function handle_scale_control(index: number, event?: MouseEvent | null, element?: HTMLElement | null, isFirstCall?: boolean) {
		const t_control = index === 0 ? T_Control.shrink : T_Control.grow;
		if (event && element !== undefined) {
			const s_mouse = isFirstCall 
				? S_Mouse.down(event, element)
				: S_Mouse.repeat(event, element);
			e.handle_s_mouseFor_t_control(s_mouse, t_control);
		}
	}
	$: {
		const _ = `${$w_rect_ofGraphView.description}:::${$w_count_window_resized}`;
		width = g.windowSize.width - 16;
	}

	$: {
		const _ = $w_t_search;
		layout_controls();
	}

	function layout_controls() {
		const left_widths = {
			0: features.has_details_button ? 18  : -7,									// details
			1: features.allow_tree_mode	   ? 20  : -70,									// graph type
			2: features.has_zoom_controls  ? 84  : features.allow_tree_mode ? 36 : 34,	// scale controls (grow/shrink)
			3: 108,																		// search toggle
			4: features.allow_search	   ? -32 : 6,									// easter egg
			5: 2,																		// separator
			6: 0,																		// breadcrumbs types
			7: 6,																		// recents
			8: 44,																		// breadcrumbs
		};
		lefts = u.cumulativeSum(Object.values(left_widths));
	}
	
</script>

{#key width, $w_background_color}
	<div class='primary-controls'
		style='
			left: 2px;
			top: 8.8px;
			height: 21px;
			width: {width}px;
			position: absolute;
			z-index: {T_Layer.frontmost};'>
		<Next_Previous name='recents'
			size={28}
			origin={Point.x(lefts[7])}
			top_offset={y_center - 17.66}
			closure={handle_recents_mouseClick}/>
		{#if !$w_id_popupView}
			{#if features.has_details_button}
				<Button name='details-toggle'
					border_thickness=0
					color='transparent'
					s_button={s_hamburger}
					center={new Point(lefts[0], y_center)}
					handle_s_mouse={(s_mouse) => e.handle_s_mouseFor_t_control(s_mouse, T_Control.details)}>
					<svg class='hamburger-svg'
						style='
							height: 17px;
							width: 20.5px;
							position: absolute;'
						viewBox='-1 -1 19 19'>
						<path
							d={hamburger_path}
							stroke-width='0.75'
							class='hamburger-path'
							fill={s_hamburger.isHovering ? 'white' : 'black'}
							stroke={s_hamburger.isHovering ? 'darkgray' : 'transparent'}/>
					</svg>
				</Button>
			{/if}
			{#if features.allow_tree_mode}
				{#key $w_t_graph}
					<Segmented name='graph-type'
						width={80}
						selected={[$w_t_graph]}
						origin={Point.x(lefts[1])}
						titles={[T_Graph.tree, T_Graph.radial]}
						handle_selection={(titles) => controls.handle_segmented_choices('graph', titles)}/>
				{/key}
			{/if}
			{#if features.allow_search}
				<Search_Toggle
					top={-0.5}
					left={search_left}
					width={lefts[3] + (features.has_details_button ? 0 : 26)}/>
			{/if}
			{#if features.has_zoom_controls}
				<Next_Previous name='scale'
					size={28}
					origin={Point.x(lefts[2])}
					top_offset={y_center - 18}
					custom_svgPaths={{
						down: svgPaths.dash(28, 7),
						up: svgPaths.t_cross(28, 6)
					}}
					closure={handle_scale_control}/>
			{/if}
			{#if !features.has_details_button}
				<Button name='easter-egg'
					width={20}
					height={30}
					color='transparent'
					zindex={T_Layer.frontmost}
					center={new Point(lefts[4], 10)}
					style='border: none; background: none;'
					s_button={s_hamburger}
					handle_s_mouse={(s_mouse) => e.handle_s_mouseFor_t_control(s_mouse, T_Control.details)}/>
			{/if}
			<Separator name='after-controls'
				isHorizontal={false}
				origin={new Point(lefts[5], -6)}
				length={g.controls_boxHeight + 0.5}
				thickness={k.thickness.separator.main}
				corner_radius={k.radius.fillets.thick}/>
			<Breadcrumbs
				left={lefts[8]}
				centered={true}
				width={g.windowSize.width - lefts[8] - 4}/>
		{/if}
	</div>
	<Separator name='bottom-separator'
		origin={new Point(2, g.controls_boxHeight - 5)}
		corner_radius={k.radius.fillets.thick}
		thickness={k.thickness.separator.main}
		length={g.windowSize.width + 2.5}
		zindex={T_Layer.frontmost}
		has_double_fillet={true}
		isHorizontal={true}/>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/radial/Radial_Graph.svelte
```svelte
<script lang='ts'>
	import { T_Layer, T_Signal, T_Radial_Zone, T_Hit_Target, S_Component } from '../../ts/common/Global_Imports';
	import { g, k, core, u, x, radial, signals, elements, g_graph_radial } from '../../ts/common/Global_Imports';
	import Radial_Rings from './Radial_Rings.svelte';
	import Radial_Focus from './Radial_Focus.svelte';
	import Widget from '../widget/Widget.svelte';
	import { onMount } from 'svelte';
	const { w_g_paging } = radial;
	const { w_ancestry_focus } = x;
	const { w_rect_ofGraphView, w_user_graph_offset } = g;
	let s_component: S_Component;
	let reattachments = 0;

	//////////////////////////////////////////////
	//											//
	//	reattaches components on/changes to:	//
	//											//
	//		rebuild_needed_forType radial		//
	//		handle_reattach_widgets				//
	//		w_ancestry_focus					//
	//											//
	//	SHOULD only reposition for:				//
	//											//
	//		w_user_graph_offset					//
	//		w_rect_ofGraphView						//
	//											//
	//////////////////////////////////////////////

	// draw center title, arcs, radial and widget necklace
	//	also selection & hover for arcs & radial

	// needs:
	//	handle keys
	//	edit titles (keydown terminates edit) BROKEN
	//	displays editing go when asked by user
	
	g.layout();

	s_component = signals.handle_signals_atPriority([T_Signal.reattach], 0, null, T_Hit_Target.radial, (ancestry) => {
		reattachments += 1;
	});

	signals.handle_signals_atPriority([T_Signal.reposition], 2, null, T_Hit_Target.radial, (received_ancestry) => {
		reattachments += 1;
	});

	onMount(() => { return () => s_component.disconnect(); });

	$: {
		const g_paging = $w_g_paging;
		if (!!g_paging && !!$w_ancestry_focus.thing && $w_ancestry_focus.thing.id == g_paging.thing_id) {
			reattachments += 1;
		}
	}

</script>

<div class = 'radial-graph'
	id = {s_component.id}
	style = '
		position: absolute;
		z-index : {T_Layer.graph};
		width : {$w_rect_ofGraphView.size.width}px;
		height : {$w_rect_ofGraphView.size.height}px;
		transform : translate({$w_user_graph_offset.x}px, {$w_user_graph_offset.y}px);'>
	<Radial_Rings/>
	{#key reattachments}
		<Widget g_widget={$w_ancestry_focus.g_widget}/>
		<div class = 'necklace-of-widgets'
			style = 'z-index : {T_Layer.necklace};'>
			{#each g_graph_radial.g_necklace_widgets as g_necklace_widget}
				<Widget g_widget = {g_necklace_widget}/>
			{/each}
		</div>
	{/key}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/radial/Radial_Rings.svelte
```svelte
<script lang='ts'>
	import { e, g, k, core, x, hits, busy, debug, colors, radial, signals, svgPaths } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Radial_Zone, T_Hit_Target, S_Component, S_Mouse } from '../../ts/common/Global_Imports';
	import { Thing, Point, Angle, g_graph_radial, databases } from '../../ts/common/Global_Imports';
	import Radial_Cluster from './Radial_Cluster.svelte';
	import { onMount } from 'svelte';
	const name = 'rings';
	const { w_s_hover } = hits;
	const { w_count_mouse_up } = e;
	const { w_thing_color } = colors;
	const ring_width = k.thickness.radial.ring;
	const { w_s_title_edit, w_ancestry_focus } = x;
	const { w_g_cluster, w_rotate_angle, w_resize_radius } = radial;
	let color = $w_ancestry_focus?.thing?.color ?? colors.default_forThings;
	let rotate_element: HTMLElement | null = null;
	let resize_element: HTMLElement | null = null;
	let mouse_up_count = $w_count_mouse_up;
	let resize_fill = 'transparent';
	let rotate_fill = 'transparent';
	let s_component: S_Component;
	let reattachments = 0;

	$: outer_diameter  = outer_radius * 2;
	$: outer_radius	   = middle_radius;// + ring_width;
	$: middle_radius   = $w_resize_radius + ring_width;
	$: reticle_svgPath = debug.reticle ? reticle_path() : '';
	$: viewBox		   = `${-ring_width}, ${-ring_width}, ${outer_diameter}, ${outer_diameter}`;
	$: resize_svgPath  = svgPaths.circle(Point.square($w_resize_radius), $w_resize_radius - 0.3, true);
	$: rotate_svgPath  = svgPaths.annulus(Point.square($w_resize_radius), middle_radius, ring_width);

	s_component = signals.handle_reposition_widgets_atPriority(2, null, T_Hit_Target.rings, (received_ancestry) => {
		reattachments += 1;
	});

	onMount(() => {
		update_fill_colors();
		// Set up click handlers for centralized hit system
		radial.s_rotation.handle_s_mouse = handle_s_mouse_forRotation;
		radial.s_resizing.handle_s_mouse = handle_s_mouse_forResize;
		return () => s_component.disconnect();
	});

	$: {
		if (!!resize_element) {
			radial.s_resizing.set_html_element(resize_element);
		}
	}

	$: {
		if (!!rotate_element) {
			radial.s_rotation.set_html_element(rotate_element);
		}
	}

	$: {
		if (!!$w_s_hover) {
			setTimeout(() => {
				update_fill_colors();
			}, 100);
		}
	}
		
	$: {
		const thing = $w_ancestry_focus?.thing;	
		if (!!thing && thing.id == $w_thing_color?.split(k.separator.generic)[0]) {
			color = thing.color ?? colors.default_forThings;
		}
	}

	$: {
		if (mouse_up_count != $w_count_mouse_up) {
			mouse_up_count = $w_count_mouse_up;
			s_reset();			// mouse up ... end all (rotation, resizing, paging)
		}
	}

	function update_fill_colors() {
		resize_fill	= radial.s_resizing.fill_color;
		rotate_fill	= radial.s_rotation.fill_color;
	}

	function s_reset() {
		radial.reset();
		e.mouse_timer_forName(name).reset();
		update_fill_colors();
	}

	function handle_s_mouse_forRotation(s_mouse: S_Mouse): boolean {
		if (s_mouse.isDown && s_mouse.event) {
			const zone = radial.ring_zone_atMouseLocation;
			const angle_ofMouseDown = g.mouse_angle_fromGraphCenter;
			const angle_ofRotation = angle_ofMouseDown.add_angle_normalized(-$w_rotate_angle);
			debug.log_radial(` begin rotate  ${angle_ofRotation.asDegrees()}`);
			radial.s_rotation.active_angle = angle_ofMouseDown;
			radial.s_rotation.basis_angle = angle_ofRotation;
			radial.cursor = radial.cursor_forRingZone;
			return true;
		}
		return false;
	}

	function handle_s_mouse_forResize(s_mouse: S_Mouse): boolean {
		if (s_mouse.isDown && s_mouse.event) {
			const zone = radial.ring_zone_atMouseLocation;
			const angle_ofMouseDown = g.mouse_angle_fromGraphCenter;
			const angle_ofRotation = angle_ofMouseDown.add_angle_normalized(-$w_rotate_angle);
			const change_ofRadius = g.mouse_distance_fromGraphCenter - $w_resize_radius;
			debug.log_radial(` begin resize  ${change_ofRadius.asInt()}`);
			radial.s_rotation.active_angle = angle_ofMouseDown + Angle.quarter;	// needed for cursor
			radial.s_rotation.basis_angle = angle_ofRotation + Angle.quarter;		// "
			radial.s_resizing.basis_radius = change_ofRadius;
			radial.cursor = radial.cursor_forRingZone;
			return true;
		}
		return false;
	}

	function reticle_path(): string {
		const center = $w_resize_radius;
		const start = -ring_width;
		const end = outer_diameter - ring_width;
		return `M ${start} ${center} L ${end} ${center} M ${center} ${start} L ${center} ${end}`;
	}

	$: rings_style = `
		position: absolute;
		z-index: ${T_Layer.ring};
		cursor: ${radial.cursor};
		width: ${outer_diameter}px;
		height: ${outer_diameter}px;
		top: ${g.center_ofGraphView.y - outer_diameter / 2}px;
		left: ${g.center_ofGraphView.x - outer_diameter / 2}px;
	`.removeWhiteSpace();

</script>

{#key reattachments}
	{#if !debug.hide_rings}
		<div class = 'rings'
			id = {s_component.id}
			style = '
				user-select: none;
				-ms-user-select: none;
				-moz-user-select: none;
				z-index:{T_Layer.ring};
				-webkit-user-select: none;'>
			<div class='ring-paths'
				style={rings_style}>
				<svg class = 'rings-svg'
					viewBox = {viewBox}>
					<path class = 'resize-path'
						fill = {resize_fill}
						d = {resize_svgPath}
						bind:this = {resize_element}/>
					{#if debug.reticle}
						<path class = 'reticle-path'
							stroke = 'green'
							fill = 'transparent'
							d = {reticle_svgPath}/>
					{/if}
					<path class = 'rotate-path'
						fill = {rotate_fill}
						d = {rotate_svgPath}
						bind:this = {rotate_element}/>
				</svg>
			</div>
		</div>
	{/if}
	<div class = 'paging-arcs'
		style = '
			z-index:{T_Layer.paging};
			background-color: transparent;'>
		{#each g_graph_radial.g_clusters as g_cluster}
			{#if !!g_cluster && (g_cluster.widgets_shown > 0)}
				<Radial_Cluster
					color = {color}
					g_cluster = {g_cluster}/>
			{/if}
		{/each}
	</div>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/radial/Radial_Cluster.svelte
```svelte
<script lang='ts'>
	import { g, k, core, u, x, hits, show, colors, radial, debug, g_graph_radial } from '../../ts/common/Global_Imports';
	import { Point, T_Layer, G_Cluster, S_Mouse } from '../../ts/common/Global_Imports';
	import Cluster_Pager from '../mouse/Cluster_Pager.svelte';
	import Curved_Text from '../text/Curved_Text.svelte';
	import Fillets from '../draw/Fillets.svelte';
	import { onMount, onDestroy } from 'svelte';
	export let g_cluster: G_Cluster;
	export let color = 'red';
	const show_fat_arc = false;
	const { w_s_hover } = hits;
	const { w_thing_fontFamily } = x;
	const s_paging = g_cluster.s_paging;
	const inset = k.radial_widget_inset;
	const { w_background_color } = colors;
	const { w_g_cluster, w_resize_radius } = radial;
	const g_cluster_pager = g_cluster.g_cluster_pager;
	let thumb_arc_element: HTMLElement | null = null;
	let thumbFill = 'transparent';
	let pager_offset = -8;

	//////////////////////////////////////////////////////
	//													//
	//		draw arc, thumb, label, fork line			//
	//													//
	//	radial graph => radial rings => this			//
	//	ignores signals: {rebuild, recreate}			//
	//	uses g_cluster => {geometry, text} &			//
	//	  {g_cluster_pager, g_thumbArc} => svg paths	//
	//													//
	//////////////////////////////////////////////////////
	
	$: `${$w_g_cluster}:::${$w_s_hover?.id}`, thumbFill = colors.special_blend(color, $w_background_color, radial.s_rotation.isHighlighted ? k.opacity.cluster.thumb : s_paging.thumb_opacity);
	$: textBackground = radial.s_rotation.isHighlighted ? $w_background_color : colors.special_blend(color, $w_background_color, radial.s_resizing.fill_opacity);
	$: ({ start_thumb_transform, end_thumb_transform } = g_cluster_pager.layout_endpoints_onArc(curved_text_radius, pager_angle, arcLength));
	$: arcLength = u.getWidth_ofString_withSize(g_cluster.cluster_title, pager_font_size) * 1.3;
	$: pager_color = colors.special_blend(color, $w_background_color, k.opacity.cluster.titles);
	$: origin = g.center_ofGraphView.offsetBy(Point.square(-radius));
	$: viewBox=`${-inset} ${-inset} ${radius * 2} ${radius * 2}`;
	$: curved_text_radius = $w_resize_radius + pager_offset;
	$: pager_font_size = `${k.font_size.cluster_slider}px`;
	$: pager_angle = -g_cluster_pager.angle_ofFork;
	$: radius = $w_resize_radius + inset;
	$: diameter = radius * 2;
	$: wrapper_style = `
		position: absolute;
		width: ${diameter}px;
		height: ${diameter}px;
		z-index: ${T_Layer.paging};
		cursor: ${k.cursor_default};
		left: ${g.center_ofGraphView.x - radius}px;
		top: ${g.center_ofGraphView.y - radius}px;
	`.removeWhiteSpace();

	onMount(() => {
		s_paging.handle_s_mouse = handle_s_mouse;
		if (!!thumb_arc_element) {
			s_paging.set_html_element(thumb_arc_element);
		}
	});

	function handle_s_mouse(s_mouse: S_Mouse): boolean {
		if (s_mouse.isDown && s_mouse.event) {
			const angle_ofPage = g.mouse_angle_fromGraphCenter.angle_normalized();
			debug.log_radial(` begin paging  ${angle_ofPage.asDegrees()}`);
			s_paging.active_angle = angle_ofPage;
			s_paging.basis_angle = angle_ofPage;
			$w_g_cluster = g_cluster;
			radial.cursor = radial.cursor_forRingZone;
			return true;
		}
		return false;
	}

	function handle_page(delta: number) {
		g_cluster.g_paging?.addTo_paging_index_for(delta);
		g.layout();
	}

	function handle_backward() { handle_page(-1); }
	function handle_forward() { handle_page(1); }

</script>

<div class='radial-cluster'
	style='
		z-index:{T_Layer.paging};
		background-color: transparent;'>
	<div class='cluster-wrapper'
		style={wrapper_style}>
        <svg class='svg-radial-cluster'
			viewBox={viewBox}>
			{#if show_fat_arc}
				<path class='path-arc-fat'
					fill='transparent'
					d={g_cluster_pager.svgPathFor_fatArc}
					stroke-width={k.thickness.radial.fork}
					stroke={colors.special_blend('transparent', $w_background_color, k.opacity.cluster.armature)}/>
			{/if}
			<path class='path-fork'
				fill='transparent'
				d={g_cluster_pager.svgPathFor_radialFork}
				stroke-width={k.thickness.radial.fork * 2}
				stroke={colors.special_blend(color, $w_background_color, k.opacity.cluster.faint)}/>
			<path class='path-arc-slider'
				fill='transparent'
				stroke-width={k.thickness.radial.fork}
				d={g_cluster_pager.svgPathFor_arcSlider}
				stroke={colors.special_blend(color, $w_background_color, k.opacity.cluster.armature)}
				pointer-events="stroke"/>
			{#if g_cluster.widgets_shown > 1}
				{#if g_cluster.isPaging}
					<path class='path-thumb'
						fill={thumbFill}
						bind:this={thumb_arc_element}
						id={`thumb-${g_cluster.name}`}
						d={g_cluster.g_thumbArc.svgPathFor_arcSlider}/>
				{/if}
			{/if}
        </svg>
	</div>
</div>
<Curved_Text
	zindex={T_Layer.ring}
	radius={curved_text_radius}
	text={g_cluster.cluster_title}
	g_cluster_pager={g_cluster_pager}
	font_family={$w_thing_fontFamily}
	background_color={textBackground}
	center_ofArc={g.center_ofGraphView}
	angle={-g_cluster_pager.angle_ofFork}
	font_size={k.font_size.cluster_slider}px
	color={colors.special_blend(color, $w_background_color, k.opacity.cluster.titles)}/>```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Angled_Text.svelte
```svelte
<script>
	import { k, core, u, x, colors, Point, debug, T_Layer } from '../../ts/common/Global_Imports';
	export let background_color = $w_background_color;
	export let font_family = $w_thing_fontFamily;
	export let zindex = T_Layer.paging;
	export let center = Point.zero;
	export let font_size = '0.7em';
	export let text = k.space;
	export let color = 'red';
	export let angle = 0;
	const { w_background_color } = colors;
	const { w_thing_fontFamily } = x;
	
	$: angleDeg = angle * 180 / Math.PI;	// Calculate degrees from radians for CSS rotation

</script>

<div class='angled-text'
	style='
		z-index: {zindex};
		top: {center.y}px;
		left: {center.x}px;
		position: absolute;
		transform: translate(-50%, -50%) rotate({angleDeg}deg);'>
	<span class='text'
		style='
			background-color: {background_color};
			font-family: {font_family};
			font-size: {font_size};
			color: {color};'>
		{text}
	</span>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Text_Table.svelte
```svelte
<script lang='ts'>
	import { g, k, Rect, Point, T_Layer } from '../../ts/common/Global_Imports';
	import type { Integer } from '../../ts/types/Types';
	export let font_size = k.font_size.info;
	export let position = 'relative';
	export let row_height = 12;
	export let name = k.empty;
	export let left = 0;
	export let top = 0;
	export let array;
	const { w_scale_factor } = g;
	let table;

	export function absolute_location_ofCellAt(x: Integer, y: Integer): Point {
		const rows = table.rows;
		const row = rows[x];
		const cells = row.cells;
		if (x >= rows.length) {
			console.error('Row index out of bounds');
		}
		if (y >= cells.length) {
			console.error('Column index out of bounds');
		}
		return Rect.createFromDOMRect(cells[y].getBoundingClientRect()).origin.multipliedEquallyBy(1 / $w_scale_factor);
	}

</script>

{#if array}
	<div class={name}
		style='
			width:97%;
			top:{top}px;
			left:{left}px;
			position:{position};
			font-size:{font_size}px;
			z-index: {T_Layer.details};'>
		<table 
			bind:this={table}
			style='color:black;'>
			{#each array as [key, value]}
				<tr>
					<td class='first-column' style='line-height:{row_height}px;'>{key}&nbsp;</td>
					<td class='second-column' style='line-height:{row_height}px;'>{value}</td>
				</tr>
			{/each}
		</table>
	</div>
{/if}

<style>
	.first-column {
		border-right: 1px solid transparent;
		text-align: right;
		color:black;
		width: 28%;
	}
	.second-column {
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Text_Editor.svelte
```svelte
<script lang='ts'>
	import { k, u, x, debug, colors, T_Layer, elements, databases } from '../../ts/common/Global_Imports';
	import Clickable_Label from '../mouse/Clickable_Label.svelte';
	export let handle_textChange = (label: string, text: string) => {};
	export let handleClick_onLabel: (event: Event) => {} | null = null;
	export let color = colors.default_forThings;
	export let width = k.width.details - 20;
	export let label_underline = false;
	export let original_text = k.empty;
	export let label_color = 'gray';
	export let label = k.empty;
	export let height = 200;
	export let left = 2;
	export let top = 0;
	const { w_thing_fontFamily, w_s_title_edit } = x;
	let textarea = null;
	let bound_text = original_text;
	let cursorStyle = 'cursor: text';

	// Update bound_text when original_text changes, but only if textarea is not focused
	$: if (original_text !== undefined && (!textarea || document.activeElement !== textarea)) {
		bound_text = original_text;
	}

	function handle_key_down(event: KeyboardEvent) { handle_key(true, event); }
	function handle_key_up(event: KeyboardEvent) { handle_key(false, event); }
	
	function handle_focus(event: Event) {
		if (!!$w_s_title_edit) {
			$w_s_title_edit.set_isEditing();
		}
	}

	function handle_blur(event: Event) {
		handle_textChange(label, null);
		if (!!$w_s_title_edit) {
			$w_s_title_edit.stop_editing();
			$w_s_title_edit = null;		// so widget will react
		}
	}

	function handle_key(down: boolean, event: KeyboardEvent) {

		// ignore down and !exit because textarea value is not [yet] altered until key up
		// ignore up and exit so altered text is ignored (result won't include an extraneous RETURN)
		
		const exit = event.key == 'Enter' && !event.shiftKey;
		if (down && exit) {
			u.consume_event(event);
			textarea.blur();
			textarea.value = bound_text;
		} else if (!down && !exit) {
			const text = textarea.value;
			if (!!text || text == k.empty) {
				bound_text = text;
				handle_textChange(label, text);
			}
		}
	}

</script>

<div class={label}
	style='
		top: {top}px;
		left: {left}px;
		width: {width}px;
		position: relative;
		padding-bottom: 7px;'>
	<textarea
		id={label}
		type='text'
		name='text'
		wrap='soft'
		class='text'
		bind:this={textarea}
		on:blur={handle_blur}
		bind:value={bound_text}
		on:focus={handle_focus}
		on:keyup={handle_key_up}
		on:keydown={handle_key_down}
		style='
			resize: none;
			padding: 6px;
			{cursorStyle};
			color: {color};
			height: {height}px;
			overflow-x: hidden;
			vertical-align: top;
			white-space: normal;
			width: {width - 15}px;
			scrollbar-width: none;          /* Firefox */
			z-index: {T_Layer.text};
			overflow-wrap: break-word;
			{k.prevent_selection_style};
			font-family: {$w_thing_fontFamily};
			border-radius: {k.radius.text_area_border}px;
		'/>
	<div class='clickable-label'
		style='
			width: 100%;
			display: flex;
			justify-content: center;'>
		<Clickable_Label
			label={label}
			label_color={label_color}
			label_underline={label_underline}
			handle_mouseUp={handleClick_onLabel} />
	</div>
</div>

<style lang='scss'>

	textarea:focus {
		outline: none;
		border: 1px dashed blue;
	}

	textarea:not(:focus) {
		outline: none;
		border: 1px solid darkgray;
	}

</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/text/Curved_Text.svelte
```svelte
<script lang='ts'>
	import { T_Layer, T_Orientation, G_Cluster_Pager } from '../../ts/common/Global_Imports';
	import { k, core, u, x, colors, Angle, Point } from '../../ts/common/Global_Imports';
	export let font_size = `${k.font_size.cluster_slider}px`;
	export let background_color = $w_background_color;
	export let font_family = $w_thing_fontFamily;
	export let g_cluster_pager: G_Cluster_Pager;
	export let center_ofArc = Point.zero;
	export let zindex = T_Layer.text;
	export let text = k.space;
	export let color = 'red';
	export let radius = 0;
	export let angle = 0;
	const { w_thing_fontFamily } = x;
	const { w_background_color } = colors;
	const text_path_id = `arc-path-${Math.random().toString(36).substr(2, 9)}`;	

	$: arcLength = u.getWidth_ofString_withSize(text, font_size) * 1.3;
	$: ({ text_path_d } = g_cluster_pager.layout_endpoints_onArc(radius, angle, arcLength));

</script>

<svg class='text-on-arc'
	style='
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		overflow: visible;
		z-index: {zindex};
		position: absolute;
		pointer-events: none;'>
	<path id={text_path_id} d={text_path_d} fill='none' />
	<text
		fill={color}
		text-anchor='middle'
		font-size={font_size}
		font-family={font_family}
		dominant-baseline='middle'>
		<textPath href='#{text_path_id}' startOffset='50%'>
			<tspan style='background-color: {background_color};'>
				{text}
			</tspan>
		</textPath>
	</text>
</svg>

<style>
	.text-on-arc {
		overflow: visible;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/BuildNotes.svelte
```svelte
<script lang='ts'>
	import { k, core, u, show, colors, Point, builds, T_Layer, elements } from '../../ts/common/Global_Imports';
	import { T_Hit_Target, S_Element } from '../../ts/common/Global_Imports';
	import Close_Button from '../mouse/Close_Button.svelte';
	import Identifiable from '../../ts/runtime/Identifiable';
	import Steppers from '../mouse/Steppers.svelte';
	import Button from '../mouse/Button.svelte';
	import { onMount } from 'svelte';
	const notesIndexed = Object.entries(builds.notes).reverse();
	const { w_id_popupView, w_t_directionals } = show;
	const notesLimit = notesIndexed.length - 1;
	const { w_background_color } = colors;
	let title = k.empty;
	let notesIndex = 0;
	let notes = [];

	// Visit button
	const s_visit = elements.s_element_for(new Identifiable('visit-material'), T_Hit_Target.button, 'visit-material');
	const visit_height = 21;

	function handle_visit_click() {
		const url = 'https://docs.webseriously.org/work/deliverables.html';
		window.open(url, '_blank');
	}
	
	updateNotes();

	function updateNotes() {
		const end = Math.min(notesLimit, notesIndex + 10);
		notes = notesIndexed.slice(notesIndex, end);
		const suffix = notesIndex < 10 ? ' (10 most recent)' : k.empty;
		title = `Seriously Build Notes${suffix}`;
	}
	
	function handle_key_down(event) {
		const key = event.key.toLowerCase();
		switch (key) {
			case 'escape': $w_id_popupView = null; break;
		}
	}

	function hit_closure(pointsUp, isLong) {
		if (isLong) {
			notesIndex = pointsUp ? 0 : notesLimit - 10;
		} else {			
			const nextIndex = notesIndex + (10 * (pointsUp ? -1 : 1));
			notesIndex = nextIndex.force_between(0, notesLimit - 10);
		}
		$w_t_directionals = [notesIndex > 0, notesIndex < notesLimit - 10];
		updateNotes();
	}

</script>

<svelte:document on:keydown={handle_key_down} />
<div class='notes-modal-overlay'
	on:keyup = {u.ignore}
	on:keydown = {u.ignore}
	on:click={() => $w_id_popupView = null}>
	<div class='notes-modal-content'
		style='background-color:{$w_background_color}'
		on:click|stopPropagation>
		<div class='top-bar'>
			<Steppers hit_closure={hit_closure}/>
			<div class='title'>{title}</div>
		</div>
		<Close_Button
			name='builds-close'
			size={k.height.dot * 1.5}
			closure={() => $w_id_popupView = null}
			origin={new Point(8, k.height.dot * 0.75)}/>
		<div class='visit-button-container'>
			<Button
				name='visit-material'
				s_button={s_visit}
				width={90}
				height={visit_height}
				origin={new Point(0, 0)}
				align_left={true}
				position='relative'
				handle_s_mouse={() => { handle_visit_click(); return true; }}>deliverables</Button>
		</div>
		<br>
		<table style='width:100%'>
			<tbody>
				<tr>
					<th>Build</th>
					<th>Date</th>
					<th>Note</th>
				</tr>
				{#each notes as [key, value]}
					<tr>
						<td>{key}</td>
						<td>{value[0]}</td>
						<td>&nbsp; {value[1]}</td>
					</tr>
				{/each}
			</tbody>
		</table>
	</div>
</div>

<style>
	.notes-modal-overlay {
		background-color: rgba(0, 0, 0, 0.1);
		justify-content: center;
		align-items: center;
		position: fixed;
		display: flex;
		height: 100%;
		width: 100%;
		left: 0;
		top: 0;
	}
	.notes-modal-content {
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
		background-color: #fff;
		border-radius: 4px;
		position: absolute;
		font-size: 0.8em;
		padding: 20px;
		width: 500px;
	}
	.top-bar {
		justify-content: center;
        align-items: center;
        display: flex;
        gap: 10px;
    }
	.title {
		font-size: 1.5em;
	}
	th {
		border-bottom: 1px solid black;
	}
	.visit-button-container {
		position: absolute;
		bottom: 8px;
		right: 8px;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Details.svelte
```svelte
<script lang='ts'>
	import { e, g, k, x, Point, search, features, show } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Detail } from '../../ts/common/Global_Imports';
	import Banner_Hideable from '../details/Banner_Hideable.svelte';
	import D_Preferences from '../details/D_Preferences.svelte';
	import D_Selection from '../details/D_Selection.svelte';
	import D_Actions from '../details/D_Actions.svelte';
	import D_Header from '../details/D_Header.svelte';
	import D_Traits from '../details/D_Traits.svelte';
	import Separator from '../draw/Separator.svelte';
	import D_Data from '../details/D_Data.svelte';
	import D_Tags from '../details/D_Tags.svelte';
	import { T_Graph } from '../../ts/common/Global_Imports';
	const width = k.width.details;
	const { w_t_search } = search;
	const { w_count_details } = e;
	const { w_index: w_found } = x.si_found;
	const { w_ancestry_forDetails, w_grabs } = x;	
	const { w_t_graph, w_show_search_controls } = show;
	const { w_description: w_tags_description } = x.si_thing_tags;
	const { w_description: w_traits_description } = x.si_thing_traits;

	$: secondary_isVisible = $w_show_search_controls || $w_t_graph == T_Graph.tree;
	$: details_top = g.controls_boxHeight + (secondary_isVisible ? g.controls_boxHeight - 5 : 0);
	$: details_height = g.windowSize.height - details_top;

	$: {
		const _ = `${$w_found}
		:::${$w_t_search}
		:::${$w_tags_description}
		:::${$w_grabs.length}
		:::${$w_traits_description}
		:::${$w_ancestry_forDetails}`;
		$w_count_details++;
	}

</script>

{#key $w_count_details}
	<div class='details-stack'
		style='
			left:3px;
			display:flex;
			overflow-y: auto;
			position:absolute;
			top:{details_top}px;
			scrollbar-width: none;          /* Firefox */
			flex-direction:column;
			-ms-overflow-style: none;  
			z-index:{T_Layer.details};
			width:{k.width.details - 6}px;
			height:{details_height}px;'>
		<Banner_Hideable t_detail={T_Detail.header}>
			<D_Header/>
		</Banner_Hideable>
		{#if features.has_every_detail}
			<Banner_Hideable t_detail={T_Detail.preferences}>
				<D_Preferences/>
			</Banner_Hideable>
		{/if}
		<Banner_Hideable t_detail={T_Detail.actions}>
			<D_Actions/>
		</Banner_Hideable>
		<Banner_Hideable t_detail={T_Detail.selection}>
			<D_Selection/>
		</Banner_Hideable>
		{#if features.has_every_detail}
			<Banner_Hideable t_detail={T_Detail.tags}>
				<D_Tags/>
			</Banner_Hideable>
			<Banner_Hideable t_detail={T_Detail.traits}>
				<D_Traits/>
			</Banner_Hideable>
		{/if}
		<Banner_Hideable t_detail={T_Detail.data}>
			<D_Data/>
		</Banner_Hideable>
	</div>
{/key}
<Separator name='right-of-details'
	isHorizontal={false}
	has_double_fillet={true}
	margin={k.details_margin}
	thickness={k.thickness.separator.main}
	corner_radius={k.radius.fillets.thick}
	length={details_height + 6.5}
	origin={new Point(k.width.details - 2, details_top - 2.5)}
/>

<style>
	.details-stack::-webkit-scrollbar {
		display: none;                /* Chrome, Safari, Opera */
	}

	.details-stack > :global(*) {
		flex-shrink: 0;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Import.svelte
```svelte
<script lang='ts'>
	import { g, h, k, x, core, files, show, details, elements } from '../../ts/common/Global_Imports';
	import { Point, T_Storage_Need } from '../../ts/common/Enumerations';
	import { onMount } from 'svelte';
	export let accept: string = '.' + files.format_preference;
	export let multiple = k.empty;		// can be set to 'multiple'
	const { w_id_popupView } = show;
	let file_input: HTMLInputElement;
	
	onMount(() => {
		if (file_input) {
			file_input.click();
		}
	});

	function dismiss_popup() {
		$w_id_popupView = null;
	}

	async function handle_selection(event: Event) {
		const target = event.target as HTMLInputElement;
		const files = target?.files;
		if (!!files && files.length > 0) {
			await h.fetch_andBuild_fromFile(files[0]);
		}
		target.value = k.empty;		// allow re-selection of the same file, MUST do this AFTER fetch
		details.t_storage_need = T_Storage_Need.direction;
		dismiss_popup();
		g.grand_build();
	}

</script>

<input
	on:change={handle_selection}
	on:cancel={dismiss_popup}
	bind:this={file_input}
	style='display: none'
	name='import-file'
	type='file'
	{multiple}
	{accept}
/>

```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Preview.svelte
```svelte
<script lang='ts'>
	import { h, k, u, show, files, colors, Point } from '../../ts/common/Global_Imports';
	import DB_Filesystem from '../../ts/database/DB_Filesystem';
	import Close_Button from '../mouse/Close_Button.svelte';
	const { w_id_popupView } = show;
	const { w_preview_content, w_preview_type, w_preview_filename } = files;
	const { w_background_color } = colors;
	let copyFeedback = '';

	function dismiss_popup() {
		$w_id_popupView = null;
		$w_preview_content = null;
	}

	async function downloadFile() {
		if (!(h.db instanceof DB_Filesystem)) return;
		const thing = h.things.find(t => t.title === $w_preview_filename);
		if (thing) {
			await h.db.downloadFile(thing.id);
		}
	}

	async function copyPath() {
		if (!(h.db instanceof DB_Filesystem)) return;
		const thing = h.things.find(t => t.title === $w_preview_filename);
		if (thing) {
			const success = await h.db.copyPath(thing.id);
			copyFeedback = success ? 'Copied!' : 'Failed';
			setTimeout(() => copyFeedback = '', 1500);
		}
	}

	function handleKeydown(event: KeyboardEvent) {
		if (event.key === 'Escape') {
			dismiss_popup();
		}
	}
</script>

<svelte:document on:keydown={handleKeydown}/>

<div class='preview-overlay'
	on:keyup={u.ignore}
	on:keydown={u.ignore}
	on:click={dismiss_popup}>
	<div class='preview-content'
		style='background-color:{$w_background_color}'
		on:click|stopPropagation>
		<div class='top-bar'>
			<span class='title'>{$w_preview_filename}</span>
		</div>
		<div class='close-wrapper' on:click={dismiss_popup}>
			<Close_Button
				name='preview-close'
				size={k.height.dot * 1.5}
				closure={dismiss_popup}
				origin={new Point(0, 0)}/>
		</div>
		{#if h.db instanceof DB_Filesystem}
			<div class='button-bar'>
				<button on:click={copyPath}>
					{copyFeedback || 'Copy Path'}
				</button>
				<button on:click={downloadFile}>
					Download
				</button>
			</div>
		{/if}
		<div class='preview-body'>
			{#if $w_preview_type === 'image' && $w_preview_content}
				<img src={$w_preview_content} alt='Preview'/>
			{:else if $w_preview_type === 'text' && $w_preview_content}
				<pre>{$w_preview_content}</pre>
			{:else}
				<p>{$w_preview_content}</p>
			{/if}
		</div>
	</div>
</div>

<style>
	.preview-overlay {
		background-color: rgba(0, 0, 0, 0.1);
		justify-content: center;
		align-items: center;
		position: fixed;
		display: flex;
		height: 100%;
		width: 100%;
		left: 0;
		top: 0;
	}
	.preview-content {
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
		background-color: #fff;
		border-radius: 4px;
		position: absolute;
		max-height: 80vh;
		max-width: 80vw;
		font-size: 0.8em;
		padding: 20px;
		overflow: auto;
	}
	.top-bar {
		justify-content: center;
		align-items: center;
		display: flex;
		gap: 10px;
	}
	.close-wrapper {
		position: absolute;
		cursor: pointer;
		right: 8px;
		top: 8px;
	}
	.title {
		font-size: 1.5em;
	}
	.button-bar {
		justify-content: center;
		margin-top: 10px;
		display: flex;
		gap: 10px;
	}
	.button-bar button {
		padding: 4px 12px;
		border-radius: 4px;
		cursor: pointer;
		border: 1px solid #ccc;
		background: #f5f5f5;
	}
	.button-bar button:hover {
		background: #e5e5e5;
	}
	.preview-body {
		margin-top: 15px;
	}
	.preview-body img {
		max-width: 100%;
		max-height: 70vh;
	}
	.preview-body pre {
		white-space: pre-wrap;
		font-family: monospace;
		max-height: 70vh;
		font-size: 12px;
		overflow: auto;
	}
</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/SeriouslyApp.svelte
```svelte
<script lang='ts'>
	import { c } from '../../ts/managers/Configuration';
	import Panel from './Panel.svelte';
	c.configure();
</script>
<Panel/>

<!-- I apologize, this app is under heavy reconstruction... -->```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Panel.svelte
```svelte
<script lang='ts'>
	import { c, e, g, h, k, core, u, x, show, busy, debug, colors, search, elements, databases } from '../../ts/common/Global_Imports';
	import { Rect, Size, Point, Thing, Ancestry, Hierarchy, Direction } from '../../ts/common/Global_Imports';
	import { T_Layer, T_Search, T_Banner, T_Control, T_Startup } from '../../ts/common/Global_Imports';
	import Secondary_Controls from '../controls/Secondary_Controls.svelte';
	import Primary_Controls from '../controls/Primary_Controls.svelte';
	import Search_Results from '../search/Search_Results.svelte';
	import { T_Database } from '../../ts/database/DB_Common';
	import BuildNotes from './BuildNotes.svelte';
	import Spinner from '../draw/Spinner.svelte';
	import Search from '../search/Search.svelte';
	import Details from './Details.svelte';
	import Import from './Import.svelte';
	import Preview from './Preview.svelte';
	import Box from '../draw/Box.svelte';
	import Graph from './Graph.svelte';
	import { onMount } from 'svelte';
	const { w_t_startup } = e;
	const { w_rect_ofGraphView } = g;
	const { w_t_database } = databases;
	const { w_separator_color } = colors;
	const { w_search_results_found } = search;
	const spinner_title = 'Loading your data...';
	const offset_toIntersection = new Point(-4, 8);
	const { w_id_popupView, w_show_details } = show;
    const half_thickness: number = k.thickness.separator.main / 2;
	let spinner_rect = Rect.zero;
	let reattachments = 0;
	let spinnerAngle = 0;

	setup_spinner_rect();
	function ignore_wheel(event) { u.consume_event(event); }
	function handle_spinner_angle(event) { spinnerAngle = event.detail.angle; }

	$: {
		const _ = `${$w_rect_ofGraphView.description}
		:::${$w_t_database}
		:::${$w_t_startup}`;
		setup_spinner_rect();
		if (!!h && h.isAssembled) {
			debug.log_draw(`PANEL`);
			reattachments += 1;
		}
	}

	function setup_spinner_rect() {
		const size = $w_rect_ofGraphView.size
		const title_width = u.getWidthOf(spinner_title) + 35;
		const diameter = Math.min(size.height, size.width) / 4;
		const square = Size.square(Math.max(diameter, title_width));
		const center = size.asPoint.dividedInHalf;
		spinner_rect = Rect.createCenterRect(center, square);
	}

</script>

{#key reattachments}
	<Box name='panel'
		width={g.windowSize.width}
		thickness={k.thickness.separator.main}
		height={g.windowSize.height + 0.5}
		corner_radius={k.radius.fillets.thick}>
		<div class='panel'
			style='
				top: 0px;
				left: 0px;
				position: fixed;
				on:wheel={ignore_wheel}
				{k.prevent_selection_style};
				width: {g.windowSize.width}px;
				height: {g.windowSize.height}px;'>
			{#if $w_id_popupView == T_Control.builds}
				<BuildNotes/>
			{:else if $w_id_popupView == T_Control.import}
				<Import/>
			{:else if $w_id_popupView == T_Control.preview}
				<Preview/>
			{:else}
				<Primary_Controls/>
				{#if $w_show_details}
					<Details/>
				{/if}
				<Secondary_Controls/>
				<div class='main'
					style='
						position: fixed;
						z-index: {T_Layer.graph};
						top: {$w_rect_ofGraphView.origin.y}px;
						left: {$w_rect_ofGraphView.origin.x}px;
						width: {$w_rect_ofGraphView.size.width}px;
						height: {$w_rect_ofGraphView.size.height}px;'>
					{#if busy.isDatabaseBusy && h.db.isRemote}
						{#key spinner_rect.description}
							<div class='data-spinner'
								style='
									opacity: 0.5;
									position: absolute;
									top: {spinner_rect.origin.y}px;
									left: {spinner_rect.origin.x}px;
									font-size: {k.font_size.common}px;'>
								<Spinner
									speed='3s'
									strokeWidth={6}
									angle={spinnerAngle}
									title={spinner_title}
									number_of_dashes={19}
									stroke={$w_separator_color}
									on:angle={handle_spinner_angle}
									diameter={spinner_rect.size.width}/>
							</div>
						{/key}
					{:else if $w_search_results_found}
						<Search_Results/>
					{:else }
						<Graph/>
					{/if}
				</div>
			{/if}
		</div>
	</Box>
{/key}
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/main/Graph.svelte
```svelte
<script lang='ts'>
	import { e, g, h, k, core, u, x, hits, show, Rect, Point, builds, debug, signals, elements } from '../../ts/common/Global_Imports';
	import { S_Component, T_Drag, T_Layer, T_Graph, T_Signal, T_Startup, T_Control } from '../../ts/common/Global_Imports';
	import Radial_Graph from '../radial/Radial_Graph.svelte';
	import Rubberband from '../mouse/Rubberband.svelte';
	import Tree_Graph from '../tree/Tree_Graph.svelte';
	import Button from '../mouse/Button.svelte';
	import { onMount } from 'svelte';
	const { w_t_graph } = show;
	const { w_t_startup } = core;
	const size_big = k.height.button + 4;
	const { w_items: w_expanded } = x.si_expanded;
	const { w_s_title_edit, w_ancestry_focus, w_thing_fontFamily } = x;
	const { w_depth_limit, w_user_graph_offset, w_rect_ofGraphView } = g;
	const { w_s_hover, w_dragging, w_rotate_angle, w_resize_radius } = hits;
	let actual_content_rect = g.user_offset_toGraphDrawing;
	let draggableRect = $w_rect_ofGraphView;
	let reattachments = 0;
	let style = k.empty;
	let draggable;

	//////////////////////////////////////////////
	//											//
	//	reattaches components on/changes to:	//
	//											//
	//		signal_rebuildGraph					//
	//		w_ancestry_focus					//
	//											//
	//	SHOULD only reposition for:				//
	//											//
	//		w_user_graph_offset					//
	//		w_rect_ofGraphView						//
	//											//
	//////////////////////////////////////////////
	
	onMount(() => {
		update_style();
	});
	
	$:	{
		const _ = `${$w_rect_ofGraphView.description}
			:::${$w_s_hover?.id ?? 'null'}
			:::${$w_t_startup}
			:::${$w_t_graph}`;
		update_style();
	}

	$:	{
		const _ = `${u.descriptionBy_titles($w_expanded)}
		:::${$w_ancestry_focus?.titles.join(k.comma)}
		:::${$w_depth_limit}
		:::${$w_t_graph}`;
		grand_layout_andReattach();
	}

	$: {
		const _ = `${$w_user_graph_offset.description}
		:::${$w_rect_ofGraphView.description}
		:::${$w_s_title_edit?.t_edit}
		:::${$w_resize_radius}
		:::${$w_rotate_angle}
		:::${$w_depth_limit}`;
		actual_content_rect = g.user_offset_toGraphDrawing;
	}

	function grand_layout_andReattach() {
		if (!!h && h.hasRoot && $w_dragging !== T_Drag.rubberband) {
			g.layout();
			debug.log_draw(`GRAPH grand_layout_andReattach`);
			actual_content_rect = g.user_offset_toGraphDrawing;
			reattachments += 1;
		}
	}
		
	function update_style() {
		draggableRect = $w_rect_ofGraphView;
		const root = document.documentElement;
		root.style.setProperty('--graph-x', `${draggableRect.origin.x}px`);
		root.style.setProperty('--graph-y', `${draggableRect.origin.y}px`);
		style=`
			overflow: hidden;
			touch-action: none;
			position: absolute;
			pointer-events: auto;
			z-index: ${T_Layer.graph};
			width: ${draggableRect.size.width}px;
			height: ${draggableRect.size.height}px;
		`.removeWhiteSpace();
	}	

</script>

{#key reattachments}
	{#if $w_t_startup == T_Startup.ready}
		<div class='draggable'
			style={style}
			bind:this={draggable}
			class:rubberband-active={$w_dragging}>
			{#if $w_t_graph == T_Graph.radial}
				<Radial_Graph/>
			{:else}
				<Tree_Graph/>
			{/if}
			{#if debug.graph}
				<div class='debug-graph-content'
					style='
						position: absolute;
						border: 1px dashed green;
						z-index: ${T_Layer.frontmost};
						background-color: transparent;
						top: {actual_content_rect.origin.y - 1}px;
						left: {actual_content_rect.origin.x + 14}px;
						width: {actual_content_rect.size.width - 10}px;
						height: {actual_content_rect.size.height - 2}px;
					'>
				</div>
			{/if}
			<Rubberband
				bounds={draggableRect}
				strokeWidth={k.thickness.rubberband}
			/>
		</div>
		<div class='bottom-controls'
			style='
				position:absolute;
				top:{draggableRect.size.height - 26}px;'>
			<Button name={T_Control.builds}
				width={85}
				height={size_big}
				origin={Point.x(4)}
				s_button={elements.s_control_forType(T_Control.builds)}
				handle_s_mouse={(s_mouse) => e.handle_s_mouseFor_t_control(s_mouse, T_Control.builds)}>
				<span style='font-family: {$w_thing_fontFamily};'>
					{'build ' + builds.build_number}
				</span>
			</Button>
			<Button name={T_Control.help}
				width={size_big}
				height={size_big}
				origin={Point.x(draggableRect.size.width - 26)}
				s_button={elements.s_control_forType(T_Control.help)}
				handle_s_mouse={(s_mouse) => e.handle_s_mouseFor_t_control(s_mouse, T_Control.help)}>
				<span
					style='
						top:2px;
						left:6.5px;
						position:absolute;'>
					?
				</span>
			</Button>
		</div>
	{/if}
{/key}

<style>

	:global(body.rubberband-active) {
		cursor: crosshair !important;
		user-select: none !important;
		-ms-user-select: none !important;
		-moz-user-select: none !important;
		-webkit-user-select: none !important;
	}

</style>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Box.svelte
```svelte
<script lang='ts'>
	import { c, k, Rect, Point, T_Layer } from '../../ts/common/Global_Imports';
	import Separator from './Separator.svelte';
    export let corner_radius: number = k.radius.fillets.thick;
    export let thickness: number = k.thickness.separator.main;
    export let showBottom: boolean = true;
    export let showRight: boolean = true;
	export let zindex = T_Layer.details;
    export let showLeft: boolean = true;
    export let showTop: boolean = true;
    export let name: string = k.empty;
    export let height: number = 0;
    export let width: number = 0;
    export let left: number = 0;
    export let top: number = 0;
    const svg_rect = Rect.createWHRect(width, height);

    </script>

<div class='{name}-box'
    style='
        top: {top}px;
        display: flex;
        left: {left}px;
        z-index: {zindex};
        height: {height}px;
        position: absolute;
        width: {width + 2}px;
        box-sizing: border-box;
        flex-direction: column;'>
    <div class='{name}-central-box' style='
        flex: 1;
        display: flex;'>
        {#if showLeft}
            <Separator name='{name}-left-side'
                length={height + 1}
                isHorizontal={false}
                thickness={thickness}
                origin={new Point(2, 2.5)}
                corner_radius={corner_radius}/>
        {/if}
        <div class='{name}-content-box' style='flex: 1;'>
            <slot />
        </div>
        {#if showRight}
            <Separator name='{name}-right-side'
                isHorizontal={false}
                length={height + 1}
                thickness={thickness}
                corner_radius={corner_radius}
                origin={new Point(width + 1 - thickness / 2, 2.5)}/>
        {/if}
    </div>
    {#if showTop}
        <Separator name='{name}-top'
            length={width + 2}
            origin={Point.zero}
            isHorizontal={true}
            thickness={thickness}
			has_fillets={false}
            corner_radius={corner_radius}/>
    {/if}
    {#if showBottom}
        <Separator name='{name}-bottom'
            length={width + 2}
            isHorizontal={true}
            thickness={thickness}
			has_fillets={false}
            corner_radius={corner_radius}
            origin={Point.y(height - thickness)}/>
    {/if}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Spinner.svelte
```svelte
<script lang='ts'>
    import { k } from '../../ts/common/Constants';
    export let angle = 0; // starting angle in degrees
    export let speed = '1s';
    export let diameter = 48;
    export let strokeWidth = 2;
    export let stroke = 'black';
    export let number_of_dashes = 10;
    export let title: string | null = null;
    const dash_width = Math.PI * (diameter - strokeWidth) / number_of_dashes / 2;
    let circle: SVGCircleElement;

    // Expose this method to parent
    export function getCurrentAngle() {
        const transform = getComputedStyle(circle).transform;
        if (transform && transform !== 'none') {
            const matrix = new DOMMatrix(transform);
            let angle = Math.atan2(matrix.b, matrix.a) * 180 / Math.PI;
            if (angle < 0) angle += 360;
            return angle;
        }
        return 0;
    }
</script>

<div class='spinner'
    style='
        position:relative;
        width:{diameter}px;
        height:{diameter}px;
        --spinner-speed:{speed};
        --spinner-angle:{angle}deg;'>
    <svg width={diameter} height={diameter} viewBox={`0 0 ${diameter} ${diameter}`}>
        <circle class='spinner-circle'
            cx={diameter/2}
            cy={diameter/2}
            stroke={stroke}
            fill='transparent'
            bind:this={circle}
            stroke-width={strokeWidth}
            r={(diameter - strokeWidth) / 2}
            stroke-dasharray='{dash_width} {dash_width}'/>
    </svg>
    {#if title}
        <div class='spinner-title'
            style='
                left: 18px;
                position: absolute;
                width: {diameter}px;
                top: {diameter/2 - 10}px;
                font-size: {k.font_size.common}px;'>
        {title}</div>
    {/if}
</div>

<style>
    .spinner-circle {
        transform-origin: center;
        animation: spin var(--spinner-speed) linear infinite;
    }

    @keyframes spin {
        from { transform: rotate(var(--spinner-angle, 0deg)); }
        to { transform: rotate(calc(360deg + var(--spinner-angle, 0deg))); }
    }
</style> ```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Separator.svelte
```svelte
<script lang='ts'>
	import { k, u, Point, colors, T_Layer, Direction } from '../../ts/common/Global_Imports';
	import Clickable_Label from '../mouse/Clickable_Label.svelte';
	import Fillets from '../draw/Fillets.svelte';
	export let handle_mouseUp: (event: Event) => {} | null = null;
	export let corner_radius = k.radius.fillets.ultra_thin;
	export let title_font_size = k.font_size.separator;
	export let thickness = k.thickness.separator.main;
	export let title_left: number | null= null;
	export let title: string | null = null;
	export let zindex = T_Layer.details;
	export let length = k.width.details;
	export let has_thin_divider = false;
	export let has_fillets = true;
	export let has_double_fillet = true;
	export let position = 'absolute';
	export let origin = Point.zero;
	export let isHorizontal = true;
	export let name = 'separator';
	export let margin = 0;
	const { w_separator_color, w_background_color } = colors;
	const thin_line_color = colors.thin_separator_line_color;
	const line_left = isHorizontal ? origin.x + margin : origin.x - thickness / 2;
	const class_name = `${name}-line-${isHorizontal ? 'horizontal' : 'vertical'}`;
	const title_top = origin.y - 1 - title_font_size / 1.5 + (position == 'relative' ? 0 : 1);
	const title_width = u.getWidth_ofString_withSize(title ?? k.empty, `${title_font_size}px`);

	// origin			is the center at the start of the separator
	// isHorizontal		true -> starts at origin.x, false -> starts at top
	// has_fillets		has fillets at either one or both ends
	// has_both_fillets	if has_fillets is true, then has fillets at both ends
	// length			length of the separator
	// margin		
	// zindex
	// handle_mouseUp		renders as a clickable label instead

	$: separatorStyle = style_for(isHorizontal, line_left, zindex, top, origin.y, margin, thickness, length, $w_separator_color);
	$: filletsCenter_single = filletsCenter_for(isHorizontal, length, thickness, false);
	$: filletsCenter_dual = filletsCenter_for(isHorizontal, length, thickness, true);
	$: filletsDirection_single = isHorizontal ? Direction.right : Direction.down;
	$: filletsDirection_dual = isHorizontal ? Direction.left : Direction.up;
	$: title_left = (length - title_width - 20) / 2;

	function style_for(isHorizontal: boolean, line_left: number, zindex: number, top: number, origin_y: number, margin: number, thickness: number, length: number, $w_separator_color: string): string {
		return isHorizontal
			? `top:${origin_y}px; z-index:${zindex}; position:${position}; left:${line_left}px; height:${thickness}px; width:${length - margin * 2}px; background-color:${$w_separator_color};`
			: `left:${line_left}px; z-index:${zindex}; position:${position}; top:${origin_y + margin}px; width:${thickness}px; height:${length - 6 - margin * 2}px; background-color:${$w_separator_color};`;
	}

	function filletsCenter_for(isHorizontal: boolean, length: number, thickness: number, forOtherEnd: boolean): Point {
		return isHorizontal
			? new Point(forOtherEnd ? length - 6 : 0, thickness / 2)
			: new Point(thickness / 2, forOtherEnd ? length - 6 : 0);
	}

</script>

<div class={class_name} style={separatorStyle}>
	{#if has_fillets}
		<Fillets
			thickness={thickness}
			radius={corner_radius}
			color={$w_separator_color}
			center={filletsCenter_single}
			direction={filletsDirection_single}/>
		{#if has_double_fillet}
			<Fillets
				thickness={thickness}
				radius={corner_radius}
				center={filletsCenter_dual}
				color={$w_separator_color}
				direction={filletsDirection_dual}/>
		{/if}
	{/if}
</div>
{#if has_thin_divider}
	{#if isHorizontal}
		<div class='thin-horizontal-divider'
			style='
				height:{0.05}px;
				position:{position};
				z-index:{zindex + 1};
				width:{length - 21}px;
				left:{line_left + 8}px;
				top:{origin.y + thickness / 2}px;
				background-color:{thin_line_color};'>
		</div>
	{:else}
		<div class='thin-vertical-divider'
			style='
				width:{0.05}px;
				top:{origin.y}px;
				position:{position};
				z-index:{zindex + 1};
				height:{length - 6}px;
				left:{origin.x - 0.05}px;
				background-color:{thin_line_color};'>
		</div>
	{/if}
{/if}
{#if !!title}
	{#if handle_mouseUp}
		<div class='clickable-title'
			style='
				left:-1px;
				width: 100%;
				display: flex;
				position:absolute;
				top:{title_top + 6}px;
				justify-content: center;'>
			<Clickable_Label
				label={title}
				zindex={zindex + 1}
				label_underline={true}
				font_size={title_font_size}
				handle_mouseUp={handle_mouseUp}/>
		</div>
	{:else}
		<div class='static-title'
			style='
				z-index:{zindex};
				padding: 0px 5px;
				position:{position};
				white-space: nowrap;
				left:{title_left}px;
				z-index:{zindex + 2};
				top:{title_top + 1}px;
				width:{title_width}px;
				font-size:{title_font_size}px;
				background-color:{$w_background_color};'>
			{title}
		</div>
	{/if}
{/if}```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Circle.svelte
```svelte
<script lang='ts'>
	import { k, u, Point, debug, T_Layer } from '../../ts/common/Global_Imports'
	export let zindex = T_Layer.dot;
	export let center = Point.zero;
	export let name = k.empty;
	export let thickness = 1;
	export let radius = 2;
	export let color;
	let diameter = 0;

	$: diameter = radius * 2;

</script>

<div
	class= 'circle' name={name} style='
		z-index: {zindex};
		position: absolute;
		border-radius: 50%;
		width: {diameter}px;
		height: {diameter}px;
		border: {thickness}px solid {color};
		top: {center.y - radius - thickness}px;
		left: {center.x - radius - thickness}px;'>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Fillets.svelte
```svelte
<script lang='ts'>
    import { k, Point, Angle, T_Layer, Direction, svgPaths } from '../../ts/common/Global_Imports';
    export let radius = k.radius.fillets.ultra_thin;
    export let direction = Direction.down;
    export let zindex = T_Layer.line;
    export let center = Point.zero;
    export let color = 'black';
    export let thickness = 1;
    const cx = 0;
    const cy = 0;
    const baseAngle = direction + Angle.half;
    const leftEndAngle = baseAngle + Angle.quarter;
    const rightEndAngle = baseAngle - Angle.quarter;
    const a_start = Point.fromPolar(radius, leftEndAngle);
    const a_end = Point.fromPolar(radius, baseAngle);
    const b_end = Point.fromPolar(radius, rightEndAngle);
    const minX = Math.min(a_start.x, a_end.x, b_end.x);
    const maxX = Math.max(a_start.x, a_end.x, b_end.x);
    const minY = Math.min(a_start.y, a_end.y, b_end.y);
    const maxY = Math.max(a_start.y, a_end.y, b_end.y);
    const width = maxX - minX;
    const height = maxY - minY;
    const svgTop = center.y + minY;
    const svgLeft = center.x + minX;
    let filletsPath = svgPaths.fillets(Point.zero, radius, direction);
</script>

<svg
    style='
        z-index: {zindex};
        position: absolute;
        pointer-events: none;
        top: {svgTop}px;
        left: {svgLeft}px;'
    class='fillets'
    width={width}
    height={height}
    viewBox={`${minX} ${minY} ${width} ${height}`}> 
    <path 
        fill={color}
        stroke={color}
        d={filletsPath}
        stroke-width={thickness}/>
</svg>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/SVG_D3.svelte
```svelte
<script lang='ts'>
    import { k, Point, colors, T_Layer } from '../../ts/common/Global_Imports';
	import { onMount } from 'svelte';
    import * as d3 from 'd3';
	export let viewBox_width: number | undefined = undefined;
	export let stroke_width: number = k.thickness.stroke;
    export let pathElement: SVGPathElement | null = null;
    export let stroke = colors.default;
    export let zindex = T_Layer.common;
    export let position = 'absolute';
    export let svgPath = k.empty;
    export let name = 'SVG_D3';
    export let fill = 'none';
	export let height = 10;
	export let width = 10;
	export let left = 0;
	export let top = 0;
	let svg;

    onMount(() => {
        const path = d3.select(svg)
            .append('path')
            .attr('fill', fill)
            .attr('stroke', stroke)
            .attr('class', `${name}`)
            .attr('stroke-width', stroke_width)
            .attr('vector-effect', 'non-scaling-stroke')
            .attr('shape-rendering', 'geometricPrecision') // anti-alias;
            .attr('d', svgPath);
        pathElement = path.node() as SVGPathElement;
    })

    $: viewBox_w = viewBox_width ?? width;

    $: {
        if (!!fill) {
            d3.select(svg)
                .select('path')
                .attr('fill', fill)
                .attr('stroke', stroke)
                .attr('class', `${name}-path`)
                .attr('stroke-width', stroke_width)
                .attr('vector-effect', 'non-scaling-stroke')
                .attr('shape-rendering', 'geometricPrecision') // anti-alias
                .attr('d', svgPath);
            svg = svg;
        }
    }

</script>

<svg class={name}
    bind:this={svg}
    width='{width}px'
    height='{height}px'
    viewBox='{left} {top} {viewBox_w} {height}'
    preserveAspectRatio='none'
    style='
        top: 0px;
        left: 0px;
        z-index: {zindex};
        position: {position};
        shape-rendering: geometricPrecision;'/>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Printable.svelte
```svelte
<script>
	import { Point, Rect, Size } from '../../ts/types/Coordinates';
	import { k } from '../../ts/common/Constants';
	export let element; // The HTML element (E) to print
	export let rect; // The rect (position and size of D)
	const screen_scale_factor = window.devicePixelRatio;``
	const message_height = 290;
	let printer_page_width = 722;
	let final_content_rect;
	let printer_dpi = 96;
	let final_inset_size;
	let final_page_size;
	let final_origin;
	let log_message;
	let isLandscape;
	let scaleFactor;
	let margin = 0;
	let scale_size;
	let printable;
	let kludge
	
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//
	//	Printing origin calculation:
	//
	//	pO		k - dC * dpF
	//	dC		dO + dS / 2
	//
	//	scalars:
	//
	//	dpF		scaleFactor
	//	m		margin
	//
	//	vectors:
	//
	// 	k		kludge								BROKEN, doesn't work for many variants of D
	//	pO		final_origin						top left for print style
	//	pS		final_inset_size
	//	dS		given_content_rect . size
	//	dC		given_content_rect . center
	//	dO		given_content_rect . origin			location of the drawn sub element within the given element
	//
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	configure();
	layout();

	$: if (!!printable) {
		printable.innerHTML = k.empty;
		printable.appendChild(element.cloneNode(true));
	}

	function configure() {
		const printCSS = `
			@media print {
				.print-test {
						top: 0; 
						left: 0; 
						width: 100%; 
						height: 100%; 
						position: absolute; 
					}
				}`;
		const square_inch = document.createElement('div');
		const style = document.createElement('style');
		const page = document.createElement('div');
		style.textContent = printCSS;
		page.className = 'print-test';
		square_inch.style.cssText = 'width: 1in; height: 1in; position: absolute; top: -9999px;';

		document.head.appendChild(style);
		document.body.appendChild(page);
		printer_page_width = page.offsetWidth;
		document.body.removeChild(page);
		document.head.removeChild(style);

		document.body.appendChild(square_inch);
		printer_dpi = square_inch.offsetWidth;
		document.body.removeChild(square_inch);
		margin = printer_dpi * 0.75; // 3/4 inch margins
	}
	
	function debug_log() {
		return `Screen scale factor: ${screen_scale_factor}
Given content origin: ${rect.description}
Given content size: ${rect.size.description}
Kludge: ${kludge.description}
Final DPI: ${k.printer_dpi}
Final scale factor: ${scaleFactor.toFixed(4)}
Final margin: ${margin}
Final page size: ${final_page_size.description}
Final page center: ${final_page_size.center.description}
Final inset size: ${final_inset_size.description}
Final content size: ${final_content_rect.size.description}
Final content center: ${final_content_rect.center.description}
Final origin: ${final_origin.description}
`;
	}

	function layout() {
		const w = printer_page_width;
		const h = w * printer_aspect_ratio;
		isLandscape = rect.size.width > rect.size.height;
		final_page_size = new Size(
			isLandscape ? h : w,
			isLandscape ? w : h
		);
		margin = printer_dpi * 0.75; // 3/4 inch margins
		final_inset_size = final_page_size.insetEquallyBy(margin);
		scale_size = final_inset_size.dividedBy(rect.size);
		scaleFactor = Math.min(scale_size.width, scale_size.height) * screen_scale_factor;
		final_content_rect = rect.multipliedEquallyBy(scaleFactor);
		kludge = new Point(-220, -380);
		final_origin = final_page_size.center.offsetBy(rect.center.negated).offsetBy(kludge);
		log_message = debug_log();
	}
	
</script>

<div class='print-container'>
	{#if !!final_origin && !!scaleFactor}
		<div class='printable-content'
			bind:this={printable}
			style='
				transform: scale({scaleFactor});
				transform-origin: 50% 50%;
				left: {final_origin.x}px;
				top: {final_origin.y}px;
				position: absolute;
			'>
		</div>
	{/if}
	{#if !!log_message && !!final_page_size && !!final_inset_size}
		<div class='message-box'
			style='
				width: {final_inset_size.width * 1.5}px;
				top: {final_page_size.height - 100}px;
				font-size: {k.font_size.warning}px;
				background-color: transparent;
				height: {message_height}px;
				box-sizing: border-box;
				font-family: monospace;
				white-space: pre-wrap;
				border: 2px solid red;
				position: absolute;
				overflow: auto;
				padding: 8px;
				color: black;
				left: 0px;
			'>
			{log_message}
		</div>
	{/if}
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/SVG_Gradient.svelte
```svelte
<script lang='ts'>
	import { Size } from '../../ts/common/Global_Imports';
	export let name = 'shading' + Math.random().toString(36).substr(2, 9);
	export let path = 'M 50,50 C 50,50 50,50 50,50';
	export let size = Size.square(100);
	export let color = '#4a90e2';
	export let isInverted = true;
	const fill = 'url(#' + name + ')';
	function opacity_for(flag: boolean): string { return flag ? '0' : '1'; }

</script>

<svg width={size.width} height={size.height} viewBox='0 -2 {size.width} {size.height}'>
	<defs>
		<radialGradient id={name} cx='50%' cy='50%' r='50%' fx='50%' fy='50%'>
			<stop offset='0%' stop-color={color} stop-opacity={opacity_for(isInverted)} />
			<stop offset='100%' stop-color={color} stop-opacity={opacity_for(!isInverted)} />
		</radialGradient>
	</defs>
	<path d={path} fill={fill}/>
</svg>```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Portal.svelte
```svelte
<script lang='ts'>
  import { tick } from 'svelte';
  
  export let target: string | HTMLElement = 'body';
  export let id: string | undefined = undefined;
  export let className: string | undefined = undefined;
  
  function portal(el: HTMLElement, target: string | HTMLElement = 'body') {
    let targetEl: HTMLElement;
    
    async function update(newTarget: string | HTMLElement) {
      target = newTarget;
      if (typeof target === 'string') {
        targetEl = document.querySelector(target);
        if (targetEl === null) {
          await tick();
          targetEl = document.querySelector(target);
        }
        if (targetEl === null) {
          throw new Error(`No element found matching css selector: "${target}"`);
        }
      } else if (target instanceof HTMLElement) {
        targetEl = target;
      } else {
        throw new TypeError(`Unknown portal target type: ${target === null ? 'null' : typeof target}. Allowed types: string (CSS selector) or HTMLElement.`);
      }
      targetEl.appendChild(el);
      el.hidden = false;
    }

    function destroy() {
      if (el.parentNode) {
        el.parentNode.removeChild(el);
      }
    }

    update(target);
    return {
      update,
      destroy,
    };
  }
</script>

<div use:portal={target} hidden {id} class={className}>
  <slot />
</div> ```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Transparent_Circle.svelte
```svelte
<script lang='ts'>
	import { k, Point, debug, colors, T_Layer } from '../../ts/common/Global_Imports'
	const { w_background_color } = colors;
	export let color_background = debug.lines ? 'transparent' : $w_background_color;
	export let zindex = T_Layer.dot;
	export let opacity = 0;
	export let thickness;
	export let radius;
	export let center;
	export let color;
	let transparentColor = 'transparent';
	let diameter = 0;

	$: {
		diameter = radius * 2;
		transparentColor = colors.opacitize(color_background, opacity);
	}

</script>

<style>
	.circle {
		position: absolute;
		border-radius: 50%;
	}
</style>

<div class='circle'
	style='
		width: {diameter}px;
		height: {diameter}px;
		z-index: {zindex};
		top: {center.y - radius}px;
		left: {center.x - radius}px;
		border: {thickness}px solid {color};
		background-color: {transparentColor};'>
</div>
```

### /Users/sand/GitHub/mono/ws/src/lib/svelte/draw/Gull_Wings.svelte
```svelte
<script lang='ts'>
    import { k, Point, Angle, T_Layer, Direction, svgPaths } from '../../ts/common/Global_Imports';
    export let radius = k.radius.gull_wings.ultra_thin;
    export let direction = Direction.down;
    export let zindex = T_Layer.line;
    export let center = Point.zero;
    export let color = 'black';
    export let thickness = 1;
    const cx = 0;
    const cy = 0;
    const baseAngle = direction + Angle.half;
    const leftEndAngle = baseAngle + Angle.quarter;
    const rightEndAngle = baseAngle - Angle.quarter;
    const a_start = Point.fromPolar(radius, leftEndAngle);
    const a_end = Point.fromPolar(radius, baseAngle);
    const b_end = Point.fromPolar(radius, rightEndAngle);
    const minX = Math.min(a_start.x, a_end.x, b_end.x);
    const maxX = Math.max(a_start.x, a_end.x, b_end.x);
    const minY = Math.min(a_start.y, a_end.y, b_end.y);
    const maxY = Math.max(a_start.y, a_end.y, b_end.y);
    const width = maxX - minX;
    const height = maxY - minY;
    const svgTop = center.y + minY;
    const svgLeft = center.x + minX;
    let gullWingsPath = svgPaths.gull_wings(Point.zero, radius, direction);
</script>

<svg
    style='
        z-index: {zindex};
        position: absolute;
        pointer-events: none;
        top: {svgTop}px;
        left: {svgLeft}px;'
    class='gull-wings'
    width={width}
    height={height}
    viewBox={`${minX} ${minY} ${width} ${height}`}> 
    <path 
        fill={color}
        stroke={color}
        d={gullWingsPath}
        stroke-width={thickness}/>
</svg>
```

### /Users/sand/GitHub/mono/ws/src/lib/js/index.js
```js
export {default as SeriouslyApp} from '../svelte/main/SeriouslyApp.svelte';```

### /Users/sand/GitHub/mono/ws/src/lib/js/plugin.js
```js
console.log('plugin says hi');
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Firebase.ts
```ts
import { c, h, k, p, u, busy, Tag, Thing, Trait, builds, debug, g } from '../common/Global_Imports';
import { doc, addDoc, setDoc, getDocs, deleteDoc, updateDoc, collection } from 'firebase/firestore';
import { T_Create, T_Preference, T_Persistable } from '../common/Global_Imports';
import { T_Persistence } from '../common/Enumerations';
import { onSnapshot, deleteField, getFirestore, serverTimestamp } from 'firebase/firestore';
import { T_Thing, T_Trait, T_Debug, T_Order, T_Predicate } from '../common/Global_Imports';
import { databases, Predicate, Relationship, Persistable } from '../common/Global_Imports';
import { DocumentData, DocumentChange, DocumentReference } from 'firebase/firestore';
import { QuerySnapshot, CollectionReference } from 'firebase/firestore';
import type { Dictionary, Integer } from '../types/Types';
import Identifiable from '../runtime/Identifiable';
import { DB_Name, T_Database } from './DB_Common';
import { initializeApp } from 'firebase/app';
import DB_Common from './DB_Common';

export default class DB_Firebase extends DB_Common {
	config = {
		appId: "1:224721814373:web:0c60f394c056ef3decd78c",
		apiKey: "AIzaSyAFy4H3Ej5zfI46fvCJpBfUxmyQco-dx9U",
		authDomain: "seriously-4536d.firebaseapp.com",
		storageBucket: "seriously-4536d.appspot.com",
		messagingSenderId: "224721814373",
		measurementId: "G-9PY9LVK813",
		projectId: "seriously-4536d"
	};

	addedTag!: Tag;
	addedThing!: Thing;
	addedTrait!: Trait;
	bulksName = 'Bulks';
	deferSnapshots = false;
	idBase = DB_Name.firebase;
	bulks: Dictionary<Bulk> = {};
	t_database = T_Database.firebase;
	app = initializeApp(this.config);
	firestore = getFirestore(this.app);
	t_persistence = T_Persistence.remote;
	predicatesCollection!: CollectionReference;
	deferredSnapshots: Array<SnapshotDeferal> = [];

	reportError(error: any) { console.log(error); }
	get displayName(): string { return this.idBase; }

	apply_queryStrings(queryStrings: URLSearchParams) {
		const persistedID = p.read_key(T_Preference.base_id);
		const id = queryStrings.get('name') ?? queryStrings.get('dbid') ?? persistedID ?? 'Public';
		p.write_key(T_Preference.base_id, id);
		this.idBase = id;
	}

	async remove_all() {
		const documentRef = doc(this.firestore, this.bulksName, this.idBase);
		await this.subcollections_persistentDeleteIn(documentRef);

		try {
			await deleteDoc(documentRef);
		} catch (error) {
			this.reportError(error);
		}
	}

	static readonly _____FETCH: unique symbol;

	async fetch_all(): Promise<boolean> {
		await busy.temporarily_set_isFetching_while(async () => {
			await this.recordLoginIP();
			await this.documents_fetch_ofType(T_Persistable.predicates);
			await this.hierarchy_fetch_forID(this.idBase);
			await this.setup_remote_handlers();
			await this.fetch_bulkAliases();		// TODO: assumes all ancestries are already created, including h.rootAncestry
		});
		return true;
	}

	async hierarchy_fetch_forID(idBase: string) {
		await this.documents_fetch_ofType(T_Persistable.relationships, idBase);
		await this.documents_fetch_ofType(T_Persistable.traits,		   idBase);
		await this.documents_fetch_ofType(T_Persistable.tags,		   idBase);
		await this.documents_fetch_ofType(T_Persistable.things,		   idBase);		// do this last so can translate ids in all others above
	}
		
	async documents_fetch_ofType(t_persistable: T_Persistable, idBase: string | null = null) {
		try {
			const collectionRef = !idBase ? collection(this.firestore, t_persistable) : collection(this.firestore, this.bulksName, idBase, t_persistable);
			let querySnapshot = await getDocs(collectionRef);
			if (!!idBase) {
				if (querySnapshot.empty) {
					await this.document_defaults_ofType_persistentCreateIn(t_persistable, idBase, collectionRef);
					querySnapshot = await getDocs(collectionRef);
				}
			}
			const docs = querySnapshot.docs;
			debug.log_remote('READ ' + docs.length + ' from ' + idBase + ':' + t_persistable);
			for (const docSnapshot of [...docs]) {
				const id = docSnapshot.id;
				const data = docSnapshot.data();
				this.document_ofType_remember_validated(t_persistable, id, data, idBase ?? this.idBase);
			}
		} catch (error) {
			this.reportError(error);
		}
	}

	static readonly _____BULKS: unique symbol;

	bulk_forID(idBase: string | null) {
		if (!idBase) {
			return null;
		}
		let bulk = this.bulks[idBase];
		if (!bulk) {
			bulk = new Bulk(idBase)
			this.bulks[idBase] = bulk;
		}
		return bulk;
	}
	
	async fetch_bulkAliases() {
		const root = h.root;
		if (!!root && this.idBase == k.name_bulkAdmin) {
			const externalsAncestry = await h.ancestry_externals;		// TODO: assumes all ancestries created
			if (!!externalsAncestry) {
				try {		// add bulk aliases to roots thing
					const bulk = collection(this.firestore, this.bulksName);	// fetch all bulks (documents)
					let bulkSnapshot = await getDocs(bulk);
					for (const bulkDoc of [...bulkSnapshot.docs]) {
						const idBulk = bulkDoc.id;
						if (idBulk != this.idBase) {
							let thing = h.bulkAlias_forTitle(idBulk);
							if (!thing) {								// create a thing for each bulk
								thing = h.thing_runtimeCreate(this.idBase, Identifiable.newID(), idBulk, 'red', T_Thing.bulk);
								await externalsAncestry.ancestry_persistentCreateUnique_byAddingThing(thing);
							} else if (thing.thing_isBulk_expanded) {
								await h.ancestry_redraw_persistentFetchBulk_browseRight(thing);		// preload
							}
						}
					}
					// TODO: detect when a root disappears
				} catch (error) {
					this.reportError(error);
				}
			}
		}
	}

	static readonly _____REMOTE: unique symbol;
	
	snapshot_deferOne(idBase: string, t_persistable: T_Persistable, snapshot: QuerySnapshot) {
		const deferral = new SnapshotDeferal(idBase, t_persistable, snapshot);
		this.deferredSnapshots.push(deferral);
	}

	async handle_deferredSnapshots() {
		let needsRebuild = false;
		this.deferSnapshots = false;
		let relationships_haveChanged = false;
		while (this.deferredSnapshots.length > 0) {
			const deferral = this.deferredSnapshots.shift();
			if (!!deferral) {
				for (const change of [...deferral.snapshot.docChanges()]) {	// convert and remember
					if (await this.handle_docChanges(deferral.idBase, deferral.t_persistable, change)) {
						if (deferral.t_persistable == T_Persistable.relationships) {
							relationships_haveChanged = true;
						}
						needsRebuild = true;
					}
				};
			}
		}
		if (needsRebuild) {
			this.signal_docHandled(relationships_haveChanged);
		}
	}

	async setup_remote_handlers() {
		let rebuildScheduled = false;
		let relationships_haveChanged = false;
		for (const t_persistable of Persistable.t_persistables) {
			if (t_persistable == T_Persistable.predicates) {
				this.predicatesCollection = collection(this.firestore, t_persistable);
			} else {
				const idBase = this.idBase;
				const bulk = this.bulk_forID(idBase);
				const collectionRef = collection(this.firestore, this.bulksName, idBase, t_persistable);
				if (!!bulk) {
					switch (t_persistable) {
						case T_Persistable.tags:		  bulk.tagsCollection = collectionRef; break;
						case T_Persistable.things:		  bulk.thingsCollection = collectionRef; break;
						case T_Persistable.traits:		  bulk.traitsCollection = collectionRef; break;
						case T_Persistable.relationships: bulk.relationshipsCollection = collectionRef; break;
					}
				}
				onSnapshot(collectionRef, async (snapshot) => {
					if (h.isAssembled) {		// u.ignore snapshots caused by data written to server
						if (this.deferSnapshots) {
							this.snapshot_deferOne(idBase, t_persistable, snapshot);
							return;
						} else {
							for (const change of [...snapshot.docChanges()]) {	// convert and remember
								if (await this.handle_docChanges(idBase, t_persistable, change)) {
									if (t_persistable == T_Persistable.relationships) {
										relationships_haveChanged = true;
									}
									if (!rebuildScheduled) {
										rebuildScheduled = true;
										setTimeout(() => {		// defer signal_docHandled until after all handle_docChanges calls [microtasks] complete
											this.signal_docHandled(relationships_haveChanged);	  // so that this is called exactly once.
											relationships_haveChanged = false;
											rebuildScheduled = false;
										}, 0);
									}
								}
							}
						}
					}
				});
			}
		}
	}

	signal_docHandled(relationships_haveChanged: boolean) {
		if (relationships_haveChanged) {
			busy.signal_data_redraw();
			h.ancestries_fullRebuild();		// first recreate ancestries
			setTimeout(() => { // wait in case a thing involved in this relationship arrives in the data
				h.relationships_refreshKnowns();
				h.rootAncestry.order_normalizeRecursive();
				g.layout();
			}, 20);
		}
	}

	async handle_docChanges(idBase: string, t_persistable: T_Persistable, change: DocumentChange): Promise<boolean> {
		const doc = change.doc;
		const data = doc.data();
		let needsRebuild = false;
		if (DB_Firebase.data_isValidOfKind(t_persistable, data)) {
			const id = doc.id;

			//////////////////////////////
			//	ignores predicate data  //
			//////////////////////////////

			try {
				switch (t_persistable) {
					case T_Persistable.tags:		  needsRebuild = this.tag_handle_docChanges(idBase, id, change, data); break;
					case T_Persistable.things:		  needsRebuild = this.thing_handle_docChanges(idBase, id, change, data); break;
					case T_Persistable.traits:		  needsRebuild = this.trait_handle_docChanges(idBase, id, change, data); break;
					case T_Persistable.relationships: needsRebuild = this.relationship_handle_docChanges(idBase, id, change, data); break;
				}
			} catch (error) {
				this.reportError(error);
			}
			debug.log_remote('HANDLE ' + idBase + ':' + t_persistable + k.space + change.type);
		}
		return needsRebuild;
	}

	static readonly _____SUBCOLLECTIONS: unique symbol;

	async document_defaults_ofType_persistentCreateIn(t_persistable: T_Persistable, idBase: string, collectionRef: CollectionReference) {
		if (!!idBase) {
			const docRef = doc(this.firestore, this.bulksName, idBase);
			await setDoc(docRef, { isReal: true }, { merge: true });
			await updateDoc(docRef, { isReal: deleteField() });
		}
		switch (t_persistable) {
			case T_Persistable.predicates: h.predicate_defaults_remember_runtimeCreate(); break;
			case T_Persistable.things:	   await this.root_default_remember_persistentCreateIn(collectionRef); break;
		}
	}

	document_ofType_remember_validated(t_persistable: T_Persistable, id: string, data: DocumentData, idBase: string) {
		if (DB_Firebase.data_isValidOfKind(t_persistable, data)) {
			switch (t_persistable) {
				case T_Persistable.predicates:	  h   .predicate_remember_runtimeCreateUnique(		  id, data.kind,		 data.isBidirectional ); break;
				case T_Persistable.things:		  h       .thing_remember_runtimeCreateUnique(idBase, id, data.title,		 data.color,		  data.t_thing, true); break;
				case T_Persistable.relationships: h.relationship_remember_runtimeCreateUnique(idBase, id, data.predicate.id, data.parent.id,	  data.child.id, data.orders, T_Create.isFromPersistent); break;
				case T_Persistable.traits:		  h       .trait_remember_runtimeCreateUnique(idBase, id, data.ownerID,		 data.t_trait,		  data.text, true); break;
				case T_Persistable.tags:		  h  .tag_remember_runtimeCreateUnique_forType(idBase, id, data.type,		 data.thingHIDs,	  true); break;
			}
		}
	}
	
	async subcollections_persistentDeleteIn(docRef: DocumentReference) {
		const subcollectionNames = ['Things', 'Traits', 'Relationships'];
		for (const subcollectionName of [...subcollectionNames]) {	
			const subcollectionRef = collection(docRef, subcollectionName);
			const snapshot = await getDocs(subcollectionRef);
			for (const subDoc of [...snapshot.docs]) {
				await deleteDoc(subDoc.ref);
			}
		}
	}

	static readonly _____THING: unique symbol;

	async thing_remember_persistentCreate(thing: Thing) {
		const thingsCollection = this.bulk_forID(thing.idBase)?.thingsCollection;
		if (!!thingsCollection) {
			const remoteThing = new PersistentThing(thing);
			const jsThing = { ...remoteThing };
			this.addedThing = thing;
			this.deferSnapshots = true;
			thing.persistence.awaiting_remoteCreation = true;
			try {
				const ref = await addDoc(thingsCollection, jsThing);
				h.thing_remember_updateID_to(thing, ref.id);
			} catch (error) {
				this.reportError(error);
			}
			thing.persistence.awaiting_remoteCreation = false;
			thing.persistence.already_persisted = true;
			await this.handle_deferredSnapshots();
			thing.log(T_Debug.remote, 'CREATE T');
		}
	}

	async root_default_remember_persistentCreateIn(collectionRef: CollectionReference) {
		const fields = ['title', 'color', 't_thing'];
		const root = new Thing(this.idBase, Identifiable.newID(), this.idBase, 'coral', T_Thing.root, true);
		const rootRef = await addDoc(collectionRef, u.convertToObject(root, fields));		// no need to remember now
		root.log(T_Debug.remote, 'CREATE T');
		h.root = root;
		root.setID(rootRef.id);
	}

	async thing_persistentUpdate(thing: Thing) {
		const thingsCollection = this.bulk_forID(thing.idBase)?.thingsCollection;
		if (!!thingsCollection) {
			const ref = doc(thingsCollection, thing.id) as DocumentReference<Thing>;
			const remoteThing = new PersistentThing(thing);
			const jsThing = { ...remoteThing };
			try {
				await setDoc(ref, jsThing);
				thing.log(T_Debug.remote, 'UPDATE T');
			} catch (error) {
				this.reportError(error);
			}
		}
	}

	async thing_persistentDelete(thing: Thing) {
		const thingsCollection = this.bulk_forID(thing.idBase)?.thingsCollection;
		if (!!thingsCollection) {
			try {
				const ref = doc(thingsCollection, thing.id) as DocumentReference<Thing>;
				await deleteDoc(ref);
				thing.log(T_Debug.remote, 'DELETE T');
			} catch (error) {
				this.reportError(error);
			}
		}
	}

	thing_extractChangesFromPersistent(thing: Thing, from: PersistentThing) {
		const changed = !from.isEqualTo(thing);
		if (changed) {
			thing.title	  = from.virginTitle;
			thing.color	  = from.color;
			thing.t_thing = from.t_thing;
		}
		return changed;
	}

	thing_handle_docChanges(idBase: string, id: string, change: DocumentChange, data: DocumentData): boolean {
		const remoteThing = new PersistentThing(data);
		let thing = h.thing_forHID(id.hash());
		if (!remoteThing) {
			return false;
		} else {
			switch (change.type) {
				case 'added':
					if (!!thing || remoteThing.isEqualTo(this.addedThing) || remoteThing.t_thing == T_Thing.root) {
						return false;			// do not invoke rebuild because nothing has changed
					}
					thing = h.thing_remember_runtimeCreate(idBase, id, remoteThing.title, remoteThing.color, remoteThing.t_thing, true);
					break;
				case 'removed':
					if (!!thing) {
						if (thing.isRoot) {
							thing.set_isDirty();
							return false;			// do not invoke rebuild
						}
						thing.remove_fromGrabbed_andExpanded_andResolveFocus();
						h.thing_forget(thing);
					}
					break;
				case 'modified':
					if (!thing || thing.persistence.wasModifiedWithinMS(800) || !this.thing_extractChangesFromPersistent(thing, remoteThing)) {
						return false;		// do not invoke rebuild
					}
					break;
			}
		}
		return true;
	}

	static readonly _____TRAIT: unique symbol;

	trait_extractChangesFromPersistent(trait: Trait, from: PersistentTrait) {
		const changed = !from.isEqualTo(trait);
		if (changed) {
			trait.t_trait = from.t_trait;
			trait.ownerID = from.ownerID;
			trait.text	  = from.text;
		}
		return changed;
	}

	async trait_persistentDelete(trait: Trait) {
		const traitsCollection = this.bulk_forID(trait.idBase)?.traitsCollection;
		if (!!traitsCollection) {
			try {
				const ref = doc(traitsCollection, trait.id) as DocumentReference<Trait>;
				await deleteDoc(ref);
				trait.log(T_Debug.remote, 'DELETE T');
			} catch (error) {
				this.reportError(error);
			}
		}
	}

	async trait_persistentUpdate(trait: Trait) {
		const traitsCollection = this.bulk_forID(trait.idBase)?.traitsCollection;
		if (!!traitsCollection) {
			const ref = doc(traitsCollection, trait.id) as DocumentReference<Trait>;
			const remoteTrait = new PersistentTrait(trait);
			const jsTrait = { ...remoteTrait };
			try {
				await setDoc(ref, jsTrait);
				trait.log(T_Debug.remote, 'UPDATE T');
			} catch (error) {
				this.reportError(error);
			}
		}
	}

	async trait_remember_persistentCreate(trait: Trait) {
		const traitsCollection = this.bulk_forID(trait.idBase)?.traitsCollection;
		if (!!traitsCollection) {
			const remoteTrait = new PersistentTrait(trait);
			const jsTrait = { ...remoteTrait };
			this.addedTrait = trait;
			try {
				this.deferSnapshots = true;
				trait.persistence.awaiting_remoteCreation = true;
				const ref = await addDoc(traitsCollection, jsTrait)
				trait.persistence.awaiting_remoteCreation = false;
				trait.persistence.already_persisted = true;
				h.trait_forget(trait);
				trait.setID(ref.id);
				h.trait_remember(trait);
				await this.handle_deferredSnapshots();
				trait.log(T_Debug.remote, 'CREATE T');
			} catch (error) {
				this.reportError(error);
			}
		}
	}

	trait_handle_docChanges(idBase: string, id: string, change: DocumentChange, data: DocumentData): boolean {
		const remoteTrait = new PersistentTrait(data);
		if (!remoteTrait) {
			return false;
		} else {
			let trait = h.trait_forHID(id.hash());
			switch (change.type) {
				case 'added':
					if (!!trait || remoteTrait.isEqualTo(this.addedTrait)) {
						return false;		// do not invoke signal because nothing has changed
					}
					trait = h.trait_remember_runtimeCreate(idBase, id, remoteTrait.ownerID, remoteTrait.t_trait, remoteTrait.text, true);
					break;
				case 'removed':
					if (!!trait) {
						h.trait_forget(trait);
					}
					break;
				case 'modified':
					if (!trait || trait.persistence.wasModifiedWithinMS(800) || !this.trait_extractChangesFromPersistent(trait, remoteTrait)) {
						return false;		// do not invoke signal because nothing has changed
					}
					break;
			}
			setTimeout(() => { // wait in case a thing involved in this trait arrives in the data
				h.traits_refreshKnowns();
				g.grand_build();
			}, 20);
		}
		return true;
	}

	static readonly _____TAG: unique symbol;

	tag_extractChangesFromPersistent(tag: Tag, from: PersistentTag) {
		const changed = !from.isEqualTo(tag);
		if (changed) {
			tag.thingHIDs = from.thingHIDs;
			tag.type	  = from.type;
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Test.ts
```ts
import { h, k, T_Thing, T_Trait, Predicate, T_Predicate } from '../common/Global_Imports';
import { T_Persistence } from '../common/Enumerations';
import { DB_Name, T_Database } from './DB_Common';
import DB_Common from './DB_Common';

export default class DB_Test extends DB_Common {
	t_persistence = T_Persistence.none;
	t_database = T_Database.test;
	idBase = DB_Name.test;
	
	get details_forStorage(): Object { return ['data', 'recreated on launch'] }

	async fetch_all_fromLocal(): Promise<boolean> {
		const idTa = 'a';
		const idTb = 'b';
		const idTc = 'c';
		const idTd = 'd';
		const idTe = 'e';
		const idTf = 'f';
		const idTr = 'r';
		const contains = T_Predicate.contains;
		const related = T_Predicate.isRelated;
		h.predicate_defaults_remember_runtimeCreate();
		h.thing_remember_runtimeCreateUnique(this.idBase, idTa, 'Authentic');
		h.thing_remember_runtimeCreateUnique(this.idBase, idTb, 'Brilliant', 'blue');
		h.thing_remember_runtimeCreateUnique(this.idBase, idTc, 'Companionable and Encouraging', '#d96726');
		h.thing_remember_runtimeCreateUnique(this.idBase, idTd, 'Diligent', 'mediumvioletred');
		h.thing_remember_runtimeCreateUnique(this.idBase, idTe, 'Excellence of breathable air', 'purple');
		h.thing_remember_runtimeCreateUnique(this.idBase, idTf, 'Friendly', 'coral');
		h.thing_remember_runtimeCreateUnique(this.idBase, idTr, 'Life', 'limegreen', T_Thing.root);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cra', contains, idTr, idTa, [0, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'crb', contains, idTr, idTb, [1, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'crc', contains, idTr, idTc, [2, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cab', contains, idTa, idTb, [0, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cac', contains, idTa, idTc, [1, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cad', contains, idTa, idTd, [2, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cae', contains, idTa, idTe, [3, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cbc', contains, idTb, idTc, [0, 2]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cbd', contains, idTb, idTd, [1, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cbe', contains, idTb, idTe, [2, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'ccd', contains, idTc, idTd, [0, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cce', contains, idTc, idTe, [1, 2]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'ccf', contains, idTc, idTf, [2, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cbf', contains, idTd, idTf, [3, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cef', contains, idTe, idTf, [0, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'rrb',  related, idTr, idTb, [0, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'rbd',  related, idTb, idTd, [0, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'rac',  related, idTa, idTc, [0, 0]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'raf',  related, idTa, idTf, [0, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'rce',  related, idTc, idTe, [0, 1]);
		h.relationship_remember_runtimeCreateUnique(this.idBase, 'cfd', contains, idTd, idTe, [0, 3]);
		h.trait_remember_runtimeCreateUnique(this.idBase, 'ttc', idTc, T_Trait.text, 'Carrumba Tinga!');
		h.trait_remember_runtimeCreateUnique(this.idBase, 'tlb', idTb, T_Trait.link, 'http://www.webseriously.org');
		h.trait_remember_runtimeCreateUnique(this.idBase, 'ttb', idTb, T_Trait.text, 'What a brilliant idea you have!');
		h.tag_remember_runtimeCreateUnique_forType(this.idBase, 'f', 'Fruity', [idTd.hash(), idTc.hash()]);
		h.tag_remember_runtimeCreateUnique_forType(this.idBase, 'm', 'Moody', [idTf.hash(), idTd.hash(), idTb.hash()]);
		h.tag_remember_runtimeCreateUnique_forType(this.idBase, 's', 'Study', [idTc.hash(), idTe.hash()]);
		// this.makeMore(3, 'c', contains, idTf, true);	// children of Friendly
		this.makeMore(4, 'g', contains, idTb, true, 4);	// children of Brilliant
		this.makeMore(4, 'c', contains, idTb, false);	// parents of  "
		this.makeMore(4, 'e', related, idTb, true, 2);	// related to  "
		this.makeMore(4, 'k', related, idTr, true, 2);	// related to  Root
		return true;
	}

	makeMore(count: number, first: string, kind: T_Predicate, idRef: string, asChild: boolean, order: number = 0) {
		const isBidirectional = Predicate.isBidirectional_for(kind);
		const prefix = isBidirectional ? 'r' : 'c';
		const charCode = first.charCodeAt(0);
		for (let i = 0; i < count; i++) {
			const idCode = String.fromCharCode(charCode + i);
			const id_thing = asChild ? idRef + idCode : idCode + idRef;
			const title = asChild ? idCode : id_thing;
			const idParent = asChild ? idRef : idCode;
			const idChild = asChild ? idCode : idRef;
			const idRelationahip = prefix + id_thing;
			h.thing_remember_runtimeCreateUnique(this.idBase, idCode, title, 'grey');
			h.relationship_remember_runtimeCreateUnique(this.idBase, idRelationahip, kind, idParent, idChild, [i + order, 0]);
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Docs.ts
```ts
import { h, T_Thing, T_Trait, T_Predicate } from '../common/Global_Imports';
import { getDocsStructure, type DocNode } from '../files/Docs';
import { T_Persistence } from '../common/Enumerations';
import { DB_Name, T_Database } from './DB_Common';
import DB_Common from './DB_Common';

export default class DB_Docs extends DB_Common {
	docs_hostname = 'http://docs.webseriously.org/';
	t_persistence = T_Persistence.none;
	t_database = T_Database.docs;
	idBase = 'Docs' as DB_Name;
	
	private thingCounter = 0;
	
	get details_forStorage(): Object { return ['documentation', 'hierarchy'] }

	async fetch_all_fromLocal(): Promise<boolean> {
		// Create root thing for documentation
		const idRoot = 'docs_root';
		h.predicate_defaults_remember_runtimeCreate();
		h.thing_remember_runtimeCreateUnique(
			this.idBase, 
			idRoot, 
			'Documentation', 
			'#4a90e2',
			T_Thing.root
		);

		// Build the hierarchy from imported docs structure
		const docsStructure = getDocsStructure();
		this.buildHierarchy(docsStructure, idRoot, 0);
		h.trait_remember_runtimeCreateUnique(
			this.idBase,
			`trait_link_${idRoot}`,
			idRoot,
			T_Trait.link,
			this.docs_hostname
		);
		return true;
	}

	private buildHierarchy(nodes: DocNode[], parentId: string, depth: number): void {
		let order = 0;

		for (const node of nodes) {
			const nodeId = `${node.type}_${node.id}_${this.thingCounter++}`;

			// Create Thing for this node
			h.thing_remember_runtimeCreateUnique(
				this.idBase,
				nodeId,
				node.name,
				this.getColorForDepth(depth + 1)
			);

			// Add link trait if present (for files or folders with index.md)
			const linkPath = node.type === 'file' ? node.path : node.link;
			if (linkPath) {
				h.trait_remember_runtimeCreateUnique(
					this.idBase,
					`trait_link_${nodeId}`,
					nodeId,
					T_Trait.link,
					`${this.docs_hostname}${linkPath}`
				);
			}

			// Create relationship: parent contains this node
			h.relationship_remember_runtimeCreateUnique(
				this.idBase,
				`rel_${parentId}_${nodeId}`,
				T_Predicate.contains,
				parentId,
				nodeId,
				[order, depth]
			);

			// Recursively process children
			if (node.children && node.children.length > 0) {
				this.buildHierarchy(node.children, nodeId, depth + 1);
			}

			order++;
		}
	}

	private getColorForDepth(depth: number): string {
		const colors = [
			'#4a90e2',  // blue
			'#7b68ee',  // medium slate blue
			'#9370db',  // medium purple
			'#ba55d3',  // medium orchid
			'#da70d6',  // orchid
			'#ee82ee',  // violet
		];
		return colors[depth % colors.length];
	}
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Filesystem.ts
```ts
import { g, h, core, files, T_Thing, T_Trait, T_Predicate, T_Persistence } from '../common/Global_Imports';
import { DB_Name, T_Database } from './DB_Common';
import DB_Common from './DB_Common';

// File System Access API types
interface File_System_Handle {
	kind: 'file' | 'directory';
	name: string;
}

interface File_System_File_Handle extends File_System_Handle {
	kind: 'file';
	getFile(): Promise<File>;
}

interface File_System_Directory_Handle extends File_System_Handle {
	kind: 'directory';
	values(): AsyncIterableIterator<File_System_Handle>;
	requestPermission(descriptor?: { mode?: 'read' | 'readwrite' }): Promise<'granted' | 'denied' | 'prompt'>;
}

interface File_Picker_Options {
	mode?: 'read' | 'readwrite';
}

declare global {
	interface Window {
		showDirectoryPicker(options?: File_Picker_Options): Promise<File_System_Directory_Handle>;
	}
}

interface File_Entry {
	id: string;
	name: string;
	path: string;
	isDirectory: boolean;
	handle: File_System_Handle;
	parentId: string | null;
}

export default class DB_Filesystem extends DB_Common {
	t_persistence = T_Persistence.none;
	t_database = T_Database.filesystem;
	idBase = DB_Name.filesystem;
	
	private rootHandle: File_System_Directory_Handle | null = null;
	private file_information: Map<string, File_Entry> = new Map();
	
	get details_forStorage(): Object { 
		const folderName = this.rootHandle?.name ?? 'none';
		return ['folder', folderName]; 
	}
	
	get hasFolder(): boolean { return this.rootHandle !== null; }
	
	static isSupported(): boolean {
		return 'showDirectoryPicker' in window;
	}

	// Called during db switch - NO picker (no user gesture)
	async fetch_all(): Promise<boolean> {
		if (!DB_Filesystem.isSupported()) {
			console.warn('File System Access API not supported in this browser');
			return false;
		}
		
		// Try to restore previously selected folder
		if (!this.rootHandle) {
			const restored = await files.restore_directoryHandle();
			if (!!restored) {
				this.rootHandle = restored as File_System_Directory_Handle;
			}
		}
		
		// If folder available, scan it
		if (this.rootHandle) {
			return await this.scanFromRoot();
		}
		
		// No folder yet - create empty placeholder state
		h.predicate_defaults_remember_runtimeCreate();
		h.thing_remember_runtimeCreateUnique(
			this.idBase,
			'empty',
			'Click here to browse a folder',
			'blue',
			T_Thing.root
		);
		return true;
	}

	// Called from UI button - HAS user gesture
	async selectFolder(): Promise<boolean> {
		if (!DB_Filesystem.isSupported()) {
			console.warn('File System Access API not supported');
			return false;
		}
		
		try {
			this.rootHandle = await window.showDirectoryPicker({ mode: 'read' });
			await files.save_directoryHandle(this.rootHandle);
			h.forget_all();
			h.rootAncestry = null as any;
			h.root = null as any;
			(h as any).thing_dict_byAncestryHID = {};  // clear cached thing lookups
			const success = await this.scanFromRoot();
			if (success) {
				await h.wrapUp_data_forUX();
				core.w_hierarchy.set(h);
				g.grand_build();
			}
			return success;
		} catch (error) {
			if ((error as Error).name === 'AbortError') {
				console.log('User cancelled folder selection');
			} else {
				console.error('Error selecting folder:', error);
			}
			return false;
		}
	}
	
	private async scanFromRoot(): Promise<boolean> {
		if (!this.rootHandle) return false;
		
		// Clear previous entries
		this.file_information.clear();
		
		// Create predicates
		h.predicate_defaults_remember_runtimeCreate();
		
		// Create root thing for the selected folder
		const rootId = this.generateId(this.rootHandle.name, '');
		h.thing_remember_runtimeCreateUnique(
			this.idBase,
			rootId,
			this.rootHandle.name,
			'limegreen',
			T_Thing.root
		);
		
		this.file_information.set(rootId, {
			id: rootId,
			name: this.rootHandle.name,
			path: '',
			isDirectory: true,
			handle: this.rootHandle,
			parentId: null
		});
		
		// Recursively scan the folder
		await this.scanDirectory(this.rootHandle, rootId, '');
		
		return true;
	}
	
	private async scanDirectory(
		dirHandle: File_System_Directory_Handle,
		parentId: string,
		parentPath: string,
		depth: number = 0
	): Promise<void> {
		if (depth >= 5) return;
		
		let order = 0;
		
		for await (const handle of dirHandle.values()) {
			const path = parentPath ? `${parentPath}/${handle.name}` : handle.name;
			const id = this.generateId(handle.name, path);
			const isDirectory = handle.kind === 'directory';
			
			// Store entry for later access
			this.file_information.set(id, {
				id,
				name: handle.name,
				path,
				isDirectory,
				handle,
				parentId
			});
			
			// Determine color based on type
			const color = isDirectory ? 'steelblue' : this.colorForFile(handle.name);
			const t_thing = isDirectory ? T_Thing.folder : T_Thing.generic;
			
			// Create thing
			h.thing_remember_runtimeCreateUnique(
				this.idBase,
				id,
				handle.name,
				color,
				t_thing
			);
			
			// Create relationship to parent
			const relationshipId = `c_${parentId}_${id}`;
			h.relationship_remember_runtimeCreateUnique(
				this.idBase,
				relationshipId,
				T_Predicate.contains,
				parentId,
				id,
				[order, 0]
			);
			
			// Add link trait only for previewable files
			if (!isDirectory && this.isPreviewable(handle.name)) {
				const traitId = `link_${id}`;
				h.trait_remember_runtimeCreateUnique(
					this.idBase,
					traitId,
					id,
					T_Trait.link,
					path
				);
			}
			
			order++;
			
			// Recurse into directories
			if (isDirectory) {
				await this.scanDirectory(
					handle as File_System_Directory_Handle,
					id,
					path,
					depth + 1
				);
			}
		}
	}
	
	private generateId(name: string, path: string): string {
		// Create a stable ID from the path
		const combined = path || name;
		return combined.replace(/[^a-zA-Z0-9]/g, '_').substring(0, 50);
	}
	
	private colorForFile(filename: string): string {
		const ext = filename.split('.').pop()?.toLowerCase() || '';
		
		// Color by file type
		const colorMap: Record<string, string> = {
			// Documents
			'pdf': '#e74c3c',
			'doc': '#2980b9', 'docx': '#2980b9',
			'txt': '#7f8c8d', 'md': '#7f8c8d',
			// Spreadsheets
			'xls': '#27ae60', 'xlsx': '#27ae60', 'csv': '#27ae60',
			// Images
			'jpg': '#9b59b6', 'jpeg': '#9b59b6', 'png': '#9b59b6', 
			'gif': '#9b59b6', 'svg': '#9b59b6', 'webp': '#9b59b6',
			// Code
			'js': '#f1c40f', 'ts': '#3498db', 'svelte': '#ff3e00',
			'html': '#e67e22', 'css': '#1abc9c', 'json': '#95a5a6',
			// Media
			'mp3': '#e91e63', 'mp4': '#e91e63', 'wav': '#e91e63',
			'mov': '#e91e63', 'avi': '#e91e63',
		};
		
		return colorMap[ext] || 'grey';
	}
	
	// Check if file extension supports preview
	isPreviewable(filename: string): boolean {
		return files.preview_type_forFilename(filename) !== null;
	}
	
	// Get file handle for preview/download
	get_file_handle(thingId: string): File_System_Handle | null {
		return this.file_information.get(thingId)?.handle || null;
	}
	
	// Get file entry info
	get_file_information(thingId: string): File_Entry | null {
		return this.file_information.get(thingId) || null;
	}
	
	// Read file contents (for preview)
	async readFileAsText(thingId: string): Promise<string | null> {
		const entry = this.file_information.get(thingId);
		if (!entry || entry.isDirectory) return null;
		
		try {
			const fileHandle = entry.handle as File_System_File_Handle;
			const file = await fileHandle.getFile();
			return await file.text();
		} catch (error) {
			console.error('Error reading file:', error);
			return null;
		}
	}
	
	// Read file as data URL (for images/media preview)
	async readFileAsDataURL(thingId: string): Promise<string | null> {
		const entry = this.file_information.get(thingId);
		if (!entry || entry.isDirectory) return null;
		
		try {
			const fileHandle = entry.handle as File_System_File_Handle;
			const file = await fileHandle.getFile();
			return new Promise((resolve, reject) => {
				const reader = new FileReader();
				reader.onload = () => resolve(reader.result as string);
				reader.onerror = reject;
				reader.readAsDataURL(file);
			});
		} catch (error) {
			console.error('Error reading file:', error);
			return null;
		}
	}
	
	// Download file
	async downloadFile(thingId: string): Promise<void> {
		const entry = this.file_information.get(thingId);
		if (!entry || entry.isDirectory) return;
		
		try {
			const fileHandle = entry.handle as File_System_File_Handle;
			const file = await fileHandle.getFile();
			
			// Create download link
			const url = URL.createObjectURL(file);
			const a = document.createElement('a');
			a.href = url;
			a.download = entry.name;
			document.body.appendChild(a);
			a.click();
			document.body.removeChild(a);
			URL.revokeObjectURL(url);
		} catch (error) {
			console.error('Error downloading file:', error);
		}
	}
	
	// Copy path to clipboard
	async copyPath(thingId: string): Promise<boolean> {
		const entry = this.file_information.get(thingId);
		if (!entry) return false;
		
		try {
			await navigator.clipboard.writeText(entry.path);
			return true;
		} catch (error) {
			console.error('Error copying path:', error);
			return false;
		}
	}
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Airtable.ts
```ts
import { T_Thing, T_Trait, T_Debug, T_Create, T_Predicate, busy } from '../common/Global_Imports';
import { h, k, u, Thing, Trait, Relationship } from '../common/Global_Imports';
import { T_Persistable } from '../common/Global_Imports';
import { T_Persistence } from '../common/Enumerations';
import { DB_Name, T_Database } from './DB_Common';
import DB_Common from './DB_Common';
import Airtable from 'airtable';

//////////////////////////////
//							//
//		users				//
//		things				//
//		access				//
//		predicates			//
//		relationships		//
//							//
//////////////////////////////

export default class DB_Airtable extends DB_Common {
	personalAccessToken = 'patGTiWbebGZTw0fh.dd17a194aea98f9e4e918d333babde7bcd39903b4179b139ac8866a5f3cfe5b6';
	tryPersonalAccessToken = 'patHLy6SzBPcbjtCM.c032a929620e4c2906a59bec5c6aa955c1cac78875ca8f5d5398ae1ee058ebc8';
	basePivot = new Airtable({ apiKey: this.personalAccessToken }).base('appopcsTBwET2o3RU');
	baseCatalist = new Airtable({ apiKey: this.personalAccessToken }).base('apphGUCbYIEJLvRrR');
	basePublic = new Airtable({ apiKey: this.personalAccessToken }).base('appq1IjzmiRdlZi3H');
	baseWendy = new Airtable({ apiKey: this.personalAccessToken }).base('appuDpzaPN3at9jRL');
	base = this.basePublic;
	relationships_table = this.base(T_Persistable.relationships);
	predicates_table = this.base(T_Persistable.predicates);
	things_table = this.base(T_Persistable.things);
	traits_table = this.base(T_Persistable.traits);
	access_table = this.base(T_Persistable.access);
	users_table = this.base(T_Persistable.users);
	t_persistence = T_Persistence.remote;
	t_database = T_Database.airtable;
	idBase = DB_Name.airtable;

	relationships_errorMessage = 'Error in Relationships:';
	async hierarchy_fetch_forID(idBase: string) {}
	things_errorMessage = 'Error in Things:';
	traits_errorMessage = 'Error in Traits:';

	// async remove_all() {}	// only remove json from localStorage

	async fetch_all(): Promise<boolean> {
		await busy.temporarily_set_isFetching_while(async () => {
			await this.things_fetch_all();
			await this.traits_fetch_all();
			await this.predicates_fetch_all();
			await this.relationships_fetch_all();
			await this.access_fetch_all();
			await this.users_fetch_all();
		});
		return true;
	}

	apply_queryStrings(queryStrings: URLSearchParams) {
		const string = queryStrings.get('name') ?? queryStrings.get('dbid');
		if (!!string) {
			const names = string.split(k.comma);
			if (names.length > 1) {
				const tableID = names[0]
				this.personalAccessToken = names[1];
				this.base = new Airtable({ apiKey: this.personalAccessToken }).base(tableID);
				this.relationships_table = this.base(T_Persistable.relationships);
				this.predicates_table = this.base(T_Persistable.predicates);
				this.things_table = this.base(T_Persistable.things);
				this.access_table = this.base(T_Persistable.access);
				this.users_table = this.base(T_Persistable.users);
			}
		}
	}

	//////////////////////////////
	//			THINGS			//
	//////////////////////////////

	async things_fetch_all() {
		h.things_forget_all(); // clear

		try {
			const select = this.things_table.select();
			const remoteThings = await select.all()
			for (const remoteThing of [...remoteThings]) {
				const id = remoteThing.id;
				const fields = remoteThing.fields;
				h.thing_remember_runtimeCreate(DB_Name.airtable, id, fields.title as string, fields.color as string, (fields.type as T_Thing) ?? fields.trait as string, true, !fields.type);
			}
		} catch (error) {
			alert(this.things_errorMessage + ' (things_fetch_all) ' + error);
		}
	}

	static readonly _____THING: unique symbol;
	
	async thing_remember_persistentCreate(thing: Thing) {
		try {
			const dict = await this.things_table.create(thing.fields);
			thing.persistence.already_persisted = true;		// was saved by create (the line above)
			thing.persistence.awaiting_remoteCreation = false;
			h.thing_remember_updateID_to(thing, dict['id']);
		} catch (error) {
			thing.log(T_Debug.remote, this.things_errorMessage + error);
		}
	}

	async thing_persistentUpdate(thing: Thing) {
		try {
			await this.things_table.update(thing.id, thing.fields);
		} catch (error) {
			thing.log(T_Debug.remote, this.things_errorMessage + error);
		}
	}

	async thing_persistentDelete(thing: Thing) {
		try {
			await this.things_table.destroy(thing.id);
		} catch (error) {
			thing.log(T_Debug.remote, this.things_errorMessage + error);
		}
	}

	static readonly _____TRAIT: unique symbol;

	//////////////////////////////
	//			TRAITS			//
	//////////////////////////////

	async traits_fetch_all() {
		h.traits_forget_all();
		try {
			const records = await this.traits_table.select().all()

			for (const record of [...records]) {
				const id = record.id as string;
				const text = record.fields.text as string;
				const type = record.fields.type as T_Trait;
				const ownerIDs = record.fields.ownerID as (string[]);
				h.trait_remember_runtimeCreateUnique(DB_Name.airtable, id, ownerIDs[0], type, text, true);
			}
		} catch (error) {
			alert(this.traits_errorMessage + error);
		}
	}

	async trait_persistentUpdate(trait: Trait) {
		try {
			await this.traits_table.update(trait.id, trait.fields);
		} catch (error) {
			trait.log(T_Debug.remote, this.traits_errorMessage + error);
		}
	}

	async trait_persistentDelete(trait: Trait) {
		try {
			await this.traits_table.destroy(trait.id);
		} catch (error) {
			trait.log(T_Debug.remote, this.traits_errorMessage + error);
		}
	}

	async trait_remember_persistentCreate(trait: Trait) {
		try {
			const fields = await this.traits_table.create(trait.fields);
			const id = fields['id'];	//	// need for update, delete and traits_byHID (to get parent from relationship)
			trait.setID(id);
			trait.persistence.already_persisted = true;
			h.trait_remember(trait);
		} catch (error) {
			trait.log(T_Debug.remote, this.traits_errorMessage + error);
		}
	}

	static readonly _____RELATIONSHIPS: unique symbol;

	async relationships_fetch_all() {
		h.relationships_forget_all();
		try {
			const records = await this.relationships_table.select().all()

			for (const record of [...records]) {
				const id = record.id as string;
				const order = record.fields.order as number;
				const parents = record.fields.parent as (string[]);
				const children = record.fields.child as (string[]);
				const kind = record.fields.kindPredicate as T_Predicate;
				h.relationship_remember_runtimeCreateUnique(DB_Name.airtable, id, kind, parents[0], children[0], [order, 0], T_Create.isFromPersistent);
			}
		} catch (error) {
			alert(this.relationships_errorMessage + error);
		}
	}

	static readonly _____RELATIONSHIP: unique symbol;

	async relationship_remember_persistentCreate(relationship: Relationship) {
		if (!!relationship && !relationship.persistence.already_persisted) {
			try {
				const fields = await this.relationships_table.create(relationship.fields);	// insert with temporary id
				const id = fields['id'];																										// grab permanent id
				relationship.setID(id);
				relationship.persistence.already_persisted = true;
				h.relationships_refreshKnowns();
			} catch (error) {
				relationship.log(T_Debug.remote, this.relationships_errorMessage + error);
			}
		}
	}

	async relationship_persistentUpdate(relationship: Relationship) {
		this.relationships_table.update(relationship.id, relationship.fields);
	}

	async relationship_persistentDelete(relationship: Relationship) {
		try {
			h.relationships = u.strip_invalid_Identifiables(h.relationships) as Array<Relationship>;
			h.relationships_refreshKnowns(); // do first so UX updates quickly
			await this.relationships_table.destroy(relationship.id);
		} catch (error) {
			relationship.log(T_Debug.remote, this.relationships_errorMessage + error);
		}
	}

	static readonly _____ANCILLARY: unique symbol;

	async predicates_fetch_all() {
		try {
			const records = await this.predicates_table.select().all()

			for (const record of [...records]) {
				const fields = record.fields;
				const id = record.id as string; // do not yet need this
				const kind = fields.kind as T_Predicate;
				const isBidirectional = fields.isBidirectional as boolean ?? false;
				h.predicate_remember_runtimeCreate(id, kind, isBidirectional);
			}

		} catch (error) {
			alert('Error in Predicates:' + error);
		}
	}

	async access_fetch_all() {
		try {
			const records = await this.access_table.select().all()
			for (const record of [...records]) {
				const id = record.id as string; // do not yet need this
				const kind = record.fields.kind as string;
				h.access_runtimeCreate(id, kind);
			}

		} catch (error) {
			alert('Error in Access:' + error);
		}
	}

	async users_fetch_all() {
		try {
			const records = await this.users_table.select().all()

			for (const record of [...records]) {
				const id = record.id as string; // do not yet need this
				h.user_runtimeCreate(id, record.fields.name as string, record.fields.email as string, record.fields.phone as string);
			}

		} catch (error) {
			alert('Error in Users:' + error);
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Bubble.ts
```ts
import { T_Thing, T_Graph, T_Create, T_Predicate, Ancestry, Hierarchy } from '../common/Global_Imports';
import { g, h, k, p, x, busy, show, debug, features } from '../common/Global_Imports';
import { T_Preference } from '../common/Global_Imports';
import { T_Persistence } from '../common/Enumerations';
import { DB_Name, T_Database } from './DB_Common';
import DB_Common from './DB_Common';
import { get } from 'svelte/store';

enum T_MID {	// type of message or identifier
	details,
	focus,
	grab,
	mode,
}

export default class DB_Bubble extends DB_Common {
	allow_response_to: boolean[] = [false, false, false, false];
	prior_id: string[] = [k.empty, k.empty];
	t_persistence = T_Persistence.remote;
	prior_grabbed_ids: string[] = [];
	t_database = T_Database.bubble;
	idBase = DB_Name.bubble;
	replace_hierarchy = false;
	will_send_events = false;
	invoke_wrapUp = true;

	async fetch_all() {
		await busy.temporarily_set_isFetching_while(async () => {
			window.addEventListener('message', this.handle_bubble_message);		// first prepare listener
			window.parent.postMessage({ type: 'listening' }, k.wildcard);		// tell bubble that we're listening
		});
		return false;
	}

	private handle_bubble_message = (e: Event) => {
		const event = e as MessageEvent;
		const properties_string = event.data.properties;
		if (!properties_string || properties_string.length == 0) {
			h.wrapUp_data_forUX();
		} else {
			const type = event.data.type;
			const bubble_properties = JSON.parse(properties_string);
			debug.log_bubble(type);
			switch (type) {
				case 'CHANGE_FOCUS':
					this.changeFocusTo(bubble_properties.id);
					break;
				case 'CHANGE_GRAB':
					this.changeGrabTo(bubble_properties.id);
					break;
				case 'CHANGE_GRAPH_MODE':
					show.w_t_graph.set(bubble_properties.in_radial_mode ? T_Graph.radial : T_Graph.tree);
					break;
				case 'REPLACE_HIERARCHY':
					this.replace_hierarchy = true;		// N.B. must happen BEFORE next UPDATE_PROPERTIES
					break;
				case 'UPDATE_PROPERTIES':
					if (this.replace_hierarchy) {
						this.replace_hierarchy = false;
						this.hierarchy = new Hierarchy(this);
					}
					this.extract_fromProperties(bubble_properties);
					break;
			}
			this.setup_to_send_events();
			p.writeDB_key(T_Preference.bubble, true);
		}
	}

	private createRelationship(parent_id: string, child_id: string, kind: T_Predicate, orders: Array<number>) {
		if (!!parent_id && !!child_id && parent_id != k.empty && parent_id != k.empty_id && child_id != k.empty && child_id != k.empty_id) {
			const id = parent_id + '-->' + kind + '-->' + child_id;
			h.relationship_remember_runtimeCreateUnique(h.db.idBase, id, kind, parent_id, child_id, orders, T_Create.isFromPersistent);
		}
	}

	private createThing(id: string, title: string, color: string, type: T_Thing) {
		if (id != null && title != null && color != null && type != null) {
			if (color == k.empty) {
				h.thing_remember_runtimeCreateUnique(h.db.idBase, id, title);
			} else {
				h.thing_remember_runtimeCreateUnique(h.db.idBase, id, title, color, type);
			}
		}
	}

	private changeGrabTo(id: string) {
		if (!!id) {
			const grab = h.thing_forHID(id.hash())?.ancestry;
			if (!!grab) {
				grab.grabOnly();
				grab.parentAncestry?.expand();
				grab.ancestry_assureIsVisible();
			}
		}
	}
	private changeFocusTo(id: string) {
		if (!!id) {
			const focus = h.thing_forHID(id.hash())?.ancestry;
			if (!!focus) {
				busy.temporarily_disable_focus_event_while(() => {
					focus.becomeFocus();
				});
			}
		}
	}

	private extract_fromProperties(bubble_properties: any) {
		let b_zoom_scale, b_depth_limit, b_inRadialMode, b_show_details,
			b_ids, b_root, b_focus, b_titles, b_colors, b_parent_ids, b_related_ids,
			b_override_focus_and_mode, b_override_zoom_scale, b_override_depth_limit, 
			b_erase_user_preferences, b_suppress_tree_mode;
		try {
			const has_bubble = p.readDB_key(T_Preference.bubble) ?? false; // true after first launch
			b_override_focus_and_mode = bubble_properties.override_focus_and_mode || !has_bubble;
			b_override_depth_limit = bubble_properties.override_depth_limit || !has_bubble;
			b_override_zoom_scale = bubble_properties.override_zoom_scale || !has_bubble;
			b_erase_user_preferences = bubble_properties.erase_user_preferences;
			b_suppress_tree_mode = bubble_properties.suppress_tree_mode;
			b_inRadialMode = bubble_properties.in_radial_mode;
			b_show_details = bubble_properties.show_details;
			b_depth_limit = bubble_properties.depth_limit;
			b_zoom_scale = bubble_properties.zoom_scale;
			b_related_ids = bubble_properties.related;
			b_parent_ids = bubble_properties.parents;
			b_colors = bubble_properties.colors;
			b_titles = bubble_properties.titles;
			b_focus = bubble_properties.focus;
			b_root = bubble_properties.root;
			b_ids = bubble_properties.ids;
		} catch (err) {
			console.warn('[DB_Bubble] Could not parse bubble_properties:', err);
		}
		h.predicate_defaults_remember_runtimeCreate();
		if (!!b_ids && !!b_titles && !!b_colors && !!b_parent_ids && !!b_related_ids) {
			for (let i = 0; i < b_titles.length; i++) {
				const related_ids = b_related_ids[i].split(k.separator.generic);
				const parent_ids = b_parent_ids[i].split(k.separator.generic);
				const remove_these = new RegExp(`[${k.space}${k.quote}]`, 'g');
				const title = b_titles[i];
				const color = b_colors[i];
				const id = b_ids[i];
				const type = (id == b_root) ? T_Thing.root : T_Thing.generic;
				this.createThing(id, title, color, type);
				if (!!parent_ids && parent_ids.length > 0) {
					for (let parent_id of [...parent_ids]) {
						parent_id = parent_id.replaceAll(remove_these, '');
						this.createRelationship(parent_id, id, T_Predicate.contains, [1, 1]);
					}
				}
				if (!!related_ids && related_ids.length > 0) {
					for (let related_id of [...related_ids]) {
						related_id = related_id.replaceAll(remove_these, '');
						this.createRelationship(id, related_id, T_Predicate.isRelated, [1, 1]);
					}
				}
			}
		}
		if (!!b_root) {
			const root = h.thing_forHID(b_root.hash());
			if (!!root) {
				root.t_thing = T_Thing.root;
				h.root = root;
			}
		}
		if (this.invoke_wrapUp) {
			this.invoke_wrapUp = false;
			h.wrapUp_data_forUX(); // create ancestries and tidy up
		} else {
			h.ancestries_assureAll_createUnique();
			busy.signal_data_redraw();
		}
		if (!!b_override_depth_limit) {
			g.w_depth_limit.set(b_depth_limit);
		}
		if (!!b_override_zoom_scale) {
			g.w_scale_factor.set(b_zoom_scale);
		}
		if (!!b_suppress_tree_mode) {
			features.allow_tree_mode = false;
			show.w_t_graph.set(T_Graph.radial);
		}
		if (!!b_override_focus_and_mode) {
			if (!b_suppress_tree_mode) {
				show.w_t_graph.set(b_inRadialMode ? T_Graph.radial : T_Graph.tree);
			}
			if (!!b_focus) {
				this.changeFocusTo(b_focus);
			}
		}
		show.w_show_details.set(!!b_show_details);
	}

	private setup_to_send_events() {

		//////////////////////////////////////////////////////////
		//														//
		//	 	message types to send to bubble plugin			//
		//   see handle_webseriously_message in initialize.js	//
		//														//
		//	  debounce: only send if changed from prior value	//
		//														//
		//////////////////////////////////////////////////////////

		if (!this.will_send_events) {
			this.will_send_events = true;
			window.parent.postMessage({ type: 'trigger_an_event', trigger: 'ready' }, k.wildcard);
			show.w_t_graph.subscribe((graph_type: T_Graph) => {
				if (this.allow_response_to[T_MID.mode]) {
					window.parent.postMessage({ type: 'in_radial_mode', in_radial_mode: graph_type == T_Graph.radial }, k.wildcard);
					window.parent.postMessage({ type: 'trigger_an_event', trigger: 'mode_changed' }, k.wildcard);
				}
				this.allow_response_to[T_MID.mode] = true;
			});
			x.w_ancestry_focus.subscribe((ancestry: Ancestry | null) => {
				const focus_id = ancestry?.thing?.id ?? k.empty;
				if (!!focus_id && focus_id != this.prior_id[T_MID.focus] && busy.isFocusEventEnabled) {
					if (this.allow_response_to[T_MID.focus]) {
						this.prior_id[T_MID.focus] = focus_id;
						window.parent.postMessage({ type: 'focus_id', id: focus_id }, k.wildcard);
						window.parent.postMessage({ type: 'trigger_an_event', trigger: 'focus_changed' }, k.wildcard);			// post state first
					}
					this.allow_response_to[T_MID.focus] = true;
				}
			});
			show.w_show_catalist_details.subscribe((inform_bubble: boolean) => {
				if (!!inform_bubble) {
					show.w_show_catalist_details.set(false);
					const ancestries = get(x.w_grabs) as Array<Ancestry>;
					const grabbed_ids = ancestries.map((ancestry: Ancestry) => ancestry.thing?.id ?? k.empty);
					if (!!ancestries && grabbed_ids.join(', ') != this.prior_grabbed_ids.join(', ')) {
						if (this.allow_response_to[T_MID.grab]) {
							this.prior_grabbed_ids = grabbed_ids;
							window.parent.postMessage({ type: 'selected_ids', ids: grabbed_ids }, k.wildcard);
							window.parent.postMessage({ type: 'trigger_an_event', trigger: 'selection_changed' }, k.wildcard);
						}
						this.allow_response_to[T_MID.grab] = true;
					}
				}
			});
			x.w_grabs.subscribe((ancestries: Array<Ancestry>) => {
				const grabbed_ids = ancestries.map((ancestry: Ancestry) => ancestry.thing?.id ?? k.empty);
				if (!!ancestries && grabbed_ids.join(', ') != this.prior_grabbed_ids.join(', ')) {
					if (this.allow_response_to[T_MID.grab]) {
						this.prior_grabbed_ids = grabbed_ids;
						window.parent.postMessage({ type: 'selected_ids', ids: grabbed_ids }, k.wildcard);
						window.parent.postMessage({ type: 'trigger_an_event', trigger: 'selection_changed' }, k.wildcard);
					}
					this.allow_response_to[T_MID.grab] = true;
				}
			});
			x.w_ancestry_forDetails.subscribe((ancestry: Ancestry | null) => {
				const details_id = ancestry?.thing?.id ?? k.empty;
				if (!!details_id && details_id != this.prior_id[T_MID.details]) {
					if (this.allow_response_to[T_MID.details]) {
						this.prior_id[T_MID.details] = details_id;
						window.parent.postMessage({ type: 'details_id', id: details_id }, k.wildcard);
						window.parent.postMessage({ type: 'trigger_an_event', trigger: 'details_changed' }, k.wildcard);
					}
					this.allow_response_to[T_MID.details] = true;
				}
			});
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/Databases.ts
```ts
import { k, p, core, busy, Hierarchy, T_Preference } from '../common/Global_Imports';
import { T_Persistence } from '../common/Enumerations';
import { T_Database } from '../database/DB_Common';
import type { Dictionary } from '../types/Types';
import DB_Common from '../database/DB_Common';
import { writable } from 'svelte/store';
import DB_Firebase from './DB_Firebase';
import DB_Airtable from './DB_Airtable';
import DB_Bubble from './DB_Bubble';
import DB_Local from './DB_Local';
import DB_Test from './DB_Test';
import DB_Docs from './DB_Docs';
import DB_Filesystem from './DB_Filesystem';
// import DB_DGraph from './DB_DGraph';

// each db has its own hierarchy
// when switching to another db
// w_hierarchy is set to its hierarchy

export default class Databases {
	private dbCache: Dictionary<DB_Common> = {};
	w_data_updated = writable<number>();
	w_t_database   = writable<string>();
	defer_persistence: boolean = false;
	db_now: DB_Common;

	apply_queryStrings(queryStrings: URLSearchParams) {
		let type = queryStrings.get('db');
		if (!!type) {
			this.db_now = this.db_forType(type);
		} else {
			type = p.read_key(T_Preference.db) ?? T_Database.firebase;
			if (type == 'firebase') { type = T_Database.firebase; }
			if (type == 'file') { type = T_Database.local; }
		}
		this.w_t_database.set(type!);
	}

	constructor() {
		let done = false;
		this.db_now = this.db_forType(T_Database.firebase);
		this.w_t_database.subscribe((type: string) => {
			if (!!type && (!done || (type && this.db_now.t_database != type))) {
				done = true;
				setTimeout( async () => {	// wait for hierarchy to be created
					await this.grand_change_database(type);
				}, 10);
			}
		});
	}

	async grand_change_database(type: string) {
		const db = this.db_forType(type);
		if (!!db) {
			this.db_now = db;
			let h = db.hierarchy;
			if (!h) {
				h = new Hierarchy(db);
				db.hierarchy = h;
			}
			p.write_key(T_Preference.db, type);
			core.w_hierarchy.set(h);
			this.w_t_database.set(type);
			await db.hierarchy_setup_fetch_andBuild();
			busy.signal_data_redraw();
		}
	}

	db_change_toNext(forward: boolean) { this.w_t_database.set(this.db_next_get(forward)); }
	isRemote(t_persistence: T_Persistence): boolean { return t_persistence == T_Persistence.remote; }
	isPersistent(t_persistence: T_Persistence): boolean { return t_persistence != T_Persistence.none; }

	db_next_get(forward: boolean): T_Database {
		switch (this.db_now.t_database) {
			case T_Database.local:      return forward ? T_Database.firebase   : T_Database.filesystem;
			case T_Database.firebase:   return forward ? T_Database.airtable   : T_Database.local;
			case T_Database.airtable:   return forward ? T_Database.dgraph     : T_Database.firebase;
			case T_Database.dgraph:     return forward ? T_Database.test       : T_Database.airtable;
			case T_Database.test:       return forward ? T_Database.docs       : T_Database.dgraph;
			case T_Database.docs:       return forward ? T_Database.filesystem : T_Database.test;
			case T_Database.filesystem: return forward ? T_Database.local      : T_Database.docs;
			default:                    return forward ? T_Database.local      : T_Database.test;
		}
	}

	db_forType(t_database: string): DB_Common {
		if (!this.dbCache[t_database]) {
			switch (t_database) {
				case T_Database.firebase: this.dbCache[t_database] = new DB_Firebase(); break;
				case T_Database.airtable: this.dbCache[t_database] = new DB_Airtable(); break;
				case T_Database.bubble:   this.dbCache[t_database] = new DB_Bubble(); break;
				case T_Database.local:    this.dbCache[t_database] = new DB_Local(); break;
				case T_Database.test:     this.dbCache[t_database] = new DB_Test(); break;
				case T_Database.docs:       this.dbCache[t_database] = new DB_Docs(); break;
				case T_Database.filesystem: this.dbCache[t_database] = new DB_Filesystem(); break;
				// default:   this.dbCache[t_database] = new DB_DGraph(); break;
			}
		}
		return this.dbCache[t_database];
	}

	get startupExplanation(): string {
		const type = this.db_now.t_database;
		let from = k.empty;
		switch (type) {
			case T_Database.firebase: from = `, from ${this.db_now.idBase}`; break;
			case T_Database.test:	  return k.empty;
		}
		return `(loading your ${type} data${from})`;
	}

}

export const databases = new Databases();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Common.ts
```ts
import { Tag, Trait, Thing, Hierarchy, Predicate, Relationship, Persistable } from '../common/Global_Imports';
import { c, h, p, x, busy, core, debug, features, databases } from '../common/Global_Imports';
import { T_Thing, T_Startup, T_Persistable } from '../common/Global_Imports';
import { T_Persistence } from '../common/Enumerations';
import type { Dictionary } from '../types/Types';

export enum T_Database {
	filesystem = 'filesystem',
	firebase   = 'firebase',
	airtable   = 'airtable',
	unknown	   = 'unknown',
	bubble	   = 'bubble',
	dgraph     = 'dgraph',
	local	   = 'local',
	test	   = 'test',
	docs       = 'docs',
}

export enum	DB_Name {
	filesystem = 'Filesystem',
	airtable   = 'Airtable',
	unknown    = 'Unknown',
	firebase   = 'Public',
	bubble     = 'Bubble',
	dgraph     = 'DGraph',
	bulks      = 'Bulks',
	local      = 'Local',
	test       = 'Test',
	docs       = 'Docs',
}

// CRUD API --> for all databases

export default class DB_Common {
	t_persistence = T_Persistence.none;
	t_database = T_Database.unknown;
	idBase = DB_Name.unknown;
	hierarchy!: Hierarchy;
	load_time = 'busy...';
	load_start_time = -1;
	
	setup_remote_handlers() {}
	apply_queryStrings(queryStrings: URLSearchParams) {}
	get displayName(): string { return this.t_database; }
	get details_forStorage(): Object { return ['fetch', this.load_time]; }
	get isStandalone(): boolean { return this.t_database != T_Database.bubble; }
	get isRemote(): boolean { return this.t_persistence == T_Persistence.remote; }
	get isPersistent(): boolean { return this.t_persistence != T_Persistence.none; }
	async hierarchy_fetch_forID(idBase: string) {}	// support for browsing multiple firebase bulks
	
	async fetch_all(): Promise<boolean> { return this.fetch_all_fromLocal(); }
	async remove_all() { this.remove_all_fromLocal(); }

	async thing_becomeFocus(thing: Thing) {}
	async thing_persistentUpdate(thing: Thing) { this.persist_all(); }
	async thing_persistentDelete(thing: Thing) { this.persist_all(); }
	async thing_remember_persistentCreate(thing: Thing) { h.thing_remember(thing); this.persist_all(); }
	
	async predicate_persistentUpdate(predicate: Predicate) { this.persist_all(); }
	async predicate_persistentDelete(predicate: Predicate) { this.persist_all(); }
	async predicate_remember_persistentCreate(predicate: Predicate) { h.predicate_remember(predicate); this.persist_all(); }

	async relationship_persistentUpdate(relationship: Relationship) { this.persist_all(); }
	async relationship_persistentDelete(relationship: Relationship) { this.persist_all(); }
	async relationship_remember_persistentCreate(relationship: Relationship) { h.relationship_remember_ifValid(relationship); this.persist_all(); }

	async trait_persistentUpdate(trait: Trait) { this.persist_all(); }
	async trait_persistentDelete(trait: Trait) { this.persist_all(); }
	async trait_remember_persistentCreate(trait: Trait) { h.trait_remember(trait); this.persist_all(); }

	async tag_persistentUpdate(tag: Tag) { this.persist_all(); }
	async tag_persistentDelete(tag: Tag) { this.persist_all(); }
	async tag_remember_persistentCreate(tag: Tag) { h.tag_remember(tag); this.persist_all(); }
	
	remove_all_fromLocal() {
		if (this.isPersistent) {
			for (const t_persistable of Persistable.t_persistables) {
				p.writeDB_key(t_persistable.toLowerCase(), null);
			}
		}
	}

	async persist_all(force: boolean = false) {
		if (!force && (databases.defer_persistence || !features.allow_autoSave)) {
			busy.signal_data_redraw();
		} else {
			busy.isPersisting = true;
			busy.signal_data_redraw();
			for (const t_persistable of Persistable.t_persistables) {
				await this.persistAll_identifiables_ofType_maybe(t_persistable, force);
			}
			if (this.t_database != T_Database.airtable) {
				busy.isPersisting = false;
				busy.signal_data_redraw();
			} else {
				// kludge to wait for airtable to catch up
				let interval = setInterval(() => {
					if (!h.isDirty) {
						busy.isPersisting = false;
						busy.signal_data_redraw();
						clearInterval(interval);
					}
				}, 100);
			}
		}
	}

	// code common to all persisting actions
	async persistAll_identifiables_ofType_maybe(t_persistable: T_Persistable, force: boolean = false) {
		const identifiables = h.persistables_forKey(t_persistable);
		if (this.isRemote) {				// db firebase and airtable, both are persistent
			for (const identifiable of identifiables) {
				if (identifiable.persistence.isDirty || force) {
					await identifiable.persist();
					identifiable.set_isDirty(false);
				}
			}
		} else if (this.isPersistent) {		// db local only, db test is not persistent
			p.writeDB_key(t_persistable.toLowerCase(), identifiables);
			for (const identifiable of identifiables) {
				identifiable.set_isDirty(false);
			}
		}
	}

	async fetch_all_fromLocal(): Promise<boolean> {
		await busy.temporarily_set_isFetching_while(async () => {
			for (const t_persistable of Persistable.t_persistables) {
				const array = p.readDB_key(t_persistable.toLowerCase()) as Array<Dictionary>;
				if (!!array) {
					for (const dict of array) {
						h.extract_objects_ofType_fromDict(t_persistable, dict);
					}
				} else if (!this.isRemote && this.isStandalone) {			// no such persistable, create empty hierarchy
					switch (t_persistable) {
						case T_Persistable.predicates:
							h.predicate_defaults_remember_runtimeCreate();
							break;
						case T_Persistable.things:
							h.thing_remember_runtimeCreateUnique(this.idBase, Thing.newID(), 'click here to edit this title', 'limegreen', T_Thing.root);
							break;
					}
				}
			}
		});
		return true;
	}

	async hierarchy_setup_fetch_andBuild() {
		this.apply_queryStrings(c.queryStrings);
		if (!h) {
			core.w_hierarchy.set(new Hierarchy(this));
		}
		core.w_t_startup.set(T_Startup.fetch);
		if (!h.hasRoot) {
			await this.hierarchy_create_fastLoad_or_fetch_andBuild();
		} else {
			h.ancestries_assureAll_createUnique();
			h.restore_fromPreferences();
			core.w_t_startup.set(T_Startup.ready);		// so search will refresh its index
			x.setup_subscriptions();
		}
	}
	
	async hierarchy_create_fastLoad_or_fetch_andBuild() {
		if (c.eraseDB > 0) {
			c.eraseDB -= 1;
			await this.remove_all();	// start fresh
		}
		h.forget_all();
		if (debug.fast_load) {
			await this.fetch_all_fromLocal();	// needs to set needs save && adjust ids during save
			if (h.hasRoot) {
				if (!this.isRemote) {
					await h.wrapUp_data_forUX();
				} else {
					this.setup_remote_handlers();
					await this.persist_all();
				}
				return;
			}
		}
		this.load_start_time = new Date().getTime();
		this.load_time = 'busy...';
		if (await this.fetch_all()) {
			await h.wrapUp_data_forUX();
		}
	}
	
	update_load_time() {
		const startTime = this.load_start_time;
		if (startTime != -1) {
			this.load_start_time = -1;
			const duration = (new Date().getTime()) - startTime;
			if (Math.abs(duration) > 100) {
				const adjusted = Math.trunc(duration / 100) / 10;
				const isInteger = adjusted == Math.trunc(adjusted);
				const suffix = (isInteger && (adjusted == 1)) ? '' : 's';
				const places = isInteger ? 0 : 1;
				const time = (duration / 1000).toFixed(places);
				this.load_time = `took ${time} second${suffix}`;
			} else if (h.hasRoot) {
				this.load_time = 'instantaneous';
			} else {
				this.load_time = 'incomplete';
			}
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/database/DB_Local.ts
```ts
import { T_Persistence } from '../common/Enumerations';
import { k } from '../common/Global_Imports';
import { DB_Name, T_Database } from './DB_Common';
import DB_Common from './DB_Common';

export default class DB_Local extends DB_Common {
	t_persistence = T_Persistence.local;
	t_database = T_Database.local;
	idBase = DB_Name.local;
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/types/Coordinates.ts
```ts
import { T_Quadrant, T_Orientation } from './Angle';
import type { SvelteComponent } from 'svelte';
import type { BBox } from 'rbush';
import Angle from './Angle';

const p = 2;

export class Polar {
	r: number;
	phi: number;
	constructor(r: number, phi: number) {
		this.r = r;
		this.phi = phi;
	}

	get asPoint(): Point { return Point.fromPolar(this.r, this.phi); }
}

export class Point {
	x: number;
	y: number;
	constructor(x: number = 0, y: number = 0) {
		this.x = x;
		this.y = y;
	}

	get magnitude():				 		 number { return Math.sqrt(this.x * this.x + this.y * this.y); }
	get isZero():					 		boolean { return this.x == 0 && this.y == 0; }
	get pixelVerbose():				 		 string { return `${this.x.toFixed(p)}px ${this.y.toFixed(p)}px`; }
	get verbose():					 		 string { return `(${this.x.toFixed(p)}, ${this.y.toFixed(p)})`; }
	get description():				 		 string { return `${this.x.toFixed(p)} ${this.y.toFixed(p)}`; }
	get asBBox():							   BBox { return { minX: this.x, minY: this.y, maxX: this.x, maxY: this.y }; }
	get asPolar():							  Polar { return new Polar(this.magnitude, this.angle); }
	get asSize():					 	 	   Size { return new Size(this.x, this.y); }		// NB: can have negative values, so rect extended by negative works
	get negated():					 		  Point { return this.multipliedEquallyBy(-1); }
	get doubled():					 		  Point { return this.multipliedEquallyBy(2); }
	get negatedInHalf():			 		  Point { return this.dividedEquallyBy(-2); }
	get dividedInHalf():			 		  Point { return this.dividedEquallyBy(2); }
	get swap():						 		  Point { return new Point(this.y, this.x); }
	get negateY():					 		  Point { return new Point(this.x, -this.y); }
	get negateX():					 		  Point { return new Point(-this.x, this.y); }
	get abs():						 		  Point { return new Point(Math.abs(this.x), Math.abs(this.y)); }
	offsetByX(x: number):			 		  Point { return this.offsetByXY(x, 0); }
	offsetByY(y: number):			 		  Point { return this.offsetByXY(0, y); }
	offsetEquallyBy(offset: number): 		  Point { return this.offsetByXY(offset, offset); }
	offsetByXY(x: number, y: number):		  Point { return new Point(this.x + x, this.y + y); }
	spreadByXY(x: number, y: number):		  Point { return new Point(this.x * x, this.y * y); }
	offsetBy(point: Point):			 		  Point { return new Point(this.x + point.x, this.y + point.y); }
	vector_to(point: Point):		 		  Point { return point.offsetBy(this.negated); }
	multiply_xBy(multiplier: number):		  Point { return new Point(this.x * multiplier, this.y) }
	multiply_yBy(multiplier: number):		  Point { return new Point(this.x, this.y * multiplier) }
	equals(other: Point):					boolean { return this.x == other.x && this.y == other.y; }
	dividedEquallyBy(divisor: number):		  Point { return new Point(this.x / divisor, this.y / divisor) }
	multipliedEquallyBy(multiplier: number):  Point { return new Point(this.x * multiplier, this.y * multiplier) }
	static fromDOMRect(rect: DOMRect):		  Point { return new Point(rect.left, rect.top); }
	static square(length: number):			  Point { return new Point(length, length); }
	static x(x: number):					  Point { return new Point(x, 0); }
	static y(y: number):					  Point { return new Point(0, y); }
	static get zero():						  Point { return new Point();}
	static fromPolar(r: number, phi: number): Point { return Point.x(r).rotate_by(phi); }

	// in this (as in math), y increases going up and angles increase counter-clockwise
	get angle(): number { return (Math.atan2(-this.y, this.x)); }	// in browsers, y is the opposite, so reverse it here

	get quadrant_ofPoint(): T_Quadrant {
		const x = this.x;
		const y = this.y;
		if		  (x >= 0 && y >= 0) { return T_Quadrant.upperRight;
		} else if (x <  0 && y >= 0) { return T_Quadrant.upperLeft;
		} else if (x <  0 && y <  0) { return T_Quadrant.lowerLeft;
		} else						 { return T_Quadrant.lowerRight;
		}
	}

	get orientation_ofVector(): T_Orientation {
		let quadrant = new Angle(this.angle).quadrant_ofAngle;
		const isFirstEighth = (this.angle).normalize_between_zeroAnd(Angle.quarter) < (Math.PI / 4);
		switch (quadrant) {
			case T_Quadrant.upperRight: return isFirstEighth ? T_Orientation.right : T_Orientation.up;
			case T_Quadrant.upperLeft:  return isFirstEighth ? T_Orientation.up	   : T_Orientation.left;
			case T_Quadrant.lowerLeft:  return isFirstEighth ? T_Orientation.left  : T_Orientation.down;
			case T_Quadrant.lowerRight: return isFirstEighth ? T_Orientation.down  : T_Orientation.right;
		}
	}

	rotate_by(angle: number): Point {
		// rotate counter-clockwise
		// angle of zero is on the x-axis pointing right
		// angle of one-half pi is on the y-axis pointing up
		// in math y increases going up,
		// so it must be reversed for browsers
		const cos = Math.cos(angle);
		const sin = Math.sin(angle);
		return new Point(
			this.x * cos + this.y * sin,
			this.y * cos - this.x * sin	// reverse y for browsers
		);
	}
	
	isContainedBy_path(path: string): boolean {
		const canvas = document.createElement('canvas');		// Create a temporary canvas element
		const context = canvas.getContext('2d');
		if (!context) {
			throw new Error('Failed to get 2D context');
		}
		canvas.width = window.innerWidth;		// Set canvas dimensions (arbitrary large values to ensure it covers the path)
		canvas.height = window.innerHeight;
		const path2D = new Path2D(path);		// Create a new Path2D object from the SVG path
		const isInside = context.isPointInPath(path2D, this.x, this.y);		// Check if the point is inside the path
		return isInside;
	}

	static origin_inWindowCoordinates_for(element: HTMLElement): Point {
		let e: HTMLElement | null = element;
		let point = Point.zero;
		while (e) {
			point = point.offsetByXY(e.offsetLeft, e.offsetTop);
			e = e.offsetParent as HTMLElement;
		}
		return point;
	}

}

export class Size {
	height: number;
	width: number;

	constructor(width: number = 0, height: number = 0) {
		this.height = height;
		this.width = width;
	}

	get proportion():					   number { return this.width / this.height; }
	get isZero():						  boolean { return this.width == 0 && this.height == 0; }
	get description():					   string { return `${this.width.toFixed(p)} ${this.height.toFixed(p)}`; }
	get verbose():						   string { return `(${this.width.toFixed(p)}, ${this.height.toFixed(p)})`; }
	get pixelVerbose():					   string { return `${this.width.toFixed(p)}px ${this.height.toFixed(p)}px`; }
	get center():						    Point { return this.asPoint.dividedInHalf; }
	get asPoint():			   			    Point { return new Point(this.width, this.height); }			// NOTE: always in lower right quadrant (increasing clockwise)
	get swap():								 Size { return new Size(this.height, this.width); }
	get negated():							 Size { return this.multipliedEquallyBy(-1); }
	get dividedInHalf():					 Size { return this.dividedEquallyBy(2); }
	reducedByXY(x: number, y: number):		 Size { return this.extendedByXY(-x, -y); }
	extendedByX(delta: number):				 Size { return this.extendedByXY(delta, 0); }
	extendedByY(delta: number):				 Size { return this.extendedByXY(0, delta); }
	reducedByX(delta: number):				 Size { return this.extendedByXY(-delta, 0); }
	reducedByY(delta: number):				 Size { return this.extendedByXY(0, -delta); }
	expandedEquallyBy(delta: number):		 Size { return this.extendedByXY(delta, delta); }
	reducedBy(srinkage: Point):				 Size { return this.extendedBy(srinkage.negated); }
	insetEquallyBy(delta: number):			 Size { return this.expandedEquallyBy(2 * -delta); }
	extendedBy(delta: Point):				 Size { return this.extendedByXY(delta.x, delta.y); }
	dividedEquallyBy(divisor: number):		 Size { return this.multipliedEquallyBy(1 / divisor); }
	extendedByXY(x: number, y: number):		 Size { return new Size(this.width + x, this.height + y); }
	multipliedEquallyBy(multiplier: number): Size { return new Size(this.width * multiplier, this.height * multiplier); }
	dividedBy(size: Size):					 Size { return new Size(this.width / size.width, this.height / size.height); }
	best_ratio_to(size: Size):			   number { return Math.min(this.width / size.width, this.height / size.height); }
	equals(other: Size):				  boolean { return this.width == other.width && this.height == other.height; }
	static fromDOMRect(rect: DOMRect):		 Size { return new Size(rect.width, rect.height); }
	static square(length: number):			 Size { return new Size(length, length); }
	static height(height: number):			 Size { return new Size(0, height); }
	static width(width: number):			 Size { return new Size(width, 0); }
	static get zero():						 Size { return new Size(); }

}

export class Rect {
	origin: Point;
	size: Size;

	constructor(origin: Point = Point.zero, size: Size = Size.zero) {
		this.origin = origin;
		this.size = size;
	}

	get x():						 number { return this.origin.x; }
	get y():						 number { return this.origin.y; }
	get right():					 number { return this.extent.x; }
	get bottom():					 number { return this.extent.y; }
	get width():					 number { return this.size.width; }
	get height():					 number { return this.size.height; }
	get isZero():					boolean { return this.size.isZero; }
	get verbose():					 string { return `${this.origin.verbose}, ${this.size.verbose}`; }
	get description():				 string { return `${this.origin.description} ${this.size.description}`; }
	get pixelVerbose():				 string { return `${this.origin.pixelVerbose} ${this.size.pixelVerbose}`; }
	get asBBox():					   BBox { return { minX: this.x, minY: this.y, maxX: this.right, maxY: this.bottom }; }
	get center():					  Point { return this.origin.offsetBy(this.size.center); }
	get extent():					  Point { return this.origin.offsetBy(this.size.asPoint); }		// bottom right
	get topRight():					  Point { return new Point(this.extent.x, this.origin.y); }
	get centerTop():				  Point { return new Point(this.center.x, this.origin.y); }
	get bottomLeft():				  Point { return new Point(this.origin.x, this.extent.y); }
	get centerLeft():				  Point { return new Point(this.origin.x, this.center.y); }
	get centerRight():				  Point { return new Point(this.extent.x, this.center.y); }
	get centerBottom():				  Point { return new Point(this.center.x, this.extent.y); }
	get dividedInHalf():			   Rect { return new Rect(this.origin, this.size.multipliedEquallyBy(-1/2)); }
	get atZero_forX():				   Rect { return new Rect(Point.y(this.origin.y), this.size); }
	get atZero_forY():				   Rect { return new Rect(Point.x(this.origin.x), this.size); }
	get atZero():					   Rect { return new Rect(Point.zero, this.size); }
	set x(x: number)						{ this.origin.x = x; }
	set y(y: number)						{ this.origin.y = y; }
	set width(width: number)				{ this.size.width = width; }
	set height(height: number)				{ this.size.height = height; }

	get normalized(): Rect {			// make width and height positive
		let width = this.width;
		let height = this.height;
		if (width < 0) {
			this.size.width = -width;	// invert width
			this.origin.x -= width;		// compensate
		}
		if (height < 0) {
			this.size.height = -height;	// "
			this.origin.y -= height;	// "
		}
		return this;					// for method chaining	
	}

	equals(other: Rect):			boolean { return this.origin.equals(other.origin) && this.size.equals(other.size); }
	multipliedEquallyBy(m: number):	   Rect { return new Rect(this.origin.multipliedEquallyBy(m), this.size.multipliedEquallyBy(m)); }
	dividedEquallyBy(m: number):	   Rect { return new Rect(this.origin.dividedEquallyBy(m), this.size.dividedEquallyBy(m)); }
	centeredRect_ofSize(size: Size):   Rect { return new Rect(this.center.offsetBy(size.center.negated), size); }
	originMultipliedBy(ratio: number): Rect { return new Rect(this.origin.multipliedEquallyBy(ratio), this.size); }
	expand_sizeBy(ratio: number):	   Rect { return new Rect(this.origin, this.size.multipliedEquallyBy(ratio)); }
	expand_heightBy(height: number):   Rect { return new Rect(this.origin, this.size.extendedByY(height)); }
	multiply_xBy(ratio: number):	   Rect { return new Rect(this.origin.multiply_xBy(ratio), this.size); }
	multiply_yBy(ratio: number):	   Rect { return new Rect(this.origin.multiply_yBy(ratio), this.size); }
	extend_widthBy(width: number):	   Rect { return new Rect(this.origin, this.size.extendedByX(width)); }
	offsetByXY(x: number, y: number):  Rect { return new Rect(this.origin.offsetByXY(x, y), this.size); }
	offsetBy(delta: Point):			   Rect { return new Rect(this.origin.offsetBy(delta), this.size); }
	offsetByX(x: number):			   Rect { return new Rect(this.origin.offsetByX(x), this.size); }
	offsetByY(y: number):			   Rect { return new Rect(this.origin.offsetByY(y), this.size); }
	offsetEquallyBy(offset: number):   Rect { return this.offsetByXY(offset, offset); }
	
	expandedBy(expansion: Point): Rect {
		const size = this.size.extendedBy(expansion);
		const origin = expansion.vector_to(this.origin);
		return new Rect(origin, size)
	}

	contains(point: Point): boolean {
		const origin = this.origin;
		const extent = this.extent;
		return point.x.isBetween(origin.x, extent.x, true) && 
			   point.y.isBetween(origin.y, extent.y, true);
	}

	corners_forAngle(angle: number): [Point, Point] {
		switch (new Angle(angle).quadrant_ofAngle) {
			case T_Quadrant.lowerRight: return [this.bottomLeft, this.topRight];
			case T_Quadrant.upperLeft:  return [this.topRight, this.bottomLeft];
			case T_Quadrant.lowerLeft:  return [this.extent, this.origin];
			default:					return [this.origin, this.extent];
		}
	}

	intersects(rect: Rect): boolean {
		// handle zero-width/height cases by using origin instead of extent
		// for a zero dimension, treat the rectangle as a line by using the origin point
        const thisExtentX = this.size.width  === 0 ? this.origin.x : this.extent.x;
        const thisExtentY = this.size.height === 0 ? this.origin.y : this.extent.y;
        const rectExtentX = rect.size.width  === 0 ? rect.origin.x : rect.extent.x;
        const rectExtentY = rect.size.height === 0 ? rect.origin.y : rect.extent.y;

		// check for non-intersection using the separating axis theorem
		// two rectangles do NOT intersect if:
		// - the left edge of one is right of the right edge of the other OR
		// - the top edge of one is below the bottom edge of the other
        return !(this.origin.x > rectExtentX || 
				 this.origin.y > rectExtentY ||
                 rect.origin.x > thisExtentX || 
                 rect.origin.y > thisExtentY);
    }

	clippedTo(bounds: Rect): Rect {
		// Clip this rect to the bounds, returning the intersection
		// If no intersection, returns a zero-sized rect at the clipped origin
		const clippedLeft = Math.max(this.origin.x, bounds.origin.x);
		const clippedTop = Math.max(this.origin.y, bounds.origin.y);
		const clippedRight = Math.min(this.extent.x, bounds.extent.x);
		const clippedBottom = Math.min(this.extent.y, bounds.extent.y);
		
		const clippedWidth = Math.max(0, clippedRight - clippedLeft);
		const clippedHeight = Math.max(0, clippedBottom - clippedTop);
		
		return new Rect(new Point(clippedLeft, clippedTop), new Size(clippedWidth, clippedHeight));
	}

	static createSizeRect(size: Size): Rect { return new Rect(Point.zero, size); }
	static get zero():				   Rect { return new Rect(Point.zero, Size.zero); }

	static createWHRect(width: number, height: number): Rect {
		return new Rect(Point.zero, new Size(width, height));
	}
	
	static createExtentRect(origin: Point, extent: Point): Rect {
		return new Rect(origin, origin.vector_to(extent).asSize);
	}

	static createRightCenterRect(rightCenter: Point, size: Size): Rect {
		return new Rect(rightCenter.offsetByY(size.height / -2), size);
	}

	static createCenterRect(center: Point, size: Size): Rect {
		const toOrigin = size.center.negated;
		const origin = center.offsetBy(toOrigin);
		return new Rect(origin, size);
	}

	static createFromDOMRect(domRect: DOMRect | null) {
		if (!domRect) {
			return null;
		}
		const origin = new Point(domRect.x, domRect.y).offsetByXY(window.scrollX, window.scrollY);
		return new Rect(origin, new Size(domRect.width, domRect.height));
	}

	static rect_forElement(element: HTMLElement | null): Rect | null {
		if (!element) {
			return null;
		}
		const domRect = element.getBoundingClientRect();
		const origin = Point.fromDOMRect(domRect);
		const size = Size.fromDOMRect(domRect);
		return new Rect(origin, size);
	}

	static rect_forComponent(c: SvelteComponent): Rect {
		const top = c['offsetTop'];
		const left = c['offsetLeft'];
		const width = c['offsetWidth'];
		const height = c['offsetHeight'];
		if ((!!top || top == 0) && (!!left || left == 0) && !!width && !!height) {
			return new Rect(new Point(left, top), new Size(width, height));
		}
		return Rect.zero;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/types/Seriously_Range.ts
```ts
export class Seriously_Range {
  start: number;
  end: number;

  constructor(start: number, end: number) {
    this.start = start;
    this.end = end;
  }
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/types/Types.ts
```ts
import { T_Signal } from '../common/Enumerations';
import { SignalConnection } from 'typed-signals';
import Ancestry from '../runtime/Ancestry';
import S_Items from '../state/S_Items';
import S_Mouse from '../state/S_Mouse';	

export type Dictionary<T = any> = Record<string, T>;
export type T_Preview_Type = 'image' | 'text' | null;
export type Integer = number & { __brand: 'integer' };
export type Handle_Result<T = Object, U = void> = (result: T) => U;
export type Handle_S_Mouse = Handle_Result<S_Mouse, boolean>;
export type Async_Handle_Boolean = (flag: boolean) => Promise<void>;
export type Signal_Handler = (t_signal: T_Signal, value: any | null) => any;
export type Create_S_Mouse = (event: MouseEvent | null, element: HTMLElement) => S_Mouse;
export type Signal_Signature = (t_signal: T_Signal, priority: number, value: any) => void;

export type SignalConnection_atPriority = {
	t_signal: T_Signal,
	priority: number,
	connection: SignalConnection | null };

export type S_Recent = {
	si_grabs: S_Items<Ancestry>; 
	focus: Ancestry;
	depth: number;
};
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/types/Angle.ts
```ts
import { tu } from '../utilities/Testworthy_Utilities';
import '../common/Extensions';

export enum T_Quadrant {
	upperRight = 'ur',	// 				0 ... quarter
	upperLeft  = 'ul',	//		  quarter ... half
	lowerLeft  = 'll',	//			 half ... three_quarters
	lowerRight = 'lr',	// three_quarters ... full
}

export enum T_Orientation {
	right = 'right',
	left  = 'left',
	down  = 'down',
	up    = 'up',
}

export default class Angle {
	angle: number;								// angles begin at 3 o'clock & rotate up (counter-clockwise)

	constructor(angle: number) {
		this.angle = angle;
	}

	static zero = 0;							// far right (3 o'clock)
	static full = Math.PI * 2;					// same as (normalizes to) zero
	static half = Angle.full / 2;				// far left (9 o'clock)
	static quarter = Angle.full / 4;			// zenith (12 o'clock)
	static three_quarters = Angle.quarter * 3;	// nadir (6 o'clock)
	static sixteenth = Angle.full / 16;			// support octants
	static eighth = Angle.full / 8;

	static radians_from_degrees(degrees: number):	   number { return Math.PI / 180 * degrees; }

	static angle_from_name(name: string): number | null {
		switch (name) {
			case 'up':				return -Math.PI / 2;
			case 'down':			return Math.PI / 2;
			case 'right': case '>': return Math.PI;
			case 'left':  case '<': return 0;
		}
		return null;
	}

	static orientation_from_name(name: string): T_Orientation | null {
		switch (name) {
			case 'up':				return T_Orientation.up;
			case 'down':			return T_Orientation.down;
			case 'right': case '>': return T_Orientation.right;
			case 'left':  case '<': return T_Orientation.left;
		}
		return null;
	}

	get angle_points_down(): boolean { return this.orientation_ofAngle == T_Orientation.down; }
	get quadrant_basis_angle(): number { return tu.basis_angle_ofType_Quadrant(this.quadrant_ofAngle); }

	get angle_slants_forward(): boolean {
		const quadrant = this.quadrant_ofAngle;
		return [T_Quadrant.lowerRight, T_Quadrant.upperLeft].includes(quadrant);
	}

	get angle_points_right(): boolean {
		switch(this.quadrant_ofAngle) {
			case T_Quadrant.lowerRight: return true;
			case T_Quadrant.upperRight: return true;
			default: return false;
		}
	}

	get angle_points_up(): boolean {
		switch(this.quadrant_ofAngle) {
			case T_Quadrant.upperLeft: return true;
			case T_Quadrant.upperRight: return true;
			default: return false;
		}
	}

	get orientation_ofAngle(): T_Orientation {
		let quadrant = this.quadrant_ofAngle;
		// isFirstEighth first of two half quadrants, counting counter-clockwise
		const isFirstEighth = this.angle.normalize_between_zeroAnd(Angle.quarter) < (Angle.quarter / 2);
		switch (quadrant) {		// going counter-clockwise
			case T_Quadrant.upperRight: return isFirstEighth ? T_Orientation.right : T_Orientation.up;
			case T_Quadrant.upperLeft:  return isFirstEighth ? T_Orientation.up    : T_Orientation.left;
			case T_Quadrant.lowerLeft:  return isFirstEighth ? T_Orientation.left  : T_Orientation.down;
			case T_Quadrant.lowerRight: return isFirstEighth ? T_Orientation.down  : T_Orientation.right;
		}
	}

	get quadrant_ofAngle(): T_Quadrant {
	
		// angles begin at 3 o'clock & rotate up (counter-clockwise)
		// ending in lowerRight quadrant (this is also the default)
	
		const normalized = this.angle.angle_normalized();
		let quadrant = T_Quadrant.lowerRight;
		if (normalized.isBetween(0,				Angle.quarter,		  true)) { quadrant = T_Quadrant.upperRight; }
		if (normalized.isBetween(Angle.quarter, Angle.half,			  true)) { quadrant = T_Quadrant.upperLeft; }
		if (normalized.isBetween(Angle.half,	Angle.three_quarters, true)) { quadrant = T_Quadrant.lowerLeft; }
		return quadrant;
	}

	get octant_ofAngle(): number {
		const normalized = this.angle.angle_normalized();
		let test_angle = Angle.sixteenth;
		for (let i = 0; i < 8; i++) {
			if (normalized < test_angle) {
				return i;
			}
			test_angle += Angle.eighth;
		}
		return 0;
	}

	get cursor_forAngle(): string {
		if (!!this.angle) {
			const octant = this.octant_ofAngle;
			switch (octant % 4) {
				case 0: return 'ns-resize';
				case 1: return 'nwse-resize';
				case 2: return 'ew-resize';
				case 3: return 'nesw-resize';
			}
		}
		return '';
	}

}

export enum Direction {
	up = Angle.three_quarters,
	down = Angle.quarter,
	right = Angle.half,
	left = Angle.zero,
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/types/Search_Node.ts
```ts
import { Thing } from "../common/Global_Imports";

export class Search_Node {
	nodes_map_byCharCode: Map<number, Search_Node> = new Map();
	items: Set<Thing> = new Set();
	isEndOfWord: boolean = false;

	// TRIE NODE --- short for "retrieval tree" or "prefix tree"
	// For efficient prefix-based searches
	// pronounced "try"
	// 
	// It's a tree-like data structure where:
	// 
	// Each node represents a character
	// Paths from root to nodes spell out strings
	// Common prefixes share the same path

	// 	Optimization Strategies:
	// 
	// 1. Lazy Set allocation: Only create Sets when items > 0
	// 2. Node pooling: Reuse deallocated nodes
	// 3. Compact arrays for small branching factors: Use arrays instead of Maps for nodes with few children

	get results(): Array<Thing> {
		return Array.from(this.items).sort((a, b) =>
			a.title.localeCompare(b.title)
		);
	}
	
	insert_wordFor(word: string, thing: Thing): void {
		let current: Search_Node = this;
		for (const char of word) {
			const charCode = char.charCodeAt(0);
			if (!current.nodes_map_byCharCode.has(charCode)) {
				current.nodes_map_byCharCode.set(charCode, new Search_Node());
			}
			// walk down the trie
			current = current.nodes_map_byCharCode.get(charCode)! as Search_Node;
			current.items.add(thing);
		}
		current.isEndOfWord = true;
	}

	search_for(words: string[], use_AND_logic: boolean = false): Array<Thing> {
		if (words.length === 0) return [];
		
		// For single word, return results directly
		if (words.length === 1) {
			const node = this.find_nodeFor(words[0]);
			return node ? node.results : [];
		}
		
		if (use_AND_logic) {
			// INTERSECTION (AND logic) - items must match ALL words
			const resultSets = words
				.map(word => this.find_nodeFor(word))
				.filter(node => node !== null)
				.map(node => node!.items);
			
			if (resultSets.length !== words.length) return [];
			
			const intersection = this.apply_AND_logicTo(resultSets);
			return Array.from(intersection).sort((a, b) =>
				a.title.localeCompare(b.title)
			);
		} else {
			// UNION (OR logic) - items match ANY word
			const allResults = new Set<Thing>();
			
			for (const word of words) {
				const node = this.find_nodeFor(word);
				if (node) {
					node.items.forEach(item => allResults.add(item));
				}
			}
			
			return Array.from(allResults).sort((a, b) =>
				a.title.localeCompare(b.title)
			);
		}
	}
	
	private apply_AND_logicTo(sets: Set<Thing>[]): Set<Thing> {
		if (sets.length === 0) return new Set();
		if (sets.length === 1) return new Set(sets[0]);
		
		const intersection = new Set(sets[0]);
		for (let i = 1; i < sets.length; i++) {
			for (const item of intersection) {
				if (!sets[i].has(item)) {
					intersection.delete(item);
				}
			}
		}
		return intersection;
	}

	private find_nodeFor(word: string): Search_Node | null {
		if (word.length === 0) return null;
		let current: Search_Node = this;
		for (const char of word) {
			const charCode = char.charCodeAt(0);
			const child = current.nodes_map_byCharCode.get(charCode) as Search_Node;
			if (!child) return null;
			current = child;
		}
		return current;
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/.DS_Store
```DS_Store
   Bud1                                                                      i m ebwspbl                                                                                                                                                                           r u n t i m ebwspblob   �bplist00�]ShowStatusBar[ShowToolbar[ShowTabView_ContainerShowSidebar\WindowBounds[ShowSidebar			_{{726, 101}, {920, 464}}	#/;R_klmno�                            �    r u n t i m evSrnlong                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 @      �                                        @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         DSDB                                 `          �                                         @      �                                          @      �                                          @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```

### /Users/sand/GitHub/mono/ws/src/lib/ts/signals/Mouse_Timer.ts
```ts
import { k } from '../../ts/common/Constants';

export enum T_Timer {
	repeat	= 'repeat',
	double	= 'double',
	alter	= 'alter',
	long	= 'long',
}

export default class Mouse_Timer {
	autorepeat_start_timer: null | number | NodeJS.Timeout = null;
	doubleClick_timer: null | number | NodeJS.Timeout = null;
	autorepeat_timer: null | number | NodeJS.Timeout = null;
	alteration_timer: null | number | NodeJS.Timeout = null;
	longClick_timer: null | number | NodeJS.Timeout = null;
	timer_ID: number = Mouse_Timer.get_next_ID();
	static debug_ID: number = 0;
	autorepeat_ID: number = -1;
	name = k.empty;

	constructor(name: string = k.empty) { this.name = name; }
	static get_next_ID(): number { return Mouse_Timer.debug_ID++; }
	isAutorepeating_forID(id: number): boolean { return this.autorepeat_ID === id; }

	hasTimer_forID(type: T_Timer): boolean {
		switch (type) {
			case T_Timer.double: return !!this.doubleClick_timer;
			case T_Timer.repeat: return !!this.autorepeat_timer;
			case T_Timer.alter: return !!this.alteration_timer;
			case T_Timer.long: return !!this.longClick_timer;
		}
	}

	autorepeat_start(id: number, callback: () => void) {
		this.autorepeat_stop();
		this.autorepeat_ID = id;
		callback();
		this.autorepeat_start_timer = setTimeout(() => {
			this.autorepeat_timer = setInterval(callback, k.threshold.autorepeat);
			this.autorepeat_start_timer = null;
		}, k.threshold.long_click);
	}

	autorepeat_stop() {
		if (this.autorepeat_start_timer) {
			clearTimeout(this.autorepeat_start_timer);
			this.autorepeat_start_timer = null;
		}
		if (this.autorepeat_timer) {
			clearInterval(this.autorepeat_timer);
			this.autorepeat_timer = null;
		}
		this.autorepeat_ID = -1;
	}

	alteration_start(callback: (invert: boolean) => void) {
		this.alteration_stop();
		let invert = true;
		this.alteration_timer = setInterval(() => {
			callback(invert);
			invert = !invert;
		}, k.threshold.alteration);
	}

	alteration_stop() {
		if (this.alteration_timer) {
			clearInterval(this.alteration_timer);
			this.alteration_timer = null;
		}
	}
	
	timeout_start(type: T_Timer, callback: (args: void) => void, force_reset: boolean = false) {
		if (type == T_Timer.long) {
			if (force_reset && !!this.longClick_timer) {
				clearTimeout(this.longClick_timer);
				this.longClick_timer = null;
			}
			if (!this.longClick_timer) {
				this.longClick_timer = setTimeout(() => {
					this.longClick_timer = null;
					callback();
				}, k.threshold.long_click);
			}
		} else if (type == T_Timer.double) {
			if (force_reset && !!this.doubleClick_timer) {
				clearTimeout(this.doubleClick_timer);
				this.doubleClick_timer = null;
			}
			if (!this.doubleClick_timer) {
				this.doubleClick_timer = setTimeout(() => {
					this.doubleClick_timer = null;
					callback();
				}, k.threshold.double_click);
			}
		}
	}

	reset() {	// tear down
		if (!!this.doubleClick_timer) {
			clearTimeout(this.doubleClick_timer);
			this.doubleClick_timer = null;
		}
		if (!!this.longClick_timer)  {
			clearTimeout(this.longClick_timer);
			this.longClick_timer = null;
		}
		this.alteration_stop();
		this.autorepeat_stop();
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/signals/Events.ts
```ts
import { details, signals, controls, elements, features, g_graph_tree } from '../common/Global_Imports';
import { c, g, h, k, u, x, hits, show, debug, search, radial, colors } from '../common/Global_Imports';
import { T_File_Extension, T_Predicate, T_Alteration } from '../common/Global_Imports';
import { T_Search, T_Action, T_Control } from '../common/Global_Imports';
import { Point, Ancestry, Predicate } from '../common/Global_Imports';
import { S_Mouse, S_Alteration } from '../common/Global_Imports';

import type { Dictionary } from '../types/Types';
import { get, writable } from 'svelte/store';
import Mouse_Timer from './Mouse_Timer';

export class Events {
	throttle_timers: Dictionary<ReturnType<typeof setTimeout> | null> = {};
	mouse_timer_dict_byName: Dictionary<Mouse_Timer> = {};
	initialTouch: Point | null = null;
	alterationTimer!: Mouse_Timer;

	w_count_details			= writable<number>(0);
	w_count_rebuild			= writable<number>(0);
	w_count_window_resized	= writable<number>(0);
	w_count_mouse_down		= writable<number>(0);
	w_count_mouse_up		= writable<number>(0);
	w_shift_on_mouse_up		= writable<boolean>(false);  // Phase 4: track shift for grab
	w_control_key_down		= writable<boolean>(false);
	w_mouse_button_down		= writable<boolean>(false);
	w_scaled_movement		= writable<Point | null>(null);
	w_mouse_location		= writable<Point>();
	w_mouse_location_scaled	= writable<Point>();

	static readonly _____UTILITIES: unique symbol;

	mouse_timer_forName(name: string): Mouse_Timer {
		return elements.assure_forKey_inDict(name, this.mouse_timer_dict_byName, () => new Mouse_Timer(name));
	}

	name_ofActionAt(t_action: number, column: number): string {
		return Object.keys(this.actions[T_Action[t_action]])[column];
	}

	throttle(key: string, defer_for: number = 50, callback: () => void): void {
		if (!this.throttle_timers[key]) {
			callback();
			this.throttle_timers[key] = setTimeout(() => {
				this.throttle_timers[key] = null;
			}, defer_for);
		}
	}

	static readonly _____SUBSCRIPTIONS: unique symbol;

	setup() {
		x.w_s_alteration.subscribe((s_alteration: S_Alteration | null) => { this.handle_s_alteration(s_alteration); });
		c.w_device_isMobile.subscribe((isMobile: boolean) => { this.subscribeTo_events(); });
	}

	private update_window_listener(name: string, handler: EventListenerOrEventListenerObject) {
		window.removeEventListener(name, handler);
		window.addEventListener(name, handler, { passive: false });
	}

	private update_document_listener(name: string, handler: EventListenerOrEventListenerObject) {
		document.removeEventListener(name, handler);
		document.addEventListener(name, handler, { passive: false });
	}

	private clear_event_subscriptions() {
		document.removeEventListener('mouseup',				this.handle_mouse_up);
		document.removeEventListener('mousemove',			this.handle_mouse_move);
		document.removeEventListener('touchend',			this.handle_touch_end);
		document.removeEventListener('touchmove',			this.handle_touch_move);
		document.removeEventListener('touchstart',			this.handle_touch_start);
	}

	private subscribeTo_events() {
		this.clear_event_subscriptions();
		this.update_document_listener('wheel',				this.handle_wheel);
		this.update_document_listener('keyup',				this.handle_key_up);
		this.update_document_listener('keydown',			this.handle_key_down);
		this.update_window_listener('resize',				this.handle_window_resize);
		this.update_document_listener('orientationchange',	this.handle_orientation_change);
		if (c.device_isMobile) {
			debug.log_action(`  mobile subscribe GRAPH`);
			document.addEventListener('touchend',			this.handle_touch_end, { passive: false });
			document.addEventListener('touchmove',			this.handle_touch_move, { passive: false });
			document.addEventListener('touchstart',			this.handle_touch_start, { passive: false });
		} else {
			document.addEventListener('mouseup',			this.handle_mouse_up, { passive: false });
			document.addEventListener('mousedown',			this.handle_mouse_down, { passive: false });
			document.addEventListener('mousemove',			this.handle_mouse_move, { passive: false });
		}
	}

	static readonly _____EVENT_HANDLERS: unique symbol;

	private handle_touch_end(event: TouchEvent) { this.initialTouch = null; }

	private handle_mouse_down = (event: MouseEvent) => {
		if (get(colors.w_color_picker_isOpen)) {
			return;
		}
		const location = new Point(event.clientX, event.clientY);
		const scaled = location.dividedEquallyBy(get(g.w_scale_factor));
		hits.handle_s_mouse_at(scaled, S_Mouse.down(event, null));
		hits.disable_hover = true;
		this.w_count_mouse_down.update(n => n + 1);
		this.w_scaled_movement.set(Point.zero);
		this.w_mouse_button_down.set(true);
	}

	private handle_mouse_up = (event: MouseEvent) => {
		const location = new Point(event.clientX, event.clientY);
		const scaled = location.dividedEquallyBy(get(g.w_scale_factor));
		hits.handle_s_mouse_at(scaled, S_Mouse.up(event, null));
		hits.disable_hover = get(colors.w_color_picker_isOpen);
		this.w_scaled_movement.set(null);
		this.w_shift_on_mouse_up.set(event.shiftKey);  // Phase 4: capture shift state
		this.w_count_mouse_up.update(n => n + 1);
		this.w_mouse_button_down.set(false);
	}

	private handle_key_up(ev: Event) {
		const event = ev as KeyboardEvent;
		if (!!event && event.type == 'keyup') {
			e.w_control_key_down.set(event.ctrlKey);
		}
	}

	private handle_orientation_change(event: Event) {
		const isMobile = c.device_isMobile;
		debug.log_action(` orientation change [is${isMobile ? '' : ' not'} mobile] STATE`);
		c.w_device_isMobile.set(isMobile);
		g.restore_preferences();
	}

	private handle_touch_start(event: TouchEvent) {
		if (event.touches.length == 2) {
			const touch = event.touches[0];
			this.initialTouch = new Point(touch.clientX, touch.clientY);
			debug.log_action(` two-finger touches GRAPH`);
		}
	}

	private handle_window_resize = (event: Event) => {
		// on COMMAND +/-
		// and on simulator switches platform
		const isMobile = c.device_isMobile;
		this.w_count_window_resized.update(n => n + 1);		// observed by controls
		c.w_device_isMobile.set(isMobile);					// force reaction (unchanged)
		g.restore_preferences();
	}

	private handle_wheel(event: Event) {
		u.consume_event(event);
		if (!c.device_isMobile) {
			const e = event as WheelEvent;
			const userOffset = get(g.w_user_graph_offset);
			const delta = new Point(-e.deltaX, -e.deltaY);
			if (!!userOffset && features.allow_h_scrolling && delta.magnitude > 1) {
				debug.log_action(` wheel GRAPH`);
				g.set_user_graph_offsetTo(userOffset.offsetBy(delta));
			}
		}
	}

	private handle_touch_move(event: TouchEvent) {
		if (event.touches.length == 2) {
			u.consume_event(event);
			if (this.initialTouch) {
				const touch = event.touches[0];
				const deltaX = touch.clientX - this.initialTouch.x;
				const deltaY = touch.clientY - this.initialTouch.y;
				g.set_user_graph_offsetTo(new Point(deltaX, deltaY));
				debug.log_action(` two-finger touch move GRAPH`);
			}
		}
	}

	private handle_s_alteration(s_alteration: S_Alteration | null) {
		if (!this.alterationTimer) {
			this.alterationTimer = this.mouse_timer_forName('alteration');
		}
		if (!!s_alteration) {
			this.alterationTimer.alteration_start((invert) => {
				signals.signal_blink_forAlteration(invert);
			});
		} else {
			this.alterationTimer.alteration_stop();
			signals.signal_blink_forAlteration(false);
		}
	}

	private handle_mouse_move = (event: MouseEvent) => {
		const location = new Point(event.clientX, event.clientY);
		const scaled = location.dividedEquallyBy(get(g.w_scale_factor));
		const prior_scaled = get(this.w_mouse_location_scaled);
		const delta = prior_scaled?.vector_to(scaled) ?? null;
		if (!!delta && delta.magnitude > 1) {
			this.w_scaled_movement.set(delta);
		}
		this.w_mouse_location.set(location);
		this.w_mouse_location_scaled.set(scaled);
		hits.handle_mouse_movement_at(scaled);
	}

	handle_s_mouseFor_t_control(s_mouse: S_Mouse, t_control: T_Control) {
		if (s_mouse.isDown) {
			switch (t_control) {
				case T_Control.help:	controls.showHelp_home(); break;
				case T_Control.search:	search.activate(); break;
				// case T_Control.grow:	g.scaleBy(k.ratio.zoom_in) - 20; break;
				// case T_Control.shrink:	g.scaleBy(k.ratio.zoom_out) - 20; break;
				case T_Control.details: details.details_toggle_visibility(); break;
				default:				controls.togglePopupID(t_control); break;
			}
		}
	}

	handle_singleClick_onDragDot(shiftKey: boolean, ancestry: Ancestry) {
		if (ancestry.isBidirectional && ancestry.thing?.isRoot) {
			this.handle_singleClick_onDragDot(shiftKey, h.rootAncestry);
		} else if (!radial.isDragging) {
			x.w_s_title_edit?.set(null);
			if (!!get(x.w_s_alteration)) {
				h.ancestry_alter_connectionTo_maybe(ancestry);
				g.grand_build();
				return;
			} else if (shiftKey) {
				ancestry.toggleGrab();
			} else {
				let focus = ancestry;
				if (ancestry.isFocus && !!ancestry.parentAncestry) {
					focus = ancestry.parentAncestry;
				}
				if (focus.becomeFocus()) {
					if (show.inRadialMode) {
						focus.grabOnly();
					}
					g.grand_build();
					return;
				}
			}
			g.layout();
		}
	}

	async handle_key_down(ev: Event) {
		const event = ev as KeyboardEvent;
		const isEditing = get(x.w_s_title_edit)?.isActive ?? false;
		if (!!event && event.type == 'keydown' && !isEditing) {
			const key = event.key.toLowerCase();
			const ancestry = get(x.w_ancestry_forDetails);
			const modifiers = ['alt',	'meta',	'shift',	'control'];
			let graph_needsSweep = false;
			e.w_control_key_down.set(event.ctrlKey);
			if (!!ancestry && !modifiers.includes(key)) {
				const OPTION = event.altKey;
				const SHIFT = event.shiftKey;
				const COMMAND = event.metaKey;
				const EXTREME = SHIFT && OPTION;
				if (get(search.w_t_search) != T_Search.off) {
					switch (key) {
						case 'enter':	
						case 'escape':
						case 'arrowright':	    search.deactivate_focus_and_grab(); break;	// stop searching		
						case 'arrowleft':		u.consume_event(event); search.activate(); break;
						case 'arrowup':			u.consume_event(event); search.next_row(false); break;
						case 'arrowdown':		u.consume_event(event); search.next_row(true); break;
						case 'tab':				search.selected_row = 0; break;
						case 'f':				search.activate(); break;			
					}
				} else {
					if (features.allow_graph_editing) {
						if (!!ancestry && features.allow_title_editing) {
							switch (key) {
								case 'enter':	ancestry.startEdit(); break;
								case 'd':		await h.thing_edit_persistentDuplicate(ancestry); break;
								case ' ':		await h.ancestry_edit_persistentCreateChildOf(ancestry); break;
								case '-':		if (!COMMAND) { await h.thing_edit_persistentAddLine(ancestry); } break;
								case 'tab':		await h.ancestry_edit_persistentCreateChildOf(ancestry.parentAncestry); break; // S_Title_Edit editor also makes this call
							}
						}
						switch (key) {
							case 'delete':
							case 'backspace':	await h.ancestries_rebuild_traverse_persistentDelete(get(x.w_grabs)); break;
						}
					}
					if (!!ancestry) {
						switch (key) {
							case '/':			graph_needsSweep = ancestry.becomeFocus(); break;
							case 'arrowleft':	u.consume_event(event); await h.ancestry_rebuild_persistentMoveRight(ancestry, false, SHIFT, OPTION, EXTREME, false); break;
							case 'arrowright':	u.consume_event(event); await h.ancestry_rebuild_persistentMoveRight(ancestry,  true, SHIFT, OPTION, EXTREME, false); break;
						}
					}
					switch (key) {
						case 'f':				search.activate(); break;
						case ']':				x.recents_go(true); break;
						case '[':				x.recents_go(false); break;
						case 'a':				u.consume_event(event); break;
						case '!':				g.grand_adjust_toFit(); break;
						case '?':				controls.showHelp_home(); return;
						case 'm':				controls.toggle_graph_type(); break;
						case 'p':				if (!COMMAND) { u.print_graph(); }; break;
						case 'c':				g.set_user_graph_offsetTo(Point.zero); return;
						case '>':				g_graph_tree.increase_depth_limit_by(1); break;
						case '<':				g_graph_tree.increase_depth_limit_by(-1); break;
						case 's':				h.persist_toFile(T_File_Extension.json); return;
						case 'o':				h.select_file_toUpload(T_File_Extension.json, event.shiftKey); break;
						case '/':				if (!ancestry) { graph_needsSweep = h.rootAncestry?.becomeFocus(); } break;
						case 'escape':			if (!!get(x.w_s_alteration)) { h.stop_alteration(); }; search.deactivate(); break;
						case 'arrowup':			u.consume_event(event); h.ancestry_rebuild_persistent_grabbed_atEnd_moveUp_maybe( true, SHIFT, OPTION, EXTREME); break;
						case 'arrowdown':		u.consume_event(event); h.ancestry_rebuild_persistent_grabbed_atEnd_moveUp_maybe(false, SHIFT, OPTION, EXTREME); break;
					}
				}
			}
			if (graph_needsSweep) {
				g.grand_sweep();
			}
			if (features.allow_autoSave && !!h && h.db.isPersistent && h.isDirty) {
				setTimeout( async () => {
					await h.db.persist_all();
				}, 1);
			}
		}
	}

	async handle_action_clickedAt(s_mouse: S_Mouse, t_action: number, column: number, name: string) {
		const ancestry = get(x.w_ancestry_forDetails);	
		if (get(e.w_control_key_down)) {
			controls.showHelp_for(t_action, column);
		} else if (!!ancestry && !this.isAction_disabledAt(t_action, column) && !!h) {
			const a = this.actions;
			switch (t_action) {
				case T_Action.browse:			switch (column) {
					case a.browse.up:				h.ancestry_rebuild_persistent_grabbed_atEnd_moveUp_maybe( true, false, false, false); break;
					case a.browse.down:				h.ancestry_rebuild_persistent_grabbed_atEnd_moveUp_maybe(false, false, false, false); break;
					case a.browse.left:				await h.ancestry_rebuild_persistentMoveRight(ancestry, false, false, false, false, false); break;
					case a.browse.right:			await h.ancestry_rebuild_persistentMoveRight(ancestry,  true, false, false, false, false); break;
				}								break;
				case T_Action.focus:			switch (column) {
					case a.focus.selection:			ancestry.becomeFocus(); break;
					case a.focus.parent:			ancestry.collapse(); ancestry.parentAncestry?.becomeFocus(); break;
				}								break;
				case T_Action.show:				switch (column) {
					case a.show.selection:			break;
					case a.show.list:				h.ancestry_rebuild_persistentMoveRight(ancestry, !ancestry.isExpanded, false, false, false, true); break;
					case a.show.graph:				g.grand_adjust_toFit(); break;
				}								break;
				case T_Action.center:			switch (column) {
					case a.center.focus:			g.ancestry_place_atCenter(get(x.w_ancestry_focus)); break;
					case a.center.selection:		g.ancestry_place_atCenter(ancestry); break;
					case a.center.graph:			g.set_user_graph_offsetTo(Point.zero); break;
				}								break;
				case T_Action.add:				switch (column) {
					case a.add.child:				await h.ancestry_edit_persistentCreateChildOf(ancestry); break;
					case a.add.sibling:				await h.ancestry_edit_persistentCreateChildOf(ancestry.parentAncestry); break;
					case a.add.line:				await h.thing_edit_persistentAddLine(ancestry); break;
					case a.add.parent:				controls.toggle_alteration(ancestry, T_Alteration.add, Predicate.contains); break;
					case a.add.related:				controls.toggle_alteration(ancestry, T_Alteration.add, Predicate.isRelated); break;
				}								break;
				case T_Action.delete:			switch (column) {
					case a.delete.selection:		await h.ancestries_rebuild_traverse_persistentDelete(get(x.w_grabs)); break;
					case a.delete.parent:			controls.toggle_alteration(ancestry, T_Alteration.delete, Predicate.contains); break;
					case a.delete.related:			controls.toggle_alteration(ancestry, T_Alteration.delete, Predicate.isRelated); break;
				}								break;
				case T_Action.move:				switch (column) {
					case a.move.up:					h.ancestry_rebuild_persistent_grabbed_atEnd_moveUp_maybe( true, false, true, false); break;
					case a.move.down:				h.ancestry_rebuild_persistent_grabbed_atEnd_moveUp_maybe(false, false, true, false); break;
					case a.move.left:				await h.ancestry_rebuild_persistentMoveRight(ancestry, false, false, true, false, false); break;
					case a.move.right:				await h.ancestry_rebuild_persistentMoveRight(ancestry,  true, false, true, false, false); break;
				}								break;
			}
		}
	}

	isAction_disabledAt(t_action: number, column: number): boolean {		// true means disabled
		const ancestry = get(x.w_ancestry_forDetails);
		if (!!ancestry) {
			const is_altering = !!get(x.w_s_alteration);
			const no_children = !ancestry.hasChildren;
			const no_siblings = !ancestry.hasSiblings;
			const is_root = ancestry.isRoot;
			const a = this.actions;
			const disable_revealConceal = no_children || is_root || (show.inRadialMode && ancestry.isFocus);
			switch (t_action) {
				case T_Action.browse:			switch (column) {
					case a.browse.left:				return is_root;
					case a.browse.up:				return no_siblings;
					case a.browse.down:				return no_siblings;
					case a.browse.right:			return no_children;
				}								break;
				case T_Action.focus:			switch (column) {
					case a.focus.selection:			return ancestry.isFocus;
					case a.focus.parent:			return !ancestry.parentAncestry || ancestry.parentAncestry.isFocus;
				}								break;
				case T_Action.show:				switch (column) {
					case a.show.selection:			return ancestry.isVisible;
					case a.show.list:				return disable_revealConceal;
					case a.show.graph:				return false;
				}								break;
				case T_Action.center:			switch (column) {
					case a.center.focus:			return g.ancestry_isCentered(get(x.w_ancestry_focus));
					case a.center.selection:		return g.ancestry_isCentered(ancestry);
					case a.center.graph:			return get(g.w_user_graph_offset).magnitude < 1;
				}								break;
				case T_Action.add:				switch (column) {
					case a.add.child:				return is_altering;
					case a.add.sibling:				return is_altering || is_root;
					case a.add.line:				return is_altering || is_root;
					case a.add.parent:				return is_root;
					case a.add.related:				return false;
				}								break;
				case T_Action.delete:			switch (column) {
					case a.delete.selection:		return is_altering || is_root;
					case a.delete.parent:			return !ancestry.hasParents_ofKind(T_Predicate.contains);
					case a.delete.related:			return !ancestry.hasParents_ofKind(T_Predicate.isRelated);
				}								break;
				case T_Action.move:				switch (column) {
					case a.move.left:				return is_root;
					case a.move.up:					return no_siblings || is_root;
					case a.move.down:				return no_siblings || is_root;
					case a.move.right:				return no_children || is_root;
				}								break;
			}
		}
		return true;
	}

	help_page_forActionAt(t_action: number, column: number): string {
		const a = this.actions;
		switch (t_action) {
			case T_Action.browse: 				return 'actions/browse';
			case T_Action.focus: 				return 'actions/focus';
			case T_Action.show:					switch (column) {
					case a.show.selection:			return 'actions/select';
					case a.show.list:				return 'actions/dots';
				}								break;
			case T_Action.center:				switch (column) {
					case a.center.focus:			return 'actions/focus';
					case a.center.selection:		return 'actions/select';
					case a.center.graph:			return 'looks/graph';
				}								break;
			default:							return 'actions/organize';
		}
		return k.empty;
	}

	private actions: Dictionary<Dictionary<number>> = {
		browse: {
			left: 0,
			up: 1,
			down: 2,
			right: 3,
		},
		focus: {
			selection: 0,
			parent: 1,
		},
		show: {
			selection: 0,
			list: 1,
			graph: 2,
		},
		center: {
			focus: 0,
			selection: 1,
			graph: 2,
		},
		add: {
			child: 0,
			sibling: 1,
			line: 2,
			parent: 3,
			related: 4,
		},
		delete: {
			selection: 0,
			parent: 1,
			related: 2,
		},
		move: {
			left: 0,
			up: 1,
			down: 2,
			right: 3,
		},
	};

}

export const e = new Events();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/signals/Signals.ts
```ts
import type { Dictionary, Signal_Signature } from '../types/Types';
import { T_Signal, T_Hit_Target } from '../common/Enumerations';
import { components } from '../managers/Components';
import S_Component from '../state/S_Component';
import Ancestry from '../runtime/Ancestry';
import { Signal } from 'typed-signals';
import { debug } from '../debug/Debug';
import { get } from 'svelte/store';
import { x } from '../managers/UX';

export class Signals {
	highestPriorities: Dictionary<number> = {};
	signal_emitter = new Signal<Signal_Signature>();
	signals_inFlight_dict_byT_Signal: Dictionary<boolean> = {};

	log_isEnabled_forSending(sending: boolean): boolean {
		return this.log_isEnabled_forDirection[sending ? 'sending' : 'handling'];
	}

	log_isEnabledFor_t_signal = {
		alteration : false,
		reposition : false,
		reattach   : false,
		rebuild	   : true,
		thing	   : false,
	}

	log_isEnabled_forDirection = {
		handling : true,
		sending  : false,
	}

	static readonly _____SENDING: unique symbol;

	// signal is called with a value and a type, but not a priority
	// emit is then called on the signal_emitter
	// for each priority (up to the highest requested for that type)
	// in increasing priority from 0 to highest
	
	signal_rebuildGraph_from(value: any = null, component: S_Component | null = null) { this.signal(T_Signal.rebuild, value, component); }
	signal_rebuildGraph_fromFocus(component: S_Component | null = null) { this.signal_rebuildGraph_from(get(x.w_ancestry_focus), component); }
	signal_blink_forAlteration(value: any = null, component: S_Component | null = null) { this.signal(T_Signal.alteration, value, component); }
	signal_reattach_widgets_from(value: any = null, component: S_Component | null = null) { this.signal(T_Signal.reattach, value, component); }
	signal_reposition_widgets_from(value: any = null, component: S_Component | null = null) { this.signal(T_Signal.reposition, value, component); }
	signal_reattach_widgets_fromFocus(component: S_Component | null = null) { this.signal_reattach_widgets_from(get(x.w_ancestry_focus), component); }
	signal_reposition_widgets_fromFocus(component: S_Component | null = null) { this.signal_reposition_widgets_from(get(x.w_ancestry_focus), component); }

	signal(t_signal: T_Signal, value: any = null, s_component: S_Component | null = null) {
		if (this.anySignal_isInFlight) {									// avoid sending multiple simultaneous signals
			debug.log_signal(`NOT SEND ${t_signal} in flight`);
		} else if (!this.signal_isInFlight_for(T_Signal.rebuild) ||			// also, if rebuild is in progress
			t_signal != T_Signal.reposition) {								// suppress reposition
			this.set_signal_isInFlight_for(t_signal, true);
			const highestPriority = this.highestPriorities[t_signal] ?? 0;
			const s_c = s_component ?? components.dummy;					// often no component is provided, use the dummy component	
			for (let priority = 0; priority <= highestPriority; priority++) {
				s_c.debug_log_signal(true, value, t_signal, priority);	// log components listening to this signal at this priority
				this.signal_emitter.emit(t_signal, priority, value);
			}
			this.set_signal_isInFlight_for(t_signal, false);
		}
	}

	static readonly _____RECEIVING: unique symbol;

	// each handler has a signal type, a priority and a closure
	// whereby, upon receipt of each signal,
	// whose type and priority are a match
	// the closure is called
	// with just the signal's type and value

	handle_signals_atPriority(t_signals: Array<T_Signal>, priority: number, ancestry: Ancestry | null, type: T_Hit_Target, onSignal: (t_signal: T_Signal, value: any | null) => any ): S_Component | null {
		this.adjust_highestPriority_forSignals(priority, t_signals);
		const s_component = components.component_forAncestry_andType_createUnique(ancestry, type);	// 1) create it
		const connection = this.signal_emitter.connect((received_t_signal, signalPriority, value) => {
			for (const t_signal of t_signals) {
				if (received_t_signal == t_signal && signalPriority == priority) {
					s_component?.debug_log_signal(false, value, received_t_signal, signalPriority);	// 4) use it
					onSignal(t_signal, value);
				}
			}
		});
		if (!!s_component) {
			s_component!.assure_hasConnection_atPriority(priority, connection);		// 2) register it
			return s_component;														// 3) return it
		}
		return null;
	}

	handle_anySignal_atPriority(priority: number, ancestry: Ancestry | null, type: T_Hit_Target, onSignal: (t_signal: T_Signal, value: any | null) => any ): S_Component | null {
		this.adjust_highestPriority_forAllSignals(priority);
		let s_component = components.component_forAncestry_andType_createUnique(ancestry, type);		// 1) create it
		const connection = this.signal_emitter.connect((received_t_signal, signalPriority, value) => {
			if (signalPriority == priority) {
				s_component?.debug_log_signal(false, value, received_t_signal, signalPriority);	// 4) use it
				onSignal(received_t_signal, value);
			}
		});
		if (!!s_component) {
			s_component!.assure_hasConnection_atPriority(priority, connection);		// 2) register it
			return s_component;														// 3) return it
		}
		return null;
	}

	handle_reposition_widgets_atPriority(priority: number, ancestry: Ancestry | null, type: T_Hit_Target, onSignal: (value: any | null) => any ) {
		return this.handle_signals_atPriority([T_Signal.reposition], priority, ancestry, type, onSignal);
	}

	static readonly _____TRACKING: unique symbol;

	get anySignal_isInFlight(): boolean {
		return Object.values(this.signals_inFlight_dict_byT_Signal).some(flag => !!flag);
	}

	set_signal_isInFlight_for(t_signal: T_Signal, flag: boolean) {
		this.signals_inFlight_dict_byT_Signal[t_signal] = flag;
	}

	signal_isInFlight_for(t_signal: T_Signal): boolean {
		return this.signals_inFlight_dict_byT_Signal[t_signal];
	}

	static readonly _____PRIORITY: unique symbol;

	// for each signal type, this array contains the highest requested priority
	// for each signal sent, a signal is emitted for each priority separately, in increasing priority from 0 to highest
	// each handler has a type and a priority, and ignores all emitted signals except the one matching its priority

	adjust_highestPriority_forSignals(priority: number, t_signals: Array<T_Signal>) {
		for (const t_signal of t_signals) {
			this.adjust_highestPriority_forSignal(priority, t_signal);
		}
	}

	adjust_highestPriority_forSignal(priority: number, t_signal: T_Signal) {
		const highestPriority = this.highestPriorities[t_signal];
		if (!highestPriority || priority > highestPriority) {
			this.highestPriorities[t_signal] = priority;
		}
	}

	adjust_highestPriority_forAllSignals(priority: number) {
		const all_t_signals = [T_Signal.thing, T_Signal.rebuild, T_Signal.reposition, T_Signal.alteration];
		for (const t_signal of all_t_signals) {
			this.adjust_highestPriority_forSignal(priority, t_signal);
		}
	}

}

export const signals = new Signals();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/UX.ts
```ts
import { S_Items, T_Graph, T_Search, S_Alteration, S_Title_Edit } from '../common/Global_Imports';
import { g, h, busy, debug, radial, details, controls } from '../common/Global_Imports';
import { Tag, Thing, Trait, Ancestry } from '../common/Global_Imports';
import { get, writable, derived, type Readable } from 'svelte/store';
import type { S_Recent } from '../types/Types';
import { show } from '../managers/Visibility';
import { search } from '../managers/Search';

export default class S_UX {
	w_si_grabs!			   : Readable<S_Items<Ancestry> | null>;
	w_ancestry_forDetails! : Readable<Ancestry | null>;
	w_ancestry_focus!	   : Readable<Ancestry | null>;
	w_grabs!               : Readable<Ancestry[]>;
	w_grabIndex!           : Readable<number>;

	w_s_title_edit		   = writable<S_Title_Edit | null>(null);
	w_s_alteration		   = writable<S_Alteration | null>();
	w_rubberband_grabs	   = writable<Ancestry[]>([]);  // Live grabs during rubberband (bypasses history)
	w_thing_title		   = writable<string | null>();
	w_order_changed_at	   = writable<number>(0);
	w_thing_fontFamily	   = writable<string>();

	si_expanded			   = new S_Items<Ancestry>([]); 
	si_recents			   = new S_Items<S_Recent>([]);
	si_found			   = new S_Items<Thing>([]);
	dragDotJustClicked     = false;  // Prevent Widget from double-handling drag dot clicks

	parents_focus!: Ancestry;
	prior_focus!: Ancestry;

	constructor() {
		this.w_si_grabs = derived(
			[this.si_recents.w_item],
			([recent]) => {
				return recent?.si_grabs ?? null;
			}
		);

		this.w_grabs = derived(
			[this.si_recents.w_item, this.w_rubberband_grabs],
			([recent, rubberbandGrabs]) => {
				// Rubberband grabs take priority during drag
				if (rubberbandGrabs.length > 0) {
					return rubberbandGrabs;
				}
				return recent?.si_grabs?.items ?? [];
			}
		);

		this.w_grabIndex = derived(
			[this.si_recents.w_item, this.w_rubberband_grabs],
			([recent, rubberbandGrabs]) => {
				// During rubberband, index is last item
				if (rubberbandGrabs.length > 0) {
					return rubberbandGrabs.length - 1;
				}
				return recent?.si_grabs?.index ?? 0;
			}
		);

		this.w_ancestry_focus = derived(
			[this.si_recents.w_item,
				this.w_grabIndex,
				show.w_t_graph,
				this.w_grabs],
			([item, index, mode, grabs]) => (/* (mode == T_Graph.radial && !!grabs) ? grabs[index ?? 0]?.parentAncestry :*/ item?.focus) ?? h?.rootAncestry
		);

		this.w_ancestry_forDetails = derived(
			[
				search.w_t_search,
				this.si_found.w_index,
				this.si_found.w_items,
				show.w_show_search_controls,
				this.w_ancestry_focus,
				this.w_grabs,
				this.w_grabIndex
			],
			([t_search, foundIndex, foundItems, showSearchControls, focus, grabs, grabIndex]) => {
				const row = foundIndex;
				if (row !== null && showSearchControls && t_search === T_Search.selected) {
					// First priority: search selected ancestry (if search is active)
					const thing = foundItems[row];
					if (thing?.ancestry) {
						return thing.ancestry;
					}
				}
				if (grabs.length > 0) {
					// Second priority: current grab
					const grab = grabs[grabIndex] as Ancestry | null;
					if (grab) {
						return grab;
					}
				}
				if (focus) {
					// Third priority: focus
					return focus;
				}
				return null;				// Fallback
			}
		);
	}

	//////////////////////////////
	//							//
	//	manage identifiables:	//
	//							//
	//	  grabs					//
	//	  focus					//
	//	  found					//
	//	  recents				//
	//	  expandeds				//
	//							//
	//////////////////////////////

	setup_subscriptions() {
		// Assert that si_recents is seeded before subscriptions are active
		if (typeof console !== 'undefined' && console.assert) {
			console.assert(
				this.si_recents.length > 0,
				'si_recents should be seeded before setup_subscriptions() is called',
				{ recentsLength: this.si_recents.length }
			);
		}
	}
	
	static readonly _____ANCESTRY: unique symbol;

	get ancestry_forDetails(): Ancestry | null { return get(this.w_ancestry_forDetails) ?? null; }
	
	grab_next_ancestry(next: boolean) {	// for next/previous in details selection banner
		if (get(search.w_t_search) > T_Search.off) {
			this.si_found.find_next_item(next);
		} else {
			// Mutate recent's grabIndex directly (no new history entry)
			const recent = this.si_recents.item;
			if (recent?.si_grabs) {
				recent.si_grabs.find_next_item(next);
				// Force derived stores to re-derive by updating w_items to new array reference
				this.si_recents.w_items.update(items => [...items]);
			}
		}
		details.redraw();
	}
		
	static readonly _____FOCUS: unique symbol;

	recents_go(next: boolean) {
		if (busy.isRendering) return;
		if (this.si_recents.length === 0) return;
		
		busy.isRendering = true;
		
		if (this.si_recents.find_next_item(next)) {
			const recent = this.si_recents.item;
			if (recent) {
				recent.focus?.expand();
				for (const grab of recent.si_grabs.items) {
					grab?.ancestry_assureIsVisible();
				}
				g.w_depth_limit.set(recent.depth);
				g.grand_build();
				details.redraw();
			}
		}
		
		requestAnimationFrame(() => {
			busy.isRendering = false;
		});
	}

	becomeFocus(ancestry: Ancestry): boolean {
		const priorFocus = get(this.w_ancestry_focus);
		const changed = !priorFocus || !ancestry.equals(priorFocus);
		if (changed) {
			const currentGrabs = get(this.w_grabs);
			const currentIndex = get(this.w_grabIndex);
			const si_grabs_clone = new S_Items<Ancestry>([...currentGrabs]);
			si_grabs_clone.index = currentIndex;
			const recent: S_Recent = { focus: ancestry, si_grabs: si_grabs_clone, depth: get(g.w_depth_limit) };
			this.si_recents.push(recent);
			x.w_s_alteration.set(null);
			ancestry.expand();
		}
		return changed;
	}

	update_forFocus() {
		let focus = get(this.w_ancestry_focus) ?? h.rootAncestry;
		if (get(g.w_branches_areChildren)) {
			this.parents_focus = focus;
			focus = this.prior_focus;
		} else {
			this.prior_focus = focus;
			const details = this.ancestry_forDetails;
			focus = this.parents_focus ?? (details ?? null);
		}
		focus?.becomeFocus();
	}
	
	static readonly _____GRABS: unique symbol;

	// For rubberband: update live grabs (bypasses history)
	setGrabs_forRubberband(ancestries: Ancestry[]) {
		this.w_rubberband_grabs.set(ancestries);
	}

	assure_grab_isVisible() {
		const ancestry = get(this.w_ancestry_forDetails);
		if (!!ancestry) {
			ancestry.ancestry_assureIsVisible();
			g.grand_build();
			details.redraw();
		}
	}

	grab_none() {
		if (!radial.isDragging) {
			const focus = get(this.w_ancestry_focus) ?? h.rootAncestry;
			const si_grabs_new = new S_Items<Ancestry>([]);
			const recent: S_Recent = { focus, si_grabs: si_grabs_new, depth: get(g.w_depth_limit) };
			this.si_recents.push(recent);
			h?.stop_alteration();
			debug.log_grab('  GRAB NONE');
		}
	}

	grabOnly(ancestry: Ancestry) {
		if (!radial.isDragging) {
			const focus = get(this.w_ancestry_focus) ?? ancestry;
			const si_grabs_new = new S_Items<Ancestry>([ancestry]);
			const recent: S_Recent = { focus, si_grabs: si_grabs_new, depth: get(g.w_depth_limit) };
			this.si_recents.push(recent);
			h?.stop_alteration();
			debug.log_grab(`  GRAB ONLY '${ancestry.title}'`);
		}
	}

	grab(ancestry: Ancestry) {
		if (!radial.isDragging) {
			const currentGrabs = get(this.w_grabs);
			let items = [...(currentGrabs ?? [])];
			// Use equals() instead of reference equality
			const index = items.findIndex(a => a.equals(ancestry));
			if (items.length != 0 && (index != -1) && (index != items.length - 1)) {
				items.splice(index, 1);
			}
			// Only push if not already at end
			const lastIndex = items.findIndex(a => a.equals(ancestry));
			if (lastIndex === -1) {
				items.push(ancestry);
			}
			
			const focus = get(this.w_ancestry_focus) ?? ancestry;
			const si_grabs_new = new S_Items<Ancestry>(items);
			si_grabs_new.index = items.length - 1;
			const recent: S_Recent = { focus, si_grabs: si_grabs_new, depth: get(g.w_depth_limit) };
			this.si_recents.push(recent);
			debug.log_grab(`  GRAB '${ancestry.title}'`);
			h?.stop_alteration();
		}
	}

	ungrab(ancestry: Ancestry) {
		if (!radial.isDragging) {
			const currentGrabs = get(this.w_grabs);
			let grabbed = [...(currentGrabs ?? [])];
			this.w_s_title_edit?.set(null);
			// Use equals() instead of reference equality
			const index = grabbed.findIndex(a => a.equals(ancestry));
			if (index != -1) {
				grabbed.splice(index, 1);
			}
			h?.stop_alteration();
			
			const focus = get(this.w_ancestry_focus) ?? h?.rootAncestry;
			const si_grabs_new = new S_Items<Ancestry>(grabbed);
			const recent: S_Recent = { focus, si_grabs: si_grabs_new, depth: get(g.w_depth_limit) };
			this.si_recents.push(recent);
			debug.log_grab(`  UNGRAB '${ancestry.title}'`);
		}
	}

	static readonly _____TRAITS: unique symbol;
	
	//////////////////////////////////////////////////////////////////////
	//																	//
	//	traits are managed by Things									//
	//	si_thing_traits is the list of traits for ancestry_forDetails	//
	//	trait is the current trait (independent of ancestry_forDetails)	//
	//																	//
	//////////////////////////////////////////////////////////////////////

	get trait(): Trait | null { return h.si_traits.item as Trait | null; }
	select_next_thingTrait(next: boolean) { this.si_thing_traits.find_next_item(next); }
	get thing_trait(): Trait | null { return this.si_thing_traits?.item as Trait | null; }
	get si_thing_traits(): S_Items<Trait> { return this.ancestry_forDetails?.thing?.si_traits ?? new S_Items<Trait>([]); }
	
	select_next_trait(next: boolean) {
		// not yet used, save in case we want it
		const si_traits = h.si_traits;
		if (!!si_traits && si_traits.find_next_item(next)) {
			const ancestry = si_traits.item?.owner?.ancestry;
			if (!!ancestry && ancestry.ancestry_assureIsVisible()) {
				g.grand_build();
				details.redraw();
			}
		}
	}
	
	static readonly _____TAGS: unique symbol;

	select_next_thing_tag(next: boolean) { this.si_thing_tags.find_next_item(next); }
	get si_thing_tags(): S_Items<Tag> { return this.ancestry_forDetails?.thing?.si_tags ?? new S_Items<Tag>([]); }

}

export const x = new S_UX();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Hits.ts
```ts
import { e, show, Point, radial } from '../common/Global_Imports';
import { S_Mouse, S_Hit_Target } from '../common/Global_Imports';
import { T_Drag, T_Hit_Target } from '../common/Global_Imports';
import Mouse_Timer, { T_Timer } from '../signals/Mouse_Timer';
import type { Dictionary } from '../types/Types';
import { get, writable } from 'svelte/store';
import RBush from 'rbush';

type Target_RBRect = {
	minX: number;
	minY: number;
	maxX: number;	
	maxY: number;	
	target: S_Hit_Target;
}

export default class Hits {
	disable_hover = false;
	longClick_fired: boolean = false;
	doubleClick_fired: boolean = false;
	rbush = new RBush<Target_RBRect>();
	targets_dict_byID: Dictionary<S_Hit_Target> = {};
	pending_singleClick_event: MouseEvent | null = null;
	pending_singleClick_target: S_Hit_Target | null = null;
	click_timer: Mouse_Timer = new Mouse_Timer('hits-click');
	targets_dict_byType: Dictionary<Array<S_Hit_Target>> = {};
	autorepeat_timer: Mouse_Timer = new Mouse_Timer('hits-autorepeat');
	
	w_s_hover	 = writable<S_Hit_Target | null>(null);
	w_longClick	 = writable<S_Hit_Target | null>(null);
	w_autorepeat = writable<S_Hit_Target | null>(null);
	w_dragging	 = writable<T_Drag>(T_Drag.none);

	static readonly _____HOVER: unique symbol;

	get isHovering(): boolean { return get(this.w_s_hover) != null; }
	get paging_types(): Array<T_Hit_Target> { return [T_Hit_Target.paging]; }
	get rubberband_types(): Array<T_Hit_Target> { return [T_Hit_Target.widget]; }
	get hovering_type(): T_Hit_Target | null { return get(this.w_s_hover)?.type ?? null; }
	get ring_types(): Array<T_Hit_Target> { return [T_Hit_Target.rotation, T_Hit_Target.resizing]; }
	get rbush_forRubberband(): RBush<Target_RBRect> { return this.rbush_forTypes(this.rubberband_types); }
	get isHovering_inRing(): boolean { return !!this.hovering_type && this.ring_types.includes(this.hovering_type); }
	get isHovering_inPaging(): boolean { return !!this.hovering_type && this.paging_types.includes(this.hovering_type); }
	get isHovering_inWidget(): boolean { return !!this.hovering_type && this.rubberband_types.includes(this.hovering_type); }

	private detect_hovering_at(point: Point) {
		// Skip hover detection when disabled
		if (this.disable_hover) {
			return false;
		}
		const matches = this.targets_atPoint(point);	// # should always be small (verify?)
		const match = this.targetOf_highest_precedence(matches);
		this.set_asHovering(match);
		return !!match;
	}

	static readonly _____CLICKS: unique symbol;

	handle_s_mouse_at(point: Point, s_mouse: S_Mouse): boolean {
		const matches = this.targets_atPoint(point);
		const target = this.targetOf_highest_precedence(matches) ?? matches[0];
		if (!!s_mouse.event) {
			if (s_mouse.event.metaKey && !target?.isAControl) {						// If COMMAND key is held and not on a control, pass to rubberband target (for graph dragging)
				const rubberband_target = matches.find(s => s.type === T_Hit_Target.rubberband);
				if (rubberband_target) {
					return rubberband_target.handle_s_mouse?.(s_mouse) ?? false;
				}
			}
			if (!!target) {
				if (s_mouse.isDown && s_mouse.event) {
					target.clicks += 1;
					if (target.respondsTo_autorepeat) {
						target.handle_s_mouse?.(s_mouse);
						this.start_autorepeat(target);
					} else if (target.respondsTo_longClick) {							// Long-click detection
						this.start_longClick(target, s_mouse.event);
					} else if (target.respondsTo_doubleClick) {
						if (target.clicks == 2) { // && this.click_timer.hasTimer_forID(T_Timer.double) && this.pending_singleClick_target === target) {
							target.clicks = 0;
							this.click_timer.reset();									// Second click within threshold — fire double-click
							this.doubleClick_fired = true;
							this.pending_singleClick_event = null;
							this.pending_singleClick_target = null;
							target.doubleClick_callback!(S_Mouse.double(s_mouse.event, target.html_element));
						} else if (target.clicks == 1) {								// First click — defer single-click, start timer
							this.start_doubleClick_timer(target, s_mouse.event);
						}
					} else {
						target.handle_s_mouse?.(s_mouse);
					}
				} else if (s_mouse.isUp) {
					this.cancel_longClick();
					this.stop_autorepeat();
					if (this.longClick_fired || this.doubleClick_fired) {				// Suppress mouse-up if long- or double-click already fired
						this.doubleClick_fired = false;
						this.longClick_fired = false;
						target.clicks = 0;
					} else {
						// If waiting for double-click, don't fire handle_s_mouse on mouse up
						// It will fire when the timer expires (if no second click happens)
						const waitingForDoubleClick = target.respondsTo_doubleClick && 
							this.click_timer.hasTimer_forID(T_Timer.double) && 
							this.pending_singleClick_target === target;
						if (!waitingForDoubleClick) {
							target.clicks = 0;
							return target.handle_s_mouse?.(s_mouse) ?? false;
						}
					}
				}
			}
		}
		return true;
	}

	static readonly _____MOVEMENT: unique symbol;

	handle_mouse_movement_at(point: Point) {
		if (!radial.isDragging) {
			e.throttle('hover_detection', 60, () => {
				if (get(this.w_dragging) === T_Drag.none) {
					this.detect_hovering_at(point);
				}
			});
		}
		if (show.inRadialMode) {
			e.throttle('radial_drag', 80, () => {
				radial.handle_mouse_drag();
			});
		}
	}

	static readonly _____GENERAL: unique symbol;

	reset() {
		this.rbush.clear();
		this.stop_autorepeat();
		this.cancel_longClick();
		this.w_s_hover.set(null);
		this.cancel_doubleClick();
		this.targets_dict_byID = {};
		this.longClick_fired = false;
		this.targets_dict_byType = {};
	}

	recalibrate() {
		const bush = new RBush<Target_RBRect>();
		for (const target of [...this.targets]) {
			target.update_rect();
			const rect = target.rect;
			if (!!rect) {
				this.insert_into_rbush(target, bush);
			}
		}
		this.rbush = bush;  // atomic swap
	}

	static readonly _____ADD_AND_REMOVE: unique symbol;

	add_hit_target(target: S_Hit_Target) {
		const id = target.id;
		const type = target.type;
		if (!this.targets_dict_byType[type]) {
			this.targets_dict_byType[type] = [];
		} else {
			const existing = this.targets_dict_byType[type].find(t => t.id == id);
			if (!!existing) {
				this.delete_hit_target(existing);
			}
		}
		this.targets_dict_byID[id] = target;
		this.targets_dict_byType[type].push(target);
		this.insert_into_rbush(target, this.rbush);
	}

	delete_hit_target(target: S_Hit_Target) {
		if (!!target && !!target.rect) {
			const id = target.id;
			if (!!id) {
				delete this.targets_dict_byID[id];
			}
			const type = target.type;
			const byType = this.targets_dict_byType[type];
			if (byType) {
				const index = byType.indexOf(target);
				if (index !== -1) {
					byType.splice(index, 1);
				}
			}
			this.remove_from_rbush(target, this.rbush);
		}
	}
	static readonly _____INTERNALS: unique symbol;

	private get targets(): Array<S_Hit_Target> {
		return this.rbush.all().map(rbRect => rbRect.target);
	}

	private targets_atPoint(point: Point): Array<S_Hit_Target> {
		const targets = this.rbush.search(point.asBBox).map(rbRect => rbRect.target);
		return targets.filter(target => (target.contains_point?.(point) ?? true));	// refine using shape of target
	}

	private targetOf_highest_precedence(matches: Array<S_Hit_Target>): S_Hit_Target | null {
		return matches.find(s => s.isADot)
			?? matches.find(s => s.isAWidget)
			?? matches.find(s => s.isRing)
			?? matches.find(s => s.isAControl)
			?? matches[0];
	}

	private insert_into_rbush(target: S_Hit_Target, into_rbush: RBush<Target_RBRect>) {
		const rect = target.rect;
		if (!!rect) {
			into_rbush.insert({
				minX: rect.x,
				minY: rect.y,
				maxX: rect.right,
				maxY: rect.bottom,
				target: target
			});
		}
	}

	private remove_from_rbush(target: S_Hit_Target, from_rbush: RBush<Target_RBRect>) {
		if (!!target && !!target.rect) {
			from_rbush.remove({
				minX: target.rect.x,
				minY: target.rect.y,
				maxX: target.rect.right,
				maxY: target.rect.bottom,
				target: target
			}, (a, b) => a.target === b.target);
		}
	}

	private targets_forTypes(types: Array<T_Hit_Target>): Array<S_Hit_Target> {
		const targets: Array<S_Hit_Target> = [];
		for (const type of types) {
			const byType = this.targets_dict_byType[type];
			if (!!byType && byType.length > 0) {
				targets.push(...byType);
			}
		}
		return targets;
	}

	private rbush_forTypes(types: Array<T_Hit_Target>): RBush<Target_RBRect> {
		const targets = this.targets_forTypes(types);
		const bush = new RBush<Target_RBRect>();
		for (const target of targets) {
			if (!!target && !!target.rect) {
				const rect = target.rect;
				bush.insert({
					minX: rect.x,
					minY: rect.y,
					maxX: rect.right,
					maxY: rect.bottom,
					target: target
				});
			}
		}
		return bush;
	}

	private set_asHovering(match: S_Hit_Target | null) {
		this.w_s_hover.set(!match ? null : match);
		// Stop autorepeat if hover leaves the autorepeating target
		const autorepeating_target = get(this.w_autorepeat);
		if (!!autorepeating_target && (!match || !match.hasSameID_as(autorepeating_target))) {
			this.stop_autorepeat();
		}
		// Cancel long-click if hover leaves the long-click target
		const longClick_target = get(this.w_longClick);
		if (!!longClick_target && (!match || !match.hasSameID_as(longClick_target))) {
			this.cancel_longClick();
		}
		// Cancel pending double-click if hover leaves the pending target
		if (!!this.pending_singleClick_target && (!match || !match.hasSameID_as(this.pending_singleClick_target))) {
			this.cancel_doubleClick();
		}
	}

	static readonly _____AUTOREPEAT: unique symbol;

	start_autorepeat(target: S_Hit_Target) {
		// start the timer (Mouse_Timer.autorepeat_start calls callback immediately, then starts interval)
		if (!!target && target.autorepeat_callback) {
			this.stop_autorepeat();			// stop any existing autorepeat
			const id = target.autorepeat_id ?? 0;
			this.w_autorepeat.set(target);
			this.autorepeat_timer.autorepeat_start(id, () => {
				target.autorepeat_callback?.();
			});
		}
	}

	stop_autorepeat() {
		const autorepeating_target = get(this.w_autorepeat);
		if (!!autorepeating_target) {
			this.autorepeat_timer.autorepeat_stop();
			this.w_autorepeat.set(null);
		}
	}

	static readonly _____LONG_CLICK: unique symbol;

	start_longClick(target: S_Hit_Target, event: MouseEvent) {
		if (!!target && target.longClick_callback) {
			this.cancel_longClick();
			this.w_longClick.set(target);
			this.click_timer.timeout_start(T_Timer.long, () => {
				this.longClick_fired = true;
				target.clicks = 0;
				target.longClick_callback?.(S_Mouse.long(event, target.html_element));
				this.w_longClick.set(null);
			});
		}
	}

	cancel_longClick() {
		const longClick_target = get(this.w_longClick);
		if (!!longClick_target) {
			this.click_timer.reset();
			this.w_longClick.set(null);
		}
	}

	static readonly _____DOUBLE_CLICK: unique symbol;

	start_doubleClick_timer(target: S_Hit_Target, event: MouseEvent) {
		this.pending_singleClick_target = target;
		this.pending_singleClick_event = event;
		this.click_timer.timeout_start(T_Timer.double, () => {
			if (this.pending_singleClick_target && this.pending_singleClick_event) {
				// Fire deferred single-click: only fire down event
				// The actual mouse up already happened and was suppressed
				this.pending_singleClick_target.handle_s_mouse?.(S_Mouse.down(this.pending_singleClick_event, this.pending_singleClick_target.html_element));
				this.pending_singleClick_target.clicks = 0;
				this.doubleClick_fired = true;
			}
			this.pending_singleClick_target = null;
			this.pending_singleClick_event = null;
		});
	}

	cancel_doubleClick() {
		if (this.pending_singleClick_target) {
			this.click_timer.reset();
			this.pending_singleClick_target = null;
			this.pending_singleClick_event = null;
		}
	}

}

export const hits = new Hits();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Components.ts
```ts
import { Ancestry, S_Component, T_Hit_Target } from '../common/Global_Imports';
import type { Integer, Dictionary } from '../types/Types';

export class Components {
	private components_dict_byType_andHID: Dictionary<Dictionary<S_Component>> = {};
	private _dummy!: S_Component;

	//////////////////////////////////////////////////////////////////
	//																//
	//				  state managed outside svelte					//
	//																//
	// debug logging												//
	// signal management											//
	// (?) style construction (by type and hid)						//
	// (?) unique id assignment (of html elements) for DOM lookups	//
	//																//
	//////////////////////////////////////////////////////////////////

	static readonly _____REGISTER: unique symbol;

	private component_register(s_component: S_Component) {
		const type = s_component.type;
		const hid = s_component.hid;
		if (!!hid && !!type) {
			const array = this.components_dict_byType_andHID;
			const dict = array[type] ?? {};
			dict[hid] = s_component;
			array[type] = dict;
		}
	}

	static readonly _____CREATE: unique symbol;

	get dummy(): S_Component {
		if (!this._dummy) {
			this._dummy = new S_Component(null, T_Hit_Target.none);
		}
		return this._dummy;
	}

	component_forAncestry_andType(ancestry: Ancestry | null, type: T_Hit_Target): S_Component | null {
		const dict = this.components_byHID_forType(type);
		return dict[ancestry?.hid ?? -1 as Integer] ?? null;
	}

	component_forAncestry_andType_createUnique(ancestry: Ancestry | null, type: T_Hit_Target): S_Component | null {
		let s_component: S_Component | null = this.component_forAncestry_andType(ancestry, type);
		if (!s_component) {
			s_component = new S_Component(ancestry, type);
			if (!!s_component) {
				this.component_register(s_component);
			}
		}
		return s_component;
	}

	private components_byHID_forType(type: string): { [hid: Integer]: S_Component } {
		let dict = this.components_dict_byType_andHID[type];
		if (!dict) {
			dict = {};
			this.components_dict_byType_andHID[type] = dict;
		}
		return dict;
	}

}

export const components = new Components();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Search.ts
```ts
import { k, h, p, x, core, show, Thing, details, Ancestry, databases, features } from "../common/Global_Imports";
import { T_Search, T_Startup, T_Preference, T_Search_Preference } from "../common/Global_Imports";
import { Search_Node } from '../types/Search_Node';
import { get, writable } from 'svelte/store';

class Search {
	use_AND_logic: boolean			= false; // for multi-word searches
	search_words: string[]			= []; // for multi-word searches
	search_text: string | null		= null;
	private root_node: Search_Node	= new Search_Node();
	w_search_results_found			= writable<number>(0);
	w_search_results_changed		= writable<number>(0);		// re-render the search results when changed
	w_t_search						= writable<T_Search>();		// observed by search_results, controls, and panel
	w_t_search_preferences			= writable<T_Search_Preference>();

	constructor() {
		setTimeout(() => {
			this.setup();
			if (!!databases) {
				databases.w_t_database.subscribe((database) => {
					this.setup();
				});
			}
		}, 1);
	}

	setup_defaults() {
		this.w_t_search.set(T_Search.off);
		this.w_t_search_preferences.set(T_Search_Preference.title);
	}

	activate() {
		show.w_show_search_controls.set(true);
		this.search_for(this.search_text);
	}

	deactivate() {
		this.w_search_results_found.set(0);
		this.w_t_search.set(T_Search.off);
		show.w_show_search_controls.set(false);
		details.redraw();		// force re-render of details
	}

	private setup() {
		if (features && features.allow_search && p) {
			core.w_t_startup.subscribe((startup: T_Startup) => {
				if (startup == T_Startup.ready) {
					this.search_text = p.readDB_key(T_Preference.search_text);
					this.buildIndex(h.things);
					this.w_search_results_changed.set(Date.now());
				}
			});
		}
	}

	get selected_row(): number | null { return x.si_found.index; }

	set selected_row(row: number) {
		x.si_found.index = row;
		this.w_t_search.set(T_Search.selected);
	}

	get selected_ancestry(): Ancestry | null {
		const row = this.selected_row;
		if (row !== null && !!get(show.w_show_search_controls)) {
			const thing = x.si_found.items[row];
			return thing?.ancestry ?? null;
		}
		return null;
	}

	update_search() {
		const text = this.search_text?.toLowerCase()?.trim();
		if (!!text) {
			this.buildIndex(h.things);
			this.update_search_for(text);
		}
	}

	next_row(up: boolean) {
		const row = this.selected_row;
		if (row !== null) {
			const count = x.si_found.items.length;	// stupid, but it works
			this.selected_row = row.increment(up, count);
			// also make sure the row is visible
		}
	}

	deactivate_focus_and_grab() {
		const ancestry = this.selected_ancestry;
		if (!!ancestry) {
			ancestry.becomeFocus();
			ancestry.grab();
		}
		this.deactivate();
	}

	search_for(query: string | null | undefined) {
		this.search_text = query?.toLowerCase()?.trim() ?? null;
		const before = this.results_fingerprint;
		if (!this.search_text || this.search_text.length == 0) {
			this.search_words = [];
			x.si_found.reset();
			this.w_search_results_found.set(0);
			this.w_t_search.set(T_Search.enter);
		} else {
			// Split once here
			this.search_words = this.search_text.split(/\s+/).filter(w => w.length > 0);
			
			// Pass the words array and the intersect flag
			x.si_found.items = this.root_node.search_for(this.search_words, this.use_AND_logic);
			const show_results = x.si_found.items.length > 0;
			this.w_search_results_found.set(x.si_found.items.length);
			this.w_t_search.set(show_results ? T_Search.results : T_Search.enter);
		}
		if (before !== this.results_fingerprint) {
			x.si_found.index = -1;
		}
		this.w_search_results_changed.set(Date.now());
	}
	
	update_search_for(query: string) {
		this.search_text = query;
		if (query.length > 0) {
			const lowercase = query.toLowerCase().trim();
			this.search_words = lowercase.split(/\s+/).filter(w => w.length > 0);
			x.si_found.items = this.root_node.search_for(this.search_words, this.use_AND_logic);
		} else {
			this.search_words = [];
			x.si_found.reset();
		}
	}

	static readonly _____PRIVATE: unique symbol;

	private get results_fingerprint(): string { return !x.si_found.items ? k.empty : x.si_found.items.map((result: Thing) => result.id).join('|'); }

	private buildIndex(things: Array<Thing>) {
		this.root_node = new Search_Node();
		for (const thing of things) {
			const title = thing.title.toLowerCase();
			const words = title.split(' ');
			for (const word of words) {
				// Insert the full word and all its suffixes
				for (let i = 0; i < word.length; i++) {
					const suffix = word.slice(i);
					this.root_node.insert_wordFor(suffix, thing);
				}
			}
		}
	}

}

export const search = new Search();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Visibility.ts
```ts
import { T_Graph, T_Detail, T_Kinship, T_Startup, T_Preference } from '../common/Global_Imports';
import { T_Counts_Shown, T_Auto_Adjust_Graph } from '../common/Global_Imports';
import { g, k, p, g_graph_tree } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import { get, writable } from 'svelte/store';
import { core } from '../managers/Core';
import { def } from './Preferences';

const P = T_Preference;

export class Visibility {
	w_t_auto_adjust_graph	= writable<T_Auto_Adjust_Graph | null>(def(P.auto_adjust));
	w_t_details				= writable<Array<T_Detail>>(def(P.detail_types));
	w_t_countDots			= writable<Array<T_Kinship>>(def(P.countDots));
	w_t_trees				= writable<Array<T_Kinship>>(def(P.tree));
	w_t_directionals		= writable<boolean[]>([false, true]);
	w_t_graph				= writable<T_Graph>(def(P.graph));

	w_show_countsAs			= writable<T_Counts_Shown>(def(P.show_countsAs));
	w_show_other_databases	= writable<boolean>(def(P.other_databases));
	w_show_related			= writable<boolean>(def(P.show_related));
	w_show_details			= writable<boolean>(def(P.show_details));
	w_show_save_data_button	= writable<boolean>(false);
	w_show_catalist_details = writable<boolean>(false);
	w_show_search_controls	= writable<boolean>(false);

	w_id_popupView			= writable<string | null>();
	debug_cursor			= false;

	constructor() {
		core.w_t_startup.subscribe((t_startup: T_Startup) => {
			if (t_startup == T_Startup.ready) {
				this.w_show_details.subscribe(() => {
					g.update_rect_ofGraphView();
					g.layout();
				});
			}
		});
	}

	apply_queryStrings(queryStrings: URLSearchParams) {
		const levels = queryStrings.get('levels');
		const hiddenNames = queryStrings.get('hide')?.split(k.comma) ?? [];
		const visibleNames = queryStrings.get('show')?.split(k.comma) ?? [];
		const hidden = Object.fromEntries(hiddenNames.map(s => [s, false]) ?? {});
		const visible = Object.fromEntries(visibleNames.map(s => [s, true]) ?? {});
		const keyedFlags: Dictionary<boolean> = {...visible, ...hidden};
		if (!!levels) {
			g.w_depth_limit.set(Number(levels));
		}
        for (const [name, flag] of Object.entries(keyedFlags)) {
			switch (name) {
				case 'details':
					this.w_show_details.set(flag);
					break;
				case 'related':
					this.w_show_related.set(flag);
					break;
				case 'parents':
					const mode = flag ? T_Kinship.parents : T_Kinship.children;
					g_graph_tree.set_tree_types([mode]);
					break;
			}
		}
	}

	isShowing_countDots_ofType(t_counts: T_Kinship): boolean { return get(this.w_t_countDots).includes(T_Kinship[t_counts]) }
	get children_dots(): boolean { return  this.isShowing_countDots_ofType(T_Kinship.children); }
	get related_dots(): boolean { return  this.isShowing_countDots_ofType(T_Kinship.related); }
	get parent_dots(): boolean { return  this.isShowing_countDots_ofType(T_Kinship.parents); }
	get inRadialMode(): boolean { return get(show.w_t_graph) == T_Graph.radial; }
	get inTreeMode(): boolean { return get(show.w_t_graph) == T_Graph.tree; }

	toggle_show_other_databases() {
		const other_databases = !get(this.w_show_other_databases)
		p.write_key(T_Preference.other_databases, other_databases);
		this.w_show_other_databases.set(other_databases);
	}

	restore_preferences() {
		this.w_t_countDots         .set(p.read_key(T_Preference.countDots));
		this.w_show_details        .set(p.read_key(T_Preference.show_details));
		this.w_show_related        .set(p.read_key(T_Preference.show_related));
		this.w_show_other_databases.set(p.read_key(T_Preference.other_databases));
		this.w_t_graph             .set(p.read_key(T_Preference.graph));
		this.w_t_trees             .set(p.read_key(T_Preference.tree));
		this.w_show_countsAs       .set(p.read_key(T_Preference.show_countsAs));
		this.w_t_details           .set(p.read_key(T_Preference.detail_types));
	}
	
	reactivity_subscribe() {
		function writeAnd_reactTo(t_preference: T_Preference, flag: any) {
			p.write_key(t_preference, flag);
			g.layout();
		}
		this.w_show_details.subscribe((flag: any) => {
			writeAnd_reactTo(T_Preference.show_details, flag);
		});
		this.w_show_related.subscribe((flag: any) => {
			writeAnd_reactTo(T_Preference.show_related, flag);
		});
		this.w_t_graph.subscribe((flag: any) => {
			writeAnd_reactTo(T_Preference.graph, flag);
		});
    }
}

export const show = new Visibility();```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Styles.ts
```ts

import { e, k, hits, show, colors, S_Snapshot, T_Hit_Target } from '../common/Global_Imports';
import { get } from 'svelte/store';

	//////////////////////////////////////////
	//										//
	//	Color computation functions			//
	//	Centralized logic for computing		//
	//	colors based on component state		//
	//										//
	//////////////////////////////////////////

export default class Styles {

	//////////////////////////////////////////////////////////////////////
	//																	//
	//		NOTE:														//
	//																	//
	//	if the logic below seems fine, despite a bug suggesting the		//
	//	opposite, one likely cause: reactive logic is being triggered	//
	//	by the wrong set of variables. eg, ones that might be missing:	//
	//																	//
	//		$w_mouse_button_down										//
	//		$w_ancestry_focus											//
	//		$w_s_title_edit												//
	//		$w_expanded													//
	//		$w_s_hover													//
	//		$w_grabs													//
	//																	//
	//////////////////////////////////////////////////////////////////////

	get_widgetColors_for(ss: S_Snapshot, thing_color: string, background_color: string): { color: string; background_color: string; border: string } {
		const medium = colors.background_special_blend(thing_color, k.opacity.medium);
		const faint = colors.background_special_blend(thing_color, k.opacity.faint);
		const isLight = colors.luminance_ofColor(thing_color) > 0.5;
		const isDown = get(e.w_mouse_button_down);
		const hover = get(hits.w_s_hover);
		const t_hover_target = hover?.type ?? null;
		let border = 'solid transparent 1px';
		let background = 'transparent';
		let color = thing_color;
		if (ss.isEditing) {
			background = background_color;
			border = `dashed ${thing_color} 1px`;
			color = isLight ? 'black' : thing_color;
		} else if (ss.isGrabbed) {
			color = 'white';
			background = thing_color;
			if (ss.isHovering && !isDown) {
				border = `dashed ${faint} 1px`;
			}
		} else if (ss.isFocus && !ss.isHovering) {
			color = thing_color;
			background = background_color;
			border = `solid ${thing_color} 1px`;
		} else if (ss.isHovering) {
			background = faint;
			border = this.border_for(t_hover_target, thing_color);
		} else if (t_hover_target === T_Hit_Target.drag && hover?.ancestry.id == ss.ancestry.id) {
			border = `solid ${medium} 1px`;
		}
		return { color, background_color: background, border };
	}

	get_dotColors_for(ss: S_Snapshot, element_color: string, thing_color: string, background_color: string, hoverColor: string): { fill: string; stroke: string; svg_outline_color: string } {
		const color_isInverted = (ss.isInverted ?? false) !== ss.isHovering;
		const isLight = colors.luminance_ofColor(thing_color) > 0.5;
		let outline: string;
		let stroke: string;
		let fill: string;
		if (color_isInverted) {
			fill = hoverColor;
			stroke = background_color;
		} else {
			fill = background_color;
			stroke = element_color;
		}
		if (!ss.isGrabbed && !ss.isEditing) {
			outline = thing_color;
		} else if (ss.isGrabbed && !ss.isEditing) {
			outline = background_color;
		} else {
			outline = isLight ? 'black' : hoverColor;
		}
		return { fill, stroke, svg_outline_color: outline };
	}

	get_buttonColors_for(ss: S_Snapshot, element_color: string, background_color: string, hoverColor: string, disabledTextColor: string, border_thickness: number, has_widget_context: boolean = false, thing_color: string = k.empty): { fill: string; stroke: string; border: string } {
		const border_style = (border_thickness <= 0) ? 'none' : `solid ${colors.border} ${border_thickness}px`;
		const color_isInverted = (ss.isInverted ?? false) !== ss.isHovering;
		let border: string;
		let stroke: string;
		let fill: string;
		if (ss.isDisabled) {
			fill = 'transparent';
		} else if (ss.isSelected) {
			fill = 'lightblue';
		} else if (color_isInverted) {
			fill = hoverColor;
		} else {
			fill = background_color;
		}
		if (ss.isDisabled) {
			stroke = disabledTextColor;
		} else if (color_isInverted) {
			stroke = background_color;
		} else {
			stroke = element_color;
		}
		if (has_widget_context && thing_color !== k.empty) {
			if (ss.isEditing) {
				border = `dashed ${thing_color} 1px`;
			} else if (ss.isFocus && show.inRadialMode) {
				border = `solid ${thing_color} 1px`;
			} else {
				border = border_style;
			}
		} else {
			border = border_style;
		}
		return { fill, stroke, border };
	}

	background_for(t_hover_target: T_Hit_Target | null, background_color: string): string {
		if (t_hover_target === T_Hit_Target.reveal) {
			return 'transparent';
		}
		return background_color;
	}

	border_for(t_hover_target: T_Hit_Target | null, thing_color: string): string {
		if (thing_color === k.empty) {
			return 'solid transparent 1px';
		}
		let border_color: string;
		switch (t_hover_target) {
			case T_Hit_Target.title:  border_color = thing_color;													break;
			case T_Hit_Target.reveal: border_color = 'transparent';													break;
			case T_Hit_Target.drag:   border_color = colors.background_special_blend(thing_color, k.opacity.none);	break;
			default:				  border_color = colors.background_special_blend(thing_color, k.opacity.light); break;
		}
		return `solid ${border_color} 1px`;
	}

}

export const styles = new Styles();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Geometry.ts
```ts
import { c, e, k, p, u, hits, show, debug, g_graph_tree, g_graph_radial, signals, features } from '../common/Global_Imports';
import { Rect, Size, Point, Thing, Ancestry } from '../common/Global_Imports';
import { G_Widget, T_Graph, T_Preference } from '../common/Global_Imports';
import { get, writable } from 'svelte/store';

export default class Geometry {

	static readonly _____TREE: unique symbol;

	w_depth_limit			= writable<number>(3);
	w_branches_areChildren	= writable<boolean>(true);

	static readonly _____GRAPH_VIEW: unique symbol;

	w_user_graph_center		= writable<Point>();
	w_user_graph_offset		= writable<Point>();
	w_rect_ofGraphView		= writable<Rect>();
	w_scale_factor			= writable<number>(1);

	restore_preferences() {
		this.w_depth_limit.set(p.read_key(T_Preference.levels) ?? 12);
		this.update_rect_ofGraphView();	// needed for set_scale_factor
		this.set_scale_factor(p.read_key(T_Preference.scale) ?? 1);
		this.renormalize_user_graph_offset();	// must be called after apply scale (which otherwise fubars offset)
		document.documentElement.style.setProperty('--css-body-width', this.windowSize.width.toString() + 'px');
	}

	static readonly _____GRAPHS: unique symbol;

	grand_build() {
		signals.signal_rebuildGraph_fromFocus();
	}
	
	grand_sweep() {
		this.layout();
		this.grand_build();
	}

	layout() {
		if (show.inRadialMode) {
			g_graph_radial.layout();
		} else {
			g_graph_tree.layout();
		}
		// NB: set html element fails (in S_Component)
		// if id does not match, or exist yet
		signals.signal_reposition_widgets_fromFocus();
		setTimeout(() => hits.recalibrate(), 100);
	}

	grand_adjust_toFit() {
		const graphView_size = get(this.w_rect_ofGraphView).size;
		const layout_size = this.rect_ofAllWidgets.size;
		const scale_factor = layout_size.best_ratio_to(graphView_size);
		const new_size = layout_size.dividedEquallyBy(scale_factor);
		const new_offset = get(this.w_user_graph_offset).dividedEquallyBy(scale_factor);
		// also detect if layout is really needed by difference from prior center and offset
		this.w_user_graph_center.set(new_size.asPoint.dividedInHalf);
		this.w_user_graph_offset.set(new_offset);
		this.set_scale_factor(scale_factor);
		this.layout();
	}

	static readonly _____WIDGETS: unique symbol;

	get rect_ofAllWidgets(): Rect { return u.get_rect_ofGraphDrawing_forAll_g_widgets(this.all_g_widgets); }

	get all_g_widgets(): G_Widget[] {
		if (show.inRadialMode) {
			return g_graph_radial.visible_g_widgets;
		} else {
			return g_graph_tree.visible_g_widgets;
		}
	}

	static readonly _____RECT_OF_GRAPH_VIEW: unique symbol;

	get center_ofGraphView(): Point { return get(this.w_rect_ofGraphView).size.asPoint.dividedInHalf; }

	update_rect_ofGraphView() {
		// respond to changes in: window size & details visibility
		const secondary_below_primary_controls = features.allow_tree_mode && (get(show.w_show_search_controls) || (get(show.w_t_graph) == T_Graph.tree));
		const y = (this.controls_boxHeight) * (secondary_below_primary_controls ? 2 : 1) - 5;	// below primary and secondary controls
		const x = get(show.w_show_details) ? k.width.details : 5;							// right of details
		const origin_ofGraphView = new Point(x, y);
		const size_ofGraphView = this.windowSize.reducedBy(origin_ofGraphView).reducedBy(Point.square(k.thickness.separator.main - 1));
		const rect = new Rect(origin_ofGraphView, size_ofGraphView);
		debug.log_mouse(`GRAPH View ====> ${rect.description}`);
		this.w_rect_ofGraphView.set(rect);													// emits a signal, to adjust the graph location
		// Update graph center to keep hit testing in sync with visual position
		const user_offset = get(this.w_user_graph_offset) ?? Point.zero;
		this.w_user_graph_center.set(rect.center.offsetBy(user_offset));
		// Recalibrate hit target positions after rect change
		setTimeout(() => hits.recalibrate(), 100);
	}

	static readonly _____USER_OFFSET: unique symbol;
	
	renormalize_user_graph_offset() { this.set_user_graph_offsetTo(this.persisted_user_offset); }
	get user_offset_toGraphDrawing(): Rect { return this.rect_ofAllWidgets.offsetBy(get(this.w_user_graph_offset)); }
	get mouse_distance_fromGraphCenter(): number { return this.mouse_vector_ofOffset_fromGraphCenter()?.magnitude ?? 0; }
	get mouse_angle_fromGraphCenter(): number | null { return this.mouse_vector_ofOffset_fromGraphCenter()?.angle ?? null; }

	get persisted_user_offset(): Point {
		const point = p.read_key(T_Preference.user_offset) ?? {x:0, y:0};
		return new Point(point.x, point.y);
	}

	mouse_vector_ofOffset_fromGraphCenter(offset: Point = Point.zero): Point | null {
		const scaled_mouse_location = get(e.w_mouse_location_scaled);
		return this.vector_fromScaled_mouseLocation_andOffset_fromGraphCenter(scaled_mouse_location, offset);
	}

	vector_fromScaled_mouseLocation_andOffset_fromGraphCenter(mouse_location: Point, offset: Point = Point.zero): Point | null {
		if (!!mouse_location) {
			const center_offset = get(this.w_user_graph_center).offsetBy(offset);
			const mouse_vector = center_offset.vector_to(mouse_location);
			debug.log_mouse(`offset  ${get(this.w_user_graph_offset).verbose}  ${mouse_vector.verbose}`);
			return mouse_vector;
		}
		return null
	}

	set_user_graph_offsetTo(user_offset: Point): boolean {
		// user_offset of zero centers the graph
		let changed = false;
		const current_offset = get(this.w_user_graph_offset);
		if (!!current_offset && current_offset.vector_to(user_offset).magnitude > 1) {
			p.write_key(T_Preference.user_offset, user_offset);								// persist user_offset
			changed = true;
		}
		const center_offset = get(this.w_rect_ofGraphView).center.offsetBy(user_offset);	// center of the graph in window coordinates
		this.w_user_graph_center.set(center_offset);										// w_user_graph_center: a signal change
		this.w_user_graph_offset.set(user_offset);											// w_user_graph_offset: a signal change
		debug.log_mouse(`USER ====> ${user_offset.verbose}  ${center_offset.verbose}`);
		if (changed) {
			setTimeout(() => {
				hits.recalibrate();
			}, 100);
		}
		return changed;
	}

	ancestry_isCentered(ancestry: Ancestry | null): boolean {
		const title_center = ancestry?.center_ofTitle;
		if (!!title_center) {
			const center = get(this.w_user_graph_center);
			const user_offset = get(this.w_user_graph_offset);
			const delta = title_center.vector_to(center).vector_to(user_offset).magnitude;
			return delta < 1;
		}
		return false;
	}

	ancestry_place_atCenter(ancestry: Ancestry | null) {
		const title_center = ancestry?.center_ofTitle;
		if (!!title_center) {
			const center = get(this.w_user_graph_center);
			const offset = title_center.vector_to(center);	// use this vector to set the user graph offset
			this.set_user_graph_offsetTo(offset);
		}
	}

	static readonly _____DETAILS: unique symbol;

	get glows_banner_height(): number { return get(c.w_device_isMobile) ? 32 : 20; }
	get controls_boxHeight(): number { return this.glows_banner_height + k.height.segmented; }

	static readonly _____BREADCRUMBS: unique symbol;

	get breadcrumbs_top(): number { return this.windowSize.height - this.controls_boxHeight; }

	layout_breadcrumbs(ancestries: Array<Ancestry>, centered: boolean, left: number, thresholdWidth: number): [Array<Ancestry>, Array<number>, Array<number>, number] {
		if (!ancestries) {
			return [[], [], [], 0];
		}
		const crumb_ancestries: Array<Ancestry> = [];
		const widths: Array<number> = [];
		let parent_widths = 0;						// encoded as one parent count per 2 digits (base 10) ... for triggering redraw
		let total = 0;								// determine how many crumbs will fit
		for (const a of ancestries.reverse()) {
			if (!!a.thing) {
				const width = u.getWidthOf(a.thing.breadcrumb_title) + 29;	// 29 px gap for separator character and button border
				if ((total + width) > thresholdWidth) {
					break;
				}
				total += width;
				widths.push(width);
				crumb_ancestries.push(a);
				debug.log_crumbs(`ONE ${width} ${a.thing.title}`);
				parent_widths = parent_widths * 100 + width;
			}
		}
		if (centered) {
			left += (thresholdWidth - total) / 2;
		}
		let lefts = [left];
		for (const width of widths.reverse()) {
			left += width;				// position of next crumb
			lefts.push(left);
		}
		return [crumb_ancestries.reverse(), widths.reverse(), lefts, parent_widths];
	}

	static readonly _____WINDOW: unique symbol;
	
	get windowScroll(): Point { return new Point(window.scrollX, window.scrollY); }
	get inner_windowSize(): Size { return new Size(window.innerWidth, window.innerHeight); }
	get windowSize(): Size { return this.inner_windowSize.dividedEquallyBy(get(this.w_scale_factor)); }

	static readonly _____SCALE_FACTOR: unique symbol;

	scaled_rect_forElement(element: HTMLElement | null): Rect | null {
		const scale_factor = get(this.w_scale_factor);
		const rect = Rect.rect_forElement(element);
		return !!rect ? rect.dividedEquallyBy(scale_factor) : null;
	}

	set_scale_factor(scale_factor: number) {
		// this.w_scale_factor.set(scale_factor);	// needed to edit things
		// p.write_key(T_Preference.scale, scale_factor);
		// const doc = document.documentElement;
		// doc.style.setProperty('zoom', scale_factor.toString());
		// doc.style.height = `${100 / scale_factor}%`;
		// doc.style.width = `${100 / scale_factor}%`;
		// this.update_rect_ofGraphView();
	}

}

export const g = new Geometry();```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Details.ts
```ts
import { T_Search, T_Detail, T_Direction, T_Storage_Need } from '../common/Global_Imports';
import { S_Banner_Hideable } from '../state/S_Banner_Hideable';
import { x, show, search } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import { get } from 'svelte/store';

class Details {
	s_banner_hideables_dict_byType: Dictionary<S_Banner_Hideable> = {};
	t_storage_need = T_Storage_Need.direction;
	show_properties = false;

	constructor() {
		for (const t_detail of Object.values(T_Detail) as T_Detail[]) {
			this.s_banner_hideables_dict_byType[t_detail] = new S_Banner_Hideable(t_detail);
		}
	}
		
	details_toggle_visibility() { show.w_show_details.update(n => !n); }
		
	static readonly _____BANNERS: unique symbol;

	redraw() {
		// e.w_count_details.update(n => n + 1); 	// force re-render of details
		// hits.recalibrate();
	}

	select_next(banner_id: string, selected_title: string) {
		const next = T_Direction.next === selected_title as unknown as T_Direction;	// unknown defeats ts type check
		const t_detail = T_Detail[banner_id as keyof typeof T_Detail];
		switch (t_detail) {
			case T_Detail.traits:	 x.select_next_thingTrait(next); break;
			case T_Detail.tags:  	 x.select_next_thing_tag(next); break;
			case T_Detail.selection: x.grab_next_ancestry(next); break;
		}
	}

	banner_title_forDetail(t_detail: T_Detail, passedGrabs?: any[], passedGrabIndex?: number): string {
		const si_items = this.s_banner_hideables_dict_byType[t_detail].si_items;
		let title = T_Detail[t_detail];
		switch (t_detail) {
			case T_Detail.tags:
				title = si_items?.title('tag', 'tags', title) ?? 'tags';
				break;
			case T_Detail.traits:
				title = si_items?.title('trait', 'traits', title) ?? 'traits';
				break;
			case T_Detail.selection:
				const si_found = x.si_found;
				const row	   = si_found.index;
				const found    = si_found.length;
				// Use passed values if available, otherwise fall back to get()
				const grabs = passedGrabs ?? get(x.w_grabs);
				const grabIndex = passedGrabIndex ?? get(x.w_grabIndex);
				if (row != null && !!found && found > 1 && get(search.w_t_search) != T_Search.off) {
					title = si_found.title('search result', 'focus', title);
				} else if (grabs.length > 1) {
					title = grabIndex.of_n_for_type(grabs.length, 'selected', '');
				} else if (grabs.length === 1) {
					title = 'selection';
				} else {
					title = 'focus';
				}
				break;
			default:
				break;
		}
		return title;
	}

}

export const details = new Details();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Hierarchy.ts
```ts
import { T_Create, T_Startup, T_Alteration, T_File_Extension, T_Persistable } from '../common/Global_Imports';
import { Access, Ancestry, Predicate, Relationship, Persistable } from '../common/Global_Imports';
import { g, k, p, u, x, busy, show, debug, features, databases } from '../common/Global_Imports';
import { T_Thing, T_Trait, T_Order, T_Control, T_Predicate } from '../common/Global_Imports';
import { Tag, User, Thing, Trait, S_Items } from '../common/Global_Imports';
import DB_Common, { DB_Name, T_Database } from '../database/DB_Common';
import DB_Filesystem from '../database/DB_Filesystem';
import type { Integer, Dictionary } from '../types/Types';
import { files, colors } from '../common/Global_Imports';
import Identifiable from '../runtime/Identifiable';
import { pivot } from '../files/Pivot';
import { get } from 'svelte/store';
import { core } from './Core';

export let h!: Hierarchy;
core.w_hierarchy.subscribe(value => h = value);
export type Ancestry_ByHID = { [hid: Integer]: Ancestry }
export type SI_Relationships_ByHID = { [hid: Integer]: S_Items<Relationship> }

export class Hierarchy {
	private si_ancestries_dict_byThingHID: Record<Integer, S_Items<Ancestry>> = {};
	private si_relationships_dict_byKind: Dictionary<S_Items<Relationship>> = {};
	private predicate_dict_byDirection: Record<number, Array<Predicate>> = {};
	private si_traits_dict_byOwnerHID: Record<Integer, S_Items<Trait>> = {};
	private si_traits_dict_byThingHID: Record<Integer, S_Items<Trait>> = {};
	private si_relationships_dict_byParentHID: SI_Relationships_ByHID = {};
	private si_relationships_dict_byChildHID: SI_Relationships_ByHID = {};
	private ancestry_dict_byKind_andHID: Dictionary<Ancestry_ByHID> = {};
	private relationship_dict_byHID: Record<Integer, Relationship> = {};
	private si_tags_dict_byThingHID: Record<Integer, S_Items<Tag>> = {};
	private si_things_dict_byT_trait: Dictionary<S_Items<Thing>> = {};
	private si_traits_dict_byType: Dictionary<S_Items<Trait>> = {};
	private thing_dict_byAncestryHID: Record<Integer, Thing> = {};
	private ancestry_dict_byHID: Record<Integer, Ancestry> = {};
	private things_dict_byType: Dictionary<Array<Thing>> = {};
	private things_dict_byTitle: Dictionary<Array<Thing>> = {};
	private predicate_dict_byKind: Dictionary<Predicate> = {};
	private access_dict_byHID: Record<Integer, Access> = {};
	private thing_dict_byHID: Record<Integer, Thing> = {};
	private trait_dict_byHID: Record<Integer, Trait> = {};
	private access_dict_byKind: Dictionary<Access> = {};
	private user_dict_byHID: Record<Integer, User> = {};
	private tag_dict_byHID: Record<Integer, Tag> = {};
	private tag_dict_byType: Dictionary<Tag> = {};

	ids_translated: Dictionary<string> = {};
	replace_rootID: string | null = k.empty;		// required for DB_Local at launch
	si_traitThings = new S_Items<Thing>([]);		// ALL things that have traits
	relationships: Array<Relationship> = [];
	si_traits = new S_Items<Trait>([]);
	predicates: Array<Predicate> = [];
	si_tags = new S_Items<Tag>([]);
	externalsAncestry!: Ancestry;
	things: Array<Thing> = [];
	rootAncestry!: Ancestry;
	isAssembled = false;
	db: DB_Common;
	root!: Thing;

	constructor(db: DB_Common) {
		this.db = db;
	}

	persistables_forKey(t_persistable: T_Persistable): Array<Persistable> {
		switch (t_persistable) {
			case T_Persistable.relationships: return this.relationships;
			case T_Persistable.predicates:	  return this.predicates;
			case T_Persistable.things:		  return this.things;
			case T_Persistable.traits:		  return this.traits;
			case T_Persistable.tags:		  return this.tags;
			default: return [];
		}
	}

	static readonly _____ROOT: unique symbol;

	get hasRoot(): boolean { return !!this.root; }
	get idRoot(): string | null { return this.root?.id ?? null; };

	assure_root_andAncestry() {
		let rootAncestry = this.rootAncestry;
		if (!rootAncestry) {
			rootAncestry = this.ancestry_remember_createUnique();
			this.rootAncestry = rootAncestry;
		}
		const root = rootAncestry.thing;
		if (!!root) {
			this.root = root;
		}
	}
	
	static readonly _____THINGS: unique symbol;

	get si_things_unique_havingTraits(): S_Items<Thing> { return this.si_traitThings; }
	things_forTitle(title: string): Array<Thing> | null { return this.things_dict_byTitle[title] ?? null; }

	things_refreshKnowns() {
		const saved = this.things;
		this.things_forget_all();
		saved.map(t => this.thing_remember(t));
	}

	things_forget_all() {
		this.things = []; // clear
		this.thing_dict_byHID = {};
		this.things_dict_byType = {};
	}

	things_forAncestries(ancestries: Array<Ancestry>): Array<Thing> {
		const things = Array<Thing>();
		for (const ancestry of ancestries) {
			const thing = ancestry?.thing;
			if (!!thing) {
				things.push(thing);
			}
		}
		return things;
	}

	things_forAncestry(ancestry: Ancestry): Array<Thing> {
		const isContains = ancestry.kind == T_Predicate.contains;
		const relationship_hids = ancestry.relationship_hids;
		let things: Array<Thing> = isContains ? [this.root] : [];
		if (!isContains || relationship_hids.length != 0) {
			for (const relationship_hid of relationship_hids) {
				const relationship = this.relationship_forHID(relationship_hid);
				if (!!relationship) {
					if (!!relationship.parent && things.length == 0) {
						things.push(relationship.parent);
					}
					if (!!relationship.child) {
						things.push(relationship.child);
					}
				}
			}
		}
		return things;
	}

	static readonly _____THING: unique symbol;
	
	thing_forHID(hid: Integer): Thing | null { return this.thing_dict_byHID[hid ?? undefined]; }

	thing_remember_updateID_to(thing: Thing, idTo: string) {
		const idFrom = thing.id;
		this.thing_forget(thing);
		thing.setID(idTo);
		this.thing_remember(thing);
		this.relationships_translate_idsFromTo_forParents(idFrom, idTo, false);
		this.relationships_translate_idsFromTo_forParents(idFrom, idTo, true);
		this.traits_translate_idsFromTo_forThings(idFrom, idTo);
		this.tags_translate_idsFromTo_forThings(idFrom, idTo);
	}

	thing_remember_runtimeCreateUnique(idBase: string, id: string, title: string, color: string = colors.default_forThings, t_thing: T_Thing = T_Thing.generic,
		already_persisted: boolean = false): Thing {
		let thing = this.thing_forHID(id?.hash() ?? null);
		if (!thing) {
			thing = this.thing_remember_runtimeCreate(idBase, id, title, color, t_thing, already_persisted);
		}
		return thing;
	}

	thing_remember_runtimeCreate(idBase: string, id: string, title: string, color: string, t_thing: T_Thing = T_Thing.generic,
		already_persisted: boolean = false, needs_upgrade: boolean = false): Thing {
		const thing = this.thing_runtimeCreate(idBase, id, title, color, t_thing, already_persisted);
		this.thing_remember(thing);
		if (needs_upgrade) {
			thing.set_isDirty();	// add type and remove trait fields
		}
		return thing;
	}

	async thing_remember_runtimeCopy(idBase: string, original: Thing) {
		const copiedThing = new Thing(idBase, Identifiable.newID(), original.title, original.color, original.t_thing);
		const prohibitedTraits: string[] = [T_Thing.externals, T_Thing.root, T_Thing.bulk];
		if (prohibitedTraits.includes(original.t_thing)) {
			copiedThing.t_thing = T_Thing.generic;
		}
		this.thing_remember(copiedThing);
		return copiedThing;
	}

	async thing_edit_persistentAddLine(ancestry: Ancestry, below: boolean = true) {
		const parentAncestry = ancestry.parentAncestry;
		const parent = parentAncestry?.thing;
		const thing = ancestry.thing;
		if (!!thing && parent && parentAncestry) {
			const order = ancestry.order + (below ? k.halfIncrement : -k.halfIncrement);
			const child = this.thing_runtimeCreate(thing.idBase, Identifiable.newID(), k.title.line, parent.color, T_Thing.generic);
			await this.ancestry_edit_persistentAddAsChild(parentAncestry, child, order, false);
		}
	}

	async thing_edit_persistentDuplicate(ancestry: Ancestry) {
		const thing = ancestry.thing;
		const id = thing?.id;
		const parentAncestry = ancestry.parentAncestry;
		if (!!thing && id && parentAncestry) {
			const sibling = await this.thing_remember_runtimeCopy(id, thing);
			sibling.title = 'idea';
			await this.ancestry_edit_persistentAddAsChild(parentAncestry, sibling, ancestry.order + k.halfIncrement);
		}
	}

	async thing_remember_persistentRelocateChild(child: Thing, fromParent: Thing, toParent: Thing): Promise<any> {
		let relationship = this.relationship_whereHID_isChild(child.hid);
		if (!!relationship && relationship.idParent == fromParent.id) {
			relationship.assign_idParent(toParent.id);
			if (relationship.isValid) {
				await relationship.persist();
			}
		}
	}

	thing_forAncestry(ancestry: Ancestry): Thing | null {
		let thing: Thing | null = this.thing_dict_byAncestryHID[ancestry.hid];
		if (!thing) {
			if (ancestry.isRoot) {
				thing = this.root;
			} else {
				thing = ancestry.thingAt(1) ?? null;	// always recompute
			}
			if (!!thing) {
				this.thing_dict_byAncestryHID[ancestry.hid] = thing;
			}
		}
		return thing;
	}

	thing_forget(thing: Thing, force: boolean = false) {
		const t_thing = thing.t_thing;
		if (t_thing != T_Thing.root || force) {		// must NOT forget root, unless forced to do so
			const typed_things = this.things_dict_byType[t_thing];
			const titled_things = this.things_dict_byTitle[thing.title];
			delete this.thing_dict_byHID[thing.hid];
			this.things = Identifiable.remove_item_byHID<Thing>(this.things, thing);
			if (!!typed_things) {
				delete this.things_dict_byType[t_thing];
			}
			if (!!titled_things) {
				delete this.things_dict_byTitle[thing.title];
			}
		}
	}

	thing_remember(thing: Thing) {
		if (!!thing && !this.thing_forHID(thing.hid)) {
			const typed_things = this.things_dict_byType[thing.t_thing] ?? [];
			const titled_things = this.things_dict_byTitle[thing.title] ?? [];
			this.thing_dict_byHID[thing.hid] = thing;
			if (!this.things.map(t => t.id).includes(thing.id)) {
				this.things.push(thing);
			}
			if (thing.isRoot && (!thing.idBase || [DB_Name.bulks, this.db.idBase].includes(this.db.idBase))) {
				if (!!this.root) {
					this.thing_forget(this.root);	// for bubble starting object
				}
				this.root = thing;
			}
			if (!typed_things.map(t => t.id).includes(thing.id)) {
				typed_things.push(thing);
				this.things_dict_byType[thing.t_thing] = typed_things;
			}
			if (!titled_things?.includes(thing)) {
				titled_things.push(thing);
				this.things_dict_byTitle[thing.title] = titled_things;
			}
		}
	}

	thing_runtimeCreate(idBase: string, id: string, title: string, color: string, t_thing: T_Thing,
		already_persisted: boolean = false): Thing {
		let thing: Thing | null = null;
		if (id && t_thing == T_Thing.root && idBase != this.db.idBase) {			// other bulks have their own root & id
			thing = this.bulkAlias_remember_forRootID_create(idBase, id, color);		// which our thing needs to adopt
		} else {
			thing = new Thing(idBase, id, title, color, t_thing, already_persisted);
			if (thing.isBulkAlias) {
				thing.persistence.needsBulkFetch = true;
				if (title.includes('@')) {
					const parts = title.split('@');
					thing.title = parts[0];
					thing.bulkRootID = parts[1];
				}
			}
		}
		return thing!;
	}

	thing_extract_fromDict(dict: Dictionary) {
		let t_thing = dict.t_thing;
		const root = this.root;
		const isRootDict = t_thing == T_Thing.root;
		if ((!root && isRootDict) || (this.replace_rootID != dict.id)) {
			if (!!root && isRootDict) {
				t_thing = k.empty;			// prevent multiple roots
			}
			this.thing_remember_runtimeCreateUnique(this.db.idBase, dict.id, dict.title, dict.color, t_thing);
		} else if (!!root && isRootDict && !this.db.isRemote) {
			root.title = dict.title;	// new title for root (only in local or test)
		}
	}

	async thing_forget_persistentDelete(thing: Thing) {
		const relationships = u.uniquely_concatenateArrays_ofIdentifiables(
			this.si_relationships_dict_byParentHID[thing.hid]?.items ?? [],
			this.si_relationships_dict_byChildHID[thing.hid]?.items ?? []
		) as Array<Relationship>;
		thing.remove_fromGrabbed_andExpanded_andResolveFocus();
		this.thing_forget(thing);				// forget so onSnapshot logic will not signal children, do first so UX updates quickly
		await this.db.thing_persistentDelete(thing);
		for (const ancestry of thing.ancestries) {
			this.ancestry_forget(ancestry);
		}
		for (const trait of thing.si_traits?.items ?? []) {
			this.trait_forget(trait)
			await this.db.trait_persistentDelete(trait);
		}
		for (const relationship of relationships) {
			this.relationship_forget(relationship);		// forget so onSnapshot logic will not signal children
			await this.db.relationship_persistentDelete(relationship);
		}
	}

	static readonly _____BULKS: unique symbol;

	bulkAlias_forTitle(title: string | null) {
		if (!!title) {
			const bulkAliases = this.things_dict_byType[T_Thing.bulk] ?? [];
			for (const bulkAlias of bulkAliases) {
				if  (bulkAlias.title == title) {		// special case TODO: convert to a query string
					return bulkAlias;
				}
			}
		}
		return null;
	}

	bulkAlias_remember_forRootID_create(title: string, rootID: string, color: string) {
		const bulkAlias = this.bulkAlias_forTitle(title);
		if (!!bulkAlias) {
			// rootID is of the root thing from bulk fetch all
			// i.e., it is the root id from another idBase (title)
			// need a second thing remembered by this root id
			// so children relationships will work
			this.thing_dict_byHID[rootID.hash()] = bulkAlias;
			bulkAlias.persistence.needsBulkFetch = true;
			bulkAlias.bulkRootID = rootID;
			bulkAlias.color = color;
		}
		return bulkAlias;
	}

	async bulkAlias_remember_recursive_persistentRelocateRight(ancestry: Ancestry, parentAncestry: Ancestry) {
		const parent = parentAncestry.thing;
		let newThingAncestry: Ancestry | null = null;
		const thing = ancestry.thing;
		if (!!thing && parent) {
			const idBase = parent.isBulkAlias ? parent.title : parent.idBase;
			const newThing = await this.thing_remember_runtimeCopy(idBase, thing);
			newThingAncestry = parentAncestry.ancestry_createUnique_byAddingThing(newThing);
			if (!!newThingAncestry) {
				await parentAncestry.ancestry_persistentCreateUnique_byAddingThing(newThing);
				for (const childAncestry of ancestry.childAncestries) {
					this.bulkAlias_remember_recursive_persistentRelocateRight(childAncestry, newThingAncestry);
				}
				if (!newThingAncestry.isExpanded) {
					setTimeout(() => {
						if (!!newThingAncestry) {
							newThingAncestry.expand();	
							ancestry.collapse()
						};
					}, 2);
				}
				await this.ancestry_forget_persistentUpdate(ancestry);
			}
		}
		return newThingAncestry;
	}

	static readonly _____RELATIONSHIPS: unique symbol;

	si_relationships_forKind(kind: T_Predicate): S_Items<Relationship> { return this.si_relationships_dict_byKind[kind] ?? new S_Items<Relationship>([]); }

	relationships_refreshKnowns() {
		const saved = this.relationships;
		this.relationships_forget_all();
		saved.map(r => this.relationship_remember(r));
	}

	relationships_inBothDirections_forThing_andKind(thing: Thing, kind: string): Array<Relationship> {
		const childrenRelationships = this.relationships_ofKind_forParents_ofThing(kind, false, thing);
		const parentsRelationships = this.relationships_ofKind_forParents_ofThing(kind, true, thing);
		return u.uniquely_concatenateArrays_ofIdentifiables(parentsRelationships, childrenRelationships) as Array<Relationship>;
	}

	relationships_forget_all() {
		this.si_relationships_dict_byParentHID = {};
		this.si_relationships_dict_byChildHID = {};
		this.relationship_dict_byHID = {};
		this.relationships = [];
	}

	relationships_areAllValid_forIDs(ids: string[]) {
		for (const id of ids) {		// ignore empty id (root placeholder)
			if (id != k.empty && !this.relationship_forHID(id.hash())) {
				return false;
			}
		}
		return true;
	}

	relationships_ofKind_forParents_ofThing(kind: string, forParents: boolean, thing: Thing | null): Array<Relationship> {
		if (!!thing) {
			const id = forParents ? thing.id : thing.idBridging;		//  use idBridging for children, in case thing is a bulk alias
			if ((!!id || id == k.empty) && id != k.unknown) {
				return this.relationships_forKindPredicate_hid_thing_isChild(kind, id.hash(), forParents);
			}
		}
		return [];
	}

	relationships_forParent_ofKind(parent: Thing, predicate: Predicate): Array<Relationship> {
		let relationships: Array<Relationship> = [] 
		if (predicate.isBidirectional) {
			relationships = h.relationships_inBothDirections_forThing_andKind(parent, predicate.kind);
		} else {
			relationships = h.relationships_ofKind_forParents_ofThing(predicate.kind, true, parent);
		}
		return relationships;
	}

	relationships_forKindPredicate_hid_thing_isChild(kind: string, hid: Integer, forParents: boolean): Array<Relationship> {
		const dict = forParents ? this.si_relationships_dict_byChildHID : this.si_relationships_dict_byParentHID;
		const si_matches = dict[hid];
		const array: Array<Relationship> = [];
		if (si_matches) {
			for (const relationship of si_matches.items) {
				if (relationship.kind == kind && !array.includes(relationship)) {
					array.push(relationship);
				}
			}
		}
		return array;
	}

	async relationships_removeHavingNullReferences() {
		// const array = Array<Relationship>();
		for (const relationship of this.relationships) {
			if (!relationship.child || !relationship.parent) {
				console.warn(`has null reference ${relationship.description}`);
				// array.push(relationship);
			}
		}
		// for (const relationship of array) {
		// 	console.log(`has null reference ${relationship.description}`);
		// 	this.relationship_forget(relationship);
		// 	await this.db.relationship_persistentDelete(relationship);
		// }
	}

	relationships_translate_idsFromTo_forParents(idFrom: string, idTo: string, forParents: boolean) {
		for (const predicate of this.predicates) {
			const relationships = this.relationships_forKindPredicate_hid_thing_isChild(predicate.kind, idFrom.hash(), forParents);
			for (const relationship of relationships) {
				if (!forParents && relationship.idParent != idTo) {
					relationship.assign_idParent(idTo);
				}
				if (forParents && relationship.idChild != idTo) {
					this.relationship_forget(relationship);
					relationship.hidChild = idTo.hash();
					relationship.idChild = idTo;
					relationship.set_isDirty();
					this.relationship_remember(relationship);
				}
			}
		}
	}

	static readonly _____RELATIONSHIP: unique symbol;

	relationship_forHID(hid: Integer): Relationship | null { return this.relationship_dict_byHID[hid ?? undefined]; }

	relationship_whereHID_isChild(hid_thing: Integer, isChild: boolean = true): Relationship | null {
		const matches = this.relationships_forKindPredicate_hid_thing_isChild(T_Predicate.contains, hid_thing, isChild);
		return matches.length == 0 ? null : matches[0];
	}

	relationship_remember_ifValid(relationship: Relationship) {
		if (relationship.isValid) {
			this.relationship_remember(relationship);
		} else {
			console.warn(`invalid relationship ${relationship.description}`);
		}
	}
	
	relationship_forget_forHID(si_relationships_dict_byHID: SI_Relationships_ByHID, hid: Integer, relationship: Relationship) {
		let si_relationships = si_relationships_dict_byHID[hid];
		if (!!si_relationships) {
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Features.ts
```ts
import { k, show, T_Theme, T_Counts_Shown } from '../common/Global_Imports';

export class Features {

	theme = T_Theme.standalone;

	has_zoom_controls	 = false;	// NB: hidden until implemented
	has_details_button 	 = true;
	has_every_detail	 = true;
	has_rubber_band		 = true;

	allow_graph_editing	 = true;
	allow_title_editing	 = true;
	allow_h_scrolling	 = true;
	allow_tree_mode		 = true;
	allow_autoSave		 = true;
	allow_search		 = true;

	apply_queryStrings(queryStrings: URLSearchParams) {
        const themeOptions	 = queryStrings.get('theme')?.split(k.comma) ?? [];
        const disableOptions = queryStrings.get('disable')?.split(k.comma) ?? [];
		for (const disableOption of disableOptions) {
			switch (disableOption) {
				case 'editGraph':			this.allow_graph_editing = false; break;
				case 'editTitles':			this.allow_title_editing = false; break;
				case 'details':				this.has_details_button	 = false; break;
				case 'horizontalScrolling': this.allow_h_scrolling	 = false; break;
				case 'tree_mode':			this.allow_tree_mode	 = false; break;
				case 'auto_save':			this.allow_autoSave		 = false; break;
				case 'search':				this.allow_search		 = false; break;
			}
		}
		for (const themeOption of themeOptions) {
			switch (themeOption) {
				case 'bubble':
					show.w_show_countsAs  .set(T_Counts_Shown.numbers);
					this.theme				 = T_Theme.bubble;
					this.allow_graph_editing = false;
					this.allow_title_editing = false;
					this.allow_h_scrolling	 = false;
					this.allow_autoSave		 = false;
					this.has_rubber_band	 = false;
					this.has_every_detail	 = false;
					this.has_details_button  = false;
					break;
			}
		}
    }

}

export const features = new Features();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Core.ts
```ts
import { T_Startup } from '../common/Enumerations';
import { Hierarchy } from '../managers/Hierarchy';
import { writable } from 'svelte/store';

export class Core {

	w_t_startup	= writable<T_Startup>(T_Startup.start);
	w_hierarchy	= writable<Hierarchy>();

}

export const core  = new Core();

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Preferences.ts
```ts
import { c, g, h, k, u, x, show, debug, radial, Ancestry, databases } from '../common/Global_Imports';
import { T_Graph, T_Kinship, T_Detail, T_Counts_Shown } from '../common/Global_Imports';
import { S_Items, T_Preference, T_Auto_Adjust_Graph } from '../common/Global_Imports';
import type { S_Recent } from '../types/Types';
import { get } from 'svelte/store';

class Enum_Spec {
	constructor(public enum_type: object | null, public defaultValue: any) {}
}

type Enum_Spec_ByType = { [type: string]: Enum_Spec };
export const def = (key: T_Preference): any => spec_dict_byType[key]?.defaultValue ?? null;

const spec_dict_byType: Enum_Spec_ByType = {
	[T_Preference.auto_adjust]:     new Enum_Spec(T_Auto_Adjust_Graph, null),
	[T_Preference.show_countsAs]:   new Enum_Spec(T_Counts_Shown,      T_Counts_Shown.numbers),
	[T_Preference.tree]:            new Enum_Spec(T_Kinship,           T_Kinship.children),
	[T_Preference.graph]:           new Enum_Spec(T_Graph,             T_Graph.tree),
	[T_Preference.countDots]:       new Enum_Spec(null,                []),
	[T_Preference.show_details]:    new Enum_Spec(null,                false),
	[T_Preference.show_related]:    new Enum_Spec(null,                false),
	[T_Preference.other_databases]: new Enum_Spec(null,                false),
	[T_Preference.thing]:           new Enum_Spec(null,                'default'),
	[T_Preference.font]:            new Enum_Spec(null,                'Times New Roman'),
	[T_Preference.detail_types]:    new Enum_Spec(null,                [T_Detail.actions, T_Detail.data]),
};

export class Preferences {

	get focus_key(): string { return get(g.w_branches_areChildren) ? T_Preference.focus_forChildren : T_Preference.focus_forParents; }
	get expanded_key(): string { return get(g.w_branches_areChildren) ? T_Preference.expanded_children : T_Preference.expanded_parents; }

	apply_queryStrings(queryStrings: URLSearchParams) {
		const levels = queryStrings.get('levels');
		if (!!levels) {
			g.w_depth_limit.set(Number(levels));
		}
		this.restore_preferences();
	}

	static readonly _____READ_WRITE: unique symbol;

	dump() 									 { console.log(localStorage); }
	get_forKey	   (key: string): any | null { return this.parse(localStorage[key]); }
	readDB_key	   (key: string): any | null { const dbKey = this.db_keyFor(key); return !dbKey ? null : this.get_forKey(dbKey); }
	writeDB_key<T> (key: string, value: T)	 { const dbKey = this.db_keyFor(key); if (!!dbKey) { this.write_key(dbKey, value); } }

	write_key<T> (key: string, value: T) {
		const object = u.stringify_object(value as object);
		if (!!object) {
			if (object.length > 3000000) {
				console.warn(`too large for localStorage: ${key} ${object.length} bytes`);
			} else {
				localStorage[key] = object;
			}
		}
	}

	writeDB_keyPairs_forKey<T>(key: string, sub_key: string, value: T): void {	// pair => key, sub_key
		const dbKey = this.db_keyFor(key);
		if (!!dbKey) {
			const sub_keys: string[] = this.get_forKey(dbKey) ?? [];
			const pair = this.keyPair_for(dbKey, sub_key);
			this.write_key(pair, value);			// first store the value by key pair
			if (sub_keys.length == 0 || !sub_keys.includes(sub_key)) {
				sub_keys.push(sub_key);
				this.write_key(dbKey, sub_keys);								// then store they sub key by key
			}
		}
	}

	readDB_keyPairs_forKey(key: string): Array<any> {
		let values: Array<any> = [];
		const dbKey = this.db_keyFor(key);
		if (!!dbKey) {
			const sub_keys: string[] = this.get_forKey(dbKey) ?? [];
			for (const sub_key of sub_keys) {
				const value = this.get_forKey(this.keyPair_for(dbKey, sub_key));
				if (!!value) {												// ignore undefined or null
					values.push(value);
				}
			}
		}
		return values;
	}

	read_key(key: T_Preference): any {
		const spec   = spec_dict_byType[key];
		const stored = this.get_forKey(key);
		if (stored !== null) {
			if (!spec || !spec.enum_type) {
				return stored;
			}
			if (Object.values(spec.enum_type).includes(stored)) {
				return stored;
			}
		}
		const defaultValue = spec?.defaultValue ?? null;
		if (defaultValue !== null) {
			this.write_key(key, defaultValue);
		}
		return defaultValue;
	}
	
	static readonly _____PRIMITIVES: unique symbol;

	db_keyFor	(key: string):			 string | null { const type = databases.db_now?.t_database; return !type ? null : this.keyPair_for(type, key); }
	keyPair_for	(key: string, sub_key: string):	string { return `${key}${k.separator.generic}${sub_key}`; }

	parse(key: string | null | undefined): any | null {
		if (!key || key == 'undefined') {
			return null;
		}		
		return JSON.parse(key);
	}

	reset_preferences() {
		const keys = Object.keys(T_Preference)
			.filter(key => isNaN(Number(key))) // Exclude numeric keys
			.map(key => T_Preference[key as keyof typeof T_Preference]);
		for (const key of keys) {
			if (key != 'local') {
				this.write_key(key, null);
			}
		}
	}
	
	reset_recents() {
		const focus = get(x.w_ancestry_focus) ?? h?.rootAncestry;
		const grabs = get(x.w_grabs) ?? [];
		if (focus) {
			const si_grabs = new S_Items<Ancestry>([...grabs]);
			si_grabs.index = grabs.length > 0 ? grabs.length - 1 : 0;
			x.si_recents.reset();
			x.si_recents.push({ focus, si_grabs, depth: get(g.w_depth_limit) });
		}
	}

	static readonly _____RESTORE: unique symbol;

	restore_paging() { radial.createAll_thing_pages_fromDict(this.readDB_key(T_Preference.paging)); }

	restore_preferences() {
		if (c.erase_preferences) {
			c.erase_preferences = false;
			this.reset_preferences();
		}
		show.w_t_auto_adjust_graph.set(this.read_key(T_Preference.auto_adjust));
		show.w_show_countsAs      .set(this.read_key(T_Preference.show_countsAs));
		x.w_thing_title           .set(this.read_key(T_Preference.thing));
		x.w_thing_fontFamily      .set(this.read_key(T_Preference.font));
		this.reactivity_subscribe()
	}
		
	restore_expanded() {
		if (c.eraseDB > 0) {
			c.eraseDB -= 1;
			x.si_expanded.reset();
		} else {
			const expanded = p.ancestries_readDB_key(this.expanded_key) ?? p.ancestries_readDB_key('expanded');	// backwards compatible with 'expanded' key
			debug.log_expand(`  READ (${get(databases.w_t_database)}): "${u.ids_forDB(expanded)}"`);
			x.si_expanded.items = expanded;
		}
		setTimeout(() => {
			x.si_expanded.w_items.subscribe((array: Array<Ancestry> | null) => {
				if (!!array && array.length > 0) {
					debug.log_expand(`  WRITING (${get(databases.w_t_database)}): "${u.ids_forDB(array)}"`);
					p.ancestries_writeDB_key(array, this.expanded_key);
				}
			});
		}, 100);
	}

	restore_recents() {
		const serialize = (r: S_Recent) => ({
			focus: r.focus?.pathString ?? k.root,
			grabs: r.si_grabs?.items?.map(a => a?.pathString ?? k.empty) ?? [],
			grabIndex: r.si_grabs?.index ?? 0,
			depth: r.depth
		});
		const deserialize = (item: any): S_Recent | null => {
			const focus = h?.ancestry_isAssured_valid_forPath(item.focus);
			if (!focus) return null;
			const grabs = (item.grabs ?? []).map((p: string) => h?.ancestry_isAssured_valid_forPath(p)).filter(Boolean);
			const si_grabs = new S_Items<Ancestry>(grabs);
			si_grabs.index = item.grabIndex ?? grabs.length - 1;
			return { focus, si_grabs, depth: item.depth ?? get(g.w_depth_limit) };
		};
		let serialized = null;
		if (c.eraseDB > 0) {
			c.eraseDB--;
		} else if (c.erase_recents) {
			c.erase_recents = false;
			this.writeDB_key(T_Preference.recents, null);
		} else {
			serialized = this.readDB_key(T_Preference.recents);
			const restored = S_Items.deserialize(serialized, deserialize);
			if (!!restored) {
				x.si_recents.items = restored.items;
				x.si_recents.index = restored.index;
			}
		}
		if (x.si_recents.length === 0) {
			const focus = h?.rootAncestry;
			if (!!focus) {
				x.si_recents.push({ focus, si_grabs: new S_Items<Ancestry>([]), depth: get(g.w_depth_limit) });
			}
		}
		x.si_recents.item?.focus?.expand();
		setTimeout(() => {
			x.si_recents.w_items.subscribe((items: Array<S_Recent>) => {
				if (items.length > 0) {
					const MAX_RECENTS = 10;
					this.writeDB_key(T_Preference.recents, x.si_recents.serialize(serialize).slice(-MAX_RECENTS));
					debug.log_grab(`  WRITING RECENTS (${get(databases.w_t_database)}): ${items.length} items`);
				}
			});
		}, 100);
	}
	
	static readonly _____ANCESTRIES: unique symbol;

	ancestries_writeDB_key(ancestries: Array<Ancestry>, key: string) {	// 2 keys use this {grabbed, expanded}
		const pathStrings = ancestries.map(a => a?.pathString ?? k.empty);			// array of pathStrings (of Relationship ids)
		this.writeDB_key(key, ancestries.length == 0 ? null : pathStrings);
	}

	ancestries_readDB_key(key: string): Array<Ancestry> {				// 2 keys use this {grabbed, expanded}
		const pathStrings = this.readDB_key(key);
		const length = pathStrings?.length ?? 0;
		let ancestries: Array<Ancestry> = [];
		if (length > 0) {
			for (const pathString of pathStrings) {
				const ancestry = h?.ancestry_isAssured_valid_forPath(pathString);
				if (!!ancestry) {
					ancestries.push(ancestry);
				}
			};
		}
		debug.log_preferences(`  ${key.toUpperCase()} ${ancestries.map(a => a.id)}`);
		return ancestries;
	}
	
	static readonly _____SUBSCRIBE: unique symbol;

	reactivity_subscribe() {

		// VISIBILITY

		show.w_t_trees.subscribe((value) => {
			this.write_key(T_Preference.tree, value);
		});
		show.w_t_countDots.subscribe((value) => {
			this.write_key(T_Preference.countDots, value);
		});
		show.w_t_details.subscribe((value) => {
			this.write_key(T_Preference.detail_types, value);
		});
		show.w_t_auto_adjust_graph.subscribe((auto_adjust: T_Auto_Adjust_Graph | null) => {
			this.write_key(T_Preference.auto_adjust, auto_adjust);
		});
		show.w_show_countsAs.subscribe((counts_shown: T_Counts_Shown) => {
			this.write_key(T_Preference.show_countsAs, counts_shown);
		});
		
		// OTHER

		g.w_depth_limit.subscribe((depth: number) => {
			this.write_key(T_Preference.levels, depth);
		});

		show.reactivity_subscribe();
	}

}

export const p = new Preferences();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Radial.ts
```ts
import { g, k, p, x, core, hits, show, Point, Angle, debug, signals, elements, g_graph_radial } from '../common/Global_Imports';
import { T_Startup, T_Preference, T_Hit_Target, T_Radial_Zone } from '../common/Global_Imports';
import { G_Cluster, S_Rotation, S_Resizing } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import { G_Paging } from '../geometry/G_Paging';
import { G_Pages } from '../geometry/G_Pages';
import { get, writable } from 'svelte/store';

//////////////////////////////////
//								//
// 	manage rotation & resizing	//
//								//
//////////////////////////////////

export default class Radial {
	s_paging_dict_byName: Dictionary<S_Rotation> = {};
	g_pages_dict_byThingID: Dictionary<G_Pages> = {};
	cursor = k.cursor_default;
	zone = T_Radial_Zone.miss;
	s_resizing!: S_Resizing;
	s_rotation!: S_Rotation;
	s_paging!: S_Rotation;
	last_action = 0;

	w_rotate_angle	= writable<number>(0);
	w_g_paging		= writable<G_Paging>();
	w_g_cluster		= writable<G_Cluster | null>(null);
	w_resize_radius = writable<number>(k.radius.ring_minimum);
	
	constructor() {
		core.w_t_startup.subscribe((startup: T_Startup) => {
			if (startup == T_Startup.ready) {
				x.w_ancestry_focus.subscribe((ancestry) => {
					this.reset();
				});
			}
		});
	}

	get ring_radius(): number { return get(this.w_resize_radius); }
	get isDragging(): boolean { return this.s_hit_targets.some(s => s?.isDragging ?? false); }
	get s_pagings(): Array<S_Rotation> { return Object.values(this.s_paging_dict_byName); }
	get s_hit_targets(): Array<S_Rotation> { return [this.s_resizing, this.s_rotation, ...this.s_pagings]; }
	s_paging_forName_ofCluster(name: string): S_Rotation {
		return elements.assure_forKey_inDict(name, this.s_paging_dict_byName, () => {
			const s_paging = new S_Rotation(T_Hit_Target.paging);
			s_paging.cluster_name = name;
			s_paging.id = `${T_Hit_Target.paging}-${name}`;
			return s_paging;
		});
	}
	
	g_pages_forThingID(id: string | null | undefined): G_Pages | null {
		return !id ? null : elements.assure_forKey_inDict(id, this.g_pages_dict_byThingID, () => new G_Pages(id));
	}

	reset() {
		if (!this.s_paging) this.s_paging = new S_Rotation(T_Hit_Target.paging);
		if (!this.s_resizing) this.s_resizing = new S_Resizing();
		if (!this.s_rotation) this.s_rotation = new S_Rotation();
		this.s_pagings.map(s => s.reset());
		this.cursor = k.cursor_default;
		this.w_g_cluster.set(null);
		this.s_resizing.reset();
		this.s_rotation.reset();
		this.s_paging.reset();
		this.last_action = 0;
	}

	createAll_thing_pages_fromDict(dict: Dictionary | null) {
		if (!!dict) {
			for (const sub_dict of Object.values(dict)) {
				const g_pages = G_Pages.create_fromDict(sub_dict);
				if (!!g_pages) {
					this.g_pages_dict_byThingID[g_pages.thing_id] = g_pages;
				}
			}
		}
	}

	get cursor_forRingZone(): string {
		switch (this.ring_zone_atMouseLocation) {
			case T_Radial_Zone.resize: return this.s_resizing.cursor;
			case T_Radial_Zone.rotate: return this.s_rotation.cursor;
			case T_Radial_Zone.paging: return this.s_paging.cursor;
			default:				   return k.cursor_default;
		}
	}

	get ring_zone_atMouseLocation(): T_Radial_Zone {
		const mouse_vector = g.mouse_vector_ofOffset_fromGraphCenter();
		if (!!mouse_vector) {
			return this.ring_zone_atVector_relativeToGraphCenter(mouse_vector);
		}
		return T_Radial_Zone.miss;
	}

	update_fill_colors() {
		this.s_paging.update_fill_color();
		this.s_rotation.update_fill_color();
		this.s_resizing.update_fill_color();
	}

	static readonly _____RINGS: unique symbol;

	ring_zone_atScaled(scaled: Point): T_Radial_Zone {
		const mouse_vector = g.vector_fromScaled_mouseLocation_andOffset_fromGraphCenter(scaled);
		if (!!mouse_vector) {
			return this.ring_zone_atVector_relativeToGraphCenter(mouse_vector);
		}
		return T_Radial_Zone.miss;
	}

	ring_zone_atVector_relativeToGraphCenter(mouse_vector: Point): T_Radial_Zone {
		let ring_zone = T_Radial_Zone.miss;
		if (!!mouse_vector) {
			const g_cluster = g_graph_radial.g_cluster_atMouseLocation;
			const inner = get(radial.w_resize_radius);
			const distance = mouse_vector.magnitude;
			const thick = k.thickness.radial.ring;
			const thin = k.thickness.radial.arc;
			const outer = inner + thick;
			const thumb = inner + thin;
			if (!!distance) {
				if (distance < inner) {
					ring_zone = T_Radial_Zone.resize;
				} else if (distance < thumb && !!g_cluster && g_cluster.isMouse_insideThumb) {
					ring_zone = T_Radial_Zone.paging;
				} else if (distance <= outer) {
					ring_zone = T_Radial_Zone.rotate;
				}
			}
			debug.log_mouse(` ring zone ${ring_zone} ${distance.asInt()}`);
			debug.log_cursor(` ring zone ${ring_zone} ${mouse_vector.verbose}`);
		}
		return ring_zone;
	}

	handle_mouse_drag() {
		const mouse_vector = g.mouse_vector_ofOffset_fromGraphCenter();
		if (!!mouse_vector) {
			const rotate = this.s_rotation;
			const resize = this.s_resizing;
			const now = new Date().getTime();
			const g_cluster = get(this.w_g_cluster);
			const s_paging = g_cluster?.s_paging;
			const mouse_angle = mouse_vector.angle;
			if ((!!rotate && rotate.isDragging) || (!!resize && resize.isDragging) || !!g_cluster) {	// not overload DOM refresh
				window.getSelection()?.removeAllRanges();					// prevent text selection during dragging
			}
			if (!!resize && resize.isDragging && resize.basis_radius != null) {										// resize, check this FIRST (when both states return isDragging true, rotate should be ignored)
				const smallest = k.radius.ring_minimum;
				const largest = smallest * 3;
				const magnitude = mouse_vector.magnitude - resize.basis_radius;
				const distance = magnitude.force_between(smallest, largest);
				const ring_radius = get(this.w_resize_radius);
				const delta = distance - ring_radius;
				const radius = ring_radius + delta;
				resize.active_angle = mouse_angle + Angle.quarter;
				this.cursor = resize.cursor;
				if (Math.abs(delta) > 1 && ((now - this.last_action) > 500)) {				// granularity of 1 pixel & 1 tenth second
					this.last_action = now;
					debug.log_radial(` resize  D ${distance.asInt()}  R ${radius.asInt()}  + ${delta.toFixed(1)}`);
					this.w_resize_radius.set(radius);
					g.layout();
				}
			} else if (!!rotate && rotate.isDragging && rotate.basis_angle != null) {								// rotate clusters
				if (!signals.anySignal_isInFlight && ((now - this.last_action) > 75)) {		// 1 tenth second
					this.last_action = now;
					this.w_rotate_angle.set(mouse_angle.add_angle_normalized(-rotate.basis_angle));
					debug.log_radial(` rotate ${get(this.w_rotate_angle).asDegrees()}`);
					rotate.active_angle = mouse_angle;
					this.cursor = rotate.cursor;
					g.layout();										// reposition necklace widgets and arc sliders
				}
			} else if (!!g_cluster && !!s_paging && s_paging.active_angle != null) {
				const basis_angle = s_paging.basis_angle;
				const active_angle = s_paging.active_angle;
				const delta_angle = (active_angle - mouse_angle).angle_normalized_aroundZero();
				s_paging.active_angle = mouse_angle;
				this.cursor = s_paging.cursor;
				debug.log_radial(` page  ${delta_angle.asDegrees()}`);
				if (!!basis_angle && !!active_angle && basis_angle != active_angle && !!g_cluster && g_cluster.adjust_paging_index_byAdding_angle(delta_angle)) {
					g.layout();
				}
			}
		}
	}

	restore_radial_preferences() {
		this.w_rotate_angle.set( p.read_key(T_Preference.ring_angle) ?? 0);
		this.w_resize_radius.set( Math.max( p.read_key(T_Preference.ring_radius) ?? 0, k.radius.ring_minimum));
		core.w_t_startup.subscribe((startup: T_Startup) => {
			if (startup == T_Startup.ready) {
				this.w_rotate_angle.subscribe((angle: number) => {
					p.write_key(T_Preference.ring_angle, angle);
				});
				this.w_resize_radius.subscribe((radius: number) => {
					p.write_key(T_Preference.ring_radius, radius);
				});
				hits.w_s_hover.subscribe((s_hover) => {
					this.update_fill_colors();
				});
				this.w_g_paging.subscribe((g_paging: G_Paging) => {
					p.writeDB_key(T_Preference.paging, this.g_pages_dict_byThingID);
					if (!!g_paging) {
						g_graph_radial.layout_forChildren_cluster(g_paging.isCluster_ofChildren);
						g_graph_radial.layout_forPaging();
					}
				})
			}
		});
	}

}

export const radial = new Radial();```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Elements.ts
```ts
import { S_Mouse, S_Widget, S_Element, S_Hit_Target, S_Component } from '../common/Global_Imports';
import { T_Control, T_Hit_Target } from '../common/Global_Imports';
import { colors, Ancestry } from '../common/Global_Imports';
import Identifiable from '../runtime/Identifiable';
import type { Dictionary, Integer } from '../types/Types';

export default class Elements {
	private s_element_dict_byType_andID: Dictionary<Dictionary<S_Element>> = {};
	private s_widget_dict_byAncestryID: Dictionary<S_Widget> = {};
	private s_control_dict_byType: Dictionary<S_Element> = {};
	private s_element_dict_byName: Dictionary<S_Element> = {};
	private s_mouse_dict_byName: Dictionary<S_Mouse> = {};
	mouse_responder_number = 0;
	s_focus!: S_Element;

	//////////////////////////////////////
	//									//
	//	state managed outside svelte	//
	//									//
	//  allows svelte components to be	//
	//	  deleted by their own event	//
	//	  handling						//
	//									//
	//	used by: Button, Close_Button,	//
	//	  Radial & Radial_Cluster,		//
	//	  Widget_Drag, Widget_Title,	//
	//	  Controls, Focus				//
	//									//
	//////////////////////////////////////

	name_from(identifiable: Identifiable, type: T_Hit_Target, subtype: string): string { return `${type}(${subtype}) (id '${identifiable.id}')`; }

	get next_mouse_responder_number(): number {
		this.mouse_responder_number += 1;
		return this.mouse_responder_number;
	}

	static readonly _____LOOKUP: unique symbol;

	s_mouse_forName(name: string): S_Mouse { return this.assure_forKey_inDict(name, this.s_mouse_dict_byName, () => S_Mouse.empty()); }
	
	s_element_forName_andType(name: string, type: T_Hit_Target, subtype: string): S_Element {
		return this.assure_forKey_inDict(name, this.s_element_dict_byID_forType(type), () => this.s_element_for(new Identifiable(), type, subtype));
	}

	s_control_forType(t_control: T_Control): S_Element {
		let s_control = this.s_control_dict_byType[t_control];
		if (!s_control) {
			const hover_color = t_control == T_Control.details ? 'white' : colors.default;
			s_control = this.s_element_for(new Identifiable(t_control), T_Hit_Target.control, t_control);
			s_control.set_forHovering(hover_color, 'pointer');
			this.s_control_dict_byType[t_control] = s_control;
		}
		return s_control;
	}

	element_set_focus_to(html_element: HTMLElement | null, on: boolean = true) {
		if (!!html_element) {
			const s_element = this.s_elements.filter(s_element => s_element.html_element == html_element)[0];
			this.s_element_set_focus_to(s_element, on);
		}
	}

	s_element_set_focus_to(s_element: S_Element | null, on: boolean = true) {
		if (!!s_element) {
			if (!on) {
				s_element.html_element?.blur();
				s_element.isFocus = false;
			} else {
				for (const se of this.s_elements) {
					if (se != s_element) {
						this.s_element_set_focus_to(se, false);		// assure that even untracked focus is cleared
					} else {
						s_element.html_element?.focus({ preventScroll: true });
						this.s_focus = s_element;
						s_element.isFocus = true;
					}
				}
			}
		}
	}

	static readonly _____CREATE: unique symbol;

	s_element_for(identifiable: Identifiable | null, type: T_Hit_Target, subtype: string): S_Element {
		const realIdentifiable = identifiable ?? new Identifiable()
		const name = this.name_from(realIdentifiable, type, subtype);
		return this.assure_forKey_inDict(name, this.s_element_dict_byName, () => new S_Element(realIdentifiable, type, subtype));
	}

	s_widget_forAncestry(ancestry: Ancestry): S_Widget {
		const id = ancestry.id;
		if (!id) {
			console.warn(`ancestry ${ancestry.title} has no id`);
		}
		return this.assure_forKey_inDict(id, this.s_widget_dict_byAncestryID, () => new S_Widget(ancestry));
	}

	assure_forKey_inDict<T>(key: string, dict: Dictionary, closure: () => T): T {
		let result = dict[key];
		if (!result) {
			result = closure();
			if (!!result) {
				dict[key] = result;
			}
		}
		return result;
	}

	static readonly _____INTERNALS: unique symbol;

	private get s_elements(): S_Element[] { return Object.values(this.s_element_dict_byName); }

	private s_element_dict_byID_forType(type: T_Hit_Target): Dictionary<S_Element> {
		let s_element_dict = this.s_element_dict_byType_andID[type];
		if (!s_element_dict) {
			s_element_dict = {};
			this.s_element_dict_byType_andID[type] = s_element_dict;
		}
		return s_element_dict;
	}

}

export const elements = new Elements();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Controls.ts
```ts
import { c, e, g, k, x, show, search, g_graph_tree, Ancestry, Predicate, S_Alteration } from '../common/Global_Imports';
import { T_Graph, T_Kinship, T_Control, T_Alteration, T_Search_Preference } from '../common/Global_Imports';
import { get } from 'svelte/store';

class Controls {
	
	open_tabFor(url: string) { window.open(url, 'help-webseriously')?.focus(); }
	showHelp_home() { this.open_tabFor(c.isServerLocal ? k.help_url.local : k.help_url.remote); }

	togglePopupID(id: T_Control) {
		const same = get(show.w_id_popupView) == id
		show.w_id_popupView.set(same ? null : id);
	}

	showHelp_for(t_action: number, column: number) { 
		const page = e.help_page_forActionAt(t_action, column);
		const url = `${k.help_url.remote}/user_guide/${page}`;
		this.open_tabFor(url);
	}

	toggle_alteration(ancestry: Ancestry, t_alteration: T_Alteration, predicate: Predicate | null) {
		const isAltering = !!get(x.w_s_alteration);
		const s_alteration = isAltering ? null : new S_Alteration(ancestry, t_alteration, predicate);
		x.w_s_alteration.set(s_alteration);
	}
	
	handle_segmented_choices(segmented_name: string, choices: string[]) {
		switch (segmented_name) {
			case 'search': search.w_t_search_preferences.set(choices[0] as unknown as T_Search_Preference); break;
			case 'tree':   g_graph_tree.set_tree_types(choices as Array<T_Kinship>); break;
			case 'graph':  show.w_t_graph.set(choices[0] as unknown as T_Graph); break;
		}
	}

	toggle_graph_type() {
		switch (get(show.w_t_graph)) {
			case T_Graph.tree:   show.w_t_graph.set(T_Graph.radial); break;
			case T_Graph.radial: show.w_t_graph.set(T_Graph.tree);   break;
		}
		g.grand_sweep();
	}

}

export const controls = new Controls();```

### /Users/sand/GitHub/mono/ws/src/lib/ts/managers/Configuration.ts
```ts
import { e, g, k, p, show, debug, search, colors, radial } from '../common/Global_Imports';
import { T_Browser, features, databases } from '../common/Global_Imports';
import { DB_Name } from '../database/DB_Common';
import MobileDetect from 'mobile-detect';
import { writable } from 'svelte/store';

export class Configuration {

	queryStrings = new URLSearchParams(window.location.search);
	w_device_isMobile = writable<boolean>(false);
	erase_recents = false;
	erase_preferences = false;
	erasePreferences = 0;
	eraseDB = 0;

	configure() {
		
		//////////////////////////////////////
		//									//
		//	 first code called by the app	//
		//									//
		//////////////////////////////////////

		// DO NOT CHANGE THE ORDER OF THESE CALLS

		const q = this.queryStrings;
		debug.apply_queryStrings(q);
		colors.restore_preferences();
		search.setup_defaults();
		this.apply_queryStrings(q);						// must call BEFORE prefs and db
		features.apply_queryStrings(q);
		g.restore_preferences();
		databases.apply_queryStrings(q);
		show.restore_preferences();						// must call BEFORE prefs
		radial.restore_radial_preferences();
		p.restore_preferences();
		show.apply_queryStrings(q);
		e.setup();
	}

	apply_queryStrings(queryStrings: URLSearchParams) {
        const eraseOptions	 = queryStrings.get('erase')?.split(k.comma) ?? [];
		for (const eraseOption of eraseOptions) {
			switch (eraseOption) {
				case 'data':	 this.eraseDB = 4;		 break;
				case 'recents':	 c.erase_recents = true; break;
				case 'settings': c.erase_preferences = true; break;
			}
		}
    }

	get device_isMobile(): boolean {
		const md = new MobileDetect(window.navigator.userAgent);
		return !!md.mobile();
	}

	get isServerLocal(): boolean {
		const hostname = window.location.hostname;
		return hostname === 'localhost' || hostname === '127.0.0.1' || hostname === '0.0.0.0';
	}

	get siteTitle(): string {
		const idBase = databases.db_now.idBase;
		const t_database = databases.db_now.t_database;
		const host = this.isServerLocal ? 'local' : 'remote';
		const base_name = idBase ? (idBase + ', ') : DB_Name.unknown;
		const db_name = t_database ? (t_database + ', ') : DB_Name.unknown;
		return `Seriously (${host}, ${db_name}${base_name}${this.browserType}, α)`;
	}

	get browserType(): T_Browser {
		const userAgent: string = navigator.userAgent;
		switch (true) {
			case /msie (\d+)/i.test(userAgent) ||
				/trident\/.*; rv:(\d+)/i.test(userAgent):  return T_Browser.explorer;
			case /(chrome|crios)\/(\d+)/i.test(userAgent): return T_Browser.chrome;
			case /firefox\/(\d+)/i.test(userAgent):		   return T_Browser.firefox;
			case /opr\/(\d+)/i.test(userAgent):			   return T_Browser.opera;
			case /orion\/(\d+)/i.test(userAgent):		   return T_Browser.orion;
			case /safari\/(\d+)/i.test(userAgent):		   return T_Browser.safari;
			default:									   return T_Browser.unknown
		}
	}

}

export const c = new Configuration();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/runtime/Identifiable.ts
```ts
import type { Integer } from '../types/Types';
import { v4 as uuid } from 'uuid';
import '../common/Extensions';

export default class Identifiable {
	hid: Integer;
	id: string;

	constructor(id: string = Identifiable.newID()) {
		this.hid = id.hash();
		this.id = id;
	}

	static newID(prefix: string = 'NEW'): string { return prefix + Identifiable.removeAll('-', uuid()).slice(10, 24); } // use last, most-unique bytes of uuid
	equals(other: Identifiable | null | undefined): boolean { return !!other && this.id == other.id; }

	static removeAll(item: string, from: string): string {
		let to = from;
		let length = from.length;
		do {
			length = to.length;
			to = to.replace(item, '');
		} while (length != to.length)
		return to;
	}

	setID(id: string = Identifiable.newID()) {
		this.hid = id.hash();
		this.id = id;
	}

	static remove_item_byHID<T>(from: Array<T>, item: T): Array<T> {
		const identifiable = item as Identifiable;
		const identifiables = from as Array<Identifiable>;
		return identifiables.filter(t => t.hid != identifiable.hid) as Array<T>;
	}

	static id_inReverseOrder(id: string): string {
		if (id.length > 3) { return this.newID(); }
		const parts = id.split('');
		const start = parts.shift();
		return [start, ...parts.reverse()].join('');
	}
	
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/runtime/Ancestry.ts
```ts
import { g, h, k, u, x, show, debug, features, svgPaths, databases, components } from '../common/Global_Imports';
import { T_Graph, T_Create, T_Kinship, T_Predicate, T_Alteration, T_Hit_Target } from '../common/Global_Imports';
import { Rect, Size, Point, Thing, Direction, Predicate, Relationship } from '../common/Global_Imports';
import { S_Items, S_Component, S_Title_Edit } from '../common/Global_Imports';
import { G_Widget, G_Cluster, G_TreeLine } from '../common/Global_Imports';
import type { Dictionary, Integer } from '../types/Types';
import { T_Database } from '../database/DB_Common';
import { G_Paging } from '../geometry/G_Paging';
import { get, Writable } from 'svelte/store';
import Identifiable from './Identifiable';

export default class Ancestry extends Identifiable {
	g_widgets: Dictionary<G_Widget> = {};
	t_database: string;
	kind: string;

	// id => ancestry (path) string 
	//   "   composed of ids of each relationship
	// NOTE: first relationship's parent is always the root
	//   "   kind is from the last relationship
	//    all children are of that kind of predicate

	constructor(t_database: string, path: string = k.root, kind: string = T_Predicate.contains) {
		super(path);
		this.kind = kind;
		this.t_database = t_database;
	}
	
	static readonly _____TRAVERSE: unique symbol;

	traverse(apply_closureTo: (ancestry: Ancestry) => boolean, t_kinship: T_Kinship = T_Kinship.children, visited: string[] = []) {
		const id = this.thing?.id;
		if (!!id && !visited.includes(id) && !apply_closureTo(this)) {
			for (const progeny of this.ancestries_createUnique_forKinship(t_kinship)) {
				progeny.traverse(apply_closureTo, t_kinship, [...visited, id]);
			}
		}
	}

	async async_traverse(apply_closureTo: (ancestry: Ancestry) => Promise<boolean>, t_kinship: T_Kinship = T_Kinship.children, visited: string[] = []) {
		const id = this.thing?.id;
		if (!!id && !visited.includes(id)) {
			try {
				if (!await apply_closureTo(this)) {
					for (const progeny of this.ancestries_createUnique_forKinship(t_kinship)) {
						await progeny.async_traverse(apply_closureTo, t_kinship, [...visited, id]);
					}
				}
			} catch (error) {
				console.error('Error during async_traverse:', error);
			}
		}
	}
	
	static readonly _____GEOMETRY: unique symbol;

	get g_widget():			 G_Widget { return this.g_widget_for_t_graph(get(show.w_t_graph)); }
	get g_paging():	  G_Paging | null { return this.g_cluster?.g_paging_forAncestry(this) ?? null; }
	get g_cluster(): G_Cluster | null { return this.g_widget.g_cluster ?? null; }

	g_widget_for_t_graph(t_graph: T_Graph): G_Widget {
		let g_widget = this.g_widgets[t_graph];
		if (!g_widget) {
			g_widget = G_Widget.empty(this);
			this.g_widgets[t_graph] = g_widget;
		}
		return g_widget;
	}
	
	static readonly _____FOCUS: unique symbol;

	get isFocus(): boolean { return get(x.w_ancestry_focus)?.equals(this) ?? false; }
	becomeFocus(): boolean { return x.becomeFocus(this); }

	get depth_within_focus_subtree(): number {
		const focus = get(x.w_ancestry_focus);
		if (!!focus) {
			return this.depth - focus.depth;
		}
		return 0;
	}

	get isVisible_accordingTo_depth_within_focus_subtree(): boolean {
		const limit = this.global_depth_limit;
		if (!!limit) {
			return this.depth_within_focus_subtree < limit;
		}
		return false;
	}

	reveal_toFocus() {
		const parentAncestry = this.parentAncestry;
		if (!!parentAncestry && !parentAncestry.isFocus) {
			if (!this.ancestors.some(a => a.isFocus)) {
				// if focus is not among ancestors, change the focus to parent
				parentAncestry.becomeFocus();
			}
			parentAncestry.reveal_toFocus();
			parentAncestry.expand();
		}
	}

	static readonly _____THINGS: unique symbol;

	get thing():  Thing | null { return h?.thing_forAncestry(this) ?? null; }
	get si_children(): S_Items<Thing> { return new S_Items<Thing>(this.children); }
	get children():  Array<Thing> { return h?.things_forAncestries(this.childAncestries) ?? []; }
	get ancestors(): Array<Thing> { return h?.things_forAncestry(this) ?? []; }
	get parents():  Array<Thing> { return this.thing?.parents ?? []; }

	thingAt(back: number): Thing | null {			// 1 == last
		const relationship = this.relationshipAt(back);
		if (!!relationship && !this.isRoot) {
			return relationship.child;
		}
		return h.root;	// N.B., h.root is wrong immediately after switching db type
	}

	things_childrenFor(kind: string): Array<Thing> {
		const relationships = h.relationships_ofKind_forParents_ofThing(kind, true, this.thing);
		let children: Array<Thing> = [];
		if (!this.isRoot && !!relationships) {
			for (const relationship of relationships) {
				const parent = relationship.parent;
				if (!!parent) {
					children.push(parent);
				}
			}
		}
		return children;
	}

	static readonly _____RELATIONSHIPS: unique symbol;
	
	get relationship():			 Relationship | null { return this.relationshipAt(); }
	get count_ofParents():					  number { return this.parentRelationships.length; }
	get relevantRelationships_count():		  number { return this.relevantRelationships.length; }
	get hasRelationships():					 boolean { return this.hasParents || this.hasChildren; }
	get hasRelevantRelationships():			 boolean { return this.relevantRelationships.length > 0; }
	get relevantRelationships(): Array<Relationship> { return this.relationships_forChildren(true); }
	get relationship_hids():		  Array<Integer> { return this.relationship_ids.map(i => i.hash()); }
	get parentRelationships():	 Array<Relationship> { return h.relationships_ofKind_forParents_ofThing(this.kind, true, this.thing); }
	get childRelationships():	 Array<Relationship> { return h.relationships_ofKind_forParents_ofThing(this.kind, false, this.thing); }
	get relationship_ids():			  Array <string> { return this.isRoot ? [] : this.pathString.split(k.separator.generic); }

	get relationships(): Array<Relationship> {
		const relationshipHIDs = this.relationship_hids.map(hid => h.relationship_forHID(hid)) ?? [];
		return u.strip_invalid(relationshipHIDs);
	}

	count_ofChilcren(forChildren: boolean):						  number { return this.relationships_forChildren(forChildren).length; }
	relationshipAt(back: number = 1):				 Relationship | null { return h.relationship_forHID(this.idAt(back).hash()) ?? null; }
	relationships_forChildren(forChildren: boolean): Array<Relationship> { return forChildren ? this.childRelationships : this.parentRelationships; }

	static readonly _____SVG: unique symbol;

	svgPathFor_tiny_outer_dot_pointTo_child(pointsTo_child: boolean): string | null {
		const in_radial_mode = show.inRadialMode;
		const tiny_outer_dots_count = this.count_ofChilcren(pointsTo_child);
		const isVisible_forChild = this.hasChildren && show.children_dots && (in_radial_mode ? true : !this.isExpanded);
		const isVisible_inRadial = pointsTo_child ? isVisible_forChild : this.hasParents && (this.isBidirectional ? show.related_dots : show.parent_dots);
		const show_tiny_outer_dots = in_radial_mode ? isVisible_inRadial : (isVisible_forChild || this.hidden_by_depth_limit);
		return !show_tiny_outer_dots ? null : svgPaths.tiny_outer_dots_circular(k.tiny_outer_dots.diameter, tiny_outer_dots_count as Integer, this.points_right);
	}

	static readonly _____BIDIRECTIONALS: unique symbol;
	
	get isBidirectional(): boolean { return this.predicate?.isBidirectional ?? false; }

	get bidirectional_ancestries(): Array<Ancestry> {
		let ancestries: Array<Ancestry> = []
		if (!!h) {
			for (const predicate of h.predicates) {
				if (predicate.isBidirectional) {
					const parents = h.ancestries_create_forThing_andPredicate(this.thing, predicate);
					if (!!parents) {	// each of the parents is bidirectional TO this ancestry's thing
						ancestries = u.uniquely_concatenateArrays_ofIdentifiables(ancestries, parents) as Array<Ancestry>;
					}
				}
			}
		}
		return ancestries;
	}

	get g_lines_forBidirectionals(): Array<G_TreeLine> {
		let found: Array<G_TreeLine> = [];
		const depth = this.depth + 1;
		for (const bidirectional of this.bidirectional_ancestries) {
			const others = bidirectional.thing?.ancestries;
			if (!!others) {
				for (const other of others) {
					if (other.isVisible && other.depth > depth && other.pathString != bidirectional.pathString) {
						const g_line = this.g_line_bidirectionaTo(other);
						found.push(g_line);
					}
				}
			}
		}
		return found;
	}

	g_line_bidirectionaTo(other: Ancestry) : G_TreeLine {
		const g_line = new G_TreeLine(this, other, true);
		const offset_x = -(k.height.line + k.height.dot / 2);
		const extent = other.g_widget.absolute_center_ofDrag;
		const origin = this.g_widget.absolute_center_ofReveal;
		const rect = Rect.createExtentRect(origin, extent).offsetByX(offset_x).offsetByXY(-0.5, 0);
		g_line.set_curve_type_forHeight(rect.height);
		g_line.rect = rect;
		return g_line;
	}

	static readonly _____VISIBILITY: unique symbol;

	get global_depth_limit():		   number { return get(g.w_depth_limit) ?? 0; }
	get halfHeight_ofVisibleSubtree(): number { return this.height_ofVisibleSubtree() / 2; }
	get halfSize_ofVisibleSubtree():     Size { return this.size_ofVisibleSubtree.dividedInHalf; }
	get size_ofVisibleSubtree():	     Size { return new Size(this.visibleSubtree_width(), this.height_ofVisibleSubtree()); }
	get hidden_by_depth_limit():	  boolean { return !this.isVisible_accordingTo_depth_within_focus_subtree && this.isExpanded && this.hasChildren && show.inTreeMode; }

	get children_hidden_by_depth_limit(): boolean {
		return this.depth_within_focus_subtree >= (this.global_depth_limit - 5) &&
			this.isExpanded && this.hasChildren && show.inTreeMode;
	}

	assure_isVisible_within(ancestries: Array<Ancestry>) {
		if (!!this.predicate && show.inRadialMode) {
			const index = u.indexOf_withMatchingThingID_in(this, ancestries);
			const g_paging = this.g_cluster?.g_paging;
			if (!!g_paging && !g_paging.index_isVisible(index)) {
				return g_paging.update_index_toShow(index);		// change paging
			}
		}
		return false;
	}

	ancestry_assureIsVisible(): boolean {
		if (!this.isVisible) {
			if (show.inTreeMode) {
				const focusAncestry = this.ancestry_createUnique_byStrippingBack(this.global_depth_limit);
				focusAncestry?.becomeFocus();
				this.reveal_toFocus();
			} else {
				this.parentAncestry?.becomeFocus();
				this.assure_isVisible_within(this.sibling_ancestries);
			}
			return true;
		}
		return false
	}

	get isVisible(): boolean {
		let isVisible = false;
		if (show.inRadialMode) {
			const parent = this.parentAncestry;
			const childIsFocus = get(x.w_ancestry_focus)?.parentAncestry == this;
			const thisIsVisible = this.g_paging?.index_isVisible(this.siblingIndex) ?? true;
			const parentIsFocus = !!parent && parent.isFocus && thisIsVisible;
			isVisible = this.isFocus || childIsFocus || parentIsFocus;
		} else {
			const focus = get(x.w_ancestry_focus) ?? null;
			const visible = this.isVisible_accordingTo_depth_within_focus_subtree;
			const incorporates = this.incorporates(focus);
			const expanded = this.isAllExpanded_fromRootTo(focus);
			isVisible = incorporates && expanded && visible;
		}
		return isVisible;
	}

	height_ofVisibleSubtree(visited: string[] = []): number {
		const thing = this.thing;
		if (!!thing && !visited.includes(this.id)) {
			if (this.shows_branches) {
				let height = 0;
				for (const branchAncestry of this.branchAncestries) {
					height += branchAncestry.height_ofVisibleSubtree([...visited, this.id]);
				}
				return Math.max(height, k.height.row);
			}
			return k.height.row;
		}
		return 0;
	}

	visibleSubtree_width(visited: string[] = []): number {
		const thing = this.thing;
		if (!!thing) {
			const id = this.id;
			let width = thing.width_ofTitle + 6;
			if (!visited.includes(id) && this.shows_branches) {
				let subtreeWidth = 0;
				for (const branchAncestry of this.branchAncestries) {
					const branchWidth = branchAncestry.visibleSubtree_width([...visited, id]);
					if (subtreeWidth < branchWidth) {
						subtreeWidth = branchWidth;
					}
				}
				width += subtreeWidth + k.height.line + k.height.dot;
			}
			return width;
		}
		return 0;
	}

	visibleSubtree_ancestries(visited: string[] = []): Array<Ancestry> {
		let ancestries: Array<Ancestry> = [];
		if (this.isVisible) {
			ancestries.push(this);
		}
		const thing = this.thing;
		if (!!thing) {
			if (!visited.includes(this.pathString) && this.shows_branches) {
				for (const childAncestry of this.childAncestries) {
					const progeny = childAncestry.visibleSubtree_ancestries([...visited, this.pathString]);
					ancestries = [...ancestries, ...progeny];
				}
			}
		}
		return ancestries;
	}

	static readonly _____EDIT: unique symbol;

	get isEditing(): boolean { return get(x.w_s_title_edit)?.ancestry_isEditing(this) ?? false; }

	get isEditable(): boolean {
		const isExternals = this.thing?.isExternals ?? true;
		const isBulkAlias = this.thing?.isBulkAlias ?? true;	// missing thing, return not editable
		const canEdit = (!this.isRoot || databases.db_now.t_database != T_Database.firebase);
		return canEdit && features.allow_title_editing && !isExternals && !isBulkAlias;
	}

	startEdit() {
		const s_text_edit = get(x.w_s_title_edit);
		if (this.isEditable && (!s_text_edit || !s_text_edit.ancestry_isEditing(this))) {
			x.w_s_title_edit?.set(new S_Title_Edit(this));
			debug.log_edit(`SETUP ${this.title}`);
		}
		this.grabOnly();
	}

	static readonly _____MOVE_UP: unique symbol;

	persistentMoveUp_maybe(up: boolean, SHIFT: boolean, OPTION: boolean, EXTREME: boolean): [boolean, boolean] {
		if (this.isCluster_ofChildren) {													// trees and radials
			return this.persistentMoveUp_forChild_maybe(up, SHIFT, OPTION, EXTREME);
		} else if (this.isBidirectional) {												// radials
			return this.persistentMoveUp_forBidirectional_maybe(up, SHIFT, OPTION, EXTREME);
		} else {																		// parents
			return this.persistentMoveUp_forParent_maybe(up, SHIFT, OPTION, EXTREME);
		}
	}

	persistentMoveUp_forChild_maybe(up: boolean, SHIFT: boolean, OPTION: boolean, EXTREME: boolean): [boolean, boolean] {
		const parentAncestry = this.parentAncestry;
		let needs_graphRelayout = false;
		let needs_graphRebuild = false;
		if (!!parentAncestry) {
			const siblings = parentAncestry.children ?? [];
			const length = siblings.length;
			const thing = this?.thing;
			if (length == 0) {		// friendly for first-time users
				h.ancestry_rebuild_runtimeBrowseRight(this, up, SHIFT, EXTREME, true);
			} else if (!!thing) {
				let grabAncestry: Ancestry | null = this;
				const fromOrder = siblings.indexOf(thing);
				const toOrder = fromOrder.increment(!up, length);
				if (!OPTION) {
					grabAncestry = parentAncestry.ancestry_createUnique_byAddingThing(siblings[toOrder]);
					if (!!grabAncestry) {
						grabAncestry.grab_forShift(SHIFT);
						needs_graphRelayout = true;
					}
				} else if (features.allow_graph_editing) {
					needs_graphRebuild = true;
					this.reorder_within(this.sibling_ancestries, up);
				}
				if (!!grabAncestry) {
					if (show.inRadialMode) {
						needs_graphRebuild = grabAncestry.assure_isVisible_within(this.sibling_ancestries) || needs_graphRebuild;	// change paging
					} else {
						x.assure_grab_isVisible();
					}
				}
			}
		}
		return [needs_graphRebuild, needs_graphRelayout];
	}

	persistentMoveUp_forParent_maybe(up: boolean, SHIFT: boolean, OPTION: boolean, EXTREME: boolean): [boolean, boolean] {
		const sibling_ancestries = get(x.w_ancestry_focus)?.ancestries_createUnique_forKinship(T_Kinship.parents);
		let needs_graphRelayout = false;
		let needs_graphRebuild = false;
		if (!!sibling_ancestries) {
			let grabAncestry: Ancestry | null = this;
			if (!OPTION) {
				const fromOrder = u.indexOf_withMatchingThingID_in(this, sibling_ancestries);
				const toOrder = fromOrder.increment(!up, sibling_ancestries.length);
				grabAncestry = sibling_ancestries[toOrder];
				if (!!grabAncestry) {
					grabAncestry.grab_forShift(SHIFT);
					needs_graphRelayout = true;
				}
			} else if (features.allow_graph_editing) {
				needs_graphRebuild = true;
				this.reorder_within(sibling_ancestries, up);
			}
			if (!!grabAncestry) {
				needs_graphRebuild = grabAncestry.assure_isVisible_within(sibling_ancestries) || needs_graphRebuild;
			}
		}
		return [needs_graphRebuild, needs_graphRelayout];
	}

	persistentMoveUp_forBidirectional_maybe(up: boolean, SHIFT: boolean, OPTION: boolean, EXTREME: boolean): [boolean, boolean] {
		const sibling_ancestries = get(x.w_ancestry_focus)?.ancestries_createUnique_forKinship(T_Kinship.related) ?? [];
		let needs_graphRelayout = false;
		let needs_graphRebuild = false;
		if (!!sibling_ancestries) {
			let grabAncestry: Ancestry | null = this;
			if (!OPTION) {
				const fromOrder = u.indexOf_withMatchingThingID_in(this, sibling_ancestries);
				const toOrder = fromOrder.increment(!up, sibling_ancestries.length);
				grabAncestry = sibling_ancestries[toOrder];
				if (!!grabAncestry) {
					grabAncestry.grab_forShift(SHIFT);
					needs_graphRelayout = true;
				}
			} else if (features.allow_graph_editing) {
				needs_graphRebuild = true;
				this.reorder_within(sibling_ancestries, up);
			}
			if (!!grabAncestry && !!this.predicate) {
				needs_graphRebuild = grabAncestry.assure_isVisible_within(sibling_ancestries) || needs_graphRebuild;
			}
		}
		return [needs_graphRebuild, needs_graphRelayout];
	}
	
	static readonly _____ORDER: unique symbol;
	
	get order(): number { return this.relationship?.order_forPointsTo(this.isCluster_ofChildren) ?? -12345; }
	
	order_setTo(order: number) {
		this.relationship?.order_setTo_forPointsTo(order, this.isCluster_ofChildren);
	}

	reorder_within(ancestries: Array<Ancestry>, up: boolean) {
		u.ancestries_orders_normalize(ancestries);
		const length = ancestries.length;
		const fromOrder = ancestries.indexOf(this);
		const toOrder = fromOrder.increment(!up, length);
		const wrapped = up ? (fromOrder == 0) : (fromOrder + 1 == length);
		const nudge = ((wrapped == up) ? 1 : -1) * k.halfIncrement;		// avoid duplicated orders
		this.order_setTo(toOrder + nudge);
		u.ancestries_orders_normalize(ancestries);
	}

	order_normalizeRecursive(visited: string[] = []) {
		const id = this.id;
		const childAncestries = this.childAncestries;
		if (!visited.includes(id) && childAncestries && childAncestries.length > 1) {
			u.ancestries_orders_normalize(childAncestries);
			for (const childAncestry of childAncestries) {
				childAncestry.order_normalizeRecursive([...visited, id]);
			}
		}
	}

	static readonly _____EXPAND: unique symbol;
	
	expand() { return this.expanded_setTo(true); }
	collapse() { return this.expanded_setTo(false); }
	toggleExpanded() { return this.expanded_setTo(!this.isExpanded); }
	get shows_branches(): boolean { return get(g.w_branches_areChildren) ? this.shows_children : !this.isRoot; }
	get shows_children(): boolean { return this.isExpanded && this.hasChildren && this.isVisible_accordingTo_depth_within_focus_subtree; }
	get isExpanded(): boolean { return this.isRoot || this.includedInStore_ofAncestries(x.si_expanded.w_items); }

	remove_fromGrabbed_andExpanded() {
		this.collapse();
		this.ungrab();
	}
	
	get isAllProgeny_expanded(): boolean {
		let allExpanded = true;
		this.traverse(ancestry => {
			if (!ancestry.isExpanded) {
				allExpanded = false;
				return true;
			}
			return false;
		});
		return allExpanded;
	}

	isAllExpanded_fromRootTo(targetAncestry: Ancestry | null): boolean {
		// visit ancestors until encountering either {targetAncestry, an unexpanded parent}
		if (!!targetAncestry && !this.equals(targetAncestry)) {
			const parentAncestry = this.parentAncestry;			// visit parent of ancestry
			if (!parentAncestry || !parentAncestry.isExpanded) {
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/UX_initialization.test.ts
```ts
/**
 * Verification tests for phase 5: Handle initialization
 * 
 * These tests verify that si_recents is properly seeded before subscriptions
 * are set up, and that the initialization sequence works correctly.
 * 
 * Run with: yarn test UX_initialization
 */

import { h, p, x } from '../common/Global_Imports';
import { get } from 'svelte/store';

describe('Initialization sequence verification', () => {
	beforeEach(() => {
		// Reset state
		x.si_recents.items = [];
	});

	it('should have si_recents populated after restore_recents() completes', () => {
		if (!h?.rootAncestry) return;

		// Call restore_recents
		p.restore_recents();

		// Verify si_recents has at least one entry
		expect(x.si_recents.length).toBeGreaterThan(0);
		const recentItem = x.si_recents.item as [any, any] | null;
		expect(recentItem).not.toBeNull();
	});

	it('should handle empty si_recents gracefully in subscription handler', () => {
		if (!h?.rootAncestry) return;

		// Clear recents to simulate edge case
		x.si_recents.items = [];

		// The subscription handler should use fallback
		// This is tested indirectly - if it crashes, test fails
		expect(() => {
			// Trigger subscription update
			x.si_recents.w_index.set(0);
		}).not.toThrow();

		// Verify fallback works (should use root or existing focus)
		const focus = get(x.w_ancestry_focus);
		// Focus should be set to something (root or null, but not crash)
	});

	it('should verify initialization sequence order', () => {
		if (!h?.rootAncestry) return;

		// Simulate initialization sequence
		// 1. restore_recents() should be called first
		p.restore_recents();
		
		// 2. Verify si_recents is populated
		expect(x.si_recents.length).toBeGreaterThan(0);
		
		// 3. Then setup_subscriptions() can be called safely
		// (In real code, this happens in Hierarchy.wrapUp_data_forUX())
		expect(() => {
			x.setup_subscriptions();
		}).not.toThrow();
	});

	it('should handle case where ancestryToFocus is null in restore_recents()', () => {
		// This test verifies that even if rootAncestry is null,
		// the code doesn't crash
		
		// Note: In practice, rootAncestry should always exist,
		// but we test the null case for robustness
		
		expect(() => {
			p.restore_recents();
		}).not.toThrow();
	});

	it('should verify subscription handler handles empty si_recents with fallback', () => {
		if (!h?.rootAncestry) return;

		// Set a focus first
		h.rootAncestry.becomeFocus();
		const initialFocus = get(x.w_ancestry_focus);

		// Clear recents to test fallback
		x.si_recents.items = [];
		x.si_recents.w_index.set(0);

		// Subscription handler should use fallback (existing focus or root)
		const focusAfterEmpty = get(x.w_ancestry_focus);
		// Should still have a focus (either initial or root)
		expect(focusAfterEmpty).not.toBeNull();
	});

	it('should set w_ancestry_focus correctly after initialization', () => {
		if (!h?.rootAncestry) return;

		// Simulate full initialization
		p.restore_recents();
		x.setup_subscriptions();

		// Verify focus is set
		const focus = get(x.w_ancestry_focus);
		expect(focus).not.toBeNull();

		// Verify it matches recents
		const recentItem = x.si_recents.item as [any, any] | null;
		if (recentItem) {
			expect(focus).toBe(recentItem[0]);
		}
	});

	it('should verify initialization works in Hierarchy.wrapUp_data_forUX() path', () => {
		if (!h?.rootAncestry) return;

		// This test verifies the initialization sequence used in
		// Hierarchy.wrapUp_data_forUX():
		// restore_fromPreferences() → restore_recents() → setup_subscriptions()

		// Simulate the sequence
		// Note: We can't call wrapUp_data_forUX() directly as it requires
		// full hierarchy setup, so we test the components
		
		// 1. restore_recents (called from restore_fromPreferences)
		p.restore_recents();
		expect(x.si_recents.length).toBeGreaterThan(0);

		// 2. setup_subscriptions (called after restore_fromPreferences)
		expect(() => {
			x.setup_subscriptions();
		}).not.toThrow();
	});

	it('should verify initialization works in DB_Common.hierarchy_setup_fetch_andBuild() path', () => {
		if (!h?.rootAncestry) return;

		// This test verifies the initialization sequence used in
		// DB_Common.hierarchy_setup_fetch_andBuild():
		// restore_fromPreferences() → restore_recents() → setup_subscriptions()

		// Same sequence as Hierarchy path, just different entry point
		p.restore_recents();
		expect(x.si_recents.length).toBeGreaterThan(0);
		
		expect(() => {
			x.setup_subscriptions();
		}).not.toThrow();
	});

	it('should ensure si_recents is seeded before subscription is active', () => {
		if (!h?.rootAncestry) return;

		// Clear recents
		x.si_recents.items = [];

		// Call restore_recents which should seed recents
		p.restore_recents();

		// Verify recents is seeded BEFORE setup_subscriptions
		expect(x.si_recents.length).toBeGreaterThan(0);

		// Now setup_subscriptions is safe
		x.setup_subscriptions();

		// Verify subscription works correctly
		const focus = get(x.w_ancestry_focus);
		expect(focus).not.toBeNull();
	});
});

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/UX_direct_setters.test.ts
```ts
/**
 * Verification tests for phase 4: Remove all direct setters of w_ancestry_focus
 * 
 * These tests verify that all direct setters have been replaced with proper
 * methods (becomeFocus() or recents index navigation).
 * 
 * Run with: yarn test UX_direct_setters
 */

import { c, h, p, x } from '../common/Global_Imports';
import Ancestry from '../runtime/Ancestry';
import { get } from 'svelte/store';

describe('Direct setters removal verification', () => {
	beforeEach(() => {
		// Reset state
		x.si_recents.items = [];
	});

	it('should verify restore_focus() uses becomeFocus() instead of direct set', () => {
		if (!h?.rootAncestry) return;

		// Mock becomeFocus to track calls
		let becomeFocusCalled = false;
		const originalBecomeFocus = h.rootAncestry.becomeFocus;
		h.rootAncestry.becomeFocus = function() {
			becomeFocusCalled = true;
			return originalBecomeFocus.call(this);
		};

		// Call restore_focus
		p.restore_focus();

		// Verify becomeFocus was called (not direct set)
		expect(becomeFocusCalled).toBe(true);

		// Restore original
		h.rootAncestry.becomeFocus = originalBecomeFocus;
	});

	it('should handle initialization with eraseDB flag', () => {
		if (!h?.rootAncestry) return;

		// Set eraseDB flag
		const originalEraseDB = c.eraseDB;
		c.eraseDB = 1;

		// Call restore_focus
		p.restore_focus();

		// Verify focus is set via becomeFocus (which adds to history)
		const focus = get(x.w_ancestry_focus);
		expect(focus).not.toBeNull();
		expect(x.si_recents.length).toBeGreaterThan(0);

		// Restore
		c.eraseDB = originalEraseDB;
	});

	it('should handle initialization with saved focus path', () => {
		if (!h?.rootAncestry) return;

		// This test would require mocking the preference storage
		// For now, just verify the method doesn't crash
		expect(() => {
			p.restore_focus();
		}).not.toThrow();
	});

	it('should add focus to recents history during initialization', () => {
		if (!h?.rootAncestry) return;

		// Clear recents
		x.si_recents.items = [];

		// Call restore_focus
		p.restore_focus();

		// Verify focus was added to history
		expect(x.si_recents.length).toBeGreaterThan(0);
		const recentItem = x.si_recents.item as [Ancestry, any] | null;
		expect(recentItem).not.toBeNull();
		expect(recentItem![0]).not.toBeNull();
	});

	it('should not create duplicate history entries', () => {
		if (!h?.rootAncestry) return;

		const initialLength = x.si_recents.length;

		// Call restore_focus
		p.restore_focus();

		// Verify only one entry was added (or none if already existed)
		const newLength = x.si_recents.length;
		// Should be at least initialLength, but not more than initialLength + 1
		expect(newLength).toBeGreaterThanOrEqual(initialLength);
		expect(newLength).toBeLessThanOrEqual(initialLength + 1);
	});

	it('should verify preferences subscription still works', () => {
		if (!h?.rootAncestry) return;

		// The subscription is set up in restore_focus (line 136-138)
		// Verify it doesn't crash when focus changes
		expect(() => {
			h.rootAncestry.becomeFocus();
		}).not.toThrow();
	});

	it('should verify no direct setters remain (grep verification)', () => {
		// This is a documentation test - actual verification requires:
		// 1. Run: grep -r "w_ancestry_focus\.set(" src/
		// 2. Verify only UX.ts update_focus_from_recents() contains it
		// 3. All other occurrences should be removed
		
		// For automated test, verify the known setter locations:
		// - UX.ts line 68: update_focus_from_recents() - CORRECT (subscription handler)
		// - Preferences.ts line 116: restore_focus() - SHOULD BE REMOVED
		
		// This test passes if the code compiles without errors
		// (TypeScript will catch if we try to use a removed setter)
		expect(true).toBe(true);
	});
});

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/UX_integration.test.ts
```ts
/**
 * Integration tests for phase 6: Comprehensive testing of breadcrumbs system
 * 
 * These tests verify end-to-end behavior of the breadcrumbs system, including:
 * - Breadcrumb navigation updates focus correctly
 * - Reactive subscriptions to w_ancestry_focus work correctly
 * - Edge cases (rapid changes, empty recents, mode switching)
 * - History truncation and navigation
 * 
 * Run with: yarn test UX_integration
 */

import { h, x } from '../common/Global_Imports';
import Ancestry from '../runtime/Ancestry';
import { get } from 'svelte/store';

describe('Breadcrumbs system integration tests', () => {
	beforeEach(() => {
		if (!h?.rootAncestry) return;
		// Reset recents to known state
		x.si_recents.items = [];
		if (h.rootAncestry) {
			h.rootAncestry.becomeFocus();
		}
	});

	it('should update focus correctly when clicking breadcrumb button', () => {
		if (!h?.rootAncestry) return;

		const ancestry = h.rootAncestry;
		const initialFocus = get(x.w_ancestry_focus);
		
		// Simulate breadcrumb button click
		ancestry.becomeFocus();
		
		// Verify focus updated
		const newFocus = get(x.w_ancestry_focus);
		expect(newFocus).toBe(ancestry);
		
		// Verify it was added to recents
		expect(x.si_recents.length).toBeGreaterThan(0);
		const recentItem = x.si_recents.item as [Ancestry, any] | null;
		expect(recentItem).not.toBeNull();
		expect(recentItem![0]).toBe(ancestry);
	});

	it('should handle rapid successive focus changes', () => {
		if (!h?.rootAncestry) return;

		const root = h.rootAncestry;
		
		// Rapid successive calls
		root.becomeFocus();
		root.becomeFocus();
		root.becomeFocus();
		
		// Verify focus is still correct
		const focus = get(x.w_ancestry_focus);
		expect(focus).toBe(root);
		
		// Verify recents index is in sync
		const recentItem = x.si_recents.item as [Ancestry, any] | null;
		expect(recentItem).not.toBeNull();
		expect(recentItem![0]).toBe(root);
	});

	it('should verify subscription handler updates focus from recents', () => {
		if (!h?.rootAncestry) return;

		const root = h.rootAncestry;
		root.becomeFocus();
		
		// Manually change recents index (simulating navigation)
		const initialIndex = x.si_recents.index;
		if (x.si_recents.length > 1) {
			x.si_recents.find_next_item(true);
			
			// Verify subscription updated focus
			const recentItem = x.si_recents.item as [Ancestry, any] | null;
			const focus = get(x.w_ancestry_focus);
			expect(recentItem).not.toBeNull();
			expect(focus).toBe(recentItem![0]);
		}
	});

	it('should verify all reactive subscriptions to w_ancestry_focus fire correctly', () => {
		if (!h?.rootAncestry) return;

		// Track subscription calls
		let subscriptionFired = false;
		const unsubscribe = x.w_ancestry_focus.subscribe(() => {
			subscriptionFired = true;
		});
		
		// Change focus
		const ancestry = h.rootAncestry;
		ancestry.becomeFocus();
		
		// Verify subscription fired (synchronous in Svelte)
		expect(subscriptionFired).toBe(true);
		
		unsubscribe();
	});

	it('should maintain consistency when navigating and then clicking breadcrumb', () => {
		if (!h?.rootAncestry || x.si_recents.length < 2) return;

		// Navigate forward in recents
		const navigatedFocus = get(x.w_ancestry_focus);
		
		// Then click a breadcrumb (adds new entry)
		const root = h.rootAncestry;
		root.becomeFocus();
		
		// Verify focus updated and new entry added
		const newFocus = get(x.w_ancestry_focus);
		expect(newFocus).toBe(root);
		expect(x.si_recents.length).toBeGreaterThan(1);
		
		// Verify index points to new entry
		const recentItem = x.si_recents.item as [Ancestry, any] | null;
		expect(recentItem).not.toBeNull();
		expect(recentItem![0]).toBe(root);
	});

});

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/setup.ts
```ts
/**
 * Vitest setup file
 * Initializes the test environment before running tests
 */

// Mock window.location for tests that need it
if (typeof window !== 'undefined' && !window.location.search) {
	Object.defineProperty(window, 'location', {
		value: {
			search: '',
		},
		writable: true,
	});
}

// Import enumerations first to ensure they're available before any classes use them
import { T_Persistence } from '../common/Enumerations';

// Verify T_Persistence is available before importing anything that uses it
if (!T_Persistence || !T_Persistence.none) {
	throw new Error('T_Persistence enum not properly initialized');
}

// Then import Global_Imports to ensure all modules are initialized
// Global_Imports now has the correct import order (k and features before radial and search)
// This ensures enumerations and managers are available
// Note: Some managers may try to access browser APIs, which will be mocked above
import '../common/Global_Imports';

// Additional setup can be added here if needed
// For example, mocking browser APIs, setting up test data, etc.

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/Coordinates.test.ts
```ts
import { T_Quadrant, T_Orientation } from '../types/Angle';
import { Point } from '../types/Coordinates';
import Angle from '../types/Angle';

describe('Point', () => {
	it('create a vector', () => {
		const point = new Point(1, 2);
		expect(point.x).toBe(1);
		expect(point.y).toBe(2);
	});
	
	it('negate a vector', () => {
		const point = new Point(1, 2).negated;
		expect(point.x).toBe(-1);
		expect(point.y).toBe(-2);
	});

	it('add two vectors', () => {
		const point1 = new Point(1, 2);
		const point2 = new Point(3, 4);
		const result = point1.offsetBy(point2);
		expect(result.x).toBe(4);
		expect(result.y).toBe(6);
	});

	it('vector magnitude', () => {
		const point = new Point(1, 2);
		const magnitude = point.magnitude;
		const squared = point.x * point.x + point.y * point.y;
		expect(magnitude).toBe(Math.sqrt(squared));
	});

});

describe('Angle', () => {

	it('vector from polar', () => {
		const point = Point.fromPolar(Math.sqrt(2), Math.PI / 4);
		expect(point.x).toBeCloseTo(1);
		expect(point.y).toBeCloseTo(-1);	// in browser coordinates, negative y is above x axis
	});

	it('vector angle', () => {
		const point = new Point(2, -2);	// in browser coordinates, negative y is above x axis
		const angle = point.angle;
		expect(angle).toBe(Math.PI / 4);
	});

	it('quadrant', () => {
		expect(new Angle(Math.PI / 3).quadrant_ofAngle).toBe(T_Quadrant.upperRight);	// 60° is in upper right quadrant
	});

	it('orientation', () => {
		expect(new Angle(Math.PI / 3).orientation_ofAngle).toBe(T_Orientation.up);		//	60° orients up
		expect(new Angle(Math.PI / 2).orientation_ofAngle).toBe(T_Orientation.up);		//	90° orients up
		expect(new Angle(Math.PI / 6).orientation_ofAngle).toBe(T_Orientation.right);	//	30° orients right
		expect(new Angle(Math.PI * 1.25).orientation_ofAngle).toBe(T_Orientation.down);	// 205° orients down
	});

});
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/UX_becomeFocus.test.ts
```ts
/**
 * Verification tests for phase 2: becomeFocus() sync with recents index
 * 
 * These tests verify that becomeFocus() correctly syncs w_ancestry_focus
 * via the subscription from si_recents index, rather than setting it directly.
 * 
 * Run with: yarn test UX_becomeFocus
 */

import { x, core, h } from '../common/Global_Imports';
import Ancestry from '../runtime/Ancestry';
import { get } from 'svelte/store';

describe('becomeFocus() sync with recents index', () => {
	beforeEach(() => {
		// Reset recents to known state
		x.si_recents.items = [];
	});

	it('should sync w_ancestry_focus from recents index after becomeFocus()', () => {
		if (!h?.rootAncestry) return;

		const ancestry = h.rootAncestry;
		const changed = ancestry.becomeFocus();

		// Verify recents was updated
		expect(x.si_recents.length).toBeGreaterThan(0);
		const recentItem = x.si_recents.item as [Ancestry, any] | null;
		expect(recentItem).not.toBeNull();
		expect(recentItem![0]).toBe(ancestry);

		// Verify w_ancestry_focus is synced (subscription should have fired)
		const focus = get(x.w_ancestry_focus);
		expect(focus).toBe(ancestry);
	});

	it('should have recents index pointing to correct ancestry after becomeFocus()', () => {
		if (!h?.rootAncestry) return;

		const ancestry = h.rootAncestry;
		ancestry.becomeFocus();

		// Verify index points to the ancestry we just set
		const recentItem = x.si_recents.item as [Ancestry, any] | null;
		expect(recentItem).not.toBeNull();
		expect(recentItem![0].equals(ancestry)).toBe(true);
	});

	it('should update ancestry_forDetails correctly after becomeFocus()', () => {
		if (!h?.rootAncestry) return;

		const ancestry = h.rootAncestry;
		ancestry.becomeFocus();

		// Give subscription time to fire (synchronous in Svelte, but test may need tick)
		const detailsAncestry = x.ancestry_forDetails;
		expect(detailsAncestry).not.toBeNull();
		// ancestry_forDetails should be derived from focus or grabs
	});

	it('should handle rapid successive becomeFocus() calls', () => {
		if (!h?.rootAncestry) return;

		const root = h.rootAncestry;
		
		// First call
		root.becomeFocus();
		expect(get(x.w_ancestry_focus)).toBe(root);

		// Second call immediately after
		root.becomeFocus();
		expect(get(x.w_ancestry_focus)).toBe(root);
		expect(x.si_recents.length).toBeGreaterThan(0);
	});

	it('should verify breadcrumb button click updates focus correctly', () => {
		if (!h?.rootAncestry) return;

		const ancestry = h.rootAncestry;
		const initialFocus = get(x.w_ancestry_focus);

		// Simulate breadcrumb button click
		if (ancestry.becomeFocus()) {
			const newFocus = get(x.w_ancestry_focus);
			expect(newFocus).toBe(ancestry);
			expect(newFocus).not.toBe(initialFocus);
		}
	});
});

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/recents_new.test.ts
```ts
/**
 * Tests for recents system
 * 
 * Run with: yarn test recents_new
 */

import { x, h, S_Items } from '../common/Global_Imports';
import type Ancestry from '../runtime/Ancestry';
import type { S_Recent } from '../types/Types';
import { get } from 'svelte/store';

describe('Phase 1: derived stores', () => {
	beforeEach(() => {
		// Reset recents to known state
		x.si_recents.items = [];
	});

	it('reacts to si_recents push', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;
		const B = h.rootAncestry;  // In real usage these would be different

		const si_grabs = new S_Items<Ancestry>([B]);
		si_grabs.index = 0;

		const recent: S_Recent = {
			focus: A,
			si_grabs,
			depth: 2
		};

		x.si_recents.push(recent);

		expect(get(x.w_ancestry_focus)).toBe(A);
		expect(get(x.w_grabs)).toEqual([B]);
	});

	it('returns defaults when empty', () => {
		expect(get(x.w_grabs)).toEqual([]);
	});

	it('updates when index changes', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		const si_grabs1 = new S_Items<Ancestry>([]);
		const si_grabs2 = new S_Items<Ancestry>([A]);

		const recent1: S_Recent = { focus: A, si_grabs: si_grabs1, depth: 1 };
		const recent2: S_Recent = { focus: A, si_grabs: si_grabs2, depth: 3 };

		x.si_recents.push(recent1);
		x.si_recents.push(recent2);

		// Should be at index 1 (most recent)
		expect(get(x.w_grabs)).toEqual([A]);

		// Navigate back
		x.si_recents.index = 0;
		expect(get(x.w_grabs)).toEqual([]);
	});
});

describe('Phase 2: snapshot creation', () => {
	beforeEach(() => {
		// Reset recents to known state
		x.si_recents.items = [];
	});

	it('creates snapshot on becomeFocus', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;
		const initialLength = x.si_recents.length;

		x.becomeFocus(A);

		expect(x.si_recents.length).toBe(initialLength + 1);
		expect(x.si_recents.item?.focus).toBe(A);
	});

	it('creates snapshot on grabOnly', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;
		x.becomeFocus(A);  // Need a focus first
		const initialLength = x.si_recents.length;

		x.grabOnly(A);

		expect(x.si_recents.length).toBe(initialLength + 1);
		expect(x.si_recents.item?.si_grabs.items).toContain(A);
	});

	it('creates snapshot on grab', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;
		x.becomeFocus(A);
		const initialLength = x.si_recents.length;

		x.grab(A);

		expect(x.si_recents.length).toBe(initialLength + 1);
		expect(x.si_recents.item?.si_grabs.items).toContain(A);
	});

	it('creates snapshot on ungrab', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;
		x.becomeFocus(A);
		x.grabOnly(A);
		const initialLength = x.si_recents.length;

		x.ungrab(A);

		expect(x.si_recents.length).toBe(initialLength + 1);
	});

	it('clones grabs to prevent reference mutation', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;
		x.becomeFocus(A);
		x.grabOnly(A);

		const snapshotGrabs = x.si_recents.item?.si_grabs;

		// Mutate current si_grabs (startup restore only)

		// Snapshot should be unaffected
		expect(snapshotGrabs?.items).toContain(A);
	});
});

describe('Phase 3: navigation', () => {
	beforeEach(() => {
		// Reset to known state
		x.si_recents.items = [];
	});

	it('navigates backward through history', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		// Create history: entry 0 (focus=A, grabs=[]), entry 1 (focus=A, grabs=[A])
		x.becomeFocus(A);           // index 0
		x.grabOnly(A);              // index 1

		expect(x.si_recents.length).toBe(2);
		expect(x.si_recents.index).toBe(1);  // at most recent

		// Navigate backward
		x.recents_go(false);

		expect(x.si_recents.index).toBe(0);
		expect(get(x.w_grabs)).toEqual([]);  // entry 0 had no grabs
	});

	it('navigates forward through history', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.becomeFocus(A);
		x.grabOnly(A);

		// Go backward first
		x.recents_go(false);
		expect(x.si_recents.index).toBe(0);

		// Go forward
		x.recents_go(true);
		expect(x.si_recents.index).toBe(1);
		expect(get(x.w_grabs)).toContain(A);
	});

	it('wraps circularly backward', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.becomeFocus(A);  // index 0
		x.grabOnly(A);     // index 1

		// Go backward twice (0 -> 1 circular wrap)
		x.recents_go(false);  // at 0
		x.recents_go(false);  // wraps to 1

		expect(x.si_recents.index).toBe(1);
	});

	it('wraps circularly forward', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.becomeFocus(A);  // index 0
		x.grabOnly(A);     // index 1

		// Go forward (wraps 1 -> 0)
		x.recents_go(true);

		expect(x.si_recents.index).toBe(0);
	});

	it('derives grabs from snapshot on navigation', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.becomeFocus(A);  // entry 0: grabs=[]
		x.grabOnly(A);     // entry 1: grabs=[A]

		// Verify current state via derived store
		expect(get(x.w_grabs)).toContain(A);

		// Navigate backward
		x.recents_go(false);

		// w_grabs should now be empty (from entry 0)
		expect(get(x.w_grabs)).toEqual([]);
	});

	it('does nothing when history is empty', () => {
		// No entries
		expect(x.si_recents.length).toBe(0);

		// Should not throw
		x.recents_go(false);
		x.recents_go(true);

		expect(x.si_recents.length).toBe(0);
	});
});

describe('Phase 4: isGrabbed', () => {
	beforeEach(() => {
		// Reset to known state
		x.si_recents.items = [];
	});

	it('uses derived w_grabs store', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.becomeFocus(A);
		x.grabOnly(A);

		expect(A.isGrabbed).toBe(true);
	});

	it('reflects navigation state', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.becomeFocus(A);  // entry 0: grabs=[]
		x.grabOnly(A);     // entry 1: grabs=[A]

		expect(A.isGrabbed).toBe(true);

		// Navigate backward to entry 0 (no grabs)
		x.recents_go(false);

		// isGrabbed should now reflect the navigated state
		expect(get(x.w_grabs)).toEqual([]);
	});
});

describe('Phase 5: final derivation', () => {
	beforeEach(() => {
		// Reset to known state
		x.si_recents.items = [];
	});

	it('w_grabIndex derives from snapshot', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		// Create snapshot with si_grabs.index = 1
		const si_grabs = new S_Items<Ancestry>([A, A]);
		si_grabs.index = 1;
		const snapshot: S_Recent = { focus: A, si_grabs, depth: 2 };
		x.si_recents.push(snapshot);

		expect(get(x.w_grabIndex)).toBe(1);
	});

	it('grab_next_ancestry cycles through grabs', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		// Create snapshot with multiple grabs
		const si_grabs = new S_Items<Ancestry>([A, A, A]);  // 3 grabs
		si_grabs.index = 0;
		const snapshot: S_Recent = { focus: A, si_grabs, depth: 2 };
		x.si_recents.push(snapshot);

		expect(get(x.w_grabIndex)).toBe(0);

		// Cycle forward
		x.grab_next_ancestry(true);
		expect(get(x.w_grabIndex)).toBe(1);

		x.grab_next_ancestry(true);
		expect(get(x.w_grabIndex)).toBe(2);

		// Wrap around
		x.grab_next_ancestry(true);
		expect(get(x.w_grabIndex)).toBe(0);
	});

	it('grab_next_ancestry cycles backward', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		const si_grabs = new S_Items<Ancestry>([A, A, A]);
		si_grabs.index = 0;
		const snapshot: S_Recent = { focus: A, si_grabs, depth: 2 };
		x.si_recents.push(snapshot);

		// Cycle backward (wraps to end)
		x.grab_next_ancestry(false);
		expect(get(x.w_grabIndex)).toBe(2);
	});

	it('grab reads from w_grabs not si_grabs', () => {
		if (!h?.rootAncestry) return;

		const A = h.rootAncestry;

		x.grabOnly(A);

		// New system has empty grabs
		x.becomeFocus(A);  // pushes snapshot with current (derived) grabs

		// grab() should read from w_grabs (empty on first call), not si_grabs
		const snapshot = x.si_recents.item;
		// becomeFocus reads from w_grabs which starts empty, falls back to si_grabs on first call
		expect(snapshot?.si_grabs.items.length).toBeGreaterThanOrEqual(0);
	});
});
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/tests/Colors.test.ts
```ts
import { colors } from '../utilities/Colors';

describe('darkness', () => {
	it('666', () => {
		const color = colors.set_darkness_toColor('#666', 0.2);
		expect(color).toBe('#e7e7e7');
	});
	it('red', () => {
		const color = colors.set_darkness_toColor('red', 0.2);
		expect(color).toBe('#ff0000');
	});
});

describe('saturation', () => {
	it('red', () => {
		const color = colors.multiply_saturationOf_by('red', 0.2);
		expect(color).toBe('#ffcccc');
	});
	it('blue', () => {
		const color = colors.multiply_saturationOf_by('blue', 0.2);
		expect(color).toBe('#ccccff');
	});
	it('green', () => {
		const color = colors.multiply_saturationOf_by('green', 0.2);
		expect(color).toBe('#668066');
	});
});

describe('luminance', () => {
	it('666', () => {
		const luminance = colors.luminance_ofColor('#666');
		expect(luminance).toBe(0.13286832155381795);
	});
	it('888', () => {
		const luminance = colors.luminance_ofColor('#888');
		expect(luminance).toBe(0.24620132670783546);
	});
	it('000', () => {
		const luminance = colors.luminance_ofColor('#000');
		expect(luminance).toBe(0);
	});
	it('fff', () => {
		const luminance = colors.luminance_ofColor('#fff');
		expect(luminance).toBe(1);
	});
	it('FFA500', () => {
		const luminance = colors.luminance_ofColor('#FFA500');
		expect(luminance).toBe(0.4817026703630963);
	});
});

describe('names', () => {
	it('red', () => {
		const color = colors.color_toHex('red');
		expect(color).toBe('#ff0000');
	});
	it('limegreen', () => {
		const color = colors.color_toHex('limegreen');
		expect(color).toBe('#32cd32');
	});
	it('blue', () => {
		const color = colors.color_toHex('blue');
		expect(color).toBe('#0000ff');
	});
	it('blue', () => {
		const luminance = colors.luminance_ofColor('blue');
		expect(luminance).toBe(0.0722);
	});
	it('green', () => {
		const luminance = colors.luminance_ofColor('green');
		expect(luminance).toBe(0.1543834296814607);
	});
	it('yellow', () => {
		const luminance = colors.luminance_ofColor('yellow');
		expect(luminance).toBe(0.9278);
	});
	it('red', () => {
		const luminance = colors.luminance_ofColor('red');
		expect(luminance).toBe(0.2126);
	});
});

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Banner_Hideable.ts
```ts
import { x, S_Items, T_Detail } from '../common/Global_Imports';

export class S_Banner_Hideable {
	slot_isVisible = false;
    t_detail!: T_Detail;
	hasBanner = false;
	isBottom = false;

	constructor(t_detail: T_Detail) {
		this.hasBanner = t_detail !== T_Detail.header;
		this.isBottom = t_detail === T_Detail.data;
		this.t_detail = t_detail;
    }

	get si_items(): S_Items<any> | null {
		switch (this.t_detail) {
			case T_Detail.selection: return null;  // Selection computes extra_titles directly from w_grabs
			case T_Detail.tags:		 return x.si_thing_tags;
			case T_Detail.traits:	 return x.si_thing_traits;
			default:				 return S_Items.dummy;
		}
	}
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Title_Edit.ts
```ts
import { k, Thing, Ancestry, Seriously_Range } from '../common/Global_Imports';

export enum T_Edit {
	percolating	= 'percolating',
	stopping	= 'stopping',
	editing		= 'editing',
	done		= 'done',
}

export default class S_Title_Edit {
	t_edit = T_Edit.editing;
	ancestry: Ancestry;
	title = k.empty
	
	// singleton (store)
	// t_edit is source of truth for all editing
	// ancestry.thing is source of truth for selection range
	
	set_isEditing() { this.t_edit = T_Edit.editing; }
	get thing(): Thing | null { return this.ancestry.thing; }
	constructor(ancestry: Ancestry) { this.ancestry = ancestry; }
	get isActive(): boolean { return this.t_edit != T_Edit.done; }
	stop_editing() { this.t_edit = T_Edit.done; this.thing?.set_isDirty(); }
	get description(): string { return `${this.t_edit} ${this.thing?.title}`; }
	refersTo(ancestry: Ancestry): boolean { return this.ancestry.equals(ancestry); }
	get thing_selectionRange(): Seriously_Range | undefined { return this.thing?.selectionRange; }
	actively_refersTo(ancestry: Ancestry): boolean { return this.refersTo(ancestry) && this.isActive; }
	inactively_refersTo(ancestry: Ancestry): boolean { return this.refersTo(ancestry) && !this.isActive; }
	ancestry_isEditing(ancestry: Ancestry | null): boolean { return this.isAncestry_inState(ancestry, T_Edit.editing); }
	ancestry_isStopping(ancestry: Ancestry | null): boolean { return this.isAncestry_inState(ancestry, T_Edit.stopping); }
	ancestry_isPercolating(ancestry: Ancestry | null): boolean { return this.isAncestry_inState(ancestry, T_Edit.percolating); }
	thing_setSelectionRange_fromOffset(offset: number) { this.thing_setSelectionRange(new Seriously_Range(offset, offset)); }

	thing_setSelectionRange(range: Seriously_Range) {
		if (!!this.thing) {
			this.thing.selectionRange = range;
		}
	}
	
	// ///////////////////////////////////////////
	//											//
	// single source of truth for editing state //
	//											//
	// ///////////////////////////////////////////

	// created by ancestry start edit
	// widget reacts to changes too it
	// title editor calls blur if isEditStopping is true
	// ancestry props that reference this object: {isEditing, isEditStopping, isEditPercolating}

	isAncestry_inState(ancestry: Ancestry | null, t_edit: string) {
		return (!ancestry || (!this.ancestry.equals(ancestry))) ? false : (this.t_edit == t_edit);
	}

	setState_temporarilyTo_whileApplying(t_edit: T_Edit, apply: () => void) {
		const saved = this.t_edit;
		this.t_edit = t_edit;
		apply();
		this.t_edit = saved;
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Element.ts
```ts
import { S_Hit_Target, T_Hit_Target, T_Control } from '../common/Global_Imports';
import { e, k, colors, elements } from '../common/Global_Imports';
import Identifiable from '../runtime/Identifiable';
import { styles } from '../managers/Styles';
import S_Snapshot from './S_Snapshot';
import { get } from 'svelte/store';

	//////////////////////////////////////////
	//										//
	//	single point of truth for			//
	//	  stroke, fill, cursor & border of	//
	//	  buttons, segments & widget dots	//
	//	  grabbed, expanded					//
	//										//
	//////////////////////////////////////////

export default class S_Element extends S_Hit_Target {
	defaultDisabledColor = '#999999'
	color_background = 'white';
	isDisabled = false;
	isSelected = false;
	isInverted = false;		// means color for hover == as though not hovering (and vice versa)
	subtype = k.empty;
	isFocus = false;
	name = k.empty;

	constructor(identifiable: Identifiable, type: T_Hit_Target, subtype: string) {
		super(type, identifiable);
		this.name = elements.name_from(identifiable, type, subtype);
		this.subtype = subtype;
		if (this.isADot) { 
			this.color_background = subtype == T_Control.search ? 'transparent' : get(colors.w_background_color);
		}
	}

	get snapshot():		 S_Snapshot { return new S_Snapshot(this); }
	get color_isInverted(): boolean { return this.isInverted != this.isHovering; }
	get asTransparent():	boolean { return this.isDisabled || this.subtype == T_Control.details; }
	get show_help_cursor(): boolean { return get(e.w_control_key_down) && this.type == T_Hit_Target.action; }
	get cursor():			 string { return (this.isHovering && !this.isDisabled) ? this.show_help_cursor ? 'help' : this.hoverCursor : this.defaultCursor; }
	get disabledTextColor(): string { return colors.special_blend(this.color_background, this.defaultDisabledColor, 0.3) ?? this.defaultDisabledColor; }
	get description():		 string { return `${this.isHovering ? 'in' : 'out '} '${this.name}'`; }	
	get thing_color():		 string { return this.ancestry.thing?.color ?? k.empty; }
	
	get fill(): string {
		if (this.asTransparent) {
			return 'transparent';
		} else if (this.isADot) {
			return this.dotColors_forElement.fill;
		} else if (this.isAControl) {
			return this.buttonColors_forElement.fill;
		} else if (this.ancestry.isGrabbed) {
			return this.thing_color;
		} else {
			return this.color_isInverted ? this.hoverColor : this.isSelected ? 'lightblue' : this.color_background;
		}
	}
		
	get stroke(): string {
		if (this.isADot) {
			return this.dotColors_forElement.stroke;
		} else if (this.isAControl) {
			return this.buttonColors_forElement.stroke;
		} else if (this.isDisabled) {
			return this.disabledTextColor;
		} else {
			return this.color_isInverted ? this.color_background : this.element_color;
		}
	}
	
	get svg_outline_color(): string {
		if (this.isADot) {
			return this.dotColors_forElement.svg_outline_color;
		}
		// Non-dot elements don't use svg_outline_color
		return k.empty;
	}
	
	get border(): string {
		const color = this.thing_color;
		if (!!color) {
			if (this.ancestry.isEditing) {
				return `dashed ${color} 1px`;
			}
			if (this.ancestry.isFocus && !this.ancestry.isGrabbed) {
				return `solid ${color} 1px`;
			}
			if (this.isHovering) {
				return `solid ${colors.ofBackgroundFor(color)} 1px`;
			}
		}
		return 'solid transparent 1px';
	}

	private get dotColors_forElement(): ReturnType<typeof styles.get_dotColors_for> {
		return styles.get_dotColors_for(this.snapshot, this.element_color, this.thing_color, this.color_background, this.hoverColor);
	}
	
	private get buttonColors_forElement(): ReturnType<typeof styles.get_buttonColors_for> {
		return styles.get_buttonColors_for(this.snapshot, this.element_color, this.color_background, this.hoverColor, this.disabledTextColor, 0, false, this.thing_color);
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Resizing.ts
```ts
import { k, colors, T_Hit_Target, T_Radial_Zone } from '../common/Global_Imports';
import S_Rotation from './S_Rotation';

// for resizing necklace

export default class S_Resizing extends S_Rotation {
	basis_radius: number | null = null;		// distance from arc radius to location of mouse DOWN
	
	constructor() {
		super(T_Hit_Target.resizing);
	}

	get hover_cursor(): string { return 'all-scroll'; }
	get isDragging():  boolean { return !!this.basis_radius; }
	reset()					   { super.reset(); this.basis_radius = null; }
	get fill_opacity(): number { return this.isHovering ? k.opacity.cluster.armature : k.opacity.cluster.faint; }
	update_fill_color()		   { this.fill_color = this.isHighlighted ? colors.opacitize(this.color, this.fill_opacity) : 'transparent'; }

	ring_zone_matches_type(ring_zone: T_Radial_Zone): boolean {
		return ring_zone == T_Radial_Zone.resize && this.type == T_Hit_Target.resizing;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Persistence.ts
```ts
import type { Async_Handle_Boolean } from '../types/Types';
import { T_Persistable } from '../common/Enumerations';
import { databases } from '../database/Databases';
import { busy } from '../state/S_Busy';

export default class S_Persistence {
	awaiting_remoteCreation = false;
	t_persistable: T_Persistable;
	lastModifyDate = new Date();
	already_persisted = false;
	needsBulkFetch = false;
	t_database: string;
	isDirty = false;
	id: string;

	get isPersistent(): boolean { return databases.db_forType(this.t_database)?.isPersistent ?? false; }
	updateModifyDate() { this.lastModifyDate = new Date(); }

	constructor(t_database: string, t_persistable: T_Persistable, id: string, already_persisted: boolean = false, awaiting_remoteCreation: boolean = false) {
		this.awaiting_remoteCreation = awaiting_remoteCreation;
		this.already_persisted		 = already_persisted;
		this.t_persistable	  		 = t_persistable;
		this.t_database		  		 = t_database;			// needed for this.isPersistent, used next
		this.isDirty		  		 = this.isPersistent && !already_persisted && !busy.isFetching;
		this.id				  		 = id;
	}

	wasModifiedWithinMS(threshold: number): boolean {
		const duration = new Date().getTime() - this.lastModifyDate.getTime();
		const result = duration < threshold;
		if (!result) {
			console.warn('slow: needs remote save');
		}
		return result;
	}

	async persist_withClosure(closure: Async_Handle_Boolean) {
		if (this.isPersistent) {
			if (this.awaiting_remoteCreation) {
				console.log(`awaiting creation ${this.t_persistable} ${this.id}`);
			} else {
				this.updateModifyDate();
				await closure(this.already_persisted);
			}
		}
	}

	setDate_fromSeriously(seriously_date: string) {
		const timestamp = parseFloat(seriously_date.split(':')[1]);
		const date = new Date(timestamp * 1000);
		const year = date.getFullYear() - 1994 + 2025;		// add (2025 - 1994) to convert from mac seriously's time interval to the current year
		this.lastModifyDate = new Date(year, date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds());
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Hit_Target.ts
```ts
import { g, k, hits, Rect, Point, debug, colors, Ancestry, S_Mouse, T_Hit_Target, T_Mouse_Detection } from '../common/Global_Imports';
import Identifiable from '../runtime/Identifiable';
import { get } from 'svelte/store';

export default class S_Hit_Target {

	// supports hit testing for all user-interactables in the DOM
	// S_Element, S_Widget, S_Component, S_Rotation, S_Resizing

	private _element_color_override?: string;	// Explicit override for buttons/controls (dots use thing_color automatically)
	private _hoverColor_override?: string;	// Cached hoverColor when element_color is explicitly set
	mouse_detection: T_Mouse_Detection = T_Mouse_Detection.none;
    containedIn_rect?: (rect: Rect | null) => boolean;
    contains_point?: (point: Point | null) => boolean;
	doubleClick_callback?: (s_mouse: S_Mouse) => void;
	longClick_callback?: (s_mouse: S_Mouse) => void;
	handle_s_mouse?: (s_mouse: S_Mouse) => boolean;
	identifiable: Identifiable | null = null;
	html_element: HTMLElement | null = null;
	element_rect: Rect | null = null;							// for use in Hits index
	autorepeat_callback?: () => void;
	defaultCursor = k.cursor_default;
	hoverCursor = k.cursor_default;
	autorepeat_event?: MouseEvent;		// stored here to survive component recreation
	autorepeat_isFirstCall = true;		// stored here to survive component recreation
	autorepeat_id?: number;
	type: T_Hit_Target;
	clicks: number = 0;
	id: string;
	
	static empty() { return {}; }
	constructor(type: T_Hit_Target, identifiable: Identifiable | null) {
		this.id = type + '-' + (identifiable?.id ?? 'unknown identifiable');
		this.identifiable = identifiable;
		this.type = type;
		if (this.isADot) {
			this.hoverCursor = 'pointer';
		}
	}

	get stroke(): string { return 'red'; }				// override in subclasses
	get rect(): Rect | null { return this.element_rect; }
	get ancestry(): Ancestry { return this.identifiable as Ancestry; }
	get isATitle(): boolean { return this.type == T_Hit_Target.title; }
	get isAWidget(): boolean { return this.type == T_Hit_Target.widget; }
	get isHovering(): boolean { return this.hasSameID_as(get(hits.w_s_hover)); }
	get inAWidget(): boolean { return this.isAWidget || this.isADot || this.isATitle; }
	set isHovering(isHovering: boolean) { hits.w_s_hover.set(isHovering ? this : null); }
	get svg_hover_color(): string { return this.isHovering ? colors.background : this.stroke; }
	get isADot(): boolean { return [T_Hit_Target.drag, T_Hit_Target.reveal].includes(this.type); }
	get detects_longClick(): boolean { return (this.mouse_detection & T_Mouse_Detection.long) !== 0; }
	get detects_autorepeat(): boolean { return this.mouse_detection === T_Mouse_Detection.autorepeat; }
	get respondsTo_longClick(): boolean { return this.detects_longClick && !!this.longClick_callback; }
	get detects_doubleClick(): boolean { return (this.mouse_detection & T_Mouse_Detection.double) !== 0; }
	get respondsTo_autorepeat(): boolean { return this.detects_autorepeat && !!this.autorepeat_callback; }
	get respondsTo_doubleClick(): boolean { return this.detects_doubleClick && !!this.doubleClick_callback; }
	get isAControl(): boolean { return [T_Hit_Target.control, T_Hit_Target.button, T_Hit_Target.glow].includes(this.type); }
	get isRing(): boolean { return [T_Hit_Target.rotation, T_Hit_Target.resizing, T_Hit_Target.paging].includes(this.type); }

	set rect(value: Rect | null) {
		this.element_rect = value;
		hits.add_hit_target(this);
	}

	set element_color(value: string) {
		this._element_color_override = value;
		// Cache hoverColor when element_color is explicitly set
		this._hoverColor_override = colors.background_special_blend(value, k.opacity.medium);
	}

	get element_color(): string {
		// For dots: use thing_color if no override is set
		if (this.isADot && !this._element_color_override) {
			return this.ancestry?.thing?.color ?? 'black';
		}
		// For buttons/controls: use explicit override or default
		return this._element_color_override ?? 'black';
	}

	get hoverColor(): string {
		// If hoverColor was explicitly computed from a set element_color, use cached value
		if (this._hoverColor_override !== undefined) {
			return this._hoverColor_override;
		}
		// Otherwise compute from current element_color (which may be reactive for dots)
		return colors.background_special_blend(this.element_color, k.opacity.medium);
	}

	set hoverColor(value: string) {
		this._hoverColor_override = value;
	}

	hasSameID_as(other: S_Hit_Target | null): boolean { return !!other && this.id == other.id; }

	set_forHovering(element_color: string, hoverCursor: string) {
		// Use setter which auto-computes hoverColor
		this.element_color = element_color;
		this.hoverCursor = hoverCursor;
	}

	set_html_element(html_element: HTMLElement | null) {
		if (!!html_element) {
			this.html_element = html_element;
			this.update_rect();
		} else {
			debug.log_hits(`no element for "${this.id}"`);
		}
	}

	update_rect() {
		if (!!this.html_element) {
			let rect = g.scaled_rect_forElement(this.html_element);
			if (rect && (this.isADot || this.isAWidget || this.isRing)) {
				const graph_bounds = get(g.w_rect_ofGraphView);
				if (graph_bounds) {
					rect = rect.clippedTo(graph_bounds);
				}
			}
			this.rect = rect;
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Rubberband.ts
```ts
import { Rect, Size, Point, hits } from '../common/Global_Imports';
import { T_Drag } from '../common/Global_Imports';
import { get } from 'svelte/store';
import RBush from 'rbush';

export default class S_Rubberband {
    startPoint: Point | null = null;
    rbush: RBush<any> | null = null;
    rect: Rect = Rect.zero;
    lastUpdate: number = 0;

    get isActive(): boolean {
        return get(hits.w_dragging) === T_Drag.rubberband;
    }

    start(point: Point, bounds: Rect) {
        this.startPoint = point;
        this.rect = new Rect(
            new Point(
                point.x.force_between(bounds.x, bounds.right),
                point.y.force_between(bounds.y, bounds.bottom)
            ),
            Size.zero
        );
        this.lastUpdate = 0;
        this.rbush = hits.rbush_forRubberband;
        hits.w_dragging.set(T_Drag.rubberband);
    }

    update(mouseLocation: Point, bounds: Rect): boolean {
        if (!this.startPoint) return false;
        
        const now = Date.now();
        if (now - this.lastUpdate < 40) return false;
        
        this.lastUpdate = now;
        const constrained = new Point(
            mouseLocation.x.force_between(bounds.x, bounds.right),
            mouseLocation.y.force_between(bounds.y, bounds.bottom)
        );
        const size = new Size(
            Math.abs(constrained.x - this.startPoint.x),
            Math.abs(constrained.y - this.startPoint.y)
        );
        const origin = new Point(
            Math.min(constrained.x, this.startPoint.x),
            Math.min(constrained.y, this.startPoint.y)
        );
        this.rect = new Rect(origin, size);
        return true;
    }

    stop() {
        this.startPoint = null;
        this.rect = Rect.zero;
        this.rbush = null;
        hits.w_dragging.set(T_Drag.none);
    }
}

export const s_rubberband = new S_Rubberband();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Busy.ts
```ts
import { databases } from '../database/Databases';

export class S_Busy {
	isFetching = false;
	isRendering = false;  // Rate-limit navigation during key repeat
	isPersisting = false;
	isFocusEventDisabled = false;

	get isFocusEventEnabled(): boolean { return !this.isFocusEventDisabled; }
	get isDatabaseBusy(): boolean { return this.isPersisting || this.isFetching; }

	async temporarily_set_isPersisting_while(closure: () => Promise<void>) {
		const wasPersisting = this.isPersisting;
		this.isPersisting = true;
		this.signal_data_redraw();
		await closure();
		this.isPersisting = wasPersisting;
		this.signal_data_redraw();
	}

	async temporarily_set_isFetching_while(closure: () => Promise<void>) {
		const wasFetching = this.isFetching;
		this.isFetching = true;
		this.signal_data_redraw();
		await closure();
		this.isFetching = wasFetching;
		this.signal_data_redraw();
	}

	async temporarily_disable_focus_event_while(closure: () => void) {
		const wasFocusEventDisabled = this.isFocusEventDisabled;
		this.isFocusEventDisabled = true;
		closure();
		this.isFocusEventDisabled = wasFocusEventDisabled;
	}

	signal_data_redraw(after: number = 0) {
		setTimeout(() => {
			databases.w_data_updated.set(new Date().getTime());
		}, after);
	}

}

export const busy = new S_Busy();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Alteration.ts
```ts
import { Ancestry, Predicate, T_Alteration } from '../common/Global_Imports';

export default class S_Alteration {
	t_alteration: T_Alteration;
	predicate: Predicate | null;
	ancestry!: Ancestry;

	constructor(ancestry: Ancestry, t_alteration: T_Alteration, predicate: Predicate | null) {
		this.predicate = predicate ?? Predicate.contains;
		this.t_alteration = t_alteration;
		this.ancestry = ancestry;
	}

	get description(): string { return `${this.t_alteration} ${this.predicate?.description ?? 'unpredicated'}`; }
}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Widget.ts
```ts
import { Ancestry, S_Element, T_Hit_Target } from '../common/Global_Imports';
import { k, colors, elements } from '../common/Global_Imports';
import { styles } from '../managers/Styles';
import S_Snapshot from './S_Snapshot';
import { get } from 'svelte/store';

	//////////////////////////////////////////
	//										//
	// widgets, titles, dots & breadcrumbs	//
	//	 use this to preserve state			//
	//	 across reattachment				//
	//										//
	// computes color, background, border	//
	//										//
	//	responds to grab, edit,	focus,		//	
	//	hover & expand						//
	//										//
	//////////////////////////////////////////

export default class S_Widget extends S_Element {
	last_snapshot: S_Snapshot;
	s_reveal:	   S_Element;
	s_title: 	   S_Element;
	s_drag:  	   S_Element;

	constructor(ancestry: Ancestry) {
		super(ancestry, T_Hit_Target.widget, k.empty);
		this.s_drag   = elements.s_element_for(ancestry, T_Hit_Target.drag, k.empty);
		this.s_title  = elements.s_element_for(ancestry, T_Hit_Target.title, k.empty);
		this.s_reveal = elements.s_element_for(ancestry, T_Hit_Target.reveal, k.empty);
		this.last_snapshot = this.snapshot;
	}

	get stroke():			string { return this.color; }
	get fill():				string { return this.background_color; }
	get color():			string { return this.widget_colors.color; }
	get border():			string { return this.widget_colors.border; }
	get background_color(): string { return this.widget_colors.background_color; }
	get background():		string { return `background-color: ${this.background_color}`; }

	get widget_colors(): { color: string; background_color: string; border: string } {
		return styles.get_widgetColors_for(this.snapshot, this.thing_color, get(colors.w_background_color));
	}

	get detect_ifState_didChange(): boolean {
		const didChange = 
			this.last_snapshot.isEditing != this.ancestry.isEditing || 
			this.last_snapshot.isGrabbed != this.ancestry.isGrabbed ||
			this.last_snapshot.isFocus != this.ancestry.isFocus;
		this.last_snapshot = this.snapshot;
		return didChange;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Items.ts
```ts
import { get, writable, derived, type Readable } from 'svelte/store';
import { T_Direction } from '../common/Enumerations';
import Identifiable from '../runtime/Identifiable';
import '../common/Extensions';

export default class S_Items<T> {
	static dummy =	 new S_Items<any>([]);	// for testing

	w_items =		 writable<Array<T>>([]);
	w_index =		 writable<number>(0);

	w_extra_titles!: Readable<string[]>;
    w_item!:		 Readable<T | null>;
	w_description!:	 Readable<string>;
	w_length!:		 Readable<number>;

	//////////////////////////////////////////////
	//											//
	//	manage a list of items, ...				//
	//	  get, set, reset, push, length			//
	//											//
	//	track the current item, ...				//
	//	  get, index (get & set), next			//
	//											//
	//	reactive stores (via x core)...			//
	//	  s elements, details, breadcrumbs,		//
	//	  results (25 files)					//
	//											//
	//	 const { w_grabs } = x;					//
	//			 ^^^^^^^						//
	//			 reactive store ($w_grabs)		//
	//											//
	//////////////////////////////////////////////
	
	constructor(items: Array<T>) {
		this.setup();
		this.items = items;
	}

	private setup() {
		// Initialize w_length as a derived store from w_items
		this.w_length = derived(
			this.w_items,
			(items) => items.length
		);
		// Initialize w_extra_titles as a derived store from w_length
		this.w_extra_titles = derived(
			this.w_length,
			(length) => (length < 2) ? [] : [T_Direction.previous, T_Direction.next]
		);
		// Initialize w_item as a derived store AFTER w_items and w_index are available
		this.w_item = derived(
			[this.w_items, this.w_index],
			([items, index]) => items[index] ?? null
		);
		// Initialize w_description as a derived store from w_items and w_index
		this.w_description = derived(
			[this.w_items, this.w_index],
			([items, index]) => {
				const item = items[index] ?? null;
				const identifiable = item as unknown as Identifiable ?? null;
				const descriptionBy_sorted_IDs = items.map(item => (item as unknown as Identifiable)?.id ?? '').sort().join('|');
				return `id (@ ${index}): ${identifiable?.id ?? ''}   ids (${items.length}): ${descriptionBy_sorted_IDs}`;
			}
		);
		// Then can set items (which will trigger these derived stores to update)
	}

	static readonly _____PRIMITIVES: unique symbol;

    set index(i: number) { this.w_index.set(i); }
	get index(): number { return get(this.w_index); }
	get item(): T | null { return get(this.w_item); }
	get length(): number { return get(this.w_length); }
	get items(): Array<T> { return get(this.w_items); }
	get identifiable(): Identifiable | null { return this.item as unknown as Identifiable ?? null; }
	get descriptionBy_sorted_IDs(): string { return this.items.map(item => (item as unknown as Identifiable)?.id ?? '').sort().join('|'); }
	
	set items(items: Array<T>) {
		const prior = this.index;
		const length = items.length;
		const index = (length === 0) ? 0 : prior.force_between(0, length - 1);
		this.w_items.set(items);
		this.index = index;
	}

	title(many: string, zero: string, one: string): string {
		if (this.length == 0) {
			return zero;
		} else if (this.length == 1) {
			return one;
		} else {
			return this.index.of_n_for_type(this.length, many, '');
		}
	}

	static readonly _____MANIPULATION: unique symbol;

	reset() {
		this.items = [];
		this.index = 0;		// do this last as it sets description
	}

	remove_all_beyond_index() {
		for (let i = this.index + 1; i < this.length; i++) {
			this.remove(this.items[i]);
		}
	}

	add_uniquely_from(from: S_Items<T> | null) {
		if (!!from) {
			for (const item of from.items) {
				if (!this.items.includes(item)) {
					this.push(item);
				}
			}	
		}
	}

	push(item: T) {
		const currentItems = this.items;
		let index = currentItems.indexOf(item);
		if (index == -1) {
			currentItems.push(item);
			this.items = currentItems;
			index = currentItems.length - 1;
		}
		this.index = index;
	}

	find_next_item(next: boolean): boolean {
		let attempts = this.length;
		while (attempts > 0) {
			this.index = this.index.increment(next, this.length);
			if (!!this.item) {
				return true;
			}
			attempts--;
		}
		return false;	// there are no items
	}

	remove(item: T) {
		const index = this.items.indexOf(item);
		if (index != -1) {
			const currentItems = [...this.items]; // Create a copy to avoid mutating the store value
			currentItems.splice(index, 1);
			this.items = currentItems; // Set items to trigger derived store updates
			if (currentItems.length == 0) {
				this.reset();
			} else if (index < this.index) {
				this.index -= 1;
			}
		}
	}

	static readonly _____PERSISTENCE: unique symbol;

	serialize<U>(itemSerializer: (item: T) => U): U[] {
		return this.items.map(itemSerializer);
	}

	static fromDefault<T>(item: T): S_Items<T> {
		return new S_Items<T>([item]);
	}

	static deserialize<T, U>(data: U[] | null, itemDeserializer: (data: U) => T | null): S_Items<T> | null {
		if (!data || data.length === 0) return null;
		const items = data.map(itemDeserializer).filter((item): item is T => item !== null);
		if (items.length === 0) return null;
		const si = new S_Items<T>(items);
		si.index = items.length - 1;
		return si;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Rotation.ts
```ts
import { k, x, Point, Angle, colors, radial, Ancestry, g_graph_radial } from '../common/Global_Imports';
import { T_Hit_Target, T_Radial_Zone } from '../common/Global_Imports';
import S_Component from './S_Component';

// for rotating (paging thumb and ring)

export default class S_Rotation extends S_Component {
	active_angle: number | null = null;		// current angle (at location of mouse MOVE)
	basis_angle: number | null = null;		// starting angle (where mouse went DOWN)
	fill_color = 'transparent';
	cluster_name: string | null = null;		// for paging type: name of the cluster this belongs to

	constructor(type: T_Hit_Target = T_Hit_Target.rotation) {
		super(null, type);
		this.contains_point = this.does_contain_point;
		setTimeout(() => {
			this.reset();
		}, 1);
		x.w_ancestry_focus.subscribe((ancestry: Ancestry | null) => {
			this.identifiable = ancestry;
			this.update_fill_color();
		});
	}

	get hover_cursor():	  string { return 'alias'; }
	get isDragging():	 boolean { return !!this.basis_angle; }		// user has clicked and is dragging
	get isHighlighted(): boolean { return (this.isHovering || this.isDragging); }
	get active_cursor():  string { return new Angle(this.active_angle!).cursor_forAngle; }
	get color():		  string { return this.ancestry?.thing?.color ?? colors.default_forThings; }
	get stroke_opacity(): number { return this.isHovering ? k.opacity.cluster.hover : k.opacity.none; }
	get fill_opacity():	  number { return this.isHovering ? k.opacity.cluster.armature : k.opacity.cluster.faint; }
	get cursor():		  string { return this.isDragging ? this.active_cursor : this.isHovering ? this.hover_cursor : k.cursor_default; }
	get thumb_opacity():  number { return this.isDragging ? k.opacity.cluster.active : this.isHovering ? k.opacity.cluster.active : k.opacity.cluster.thumb; }
	reset()						 { this.basis_angle = this.active_angle = null; this.update_fill_color(); }
	update_fill_color()			 { this.fill_color = colors.opacitize(this.color, this.fill_opacity) }

	does_contain_point(point: Point | null): boolean {
		let result = false;
		if (!!point) {
			const ring_zone = radial.ring_zone_atScaled(point);
			// For paging type, verify the mouse is actually over THIS cluster's thumb
			if (this.type == T_Hit_Target.paging) {
				const g_cluster = g_graph_radial.g_cluster_atMouseLocation;
				result = !!g_cluster && g_cluster.s_paging === this;
			} else if (this.ring_zone_matches_type(ring_zone)) {
				result = true;
			}
		}
		return result;
	}

	ring_zone_matches_type(ring_zone: T_Radial_Zone): boolean {
		return (ring_zone == T_Radial_Zone.rotate && this.type == T_Hit_Target.rotation) ||
			(ring_zone == T_Radial_Zone.resize && this.type == T_Hit_Target.resizing) ||
			(ring_zone == T_Radial_Zone.paging && this.type == T_Hit_Target.paging);
	}
	
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Component.ts
```ts
import { Rect, Point, S_Hit_Target, T_Signal, T_Hit_Target } from '../common/Global_Imports';
import { k, u, debug, signals, Ancestry } from '../common/Global_Imports';
import { Integer, SignalConnection_atPriority } from '../types/Types';
import Identifiable from '../runtime/Identifiable';
import { SignalConnection } from 'typed-signals';

// formerly called Svelte Wrapper
// (?) style construction (by type and hid)
// manage signals and for debugging styles and DOM issues
// unique id assignment (of html elements) for DOM lookups
// provide Ancestry access to an associated svelte component's main element (and vice versa)

export default class S_Component extends S_Hit_Target {
    signal_handlers: SignalConnection_atPriority[] = [];
	hid: Integer | null = null;

    // hit test (detect and rubberband), logger, emitter, handler and destroyer

    constructor(identifiable: Identifiable | null, type: T_Hit_Target) {
        super(type, identifiable);
        this.hid = identifiable?.hid ?? -1 as Integer;
        this.id = this.component_id;
    }

    static readonly _____SIGNALS: unique symbol;

    assure_hasConnection_atPriority(priority: number, connection: SignalConnection) {
        for (const handler of this.signal_handlers) {
            if (handler.priority == priority) {
                handler.connection = connection;
            }
        }
    }

    disconnect() {
        for (const handler of this.signal_handlers) {
            handler.connection?.disconnect();
            handler.connection = null;
        }
    }

    private get description(): string { return this.type; }

    private get component_id(): string {
        const a = this.ancestry;
        return `${this.type}-${!a ? 'no-ancestry' : (a.kind + '-' + a.titles)}`;
    }

    static readonly _____DEBUG_LOGGING: unique symbol;
    
    private get element_debug_style(): string {
        const element = this.html_element;
        if (!!element) {
            const indented = k.newLine + k.tab;
            const style = element.getAttribute('style');
            if (!!style) {
                return style.replace(/; /g, indented).replace(/ :/g, ':').replace(/: /g, '\t');
            }
        }
        return 'no style information';
    }

	private style_debug_info(prefix: string): string {
		const element = this.html_element;
		if (!!element) {
			const indented = k.newLine + k.tab;
			const computed = window.getComputedStyle(element);
			return [prefix, this.ancestry?.titles,
                indented + k.title.line,
                indented + this.element_debug_style,
				indented + k.title.line,
				indented + 'isConnected', element.isConnected,
				indented + 'computed.backgroundColor', computed.backgroundColor,
				indented + 'computed.display', computed.display,
				indented + 'computed.visibility', computed.visibility,
				indented + 'ownerDocument', element.ownerDocument === document ? 'main document' :'different document',
				indented + (element.offsetParent === element.parentElement) ? 'positioning is normal' :'offset is not parent'
			].join(k.tab);
		}
        return 'no style information';
	}

	private element_debug_info(prefix: string, element: HTMLElement | null | undefined): string {
		const indented = k.newLine + k.tab + prefix + k.space;
		const array = !element ? [] : [
			k.newLine + k.tab + k.title.line,
			indented + 'tagName', element.tagName,
			indented + 'isConnected', element.isConnected,
			indented + 'getBoundingClientRect', JSON.stringify(element.getBoundingClientRect()),
			indented + 'ownerDocument.contains', element.ownerDocument?.contains(element),
			indented + 'getRootNode', element.getRootNode()?.nodeName,
			indented + 'compareDocumentPosition', element.compareDocumentPosition(document.body) & 0x8 ? 'body contains ' + prefix : prefix + ' is orphaned',
			indented + 'closest body', element.closest('body')?.tagName];
			return array.join(k.tab);
	}

    get isComponentLog_enabled(): boolean {
        const log_isEnabledFor_type = {
            breadcrumbs : false,
            branches	: false,
            radial		: false,
            reveal		: false,
            widget		: false,
            title		: false,
            drag		: false,
            line		: false,
            none		: false,
            tree		: false,
            app			: false,
        }
        const type = this.type as keyof typeof log_isEnabledFor_type;
        return log_isEnabledFor_type[type] ?? false;
    }

	debug_log_style(prefix: string) {
        if (!this.isComponentLog_enabled) { return; }
        const information = this.style_debug_info(prefix);
        if (!!information) {
            debug.log_component(information);
        }
	}

	debug_log_signal(sending: boolean, value: any | null, t_signal: T_Signal, priority: number) {
        if (signals.log_isEnabledFor_t_signal[t_signal] && signals.log_isEnabled_forSending(sending) && this.isComponentLog_enabled) {
            const resolved = u.resolve_signal_value(value);
            const first = sending ? '[s]---->' : '---->[h]';
			const second = sending ? 'from' : 'in';
			debug.log_signal(`${first} "${t_signal}" @ ${priority} ${second} ${this.description} with ${resolved}`);
		}
	}

	debug_log_connection_state(prefix: string) {
        if (!this.isComponentLog_enabled) { return; }
		const element = this.html_element;
		if (!!element) {
			const indented = k.newLine + k.tab;
            const type = this.type.toUpperCase();
			const array = [type, prefix, 'connection state', `(at ${new Date().toLocaleString()})`,
				indented + k.title.line,
				indented + this.style_debug_info('ancestry'),
				indented + k.title.line,
				indented + 'ancestry.isGrabbed', this.ancestry?.isGrabbed,
				indented + 'ancestry.isEditing', this.ancestry?.isEditing,
				indented + 'ancestry.isFocus', this.ancestry?.isFocus,
				indented + 'previousSibling', element.previousSibling?.nodeName,
				indented + 'nextSibling', element.nextSibling?.nodeName,
			];
			array.push(this.element_debug_info('ELEMENT', element));
			// array.push(this.element_debug_info('PARENT', element.parentElement));
			// array.push(this.element_debug_info('GRAND-PARENT', element.parentElement?.parentElement));
			debug.log_component(array.join(k.tab));
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Snapshot.ts
```ts
import { Ancestry, k, S_Element } from '../common/Global_Imports';

	//////////////////////////////////////
	//									//
	//  snapshot of s_element			//
	//	  occupying user's attention	//
	//	used by Styles manager			//
	//	  to compute colors				//
	//									//
	//////////////////////////////////////

export default class S_Snapshot {
	ancestry:	 Ancestry;
	isInverted:  boolean;
	isDisabled:  boolean;
	isSelected:  boolean;
	isHovering:  boolean;
	isGrabbed:   boolean;
	isEditing:   boolean;
	isFocus:     boolean;
	thing_color: string;
	subtype:     string;
	type:	     string;

	constructor(s_element: S_Element) {
		// snapshot the state of the element
		this.type		 = s_element.type;
		this.subtype	 = s_element.subtype;
		this.ancestry	 = s_element.ancestry;
		this.isDisabled  = s_element.isDisabled;
		this.isSelected  = s_element.isSelected;
		this.isInverted  = s_element.isInverted;
		this.isHovering  = s_element.isHovering;
		this.isFocus	 = this.ancestry.isFocus;
		this.isGrabbed   = this.ancestry.isGrabbed;
		this.isEditing   = this.ancestry.isEditing;
		this.thing_color = this.ancestry.thing?.color ?? k.empty;
	}

}

```

### /Users/sand/GitHub/mono/ws/src/lib/ts/state/S_Mouse.ts
```ts
import { Rect } from '../common/Global_Imports';

export default class S_Mouse {
	element: HTMLElement | null;	// null means mouse responder
	event: MouseEvent | null;		// null means mouse movement from global state
	isRepeat: boolean;
	isDouble: boolean;
	isMove: boolean;
	isLong: boolean;
	isDown: boolean;
	isUp: boolean;
	clicks = 0;

	//////////////////////////////////////////////
	//	encapsulate relevant event properties	//
	//	pass to buttons, widgets, radial & arcs	//
	//	isHovering is mirrored in S_Element		//
	//////////////////////////////////////////////

	constructor(event: MouseEvent | null, element: HTMLElement | null, isDown: boolean, isUp: boolean, isDouble: boolean = false, isLong: boolean = false, isMove: boolean = false, isRepeat: boolean = false) {
		this.isDouble = isDouble;
		this.isRepeat = isRepeat;
		this.element = element;
		this.isDown = isDown;
		this.isLong = isLong;
		this.isMove = isMove;
		this.event = event;
		this.isUp = isUp;
	}

	// Transient mouse states, for passing to parent																							down,   up,  double,          long,  move,  repeat

	static empty (event: MouseEvent | null = null)														  { return new S_Mouse(event, null,    false,  true); }
	static up    (event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  true); }
	static down  (event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, true,   false); }
	static long  (event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  false, false,          true); }
	static repeat(event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  false, false,          false, false, true); }
	static double(event: MouseEvent | null, element: HTMLElement | null)								  { return new S_Mouse(event, element, false,  false, true,           false); }
	static clicks(event: MouseEvent | null, element: HTMLElement | null, clickCount: number)			  { return new S_Mouse(event, element, false,  false, clickCount > 1, false); }
	
	get isShapeHit():	boolean { return false; }
	get notRelevant():	boolean { return !this.isDown && !this.isUp && !this.isDouble && !this.isLong && !this.isMove && !this.isRepeat; }
	descriptionFor(name: string = ''): string { return `${name} states: ${this.description}`; }

	get description(): string {
		let states: string[] = [];
		if (this.isUp) { states.push('up'); }
		if (this.isDown) { states.push('down'); }
		if (this.isLong) { states.push('long'); }
		if (this.isMove) { states.push('move'); }
		if (this.isDouble) { states.push('double'); }
		if (this.isRepeat) { states.push('repeat'); }
		return states.length == 0 ? 'empty mouse state' : states.join(', ');
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/utilities/Colors.ts
```ts
import { parseToRgba, transparentize } from 'color2k';
import { T_Preference } from '../common/Enumerations';
import { get, writable } from 'svelte/store';
import { p } from '../managers/Preferences';

// single source of truth for all colors

export class Colors {
	default = 'black';
	banner = '#f8f8f8';
	border = 'darkgray';
	background = 'white';
	separator = '#eeeee0';
    disabled = 'lightGray';
	rubberband = '#4a90e2';
    default_forThings = 'blue';
	thin_separator_line_color = '#999999';
	w_background_color = writable<string>();
	w_thing_color	   = writable<string | null>(null);
	w_separator_color  = writable<string>(this.separator);
	w_color_picker_isOpen = writable<boolean>(false);

	restore_preferences() {
		this.w_background_color.set( p.read_key(T_Preference.background) ?? this.background);
		this.w_separator_color .set( p.read_key(T_Preference.separator) ?? this.separator);
		this.w_separator_color .subscribe((color: string) => {
			p.write_key(T_Preference.separator, color);
			this.w_background_color.set(this.ofBackgroundFor(color));
		})
		this.w_background_color.subscribe((color: string) => {
			document.documentElement.style.setProperty('--css-background-color', color);
			p.write_key(T_Preference.background, color);
			this.banner = this.ofBannerFor(color);
		})
	}

	ofBackgroundFor(color: string): string { return this.lighterBy(color, 10);}
	ofBannerFor(background: string): string { return this.blend('white', background, 4);}
	opacitize(color: string, amount: number): string { return color == '' ? '' : transparentize(color, 1 - amount); }
	background_special_blend(color: string, opacity: number): string { return this.special_blend(color, get(this.w_background_color), opacity) ?? color; }

	color_fromSeriously(color: string | undefined): string {
		if (!!color) {			
			const parts = color.split(',');				// "red:0.7,green:0,blue:0,alpha:1"
			const rgba = new RGBA();
			for (const part of parts) {
				const [key, value] = part.split(':');
				const numValue = parseFloat(value);
				switch (key) {
					case 'red':	  rgba.r = Math.round(numValue * 255); break;
					case 'blue':  rgba.b = Math.round(numValue * 255); break;
					case 'green': rgba.g = Math.round(numValue * 255); break;
					case 'alpha': rgba.a = numValue;				   break;
				}
			}
			return this.RGBA_toHex(rgba);
		}
		return this.default_forThings;
	}

	blend(color: string, background: string, saturation: number = 7): string {
		let blended: string | null = 'lightgray';
		if (!this.colors_areIdentical(background, this.background)) {
			if (this.isGray(background)) {
				blended = this.darkerBy(background, 1 / saturation);
			} else {
				blended = this.multiply_saturationOf_by(background, saturation);
			}
		}
		if (!!blended) {
			color = blended;
		}
		return color;
	}

	special_blend(color: string, background: string, ratio: number): string | null {
		const rgbaA = this.color_toRGBA(color);
		const rgbaB = this.color_toRGBA(background);		
		if (!rgbaA || !rgbaB) return null;
		const alpha = rgbaA.a * ratio;
		const r = Math.round((rgbaA.r * alpha) + (rgbaB.r * (1 - alpha)));
		const g = Math.round((rgbaA.g * alpha) + (rgbaB.g * (1 - alpha)));
		const b = Math.round((rgbaA.b * alpha) + (rgbaB.b * (1 - alpha)));
		const blendedHex = this.RGBA_toHex(new RGBA(r, g, b, 1));
		return this.multiply_saturationOf_by(blendedHex, 1 + ratio);
	}

	static readonly _____SATURATION: unique symbol;

	/**
	 * Multiplies the saturation of a color by the given ratio.
	 * 
	 * Converts the color to HSBA (Hue, Saturation, Brightness, Alpha) color space,
	 * multiplies the saturation component by the ratio (capped at 255), then converts
	 * back to hex format. Preserves hue and brightness while intensifying or reducing
	 * color saturation.
	 * 
	 * @param color - The input color in any CSS-compatible format (hex, rgb, named color, etc.)
	 * @param ratio - The multiplier for saturation (e.g., 2.0 doubles saturation, 0.5 halves it)
	 * @returns The color with adjusted saturation in hex format, or the original color if conversion fails
	 */
	private multiply_saturationOf_by(color: string, ratio: number): string {
		let hsba = this.color_toHSBA(color);
		if (!!hsba) {
			hsba.s = Math.min(255, hsba.s * ratio);
			const rgba = this.HSBA_toRGBA(hsba);
			return this.RGBA_toHex(rgba)
		}
		return color
	}

	static readonly _____LUMINANCE: unique symbol;
	
	darkerBy(color: string, ratio: number): string {
		return this.adjust_luminance_byApplying(color, (lume => {
			return (1 - lume) * (1 + ratio);
		}));
	}

	lighterBy(color: string, ratio: number): string {
		return this.adjust_luminance_byApplying(color, (lume => {
			return Math.max(0, (1 - lume) / ratio);
		}));
	}

	luminance_driven_desaturation(color: string): string {
		const lume = this.luminance_ofColor(color);
		if (lume > 0.5) {
			color = this.blend(color, 'black') ?? color;
		} else {
			color = this.blend(color, color) ?? color;
		}
		return color;
	}

	luminance_ofColor(color: string): number {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return this.luminance_ofRGBA(rgba);
		}
		return 0
	}

	private luminance_ofRGBA(rgba: RGBA): number {
		if (!!rgba) {
			const linearize = (c: number) => {
				const s = c / 255;
				return s <= 0.04045 ? s / 12.92 : Math.pow((s + 0.055) / 1.055, 2.4);
			};
			const R = linearize(rgba.r);
			const G = linearize(rgba.g);
			const B = linearize(rgba.b);
			const relative = 0.2126 * R + 0.7152 * G + 0.0722 * B;		// according to WCAG
			return rgba.a * relative + (1 - rgba.a) * 1;				// assume white background with luminance = 1
		}
		return 0;
	}

	private adjust_luminance_byApplying(color: string, closure: (lume: number) => number): string {
		let result = 'null';
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			const lume = this.luminance_ofRGBA(rgba);
			if (!!lume) {
				const dark = closure(lume);
				const adjusted = this.set_darkness_toRGBA(rgba, dark);
				result = adjusted ?? result;
			}
		}
		return result;
	}

	static readonly _____DARKNESS: unique symbol;

	private set_darkness_toColor(color: string, darkness: number): string {
		const rgba = this.color_toRGBA(color);
		if (!!rgba	) {
			return this.set_darkness_toRGBA(rgba, darkness);
		}
		return color;
	}

	private set_darkness_toRGBA(rgba: RGBA, darkness: number): string {
		const adjusted = this.adjust_RGBA_forDarkness(rgba, darkness);
		const rgba_new = adjusted.result;
		if (!adjusted.error && !!rgba_new) {
			return this.RGBA_toHex(rgba_new);
		}
		return this.RGBA_toHex(rgba);
	}

	private adjust_RGBA_forDarkness(rgba: RGBA, targetDarkness: number): {result: RGBA | null, error: Error | null} {
		
		//////////////////////////////////////////////////////////////////////////////////
		//																				//
		// Adjusts an RGBA color so that its "perceived darkness"						//
		//		equals the given target darkness.										//
		// returns an Error if a valid adjustment cannot be computed.					//
		//																				//
		//  Darkness is defined here as:												//
		// 	 darkness = 1 - (a * Y + (1 - a) * 1)										//
		//  where Y is the relative luminance computed from the linearized sRGB values.	//
		//																				//
		//  scales the color channels (preserving hue/saturation) such that:			//
		// 	 Y_new = 1 - (targetDarkness / a)											//
		//																				//
		//////////////////////////////////////////////////////////////////////////////////

		const r = rgba.r;
		const g = rgba.g;
		const b = rgba.b;
		const a = rgba.a;
		if (a === 0) {			// Check alpha constraints:
			if (targetDarkness !== 0) {
				return {result: rgba, error: new Error("With zero alpha, only target darkness 0 is possible.")};
			}
		}
		if (targetDarkness > a) {
			return {result: rgba, error: new Error("Target darkness must be <= alpha.")};
		}
		const srgbToLinear = (c: number): number => {
			// Helper to convert sRGB channel [0,255] to linear value [0,1]
			const s = c / 255;
			return s <= 0.04045 ? s / 12.92 : Math.pow((s + 0.055) / 1.055, 2.4);
		};
		const linearToSrgb = (c: number): number => {
			// Helper to convert linear value [0,1] to sRGB channel [0,1]
			return c <= 0.0031308 ? c * 12.92 : 1.055 * Math.pow(c, 1 / 2.4) - 0.055;
		};
		const R_lin = srgbToLinear(r);		// Convert original channels to linear space
		const G_lin = srgbToLinear(g);
		const B_lin = srgbToLinear(b);
		const Y = 0.2126 * R_lin + 0.7152 * G_lin + 0.0722 * B_lin;		// Compute current relative luminance Y
		if (Y === 0) {			// If the color is black and target darkness is not full darkness, we can't scale from 0.
			if (targetDarkness !== 1) {
				return {result: null, error: new Error("Cannot adjust a black color to be lighter while preserving hue.")};
			}
			return {result: rgba, error: null}; // already black
		}
		// Compute the desired relative luminance from target darkness:
		// effective luminance = 1 - targetDarkness must equal a * Y_new + (1-a)*1,
		// so Y_new = ( (1 - targetDarkness) - (1-a) ) / a = (a - targetDarkness) / a.
		const Y_new = (a - targetDarkness) / a;
		if (Y_new < 0 || Y_new > 1) {
			return {result: null, error: new Error("Computed target luminance out of range.")};
		}
		const k = Y_new / Y;		// Compute scaling factor k to adjust the color channels
		const R_new_lin = Math.min(R_lin * k, 1);		// Scale each channel in linear space (clamping to 1 if necessary)
		const G_new_lin = Math.min(G_lin * k, 1);
		const B_new_lin = Math.min(B_lin * k, 1);
		const R_new = Math.round(linearToSrgb(R_new_lin) * 255);		// Convert back to sRGB (and then to 0-255 integer values)
		const G_new = Math.round(linearToSrgb(G_new_lin) * 255);
		const B_new = Math.round(linearToSrgb(B_new_lin) * 255);

		return {result: new RGBA(R_new, G_new, B_new, a), error: null};
	}

	static readonly _____CONVERSIONS: unique symbol;

	private colors_areIdentical(a: string, b: string): boolean {
		const aHex = this.color_toHex(a);
		const bHex = this.color_toHex(b);
		if (!!aHex && !!bHex) {
			return aHex == bHex;
		}
		return false;
	}

	private color_toHex(color: string): string {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return this.RGBA_toHex(rgba);
		}
		return color;
	}

	private color_toHSBA(color: string): HSBA | null {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return this.RBGA_toHSBA(rgba);
		}
		return null;
	}

	private color_toRGBA(color: string): RGBA | null {
		try {
			const [r, g, b, a] = parseToRgba(color);
			return new RGBA(r, g, b, a);
		} catch {
			return null;
		}
	}

	private isGray(color: string): boolean {
		const rgba = this.color_toRGBA(color);
		if (!!rgba) {
			return rgba.r === rgba.g && rgba.g === rgba.b;
		}
		return false;
	}

	private RGBA_toHex(rgba: RGBA, omitAlpha: boolean = true): string {
		const r = Math.min(255, Math.max(0, rgba.r));		// Ensure the values are in the valid range
		const g = Math.min(255, Math.max(0, rgba.g));
		const b = Math.min(255, Math.max(0, rgba.b));
		const a = Math.min(1, Math.max(0, rgba.a));
		const rHex = r.toString(16).padStart(2, '0');		// Convert RGB to 2-digit hex
		const gHex = g.toString(16).padStart(2, '0');
		const bHex = b.toString(16).padStart(2, '0');
		const aHex = Math.round(a * 255).toString(16).padStart(2, '0');		// Convert alpha to a 2-digit hex (scale it to 255)
		const withoutAlpha = `#${rHex}${gHex}${bHex}`;
		if (omitAlpha) {
			return withoutAlpha;					// Return the hex color in rgb format
		} else {
			return `${withoutAlpha}${aHex}`;		// Return the hex color in rgba format
		}
	}

	private HSBA_toRGBA(hsba: HSBA): RGBA {
		const h = hsba.h;
		const s = hsba.s / 100;
		const b = hsba.b / 100;
		const a = hsba.a;
		const c = b * s; // Chroma
		const x = c * (1 - Math.abs((h / 60) % 2 - 1));
		const m = b - c;
		let r = 0, g = 0, b2 = 0;
		if (h >= 0 && h < 60) {
			r = c;
			g = x;
			b2 = 0;
		} else if (h >= 60 && h < 120) {
			r = x;
			g = c;
			b2 = 0;
		} else if (h >= 120 && h < 180) {
			r = 0;
			g = c;
			b2 = x;
		} else if (h >= 180 && h < 240) {
			r = 0;
			g = x;
			b2 = c;
		} else if (h >= 240 && h < 300) {
			r = x;
			g = 0;
			b2 = c;
		} else if (h >= 300 && h < 360) {
			r = c;
			g = 0;
			b2 = x;
		}
		// Add m to each RGB value
		r = Math.round((r + m) * 255);
		g = Math.round((g + m) * 255);
		b2 = Math.round((b2 + m) * 255);
		return new RGBA(r, g, b2, a);
	}

	private RBGA_toHSBA(rgba: RGBA): HSBA {
		const r = rgba.r / 255;
		const g = rgba.g / 255;
		const b = rgba.b / 255;
		const max = Math.max(r, g, b);
		const min = Math.min(r, g, b);
		const delta = max - min;
		let h = 0;
		if (delta !== 0) {
			if (max === r) {
				h = (g - b) / delta;
			} else if (max === g) {
				h = (b - r) / delta + 2;
			} else {
				h = (r - g) / delta + 4;
			}
			h = (h * 60 + 360) % 360;
		}
		const s = max === 0 ? 0 : (delta / max) * 100;
		const bValue = max * 100;
		return new HSBA(h, s, bValue, rgba.a);
	}

}

class RGBA {
	r!: number;
	g!: number;
	b!: number;
	a!: number;
	constructor(r: number = 0, g: number = 0, b: number = 0, a: number = 0) {
		this.r = r;
		this.g = g;
		this.b = b;
		this.a = a;
	}
}

class HSBA {
	h!: number;
	s!: number;
	b!: number;
	a!: number;
	constructor(h: number = 0, s: number = 0, b: number = 0, a: number = 0) {
		this.h = h;
		this.s = s;
		this.b = b;
		this.a = a;
	}
}

export const colors = new Colors();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/utilities/Testworthy_Utilities.ts
```ts
 // N.B., do not import these from Global Imports --> avoid dependency issues when importing Utilities class into test code

import Identifiable from '../runtime/Identifiable';
import type { Dictionary } from '../types/Types';
import { T_Quadrant } from '../types/Angle';
import { Point } from '../types/Coordinates';
import Angle from '../types/Angle';

export class Testworthy_Utilities {
	private orderedKeysCache = new WeakMap<object, string[]>();

	ignore(event: Event)							{}
	t_or_f(value: boolean): string					{ return value ? '|' : '-'; }
	quadrant_ofAngle(angle: number):	 T_Quadrant { return new Angle(angle).quadrant_ofAngle; }
	location_ofMouseEvent(event: MouseEvent): Point { return new Point(event.clientX, event.clientY); }
	consume_event(event: Event)						{ event.preventDefault(); event.stopPropagation(); }

	// remove item from a dictionary at the index
	// assuming it has string keys and number values
	valueFrom_atIndex<T extends Record<string, number>>(dictionary: T, index: number): number {
		const propNames = Object.keys(dictionary) as Array<keyof T>;
		if (index < 0 || index >= propNames.length) {
			throw new Error(`Index ${index} is out of bounds`);
		}
		return dictionary[propNames[index]];
	}

	valueFrom_atIndex_usingMap<T extends Record<string, number>>(dictionary: T, index: number): number {
		// Get or create the ordered keys for this dictionary
		let orderedKeys = this.orderedKeysCache.get(dictionary);
		if (!orderedKeys) {
			orderedKeys = Object.keys(dictionary);
			this.orderedKeysCache.set(dictionary, orderedKeys);
		}

		if (index < 0 || index >= orderedKeys.length) {
			throw new Error(`Index ${index} is out of bounds`);
		}
		return dictionary[orderedKeys[index] as keyof T];
	}

	remove<T>(from: Array<T>, item: T): Array<T> {
		let array = from;
		const index = array.findIndex((element: T) => element === item);
		if (index !== -1) {
			array.splice(index, 1);
		}
		return array;
	}

	copyObject(obj: any): any {
		const copiedObject = Object.create(Object.getPrototypeOf(obj));
		Object.assign(copiedObject, obj);
		return copiedObject;
	}

	basis_angle_ofType_Quadrant(quadrant: T_Quadrant): number {
		switch (quadrant) {
			case T_Quadrant.upperRight: return Angle.three_quarters;
			case T_Quadrant.lowerLeft:  return Angle.quarter;
			case T_Quadrant.upperLeft:  return Angle.half;
			default:					return 0;
		}
	}

	convertToObject(instance: any, fields: string[]): object {
		const o: Dictionary = {};
		for (const field of fields) {
			if (instance.hasOwnProperty(field)) {
				o[field] = instance[field];
			}
		}
		return o;
	}

	polygonPoints(radius: number, count: number, offset: number): Array<Point> {
		const increment = Angle.full / count;
		const points: Point[] = [];
		let angle = offset;
		let index = count;
		do {
			points.push(Point.fromPolar(radius, angle));
			angle += increment;
			index--;
		} while (index > 0)
		return points;
	}

	static readonly _____ARRAYS: unique symbol;

	concatenateArrays(a: Array<any>, b: Array<any>):  		  Array<any> { return [...a, ...b]; }
	strip_falsies(array: Array<any>):				  		  Array<any> { return array.filter(a => !!a); }
	subtract_arrayFrom(a: Array<any>, b: Array<any>): 		  Array<any> { return b.filter(c => a.filter(d => c != d)); }
	strip_invalid(array: Array<any>):				  		  Array<any> { return this.strip_duplicates(this.strip_falsies(array)); }
	uniquely_concatenateArrays(a: Array<any>, b: Array<any>): Array<any> { return this.strip_duplicates(this.concatenateArrays(a, b)); }
	convert_toNumber(values: Array<boolean>):					  number { return values.reduce((acc, val, index) => acc + (val ? (1 << index) : 0), 0); }

	remove_fromArray_byReference<T>(item: T, array: Array<T>): Array<T> {
		if (!item) return array;
		return array.filter(element => element !== item);
	}

	indexOf_inArray_byReference<T>(item: T, array: Array<T>): number {
		if (!item) return -1;
		return array.findIndex(element => element === item);
	}

	strip_duplicates(array: Array<any>): Array<any> {
		let stripped: Array<any> = [];
		for (const item of array) {
			if (!stripped.includes(item)) {
				stripped.push(item);
			}
		}
		return stripped;
	}

	static readonly _____ARRAYS_OF_IDENTIFIABLES: unique symbol;

	strip_invalid_Identifiables(array: Array<Identifiable>): Array<Identifiable> { return this.strip_identifiableDuplicates(this.strip_falsies(array)); }
	uniquely_concatenateArrays_ofIdentifiables(a: Array<Identifiable>, b: Array<Identifiable>): Array<Identifiable> { return this.strip_invalid_Identifiables(this.concatenateArrays(a, b)); }

	remove_fromArray<T extends Identifiable>(item: T, array: Array<T>): Array<T> {
		if (!item) return array;
		return array.filter(e => e.id !== item.id);
	}

	indexOf_inArray<T extends Identifiable>(item: T, array: Array<T>): number {
		if (!item) return -1;
		return array.findIndex(e => e.id === item.id);
	}

	strip_identifiableDuplicates(identifiables: Array<Identifiable>): Array<Identifiable> {
		let identifiablesByHID: Record<number, Identifiable> = {};
		let stripped: Array<Identifiable> = [];
		for (const identifiable of identifiables) {
			const hid = identifiable.hid;
			if ((!!hid || hid == 0) && (!identifiablesByHID[hid])) {
				identifiablesByHID[hid] = identifiable;
				stripped.push(identifiable);
			}
		}
		return stripped;
	}

	static readonly _____JSON: unique symbol;

	stringify_object(object: Object): string {
		const ignored = [
			'hid',
			'state',
			'idBase',
			'hidChild',
			'hidParent',
			'isGrabbed',
			'bulkRootID',
			't_database',
			'persistence',
			'selectionRange',
		];
		function removeExtras(key: string, value: any): any | undefined {
			if (ignored.includes(key)) {
				return undefined;
			}
			return value;
		}
		return JSON.stringify(object, removeExtras, 1);
	}

	/**
	 * Returns the cumulative sum (prefix sum) array for the input array.
	 * Example: [10, 20, 30] => [10, 30, 60]
	 */
	cumulativeSum(array: Array<number>): Array<number> {
		const result: Array<number> = [];
		array.reduce((acc, val) => {
			const sum = acc + val;
			result.push(sum);
			return sum;
		}, 0);
		return result;
	}

}

export const tu = new Testworthy_Utilities();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/utilities/Utilities.ts
```ts
// N.B., do not import these from Global Imports --> avoid dependency issues when importing Utilities class

import { Testworthy_Utilities } from './Testworthy_Utilities';
import { Rect, Size, Point } from '../types/Coordinates';
import Identifiable from '../runtime/Identifiable';
import { databases } from '../database/Databases';
import G_TreeLine from '../geometry/G_TreeLine';
import { show } from '../managers/Visibility';
import G_Widget from '../geometry/G_Widget';
import Ancestry from '../runtime/Ancestry';
import { Integer } from '../types/Types';
import { g } from '../managers/Geometry';
import { k } from '../common/Constants';
import { x } from '../managers/UX';
import { get } from 'svelte/store';
import { colors } from './Colors';
import { print } from './Print';

export class Utilities extends Testworthy_Utilities {
	
	descriptionBy_title(ancestries:		  Array<Ancestry> | null): string { return ancestries?.map(a => a?.title ?? k.unknown).join('-') ?? k.empty; }
	descriptionBy_titles(ancestries:	  Array<Ancestry> | null): string { return ancestries?.map(a => (a?.titles ?? [k.unknown])?.join(k.comma) ?? k.unknown).join('-') ?? k.unknown; }
	descriptionBy_sorted_HIDs(identifiables: Array<Identifiable>): string { return identifiables.map((a: Identifiable) => a?.hid ?? -1 as unknown as Integer).sort().join(k.comma); }
	descriptionBy_sorted_IDs(identifiables:  Array<Identifiable>): string { return identifiables.map((a: Identifiable) => a?.id ?? k.unknown).sort().join(k.comma); }
	sort_byOrder(ancestries: Array<Ancestry>):			  Array<Ancestry> { return ancestries.sort( (a: Ancestry, b: Ancestry) => { return a.order - b.order; }); }
	getWidthOf(s: string):										   number { return this.getWidth_ofString_withSize(s, `${k.font_size.common}px`); }

	ids_forDB(ancestries: Array<Ancestry>): string[] {
		return ancestries.filter(a => !!a && a?.t_database == get(databases.w_t_database)).map(a => a?.id ?? k.unknown);
	}

	resolve_signal_value(value: any): string {
		const type = value?.constructor?.name;
		return typeof value != 'object' ? value :
			(type === 'Ancestry' ? `Ancestry (${value.title})` : type ?? 'null');
	}

	getFontOf(element: HTMLElement): string {
		const style: CSSStyleDeclaration = window.getComputedStyle(element);
		const fontFamily: string = style.fontFamily;
		const fontSize: string = style.fontSize;
		return `${fontSize} ${fontFamily}`;
	}

	indexOf_withMatchingThingID_in(ancestry: Ancestry, ancestries: Array<Ancestry>): number {
		const thing = ancestry.thing;
		if (!!thing) {
			const index = ancestries.findIndex(a => a.thing?.id == thing.id);
			return index;
		}
		return -1;
	}

	sort_byTitleTop(ancestries: Array<Ancestry>): Array<Ancestry> {
		return ancestries.sort( (a: Ancestry, b: Ancestry) => {
			const aTop = a.rect_ofTitle?.origin.y;
			const bTop = b.rect_ofTitle?.origin.y;
			return (!aTop || !bTop) ? 0 : aTop - bTop;
		});
	}

	strip_hidDuplicates(ancestries: Array<Ancestry>): Array<Ancestry> {
		let ancestriesByHID: Record<number, Ancestry> = {};
		let stripped: Array<Ancestry> = [];
		for (const ancestry of ancestries) {
			const hid = ancestry.hid;
			if ((!!hid || hid == 0) && (!ancestriesByHID[hid])) {
				ancestriesByHID[hid] = ancestry;
				stripped.push(ancestry);
			}
		}
		return stripped;
	}

	strip_identifiableDuplicates(identifiables: Array<Identifiable>): Array<Identifiable> {
		let stripped: Array<Identifiable> = [];
		for (const identifiable of identifiables) {
			const hid = identifiable.hid;
			if ((!!hid || hid == 0)) {
				const index = stripped.findIndex(i => i.hid === hid);
				if (index == -1) {
					stripped.push(identifiable);
				} else if (stripped[index].hid < identifiable.hid) {
					stripped[index] = identifiable;		// assure array content is repeatable
				}
			}
		}
		return stripped;
	}

	strip_thingDuplicates_from(ancestries: Array<Ancestry>): Array<Ancestry> {
		let stripped: Array<Ancestry> = [];
		for (const ancestry of ancestries) {
			const hid = ancestry.thing?.hid;
			if ((!!hid || hid == 0)) {
				const index = stripped.findIndex(a => a.thing?.hid === hid);
				if (index == -1) {
					stripped.push(ancestry);
				} else if (stripped[index].depth < ancestry.depth) {
					stripped[index] = ancestry;		// assure array content is repeatable
				}
			}
		}
		return stripped;
	}

	hasMatching_bidirectional(bidirectionals: G_TreeLine[], g_line: G_TreeLine): boolean {
		return bidirectionals.some(b => 
			!!b.ancestry &&
			!!g_line.ancestry &&
			((b.ancestry.id == g_line.ancestry.id &&
			b.other_ancestry.id == g_line.other_ancestry.id) ||
			(b.ancestry.id == g_line.other_ancestry.id &&
			b.other_ancestry.id == g_line.ancestry.id)));
	}

	ancestries_orders_normalize(ancestries: Array<Ancestry>): void {
		const length = ancestries.length;
		if (length > 1) {
			this.sort_byOrder(ancestries);
			for (let index = 0; index < length; index++) {
				ancestries[index].order_setTo(index);
			}
		}
	}

	getWidth_ofString_withSize(str: string, fontSize: string): number {
		const element: HTMLElement = document.createElement('div');
		element.style.fontFamily = get(x.w_thing_fontFamily);
		element.style.left = '-9999px'; // offscreen
		element.style.padding = '0px 0px 0px 0px';
		element.style.position = 'absolute';
		element.style.fontSize = fontSize;
		element.style.whiteSpace = 'pre';
		element.textContent = str;
		document.body.appendChild(element);
		const width: number = element.getBoundingClientRect().width / get(g.w_scale_factor);
		document.body.removeChild(element);
		return width;
	}

	print_graph() {
		const rect = g.rect_ofAllWidgets;
		const className = show.inTreeMode ? 'tree-graph' : 'radial-graph';
		print.print_element_byClassName_withRect(className, rect, get(x.w_ancestry_focus)?.title ?? '');
	}

	temporarily_setDefaults_while(closure: () => void) {
		const recent = get(x.si_recents.w_item);
		const grabbed = recent?.si_grabs?.items ?? [];
		const grabIndex = recent?.si_grabs?.index ?? 0;
		const color = get(colors.w_background_color);
		colors.w_background_color.set('white');
		if (recent?.si_grabs) {
			recent.si_grabs.items = [];
			recent.si_grabs.index = 0;
		}
		setTimeout(() => {
			closure();
			if (recent?.si_grabs) {
				recent.si_grabs.items = grabbed;
				recent.si_grabs.index = grabIndex;
			}
			colors.w_background_color.set(color);
		}, 10);
	}

	print_element_byClassName_withRect(className: string, rect: Rect, title: string) {
		const element = document.querySelector(`.${className}`) as HTMLElement;
		const printWindow = window.open('', '_blank');
		if (!!printWindow && !!element) {
			printWindow.document.write(`
				<!DOCTYPE html>
				<html>
					<head>
						<title>Print</title>
						<style>
							body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
							@media print {
								body { margin: 0; }
							}
						</style>
						<link rel='stylesheet' href='/path/to/your/styles.css'>
					</head>
					<body>
						${element.outerHTML}
					</body>
				</html>
			`);
		
			printWindow.document.close();
			printWindow.focus();
			printWindow.print();
			printWindow.close();
		}
	}

	get_rect_ofGraphDrawing_forAll_g_widgets(g_widgets: G_Widget[]): Rect {
		if (g_widgets.length === 0) {
			return Rect.zero;
		}
		let minX = Infinity;
		let minY = Infinity;
		let maxX = -Infinity;
		let maxY = -Infinity;
		for (const g_widget of g_widgets) {
			const w_origin = g_widget.origin_ofGraphDrawing;
			const w_width = g_widget.width_ofWidget;
			const w_height = k.height.row - 1.5;
			const w_minX = w_origin.x;
			const w_minY = w_origin.y;
			const w_maxX = w_origin.x + w_width;
			const w_maxY = w_origin.y + w_height;
			minX = Math.min(minX, w_minX);
			minY = Math.min(minY, w_minY);
			maxX = Math.max(maxX, w_maxX);
			maxY = Math.max(maxY, w_maxY);
		}
		const width = maxX - minX;
		const height = maxY - minY;
		return new Rect(new Point(minX, minY), new Size(width, height));
	}

	convert_windowOffset_toCharacterOffset_in(offset: number, input: HTMLInputElement): number {
		const rect = input.getBoundingClientRect();
		const style = window.getComputedStyle(input);
		const paddingLeft = parseFloat(style.paddingLeft) || 0;
		const borderLeft = parseFloat(style.borderLeftWidth) || 0;
		const contentLeft = rect.left + borderLeft + paddingLeft;
		let relativeX = offset - contentLeft;
		if (relativeX < 0) {
			relativeX = 0;
		}
		const effectiveX = (relativeX + input.scrollLeft) / get(g.w_scale_factor);
		// Create a canvas context for measuring text.
		const canvas = document.createElement('canvas');
		const context = canvas.getContext('2d');
		if (!context) {
			return 0;
		}
		context.font = style.font || `${style.fontSize} ${style.fontFamily}`;
		const text = input.value;
		if (text.length === 0) {
			return 0;
		}
		// Use binary search to find the character index
		// whose measured width is as close as possible to effectiveX.
		let low = 0;
		let high = text.length;
		while (low < high) {
			const mid = Math.floor((low + high) / 2);
			const width = context.measureText(text.substring(0, mid)).width;
			if (width < effectiveX) {
				low = mid + 1;
			} else {
				high = mid;
			}
		}
		// low is now the smallest index where the width is >= effectiveX.
		// Optionally, check if the previous index was closer.
		if (low > 0) {
			const prevWidth = context.measureText(text.substring(0, low - 1)).width;
			const currWidth = context.measureText(text.substring(0, low)).width;
			if (Math.abs(effectiveX - prevWidth) < Math.abs(currWidth - effectiveX)) {
				return low - 1;
			}
		}
		return low;
	}

}

export const u = new Utilities();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/utilities/Print.ts
```ts
import Printable from '../../svelte/draw/Printable.svelte';
import { Rect } from '../types/Coordinates';
import { u } from './Utilities';
import printJS from 'print-js';

export default class Print {
	printable!: HTMLElement;
	
	print_element_byClassName_withRect(className: string, rect: Rect, title: string) {
		const element = document.querySelector(`.${className}`) as HTMLElement;
		this.print_element_withRect(element, rect, title);
	}
	
	async print_element_withRect(element: HTMLElement, rect: Rect, title: string) {
		if (!!element) {
			if (element.offsetWidth === 0 || element.offsetHeight === 0) {
				console.error('Element has zero dimensions, cannot print');
			} else {
				try {
					await new Promise(resolve => setTimeout(resolve, 100));
					u.temporarily_setDefaults_while(() => {
						const isLandscape = rect.size.width > rect.size.height;
						this.setup_printable(element, rect);
						this.print_printable(isLandscape, title);
					});
				} catch (error) {
					console.error('Error printing element:', error);
				}
			}
		}
	}
	
	private setup_printable(element: HTMLElement, rect: Rect) {
		this.printable = document.createElement('div');
		new Printable({
			target: this.printable,
			props: {
				element: element,
				rect: rect
			}
		});
	}
	
	private print_printable(isLandscape: boolean, title: string) {
		printJS({
			type: 'html',
			documentTitle: title,
			printable: this.printable,
			style: `
				@media print { 
					@page {
						size: ${isLandscape ? 'A4 landscape' : 'A4 portrait'};
						orientation: ${isLandscape ? 'landscape' : 'portrait'};
					}
				}
			`,
			scanStyles: false
		});
	}
}

export const print = new Print();```

### /Users/sand/GitHub/mono/ws/src/lib/ts/utilities/SVG_Paths.ts
```ts
import { k, u, Rect, Size, Point, Angle, T_Oblong, T_Orientation, Direction } from '../common/Global_Imports';
import type { Integer } from '../types/Types';

export default class SVG_Paths {

	line_connecting(start: Point, end: Point) { return `M ${start.x} ${start.y} L ${end.x} ${end.y}`; }

	line_atAngle(start: Point, radius: number, angle: number) {
		return this.line_connecting(start, Point.fromPolar(radius, angle).offsetBy(start))
	}

	rectangle(rect: Rect): string {
		return `M ${rect.x} ${rect.y} L ${rect.right} ${rect.y} L ${rect.right} ${rect.bottom} L ${rect.x} ${rect.bottom} Z`;
	}

    dash(diameter: number, margin: number): string {
		const y = diameter / 2;
        return `M${margin} ${y} L${diameter - margin} ${y}`;
    }

    x_cross(diameter: number, margin: number): string {
		const start = margin + 2;
		const end = diameter - start;
        return `M ${start} ${start} L ${end} ${end} M ${start} ${end} L ${end} ${start}`;
    }

    t_cross(diameter: number, margin: number): string {
		const radius = diameter / 2;
		const start = margin + 2;
		const end = diameter - margin - 2;
		return `M ${start} ${radius} L ${end} ${radius} M ${radius} ${start} L ${radius} ${end}`;
	}

	arrow_forTitle(diameter: number, margin: number, title: string): string {
		const orientation = Angle.orientation_from_name(title);
		return !orientation ? k.empty : this.arrow_forOrientation(diameter, margin, orientation);
	}

	arrow_forOrientation(diameter: number, margin: number, orientation: T_Orientation): string {
		const start = margin;
		const center = diameter / 2;
		const end = diameter - margin;
		const available = diameter - margin * 2;
		const arrowheadBase = available;
		const arrowheadLength = available * 2 / 3;
		const bodyWidth = available * 0.3;
		const bodyStart = start + arrowheadLength;
		const bodyEnd = end;
		switch (orientation) {
			case T_Orientation.right:
				return `M ${end} ${center} L ${end - arrowheadLength} ${center - arrowheadBase / 2} L ${end - arrowheadLength} ${center - bodyWidth / 2} L ${start} ${center - bodyWidth / 2} L ${start} ${center + bodyWidth / 2} L ${end - arrowheadLength} ${center + bodyWidth / 2} L ${end - arrowheadLength} ${center + arrowheadBase / 2} Z`;
			case T_Orientation.left:
				return `M ${start} ${center} L ${bodyStart} ${center - arrowheadBase / 2} L ${bodyStart} ${center - bodyWidth / 2} L ${bodyEnd} ${center - bodyWidth / 2} L ${bodyEnd} ${center + bodyWidth / 2} L ${bodyStart} ${center + bodyWidth / 2} L ${bodyStart} ${center + arrowheadBase / 2} Z`;
			case T_Orientation.up:
				return `M ${center} ${start} L ${center - arrowheadBase / 2} ${bodyStart} L ${center - bodyWidth / 2} ${bodyStart} L ${center - bodyWidth / 2} ${bodyEnd} L ${center + bodyWidth / 2} ${bodyEnd} L ${center + bodyWidth / 2} ${bodyStart} L ${center + arrowheadBase / 2} ${bodyStart} Z`;
			case T_Orientation.down:
				return `M ${center} ${end} L ${center - arrowheadBase / 2} ${end - arrowheadLength} L ${center - bodyWidth / 2} ${end - arrowheadLength} L ${center - bodyWidth / 2} ${start} L ${center + bodyWidth / 2} ${start} L ${center + bodyWidth / 2} ${end - arrowheadLength} L ${center + arrowheadBase / 2} ${end - arrowheadLength} Z`;
		}
	}

    circle_atOffset(width: number, diameter: number, offset: Point = Point.zero): string {
        const center = offset.offsetEquallyBy(width / 2);
		return this.circle(center, diameter / 2);
    }

    circle(center: Point, radius: number, clockwise: boolean = true): string {
		const direction = clockwise ? 0 : 1;
		const diametric_move = radius * 2 * (clockwise ? 1 : -1);
        return `M${center.x - radius} ${center.y} a ${radius} ${radius} 0 0 ${direction} ${diametric_move} 0 a ${radius} ${radius} 0 0 ${direction} ${-diametric_move} 0`;
    }

	annulus(center: Point, outer_radius: number, thickness: number, offset: Point = Point.zero): string {
		const offset_center = center.offsetBy(offset);
		const inner_center = offset_center.offsetByX(center.x * 2);
		return `${this.circle(offset_center, outer_radius, true)} ${this.circle(inner_center, outer_radius - thickness, false)}`;
	}

    oval(diameter: number, horizontal: boolean = true, eccentricity: number = 2.3): string {
        const radius = diameter / 2;
        const width = radius - (horizontal ? 1 : eccentricity);
        const height = radius - (horizontal ? eccentricity : 1);
        const doubleWidth = width * 2;
        return `M${radius - width} ${radius} a ${width} ${height} 0 1 0 ${doubleWidth} 0 a ${width} ${height} 0 1 0 ${-doubleWidth} 0`;
    }

	arc(center: Point, radius: number, sweepFlag: number, startAngle: number, endAngle: number): string {
		const end = center.offsetBy(Point.fromPolar(radius, endAngle));
		const start = center.offsetBy(Point.fromPolar(radius, startAngle));
		const largeArcFlag = ((startAngle - endAngle).angle_normalized() > Math.PI) ? 1 : 0;
		return `\nM ${start.x} ${start.y} \nA ${radius} ${radius} 0 ${largeArcFlag} ${sweepFlag} \n${end.x} ${end.y}`;
	}

	arc_partial(center: Point, radius: number, largeArcFlag: number, sweepFlag: number, endAngle: number): string {
		const end = center.offsetBy(Point.fromPolar(radius, endAngle));
		return `\nA ${radius} ${radius} 0 ${largeArcFlag} ${sweepFlag} \n${end.x} ${end.y}`;
	}

	startOutAt(center: Point, radius: number, startAngle: number) {
		const start = center.offsetBy(Point.fromPolar(radius, startAngle));
		return `\nM ${start.x} ${start.y}`;
	}

    half_circle(diameter: number, direction: number): string {
		const vertical = [Direction.up, Direction.down].includes(direction);
        const radius = diameter / 2;
		if (vertical) {
			const up = direction == Direction.up;
        	return `M ${up ? 0 : diameter} ${radius}
				A ${radius} ${radius} 0 0 1 ${radius + (up ? radius : -radius)} ${radius}`;
		} else {
			const left = direction == Direction.right;
        	return `M ${radius} ${left ? 0 : diameter}
				A ${radius} ${radius} 0 0 1 ${radius} ${left ? (radius * 2) : 0}`;
		}
    }

	fillets(center: Point, radius: number, direction: Direction): string {
		const baseAngle = direction + Angle.half;
		const leftEndAngle = baseAngle + Angle.quarter;
		const rightEndAngle = baseAngle - Angle.quarter;
		const a_start = center.offsetBy(Point.fromPolar(radius, leftEndAngle));
		const a_end = center.offsetBy(Point.fromPolar(radius, baseAngle));
		const b_end = center.offsetBy(Point.fromPolar(radius, rightEndAngle));
		const leftArc = `A ${radius} ${radius} 0 0 0 ${a_end.x} ${a_end.y}`;
		const rightArc = `A ${radius} ${radius} 0 0 0 ${b_end.x} ${b_end.y}`;
		return `M ${a_start.x} ${a_start.y} ${leftArc} ${rightArc} L ${a_start.x} ${a_start.y} Z`;
	}

	line(vector: Point, offset: Point = Point.zero): string {
		const x = vector.x + offset.x;
		const y = vector.y + offset.y;
		if (x >= 0 && y >= 0)		{ return `M ${offset.x} ${offset.y} L ${x} ${y}`;
		} else if (x >= 0 && y < 0)	{ return `M ${offset.x} ${-y} L ${x} ${offset.y}`;
		} else if (x < 0 && y >= 0)	{ return `M ${-x} ${offset.y} L ${offset.x} ${y}`;
		} else						{ return `M ${-x} ${-y} L ${offset.x} ${offset.y}`;
		}
	}

	polygon(radius: number, angle: number, count: number = 3, skip: Array<number>): string {
		const points = u.polygonPoints(radius, count, angle);
		const center = Point.square(radius);
		let index = count;
		let path = 'M ';
		while (index > 0) {
			index --;
			if (!skip.includes(index)) {
				const separator = (index == 0) ? k.empty : ' L ';
				const point = center.offsetBy(points[index]);
				path = path + `${point.x} ${point.y}${separator}`
			}
		}
		return path + ' Z';
	}

	tiny_outer_dots_circular(diameter: number, count: Integer, points_right: boolean ): string {
		const halfCircular = (count: Integer, dot_size: number, isBig: boolean = false): string => {
			return this.tiny_outer_dots_halfCircular(diameter, count, points_right, dot_size, isBig);
		};
		const thousands = Math.floor(count / 1000) as Integer;
		const hundreds = Math.floor((count - thousands * 1000) / 100) as Integer;
		const tens = Math.floor((count - thousands * 1000 - hundreds * 100) / 10) as Integer;
		const ones = count % 10 as Integer;
		const small = 1.5;
		const big = small * 1.3;
		const huge = big * 1.3;
		const gigantic = huge * 1.3;
		if (thousands > 0) {
			if (hundreds > 0) {
				return halfCircular(hundreds, huge) + halfCircular(thousands, gigantic, true);
			} else if (tens > 0) {
				return halfCircular(tens, big) + halfCircular(thousands, gigantic, true);
			} else if (ones > 0) {
				return halfCircular(ones, small) + halfCircular(thousands, gigantic, true);
			}
			return this.tiny_outer_dots_fullCircular(diameter, thousands, points_right, gigantic);
		} else if (hundreds > 0) {
			if (tens > 0) {
				return halfCircular(tens, big) + halfCircular(hundreds, huge, true);
			} else if (ones > 0) {
				return halfCircular(ones, small) + halfCircular(hundreds, huge, true);
			}
			return this.tiny_outer_dots_fullCircular(diameter, hundreds, points_right, huge);
		} else if (tens > 0) {
			if (ones > 0) {
				return halfCircular(ones, small) + halfCircular(tens, big, true);
			}
			return this.tiny_outer_dots_fullCircular(diameter, tens, points_right, big);
		} else if (ones > 0) {
			return this.tiny_outer_dots_fullCircular(diameter, ones, points_right, small);
		}
		return this.tiny_outer_dots_fullCircular(diameter, count, points_right);
	}

	tiny_outer_dots_fullCircular(diameter: number, count: Integer, points_right: boolean, dot_size: number = 2): string {
		if (count == 0) {
			return k.empty;
		}
		const radius = diameter / 3;
		const increment = Math.PI * 2 / count;
		const radial = Point.x(radius).rotate_by(points_right ? 0 : Math.PI);
		return this.tiny_outer_dots_path(diameter, dot_size, increment, count, radial);
	}

	tiny_outer_dots_halfCircular(diameter: number, count: Integer, points_right: boolean, dot_size: number, isBig: boolean = false): string {
		if (count == 0) {
			return k.empty;
		}
		const radius = diameter / 3;
		const increment = Math.PI / count;
		let radial = Point.y((isBig == points_right) ? -radius : radius).rotate_by(increment / 2);
		return this.tiny_outer_dots_path(diameter, dot_size, increment, count, radial);
	}

	tiny_outer_dots_path(diameter: number, dot_size: number, increment: number, count: Integer, radial: Point) {
		let i = 0;
		let path = k.empty;
		while (i++ < count) {
			path = path + this.circle_atOffset(diameter, dot_size, radial.offsetByXY(-0.7, 0.3));
			radial = radial.rotate_by(increment);
		}
		return path;
	}

	ellipses(stretch: number, tiny: number, horizontal: boolean = true, count: number = 3, other: number = 6): string {
		const max = Math.min(4, count);
		const gap = stretch / (max - 1) - tiny;
		let a = 2.5 + ((max > 2) ? 0 : k.halfIncrement);
		let i = 0;
		let paths: string[] = [];
		const pairs: Array<Array<number>> = [[a]];
		while (i < max) {
			const b = a + tiny * 2;
			pairs[i][1] = b;
			if (i + 1 < max) {
				a = b + gap - tiny / max;
				pairs[i + 1] = [a];
			}
			i++;
		}
		if (horizontal) {
			paths = pairs.map(p => `M ${p[0]} ${other} A ${tiny} ${tiny} 0 1 1 ${p[1]} ${other} A ${tiny} ${tiny} 0 1 1 ${p[0]} ${other}`);
		} else {
			paths = pairs.map(p => `M ${other} ${p[0]} A ${tiny} ${tiny} 0 1 1 ${other} ${p[1]} A ${tiny} ${tiny} 0 1 1 ${other} ${p[0]}`);
		}
		return paths.join(k.space);
	}

	fat_polygon_path_for(name: string, size: number = 16): string | null {
		let angle = Angle.angle_from_name(name);
		return angle != null ? this.fat_polygon(size, angle) : null;
	}

	// TODO: this only works for the default number of vertices (3)
	fat_polygon(size: number, angle: number, onCenter: boolean = false, vertices: number = 3): string {
		const segmentAngle = Math.PI / vertices;
		const offset = onCenter ? Point.zero : Point.square(size / 2);
		const inner = Point.x(size / 3);
		const outer = Point.x(size / 2);
		const tweak = segmentAngle / 5;
		let data = [];
		let i = 0;
		while (i++ < vertices) {
			const final = angle + i * segmentAngle * 2; // multiples of one third of a circle
			const halfWay = final - segmentAngle;
			const preceder = halfWay - tweak;
			const follower = halfWay + tweak;
			data.push({
				controlOne: outer.rotate_by(preceder).offsetBy(offset),
				controlTwo: outer.rotate_by(follower).offsetBy(offset),
				end:		inner.rotate_by(   final).offsetBy(offset),
			});
		}
		const start = data[vertices - 1].end;
		const arcs = data.map(d => `C${d.controlOne.description} ${d.controlTwo.description} ${d.end.description}`);
		return 'M' + start.description+ k.space + arcs.join(k.space) + 'Z';
	}

	oblong(center: Point, size: Size, part: T_Oblong = T_Oblong.full): string {
		const bumpRight = [T_Oblong.full, T_Oblong.right].includes(part);
		const bumpLeft = [T_Oblong.full, T_Oblong.left].includes(part);
		const radius = size.height / 2;
		const half = size.width / 2;
		const cx = center.x;
		const cy = center.y;
		const L = cx - half + (bumpLeft ? 0 : radius);
		const R = cx + half + (bumpRight ? 0 : radius);
		const T = cy - radius;
		const B = cy + radius;
		const TL = `${L}, ${T}`;
		const TR = `${R}, ${T}`;
		const BR = `${R}, ${B}`;
		const BL = `${L}, ${B}`;
		const cap = `${radius}, ${radius} 0 0 1`;
		switch (part) {
			case T_Oblong.middle: return `M ${TL} L ${TR} L ${BR} L ${BL} L ${TL} Z`;
			case T_Oblong.right:  return `M ${TL} L ${TR} A ${cap} ${BR} L ${BL} L ${TL} Z`;
			case T_Oblong.left:	 return `M ${TL} L ${TR} L ${BR} L ${BL} A ${cap} ${TL} Z`;
			case T_Oblong.full:	 return `M ${TL} L ${TR} A ${cap} ${BR} L ${BL} A ${cap} ${TL} Z`;
		}
		return k.empty;
	}

	pill(center: Point, size: Size): string {
		const radius = size.height / 2;
		const half = size.width / 2;
		const cx = center.x;
		const cy = center.y;
		const L = cx - half;
		const R = cx + half;
		const T = cy - radius;
		const B = cy + radius;
		return `M ${L}, ${T} L ${R}, ${T} A ${radius}, ${radius} 0 0 1 ${R}, ${B} L ${L}, ${B} A ${radius}, ${radius} 0 0 1 ${L}, ${T} Z`;
	}

	hamburgerPath(size: number = 150): string {

		// @returns SVG path string that renders a hamburger icon
		//	comprised of three horizontal pills
		//	each is size long and 1/5 of the size thick
		//	gaps between are 1/5 of the size

		const barHeight = size / 5;
		const barSize = new Size(size, barHeight);
		const x = size / 2;
		const threeYs = [barHeight / 2, size / 2, size - barHeight / 2];
		const paths = threeYs.map(y => this.pill(new Point(x, y), barSize));
		return paths.join(k.space);
	}

	// double arrows
	// <polygon points='66.08 8.13 46.18 0 50.32 7.13 34.58 7.13 34.58 3.13 32.58 3.13 32.58 7.13 15.76 7.13 19.9 0 0 8.13 19.9 16.26 15.76 9.13 32.58 9.13 32.58 13.13 34.58 13.13 34.58 9.13 50.32 9.13 46.18 16.26 66.08 8.13'/>
	// rotate icon
	// <path class='b' d='M13.65 9.12c9.31-1.71 22.64-2.81 37.69 .01'/><polygon points='0 12.74 21.28 15.8 14.72 9.06 17.34 .03 0 12.74'/><polygon points='65 12.74 43.72 15.77 50.28 9.04 47.69 0 65 12.74'/>

	get hammer(): string {
		return 'M4 12\
			C4 7.58172 7.58172 4 12 4\
			C12.5523 4 13 3.55228 13 3\
			C13 2.44772 12.5523 2 12 2\
			C6.47715 2 2 6.47715 2 12\
			C2 17.5228 6.47715 22 12 22\
			C14.7611 22 17.2625 20.8796 19.0711 19.0711\
			C19.4616 18.6805 19.4616 18.0474 19.0711 17.6569\
			C18.6805 17.2663 18.0474 17.2663 17.6569 17.6569\
			C16.208 19.1057 14.2094 20 12 20\
			C7.58172 20 4 16.4183 4 12Z\
			M13 6\
			C13 5.44772 12.5523 5 12 5\
			C11.4477 5 11 5.44772 11 6V12\
			C11 12.2652 11.1054 12.5196 11.2929 12.7071\
			L14.2929 15.7071\
			C14.6834 16.0976 15.3166 16.0976 15.7071 15.7071\
			C16.0976 15.3166 16.0976 14.6834 15.7071 14.2929\
			L13 11.5858V6\
			Z\
			M21.7483 15.1674\
			C21.535 15.824 20.8298 16.1833 20.1732 15.97\
			C19.5167 15.7566 19.1574 15.0514 19.3707 14.3949\
			C19.584 13.7383 20.2892 13.379 20.9458 13.5923\
			C21.6023 13.8057 21.9617 14.5108 21.7483 15.1674Z\
			M21.0847 11.8267\
			C21.7666 11.7187 22.2318 11.0784 22.1238 10.3966\
			C22.0158 9.71471 21.3755 9.2495 20.6937 9.3575\
			C20.0118 9.46549 19.5466 10.1058 19.6546 10.7877\
			C19.7626 11.4695 20.4029 11.9347 21.0847 11.8267Z\
			M20.2924 5.97522\
			C20.6982 6.53373 20.5744 7.31544 20.0159 7.72122\
			C19.4574 8.127 18.6757 8.00319 18.2699 7.44468\
			C17.8641 6.88617 17.9879 6.10446 18.5464 5.69868\
			C19.1049 5.2929 19.8867 5.41671 20.2924 5.97522Z\
			M17.1997 4.54844\
			C17.5131 3.93333 17.2685 3.18061 16.6534 2.86719\
			C16.0383 2.55378 15.2856 2.79835 14.9722 3.41346\
			C14.6588 4.02858 14.9033 4.78129 15.5185 5.09471\
			C16.1336 5.40812 16.8863 5.16355 17.1997 4.54844\
			Z';
	}

	// for debugging paths
	sizeFrom_svgPath(svgPath: string): Size {
		let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
		const commands = svgPath.match(/[a-zA-Z][^a-zA-Z]*/g) || [];
		let x = 0, y = 0;
		for (const command of commands) {
			const type = command[0];
			const args = command.slice(1).trim().split(/[\s,]+/).map(Number);
			switch (type) {
				case 'H': x = args[0]; break;
				case 'V': y = args[0]; break;
				case 'M':
				case 'L': [x, y] = args; break;
				case 'a':
				case 'A': handleArcCommand(args); break;
				case 'Z': break; // Close path, no coordinates to update
				default: throw new Error(`Unsupported command: ${type}`);
			}
			minX = Math.min(minX, x);
			minY = Math.min(minY, y);
			maxX = Math.max(maxX, x);
			maxY = Math.max(maxY, y);
		}

		function handleArcCommand(args: Array<number>): void {
			const startX = x;
			const startY = y;
			let [rx, ry, xAxisRotation, largeArcFlag, sweepFlag, endX, endY] = args;
			x = endX;
			y = endY;
			const xAxisRotationRad = (xAxisRotation * Math.PI) / 180;							// Convert rotation to radians
			const dx2 = (startX - endX) / 2.0;													// Compute the half distance between the db_now and the end point
			const dy2 = (startY - endY) / 2.0;
			const x1 = Math.cos(xAxisRotationRad) * dx2 + Math.sin(xAxisRotationRad) * dy2;
			const y1 = -Math.sin(xAxisRotationRad) * dx2 + Math.cos(xAxisRotationRad) * dy2;
			const radiiCheck = (x1 * x1) / (rx * rx) + (y1 * y1) / (ry * ry);					// Ensure radii are large enough
			if (radiiCheck > 1) {
				rx *= Math.sqrt(radiiCheck);
				ry *= Math.sqrt(radiiCheck);
			}
			const sign = largeArcFlag === sweepFlag ? -1 : 1;
			const sq = ((rx * rx) * (ry * ry) - (rx * rx) * (y1 * y1) - (ry * ry) * (x1 * x1)) / ((rx * rx) * (y1 * y1) + (ry * ry) * (x1 * x1));
			const coef = sign * Math.sqrt(Math.max(sq, 0));
			const cx1 = coef * ((rx * y1) / ry);
			const cy1 = coef * -((ry * x1) / rx);
			const cx = (startX + endX) / 2.0 + Math.cos(xAxisRotationRad) * cx1 - Math.sin(xAxisRotationRad) * cy1;
			const cy = (startY + endY) / 2.0 + Math.sin(xAxisRotationRad) * cx1 + Math.cos(xAxisRotationRad) * cy1;
			minX = Math.min(minX, startX, endX, cx - rx, cx + rx);								// Calculate bounding box
			minY = Math.min(minY, startY, endY, cy - ry, cy + ry);
			maxX = Math.max(maxX, startX, endX, cx - rx, cx + rx);
			maxY = Math.max(maxY, startY, endY, cy - ry, cy + ry);
		}
		return new Size(maxX - minX, maxY - minY);
	}

	/**
	 * Test if a screen point is inside an SVG path's fill area.
	 * Uses native SVG hit testing - works with any path complexity.
	 *
	 * @param point - Screen coordinates (e.g., from mouse event)
	 * @param pathElement - The SVG path element to test against
	 * @returns true if point is inside the path's fill
	 */
	isPointInPath(point: Point | null, pathElement: SVGPathElement | null): boolean {
		if (!point || !pathElement) return false;

		const svg = pathElement.ownerSVGElement;
		if (!svg) return false;

		// Convert screen coordinates to SVG coordinates
		const svgPoint = svg.createSVGPoint();
		svgPoint.x = point.x;
		svgPoint.y = point.y;

		const ctm = pathElement.getScreenCTM();
		if (!ctm) return false;

		const transformed = svgPoint.matrixTransform(ctm.inverse());

		// Use native SVG hit testing
		return pathElement.isPointInFill(new DOMPoint(transformed.x, transformed.y));
	}

}

export const svgPaths = new SVG_Paths();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/common/Extensions.ts
```ts
import type { Integer } from '../types/Types';

declare global {
	interface String {
		hash(): Integer;
		lastWord(): string;
		html_encode(): string;
		unCamelCase(): string;
		removeWhiteSpace(): string;
		encode_as_property(): string;
		decode_from_property(): string;
		injectEllipsisAt(at: number): string;
		clipWithEllipsisAt(at: number): string;
		fontSize_relativeTo(base: number): number;
		removeOccurencesOf(characters: string): string;
		beginWithEllipsis_forLength(length: number): string;
	}
}

Object.defineProperty(String.prototype, 'unCamelCase', {
	value: function(): string {
		return this.replace(/([A-Z])/g, ' $1').toLowerCase();
	},
	writable: false, // Set writable to false to prevent the method to be overwritten
	enumerable: false, // Set enumerable to false to avoid unintended behavior
	configurable: false // Set configurable to false to prevent redefinition of the property
});

Object.defineProperty(String.prototype, 'removeWhiteSpace', {
	value: function(): string {
		return this.split('\n').join(' ').split('\t').join('').trim();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'encode_as_property', {
	value: function(): string {
		// in ts, hyphens, spaces and parentheses are not allowed in property names
		return this.removeWhiteSpace().split(' ').join('_').split('-').join('$$$').split('(').join('$$').split(')').join('$');
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'decode_from_property', {
	value: function(): string {
		return this.split('$$$').join('-').split('$$').join('(').split('$').join(')');
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'removeOccurencesOf', {
	value: function(characters: string): string {
		if (!characters) return this;
		const pattern = new RegExp(`^[${characters}]+|[${characters}]+$`, 'g');
		return this.replace(pattern, '').trim();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'lastWord', {
	value: function(): string {
		return this.split(' ').slice(-1)[0];
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'fontSize_relativeTo', {
	value: function(base: number): number {
		if (this.includes('em')) {
			return base * parseFloat(this.split('em')[0]);
		} else if (this.includes('px')) {
			return Number(this.split('px')[0]);
		}
		return Number(this);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'injectEllipsisAt', {
	value: function(at: number = 6): string {
		let injected = this;
		const length = injected.length;
		if (length > (at * 2) + 1) {
			injected = injected.slice(0, at) + ' ... ' + injected.slice(length - at, length);
		}
		return injected;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'clipWithEllipsisAt', {
	value: function(at: number = 15): string {
		let clipped = this;
		const length = clipped.length;
		if (length > at) {
			clipped = clipped.slice(0, at) + ' ...';
		}
		return clipped;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'beginWithEllipsis_forLength', {
	value: function(length: number = 6): string {
		let injected = this;
		if (injected.length > length) {
			injected = ' ... ' + injected.slice(injected.length - length, injected.length);
		}
		return injected;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'hash', {
	value: function() {
		let hash = 0,
		i, character;
		if (this.length === 0) {
			return hash;
		}
		for (i = 0; i < this.length; i++) {
			character = this.charCodeAt(i);
			hash = ((hash << 5) - hash) + character;
			hash |= 0; // Convert to 32bit integer
		}
		return hash;
	},
	writable: true,
	enumerable: true,
	configurable: true
});

Object.defineProperty(String.prototype, 'sizeOf_svgPath', {
	value: function(): string {
		return this.split(' ').slice(-1)[0];
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(String.prototype, 'html_encode', {
	value: function(): string {
		let encoded = this.replace(/\n+/g, '').trim();
		return encodeURIComponent(encoded)
			.replace(/%22/g, '\'')	// un-encode for easier reading
			.replace(/%2B/g, '+')
			.replace(/%3A/g, ':')
			.replace(/%3F/g, '?')
			.replace(/%23/g, '#')
			.replace(/%2F/g, '/')
			.replace(/%3D/g, '=')
			.replace(/%20/g, ' ')
			// .replace(/%3C/g, '<')
			// .replace(/%3E/g, '>')
			;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

declare global {
	interface Number {
		nth(): string;
		asInt(): string;
		asDegrees(): string;
		roundToEven(): number;
		supressZero(): string;
		supressNegative(): string;
		angle_normalized(): number;
		toFixed(precision: number): string;
		angle_normalized_aroundZero(): number;
		degrees_of(precision: number): string;
		straddles_zero(other: number): boolean;
		add_angle_normalized(angle: number): number;
		normalize_between_zeroAnd(value: number): number;
		isAlmost(target: number, within: number): boolean;
		increment_by(delta: number, total: number): number;
		increment(increment: boolean, total: number): number;
		force_between(smallest: number, largest: number): number;
		isBetween(a: number, b: number, inclusive: boolean): boolean;
		isClocklyBetween(a: number, b: number, limit: number): boolean;
		of_n_for_type(n: number, type: string, plurality: string): string;
		force_asInteger_between(smallest: number, largest: number): number;
		bump_towards(smallest: number, largest: number, within: number): number;
		isClocklyAlmost(target: number, within: number, clock: number): boolean;
	}
}

Object.defineProperty(Number.prototype, 'isAlmost', {
	value: function(target: number, within: number): boolean {
		return Math.abs(this - target) < within;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'force_asInteger_between', {
	value: function(a: number, b: number): number {
		return Math.round(this.force_between(a, b));
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'force_between', {
	value: function(a: number, b: number): number {
		const largest = Math.max(a, b);
		const smallest = Math.min(a, b);
		return Math.max(smallest, Math.min(largest, this));
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'increment', {
	value: function(increase: boolean, total: number): number {
		return this.increment_by(increase ? 1 : -1, total);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'increment_by', {
	value: function(delta: number, total: number): number {
		let result = this.valueOf() + delta;
		return result.normalize_between_zeroAnd(total);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'add_angle_normalized', {
	value: function(angle: number): number {
		return (this + angle).angle_normalized();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'straddles_zero', {
	value: function(other: number): boolean {
		return this.angle_normalized() > other.angle_normalized();
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'angle_normalized', {
	value: function(): number {
		return this.normalize_between_zeroAnd(Math.PI * 2);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'angle_normalized_aroundZero', {
	value: function(): number {
		// range from - to + PI
		return (this + Math.PI).angle_normalized() - Math.PI;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'isBetween', {
	value: function(a: number, b: number, inclusive: boolean): boolean {
		const min = Math.min(a, b),
			  max = Math.max(a, b);
		return inclusive ? (this >= min && this <= max) : (this > min && this < max);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'roundToEven', {
	value: function(): Integer {
		return (Math.round(this / 2) * 2) as Integer;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'asDegrees', {
	value: function(): string {
		return this.degrees_of(0);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'degrees_of', {
	value: function(precision: Integer): string {
		const degrees = this * 180 / Math.PI;
		return degrees.toFixed(precision);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'isClocklyBetween', {
	value: function(a: number, b: number, normalizeTo: number): boolean {
		const value = this.normalize_between_zeroAnd(normalizeTo);
		const cycled: number = value - normalizeTo;
		let min = Math.min(a, b),
			max = Math.max(a, b);
		return this.isBetween(min, max, true) || cycled.isBetween(min, max, true);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'isClocklyAlmost', {
	// after normalizing to normalizeTo, is this almost target (+/- within)?
	value: function(target: number, within: number, normalizeTo: number): boolean {
		return this.isClocklyBetween(target - within, target + within, normalizeTo);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'supressNegative', {
	value: function(): string | number {
		return this < 0 ? '' : this;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'supressZero', {
	value: function(): string | number {
		return this == 0 ? '-' : this;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'asInt', {
	value: function(): string {
		return this.toFixed(0);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'of_n_for_type', {
	value: function(n: number, type: string, plurality: string): string {
		return `${type}${n == 1 ? '' : plurality}: ${(this + 1).nth()} of ${n}`;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'nth', {
	value: function(): string {
		const prefix = this.asInt();
		const n = Number(prefix);
		let suffix = 'th';
		if (n < 10 || n > 20) {
			switch (n % 10) {
				case 1: suffix = 'st'; break;
				case 2: suffix = 'nd'; break;
				case 3: suffix = 'rd'; break;
			}
		}
		return prefix + suffix;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'toFixed', {
	value: function(precision: Integer): string {
		const formatter = new Intl.NumberFormat('en-US', {
			style: 'decimal',
			maximumFractionDigits: precision,
			minimumFractionDigits: precision,
			useGrouping: false
		});
		return formatter.format(this);
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'bump_towards', {
	value: function(smallest: number, largest: number, within: number): number {
		if (this < smallest || this.isAlmost(smallest, within)) {
			return smallest;
		}
		if (this > largest || this.isAlmost(largest, within)) {
			return largest;
		}
		return this;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

Object.defineProperty(Number.prototype, 'normalize_between_zeroAnd', {

	// converts this using clock arithmetic
	// force between 0 and value
	// inclusive

	value: function(value: number): number {
		let result = this;
		if (value != 0) {
			while (result < 0) {
				result += value;
			}
			while (result >= value) {
				result -= value;
			}
		}
		return result;
	},
	writable: false,
	enumerable: false,
	configurable: false
});

// Object.defineProperty(String.prototype, 'boilerplate', {
//	value: function(foo: number): string {
//		return k.empty;
//	},
//	enumerable: false, // Set enumerable to false to avoid unintended behavior
//	writable: false, // Set writable to false to prevent the method to be overwritten
//	configurable: false // Set configurable to false to prevent redefinition of the property
// });

export {};```

### /Users/sand/GitHub/mono/ws/src/lib/ts/common/Builds.ts
```ts
export class Builds {
	notes: Record<number, Array<string>> = {
		191 : ['January 31, 2026', 'final candidate 3'],
		190 : ['January 29, 2026', 'final candidate 2'],
		189 : ['January 26, 2026', 'persist recents in local storage'],
		188 : ['January 25, 2026', 'major housekeeping, minor UI improvements'],
		187 : ['January 21, 2026', 'new recents as source of truth'],
		186 : ['January 14, 2026', 'new public deliverables status page'],
		185 : ['January 5, 2026', 'friendlier layout of controls'],
		184 : ['January 1, 2026', 'incorporate new internal documentation database'],
		183 : ['December 27, 2025', 'fully wire up dynamic/static focus'],
		182 : ['December 24, 2025', 'preference option to show children counts as numbers'],
		181 : ['December 22, 2025', 'restore grabs when navigating history'],
		180 : ['December 20, 2025', 'new breadcrumbs history type'],
		179 : ['December 18, 2025', 'new Styles manager centralizes color computation'],
		178 : ['December 17, 2025', 'fully isolate mouse logic within hits manager'],
		177 : ['December 13, 2025', 'mouse responder is dead!'],
		176 : ['December 2, 2025', 'new curved cluster titles'],
		175 : ['December 1, 2025', 'new hover system'],
		174 : ['November 25, 2025', 'click drag dot changes focus (in both graph modes)'],
		173 : ['November 18, 2025', 'decrease spacing everywhere'],
		172 : ['November 14, 2025', 'simplified non-standalone UI mode'],
		171 : ['November 3, 2025', 'tag and trait details now correctly use s items'],
		170 : ['October 25, 2025', 'refactored hover logic'],
		169 : ['October 19, 2025', 'revised bubble plugin API'],
		168 : ['October 8, 2025', 'adopt s items design for recents, search and tags'],
		167 : ['September 21, 2025', 'move search controls to left of breadcrumbs'],
		166 : ['September 17, 2025', 'new secondary controls: more room for search and tree type'],
		165 : ['September 11, 2025', 'revise plugin names, add data load spinner, repair search'],
		164 : ['September 7, 2025', 'super fast search'],
		163 : ['September 3, 2025', 'suppress select and focus events during plugin data download'],
		162 : ['August 26, 2025', 'fix bugs (editing, layout, color, hover), new print utility'],
		161 : ['August 9, 2025', 'rubberband and command drag'],
		160 : ['August 8, 2025', 'wire up focus and select for bubble plugin'],
		159 : ['August 7, 2025', 'new zoom buttons. tolerate space in parents and related field names'],
		158 : ['July 31, 2025', 'adopt Vincent\'s proposal for parents and related'],
		157 : ['July 27, 2025', 'add focus and grabs to plugin fields'],
		156 : ['July 25, 2025', 'using data received from bubble'],
		155 : ['July 24, 2025', 'bubble plugin now receiving valid data'],	
		154 : ['July 18, 2025', 'move tree preferences into tree graph'],
		153 : ['July 12, 2025', 'UI suggestions from Vincent Arena'],
		152 : ['July 5, 2025', 'now loads as a bubble plugin'],
		151 : ['July 1, 2025', 'autorepeat previous and next buttons'],
		150 : ['June 29, 2025', 'support for multiple selected things'],
		149 : ['June 25, 2025', 'hover logic applied everywhere'],
		148 : ['June 20, 2025', 'wired up new recents buttons'],
		147 : ['June 14, 2025', 'show help for actions'],
		146 : ['June 12, 2025', 'use filled to indicate grabbed'],
		145 : ['June 7, 2025', 'new depth limit in display details'],
		144 : ['June 5, 2025', 'new panel layout'],
		143 : ['June 2, 2025', 'details banners now have glowing buttons'],
		142 : ['May 25, 2025', 'should now read tags table from firebase'],
		141 : ['May 25, 2025', 'brand new details view'],
		140 : ['May 24, 2025', 'begin work on tags'],
		139 : ['May 22, 2025', 'hopefully stable import from marianne as csv into firebase'],
		138 : ['May 20, 2025', 'reorganize details so title is always visible'],
		137 : ['May 19, 2025', 'new traits details'],
		136 : ['May 14, 2025', 'read marianne\'s csv file into local db'],
		135 : ['May 12, 2025', 'all go wired and working'],
		134 : ['May 3, 2025', 'new go in Details'],
		133 : ['April 3, 2025', 'new control to show related relationships'],
		132 : ['March 19, 2025', 'new radial UX'],
		131 : ['March 18, 2025', 'fast and smooth response to editing and rotating'],
		130 : ['March 10, 2025', 'title editor busts ass, new Ancestry-centric architecture'],
		129 : ['February 13, 2025', 'title editor temporarily broken'],
		128 : ['January 29, 2025', 'display details, finish logic for controlling tiny dots'],
		127 : ['January 21, 2025', 'fixed translation of thing ids during import'],
		126 : ['December 29, 2024', 'rename rings as radial'],
		125 : ['December 28, 2024', 'working import and export buttons in Storage'],
		124 : ['December 27, 2024', 'files can move across dbs'],
		123 : ['December 19, 2024', 'begin work on tutorial'],
		122 : ['December 17, 2024', 'improved details'],
		121 : ['December 11, 2024', 'fix breadcrumb button cosmetics'],
		120 : ['December 9, 2024', 'save and read subtrees'],
		119 : ['November 30, 2024', 'can save to a file (and fetch) entire hierarchy'],
		118 : ['November 27, 2024', 'OFFICIAL ALPHA RELEASE'],
		117 : ['November 19, 2024', 'new details mode segmented'],
		116 : ['November 1, 2024', 'adopt segmented controls'],
		115 : ['October 6, 2024', 'graph, touch, controls on mobile'],
		114 : ['October 2, 2024', 'begin work on mobile)'],
		113 : ['September 24, 2024', 'add new game feature (consequences & quests)'],
		112 : ['September 12, 2024', 'new info details'],
		111 : ['September 8, 2024', 'new resize ring'],
		110 : ['August 30, 2024', 'airtable dbid support'],
		109 : ['August 22, 2024', 'rotate cluster label tangent to arc'],
		108 : ['August 18, 2024', 'paging persists for multiple things and dbs'],
		107 : ['August 12, 2024', 'thumb works (funky)'],
		106 : ['August 1, 2024', 'fixed netlify cluster mode'],
		105 : ['July 30, 2024', 'corrected thumb position and shape of arc and thumb'],
		104 : ['July 2, 2024', 'save and restore paging thumb position'],
		103 : ['June 30, 2024', 'paging thumb button works'],
		102 : ['June 18, 2024', 'visibility logic for advance buttons'],
		101 : ['June 13, 2024', 'limit the number of things within each cluster'],
		100 : ['June 6, 2024', 'significantly reduce stutter during rotation_ring rotation'],
		99 : ['June 4, 2024', 'expand help content and move to help-webseriously.netlify.app'],
		98 : ['May 23, 2024', 'double-click drag to alter ring button radius'],
		97 : ['May 20, 2024', 'cluster rotation perfected, improved memory usage'],
		96 : ['May 14, 2024', 'nearly perfect cluster curly braces, new cluster line angles'],
		95 : ['May 10, 2024', 'add color editing'],
		94 : ['May 4, 2024', 'replace to/from with child/parent and directions with isBidirectional'],
		93 : ['May 2, 2024', 'convert cluster arc into a bracket ( { )'],
		92 : ['April 29, 2024', 'assure things fit in cluster, show cluster arc'],
		91 : ['April 23, 2024', 'fix hover, grab highlight, go, switching db'],
		90 : ['April 10, 2024', 'display related things clusters'],
		89 : ['March 28, 2024', 'display focus in clusters'],
		88 : ['March 26, 2024', 'resume support for Airtable'],
		87 : ['March 22, 2024', 'begin work on circle layout'],
		86 : ['March 10, 2024', 'vertical parent count dots inside drag dot'],
		85 : ['March 6, 2024', 'move tiny dots in crumbs to surround reveal dots'],
		84 : ['March 3, 2024', 'click title of thing to grab, tiny dots in crumbs'],
		83 : ['February 24, 2024', 'cluster go: hover and disable logic'],
		82 : ['February 16, 2024', 'add zoom in/out buttons for mobile'],
		81 : ['February 15, 2024', 'new panel layout'],
		80 : ['February 13, 2024', 'dynamic ancestries for child and parent all seemingly working'],
		79 : ['February 2, 2024', 'working on relations'],
		78 : ['January 29, 2024', 'added two new go to go cluster'],
		77 : ['January 27, 2024', 'go cluster is now an overlay hiding title and reveal dot'],
		76 : ['January 25, 2024', 'relocate focus title in graph (default with url query alternative)'],
		75 : ['January 23, 2024', 'switched ancestry ids from things to relationships'],
		74 : ['January 20, 2024', 'fixed most remaining ancestry design bugs'],
		73 : ['January 13, 2024', 'ancestries mostly working'],
		72 : ['January 11, 2024', 'ancestry based design'],
		71 : ['January 7, 2024', 'try to stop using thing ids for grab, focus, etc.'],
		70 : ['December 24, 2023', 'center graph'],
		69 : ['December 21, 2023', 'remount graph on relocate and hide/show children'],
		68 : ['December 17, 2023', 'relayout on title edit keystrokes'],
		67 : ['December 15, 2023', 'add div and origin to all components, position: absolute'],
		66 : ['November 28, 2023', 'configuration netlify content security profile'],
		65 : ['November 27, 2023', 'size slider'],
		64 : ['November 24, 2023', 'perfect scrolling'],
		63 : ['November 20, 2023', 'add select notification'],
		62 : ['November 13, 2023', 'cluster dot tweaks'],
		61 : ['November 13, 2023', 'lots of cosmetic cleanups & added query string'],
		60 : ['November 12, 2023', 'massive cosmetic tweaks'],
		59 : ['November 9, 2023', 'added ip logging'],
		58 : ['November 3, 2023', 'begin work on reveal cluster'],
		57 : ['October 31, 2023', 'separate bulk collections'],
		56 : ['October 27, 2023', 'fat triangle for all reveal dots'],
		55 : ['October 25, 2023', 'double-click drag dot applies focus'],
		54 : ['October 21, 2023', 'restore details at left'],
		53 : ['October 20, 2023', 'fix add child bugs'],
		52 : ['October 13, 2023', 'new bulks correctly created'],
		51 : ['October 12, 2023', 'new admin view of all data'],
		50 : ['October 10, 2023', 'eliminate details view, show focus title at top'],
		49 : ['October 10, 2023', 'create private firebase bulks as needed'],
		48 : ['October 9, 2023', 'private firebase bulks'],
		47 : ['October 9, 2023', 'two netlify query string'],
		46 : ['October 8, 2023', 'perfect editing and browsing'],
		45 : ['October 7, 2023', 'children origins are perfect'],
		44 : ['October 5, 2023', 'scrolling works'],
		43 : ['October 3, 2023', 'fetch Catalist data, HAH!'],
		41 : ['October 3, 2023', 'almost perfectly laid out graph'],
		40 : ['September 26, 2023', 'lines use children height'],
		39 : ['September 19, 2023', 'highlight grabbed root, eliminate line clipping'],
		38 : ['September 18, 2023', 'add fat triangle for focus, click it to go left'],
		37 : ['September 16, 2023', 'position widgets correctly at ends of curves'],
		36 : ['September 12, 2023', 'draw curves, switch public to show them'],
		35 : ['September 8, 2023', 'begin work on bubble plugin and svg'],
		34 : ['September 3, 2023', 'crumbs update on db switch'],
		33 : ['September 2, 2023', 'separate hierarchy for each db'],
		32 : ['August 31, 2023', 'manage order changes in snapshots'],
		31 : ['August 30, 2023', 'add child, duplicate and delete'],
		30 : ['August 26, 2023', 'clean construction of relationships'],
		29 : ['August 22, 2023', 'synchronize relocated things'],
		28 : ['August 21, 2023', 'synchronize title edits'],
		27 : ['August 20, 2023', 'firebase relationships'],
		26 : ['August 17, 2023', 'cloud abstraction layer'],
		25 : ['August 15, 2023', 'switch between db T_Signal'],
		24 : ['August 15, 2023', 'bulk for private/public, shared predicates'],
		23 : ['August 14, 2023', 'synchronization works, a goal 8 years long'],
		22 : ['August 13, 2023', 'locally persist db type'],
		21 : ['August 13, 2023', 'select db type'],
		20 : ['August 13, 2023', 'firebase private databases'],
		17 : ['August 12, 2023', 'better help'],
		12 : ['August 10, 2023', 'relocate things'],
		11 : ['August 8, 2023', 'display build number'],
		10 : ['August 2, 2023', 'refactor Panel into Startup'],
	}
	build_number: string = Object.keys(this.notes).slice(-1)[0];		// needed for builds button. grab the keys, then grab the last of them

}

export const builds = new Builds();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/common/Constants.ts
```ts
import { Size, Point } from '../types/Coordinates';

const dot_size = 14;
const row_height = 16;
const rubberband_thickness = 1;
const tiny_outer_dots_expansion = 6;
const tiny_outer_dots_diameter = dot_size + tiny_outer_dots_expansion;

export default class Constants {

	details_margin = 0;
	halfIncrement = 0.5;
	separator_title_left = 0;
	hid_unknown = 1000000000000;
	radial_widget_inset = dot_size + 14;
	printer_aspect_ratio = 11.69 / 8.27;
	prevent_selection_style = '-webkit-user-select: none; user-select: none; -moz-user-select: none';
	nothing_to_show = 'Please select something to show here';
	name_bulkAdmin = 'Jonathan Sand';
	cursor_default = 'default';
	corrupted = 'corrupted';
	unknown = 'unknown';
	root = 'root';
	empty_id = '""';
	newLine = '\n';
	wildcard = '*';
	comma = ',';
	quote = '"';
	space = ' ';
	empty = '';
	tab = '\t';

	dasharray = {
		relateds: '4,3',
		editing:  '3,2',
	};

	width = {
		details:  219,
		child_gap: 20,
	};

	help_url = {
		local:  'http://localhost:8000/README.html',
		remote: 'https://help.webseriously.org',
	};

	title = {
		default: 'Please, enter a title',
		line:	 '------------------------',
	};

	ratio = {
		zoom_out: 0.9,
		zoom_in:  1.1
	};

	separator = {
		generic: '::',
		small:	 ':::',
		big:	 '::::',
	};

	threshold = {
		autorepeat:	  150,
		double_click: 400,
		alteration:	  500,
		long_click:	  800,
	};
	
	tiny_outer_dots = {
		diameter:	tiny_outer_dots_diameter,
		expansion:	tiny_outer_dots_expansion,
		size:		Size.square(tiny_outer_dots_diameter),
		offset:		Point.square(-tiny_outer_dots_expansion).offsetByXY(4.2, 5),
		viewBox:	`0.5 2.35 ${tiny_outer_dots_diameter} ${tiny_outer_dots_diameter}`,	
	};

	radius = {
		text_area_border:  7,
		arcSlider_cap: 	   7.5,
		ring_minimum:  	  55,
		fillets: { 
			thick:	   	  14,
			thin:		   8,
			ultra_thin:	   5,
		},
	};

	height = {
		separator: 7,
		empty:	   22,
		line:	   row_height + 2,
		segmented: row_height + 1,
		row:	   row_height,
		controls:  16,
		button:	   dot_size + 3,
		dot:	   dot_size,
	};

	font_size = {
		cluster_slider: dot_size - 5,
		instructions:   dot_size - 4,
		separator:	    dot_size - 4,
		details:	    dot_size - 3,
		banners:	    dot_size - 2,
		info:		    dot_size - 1,
		common:		    dot_size,
		segmented:	    dot_size + 1,
		warning:	    dot_size + 2,
		tree_prefs:	    36,
	};

	thickness = {
		stroke:		 0.7,
		rubberband:	 rubberband_thickness,
		radial: {
			ring:	 44,
			arc:	 15,
			fork:	 2.5,
		},
		separator: {
			main:	 5,
			banners: 2.5,
			details: 0.75,
		},
	};

	opacity = {
		none:		  0,
		faint:		  0.1,
		light:		  0.2,
		medium:		  0.4,
		dark:		  0.7,
		cluster: {
			faint:	  0.02,
			armature: 0.1,
			thumb:	  0.1,
			hover:	  0.7,
			titles:	  1,
			active:	  0.3,
		},
	};
}

export const k = new Constants();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/common/Enumerations.ts
```ts
// DO NOT change the order of the following

export enum T_Order {	// need two orders, so .... ???
	child,
	other,
}

export enum T_Banner {
	controls,
	graph,
	crumbs,
}

export enum T_Startup {
	start,
	fetch,
	empty,
	ready,
}

export enum T_Search {
	off,
	enter,
	results,
	selected,
}

export enum T_Detail {
	header,
	actions,
	selection,
	tags,
	traits,
	preferences,
	data,
}

export enum T_Action {
	browse,
	focus,
	show,
	center,
	add,
	delete,
	move,
}

export enum T_Layer {
	common,
	graph,
	paging,
	ring,
	necklace,
	line,
	widget,
	dot,
	text,
	details,
	stackable,
	action,
	hideable,
	rubberband,
	frontmost,
}

// the order of the following is NOT important

export enum T_Graph {
	radial = 'radial',
	tree   = 'tree',
}

export enum T_Direction {
	previous = '<',
	next	 = '>',
}

export enum T_Alteration {
	delete = 'delete',
	add	   = 'add',
}

export enum T_File_Operation {
	import = 'import',	// persist
	export = 'export',	// fetch
}

export enum T_Theme {
	standalone = 'standalone',
	bubble	   = 'bubble',
}

export enum T_Counts_Shown {
	numbers = 'numbers',
	hidden  = 'hidden',
	dots    = 'dots',
}

export enum T_Auto_Adjust_Graph {
	selection = 'center the selection',
	fit		  = 'exactly fit',
	ignore	  = 'ignore',
}

export enum T_Button_SVG {
	triangle = 'triangle',
	arrow = 'arrow',
	none = 'none',
}

export enum T_Search_Preference {
	title = 'title',
	trait = 'trait',
	tags  = 'tags',
}

export enum T_Widget {
	radial = 'radial',
	focus  = 'focus',
	tree   = 'tree',
}

export enum T_Tree_Line {
	flat = 'flat',
	down = 'down',
	up	 = 'up',
}

export enum T_Create {
	isFromPersistent = 'isFrom',
	getPersistentID	 = 'getID',
	none			 = '',
}

export enum T_Storage_Need {
	direction = 'direction',
	format	  = 'format',
	busy	  = 'busy',
}

export enum T_Persistence {
	remote = 'remote',
	local  = 'local',
	none   = 'none',
}

export enum T_Kinship {
	children = 'children',
	related  = 'related',
	parents  = 'parents',
}

export enum T_Drag {
	rubberband = 'rubberband',	// selecting widgets
	widget	   = 'widget',		// drag and drop
	graph	   = 'graph',		// repositioning the graph
	none	   = 'none',
}

export enum T_Radial_Zone {
	resize = 'resize',
	paging = 'paging',
	rotate = 'rotate',
	miss   = 'miss',
}

export enum T_Oblong {
	middle = 'middle',
	right  = 'right',
	left   = 'left',
	full   = 'full',
}

export enum T_Mouse_Detection {
	autorepeat = 4,
	doubleLong = 3,
	double	   = 1,
	long	   = 2,
	none	   = 0,
}

export enum T_Request {
	handle_s_mouse = 'handle_s_mouse',
	is_disabled	   = 'is_disabled',
	is_inverted	   = 'is_inverted',
	is_visible	   = 'is_visible',
	is_hit		   = 'is_hit',
	name		   = 'name',
}

export enum T_Signal {
	alteration	 = 'alteration',
	reposition	 = 'reposition',	// only for widgets
	reattach	 = 'reattach',
	rebuild		 = 'rebuild',
	thing		 = 'thing',
}

export enum T_Persistable {
	relationships = 'Relationships',
	predicates	  = 'Predicates',
	things		  = 'Things',
	traits		  = 'Traits',
	access		  = 'Access',
	users		  = 'Users',
	tags		  = 'Tags',
}

export enum T_Predicate {
	appreciates = 'appreciates',
	explainedBy	= 'explainedBy',
	supportedBy	= 'supportedBy',
	alliedWith	= 'alliedWith',		// steve melville's term
	isRelated	= 'isRelated',
	contains	= 'contains',
	isTagged	= 'isTagged',		// trying this out...
	requires	= 'requires',
}

export enum T_Control {
	details	 = 'show details view',
	builds	 = 'show build notes',
	preview	 = 'preview',
	recents	 = 'recents',
	import	 = 'import',
	search	 = 'search',
	shrink	 = 'shrink',
	grow	 = 'grow',
	help	 = '?',
}

export enum T_Browser  {
	explorer = 'explorer',
	unknown  = 'unknown',
	firefox	 = 'firefox',
	chrome	 = 'chrome',
	safari	 = 'safari',
	opera	 = 'opera',
	orion	 = 'orion',
}

export enum T_File_Extension {
	seriously = 'seriously',
	cancel	  = 'cancel',
	json	  = 'json',
	csv		  = 'csv',
}

export enum T_Image_Extension {
	jpeg   = 'jpeg',
	webp   = 'webp',
	jpg    = 'jpg',
	gif    = 'gif',
	png    = 'png',
	svg    = 'svg',
}

export enum T_Text_Extension {
	svelte = 'svelte',
	html   = 'html',
	json   = 'json',
	css    = 'css',
	csv    = 'csv',
	txt    = 'txt',
	js     = 'js',
	md     = 'md',
	sh     = 'sh',
	ts     = 'ts',
}

export enum T_Thing {
	organization = 'o',
	externals	 = '^',	// list of bulks
	bookmark	 = 'b',
	generic		 = '-',
	person		 = 'p',
	folder		 = 'f',
	found		 = '?',
	root		 = '!',
	bulk		 = '~',
	meme		 = '*',
}

export enum T_Trait {
	consequence = 'consequence',
	location	= 'location',
	citation	= 'citation',
	comment		= 'comment',
	money		= 'money',
	phone		= 'phone',
	quest		= 'quest',
	text		= 'text',
	date		= 'date',
	link		= 'link',
	note		= 'note',
	sum			= 'sum',
}

export enum T_Hit_Target {
	breadcrumbs	= 'breadcrumbs',
	rubberband	= 'rubberband',
	database	= 'database',
	resizing	= 'resizing',
	rotation	= 'rotation',
	details		= 'details',
	control		= 'control',
	action		= 'action',
	button		= 'button',
	cancel		= 'cancel',
	paging		= 'paging',
	reveal		= 'reveal',
	search		= 'search',
	widget		= 'widget',
	title		= 'title',
	trait		= 'trait',
	drag		= 'drag',
	glow		= 'glow',
	line		= 'line',
	none		= 'none',
	tag			= 'tag',
}

export enum T_Preference {
	expanded_children = 'expanded_children',
	focus_forChildren = 'focus_forChildren',
	expanded_parents  = 'expanded_parents',
	focus_forParents  = 'focus_forParents',
	other_databases	  = 'other_databases',
	cluster_sliders	  = 'cluster_sliders',
	show_countsAs	  = 'show_countsAs',
	relationships	  = 'relationships',
	detail_types	  = 'detail_types',			// shown in details view, vertical stack
	show_details	  = 'show_details',			// left side
	show_related	  = 'show_related',
	ring_radius		  = 'ring_radius',
	user_offset		  = 'user_offset',
	auto_adjust		  = 'auto_adjust',
	search_text		  = 'search_text',
	background		  = 'background',
	ring_angle  	  = 'ring_angle',
	auto_save		  = 'auto_save',
	countDots		  = 'countDots',
	font_size		  = 'font_size',
	separator		  = 'separator',
	base_id			  = 'base_id',
	details			  = 'details',				// visible details control
	recents			  = 'recents',
	bubble 			  = 'bubble',
	levels			  = 'levels',
	paging 			  = 'paging',
	search 			  = 'search',
	traits			  = 'traits',
	graph			  = 'graph',
	scale			  = 'scale',
	local			  = 'local',
	thing	    	  = 'thing',
	font			  = 'font',
	tree			  = 'tree',
	db				  = 'db',
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/common/Global_Imports.ts
```ts
import G_Cluster_Pager from '../geometry/G_Cluster_Pager';
import G_TreeBranches from '../geometry/G_TreeBranches';
import G_RadialGraph from '../geometry/G_RadialGraph';
import G_Repeater from '../geometry/G_Repeater';
import G_TreeLine from '../geometry/G_TreeLine';
import G_Cluster from '../geometry/G_Cluster';
import G_Widget from '../geometry/G_Widget';

import S_Alteration from '../state/S_Alteration';
import S_Title_Edit from '../state/S_Title_Edit';
import S_Hit_Target from '../state/S_Hit_Target';
import S_Component from '../state/S_Component';
import S_Resizing from '../state/S_Resizing';
import S_Rotation from '../state/S_Rotation';
import S_Snapshot from '../state/S_Snapshot';
import S_Element from '../state/S_Element';
import S_Widget from '../state/S_Widget';
import S_Mouse from '../state/S_Mouse';
import S_Items from '../state/S_Items';

import Relationship from '../persistable/Relationship';
import Persistable from '../persistable/Persistable';
import Predicate from '../persistable/Predicate';
import Mouse_Timer from '../signals/Mouse_Timer';
import Ancestry from '../runtime/Ancestry';
import Access from '../persistable/Access';
import Thing from '../persistable/Thing';
import Trait from '../persistable/Trait';
import User from '../persistable/User';
import Tag from '../persistable/Tag';
import Angle from '../types/Angle';

import { T_Debug } from '../debug/Debug';
import { T_Edit } from '../state/S_Title_Edit';
import { T_Timer } from '../signals/Mouse_Timer';
import { T_Theme, T_Button_SVG } from './Enumerations';
import { T_Oblong, T_Direction } from './Enumerations';
import { T_Quadrant, T_Orientation } from '../types/Angle';
import { T_Persistable, T_Persistence } from './Enumerations';
import { T_Graph, T_Banner, T_Control } from './Enumerations';
import { T_Search, T_Search_Preference } from './Enumerations';
import { T_Create, T_Browser, T_Alteration } from './Enumerations';
import { T_Image_Extension, T_Text_Extension } from './Enumerations';
import { T_Tree_Line, T_Order, T_Widget, T_Layer } from './Enumerations';
import { T_Thing, T_Trait, T_Kinship, T_Predicate } from './Enumerations';
import { T_Signal, T_Hit_Target, T_Mouse_Detection } from './Enumerations';
import { T_Action, T_Detail, T_Request, T_Storage_Need } from './Enumerations';
import { T_Drag, T_File_Extension, T_File_Operation, T_Startup } from './Enumerations';
import { T_Radial_Zone, T_Preference, T_Auto_Adjust_Graph, T_Counts_Shown } from './Enumerations';

import './Extensions';
import { k } from './Constants';
import { x } from '../managers/UX';
import { e } from '../signals/Events';
import { core } from '../managers/Core';
import { g } from '../managers/Geometry';
import { h } from '../managers/Hierarchy';
import { u } from '../utilities/Utilities';
import { p } from '../managers/Preferences';
import { c } from '../managers/Configuration';
import { features } from '../managers/Features';

import { builds } from './Builds';
import { busy } from '../state/S_Busy';
import { files } from '../files/Files';
import { hits } from '../managers/Hits';
import { print } from '../utilities/Print';
import { search } from '../managers/Search';
import { radial } from '../managers/Radial';
import { signals } from '../signals/Signals';
import { colors } from '../utilities/Colors';
import { details } from '../managers/Details';
import { show } from '../managers/Visibility';
import { controls } from '../managers/Controls';
import { elements } from '../managers/Elements';
import { databases } from '../database/Databases';
import { svgPaths } from '../utilities/SVG_Paths';
import { components } from '../managers/Components';
import { g_graph_tree } from '../geometry/G_TreeGraph';
import { g_graph_radial } from '../geometry/G_RadialGraph';

import { Direction } from '../types/Angle';
import { debug, Debug } from '../debug/Debug';
import { ErrorTrace } from '../debug/ErrorTrace';
import { Hierarchy } from '../managers/Hierarchy';
import { Rect, Size, Point } from '../types/Coordinates';
import { Seriously_Range } from '../types/Seriously_Range';

import { transparentize } from 'color2k';
import interact from 'interactjs';

export {	
	S_Rotation, S_Resizing, S_Component,
	S_Hit_Target, S_Alteration, S_Title_Edit,
	S_Items, S_Mouse, S_Widget, S_Element, S_Snapshot,
	
	G_Cluster, G_RadialGraph, G_Cluster_Pager,
	G_Widget, G_TreeLine, G_TreeBranches, G_Repeater,

	core, features,
	e, c, g, h, k, p, u, x,
	colors, radial, signals,
	interact, transparentize,
	search, details, controls,
	debug, svgPaths, databases,
	hits, elements, components,
	g_graph_tree, g_graph_radial,
	busy, show, files, builds, print,

	Angle, Direction, 
	Rect, Size, Point,
	User, Access, Persistable,
	Debug, ErrorTrace, Mouse_Timer,
	Ancestry, Hierarchy, Seriously_Range,
	Tag, Thing, Trait, Predicate, Relationship,
	
	T_Debug, T_Timer,
	T_Order, T_Kinship,
	T_Theme, T_Graph, T_Browser, 
	T_Search, T_Search_Preference,
	T_Startup, T_Drag, T_Alteration,
	T_Image_Extension, T_Text_Extension,
	T_Auto_Adjust_Graph, T_Counts_Shown,
	T_Quadrant, T_Orientation, T_Direction,
	T_Layer, T_Tree_Line, T_Radial_Zone, T_Oblong,
	T_Edit, T_Create, T_Persistable, T_Persistence,
	T_File_Extension, T_File_Operation, T_Storage_Need,
	T_Signal, T_Control, T_Hit_Target, T_Mouse_Detection,
	T_Banner, T_Detail, T_Request, T_Action, T_Button_SVG,
	T_Thing, T_Trait, T_Widget, T_Predicate, T_Preference,
};
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Tag.ts
```ts
import { h, k, Thing, databases, T_Persistable } from '../common/Global_Imports';
import type { Integer } from '../types/Types';
import Persistable from './Persistable';

export default class Tag extends Persistable {
	thingHIDs: Array<Integer> = [];
	type: string = '';
	
	constructor(idBase: string, id: string, type: string, thingHIDs: Array<Integer>, already_persisted: boolean = false) {
		super(databases.db_now.t_database, idBase, T_Persistable.tags, id, already_persisted);
		this.thingHIDs = thingHIDs;
		this.type = type;
	}

	get things(): Array<Thing> {
		return this.thingHIDs.map(hid => h.thing_forHID(hid)).filter(thing => !!thing) as Array<Thing>;
	}

	ownerAt(index: number): Thing | null {
		const things = this.things;
		if (index < things.length) {
			return things[index];
		}
		return null;
	}

	async persistent_create_orUpdate(already_persisted: boolean) {
		if (already_persisted) {
			await databases.db_now.tag_persistentUpdate(this);
		} else {
			await databases.db_now.tag_remember_persistentCreate(this);
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Persistable.ts
```ts
import { T_Persistable } from '../common/Enumerations';
import S_Persistence from '../state/S_Persistence';
import Identifiable from '../runtime/Identifiable';
import { debug, T_Debug } from '../debug/Debug';
import { h } from '../managers/Hierarchy';
import { k } from '../common/Constants';
import { busy } from '../state/S_Busy';

export default class Persistable extends Identifiable {
	t_persistable: T_Persistable;
	persistence!: S_Persistence;
	idBase: string;

	constructor(t_database: string, idBase: string, t_persistable: T_Persistable, id: string, already_persisted: boolean = false) {
		super(id);
		this.persistence = new S_Persistence(t_database, t_persistable, id, already_persisted, false);
		this.t_persistable = t_persistable;
		this.idBase = idBase;
	}

	async persistent_create_orUpdate(already_persisted: boolean) {}
	log(option: T_Debug, message: string) { debug.log_maybe(option, message); }
	isInDifferentBulkThan(other: Persistable) { return this.idBase != other.idBase; }

	set_isDirty(flag: boolean = true) {
		if (!busy.isFetching || h?.db.isPersistent) {
			this.persistence.isDirty = flag;
			busy.signal_data_redraw();
		}
	}

	async persist() {
		await this.persistence.persist_withClosure(async (already_persisted: boolean) => {
			await this.persistent_create_orUpdate(already_persisted);
		});
	}

	static get t_persistables(): Array<T_Persistable> {
		return [T_Persistable.things,
			T_Persistable.traits,
			T_Persistable.predicates,
			T_Persistable.relationships,
			T_Persistable.tags]; }

	static dirty_count(persistables: Array<Persistable> ): number {
		return persistables.filter(p => p.persistence.isDirty).length;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Thing.ts
```ts
import { e, h, k, u, x, debug, colors, S_Items, databases, Seriously_Range } from '../common/Global_Imports';
import { Tag, Trait, Ancestry, Predicate, Persistable, Relationship } from '../common/Global_Imports';
import { T_Thing, T_Trait, T_Debug, T_Predicate, T_Persistable } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import { get } from 'svelte/store';

export default class Thing extends Persistable {
	selectionRange = new Seriously_Range(0, 0);
	bulkRootID: string = k.empty;
	t_thing: T_Thing;
	title: string;
	color: string;

	constructor(idBase: string, id: string, title = k.title.default, color = colors.default_forThings, t_thing = T_Thing.generic, already_persisted: boolean = false) {
		super(databases.db_now.t_database, idBase, T_Persistable.things, id, already_persisted);
		this.selectionRange = new Seriously_Range(0, title.length);
		this.t_thing = t_thing;
		this.title = title;
		this.color = color;
	};
	
	get si_tags():				S_Items		   <Tag> { return h.si_tags_forThingHID(this.hid); }
	get si_traits():	 null | S_Items		 <Trait> { return h.si_traits_forOwnerHID(this.hid); }
	get si_ancestries(): null | S_Items   <Ancestry> { return h.si_ancesties_forThingHID(this.hid); }
	get parents():				Array		 <Thing> { return this.parents_ofKind(T_Predicate.contains); }
	get parentIDs():			Array		<string> { return this.parents.map(t => t.id); }
	get ancestries():		 	Array	  <Ancestry> { return this.si_ancestries?.items ?? []; }
	get childRelationships():	Array <Relationship> { return h.relationships_ofKind_forParents_ofThing(T_Predicate.contains, false, this); }
	get relatedRelationships(): Array <Relationship> { return h.relationships_ofKind_forParents_ofThing(T_Predicate.isRelated, false, this); }
	get fields():		  		Dictionary  <string> { return { title: this.title, color: this.color, type: this.t_thing }; }
	get abbreviated_title():				  string { return this.title.split(' ').map(word => word[0]).join(k.empty).toLowerCase(); }
	get idBridging():						  string { return this.isBulkAlias ? this.bulkRootID : this.id; }
	get description():						  string { return this.id + ' "' + this.title + k.quote; }
	get breadcrumb_title():					  string { return this.title.clipWithEllipsisAt(15); }
	get width_ofTitle():					  number { return u.getWidthOf(this.title); }
	get isRoot():							 boolean { return this.t_thing == T_Thing.root; }
	get isFolder():							 boolean { return this.t_thing == T_Thing.folder; }
	get isBookmark():						 boolean { return this.t_thing == T_Thing.bookmark; }
	get isBulkAlias():						 boolean { return this.t_thing == T_Thing.bulk; }
	get isExternals():						 boolean { return this.t_thing == T_Thing.externals; }
	get hasRelated():						 boolean { return this.relatedRelationships.length > 0; }
	get isAcrossBulk():						 boolean { return this.idBase != h.db.idBase; }
	get hasParents():						 boolean { return this.hasParents_ofKind(T_Predicate.contains); }
	get isFocus():							 boolean { return (get(x.w_ancestry_focus)?.thing?.id ?? k.empty) == this.id; }
	
	get parents_ofAllKinds(): Array<Thing> {
		let parents: Array<Thing> = [];
		for (const predicate of h.predicates) {
			const more = this.parents_ofKind(predicate.kind)
			parents = u.uniquely_concatenateArrays_ofIdentifiables(parents, more) as Array<Thing>;
		}
		return parents;
	}

	get thing_isBulk_expanded(): boolean {		// cross db ancestries needs special attention
		if (this.isBulkAlias) {
			const ancestries = x.si_expanded.items;
			if (!!ancestries) {
				for (const ancestry of ancestries) {
					if (this.id == ancestry.thing?.id) {
						return true;
					}
				}
			}
		}
		return false;
	}

	debugLog(message: string) { this.log(T_Debug.things, message); }
	trait_forType(type: T_Trait) { return this.si_traits?.item as Trait; }
	hasParents_ofKind(kind: string): boolean { return this.parents_ofKind(kind).length > 0; }
	hasMultipleParents_ofKind(kind: string): boolean { return this.parents_ofKind(kind).length > 1; }
	log(option: T_Debug, message: string) { debug.log_maybe(option, message + k.space + this.description); }

	override isInDifferentBulkThan(other: Thing): boolean {
		return super.isInDifferentBulkThan(other) || (other.isBulkAlias && !this.isBulkAlias && this.idBase != other.title);
	}

	signal_color_change() {
		e.w_count_rebuild.update(n => n + 1);
		colors.w_thing_color.set(`${this.id}${k.separator.generic}${get(e.w_count_rebuild)}`);
	}

	async persistent_create_orUpdate(already_persisted: boolean) {
		if (already_persisted) {
			await databases.db_now.thing_persistentUpdate(this);
		} else {
			await databases.db_now.thing_remember_persistentCreate(this);
		}
	}

	crumbWidth(numberOfParents: number): number {
		const forNone = this.width_ofTitle + 10;
		switch (numberOfParents) {
			case 0:	 return forNone;
			case 1:	 return forNone + 11;
			default: return forNone + 18;
		}
	}

	remove_fromGrabbed_andExpanded_andResolveFocus() {
		// called when this (thing) is being deleted
		for (const ancestry of this.ancestries) {		// DO NOT REMOVE ANCESTRIES ???
			if (ancestry.id_thing == this.id) {
				ancestry.remove_fromGrabbed_andExpanded();
			}
		}
		const focus = get(x.w_ancestry_focus);
		if (focus?.thing?.hid == this.hid) {
			h.rootAncestry.becomeFocus();
		}
	}

	parents_ofKind(kind: string): Array<Thing> {
		let parents: Array<Thing> = [];
		if (!this.isRoot) {
			const relationships = h.relationships_ofKind_forParents_ofThing(kind, true, this);
			for (const relationship of relationships) {
				const thing = relationship.parent;
				if (!!thing) {
					parents.push(thing);
				}
			}
		}
		return parents;
	}

	static readonly _____ANCESTRIES: unique symbol;

	get ancestry(): Ancestry { return this.ancestries[0] ?? h.rootAncestry; }

	get ancestry_maybe(): Ancestry | null {
		const ancestries = h.ancestries_forThing(this);
		return ancestries.length > 0 ? ancestries[0] : null;
	}

	ancestries_createUnique_forPredicate(predicate: Predicate | null): Array<Ancestry> {
		let ancestries: Array<Ancestry> = [];
		if (!!predicate){
			if (predicate.isBidirectional) {
				ancestries = h.ancestries_create_forThing_andPredicate(this, predicate);
			} else {
				let parents = this.parents_ofKind(predicate.kind) ?? [];
				for (const parent of parents) {
					const parentAncestries = parent.isRoot ? [h.rootAncestry] : h.ancestries_create_forThing_andPredicate(parent, predicate);
					ancestries = u.concatenateArrays(ancestries, parentAncestries);
				}
			}
			ancestries = u.strip_thingDuplicates_from(u.strip_falsies(ancestries));
		}
		return ancestries;
	}
	
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Predicate.ts
```ts
import { h, k, debug, radial, T_Debug, databases, Persistable } from '../common/Global_Imports';
import { T_Kinship, T_Predicate, T_Persistable } from '../common/Global_Imports';
import { get } from 'svelte/store';

export default class Predicate extends Persistable {
	isBidirectional: boolean;
	kind: T_Predicate;

	constructor(id: string, kind: T_Predicate, isBidirectional: boolean, already_persisted: boolean = false) {
		super(databases.db_now.t_database, k.empty, T_Persistable.predicates, id, already_persisted);
		this.isBidirectional = isBidirectional;
		this.kind			 = kind;
	}
	
	log(option: T_Debug, message: string)					 { debug.log_maybe(option, message + k.space + this.description); }
	get description():					  			  string { return this.kind.unCamelCase().lastWord(); }
	static isBidirectional_for(kind: T_Predicate):	 boolean { return kind != T_Predicate.contains; }
	static get contains():				    Predicate | null { return this.predicate_forKind(T_Predicate.contains); }
	static get isTagged():					Predicate | null { return this.predicate_forKind(T_Predicate.isTagged); }
	static get requires():				    Predicate | null { return this.predicate_forKind(T_Predicate.requires); }
	static get isRelated():				    Predicate | null { return this.predicate_forKind(T_Predicate.isRelated); }
	static get alliedWith():				Predicate | null { return this.predicate_forKind(T_Predicate.alliedWith); }
	static get appreciates():			  	Predicate | null { return this.predicate_forKind(T_Predicate.appreciates); }
	static get explainedBy():				Predicate | null { return this.predicate_forKind(T_Predicate.explainedBy); }
	static get supportedBy():				Predicate | null { return this.predicate_forKind(T_Predicate.supportedBy); }
	static predicate_forKind(kind: string): Predicate | null { return h.predicate_forKind(kind) ?? null; }

	kinship_forChildren_cluster(isCluster_ofChildren: boolean): T_Kinship | null {
		switch (this.kind) {
			case T_Predicate.contains:	return isCluster_ofChildren ? T_Kinship.children : T_Kinship.parents;
			case T_Predicate.isRelated:	return T_Kinship.related;
			default:					return null;
		}
	}

	async persistent_create_orUpdate(already_persisted: boolean) {
		if (already_persisted) {
			await databases.db_now.predicate_persistentUpdate(this);
		} else {
			await databases.db_now.predicate_remember_persistentCreate(this);
		}
	}
	
	angle_ofCluster_when(isCluster_ofChildren: boolean): number {
		// returns one of three angles: 1) children_angle 2) opposite+tweak 3) opposite-tweak
		const tweak = 2 * Math.PI / 3;					// equilateral distribution
		const children_angle = get(radial.w_rotate_angle);
		const raw = this.isBidirectional ?
			children_angle + tweak :
			isCluster_ofChildren ? children_angle :		// one directional, use global
			children_angle - tweak;
		return raw.angle_normalized() ?? 0;
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Trait.ts
```ts
import { k, Thing, databases, T_Trait, h } from '../common/Global_Imports';
import { Persistable, T_Persistable } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import Airtable from 'airtable';

export default class Trait extends Persistable {
	t_trait: T_Trait = T_Trait.text;
	ownerID: string = k.empty;
	text: string = k.empty;
	dict: Dictionary = {};	// need this for pivot data import

	constructor(idBase: string, id: string, ownerID: string, t_trait: T_Trait, text: string = k.empty, already_persisted: boolean = false) {
		super(databases.db_now.t_database, idBase, T_Persistable.traits, id, already_persisted);
		this.ownerID = ownerID;
		this.t_trait = t_trait;
		this.text = text;
	}

	get owner():	   Thing | null { return h.thing_forHID(this.ownerID.hash()); }
	get fields(): Airtable.FieldSet { return { type: this.t_trait, ownerID: [this.ownerID], text: this.text }; }

	async persistent_create_orUpdate(already_persisted: boolean) {
		if (already_persisted) {
			await databases.db_now.trait_persistentUpdate(this);
		} else {
			await databases.db_now.trait_remember_persistentCreate(this);
		}
	}
	
	static type_fromSeriously(type: string): T_Trait {
		switch (type) {
			case 'n': return T_Trait.note;
			case 'd': return T_Trait.date;
			case 'h': return T_Trait.link;
			case 'c': return T_Trait.citation;
			case '$': return T_Trait.money;
			case '#': return T_Trait.phone;
		}
		return T_Trait.text;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Access.ts
```ts
import { Persistable, T_Persistable } from '../common/Global_Imports';

export default class Access extends Persistable {
	kind: string;

	constructor(t_database: string, t_persistable: T_Persistable, id: string, kind: string, already_persisted: boolean = false) {
		super(t_database, '', t_persistable, id, already_persisted);
		this.kind = kind;
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/Relationship.ts
```ts
import { h, k, x, Thing, T_Order, databases, Predicate } from '../common/Global_Imports';
import { T_Persistable, T_Predicate } from '../common/Global_Imports';
import Identifiable from '../runtime/Identifiable';
import type { Integer } from '../types/Types';
import Persistable from './Persistable';
import Airtable from 'airtable';

export default class Relationship extends Persistable {
	isReversed = false;
	hidParent: Integer;
	hidChild: Integer;
	kind: T_Predicate;
	idParent: string;
	idChild: string;
	orders = [0, 0];

	constructor(idBase: string, id: string, kind: T_Predicate, idParent: string, idChild: string, orders: Array<number>, already_persisted: boolean = false) {
		super(databases.db_now.t_database, idBase, T_Persistable.relationships, id, already_persisted);
		this.hidParent = idParent.hash();
		this.hidChild = idChild.hash();
		this.idParent = idParent;
		this.idChild = idChild;
		this.orders = orders;
		this.kind = kind;
	}

	get child(): Thing | null { return this.thing(true); }
	get parent(): Thing | null { return this.thing(false); }
	get predicate(): Predicate | null { return h.predicate_forKind(this.kind); }
	get isValid(): boolean { return !!this.kind && !!this.parent && !!this.child; }
	get fields(): Airtable.FieldSet { return { kind: this.kind, parent: [this.idParent], child: [this.idChild], orders: this.orders.map(String) }; }
	get reversed(): Relationship | null { return h?.relationship_forPredicateKind_parent_child(this.kind, this.idChild.hash(), this.idParent.hash()) ?? null; }
	
	get verbose(): string {
		const persisted = this.persistence.already_persisted ? 'STORED' : 'DIRTY';
		return `BASE ${this.idBase} ${persisted} [${this.orders}] ${this.id} ${this.description}`;
	}

	get description(): string {
		const child = this.child ? this.child.description : this.idChild;
		const parent = this.parent ? this.parent.description : this.idParent;
		return `${parent} ${this.predicate?.kind} ${child}`;
	}

	get reversed_remember_createUnique(): Relationship {
		let reversed = this.reversed;
		if (!reversed) {
			reversed = new Relationship(this.idBase, Identifiable.id_inReverseOrder(this.id), this.kind, this.idChild, this.idParent, [...this.orders].reverse());
			reversed.isReversed = true;
			h.relationship_remember(reversed);
		}
		return reversed;
	}

	order_forPointsTo(isCluster_ofChildren: boolean): number {
		return isCluster_ofChildren ? this.orders[T_Order.child] : this.orders[T_Order.other];
	}

	remove_from(relationships: Array<Relationship>) {
		relationships.filter(t => t.kind != this.kind)
	}

	orders_setTo(newOrders: Array<number>) {
		this.order_setTo(newOrders[T_Order.child]);	// don't persist or signal, yet
		this.order_setTo(newOrders[T_Order.other], T_Order.other);
	}

	thing(child: boolean): Thing | null {
		const id = child ? this.idChild : this.idParent;
		return h.thing_forHID(id.hash()) ?? null
	}

	async persistent_create_orUpdate(already_persisted: boolean) {
		if (already_persisted) {
			await databases.db_now.relationship_persistentUpdate(this);
		} else {
			await databases.db_now.relationship_remember_persistentCreate(this);
		}
	}

	order_setTo_forPointsTo(order: number, toChildren: boolean = true) {
		const t_order = toChildren ? T_Order.child : T_Order.other;
		this.order_setTo(order, t_order);
	}

	order_setTo(newOrder: number, t_order: T_Order = T_Order.child) {
		const order = this.orders[t_order] ?? 0;
		const difference = Math.abs(order - newOrder);
		if (difference > 0.001) {
			this.orders[t_order] = newOrder;
			x.w_order_changed_at.set(Date.now());
			this.set_isDirty();
		}
	}

	assign_idParent(idParent: string) {
		h.relationship_forget(this);
		this.idParent = idParent;
		this.hidParent = idParent.hash();
		this.set_isDirty();
		h.relationship_remember(this);
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/persistable/User.ts
```ts
import { Persistable, T_Persistable } from '../common/Global_Imports';

export default class User extends Persistable {
	email: string;
	phone: string;
	name: string;

	constructor(t_database: string, t_persistable: T_Persistable, id: string, name: string, email: string, phone: string, already_persisted: boolean = false) {
		super(t_database, '', t_persistable, id, already_persisted);
		this.name = name;
		this.email = email;
		this.phone = phone;
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/files/Pivot.ts
```ts
import { h, k, Tag, Trait, T_Thing, T_Trait, T_Create, T_Predicate } from '../common/Global_Imports';
import Identifiable from '../runtime/Identifiable';
import type { Dictionary } from '../types/Types';
import '../common/Extensions';

class Pivot {

	extract_fromDict(dict: Dictionary) {
		// each dict represents a Thing, which has a title, name, description and parent 1 link
		// later, in create_relationships_fromAllTraits, above ...
		// ... create a Relationship for each trait that has a dict containing a parent 1 link
		// TODO: what is the parent 2 link?
		const idBase = h.db.idBase;
		const thing_id = Identifiable.newID();
		const t_thing = dict['Type'] == 'bookmark' ? T_Thing.bookmark : T_Thing.generic;
		const title = dict['Title'].removeWhiteSpace();					// TODO: for remote db we need the thing id from the server
		h.thing_remember_runtimeCreate(idBase, thing_id, title, 'blue', t_thing);		// create a Thing for each dict
		this.create_trait_forThingfromDict(thing_id, dict);
		this.create_tags_forThing_fromDict(thing_id, dict);
		if (['TEAM LIBRARY', 'MEMBER LIBRARY'].includes(title)) {		// these two things are roots in airtable, directly add them to our root
			h.relationship_remember_runtimeCreateUnique(idBase, Identifiable.newID(), T_Predicate.contains, h.root.id, thing_id, [0, 0]);
		}
	}
	
	static readonly _____TRAITS: unique symbol;

	create_trait_forThingfromDict(thing_id: string, dict: Dictionary): Trait {
		const isBookmark = dict['Type'] == 'bookmark' ? T_Thing.bookmark : T_Thing.generic;
		const text = (isBookmark ? dict['Link'] : dict['Description']) ?? k.unknown;
		const t_trait = isBookmark ? T_Trait.link : T_Trait.text;
		const trait = h.trait_remember_runtimeCreate(h.db.idBase, Identifiable.newID(), thing_id, t_trait, text);			// save dict in memory, but do not persist it
		trait.dict = dict;
		return trait;
	}
	
	static readonly _____TAGS: unique symbol;

	create_tags_forThing_fromDict(thingID: string, dict: Dictionary) {
		const keys = ['Custom Tags', 'Custom Tags (Local)', 'All Local Tags (folder names)'];
		for (const key of [...keys]) {
			this.create_tag_forThing_andKey_fromDict(thingID, dict[key]);
		}
	}

	create_tag_forThing_andKey_fromDict(thingID: string, tag_types: string): Tag | null {
		if (!!tag_types) {
			for (const tag_type of [...tag_types.split(k.comma)]) {
				const tag = h.tag_remember_runtimeCreateUnique_forType(h.db.idBase, Identifiable.newID(), tag_type.trim(), [thingID.hash()]);
				return tag;
			}
		}
		return null;
	}
	
	static readonly _____RELATIONSHIPS: unique symbol;

	async create_relationships_fromAllTraits() {
		// for each trait that has a dict containing a parent <x> link
		for (const trait of [...h.traits]) {
			for (const key of ['parent 1 link']) {
				await this.create_relationship_fromTrait(trait, key);
			}
			trait.dict = {};			// not save dict, too big. was: this.shrink_dict(dict);
		}
		while (this.assure_small_families()) {}			// repeat until no changes
		// await this.cleanup_lost_and_found();  // Make sure we await this
	}

	private async create_relationship_fromTrait(trait: Trait, key: string) {
		const parent_title = trait.dict[key]?.removeWhiteSpace();
		if (!!parent_title) {
			;
			const parents = h.things_forTitle(parent_title);
			const parent = parents?.[0] ?? await h.lost_and_found();
			if (!!parent) {
				h.relationship_remember_runtimeCreateUnique(h.db.idBase, Identifiable.newID(), T_Predicate.contains, parent.id, trait.ownerID, [0, 0]);
			}
		}
	}
	
	static readonly _____CHUNKING: unique symbol;

	private assure_small_families(): boolean {
		let changed = false;
		const max_children = 35;
		;
		const rootAncestry = h.rootAncestry;
		rootAncestry.traverse((ancestry) => {
			const ancestry_title = ancestry.abbreviated_title;
			const ancestry_thing_id = ancestry.thing?.id;
			const child_ancestries = ancestry.childAncestries;
			if (!!ancestry_thing_id && child_ancestries.length > max_children) {
				changed = true;
				const chunks = [];
				for (let i = 0; i < child_ancestries.length; i += max_children) {
					chunks.push(child_ancestries.slice(i, i + max_children));
				}
				for (const [index, chunk] of [...chunks.entries()]) {
					const chunk_thing_id = Identifiable.newID();
					const chunk_thing = h.thing_remember_runtimeCreateUnique(h.db.idBase, chunk_thing_id, ancestry_title + '.' + (index + 1), 'blue', T_Thing.generic);
					h.relationship_remember_runtimeCreateUnique(h.db.idBase, Identifiable.newID(), T_Predicate.contains, ancestry_thing_id, chunk_thing.id, [0, 0], T_Create.getPersistentID);
					for (const child_ancestry of [...chunk]) {
						const child_relationship = child_ancestry.relationship;
						if (!!child_relationship) {
							child_relationship.assign_idParent(chunk_thing_id);
						}
					}
				}
			}
			return false;	// continue
		});
		if (changed) {
			h.ancestries_forget_all();
			h.ancestry_remember(rootAncestry);
		}
		return changed;
	}
	
	static readonly _____DEPRECATED: unique symbol;

	convert_key(key: string): number {
		const encodedKey = key.encode_as_property();
		if (!!encodedKey) {
			const newkey = T_Pivot_Fields[encodedKey as keyof typeof T_Pivot_Fields];
			return newkey;
		}
		return -1;
	}

	shrink_dict(dict: Dictionary): Dictionary {
		const shrunk: Dictionary = {};
		const keys_to_remove = ['Type', 'Link', 'Description', 'parent 1 link', 'data types import'];
		for (const key in dict) {
			if (!keys_to_remove.includes(key) && dict[key] != k.empty) {
				shrunk[key] = dict[key].removeWhiteSpace();
			}
		}
		return shrunk;
	}

	async cleanup_lost_and_found() {		// not currently in use
		
		const lost_and_found = await h.lost_and_found();
		if (!!lost_and_found) {
			const lost_and_found_ancestry = lost_and_found.ancestry;
			for (const child_zncestry of lost_and_found_ancestry.childAncestries) {
				const grandChildren_count = child_zncestry.childRelationships.length ?? 0;
				const child_relationship = child_zncestry.relationship;
				if (!!child_relationship) {
					const clump_name = grandChildren_count == 0 ? 'leaves' : 'crowds';
					const clump_ancestry = await h.ancestry_persistentCreateUnique(clump_name, lost_and_found_ancestry, T_Thing.generic);
					const idParent = clump_ancestry?.thing?.id;
					if (!!idParent) {
						child_relationship.assign_idParent(idParent);
					}
				}
			}
		}
	}

}

export const pivot = new Pivot();

enum T_Pivot_Fields {
	Title,
	parent_1_link,
	Custom_Tags_$$Local$,
	Societal_Sectors,
	Wheel_of_Co$$$Creation_Sectors,
	Data_Subtypes,
	Main_Data_Type,
	Link,
	data_types_import,
	name,
	All_Local_Tags_$$folder_names$,
	Description,
	Parent_2_tags,
	parent_2_link,
	Parent_3_Tags,
	Parent_3_link,
	Parent_4_Tags,
	Parent_Link_4,
	Parent_5_Tags,
	Parent_Link_5,
	Parent_6_Tags,
	Source_Created_Date,
	Domain,
	Custom_Tags,
	Privacy_Field_of_record,
	Type,
	Ignore_for_Sync,
	Ready_to_Sync,
	Last_Synced,
	User_Curators
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/files/Docs.ts
```ts
// Documentation structure for DB_Docs
// AUTO-GENERATED - DO NOT EDIT MANUALLY
// Run: bash shared/tools/create-docs-db-data.sh to regenerate

export interface DocNode {
	id: string;
	name: string;
	type: 'folder' | 'file';
	path: string;
	link?: string;
	children?: DocNode[];
}

export function getDocsStructure(): DocNode[] {
	return [
	];
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/files/Files.ts
```ts
import { T_File_Extension, T_Text_Extension, T_Image_Extension, T_Control } from '../common/Enumerations';
import { tu } from '../utilities/Testworthy_Utilities';
import DB_Filesystem from '../database/DB_Filesystem';
import { T_Preview_Type } from '../types/Types';
import { show } from '../managers/Visibility';
import { h } from '../managers/Hierarchy';
import { writable } from 'svelte/store';

interface File_System_Directory_Handle {
	name: string;
	requestPermission(descriptor?: { mode?: 'read' | 'readwrite' }): Promise<'granted' | 'denied' | 'prompt'>;
}

export default class Files {
	format_preference: T_File_Extension = T_File_Extension.json;

	w_preview_filename	= writable<string>('');
	w_preview_content	= writable<string | null>(null);
	w_preview_type		= writable<T_Preview_Type>('text');

	
	static readonly _____WRITE: unique symbol;

	persist_json_object_toFile(object: Object, fileName: string): void {
		const content = tu.stringify_object(object);
		const blob = new Blob([content], { type: 'application/json' });
		const link = document.createElement('a');
		link.href = URL.createObjectURL(blob);
		link.download = fileName;
		link.click();
		URL.revokeObjectURL(link.href);
	}
	
	static readonly _____READ: unique symbol;

	async fetch_fromFile(file: File): Promise<any> {
		const format = this.format_preference;
		switch (format) {
			case T_File_Extension.seriously: return await this.extract_json_object_fromFile(file);
			case T_File_Extension.json:	  return await this.extract_json_object_fromFile(file);
			case T_File_Extension.csv:		  return await this.extract_csv_records_fromFile(file);
			default:					  throw new Error(`Unsupported format: ${format}`);
		}
	}

	private async extract_json_object_fromFile(file: File): Promise<any> {
		return new Promise((resolve, reject) => {
			const reader = new FileReader();
			reader.onload = function (e) {
				const result = (e.target?.result as string);
				if (!result || result.length == 0) {
					reject('Empty file.');
				} else {
					try {
						const object = JSON.parse(result);
						resolve(object);
					} catch (error) {
						reject(`Error parsing JSON: '${result}' ${(error as Error).message}`);
					}
				}
			};
			reader.onerror = function () {
				reject('Error reading file.');
			};
			reader.readAsText(file);
		});
	}

	private async extract_csv_records_fromFile(file: File): Promise<any> {
		return new Promise((resolve, reject) => {
			const reader = new FileReader();
			reader.onload = function (e) {
				const result = (e.target?.result as string);
				if (!result || result.length == 0) {
					reject('Empty file.');
					return;
				}
				try {
					// Replace commas inside quotes with a temporary marker
					let inQuotes = false;
					let processed = '';
					for (let i = 0; i < result.length; i++) {
						const character = result[i];
						if (character === '"') inQuotes = !inQuotes;
						else if (character === ',' && inQuotes) processed += '$$$$$$';
						else processed += character;
					}
					
					const lines = processed.split('\n').filter(line => line.trim().length > 0);
					if (lines.length === 0) {
						reject('No data found in CSV file.');
						return;
					}
					const headers = lines[0].split(',').map(header => header.trim());
					const records = lines.slice(1).map(line => {
						const values = line.split(',').map(value => value.trim().replace(/\$\$\$\$\$\$/g, ','));
						const record: Record<string, string> = {};
						headers.forEach((header, index) => {
							record[header] = values[index] || '';
						});
						return record;
					});
					resolve(records);
				} catch (error) {
					reject(`Error parsing CSV: ${(error as Error).message}`);
				}
			};
			reader.onerror = function () {
				reject('Error reading file.');
			};
			reader.readAsText(file);
		});
	}
	
	static readonly _____PREVIEW: unique symbol;

	preview_type_forFilename(filename: string): T_Preview_Type {
		const ext = filename.split('.').pop()?.toLowerCase() || '';
		if (Object.values(T_Image_Extension).includes(ext as T_Image_Extension)) return 'image';
		if (Object.values(T_Text_Extension).includes(ext as T_Text_Extension)) return 'text';
		return null;
	}

	async show_previewOf_file(fileId: string): Promise<boolean> {
		let success = false;
		if (h.db instanceof DB_Filesystem) {
			const entry = h.db.get_file_information(fileId);
			if (!!entry && !entry.isDirectory) {
				const preview_type = this.preview_type_forFilename(entry.name);
				if (!!preview_type) {
					if (preview_type === 'image') {
						this.w_preview_content.set(await h.db.readFileAsDataURL(fileId));
					} else {
						this.w_preview_content.set(await h.db.readFileAsText(fileId));
					}
					this.w_preview_type.set(preview_type);
					this.w_preview_filename.set(entry.name);
					show.w_id_popupView.set(T_Control.preview);
					success = true;
				}
			}
		}
		return success;
	}

	static readonly _____DIRECTORY_HANDLE: unique symbol;

	private readonly DB_NAME = 'webseriously-files';
	private readonly STORE_NAME = 'directory-handles';
	private readonly HANDLE_KEY = 'last-folder';

	private async openDatabase(): Promise<IDBDatabase> {
		return new Promise((resolve, reject) => {
			const request = indexedDB.open(this.DB_NAME, 1);
			request.onerror = () => reject(request.error);
			request.onsuccess = () => resolve(request.result);
			request.onupgradeneeded = (event) => {
				const db = (event.target as IDBOpenDBRequest).result;
				if (!db.objectStoreNames.contains(this.STORE_NAME)) {
					db.createObjectStore(this.STORE_NAME);
				}
			};
		});
	}

	async save_directoryHandle(handle: File_System_Directory_Handle): Promise<boolean> {
		let success = false;
		try {
			const db = await this.openDatabase();
			const tx = db.transaction(this.STORE_NAME, 'readwrite');
			const store = tx.objectStore(this.STORE_NAME);
			store.put(handle, this.HANDLE_KEY);
			await new Promise<void>((resolve, reject) => {
				tx.oncomplete = () => resolve();
				tx.onerror = () => reject(tx.error);
			});
			db.close();
			success = true;
		} catch (error) {
			console.warn('Failed to save directory handle:', error);
		}
		return success;
	}

	async restore_directoryHandle(): Promise<File_System_Directory_Handle | null> {
		let handle: File_System_Directory_Handle | null = null;
		try {
			const db = await this.openDatabase();
			const tx = db.transaction(this.STORE_NAME, 'readonly');
			const store = tx.objectStore(this.STORE_NAME);
			const request = store.get(this.HANDLE_KEY);
			handle = await new Promise<File_System_Directory_Handle | null>((resolve, reject) => {
				request.onsuccess = () => resolve(request.result || null);
				request.onerror = () => reject(request.error);
			});
			db.close();
			if (!!handle) {
				const permission = await handle.requestPermission({ mode: 'read' });
				if (permission !== 'granted') {
					handle = null;
				}
			}
		} catch (error) {
			console.warn('Failed to restore directory handle:', error);
		}
		return handle;
	}

	async clear_directoryHandle(): Promise<void> {
		try {
			const db = await this.openDatabase();
			const tx = db.transaction(this.STORE_NAME, 'readwrite');
			const store = tx.objectStore(this.STORE_NAME);
			store.delete(this.HANDLE_KEY);
			await new Promise<void>((resolve, reject) => {
				tx.oncomplete = () => resolve();
				tx.onerror = () => reject(tx.error);
			});
			db.close();
		} catch (error) {
			console.warn('Failed to clear directory handle:', error);
		}
	}

}

export const files = new Files();```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_Repeater.ts
```ts
import { u } from '../common/Global_Imports';

export default class G_Repeater {
	title_widths: Array<number>;
	widths: Array<number> = [];
	lefts: Array<number> = [];
	proportionate: boolean;
	title_gap: number = 8;
	swap_title = false;
	font_size: number;
	columns: number;
    titles: string[];
	margin: number;
    height: number;
    width: number;
	padding = 8;
	gap = 0;

	//////////////////////////////////////////////////////////////
	//															//
	//	titles:			strings to display						//
	//	swap_title:		swap first and second titles			//
	//	proportionate:	space titles according to their widths	//
	//	font_size:		needed to compute each title's width	//
	//	gap:			between titles							//
	//	padding:		around titles							//
	//	margin:			on right and left						//
	//	title_gap:		after first title						//
	//															//
	//////////////////////////////////////////////////////////////

	constructor(titles: string[],
		height: number,
		width: number,
		margin: number,
		gap: number,
		padding: number,
		title_gap: number,
		proportionate: boolean,
		font_size: number,
		swap_title: boolean = false) {
		this.titles = G_Repeater.swap_titles(titles, swap_title);
		this.proportionate = proportionate;
		this.columns = titles.length;
		this.swap_title = swap_title;
		this.title_gap = title_gap;
		this.font_size = font_size;
		this.padding = padding;
		this.height = height;
		this.margin = margin;
		this.width = width;
		this.gap = gap;
		this.title_widths = this.titles.map((title) => u.getWidth_ofString_withSize(title, `${font_size}px`));
		this.widths = this.title_widths.map((w, i) => this.gap + this.button_width_for(i));
	}

	static swap_titles(titles: string[], swap_title: boolean): string[] {
		return (!swap_title || titles.length < 2) ? titles : [titles[1], titles[0], ...titles.slice(2)];
	}

	should_swap_titles(): boolean { return this.swap_title && this.titles.length > 1; }

	button_width_for(column: number): number { 
		const total_width = this.title_widths.reduce((acc, width) => acc + width, 0);	// sum of title widths
		if (this.proportionate) {
			const margin_and_gaps = this.margin * 2 + this.title_gap + this.gap * (this.columns - 1);
			const approportionment = (this.width - total_width - margin_and_gaps) / this.columns;
			return this.title_widths[column] + approportionment; 
		}
		if (column === (this.should_swap_titles() ? 1 : 0)) {
			const widths = this.title_widths.filter((_, i) => i !== column);
			const other_buttons_width = widths.reduce((acc, width) => acc + width + this.padding * 2, 0);
			return this.width - other_buttons_width - this.margin * 2 - this.gap - this.padding;
		}
		return this.title_widths[column] + this.padding * 2;
	}

	button_left_for(column: number): number {
		if (this.proportionate) {
			return this.widths.slice(0, column).reduce((sum, width) => sum + width, this.title_gap - this.gap / 2);
		}
		let x = 0;
		for (let i = 0; i < column; i++) {
			x += this.button_width_for(i) + this.gap;
		}
		return x;
	}
	
}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_TreeLine.ts
```ts
import { k, Rect, Size, Point, T_Tree_Line, svgPaths, Ancestry } from '../common/Global_Imports';

export default class G_TreeLine {
	t_curve: string = T_Tree_Line.flat;
	ancestry: Ancestry | null;	// main end of the line
	other_ancestry: Ancestry;	// other end of the line (N.B. main can be deeper!!)
	isBidirectional: boolean;
	points_atOther = true;
	origin = Point.zero;
	extent = Point.zero;
	linePath = k.empty;
	rect = Rect.zero;
	size = Size.zero;
	stroke_width = 1;
	name = k.empty;

	// scratchpad for one line drawn
	// from the "main" widget to its "other" {child OR bidirectional} widget

	constructor(ancestry: Ancestry | null, other_ancestry: Ancestry, isBidirectional: boolean = false) {
		this.name = ancestry?.title ?? k.empty;
		this.isBidirectional = isBidirectional;
		this.other_ancestry = other_ancestry;
		this.ancestry = ancestry;
	}

	get branchAncestry(): Ancestry | null { return this.points_atOther ? this.other_ancestry : this.ancestry; }
	get depth_ofLine(): number { return Math.max(this.ancestry?.depth ?? 0, this.other_ancestry.depth); }
		
	layout() {
		this.layout_svgPaths();
		this.update_name();
	}

	set_curve_type_forHeight(height: number) {
		if (height > 1) {
			this.t_curve = T_Tree_Line.down;
		} else if (height < -1) {
			this.t_curve = T_Tree_Line.up;
		} else {
			this.t_curve = T_Tree_Line.flat;
		}
	}

	static readonly _____INTERNAL: unique symbol;

	private update_name() {
		if (!!this.ancestry && !this.ancestry.equals(this.other_ancestry)) {
			this.name = `${this.ancestry.titles.join('.')}...${this.other_ancestry.titles.join('.')}`;
		}
	}
		
	private layout_svgPaths() {
		const lineOffset = new Point(-118.5, 1.5);
		let lineRect = this.rect.offsetBy(lineOffset).extend_widthBy(-4);
		switch (this.t_curve) {
			case T_Tree_Line.up:
				this.origin = lineRect.origin;
				this.extent = lineRect.extent.offsetByY(-1.5);
				break;
			case T_Tree_Line.down:
				this.origin = lineRect.bottomLeft.offsetByY(-0.5);
				this.extent = this.origin.offsetBy(lineRect.size.asPoint).offsetByY(0.5);
				break;
			case T_Tree_Line.flat:
				lineRect = lineRect.offsetByY(-1);
				this.origin = lineRect.centerLeft;
				this.extent = lineRect.centerRight;
				this.linePath = svgPaths.line(this.origin.vector_to(this.extent));
				break;
		}
		const vector = this.origin.vector_to(this.extent);
		this.size = vector.abs.asSize;
		if (this.t_curve != T_Tree_Line.flat) {
			const flag = (this.t_curve == T_Tree_Line.down) ? 0 : 1;
			const originY = this.t_curve == T_Tree_Line.down ? 0 : this.size.height;
			const extentY = this.t_curve == T_Tree_Line.up   ? 0 : this.size.height;
			this.linePath = `M0 ${originY} A ${this.size.description} 0 0 ${flag} ${this.size.width} ${extentY}`;
		}
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_TreeGraph.ts
```ts
import { c, g, k, p, x, show, Rect, debug, Ancestry, G_Widget, T_Kinship} from "../common/Global_Imports";
import { get } from "svelte/store";

export default class G_TreeGraph {
	attached_branches: string[] = [];
	focus!: Ancestry;

	constructor() {
		x.w_ancestry_focus.subscribe((focus: Ancestry | null) => {
			if (!!focus) {
				this.focus = focus;
			}
		});
	}

	layout() {
		const rect_ofGraphView = get(g.w_rect_ofGraphView);
		const depth_limit = get(g.w_depth_limit) ?? 1;
		if (!!rect_ofGraphView && !!this.g_focus) {
			this.layout_focus_ofTree(rect_ofGraphView); 
			this.g_focus.layout_each_generation_recursively(depth_limit);
			this.g_focus.layout_each_bidirectional_generation_recursively(depth_limit);
			this.adjust_focus_ofTree(rect_ofGraphView);
		}
	}

	get g_focus(): G_Widget | undefined { return this.focus?.g_widget; }

	get visible_g_widgets(): G_Widget[] {
		let array: G_Widget[] = [];
		if (!!this.focus) {
			this.focus.traverse((ancestry: Ancestry) => {
				if (ancestry.isVisible) {
					array.push(ancestry.g_widget);
				}
				return false;
			});
		}
		return array;
	}

	increase_depth_limit_by(increment: number) {
		g.w_depth_limit.update(a => a + increment);
		g.layout();
	}

	reset_scanOf_attached_branches() {
		debug.log_draw('TREE', 'reset scan');
		this.attached_branches = [];
		return true;	// tell svelte to reattach the tree
	}

	branch_isAlready_attached(ancestry: Ancestry): boolean {
		const visited = this.attached_branches.includes(ancestry.id);
		if (!visited) {
			this.attached_branches.push(ancestry.id);
		}
		return visited;
	}

	set_tree_types(t_trees: Array<T_Kinship>) {
		if (t_trees.length == 0) {
			t_trees = [T_Kinship.children];
		}
		show.w_t_trees.set(t_trees);
		x.update_forFocus();
		show.w_show_related.set(t_trees.includes(T_Kinship.related));
		p.restore_expanded();
		g.grand_build();
	}

	static readonly _____PRIVATE: unique symbol;

	private adjust_focus_ofTree(rect_ofGraphView: Rect) {
		const g_focus = this.g_focus;
		if (!!g_focus) {
			const y_offset = -1 - rect_ofGraphView.origin.y;
			const subtree_size = this.focus.size_ofVisibleSubtree;
			const x_offset_ofReveal = (this.focus.thing?.width_ofTitle ?? 0) / 2 - 2;
			const x_offset_forDetails = (get(show.w_show_details) ? -k.width.details : 0);
			const x_offset = x_offset_forDetails - (subtree_size.width / 2) - (k.height.dot / 2.5) + x_offset_ofReveal - 5;
			const origin_ofFocusReveal = rect_ofGraphView.center.offsetByXY(x_offset, y_offset);
			g_focus.origin_ofWidget = origin_ofFocusReveal.offsetByXY(-21.5 - x_offset_ofReveal, -5);
		}
	}

	private layout_focus_ofTree(rect_ofGraphView: Rect) {
		const y_offset = rect_ofGraphView.origin.y;
		const subtree_size = this.focus.size_ofVisibleSubtree;
		const x_offset_ofFirstReveal = (this.focus.thing?.width_ofTitle ?? 0) / 2 - 2;
		const y_offset_ofFirstBranches = (k.height.dot / 2) -(subtree_size.height / 2) - 5;
		const x_offset_ofFirstBranches = -8 - k.height.dot + x_offset_ofFirstReveal;
		const x_offset = (get(show.w_show_details) ? -k.width.details : 0) + 5 + x_offset_ofFirstReveal - (subtree_size.width / 2) - (k.height.dot / 2.5);
		const origin_ofFocusReveal = rect_ofGraphView.center.offsetByXY(x_offset, -y_offset);
		if (c.device_isMobile) {
			origin_ofFocusReveal.x = 25;
		}
		// need this for laying out branches, but it is wrong for final positioning
		// TODO: dunno why, must fix
		if (!!this.g_focus) {
			this.g_focus.origin_ofWidget = origin_ofFocusReveal.offsetByXY(x_offset_ofFirstBranches, y_offset_ofFirstBranches);
		}
	}

}

export const g_graph_tree = new G_TreeGraph();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_Paging.ts
```ts
import { h, k, radial, Thing, Predicate, Ancestry } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';

export class G_Paging {

	// a page is a subset of a too-long list of things
	// widgets_shown == length of subset
	// thing id refers to "owner"
	// index == first of subset

	isCluster_ofChildren = false;
	thing_id = k.empty;
	widgets_shown = 0;
	total_widgets = 0;
	kind = k.empty;
	index = 0;			// this value changes when user moves paging arc [thumb] slider, or when widget needs to be visible and isn't

	constructor(index: number = 0, widgets_shown: number = 0, total_widgets: number = 0) {
		this.index = index.force_asInteger_between(0, total_widgets - widgets_shown);
		this.total_widgets = total_widgets;
		this.widgets_shown = widgets_shown;
	}

	get isPaging(): boolean { return this.widgets_shown < this.total_widgets; }
	get indexOf_followingPage(): number { return this.index + this.widgets_shown; }
	get maximum_paging_index(): number { return this.total_widgets - this.widgets_shown; }
	get thing(): Thing | null { return h.thing_forHID(this.thing_id.hash()) ?? null; }
	get predicate(): Predicate | null { return h.predicate_forKind(this.kind) ?? null; }
	get sub_key(): string { return `${this.thing_id}${k.separator.generic}${this.kind}${k.separator.generic}${this.isCluster_ofChildren}`; }
	ancestry_atIndex(ancestries: Array<Ancestry>): Ancestry { return ancestries[Math.round(this.index)]; }
	
	index_isVisible(index: number): boolean {
		return index.isBetween(this.index, this.indexOf_followingPage - 1, true);
	}

	addTo_paging_index_for(delta: number): boolean {
		return (delta == 0) ? false : this.update_index_toShow(this.index + delta);
	}

	update_index_toShow(index: number): boolean {
		const prior = this.index;
		if (index == this.indexOf_followingPage) {
			this.index = (this.index + 1).force_between(0, this.maximum_paging_index);		// increment index by 1
		} else {
			this.index = index.force_between(0, this.maximum_paging_index);					// force == wrap around
		}
		const changed = this.index != prior;
		if (changed) {
			radial.w_g_paging.set(this);
		}
		return changed;
	}

	onePage_from(widgets_shown: number, ancestries: Array<Ancestry>): Array<Ancestry> {
		this.total_widgets = ancestries.length;
		this.widgets_shown = widgets_shown;
		this.update_index_toShow(this.index);
		const index = Math.round(this.index);
		return ancestries.slice(index, index + widgets_shown);
	}

	static create_g_paging_fromDict(dict: Dictionary, isCluster_ofChildren: boolean): G_Paging {
		const g_paging = new G_Paging(dict.index ?? 0, dict.widgets_shown ?? 0, dict.total_widgets);
		g_paging.isCluster_ofChildren = isCluster_ofChildren;
		g_paging.thing_id = dict.thing_id;
		g_paging.kind = dict.kind;
		return g_paging;
	}

	static create_g_paging_dict_fromDict(dict: Dictionary, isCluster_ofChildren: boolean): Dictionary<G_Paging> {
		const result: Dictionary<G_Paging> = {}
		for (const [key, subdict] of Object.entries(dict)) {
			result[key] = this.create_g_paging_fromDict(subdict, isCluster_ofChildren);
		}
		return result;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_Cluster_Pager.ts
```ts
import { Rect, Point, Angle, T_Orientation } from '../common/Global_Imports';
import { g, k, radial, svgPaths } from '../common/Global_Imports';
import { get } from 'svelte/store';

// create svg paths for generic arcs
// arc radii are smaller than ring radii
//
// given:
//	start, end & fork angles
//	w_resize_radius

export default class G_Cluster_Pager {
	label_text_angle = Math.PI / 2;
	clusters_center = Point.zero;
	label_center = Point.zero;
	tip_ofFork = Point.zero;
	outside_arc_radius = 0;
	inside_arc_radius = 0;
	arc_rect = Rect.zero;
	angle_ofCluster = 0;
	isThumb = false;
	fork_radius = 0;
	start_angle = 0;
	cap_radius = 0;
	end_angle = 0;

	constructor(isThumb: boolean) {
		const radius = get(radial.w_resize_radius);
		this.clusters_center = Point.square(radius);
		this.isThumb = isThumb;
		if (isThumb) {
			const delta = k.thickness.separator.main / 3;
			this.outside_arc_radius = radius + k.thickness.radial.arc - delta + 1;
			this.cap_radius = k.radius.arcSlider_cap - delta;
			this.inside_arc_radius = radius + delta + 1;
		} else {
			this.outside_arc_radius = radius + k.thickness.radial.arc + 1;
			this.cap_radius = k.radius.arcSlider_cap;
			this.inside_arc_radius = radius + 1;
		}
	}

	static readonly _____PRIMITIVES: unique symbol;

	get angle_ofFork():			number { return (this.end_angle + this.start_angle) / 2 - this.offset_ofNadir; }
	get offset_ofNadir():		number { return (this.arc_straddles_nadir && !this.arc_straddles(0)) ? Angle.half : 0; }
	get fork_slants_forward(): boolean { return new Angle(this.angle_ofCluster).angle_slants_forward; }
	get fork_points_right():   boolean { return new Angle(this.angle_ofCluster).angle_points_right; }
	get fork_points_down():    boolean { return new Angle(this.angle_ofCluster).angle_points_down; }
	get straddles_zero():	   boolean { return this.end_angle.straddles_zero(this.start_angle); }
	get arc_straddles_nadir(): boolean { return this.arc_straddles(Angle.three_quarters); }
	get spread_angle():			number { return this.end_angle - this.start_angle; }
	get arc_origin():			 Point { return this.arc_rect.origin; }
	get arc_center():			 Point { return this.arc_rect.center; }

	get compute_arc_rect(): Rect {
		let origin = Point.zero;
		let extent = Point.zero;
		const end_radial = this.radial_vector_atAngle(this.end_angle);								// for each of start and end radials,
		const start_radial = this.radial_vector_atAngle(this.start_angle);
		const start_x_isSmaller = start_radial.x < end_radial.x;								// for x and then for y
		const start_y_isSmaller = start_radial.y < end_radial.y;
		origin.x = (start_x_isSmaller ? start_radial.x : end_radial.x) - this.cap_radius;		// which radial's coordinate is smaller?
		origin.y = (start_y_isSmaller ? start_radial.y : end_radial.y) - this.cap_radius;		// subtract cap_radius
		extent.x = (start_x_isSmaller ? end_radial.x : start_radial.x) + this.cap_radius;		// vice-versa for larger
		extent.y = (start_y_isSmaller ? end_radial.y : start_radial.y) + this.cap_radius;
		return Rect.createExtentRect(origin, extent);
	}

	radial_vector_atAngle(angle: number): Point {
		const middle_radius = this.inside_arc_radius + this.cap_radius;
		return Point.fromPolar(middle_radius, angle);
	}

	arc_straddles(angle: number): boolean {
		return (this.start_angle.angle_normalized() > angle && this.end_angle.angle_normalized() < angle);
	}

	arc_contains_point(point: Point | null): boolean {
		if (!point) return false;
		const center = this.clusters_center;
		const angle = Math.atan2(point.y - center.y, point.x - center.x);
		const radius = center.vector_to(point).magnitude;
		
		const within_angle = this.arc_straddles(angle);
		const within_radius = 
			radius >= this.inside_arc_radius && 
			radius <= this.outside_arc_radius;
		
		return within_angle && within_radius;
	}

	static readonly _____LAYOUT: unique symbol;

	layout() {
		const fork_raw_radius = k.thickness.radial.ring * 0.6;
		const fork_backoff = this.fork_adjustment(fork_raw_radius, this.inside_arc_radius);
		this.fork_radius = fork_raw_radius - fork_backoff;
	}

	layout_forkTip(center: Point) {
		const radial_vector = Point.fromPolar(this.inside_arc_radius, this.angle_ofFork);
		this.tip_ofFork = center.offsetBy(radial_vector);
	}

	fork_adjustment(fork_radius: number, inside_arc_radius: number): number {
		const ratio = fork_radius / inside_arc_radius / 2;
		const angle = Math.asin(ratio) * 2;
		const delta = inside_arc_radius * (1 - Math.cos(angle));
		return delta / Math.sqrt(1.5);
	}

	finalize_angles() {
		if (!this.fork_points_right) {
			[this.start_angle, this.end_angle] = [this.end_angle, this.start_angle];
		}
		this.arc_rect = this.compute_arc_rect;
	}

	static readonly _____SVG_PATHS: unique symbol;

	get svgPathFor_arcSlider(): string {
		return this.svgPathFor_arcSlider_using(this.inside_arc_radius, this.outside_arc_radius, this.cap_radius);
	}

	svgPathFor_start(start_angle: number, radius: number) {
		return svgPaths.startOutAt(this.clusters_center, radius, start_angle);
	}

	get svgPathFor_radialFork(): string {
		return svgPaths.line_atAngle(this.clusters_center, this.inside_arc_radius, this.angle_ofFork);
	}

	svgPathFor_arcSliderEdge(end_angle: number, radius: number, clockwise: boolean) {
		const sweep_flag = clockwise ? 0 : 1;
		return svgPaths.arc_partial(this.clusters_center, radius, 0, sweep_flag, end_angle);
	}

	svgPathFor_cap(arc_angle: number, clockwise: boolean, cap_radius: number) {
		const radial_vector = this.radial_vector_atAngle(arc_angle);
		const center = this.clusters_center.offsetBy(radial_vector);
		const end_angle = arc_angle + (clockwise ? 0 : Math.PI);
		return svgPaths.arc_partial(center, cap_radius, 0, 1, end_angle);
	}

	get svgPathFor_fatArc(): string {
		const capRadius = k.thickness.radial.ring / 2;
		const smallRadius = get(radial.w_resize_radius) + 1;
		const bigRadius = smallRadius + k.thickness.radial.ring;
		return this.svgPathFor_arcSlider_using(smallRadius, bigRadius, capRadius);
	}

	svgPathFor_arcSlider_using(small_radius: number, big_radius: number, cap_radius: number): string {
		const start = this.start_angle;
		let end = this.end_angle;
		while (end < start) {
			end += Math.PI * 2;
		}
		const paths = [
			this.svgPathFor_start(start, big_radius),
			this.svgPathFor_arcSliderEdge(end, big_radius, false),
			this.svgPathFor_cap(end, false, cap_radius),
			this.svgPathFor_arcSliderEdge(start, small_radius, true),
			this.svgPathFor_cap(start, true, cap_radius),
		];
		return paths.join(k.space);
	}

	layout_endpoints_onArc(radius: number, angle: number, arcLength: number): { text_path_d: string, start_thumb_transform: string, end_thumb_transform: string } {
		const sweepAngle = arcLength / radius;
		const startAngle = angle - sweepAngle / 2;
		const endAngle = startAngle + sweepAngle;
		const invert = new Angle(angle).angle_points_up;
		const { start: text_start, end: text_end } = this.get_endpoints(startAngle, endAngle, radius, invert);
		const { start: thumb_start, end: thumb_end } = this.get_endpoints(startAngle, endAngle, radius + 0.8);
		const startThumbAngleDeg = (startAngle + Math.PI/2) * 180 / Math.PI;
		const endThumbAngleDeg = (endAngle - Math.PI/2) * 180 / Math.PI;
		const sweepFlag = invert ? 0 : 1;
		const text_path_d = `M ${text_start.x} ${text_start.y} A ${radius} ${radius} 0 0 ${sweepFlag} ${text_end.x} ${text_end.y}`;
		const start_thumb_transform = `translate(${thumb_start.x}, ${thumb_start.y}) rotate(${startThumbAngleDeg})`;
		const end_thumb_transform = `translate(${thumb_end.x}, ${thumb_end.y}) rotate(${endThumbAngleDeg})`;
		return { text_path_d, start_thumb_transform, end_thumb_transform };
	}

	private get_endpoints(startAngle: number, endAngle: number, arc_radius: number, invert: boolean = false) {
		const center_ofArc = g.center_ofGraphView;
		const startX = center_ofArc.x + arc_radius * Math.cos(invert ? endAngle : startAngle);
		const startY = center_ofArc.y + arc_radius * Math.sin(invert ? endAngle : startAngle);
		const endX = center_ofArc.x + arc_radius * Math.cos(invert ? startAngle : endAngle);
		const endY = center_ofArc.y + arc_radius * Math.sin(invert ? startAngle : endAngle);
		return { start: new Point(startX, startY), end: new Point(endX, endY) };
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_Cluster.ts
```ts
import { g, k, u, x, debug, colors, radial, signals } from '../common/Global_Imports';
import { G_Widget, G_Cluster_Pager, S_Rotation } from '../common/Global_Imports';
import { Point, Angle, Ancestry, Predicate } from '../common/Global_Imports';
import { G_Paging } from './G_Paging';
import { get } from 'svelte/store';

//////////////////////////////////////////
//										//
//	for ONE cluster (there are three)	//
//										//
//	assumes ancestries are				//
//		already paged to fit			//
//										//
//	computes:							//
//		positions of arc, thumb & label	//
//		svg paths for arc & thumb		//
//		geometry for each widget		//
//		angle for fork & label			//
//										//
//////////////////////////////////////////

export default class G_Cluster {
	g_cluster_pager = new G_Cluster_Pager(false);
	g_thumbArc = new G_Cluster_Pager(true);
	ancestries_shown: Array<Ancestry> = [];
	g_cluster_widgets: G_Widget[] = [];
	ancestries: Array<Ancestry> = [];
	color = colors.default_forThings;
	isCluster_ofChildren: boolean;
	arc_in_lower_half = false;
	label_center = Point.zero;
	cluster_title = k.empty;
	predicate: Predicate;
	center = Point.zero;
	widgets_shown = 0;
	total_widgets = 0;
	isPaging = false;
	row_height = 0;

	// heavy lifting for positioning everything in one cluster

	destructor() { this.ancestries = []; }
	constructor(predicate: Predicate, isCluster_ofChildren: boolean) {
		this.isCluster_ofChildren = isCluster_ofChildren;
		this.predicate = predicate;
		radial.w_resize_radius.subscribe((radius: number) => {
			const base_row_height = k.height.dot + 3;
			const inset = k.thickness.radial.ring / 1.5;
			this.row_height = base_row_height * radius / (radius + inset);
			if (this.g_cluster_pager.outside_arc_radius != radius) {
				this.layout();		// do not set_paging_index (else expand will hang)
			}
		})
	}

	static readonly _____CLUSTER: unique symbol;

	layout() {
		if (this.ancestries_shown.length > 0) {
			debug.log_build(`layout (${this.ancestries_shown.length} shown)  ${this.direction_kind}`);
			this.widgets_shown = this.ancestries_shown.length;
			this.isPaging = this.widgets_shown < this.total_widgets;
			this.center = get(g.w_rect_ofGraphView).size.asPoint.dividedInHalf;
			this.color = colors.opacitize(get(x.w_ancestry_focus)?.thing?.color ?? this.color, 0.2);
			this.g_cluster_pager.angle_ofCluster = this.angle_ofCluster;
			this.g_cluster_pager.layout();
			this.layout_cluster_widgets();
			this.g_cluster_pager.layout_forkTip(this.center);
			this.layout_label();
			this.layout_thumb_angles();
			this.update_label_forIndex();
			signals.signal_reposition_widgets_fromFocus();
		}
	}
	
	get angle_ofCluster(): number {
		// returns one of three angles: 1) children_angle 2) opposite+tweak 3) opposite-tweak
		const tweak = 2 * Math.PI / 3;					// equilateral distribution
		const children_angle = get(radial.w_rotate_angle);
		const raw = this.predicate.isBidirectional ?
			children_angle + tweak :
			this.isCluster_ofChildren ? children_angle :		// one directional, use global
			children_angle - tweak;
		return raw ?? 0;
	}

	static readonly _____OTHER: unique symbol;

	get titles(): string { return this.ancestries.map(a => a.title).join(', '); }
	get description(): string { return `(${this.cluster_title}) ${this.titles}`; }
	get kind(): string { return this.predicate?.kind.unCamelCase().lastWord() ?? k.empty; }
	get name(): string { return `${get(x.w_ancestry_focus)?.title ?? 'unknown'}-cluster-${this.direction_kind}`; }

	get isMouse_insideThumb(): boolean {
		const offset = Point.square(-radial.ring_radius);
		const mouse_vector = g.mouse_vector_ofOffset_fromGraphCenter(offset);
		return this.isPaging && !!mouse_vector && mouse_vector.isContainedBy_path(this.g_thumbArc.svgPathFor_arcSlider);
	}

	setAncestries(ancestries: Array<Ancestry>) {
		this.total_widgets = this.widgets_shown = ancestries.length;
		this.ancestries = ancestries;
	}

	static readonly _____LABEL: unique symbol;

	private layout_label() {		// rotate text tangent to arc, at center of arc
		const angle = this.g_cluster_pager.angle_ofFork;
		const ortho = this.arc_in_lower_half ? Angle.three_quarters : Angle.quarter;
		const tweak = [10, 7, -17.4, -22.4][u.convert_toNumber([this.arc_in_lower_half, true])];
		const label_radius = radial.ring_radius + tweak;
		this.label_center = this.center.offsetBy(Point.fromPolar(label_radius, angle));
		this.g_cluster_pager.label_text_angle = ortho - angle;
	}
	
	private update_label_forIndex() {
		let title =  `${this.total_widgets} ${this.direction_kind}`;
		if (this.isPaging) {
			const index = this.paging_index_ofFocus;
			const middle = (this.widgets_shown < 2) ? k.empty : `-${index + this.widgets_shown}`;
			title = `${this.total_widgets} ${this.direction_kind} (${index + 1}${middle})`
		}
		this.cluster_title = title;
	}
	
	static readonly _____PAGING: unique symbol;

	get maximum_paging_index():	  number { return this.total_widgets - this.widgets_shown; }
	get paging_index_ofFocus():	  number { return Math.round(this.g_focusPaging?.index ?? 0); }
	get s_paging():			  S_Rotation { return radial.s_paging_forName_ofCluster(this.name); }
	get g_paging():		 G_Paging | null { return this.g_paging_forPredicate_toChildren(this.predicate, this.isCluster_ofChildren); }

	get g_focusPaging(): G_Paging | null { 
		const focus = get(x.w_ancestry_focus);
		return focus ? this.g_paging_forAncestry(focus) : null;
	}

	g_paging_forPredicate_toChildren(predicate: Predicate, isCluster_ofChildren: boolean): G_Paging | null {
		const g_pages = radial.g_pages_forThingID(get(x.w_ancestry_focus)?.thing?.id);
		return g_pages?.g_paging_forPredicate_toChildren(predicate, isCluster_ofChildren) ?? null;
	}

	g_paging_forAncestry(ancestry: Ancestry): G_Paging | null {
		const g_pages = radial.g_pages_forThingID(ancestry.thing?.id);
		return g_pages?.g_paging_for(this) ?? null;
	}

	layout_forPaging() {
		const g_paging = this.g_paging;
		if (!!g_paging) {
			const points_right = new Angle(this.angle_ofCluster).angle_points_right;
			const onePage_ofAncestries = g_paging.onePage_from(this.widgets_shown, this.ancestries);
			this.ancestries_shown = points_right ? onePage_ofAncestries.reverse() : onePage_ofAncestries;	
			this.layout();
			let angle = this.g_cluster_pager.spread_angle;
			if (angle < 0) {
				angle = -angle;
			}
			return angle;
		}
		return 0;
	}
	
	adjust_paging_index_byAdding_angle(delta_angle: number) {
		const paging = this.g_focusPaging;
		if (!!paging) {
			const max_index = this.maximum_paging_index;
			const spread_angle = -this.g_cluster_pager.spread_angle;
			const sensitivity_multiplier = Math.PI * spread_angle * 5 / Math.min(18, (max_index ** .5));
			const delta_fraction = delta_angle * sensitivity_multiplier / spread_angle;
			const delta_index = delta_fraction * max_index;			// convert rotation delta to index delta
			const adjusted = paging.addTo_paging_index_for(delta_index) ?? false;	// add index delta to index
			this.layout_thumb_angles();
			if (adjusted) {
				this.update_label_forIndex();
			}
			return adjusted || delta_index != 0;
		}
		return false;
	}

	static readonly _____ANGLES: unique symbol;
	
	private get isSingular(): boolean { return this.total_widgets == 1; }
	private get isParental(): boolean { return !this.isCluster_ofChildren && !this.predicate?.isBidirectional; }
	private get radial_vector_ofFork(): Point { return Point.fromPolar(radial.ring_radius, this.angle_ofCluster); }
	private get direction_kind(): string { return this.isParental ? this.isSingular ? 'parent' : 'parents' : this.isCluster_ofChildren ? this.isSingular ? 'child' : 'children' : this.kind; }

	private update_arc_angles(index: number, max: number, child_angle: number) {
		// index increases & angle decreases clockwise
		if (index == max) {
			this.g_cluster_pager.start_angle = child_angle;
		}
		if (index == 0) {
			this.g_cluster_pager.end_angle = child_angle;
		}
	}

	layout_cluster_widgets() {
		this.g_cluster_widgets = [];
		if (this.widgets_shown > 0 && !!this.predicate) {
			const inset = k.thickness.radial.ring / 1.5;
			const radial_vector = Point.x(radial.ring_radius + inset);
			const radial_vector_ofFork = this.radial_vector_ofFork;				// points at middle widget (of cluster)
			const fork_points_right = radial_vector_ofFork.x > 0;
			const fork_points_down = radial_vector_ofFork.y < 0;
			const center = this.center.offsetByXY(0.5, -1);			// tweak so that drag dots are centered within the rotation ring
			let index = 0;
			while (index < this.widgets_shown) {
				const adjusted_index = fork_points_right ? (this.widgets_shown - index - 1) : index;
				const ancestry = this.ancestries_shown[adjusted_index];
				const angle = this.angle_at_index(adjusted_index);
				const points_right = new Angle(angle).angle_points_right;
				const rotated_origin = center.offsetBy(radial_vector.rotate_by(angle));
				const g_widget = ancestry.g_widget;
				g_widget.layout_necklaceWidget(rotated_origin, points_right);
				this.g_cluster_widgets.push(g_widget);
				index += 1;
			}
			this.g_cluster_pager.finalize_angles();
			this.arc_in_lower_half = fork_points_down;
		}
	}

	private angle_at_index(index: number): number {

		// index:
		//	increases clockwise
		//	constant vertical distribution
		//	maximum is 1 subtracted from shown
		// angle:
		//	avoids zenith and nadir
		//	increases counter-clockwise
		//	widgets distributed half-and-half around fork-angle

		const max = this.widgets_shown - 1;
		const row = (max / 2) - index;						// row goes from minus to plus (equally divided around fork_y)
		const radius = radial.ring_radius;
		const radial_vector = this.radial_vector_ofFork;	// points at cluster's middle widget
		let y = radial_vector.y + (row * this.row_height);		// distribute y equally around fork_y
		let y_isOutside = false;
		const absY = Math.abs(y);
		if (absY > radius) {
			y_isOutside = true;								// y is outside rotation ring
			y = radius * (y / absY) - (y % radius);			// swing around (bottom | top) --> back inside rotation
		}
		let child_angle = Math.asin(y / radius);			// arc-sin only defined (-90 to 90) [ALSO: negate angles so things advance clockwise]
		if (y_isOutside != (radial_vector.x > 0)) {			// counter-clockwise if (x is positive AND y is outside) OR (x is negative AND y is inside)
			child_angle = Angle.half - child_angle			// otherwise it's clockwise, so invert it
		}
		this.update_arc_angles(index, max, child_angle);
		return child_angle;									// angle at index
	}

	private layout_thumb_angles() {

		// a tad complex, because:
		// 1. start & end are sometimes reversed (hasNegative_spread)
		// 2. arc can straddle nadir when fork y is outside of ring

		if (this.total_widgets > 0) {	// avoid division by zero
			const spread_angle = this.g_cluster_pager.spread_angle;
			const hasNegative_spread = spread_angle < 0
			const inverter = hasNegative_spread ? 1 : -1;
			const otherInverter = (hasNegative_spread == this.g_cluster_pager.arc_straddles_nadir) ? -1 : 1;
			const arc_spread = this.g_cluster_pager.arc_straddles_nadir ? (-spread_angle).angle_normalized() : spread_angle;
			const increment = arc_spread / this.total_widgets * inverter;
			const arc_start = this.g_cluster_pager.start_angle * otherInverter;
			const start = arc_start + (increment * this.paging_index_ofFocus);
			const end = start + (increment * this.widgets_shown);
			const angle = (start + end) / 2;
			this.g_thumbArc.angle_ofCluster = angle;
			this.g_thumbArc.start_angle = start;
			this.g_thumbArc.end_angle = end;
			this.g_thumbArc.layout();
		}
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_TreeBranches.ts
```ts
import { show, Size, Point, Ancestry, T_Graph } from '../common/Global_Imports';

export default class G_TreeBranches {
	show_child_branches = true;
	origin_ofLine = Point.zero;
	ancestry: Ancestry;
	size = Size.zero;

	// scratchpad for widgets, size_ofSubtree.height and center

	constructor(ancestry: Ancestry, show_child_branches: boolean = true) {
		this.show_child_branches = show_child_branches;
		this.ancestry = ancestry;
	}
		
	layout() {
		const ancestry = this.ancestry;
		const g_widget = ancestry.g_widget;
		if (show.inTreeMode && !!ancestry && !!g_widget && (ancestry.isExpanded || ancestry.isRoot)) {
			let width = 0;
			const branchAncestries = ancestry.branchAncestries;
			const halfHeight = ancestry.halfHeight_ofVisibleSubtree;
			const origin_ofWidget = g_widget.origin_ofWidget.offsetByXY(1, halfHeight + 1);
			let height = -halfHeight;		// start out negative and grow positive
			for (const ancestry_ofBranch of [...branchAncestries]) {
				if (ancestry_ofBranch.depth > ancestry.depth) {
					const g_widget_ofBranch = ancestry_ofBranch.g_widget;
					g_widget_ofBranch.layout_subtree_for(height, origin_ofWidget, T_Graph.tree)
					width = Math.max(width, g_widget_ofBranch.width_ofWidget);
					height += g_widget_ofBranch.size_ofSubtree.height;
				}
			}
			this.size = new Size(width, height + halfHeight);
			this.origin_ofLine = origin_ofWidget.offsetByXY(25, 1.2);
		}
	}

}```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_RadialGraph.ts
```ts
import { g, h, k, u, x, Point, radial, Ancestry, Predicate } from '../common/Global_Imports';
import { G_Widget, G_Cluster, T_Kinship } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import { G_Paging } from './G_Paging';
import { get } from 'svelte/store';

export default class G_RadialGraph {
	g_parent_clusters: Dictionary<G_Cluster> = {};		// includes related
	g_child_clusters: Dictionary<G_Cluster> = {};

	destructor() {
		Object.values(this.g_parent_clusters).forEach(cluster => cluster.destructor());
		Object.values(this.g_child_clusters).forEach(cluster => cluster.destructor());
		this.g_parent_clusters = {};
		this.g_child_clusters = {};
	}

	static readonly _____LAYOUT: unique symbol;

	//////////////////////////////////////////////////
	// layout widgets, cluster lines, & paging arcs //
	//////////////////////////////////////////////////

	layout() {
		this.destructor();
		this.layout_forChildren_cluster(true);
		this.layout_forChildren_cluster(false);
		this.layout_focus();
		this.layout_forPaging();
	}

	layout_focus() {
		const ancestry = get(x.w_ancestry_focus);
		const g_focus = ancestry?.g_widget;
		if (!!g_focus && !!ancestry?.thing) {
			const width_ofTitle = ancestry.thing.width_ofTitle;
			const width_ofWidget = width_ofTitle + 13;
			const x = - 1 - (width_ofWidget / 2);
			const y = -10;
			const origin_ofWidget = g.center_ofGraphView.offsetByXY(x, y);
			g_focus.layout();
			g_focus.offset_ofWidget = Point.zero;
			g_focus.width_ofWidget = width_ofWidget + 5;
			g_focus.location_ofRadial = origin_ofWidget;
			g_focus.origin_ofRadial = origin_ofWidget.offsetByX(-width_ofTitle);	// adjust for printing
		}
	}

	layout_forChildren_cluster(isCluster_ofChildren: boolean) {
		const focus_ancestry = get(x.w_ancestry_focus);
		if (!!focus_ancestry) {
			if (isCluster_ofChildren) {
				let childAncestries = focus_ancestry.ancestries_createUnique_forKinship(T_Kinship.children);
				this.assignAncestries_toClusterFor(childAncestries, Predicate.contains, true);
			} else {
				for (const predicate of [...h?.predicates ?? []]) {
					const ancestries = focus_ancestry.ancestries_createUnique_forKinship(predicate.kinship_forChildren_cluster(false));
					this.assignAncestries_toClusterFor(ancestries, predicate, false);
				}
			}
		}	
	}

	static readonly _____CLUSTERS: unique symbol;

	get g_clusters(): Array<G_Cluster> {
		return u.concatenateArrays(Object.values(this.g_parent_clusters), Object.values(this.g_child_clusters));
	}

	get g_clusters_forPaging(): Array<G_Cluster> {
		return this.g_clusters.filter(cluster => cluster.ancestries.length > 0);
	}

	get g_cluster_atMouseLocation(): G_Cluster | null {
		for (const g_cluster of [...this.g_clusters]) {
			if (g_cluster.isMouse_insideThumb) {
				return g_cluster;
			}
		}
		return null;
	}

	private g_cluster_forPredicate_toChild(predicate: Predicate, isCluster_ofChildren: boolean) : G_Cluster {
		const g_clusters = isCluster_ofChildren ? this.g_child_clusters : this.g_parent_clusters;;
		let g_cluster = g_clusters[predicate.kind];
		if (!g_cluster) {
			g_cluster = new G_Cluster(predicate, isCluster_ofChildren);
			g_clusters[predicate.kind] = g_cluster;
		}
		return g_cluster;
	}

	static readonly _____ANCESTRIES: unique symbol;

	get total_ancestries(): number {
		return this.g_clusters.reduce((sum, cluster) => sum + cluster.total_widgets, 0);
	}

	private assignAncestries_toClusterFor(ancestries: Array<Ancestry> | null, predicate: Predicate | null, isCluster_ofChildren: boolean) {
		if (!!predicate && !!ancestries) {
			const g_cluster = this.g_cluster_forPredicate_toChild(predicate, isCluster_ofChildren);
			g_cluster.setAncestries(ancestries);
			for (const ancestry of [...ancestries]) {
				ancestry.g_widget.g_cluster = g_cluster;
			}
		}
	}

	static readonly _____NECKLACE: unique symbol;

	get visible_g_widgets(): G_Widget[] {
		let array: G_Widget[] = this.g_necklace_widgets;
		const g_focus = get(x.w_ancestry_focus)?.g_widget;
		if (!!g_focus) {
			array.push(g_focus);
		}
		return array
	}

	get g_necklace_widgets(): G_Widget[] {
		let g_widgets: G_Widget[] = [];
		for (const g_cluster of [...this.g_clusters]) {
			if (!!g_cluster) {
				for (const g_widget of [...g_cluster.g_cluster_widgets]) {
					g_widgets.push(g_widget);
				}
			}
		}
		return g_widgets;
	}

	static readonly _____PAGING: unique symbol;

	g_paging_forPredicate_toChildren(predicate: Predicate, isCluster_ofChildren: boolean): G_Paging | null {
		const g_thing_pages = radial.g_pages_forThingID(get(x.w_ancestry_focus)?.thing?.id);
		return g_thing_pages?.g_paging_forPredicate_toChildren(predicate, isCluster_ofChildren) ?? null;
	}

	layout_forPaging() {
		const radius = get(radial.w_resize_radius);
		const angle_per_widget = 40 / radius;			// Limit show so arc spread never exceeds 180°
		const maximum_portion = Math.floor(Math.PI / angle_per_widget);
		let remaining_toShow = Math.ceil(Math.pow(radius, 1.5) / k.height.row);
		if (this.total_ancestries > remaining_toShow || this.total_ancestries > maximum_portion) {
			let clusters = this.g_clusters_forPaging;
			clusters.sort((a, b) => a.total_widgets - b.total_widgets);		// sort clusters by widgets count, smallest first
			while (clusters.length > 0 && remaining_toShow > 0) {
				const portion = Math.min(Math.ceil(remaining_toShow / clusters.length), maximum_portion);
				const cluster = clusters[0];
				const show = Math.min(portion, cluster.total_widgets);
				remaining_toShow -= show;
				cluster.widgets_shown = show;
				clusters.shift();
			}
		}
		for (const g_cluster of [...this.g_clusters_forPaging]) {
			g_cluster.layout_forPaging();
		}
	}

}

export const g_graph_radial = new G_RadialGraph();
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_Pages.ts
```ts
import { h, k, Thing, Predicate, G_Cluster } from '../common/Global_Imports';
import type { Dictionary } from '../types/Types';
import { G_Paging } from './G_Paging';

export class G_Pages {

	parent_pagings_dict: Dictionary<G_Paging> = {};
	child_pagings_dict: Dictionary<G_Paging> = {};
	thing_id = k.empty;

	// every Thing has a G_Pages
	//
	// two arrays of G_Paging (defined above)
	// 1) child: (to) children and relateds (more kinds later?)
	// 2) parent: (from) parents
	// each array has one index for each predicate kind
	// 
	// page == a subset of a too-long list
	// index == first of subset, and changes to show a different subset

	constructor(thing_id: string = k.empty) {
		this.thing_id = thing_id;
	}

	static create_fromDict(dict: Dictionary): G_Pages | null {
		const s_pages = new G_Pages(dict.thing_id);
		s_pages.child_pagings_dict = G_Paging.create_g_paging_dict_fromDict(dict.child_pagings_dict, true);
		s_pages.parent_pagings_dict = G_Paging.create_g_paging_dict_fromDict(dict.parent_pagings_dict, false);
		return s_pages;
	}

	get thing(): Thing | null { return h.thing_forHID(this.thing_id.hash()) ?? null; }
	g_paging_for(g_cluster: G_Cluster): G_Paging { return this.g_paging_forPredicate_toChildren(g_cluster.predicate, g_cluster.isCluster_ofChildren); }
	g_pagings_dict_forChildren(isCluster_ofChildren: boolean): Dictionary<G_Paging> { return isCluster_ofChildren ? this.child_pagings_dict : this.parent_pagings_dict; }

	add_g_paging(g_paging: G_Paging) {
		const g_pagings = this.g_pagings_dict_forChildren(g_paging.isCluster_ofChildren);
		g_pagings[g_paging.kind] = g_paging;
	}

	g_paging_forPredicate_toChildren(predicate: Predicate, isCluster_ofChildren: boolean): G_Paging {
		let g_pagings = this.g_pagings_dict_forChildren(isCluster_ofChildren);
		let g_paging = g_pagings[predicate.kind]
		if (!g_paging) {
			g_paging = new G_Paging();
			g_paging.kind = predicate.kind;
			g_paging.thing_id = this.thing_id;
			g_pagings[predicate.kind] = g_paging;
			g_paging.isCluster_ofChildren = isCluster_ofChildren;
		}
		return g_paging;
	}

}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/geometry/G_Widget.ts
```ts
import { k, u, show, Rect, Size, Point, debug, elements, Ancestry } from '../common/Global_Imports';
import { S_Widget, G_Cluster, G_TreeLine, G_TreeBranches } from '../common/Global_Imports';
import { T_Widget, T_Graph } from '../common/Global_Imports';
import { get } from 'svelte/store';

export default class G_Widget {
	g_bidirectionalLines: G_TreeLine[] = [];
	location_within_necklace = Point.zero;
	timestamp = new Date().getTime();
	g_parentBranches: G_TreeBranches;	// <future>
	g_childBranches: G_TreeBranches;	// scratchpad size_ofSubtree.height and center (of subtree)
	location_ofRadial = Point.zero;
	center_ofReveal = Point.zero;
	offset_ofWidget = Point.zero;
	origin_ofWidget = Point.zero;
	origin_ofRadial = Point.zero;
	origin_ofTrunk = Point.zero;
	origin_ofTitle = Point.zero;
	center_ofDrag = Point.zero;
	size_ofSubtree = Size.zero;
	reveal_isAt_right = true;
	pointsTo_child = true;
	g_cluster!: G_Cluster;
	s_widget!: S_Widget;
	g_line!: G_TreeLine;
	ancestry!: Ancestry;
	width_ofWidget = 0;
	t_graph: T_Graph;

	// create a G_TreeLine as normal
	// and one for each bidirectional

	get html_element(): HTMLElement | null { return this.s_widget.html_element; }

	// single source of truth for widget's
	//
	// widget_width (computed here)
	// relevant ancestries (children, thing, shows reveal)
	//
	// layout:
	//	 rects for lines from: parent and bidirectionals
	//	 locations of:
	//		dots and title, 
	//		trunk base and its child branches
	//		necklace angle, radial origin
	//		orientations (in/out, right/left) caused by rotating the necklace

	constructor(ancestry: Ancestry) {
		this.g_line = new G_TreeLine(ancestry.parentAncestry, ancestry);
		this.g_parentBranches = new G_TreeBranches(ancestry, false);
		this.g_childBranches = new G_TreeBranches(ancestry);
		this.s_widget = elements.s_widget_forAncestry(ancestry);
		this.t_graph = get(show.w_t_graph);
		this.ancestry = ancestry;
		if (!ancestry) {
			console.warn(`G_Widget is missing an ancestry`);
		} else if (!ancestry.thing) {
			console.warn(`G_Widget is missing a thing for "${ancestry.id}"`);
		}
	}

	static readonly _____PRIMITIVES: unique symbol;

	static empty(ancestry: Ancestry) { return new G_Widget(ancestry); }

	get absolute_center_ofDrag(): Point { return this.origin.offsetBy(this.center_ofDrag); }
	get absolute_center_ofReveal(): Point { return this.origin.offsetBy(this.center_ofReveal); }
	get showingReveal(): boolean { return this.ancestry.showsReveal_forPointingToChild(this.pointsTo_child) ?? false; }
	get origin_ofGraphDrawing(): Point { return this.t_widget == T_Widget.radial ? this.origin_ofRadial : this.origin; }
	get reveal_count(): number { return (!this.g_cluster || this.g_cluster.isCluster_ofChildren) ? this.ancestry.children.length : this.ancestry.count_ofParents; }

	private get t_widget(): T_Widget {
		const isFocus = this.ancestry?.isFocus ?? false;
		return show.inRadialMode ? T_Widget.radial : isFocus ? T_Widget.focus : T_Widget.tree;
	}

	get origin(): Point {
		switch (this.t_widget) {
			case T_Widget.radial: return this.location_ofRadial;
			case T_Widget.focus:  return this.origin_ofWidget;	// tree focus
			default:			  return this.origin_ofTrunk;
		}
	}

	static readonly _____LAYOUT: unique symbol;

	private layout_one_generation() {
		this.layout();						// assumes full progeny subtrees are laid out (needed for progeny size)
		this.layout_origin_ofTrunk();
		this.g_childBranches.layout();		// noop if childless, radial or collapsed ... FUBAR: BAD origin_ofWidget, after switching to radial, refocusing, then back again
		debug.log_layout(`WIDGET one generation ${this.origin.verbose} ${this.ancestry.title}`);
	}

	private layout_origin_ofTrunk() {
		if (!!this.ancestry && show.inTreeMode) {
			this.origin_ofTrunk = this.g_line.rect.extent.offsetByXY(k.height.row, -8.6);
			this.g_line.layout();
		}
	}

	layout_necklaceWidget(rotated_origin: Point, reveal_isAt_right: boolean) {
		if (show.inRadialMode) {
			this.t_graph = T_Graph.radial;
			this.location_within_necklace = rotated_origin;
			this.reveal_isAt_right = reveal_isAt_right;
			this.layout();
			debug.log_layout(`WIDGET necklaceWidget ${this.origin.verbose} ${this.ancestry.title}`);
		}
	}

	layout_bidirectional_lines(bidirectionals: G_TreeLine[]) {
		const g_lines = this.ancestry.g_lines_forBidirectionals;
		for (const g_line of g_lines) {
			if (!u.hasMatching_bidirectional(bidirectionals, g_line)) {
				this.g_bidirectionalLines.push(g_line);
				g_line.layout();
			}
		}
		return this.g_bidirectionalLines;
	}

	layout_each_generation_recursively(depth: number, visited: string[] = []) {
		if (depth > 0) {
			const ancestry = this.ancestry;	
			if (!visited.includes(ancestry.id) && ancestry.shows_branches && depth > 0) {
				const branchAncestries = ancestry.branchAncestries;
				for (const branchAncestry of branchAncestries) {
					branchAncestry.g_widget.layout_each_generation_recursively(depth - 1, [...visited, branchAncestry.id]);		// layout progeny first
				}
			}
			this.layout_one_generation();			// <-- this is the heavy lifter
		}
	}

	layout_each_bidirectional_generation_recursively(depth: number, visited: string[] = [], bidirectionals: G_TreeLine[] = []) {
		if (show.inTreeMode && get(show.w_show_related) && depth > 0) {
			this.g_bidirectionalLines = [];
			const more = this.layout_bidirectional_lines(bidirectionals);
			const ancestry = this.ancestry;	
			if (!visited.includes(ancestry.id) && ancestry.shows_branches) {
				const childAncestries = ancestry.childAncestries;
				for (const childAncestry of childAncestries) {
					childAncestry.g_widget.layout_each_bidirectional_generation_recursively(		// layout progeny first
						depth - 1,
						[...visited, childAncestry.id],
						[...bidirectionals, ...more]);
				}
			}
		}
	}

	layout_subtree_for(
		height: number = 0,
		origin: Point = Point.zero,
		t_graph = T_Graph.radial,
		pointsTo_child: boolean = true,
		reveal_isAt_right: boolean = true) {

		if (t_graph == get(show.w_t_graph)) {	// assure modes match
			const height_ofSubtree = this.ancestry.height_ofVisibleSubtree();
			const height_ofLines = height + height_ofSubtree / 2;
			const rect_ofLines = new Rect(origin, new Size(k.width.child_gap, height_ofLines - 1));
			this.origin_ofWidget = this.origin_forAncestry_inRect(this.ancestry, rect_ofLines);
			this.g_line.rect = rect_ofLines.extend_widthBy(5);
			this.t_graph = t_graph;
			this.pointsTo_child = pointsTo_child;
			this.size_ofSubtree.height = height_ofSubtree;
			this.reveal_isAt_right = reveal_isAt_right;
			this.g_line.set_curve_type_forHeight(height_ofLines);
			this.layout_one_generation();
		}
	}

	layout() {
		const ancestry = this.ancestry;
		if (!!ancestry.thing) {
			const dot_size = k.height.dot;
			const show_reveal = this.showingReveal;
			const inRadialMode = show.inRadialMode;
			const reveal_isAt_right = this.reveal_isAt_right;
			const width_ofTitle = ancestry.thing.width_ofTitle;
			const width_ofReveal_dot = show_reveal ? dot_size : 0;
			const isRadialFocus = inRadialMode && ancestry.isFocus;
			const width_ofDrag = (dot_size * 2) + (inRadialMode ? 2 : -4);
			const width_ofWidget = isRadialFocus 
				? width_ofTitle + 18 
				: width_ofTitle + width_ofDrag + width_ofReveal_dot + (inRadialMode ? 0 : 4) - 5;
			const x_ofDrag_for_pointing_left = width_ofWidget - dot_size - 1.25 + (show_reveal ? 0.5 : 0);
			const x_ofDrag = reveal_isAt_right ? 2 : x_ofDrag_for_pointing_left;
			const x_ofRadial = reveal_isAt_right ? -4 : -dot_size;
			const x_offset_ofWidget = reveal_isAt_right ? -7 : 6 + dot_size - width_ofWidget;
			const origin_ofDrag = new Point(x_ofDrag, 2.8);
			const x_ofRadial_title = (reveal_isAt_right && !isRadialFocus) ? 19 : (show_reveal ? 22 : 10);
			if (!isRadialFocus) {	// not overwrite focus's location_ofRadial
				this.location_ofRadial = this.location_within_necklace.offsetByXY(x_ofRadial + 4, 6 - dot_size);
			}
			this.origin_ofRadial = this.location_ofRadial.offsetByX(reveal_isAt_right ? 0 : -width_ofTitle - width_ofReveal_dot);
			this.origin_ofTitle = Point.x(inRadialMode ? x_ofRadial_title : dot_size + 5);
			this.center_ofDrag = origin_ofDrag.offsetEquallyBy(dot_size / 2);
			this.offset_ofWidget = new Point(x_offset_ofWidget + (ancestry.isFocus ? 5 : 0), 0.5);
			this.width_ofWidget = width_ofWidget;
			if (show_reveal) {
				const y_ofReveal = dot_size - 3.8;
				const x_offsetFor_revealAt_right = width_ofWidget - dot_size - 10;
				const x_ofReveal = dot_size + (reveal_isAt_right ? x_offsetFor_revealAt_right : -3);
				this.center_ofReveal = new Point(x_ofReveal, y_ofReveal);
			}
		}
	}

	static readonly _____PRIVATE: unique symbol;

	private origin_forAncestry_inRect(ancestry: Ancestry, rect: Rect): Point {
		const thing = ancestry.thing;
		let x, y = 0;
		if (!!thing) {
			y = rect.extent.y - ancestry.halfHeight_ofVisibleSubtree;
			x = rect.origin.x + thing.width_ofTitle + k.height.dot * 2 + k.width.child_gap - 7;
		}
		return new Point(x, y);
	}
	
}
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/debug/Debug.ts
```ts
import { c } from '../managers/Configuration';

// query string: ?debug=p,action

export enum T_Debug {
	bidirectionals	= 'bidirectionals',
	preferences		= 'preferences',
	hide_rings		= 'hide_rings',
	component		= 'component',		// S_Component
	fast_load		= 'fast_load',
	segments		= 'segments',
	actions			= 'actions',		// state logic of actions
	reticle			= 'reticle',		// show center of radial layout geometry
	action  		= 'action',
	bubble  		= 'bubble',
	colors			= 'colors',
	cursor			= 'cursor',
	crumbs  		= 'crumbs',
	expand  		= 'expand',
	handle			= 'handle',
	layout 			= 'layout',			// branches and widgets
	radial			= 'radial',
	remote			= 'remote',			// interactions with remote (databases)
	signal			= 'signal',
	things			= 'things',			// properties of things
	build			= 'build',			// completely reattach graph and its entire DOM
	error			= 'error',			// async errors
	focus			= 'focus',			// watch for and log focus changes
	graph			= 'graph',			// size of graph area
	lines			= 'lines',			// alignment dots for lines and widgets
	mouse			= 'mouse',
	order			= 'order',
	style			= 'style',
	trace			= 'trace',
	draw			= 'draw',
	edit			= 'edit',			// state machine for editing
	grab			= 'grab',
	hits			= 'hits',
	move			= 'move',
	key				= 'key',			// keyboard input
}

export class Debug {
	flags: Array<T_Debug>;
	constructor(flags: Array<T_Debug>) { this.flags = flags; }
	hasOption(option: T_Debug) { return this.flags.includes(option); }
	captureStackTrace(): string | undefined { return new Error().stack; }

	get graph(): boolean { return this.hasOption(T_Debug.graph); }
	get focus(): boolean { return this.hasOption(T_Debug.focus); }
	get lines(): boolean { return this.hasOption(T_Debug.lines); }
	get trace(): boolean { return this.hasOption(T_Debug.trace); }
	get cursor(): boolean { return this.hasOption(T_Debug.cursor); }
	get radial(): boolean { return this.hasOption(T_Debug.radial); }
	get crumbs(): boolean { return this.hasOption(T_Debug.crumbs); }
	get reticle(): boolean { return this.hasOption(T_Debug.reticle); }
	get actions(): boolean { return this.hasOption(T_Debug.actions); }
	get fast_load(): boolean { return this.hasOption(T_Debug.fast_load); }
	get component(): boolean { return this.hasOption(T_Debug.component); }
	get hide_rings(): boolean { return this.hasOption(T_Debug.hide_rings); }

	log_alert(option: T_Debug, message: string) { alert(message); }
	log_key(message: string, ...args: any[]) { this.log_maybe(T_Debug.key, message, ...args); }
	log_draw(message: string, ...args: any[]) { this.log_maybe(T_Debug.draw, message, ...args); }
	log_edit(message: string, ...args: any[]) { this.log_maybe(T_Debug.edit, message, ...args); }
	log_grab(message: string, ...args: any[]) { this.log_maybe(T_Debug.grab, message, ...args); }
	log_hits(message: string, ...args: any[]) { this.log_maybe(T_Debug.hits, message, ...args); }
	log_move(message: string, ...args: any[]) { this.log_maybe(T_Debug.move, message, ...args); }
	log_build(message: string, ...args: any[]) { this.log_maybe(T_Debug.build, message, ...args); }
	log_error(message: string, ...args: any[]) { this.log_maybe(T_Debug.error, message, ...args); }
	log_lines(message: string, ...args: any[]) { this.log_maybe(T_Debug.lines, message, ...args); }
	log_mouse(message: string, ...args: any[]) { this.log_maybe(T_Debug.mouse, message, ...args); }
	log_style(message: string, ...args: any[]) { this.log_maybe(T_Debug.style, message, ...args	); }
	log_action(message: string, ...args: any[]) { this.log_maybe(T_Debug.action, message, ...args); }
	log_bubble(message: string, ...args: any[]) { this.log_maybe(T_Debug.bubble, message, ...args); }
	log_colors(message: string, ...args: any[]) { this.log_maybe(T_Debug.colors, message, ...args); }
	log_crumbs(message: string, ...args: any[]) { this.log_maybe(T_Debug.crumbs, message, ...args); }
	log_cursor(message: string, ...args: any[]) { this.log_maybe(T_Debug.cursor, message, ...args); }
	log_expand(message: string, ...args: any[]) { this.log_maybe(T_Debug.expand, message, ...args); }
	log_handle(message: string, ...args: any[]) { this.log_maybe(T_Debug.handle, message, ...args); }
	log_layout(message: string, ...args: any[]) { this.log_maybe(T_Debug.layout, message, ...args); }
	log_radial(message: string, ...args: any[]) { this.log_maybe(T_Debug.radial, message, ...args); }
	log_remote(message: string, ...args: any[]) { this.log_maybe(T_Debug.remote, message, ...args); }
	log_signal(message: string, ...args: any[]) { this.log_maybe(T_Debug.signal, message, ...args); }
	log_actions(message: string, ...args: any[]) { this.log_maybe(T_Debug.actions, message, ...args); }
	log_segments(message: string, ...args: any[]) { this.log_maybe(T_Debug.segments, message, ...args); }
	log_component(message: string, ...args: any[]) { this.log_maybe(T_Debug.component, message, ...args); }
	log_preferences(message: string, ...args: any[]) { this.log_maybe(T_Debug.preferences, message, ...args); }
	log_bidirectionals(message: string, ...args: any[]) { this.log_maybe(T_Debug.bidirectionals, message, ...args); }
	
	log_maybe(option: T_Debug, message: string, ...args: any[]) {
		if (this.hasOption(option)) {
			let log = [message, ...args].join(' ');
			if (this.trace) {
				log = `\n${log}\n${this.captureStackTrace()}`;
			}
			console.log(option.toUpperCase(), log);
		}
	}

	apply_queryStrings(queryStrings: URLSearchParams) {
		const query = queryStrings.get('debug');
		if (query) {
			const flags = query.split(',');
			for (const option of flags) {
				switch (option) {
					case 'bidirectionals': this.flags.push(T_Debug.bidirectionals); break;
					case 'preferences': this.flags.push(T_Debug.preferences); break;
					case 'component': this.flags.push(T_Debug.component); break;
					case 'hide_rings': this.flags.push(T_Debug.hide_rings); break;
					case 'fast_load': this.flags.push(T_Debug.fast_load); break;
					case 'segments': this.flags.push(T_Debug.segments); break;
					case 'actions': this.flags.push(T_Debug.actions); break;
					case 'reticle': this.flags.push(T_Debug.reticle); break;
					case 'action': this.flags.push(T_Debug.action); break;
					case 'bubble': this.flags.push(T_Debug.bubble); break;
					case 'colors': this.flags.push(T_Debug.colors); break;
					case 'crumbs': this.flags.push(T_Debug.crumbs); break;
					case 'cursor': this.flags.push(T_Debug.cursor); break;
					case 'expand': this.flags.push(T_Debug.expand); break;
					case 'handle': this.flags.push(T_Debug.handle); break;
					case 'layout': this.flags.push(T_Debug.layout); break;
					case 'radial': this.flags.push(T_Debug.radial); break;
					case 'remote': this.flags.push(T_Debug.remote); break;
					case 'signal': this.flags.push(T_Debug.signal); break;
					case 'things': this.flags.push(T_Debug.things); break;
					case 'build': this.flags.push(T_Debug.build); break;
					case 'error': this.flags.push(T_Debug.error); break;
					case 'focus': this.flags.push(T_Debug.focus); break;
					case 'graph': this.flags.push(T_Debug.graph); break;
					case 'lines': this.flags.push(T_Debug.lines); break;
					case 'mouse': this.flags.push(T_Debug.mouse); break;
					case 'order': this.flags.push(T_Debug.order); break;
					case 'trace': this.flags.push(T_Debug.trace); break;
					case 'style': this.flags.push(T_Debug.style); break;
					case 'draw': this.flags.push(T_Debug.draw); break;
					case 'edit': this.flags.push(T_Debug.edit); break;
					case 'grab': this.flags.push(T_Debug.grab); break;
					case 'hits': this.flags.push(T_Debug.hits); break;
					case 'move': this.flags.push(T_Debug.move); break;
					case 'key': this.flags.push(T_Debug.key); break;
				}
			}
		}
	}
}

export const debug   = new Debug([]);
```

### /Users/sand/GitHub/mono/ws/src/lib/ts/debug/ErrorTrace.ts
```ts
export class ErrorTrace extends Error {
	constructor(message: string) {
		super(message);
		this.name = this.constructor.name;
		if (Error.captureStackTrace) {
			Error.captureStackTrace(this, this.constructor);	// exclude constructor call
		}
	}
}
```

### /Users/sand/GitHub/mono/ws/src/assets/seriously-icon.png
```png
�PNG

   IHDR         +�  iCCPkCGColorSpaceGenericRGB  8��U]hU>���+$΃Ԧ���5��lRф���e�m�,�l�A���ݝi&3���i)>A������[�'!j��-��P��(���G��	�3����k������~��s����,[��%,�-�������:t�}�}�-+��*�&�¿��� �������g�PG�݅ج8�"�e �Ų]�A��	�b�	�;l� �õ W��ϙ�2�_E,(����ۈ�#�Zs�ێ<5��)"�E�6��N#ӽ���E�k�ۃO��0}����*r���U��t��.i���e�i	�# ]���r
�>�cU{��t��7��+�ԙg߃xu�<���D��1_�
u~R�� ��*-�z�#�Mi*�ˍWh6�����f}�-gi:��9�f�A,���V�>�W���B�_-��%=�^�t�0u���vW���9�%/V��B�W�'�_�t����Mۓ�����P���\>����@��y�0`D� i|[`��
�h��h�������)�� �Tj�����0B��#�Ъ��hU#�~yh�u�	fp#�1I/I���"��0!� �'�Sd�d�:J5ǖ"sd���y#R�7����wA��gd����J�7����kʕ�n^:}nW��FV���s�t$gj-t��ԝr���_�װ_�7Z�~��V�5�4�V
}�o[�G�=Nd>�-Ula���Y5V�� }�x�g[����?�k���&���>��s�r�q߀�]�.r_r_qs�Gj�y�4k�
�i�QܟBZ�-<(d�=���dKO���	a/zv7��]�ǰod�}���s�n����?TF�'|���3Nn�#I?"�m�z����v~K=گ��s�l<b|_|4>?�p�ߋ�Q���r���i���������b
�2*���(��Ѧ��h� �{28�oI���y�es�8�';�Z�9���h�6�g�� �>�x�Rx'�b�8Ճ��WOϫ��[xn%� �|�^���z}��� ����%x�c��   8eXIfMM *    �i            �       �           ��'  @ IDATx��eE����g�JP�"IE����\��&��5g?�%�.XQ�Udqw�\�5�ׄ�k@E�\��"�(3�����S����_7�0�L����w��ԩSuu��:u�KIAD@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D@D`"0��E]��&0==����>[�����>[�g��`������쥩��411��=����ǟ���4�Ln�0�����4Rj�2�޸��k����ޝ��,�CJkߞ�"��ܕ�K�7�
" " " �� ����.�i�p�I��>��� ��b��g����I_ ;��@w���N&̡�4��=�����̔�6���^��^�CVu��z7M�unK���֔^�4D@D@D@V�@�/��[RMr�������l�<dM��K�����99���YWq���d1�mN��v���Z�nY���,�͹ڢM�aP;����nIi]�lh�W���PZD@D@D`&��_ԙ�������0'���k��������>�.���Qo=-����-�x�ʎ��6��g�W�!�A���p�c!X�.�~,6D}�Ԙ~�.�q�18���~�������M)=�>�{`0?IE@D@F�@��w��]�+" "0���Ǖ��O��K2�Oil��i��/J{���T��nn�C�9�����(�t�k)�&����X,��D�n�Xd�6���O���#�}��6f9eQ�[<n�����Δ6��^�pUJ/߇�E@D@D`�/�(��QD@D`��3|���3���l7B����'~=���o�����7���.3&'�j��@~�>��kDn��N,���
�;x���m�"�&l���\�a��?�_�������+S��X$R��!���C�C���#0�>���t��R������'.��'�;zz{<a/���{��*�41h]�l���0iX�ʢ��������
�ԏE���F�G,K�/'<��<6}���8ŧ���s��eq�(������|#P��ͷ���" " #J��J����x��ѮE/c�i[����p�e�Ғ%K�?�������A�8��pu��rh�6z�O�ԣ�y�}9�,C�,���ٳ� ���BȪ�����.��J��O�����HE�{�`�>� ��D@D@D`�$0���S�JD@D`$	���~<�n�2��� ���۶��p��uo?����#����-�<_�wjٲe��HO���+qG�v��E��NuݻW�a#�G*lb��ZC:�P;�姴�&Jk��C��c����Lۻ&�2��r���st�[���=��X������܃��E@D@D�~'P����M�Ah	IJ7leװ7��ą��[����z;x�=����׾����ȥO����z���EfW:�,$�N r�W�ù�T������Ze���#G�Z28��
Ԅ���6fٽ����ZYf�D�?>��q���ޛ����f�|���[U�" " "���[W]+�," " 3Q\տ�~�I�)��}�i�. ��B�j��Jo���:���#_~�5��۟�wB�%{����>W�L�q���	���C����1�K�	��ەFY�e_�I-R��NYki.qĝ��-Z�.��Ҧ�n�<W��fW$�z��[��)T��� �V�?����%0��{�X�n[s�7�:�ɯ��*l��y�?b�u>�܆,n���;�~WZdNܨޚ���oN��|��>9V����}��TW�}�?�eX�N���G�v�G�m3�u�Kβ6f{�o˺ih�'mI�n[�H7Z��>��UiX���a��ݠ쉀���
���nJ�}�]����x|,]Q��V���t窳�%O=�������o{G�7�y?{�_~ TG(LLL��~��[���� �(��p����p�붺�]����n�����.b^kG	�S7��u6�Y��(�)��@;��U.f@u�������w��^���+lb}���/ ��>���=�������$��� " " ���'���ŏI�W������#T޳y/j�{F'�ݷH� ,@s�wNg����H��Oӥ�����I���ҿ��GeZӃd}�>�������G�m0�Y+���t����E.,0�=VP��p4	�&<�OL��ؼ��H���t�-
|��%E@D@D�^�����ʘ�E@D@F��Xz�����}���p�+��r_�Lu��s׷R�F�_h�x����J?p�4555w��G|��K��;�(�����yo���I��t�� ��F�uK7���R:إ%Q���ӳ�ˣ.�`��oԈE�����sﺺ(��mW	-�d�u���ݞ阣����(�a���p�<췺," "�	���j삚�N==�_o��u�k�k�������kY�����-��g�p$��J9�1ݭ�C^�����
K�.�Ŏ]����_�.-������Ԫ#1���ŮcS�����Z�>u8��Sm��v�"B�.��Kqtteh��]��YQ��wo���[����H�k��f๶ ��R}��&���ý��;�$p�WS����KiY~��t���8m�+��I:j�I�.j�N_��fh���.��w�3�����Ԏ~�i鄷/M��������.��i{�qoe]홹�VԊłЛ����n��R�f���E>̿�e���ŀ3fҒDD@D`�	�o��s������8��~���ۧt��$�L���V��V~h�c5!�[�#��Ͳ�R�a�?O��v��X��O_�����~��F%^�������I�O���:�+�A���4��x �5 g�']�͈c�9�(t��(�7A�x�������<�Ei�}w�*��n[x����PD@D����yO�T." "0D>|fJ��!��[b�&�e�,�V�`�O���������~y�sЊ�u���Bs������ICr�6w~���xl��W7�{���l����^A-���P����<N`�(�E���a���_�������ܿ9����!�p���q����}�.����� ����0�*" " � n�����a���}���s�c�������t���2�X��������3��%t�Rz�jr+1'nٲe��o�b���o�}���)B�
 �M#o��ee/�:m:}6#9�6��(Q��H��FXǎ8."���)�#f:� G/x՞��Cs���/v�o�2'���y�}7)" " �@��s>�[}����ǿ9�~�cJ7>�V����s k�&,��,�(�
���A15#걌�Z�k?���bjE�Uo,�j�90#��7���ei�'�?M/5^1X��+�+��P��2�泂���Ƕ)uL�*&�m�)c�� � �)�xv�f���.(�4Ŕ�Q+������n���W:�g���� ���I�bj�C@AD@D`�	��j�wP�&" �K����W�4�n�f���A#��'`���ɟ�]��ר%�+ ���^u��&��aI����?�I\͝����G��^��Qad ~�����/�إ�4ݾ�Ϝ�1�Ez ��3F�K�N3	����V�:9�� d��y�{�����=�6��fK�E�N���>:����r���N��4���_/w)������[� " "0TN<�^�SJK��/_����L���Ցl�nu��5��_��n'jå��(����^�eh�e�M��0��򷸑dk������F�q��"�~���2/����?��Y����L��震�:^��-؅�`��ӯ�^�y�Џ������\<�몶��,�<l�������t�����G���XY�S��?�b��V�A�X}��q��W�" "�	|�k)�|���� �+�]��j9:L������}$��k�NaɄ+�9�Q+,�B(W��T6g0��-m֯B����[��;����G��?����mL�Ѷ���A�BP��o������ʙ�� ��(�F�6bt�Ye%�.*4v�^Ώ�|AiԷ��v�2�wXQy�Ҽc�Ǵ�Cn���c��'>]�?��ǐ��W��WX�B�����/�G��." "�	�o�j삚XQc��K��5�{�W���y��VՖ(e� ���H�R�f��>5x�?�3�VI�V[�\�[8����n�C���5e���u��Mi�]Km��l����s�;{�[8h�(�>���������[d|���eS����t��<���O~���Y!|ũ������|�����l�������j%0���j����X:�'��׏�����>xB��_�#p�[7��T�q�J���ܥ�-G��E{�~��"k3?g��L	�w�G����H��w �������%�j|�x�����"��va�!g�Ņ�uڡ��k<P����i����������y>~��,���q���IW]�i��z/�J�*���ŝ(O?���{߸����ߔ��x�+�WE�=2�c���q���z,"0��!|���'�g�������U�o�G�94>_%�_�a�a���D�j���z�/� j�׬6<�Nïm���F�sɻ��~ٰ���S��?��4>�8�>����v�ɻ|XY�ᰕ!1AVK�0���� Y.+�P�'g��fz�˛�/D��w��a�=;��=��v�7��wܕ�����ܳ�4��v�1jqP7�6��/I�E�&������&0�TkuwM틀��h0��I���}���ۓq�7��x��cb��ׅ{�tאP�O�sB+����O]�!���l������#��c��A;��[�l�����2}�~�P����p*b�� �]�*Ry��Ey�2�`�6@�?&��ۀ��9F�1���1e�=�e̷q��	�����Ls�'�������z*��πc�w����+
oN�}E~���}p��D�m[ػHL�0+��Y�*�����Y�L�f�I���&`��S���g����k�N۟���x�y�4�\�V˕glby���C�5�ܖ���W��q��R���Aܿ�Wr��+�.�����z�N�W8c���irY]���Q��Ac8�р�l�JC��q�N?�eH��7������`zm7�� ;3tl�a�D�ZlN8��5/�=a�_Y���A�{M�A��C���;�ٟ,� ��c�<���a��*�D@D`M!�_XSFB�i���8n6�g��+pc>������}#�9G��<jE�z��lyX�c_-3�Z�
ۖh�9n맚;���B �is�'��K��[����Їl�N1���+��=�s����Ӳ���le�.^ms����|d������K9��k���e`�rKz��8�r6�Q�t�r�z�jo�]�"d�a��%��XT`�Y<m�AX�΢��k�V~!@��Z�-���o�5�{��%\�襾�����a��P�0f$c��A����t��B+_�ֱ��pqJ/��
D@D@V��D@D@V�p�j͞h�9'�K�شy�#m� ������r��u��������Wm��{�2�s���[1�P4����me[��q�H�������[o�3m��;:~��Xظ�mt��3�~�����u���<^P�1-�?d���bЛ��W�c��F��rc�L�Z̲�X��"B�6ڲ�����-Ħq����O�9��ߴw���4);����1o<�ɓ�\1�(� s��}��~��{Z�3Q^D@V=�9�j��q� " �H���������� ��#�V�/�~�;��� Յ�dp�4�Sq�}͐�"A����h�2ƨ�i��@��@��{�����_���Uh��%��o˿���G��2\��S��}N�8�(+ܑ�8ù*��c�2s�-�4b�)�эU��zH�5��F�a���66M�ܮiB��]9��Uن봊0�,�8kpM[�����C�o_�����h�S8�p���?*B�wG~1�-;�����;|졋����6�����R~��?{����ƻN�pv=������lq�^�VeOD@D`�x�܄�Ϣ������?��t�ٿ�ъ8e���@q����O�QV8�o-�n	���
�#c�q�x���ĝU���Ķx����_����z�`ȷK�.M����#��z�0���*���=�C������������wy6k�Q��]��v��[��I��c���ұo}���w�3��I ��t������v��Ĵ�~[�c1�Gfp)��+��zg ��v�_cȷ� �#v�2�D@D@V�`UP�M�l�}�%߳"@�������)2>�.��I5[�Z�Ly�/�*�u"e�Y}Z���o���c�1����p���|�k�Q��>�'#��c�?����������.P�x�P?�N_��c0��kΣ~{��\�
��1�7�\��=�*�7s��Y~��yԏ��_����7�A��� �T��ƛӖ����ˁ+�]��g�	s�C�mG(�9|�Y+��\��K(���6`7�U�N�#|)b<��Tz�f,Q," "��t�j+Ϭ,����h0���`��B�?����X2��0�1Ɏ	x�!�k�&�m@�.��-�t��(3��ᰍ�!ΟҒX;�-��~�Ÿ���#�N����O�ܔ_W��>��U���f �������@=������6m!����my?M��|E�Ŗy`ȜO�5}�X`�ŗ]�ƴ�&uZы�:8fdxl� �S��;i�͎�a�zܤ�������9�G�
M��GD+�g(�SA���>-d;�qme��c���M��c�N��ӳ�"��@@w ��2!" $`>�;,}��5>���	N�1��d��4��"��xl�5�]��ӛ��ʠ-f��_����[�3z�U�lq�?�a*�4�j���As���w����ye�O'�h���}����^vUƎ?��md@'��|�ù�0��C��M��46����{_�-z笐z~K?�b�2��09�����T;�0w������|B�{E ?�3�n�%����՗�ޟ��3�G�bL��n��Gi;�\�f�&�U��O��]�aL���n5�~�UJG.�I��PU������"��{�K�" "0��9�/��.]1�-�ܚ�t�M������g/���x��W�Ě�{ܛ�sRN1^��q�Q��9.�9�m�U�VVҜ�{��A��	�>{���G����~����G��c��.\� -]j?�G6<9S�;��xQ8M�9��,sW��̲�;�Ƞ G��,��<q�;|�s! i����ɦb��S*m�t��sb�x���N�>���ϼ�_�������I`ѢEiɒ%鮻�N[m�{�]e��[��x��C�����p���v��~�^��rZ����Ѵ��ǡU{�<�!A�%.H��^���]J;ۻ��i�� " "p�	�g�{_[5D@D`�	������\U^��Ϧ�}�G>�m��ŉ��k�Ƒ�5�9zD~�
�|n	W++���d�>����`�En ��k���̻�x�-�~u�J��b�ެ1���t��7Z2�YÈyGg�s�ݹ^�W��\���<�w:��L����>������/�#�6���Qfi���[��[6�&ݴ˖��G�$����l�+}p�w� \x��IO<����owx؞���e�v�jy;¡�J|l�1�ص�V���M�{� �a��V�G��U)��V������=�9�=�ICD@D����}0#]e�?�2?�ϩ/��Ǵ�>S�h ��O�y�G�t7jV�o�]-��O�Y���q�9gG���%8}E�=��"L����Ž�O��9�7�{�l<頃�����ob�]�Q�E���
ӑ�-ڃ6�^�d l��##Ѕ���܄�_/�
n�U�?[��.��.��Z��<�r��g9�~���)�[���Rz�cߗ��O��G�a�~\c[�p 2g��s�<E���B�9�0����Cʒ|�xE�߸m�'���R���t��������vyt�#" #M���c�[�/�^_&�uB��9)�c�I~̨g����h����	��ƍFMR��ǫ�Es�"
��q{�����hs��[�H[o�6�s{�A���h���b�[y=H�j3K����~hD���)�D�+��zР�rOXwX�+�wL�O��!_k������*��3���?���ǯ�w{f�^f�>� �����sD�G��+jr4��-������q��.�_�/t{R�$Q[\j�
ع�������Lz�L&����@��9��$�����~�
�ٍi�{fw�=�SݙN]���Y>�\�9�/E�7�۵4bC�El�e�g�Ș�8�����f���KK٠ߺ�W�����?�L������-�?>��!#�ձ%���a�Nw,�%n�6�3�����-���].;M������!�}䡇�L�h8�a-�h�L��:�6�h��?���� �/������'�{r������'�ys	�����^B9� �cm��b41B��:����GE{ԎҰ��� h�k�g��nEO�n��v���O_5�G��LD@�� t ���� 6�^�ķ(Ze������i��Dx
ܮ+�ΐg���?Ϟ9y�3�Up�w�%���/��>bbc}�ۿY�N�O�Qn� n�y}�x5
l����;o�^����Ǣ_bw�9j������A��{�6�MԌ)�)�Y������a�_�wd��r��B˴yPdK0;��(�q[���w����c�����C{+)�S�l�t��?���}nO�t9'X�i��*B��u4�8���~,
T=J<CH��e�w�E��)_�����Z@w�h ʶ;/�C������@�yT<D@D@��9�����_��o�z�t�yi�=�?i^���݀3�����\ܖg��F�)��4θm	
�2���oYS�pP�-��[�5\^���	�����̴:q;��=픀�Az�<Ǐq_�(c�ʐF@Y�ieH��I�٢1�y��B�R�������m�݃�7������VVj,(�v۝��9�:�P���y~���P��������] �����(��F}��%���n�,m���� �b+�XvZ�,�ʮ|̄�z@J�_P �8���� ����'�n�����1�r:mNry����#�^�c�s���￹?&��m��[{����&T˝��^$����Z����v�;n�g����T����0$��~�{�u�~���F |��ט��x�>�h� [���ju�*oːf���|Nñ�#��t���RO��=�ͬ�s���Y���gp�4a�Vw[`! �_�s	b��y�'�j6Y�s����P��Lz�[��kF�Zy��nĻjW[K�6'���ڷL�G����R[QJD@F� Λ
" "0���<�>�=�v�W��<�����oNǙ��f����\������2���`|��?�sp9�T��6^��iCCY�X!�1��:%�k�q[��v��̀}�>�<Sc�K�����}9�۝1�o˄iƃvyE�ٚM6W�3Wy[�4?m[v(�;�����=lo/����$Zu�+���y�K?�~��Ҥ=Z�2��c�Z���>���>,����<Ӧi2�el1����/���-�Q9�F�-��!��pO�^l!��p�d��)�sPJo�%���./I��8����U6a����7k��cxˇ�n����5Lrq�>/�a��vٛ�|r����]��_�G�����}~��Yܤ�:(�����7lWu٠J���F�hܞK����1�_�ڋғ��pw��!�k��͏L˖r4Wp��9�t+��y�\y�f��j�Bt��&��ö~�
��f�gg�2�����nޓ6����|W�B�6�I�# ����l�3�C0�����G��a)�EYH�e�i����=�L�Aߞ/�lA��Qٖ��]�S�Q!�����s.���Y��k�����\�}� �ռ�����Y|/񛠅^�{��>o�i/��8*t����uB
��?��Z�^��n��,2m�up�?������i�=��?no���ښ9�� �Q�8͝,|�c��'�j��Ӄ�!n?0��1l,n�YZ#ց$�Y�y�.+�z?_�L����N�?l븅}���-�����pЇ�-���	S˃B�c��~��q��V����,��9�F?��1��P�ù#r�E;�S�k��6�=�^�ݢE�����<�@��<d�<2��l���S�Q �_�Q�>��8s��e���Tp|O��9i��f��'ܥϜd���|ՎSg���>���\�^��x�l��h���v���F�W�ԧ."o��M�Z<��}]	W�q8�aY��ا�׳�a���i�P���4�C�����e�9�^f�66��h��L�w�@�	���i��m�ȕ�4\�w���t���IK�,I�-j,+9��^O9)���+����y��=1��+��g-��m�ϥ�����&:��~����r�,JZ�i��˳%�x�R���#��O ���i�垇	����Y��X�8ZC!����r�ſ�e<}�Tz��)=�(W�a%0�T=����U6Q>�>����?�W�����}�pr��6^n�+r�J�?��Bù.绞7������y!`:{��5��k繵)C�ޡ?�A�6�븂���/;���3f���л���f.�6��������n��;���w#0D�y�v�\����z&@���x�[2Y�Vfw{L�A�~^���*��)��ĩ���8՝H�t:�@�1&F�Y��c״�4 dM��"$�&�1�1�9��e�=$�Ȣ��(�l>z�M@ZeU���*�ڵ���P�n����e�7�n�4�==��^�rV�`XGV�%"�+d����,�=���+��"���o ������-'���q6��\˸2'��8�f�Ӭ�m�5����i�y��߅��A(����@�>���'v���-�����=��82��8ȴnMFg����y[X�r��q���������P;j<?�i|�+�r�:VVl�^�	��#^ni�e��	��K�)�(:�� �{�{g��lm��-�9gj\�*������F��A,���/�O|�����B�Y6�q�A��\��F�O �0��ъRdY�N?4y�Al�k��K�H�n�qK0JP4E��Ys�Ak3Z�1�/=���C�X'z��ݽ�y�a! M{-�ݠ=h"��ś� �ɻS��~5�U{y�6" "0$�{�5$����wl}��x��������-��j�������}�z>�Y��v�"�9Lv=m�l�m�4]Occ�U[��,C=�F:
��l�X�����R\��B���_��3�Cx�?�kܹ��a��B���i��� !�&�u"��p���ՃSH9�Y��aV�m[�9���xMʠS��nqc�8��΢t��^�q��}�mϗ+,�����c�G�3]�[{a��wFL⅙1$��q1E�/�$��~ ��1�w�&p�g��z����k�n��YOX����n����7�u�Qdj<�Q��;�)߉�g��jC�ZaӐG:��{ɲ�Z+�K�L�H{#�#~�ҋ,EJ����<&О��n��" "`S����s���G�����&՘��ն|�mƾ�3\�в���1��V��-k�`Ssu�G+e!�3�)��'�
#Y@�n/�t}��D�(�^��=��C�a��=����^Z�W$F'�x�x]�tg=�����a	d��v ��u1�(ͭ!�e���6�m}�r�q��q���b|.>��i���qwU�mz ��`.[6��u�G����/�4FS~ZVq�dzu(B�˃�?`�A`�XpsI6���x�1EE|�j�A�sU�; �*��%��SҬ�8땸�ECn׿Q�oG#�t���v%��c�3���;Q�ij!^�~J��ҿ��J���J`�9q���-"0���?�v���������MK�d��/>�7I��#��(�j�J)ɉY�u�f�q�S�6��x��fV�kZ��+/}S�����`���] ���}�-�[���t��;;cZma8�1;S:`<+����A�#Qk@J;#=֋t�M�	K�e]�l#��z<�>f,�bo��g�]�������c�|��_"�tӭ�Q����tG3?S�sC�#��[�e��q���c�ģ$��cH#0f��֭�@���i8����fT봩����m�[^se��ZJd��>㱔xD�ʢ����0=n{��O�� �3@AD@�'=0?�M�06�~�E'8S�l��f���me��3v��q���i�Wo��H��?��$ZL[��������8H�r�YM���ە�)�.lY8�m�~�|X��?n�F���O��rG<�n�;G��!�H�1N!	��-��3�/,@\�n!�g��uQ��h��4�H#��b��R/wU������Dq$Qf�	��v�C�)�?Zu�p̷���v96���7�$��8�2j"� D�g-�*1���ѼpKNa�<n��@}?L��&���Gq��	I����Г�-P��K��P��=b)	:�Q/�em`�<Ĵ�|�����G���=��=�d�xG���H�X�bu�" "0�<7��.���@%`�,7������;��CL�������,�&��F̴+q�I�M���M�K=��]���y>��2S�dL���}j��Tc�b�a޽�>s7�鷖A�����.����UZ�h��ƽ_�d�a��[x��aCjJ�W^`bp�Pb�[�]O�~6@;�we�z������7��ӓ��)��M�ZR�`яW�y�'����:1&�fE
ǌ�<��o�%�?.P���I���(�7d���a}Hz�m?6�Jlr�b�)�b ?PC���L��������"���0Y4dػP�s�/�Y�3��J���0�Pw(�j���#��Ѷ `K���!m(��@`�)v>t[}U6i>�>���t�3�݈����noնkN�}Ι'����e�r�XE�(���M�cZ_eu�ޒ�rV/� ��z�:��N�t���i��X�����ww̾.�+�׳~x�=�=��-5� \�����S����J��^drh�Y�zn��(gĔQ�-c9��(A6 ����h��6H_��h��W������[nM{Ա�_�y ��[��Ǯ�1�l��;�*s|��գ�v[�y;�x}�e۬��맩cq����F�z��)A~Pղ�����eگ�~��!G��ԋ�y1�m~�J_\���JVn�\jw��VoD@D`~���G��K�%`祶�'���Vq8�������SUD���:�eE�m��g�6���x��CFB3��D�#b]�'��@�r8�V檶�U��~Ȋ	f�x��T�[��������:v/~͗l�Z3�^L�@:�v�cS1*�,R�nV��(�v��Dq�H�b(�սR�59����"�O��ڡ����\i�����X����.J[o��|��
��l�4*����8Hr��8U�2���nS��ж�U�J��/N�+�|n�s�c�U�"��`2o"<���cR��`��Q�Ofv7:g��E?�Ϛ<����!g�v�P����~�r�v��6��詝w��ע��" "���; �ܱQ�D@��X��L����&[t�����~��<#�	'&��b�\"�7��H����
���#�`��t1b���Ï�쿫TC�=�R7��%!GE/�ʝ�������O?)�|��y�7`��<�x�"��xo �"�2�4F%���v4� d�v`�����6X��Vm��X,b:J���ev7��k���p|�ϺS{��������S��q�)w�F����D�4�  @ IDAT
b�LGc[�W�｟:�� ��<�̔P��5a�
a|�C#��1�o�>�"d^q���ܜ�$c_�P���.c�<2Ԯx!r��ڥ8FYDJh:�LJB��%ڡy��I��,-�N���=�9 =��û>��t�����OϽ�5�� ּ1Q�D@
�#oK���Y�R�l����2�}���klc��n�?r
�Ok1�Nz�3#6bڊ��J�<7g�!A���Se� ��lbPyS�؅u�Y+��㶉�yުC���7]pޯ���)ط�x[ZK��Q۶6�X�AmZlJ�-��([�������V�Q��m�H7+^��N�9F�������$��|���Gt�����g��r[М���du��\r��/��=��b���9���� Yu���ր;��녬�Qn׏	o���2/������bQ�@����� ��~���(h�l�6�Cm���L��6K�P+J�b�G?�!���<m��z��q�7�`�>ථ��~uGIX�� ��@͋��$0�N��t�x��t�b�6����C���a������ˤ}�k��d�t��;�\�n���9Q�b������C��ҝ��mf���C��Ův�^�Dgh@�y+¢��_�E_�(W>�:�Ǯa!�ԇ��H1x��c<1�ǅ�q�Q�pXЂKi�FQ`%nǼCf��Џ% W�mS�;D�j.�2�����̙�;�w���O�tԳܱ�\Ev����������L������-vp�z�������E��BV�Q�J^�+3�/g�Ed���H���,f}h�U.i��M��F�|���2�o�q�K��Д宙J,���������uykܖpK?B�'�&܅�������f8���;�!�ɢ��y�#�=x	u�����&���=j_D�!�ٯ,H��,]�1���!��ݶ:��>�����l"j2��z���<�>K�T����m��G�YKf��룤�/�������d�.~�ވg�+K�y�^C7����׾yN��W�[Έ��$˻�E����eY�O��X����^V
t����gU�PuZ]�^M���κޗN[��Ai��5���o���Pw�i��u��P�-�����)�q�)���gl8DL�A���rʨߖ�o��U�9~x�se���b5F�$jx(�Yݎ�r~��P�-ا��Eؠ�lߛ����"���N��pH?�$r%n=����N��~�[W����T�uZw����7���qG?����~�ϱy��y��/�s~�be�����&��UMX�E@���[nO?4��q���/����gN������x�m�W�{�9���b�l��iGh�B�����D��cB٘�wDA��-��Aի��,�pL�-�җ��ц�g���pl��e_H�La��]��3i�=�
|.4f.!F�{Ə'��Q�ӈ�N#k�,��<���������o��m�?����P���һ��t�;���=�bx\߃��*�� �C;F�:p���u� ��|�N8*#j8��0(v������A���T֡]����V����Va?)�鶢-��El��O�)Ӓ�)~��r�X�f�碀%=�����o����g�|��J�"G,����� hli>�����@AD@V- ��jSD�!��KR����ӝ.��q��a�����������΅��ظ��j�w�Z}����S؜/e��i8��V;��%��:�~4�&g��4�ַ�����Gd?pŎ������Ʀ�	��*�4��'1�o�����7�������Ts� ��0�"0�$�e(������ecy˸���J��-z������^{y-�^{l ����W�����~�3����qc�'����e�x���q����W�26�^�
q�5rb����{���%� `Ƙ�EM;/�~�k��Ѧ�mZA��;�ma���7;e"bȢȶ8��"{�m�҄up��İ��q�?�����G��߹_���ۇ�ޖwsP��������Cv��" "p���I[m���>9���S5�|9��?*`���]�u����zy�� ���¶A�<#.�Q��N���:�I�Wsj͆�V�)�5�փF-���R��n��lӍ�����u��3�B����p
�����q2A,��V^�V���
0w����C�zLa|a�� S�5{�t�;��4FO�+�8�(��g(�����`(�����!��:�	B9�d���/�`@u��v�R�C��*ˆ\di?����m]������Ă B9�?�B����J1�I� [�`Ǧ�Z�w�v��F�6`~b�IP��-�î[����P��J��묺����.3���w��kF�E@D`&�g�H"" ���X:�')>�y[m���q^���ۖ)���w�i?�g����cg:;n�X���X�^u��ZbЃ[��<�LC�%+�����u���'ݶ�i��'{�^N����/y:2��y\�.<��st�6C��|�[-�:�1�Q����[�,�4��W;��^�P��!�@������+�+v���~�e��![oõӗ>�B�)�
�{?pF:�l[�ˌ�=�w3��!�K .9�ad��>J9���^`9���]�a����=�B4�c \�"ԏ3M��1%���y�(���υ�(�4��sSQ�[���1��2>���-���e5_�'��\T���/��ݎ��l��d~f��ꡂ���t���Z-����2�:���܊�[��}
�JLѐ�\L�ֲ+j�~wݍi�^��� �˳��$�A�nt�t�E=�Y��n��kIM��\�f��co���%\��"����$6&��} h�,Y��{�)��n��2��_�/�3&.Ǹ"���:Xx�	� 鎐�-=���c\�G9b�`�����i�.����0�۰([�>�b$j���fn����"��wL����Q�`�3����)�E|G,�����Ï0S��E��-�� (�z�����.���.b�!]�"��#MAʺ��mZ�m��1�C�]�w��c�JM�P6�7��4���Gl�Q�.YT�=�A�ò�-a��ǧ������r9���h5�������Z?�6z�����:�9rյ"�" "��vuJ7>�~��b6��P�bPH������1ϳɪ���|������"�
!O�1���Q���4��}f���Z���|̬}�gBt���pt�q��(#��s�|Or�	7��)�ء�����_v&S�������p>�i�ںS'�y"�4���������0�x�� DҲ.Alu0^!`}�K�^j�Am ��?�;ٞ�[_ab�Z��~Q(�ж�3�w����?K<�C�nc��w��>�(�'�G��eYn���E>[r��f�jT���G��c���:��w��H�:�[r��N�YάǱ�^��<"C�Zm��ؖ��b��z�����" ʟCߴO���w�O�i�-6�bl���˾���5�:;^�_[Uc" #G`8/���0j�E`�%0�����t�Ɠ�$�����1٭�vO0Ƃ������mbT'���<Js�������'�>i��G�l�[&�1��|��:���[Mz1���	&o�|���	ι��)pڎ��Ő+��,>�I;�E�Ra��;<�}�]w�O�'��aw�h�ng��<X�}k�@bZp �EY�r��r��:�ΐ�ݬ�;��X[�P��3�vS��s_��O����ոr/�)���oG/B��6^����ǗǄH=�e���Ǆ1�s��ȟ�(+��(�1��Z����������\ߝe�˶���X�mZ���9?i@��ج�(����牆���붬3��0�Y�E ���d�H�Y��>y��)'=#���6���x)����^��gX�O����kR����!���K������X�l3LP��~��Ŭ��K�1k�cr�s<L0��n����|b\�}�{߶@  �R�H9��}ZYܝ��
-l\���9ۄq;y@��~L��?�_-�d���	�-~Ǜ�Dա
x��uG~��	�(v�T�a'��۞md]�de�8'���q�D+�t�6��@��+&p�\�-Ϣ�ˠ^+C�쌭���7�>���GdӾ����G��/���W�	�|���X�,Qަ�!kw|i!�(�n�����ل.ǖ�G5��i�k.R�>5��{;��x�go/+!]:ci:��Pe�t̄.��^g�U��o���JK�^���?l�������E�f�^�o�kR�Y������5�S���p��p���B�0|��v�W��ʯ�sJ��p���.�~���1�|��bs��5�v�OW���t8��c�H{�c?�C����C��8�x��C�e�R�sv�)��� �bbr^�P��<i�{n��>x����wF�Ѕ/}��⋫�1��]lǨ�2 ԷB�E��Fk�
�l���a��߈K�o�y�Plқo�q���G�����0�%���w ���3}�[���3@�.s��Ɠ��0�<F�+M�c�%��;_�2~~0��6c�Vq^�Z�W󖣵�{�N�D/ѱ9����{E�/L��69�fY@���s�✒�zT�P��EX����#m;���6M��?N{>y��]�h:����#c�=��}��>���P," ��� �=��K��t�ho{���o�m帅?��<Y��F��Ib��B/9~>n�����<ٸ`�-���tB0`���Eת�q.��;�V�o�7[�e������bq^P7O�cҟ;�6�0����z�>Hy���t�Xm�ǟ���m���@�X���D}����y���dmy���N����?8��>�H۸b���(o!�#���ޗ.:�*S7��rؗ�cA�eb�h��Ҏ����S�aX�1��5������c˲3�ӦB�����Slm�W��;����0��f�l�:�2-�5n���mQ���㟼&��������ݙ�_�����lni�Ob^~�L����`����>vR)ӵx���<AeI3mv���1��p2�!��8϶����*��!�n{�O���}�<�.j%�s>��,���{�:�б'�^%��E��,3�q�`Lc!����s��y^yck�=��G�>s���N�lT�
M�����|�Y��"�v�G�t�D+�ū�N��!i�MP��m\ˎH�. p@���g�K.4��[pP�A��[���9��于{�0���=9�iv)��k������fa�h���c���&����E�=����i���"�G)r�r����[d��w.س�c��?�p��Jw�~B���;�])�9D��\;�NnJ������ +BMuD@z��r<]�PN�ڕE��(�U����|��r�$��e�l��ܶ9�����{|ƙ����ȥ]Y���-��6��{�;��
?UQ��ЊJ�u�{"ۚ��ؔ�&�1�m�f57���6Ol�n�3ɏ|���ˬS�s�s�a��b�pl���Y���yШۖ��}��2��W���y&Zʾl����fײJ>�v��!�}b:h��|A/��W_�ްoy��>�����~3�KX�@�b~q�k�rD���}�(�q���C+eA����y4�xN�1t���׉c�WVTv'��Y���xc�b4��̴���Ѱ��A�I���Mc�������}���/<�|݄�ўgY}��W�����g7��]8D��]�	h�~���D`�L���8���x<]ﻆk��"�0��ӽ,��i;��41t�$&�ci�]M����{�=�:L'�b�#`�[H]8�2pcz�J����,��C%B#ɓuWd1b��o����T�:�*��S�,����p�-��#�����XXE1	1�0]d�,���~����[ҥ�\���Z�z��S��l�u��K]�3�p<}��?�[�['��[ߚvy�{���r|��F�$з@x����(ga(F�֏�9�@I,@�C�jΔ.X�-w�d��,ί��
l���]�"_$
a�e�z�=�e�-�����lcԓ���ɴ?vy�?�����#�����f�
ǆM"nϳ�|�����������ȝ����;Z �w��-"Pu�d�c�6��+�0o��C���.'}�BJj�&�5�����x�?��n�?�W�ٙqU�22w"	��!�Pҍ,�|fm�ZP�R�Sժz�JX���>d�=+�*��!��0$p��+��J8E����[�2 ���cf G�Qh�j%���u�7CY)�m�eX����z����28Q����� '����+��8W���p����X7�_�����̹/�-?��_���\���Acj��[��0�JH�n��J�W��@8��p���B���`�b�G��/�O�Q}��m�8��7�і)�}�3 �J|������:��;N~y���ӏ0�������e �;F?;:��=��pJW��&0�N����z�tܱ).�L���1��5��\��1�k����'v9����n���'z�����C����ŷ�c���0s�z�>�7�x�d,Y'�ԀI��I����!�:FUww����ۃd�l�g�­�ݞ�:��������<vx���Yɑ�P/�P�B?�����y�R��6M=�(k�sڝ+w�����ĴϞ���G�:�|�ȟ��c��58~��yʝz_0�p���g6C䗵�Y�4eٶ�C���Q��1�%��OUͲ8�x.F1�{��+d�3����c��:��B�����v=�"��}�����!�=�ŕw�����������`*��s|���nN���Gw���" ���� ��Ĥ/#M����ҥ[M��1���ɷ��u����0�ń�N;�����(�9���g�8���g�����^�&1��f��P´�q�˘e�ۯ�9V��ɸ�Y�[���e��Ȳvw��@ޠ~MF:�h�Go�*��4�Î�FEe������%\\�Di��4c�f�1����)�#�:��P��V���l�A:���|Q ;_sY�2~W?�%�H�9������pX���g7;)F�1����8Q�n p��ۿ3��啡gB���Y��5Q�b,8 �
����D�hæ�^��B�lK=Ӵ>c̣BD��|���h캂w�Bd ��K��b�;�����W�y��k��(�]�w�W@]4�g�O��u��{&���=kJCD`d	��ϝNW> �P;��Ƞ�I+����u�Є�N~���;�aY��������ξҮ^�*W��h	�b&C3�䪾ЙΛT���Vfm0�.�,��9�N�6�#\����6[o���CW7}�[n+�ox�N�5�Y��CҪ�9Ƭ^�pG�
ܱ��E����l��;����N%�����������w˺h5B���|�� �?�i��h��=�j�C%�q@#���(�.c7��sH��uy�A�W!�zW-����1�8���v:|�J����i�'=ү����[�"�C�{�ת0,�" �A@w �8j/D`8���t�渣;��@]w��LEbZ��I��:���g�?-�_2C�U����u�P�R���n�(��⚬�+z�E[ޝ9�P�1��	���N��Æo���F��ΈW5Mʑo�µ��t5�y���9v�-H��εW���w����r+�~1A/�:�G}�����A0�y�m?-���^�t�=3ě��)��̫�s:��@�H'�+� .JV��1.y�e/�c��@�z?p!�Cѻ ۹g��V�B�X���H!e�wճ3T�U|�Wޣ�n�6ni������dO�`�xZ�4B����JO9�י�D>	���GD+!�Ә��(ݿ"+��L��	��dw�" +��a�鎎���"��pfku��?5�*�=������~hlf�\�7��yǒ؋v�rS6|bB9Y����,X��m{:�L7���fLጠ"�4�;Hk0��>�9�wn�-MΣ���������x8@�}�V?��������Q�/�g�B�+S�bO�.�IG�c�#Lb�Gy��]g�Ei�M����G�vr���wޕ�~����fy�s$L��Zy̾?�ތ���C��7S7}���9���)(�
��#��/�y$�B��ԇ�	���gy.�X�Z\ԭ{�f�A`��u�(ǻB����ˏN췫�,]��c��{�r�U@+'e�2B]QY9feED`��!D��lc��ߜN��'��u+oS?L�f��B���DX��s�W�(a���v��?p]� �ܰL/��We�=�����c���B��e��)���4-�J���c��-�1��(�����(gg�X������+�tf0t��jwj���߷���K�J7\�=nG�]%v6y�S ���D�\LK� ��yG1 ��C�=�m ��=����
Q1B6�̸݇m�[�����ް߂��幅��|o��57���t�=���;�4t��qa=7F��y�ʽ�tc��!�_�����k�О}X�6�/g�*���H���!G���
���0��KbhF�`�^~o�����y:�S��ݖ�[�a�B����c؏?��U�9�ؾ�X�i�6#�" � ��h��"��	��g"]���t��?�9+>��Ť�Mh��&�����Kj�W��A��,�����nx��~Q0q��f�`��� ='�7�����Os�u�E+��+�~�2��uC1o�7�ZIT��<~.��>Z���{P�a�m�
�6�}D8�Y�a�)�!�G,8�x92~�G�(c��8s/i6M�b#˲�F�4S���������a-�h�ɺ�o��:"m��ff�j����a��/�8���_�1�3�K��M�ȓ��(Ŧu�4u\�|ZO��!�?a%,��;�V	�D�n�O�v��<�\`�V�}�p>���ի�l�v� ���;�-��b��k'S˦�Ƹ=B��,z����_���[��)��.��7`�&�Ѿ�o4ӏ���/WM�*"0�h`>���*����_�N?�a�����S�:��N%��4tYp���t;{�>���;︡���	�~|��������> ̉�g}%�䤻�z͢�DeO�>�(+��ľ�o��4|����a� �~m��7�|�KS*��qc�?~�Y��/�P$�f9�c�k�~��tx`�M�{���PO�Ͱ�~1�W� ��d����~����7lR��a_�����s�R:PzM/t�E8t�J�2L�(iV4���,v�Ϊ8�|�ή����+�ͯ��fJ��bu���>ƺ{���G+�]S%	�&`�+���S1�|A,l���髟}~j���|�BX�v���ko�c��Ud_fE@�	�<�'�U7E@V	��a��3p���4iK ���\r*�<��c��b@�����0ecN��ʉ�v�q#��$}�����{����^w����;ʠ
��J����1���rM=[Ɏ�)І�C~@��x���C=��C����������Q~�{>����w�U��Xv���� ��`!06�niᙹ�����e��u�O�c���n\#d���m��!<t���O+We!��F�[��!��{l�9�c.ΐ�(�EvY��M�&�%4%M�*7B.ܙ��' %|/�wsF+��O�\�Ga�P�ϖM����e��|�G�ٷg>�Y�K���i�m�J<�ȟ�jA�UD�]���Ud[fE@�	�0OJ��UG�����[�Kx�&��~@��C��.�T[�⃩^��C;�)u��^X7��YdN?�X���J�!��-�o�=1�P�(�ss�3���弊L����;\x/FW��V��W�ѴUf��n�����ڭ^��؛�:���w�&mA��n��M뮻N-�穳��e��&{���-��� ��#�	�����&8=f����S?�	戠e�<&����X��q���c�1��	��2[[�4���W^i���a�2�+��O��������5W� �9�(�%d�崃D���b�-v�!�喚;@�CN��t6�#��U|W���!~��N��� <�r�Gn&w����ǔ��@��x�bc,�i�ҏ����[o�Y�����C�����iѢE�Q%�'{ر�_	��`�X	h`M�I�c�g����J��H�m�h>�wᚰ;�ԙc��%Q�N��m�|$1���ls�U���I,�C�ۮ�y�������t��w��y�\v,1d����
84s�bgl�lw0{��VM�(2�����P��k�ͨi[؇�8(���I'<mP鼔aܞ����IǾ�+����p�8F���Zűa��)�B��UMy���E�\6�<T<�zh��w��q�f��6���<1m�޺^�魯pH6x�<�.��s�'����{�8����,�E4�s�2lY&���$+[��=ˡ�F,��@��r-h���YQ�����< Qe9�b�{ٴ�6P��%�.|Eƭ�x�������J�|�p��d���i^Fv^À~��>=^�:-"���/�
WWE��I�ݿ�H�$�~0��40�:�f�2����v�;�r�.6ڳ����C����市�D�h������d�<���+,|���"e��:( 2/��Zؔ�1�?���ݭ�>�������ZM��I���b�a/�EK���5�w���S&�0b��x��쳏��E:J�̙���0,t�C�\��26^��<݅V֌q����RI�h	��IWK�E�~n�Ѻ韏yV�B����%�3s��o6v�g��iv���~y��L��a�Eh��4|p�峚�ڄ��Xͱ>�Y�s'�yC�q Ŷ�j&w,,��6�MFQd�������;�(��OXkl�����w��?�kl7�1��I@w �L��%��[nO�n��&t������%���5�&â�Ȯ (1��+E�DE��c��4
��
"�]T�bD%Q����,�� FYD@@v��f���s奄��{,����f��ֽ�ު�U�U��_?,��C��S8w��/����熆����7�؆G���q��uq��GBOQ�N�����"���A���ע۽�\�Z��x}�K��]�y/���vOy(��E��*����.N����!����9����'�w�"QA�@��ɰ��ɃR�i�EnS؈e#۫�VmVՑ<��%����nNA��c��7�fR�t�҂��q�h�}�VO���'����Oh�s&t$;��\`�dz�%�=Ȧ�d�,\�Y���[&���
d�n�wv#�X��gz��T�l��U��#yn�\K���a��쨭<�n�lh��=�n ���k�����٪p1���z���_G_��f<�Ђ��
S��&6�z����g!F������73n��|� \�����L�xB�w8�����t��[n���km�r���Z�i�Q�x�c&�������}֏n���A�~�����#Ю�]{�L�
3���P�� �zΪ���R݈Ɵh{�w*�=b�N<�(��\7q#����B9��YSo���Rm8���h?c�7�qLPxM��J��Xf2B�*NÝ�F+K�vb�v�W9��H��:7�vE�x�
���cZ���w1�ZZf%�C�ۣ���O���1����x�S�c�~���������V�6�����k��=9��V_��S^A_�i��HO�u1�}�tK�|�I��ğ6df��B����t��oCc�u���������.���ׂ����C_X��G�'Ǒ���b"�>�o.$%�@���� 2l�K����+w �/�7N>���u�����득߬��|6�������H��
������+�\�{C�o_���޷��'�{�nN]~�5e�]?bV�es�9[~���#�������gC�������KL���D�	q����$��\j9ae��Uشk�*�}�״���P�����[CF�����
��m��f�/����Κ|�B�-����X鷲��Yk�y�y`z�� ���ڪ�<����7�+׮����<,P�w\��BN@���(,2s��X�Dن��! 8��b,LI*=��,���NZ��& �t^�E��&\���*�f��� �
�p6�1�����eb8�U������ M�v����#+��z���_�(�X����	�D��wqr�G���˝h��N@P�̩�	5�Yʆ�.�?���yHo�<��tG�Sq�MI��F
%𽅻��1�"O����;mah�N��/i�f��&D�>�(/�a�e��.@���{	r��f׮K�y �'��(�̖�Oz���/�Ǜ���x�x ��wvDkϘz��44�����f�^o��%�����=hK�_;z*o�@��������0�׌�O4bi�RX�Um�WM� B��;�;(�5k�!�� n���
�o�	��nč߯f�*w��3\�\LT]���4wޜ��V���������	��:*�}m���\@�0�հp?D������M�~�΄7mje���h�<<���c�ΰ�!>��>1Zi�H�56��Q/O6��4p�O�؉2�����d[�D�W��af�5�`'4��~����+�+�(����_�i�m����R7Z��F���z������±�H+|�@��$�5�$Ic44���n�o�o{���e�/���(���a�_��z�&�o<~�<]aF��?tq�[ɢHX\�:��;��7/�5ʎ���AՖ��9���P�L#������6�gb�2���$�Q�h�O��ţ*Ȱ�PF&;�n�Pn���瀾��CN�3�z��R����]���E6Z�J&���P�����Vܹ����R�6��٨�9Λ�#?��򾏞�b�3�1B��w_7^p�A_���@�(O���T�8��U�t jƍ0`(1�Z��,����$ӆF�� �s�k�ů����x����}~jaF{��6��lFװU�y`z��0�Uyf{`^y���[7�����/o���\�խ�V�X:ʝ�S<kA��HN�a�o{��{�
wS2���d*!֕�<s!>ƋL-���ϳ����6l+Ꟈ��)�S<ů>p��0���]wmH,���+0��<B���<���T�Gۍm���A��o�Q.��j{��>�9x�IX]�'Ղ��l�l��l*�QX?��)�^x��p��o�)�ҥ�ʟ���r�7Ĝ ?�s�]�����׳A�0)�-H��h6�i�*+#͛0��5Hk虳��UK��LL%��/�V����j����|�/�����z��n=�y��?os�z��*4@�@�������ӻ��t����s��N�E��E��fl�:ܘV�}n9	�,�֤32Rf�QZ�O��^�i�����Z��Ϳ��O�w�g�D���oh��k}��V1ũ���ސ���C��"9�%{$CE�\��t�h��䶛��z�1J�������x��b�!~���1H+��(]Ʉ0�]���>�H<���7Te��6�O���r���O���9p�T=��\ l�AG�Q�;څ�x����p��1d�fz�u�v�JI�L@F��Wu (�^_����*ʩ'����?�{��喘���u��>@��c�-�Ǽ�������*{������#o�����8�ieڭE+'o�CO�t�G��,�#o�����Z�`�:�,�Xk�թ5:`su�y���T��ՙ�+�� ���@l��=#���=�=���a�b��!���+����l��}|��n ��G���
��g�7SS���OٗP��p�h���҃�$�k a�I�h�&��9�|��S�a֦Y�q�����ui����Y��+�b��IW��Ut�D�Ax���7<�@�q�������X��I��*+��G�P�}��nlͱ�?��zk��_�β�v[�,1�=� ��b�>�2�=��<0��K�1�G+~��,���+�l/.w�F�o����n�J)ľ��\8��W����M�K_h�Y���5ٷ��ګIa�c���+� ��Qg�揠�{�����(W�a�t\�K�2DN�p��o�uE��>KX3�=2��57��@�rvZӞR����{C?`�I������b(UڈJ�	Dtj`�'8��D�C686C���S.���Sy�m�c�K�,O���������+��GI��l��h���c��GC������y�])Lr(� ��H+�+�l��5������V�����vS�u�5����-3Ƿ�����];��~bAY�*v�UW,���n��h_��hc�
��J�6�x�o��'����3��X��ai�z��c_)_��ݶ�,��6�"�ˍ��9g0��B��t`tD(��#[�i_�x�A�_o�(�^����<�(��˟�ߑk#������?m��Z_��l��xTAUW��Г[Br�D�ꇐ��V�i����a���	���K�HɆ��Dy��Gٛ ��h��ب�tӭ��Cu������ٓ�9�4��nr�!�G��%� (W*���@In���v�� �	��`�*�D��s���#�.7^���w=o`�%g�N��y��]V��&�C�b��7|������~i�oW�ij\����<0K=���K�m=T~9�qz���wX�uL����DX-���4z�X�q���Cۑ֒��"�2ت��PG�Y���6�xձ}��W5K\{ݍv�����#b��O��Tuɐ�X�'��#p�&��(��^����*��	l,XP>��=���'���˗�ҡ�5��svx8�R�9�z��Yvc�4�D���"��Y٤�*`*���6a7;V�7����o��CCu�"��1�'�����N�v�~��)k;T�ciK�<8 ��-�sz�*)��ה��'ZqO(C^1F�f���U�y��R#g�O�Y-���uA�E��N<�<�iG�������ˮO�\��q�;�c������v���h��������l�y�y`�<p��\�moUg+<�;Q���	��閟B)6Ȉ�X�]�x��P� ,/>��L�Y�LF)A3-�b�\M�����L�8�E��^^��}���S&�ȯ��/ %b�;"	��w �
S�C9���FP/x�l�C��g?\�2Ɵ��&�����<���o��z���aX5�Πsz18::j�ˎ4��Xl�1R�I��$�HKsG�{�e"r�K�ѣZ�G� Z@.x�g�����?�ݱ�s���|���[��k�k=G��W�S�*~5?ܿ��L���Xf�6)#��~IDuKg��ۛ�*O�������2o�ܲ����]��_�R?��G�Ը{ o4is?�.��v�/ʞ�;���ʛʃ�>���G��N��,�?~Z8/:�r{ϰ0�d�W�WNΪ��G�n������g �g��R5L���E��Mk�媵[�uT��Š/OEǢ�dNa)t��WS�h���BMA'ش��R>���\o�*| ��Ţ�>�R�c��g�ԾϨ ���u�5ɸ�G��P7��g��DU�cD̝�Y�r�f@S��A�Hȗ���#��'�C������)����{�N��jIU	�W�tx��rg�=Kê�<�!�<��Hy[�0��Wqm����#�[f�=
<E���FSo w���Ex�~X����e�Gla�������kz�8��*@� �ݨ�Xp�R�J���r�u��U�)'���-���W�;߸X~�r�A��׼�Ո���3�UЈ�� ����/�����3�q_�iY|�Rn��B�6^����+��R� �N����ӧ������ndO���6�j�FrK;.Zi�8	c��0j ;M�i��(������?2��;�e��d�\��m��\�ʸ����~븗�]��c�;��YG�_�w��:�  @ IDATW�{���:U�����J$�	�1+�3@Ŵ��v�JP�g6��7�Nvǟ��&X,��ǿ�5�UN>��.
�ɣWl �e8' 1��woL�P���C�� 8T$Yթ��ż8�{2��U)HOc�q�e�Ȼ�]^dO��)L�ӚT��?>�W�Y�?�(�@u�ĂX�hF`�O.��a6Sc��4Ry!rf�O$*T�*���u$܄�����m�W>���J�g[ZK�M563=��UW_W�~ܹ�_�����_W�wu�kJ	4L�����-��_�&��&-nh���R����i�����PL��_dL������-��ܰJӵb���@W�-K���i$B��^uEf��@���$;�1�a�\s|[�j����W\群?Q_,ހR��q�=E�
�q c'�#:z�je��6a�/�ڍ6���4�G�{ٍyBo�`c��O��~�B���r��͇��[�n2o��:�CE�a��]��"&��>P�%��� �Ȟq�E��@�D�B���l�S�9��v���ߗ;�c�Á6�φv��e�7cM'��(x��H$19=��hFV��d�I`��$��!�ZZ�U6� a�h�k�l�.?����>�r������q����p�Ϗ�F�9���+^�_e���������]��ޅ�����9�T�G��7xѫ@��ߴ����F44LK���,`+T��l��M�o4�7���Ȃ��_�`�šg��pQ���Kq�I�7 �A̐�Fϵw���pa�G|�ah@i��n���<,�p��0��F�KJ��`�]�6���%��6Jo����6��?��C�7)Ml�|V`:Xu�L(E��AA=�S~v`��g���3��a�o��沶�9J,��Z����Z0h��'4��SGg��S<���#�S?�4�������|�V4/��F��(���^׀�y�7������y�)���
߈`�����M �ϼoO~נ���G%����7-	�S�w
NI�T���A:C���E��� ���`�/s���-.�����.;��e�������ma|<�1��[�f��xc鿏?�l���˚���<�I�-_��e�ׇ9}�� �a�Z�.���2O�WJ�}��p��e��0�����r�M���ٵ�y�y`z /��a�Z��f�l�>�<p���I|��b_|M�ǓIN�Z����S��,NW�J�c��I�I�)�����Ƃ��jx���U���e0�����Т�od|R7/���z܄{=Yz� �*P�6� �G�Bj�j ;�0�&�ʐ�J�̎6���
�讻nW�[�0��A,�X�`~��o*�<b#V� _�[�>`���ykQ�-���r~�9h�>�Z�+f&4�k�$ȴ�j�u�T`:�I��:��|�k� �޲�\t��T�~��iz��B���fۨ<�i��_;@��8�<"�+4Ѫ�ԇ��<c�g��<K�2;g���1.�՞%���jξiȵ�z��7�5V�2�@�(^cM3��Яտ��z���z9����A�/��r�%��1��Ǥ~�R����������d�"8���������W�s��l�C��W*坿��F44L+h�N�B��44؄;1q���C_l��[����Z��8C�6��&wL��TO\,D�?7��c�Oa:��MS�,6�eJ+ϤNu�D�]/X���q���u�Y+[K��_]Zv~�'���6�v��6�"q/Lb����l�L&���Ҥ��G��z�fG�<���X�}�øYƢt��_]���=?I�D��=�/��������)!�����c46��ǻ�:F��IT ����&=`���]��{ ��{qy��c�����$6M(��O|O���[�M^io7�%94���:�^�g'�
��(K~7���H���g+�J��c��)�o�a�Η_VV_}U�s���To����}|���aɒ��i?�ey�?�o����5gy����EG����c^���9��F1"Fu������C�b?Z�S����Ik�(z��� h�� dݲlh��6�_k���05��$쓵n vy>����g����F	����!#��uA,�lJh����.��[�Ge���Z�5u�:x��S-JY>ɿ�a���#� ��F�%��%AP�)����[nLr6l�Qѭ�ؤ���=�uF�ɵx+��;��ƕ�g��aAm���C�k!�(�j N��u*�r�i��u�����r��l"�q	�����샎�2�0��z]�ŵm�s|���&/Dz
vOM�21"�na��W_�����Z�'�{��9�5��׍��4���E�Lc����o�ꑇ��6<���m�oߒ�N;����c���q�eZ���Mx?�Mv�4�v �;,dJI;�}�!�W;�/�;�-44LtW��Q�V��Y�[�mjf���r��U��Un��IS�&�4�c���䀧ED���].0;۾b������Э��џ��=���V`g5�\�%��5�[LJ� R�b�W� p�.�MΓ*��t���Ch�^;�����ks3�X3�č�w���尃w�g���������?�����8�#��6�r'��q ����C:LV9p��U��2O��>q�ž�%w7�(36�O�i;s��3#W�G ՞��RFt�q0����;�qA#ʇ%�P��|a�]CP`S�B�(/��q�3�<k���k�����~����N/O}�'��k������U�ۦ�K�T-���c0���4'[�B4L�Ni�	�����3�_׺L:�/>�lN4�4��j�\�wg�b�5�WN�$�jhx =�.d1Z�����N�	,d��d��+������2r5�-���	x�0�+�I���6���4_�_E4�O��]���+@��EV]u%����#��s� �&��t�{�z%x�
�k�ǧ�0����T	S�u�/ވL�s���y{>�j�B�x�˞^>����&�	84���m��Y&Zr��C�Ҋ3^6�x�?-��w'�m{{�__Y�8���2 �x�l��n�M�?�X��.���d_�*zU��E��Q�����0"2%)_	�u�7�%αC�q�+�+��o9��}��M�q�i��ς�)h�svQ���}ў�����˿V�=����'������)D_c'�������$�h�pvk޳���V���Rе<V9=� �s�������ѧ�r���8L�r<pei97�Z�"���'x�n�*���� ���@�4��" ����_��bbi'�V�J{�mz��Uձ$)��L_�D�3����E7_sx��Q����3v(�6�=�\{�M,2n��C��@��B�od����$#�t`��fI�Q���0�Sʨ#�����/��.{�8�OW�?���o�2�Š	�c?��	g �fz��dw*��0S��W<���gP�Zs���a��8���Ut��9�b���a�XF��1T62ǐ�p, S��z�a�ͱ3+�w������˟|qB5��@�M�_�nH���ʡ�;������O4��}��?�@G'�k8�d�����I|���_�B/��vﭰ�sG�σlTB�:^�{����V����5�kq�@��������/@˱y`�{�������ʡ�J��������,,�N�`�t��w��* d��d2�lQ�)ľ�)���&Js�ٟ�ˍ��R�����	Ud5�2M��T��|*a( �F눅���ݩ7e^�	�v�BWi�B��+�/y���cp�g��"����7����u�̴d�Ovp���˖�7U�
���<�x�_��ˎ������[H����C��6�5�GˈJ�W����n�k�A�)��5v�� ���q��@��@Z�Bfld�0���0�6���[���!p�ykX��.�������P����r��]�t��q�)�Y��hm�૟	�2����y����������#k~Ӭ�5�J(|�i!Qa;��X����?�Ha���ۃ�-��Y�[�}Ԫ��{S��l�_�5�v��"&~������ ��Q_�G�&p����&wc��t �>�������y��	�l̈́��AKo_�U�R��Ī$dt�H�P;8�,`M�噷�q�_B��s~��`S�t�)��[l8���)�x/������SY���Z7���Й����HC��8Dr���ag�(z��'���UW�P���w����>�~�`_���h�ӦG���K��>�0~|ɉ��3�L�mfg9��8����� �F���k�ʫ,(?<��~/~�3��� ��8�����ƃ�+nvpy��/��J61��<��1��=����Q%u���"a;NO�;�� � )��Y�n�)���4�s:�(ęF1�	x���T���jD�@�������_�n�5�j��[�5��	��rʭ�����|��m��ǹ�	��D���O8�cq@��t�Z@^�)N�s��\�B^���n��u��S;��DՓK���N ѻ�8eL�цLx�G�Sd
;�ed?�a����	_��"�W'��·od��os�;�g��2��^�e;X}�ox������tJg��ϊ%SZ���8�"b��Xyp�����O�Q.���*�6?�=����6�U�F�䫕{mx�����U�f�m���݊��
.�| D�`������8��Z��{@�;�9G�0pM8��������G���r�-���^!��}Ŭ�s%�3ƪ=��i ����h�ׂ���I�ʨ�����;��чs?v�N7������k7+�m�s�vnh�?=p7����(-����[,�i���R�G?
o `����3bb��_ �����O��?�5c3V�&o#���f�c��G�Љ�0�=avDlp<Xg����8/���:֧��;@ (i41i-���gH�æ�߃C]*�b�'��  �A���/|�̲�V�?�V\���_�zO����<fs��u�U�xGY����e����|��5�����
(�b�eZv2O��L#\�NE;V[��+����sT���B0vm��`����{<b#ض
2s�Y]�'����j_A6�dl�y˕i��&*�! >���8�������g|9~o¨&�뺧M�տ����_�^�~���X���/���e��瀶�y8�E�iyw_}�۸v�
T?�~%��!�!-E��\�Fb�We���b�W	�����*�Q�r@O���M��]��ʭ�򺉅�>Ve6�y�y�O�4���y�����h�Т����X0_��O���(�T%0�91�	�$d�<��mu�{,F�-a��E��U��"���yU�9�� 7͓X�&�����ȹ~� ��p%�J�w�����h�{���t(��t[.Ml�ԓ���	ܘ��sbΆ9��+�}���oV׿E>ЛMɳ���jk�R��7&�a�sG�%�l+�u�	����F�,��K�&7���7u|��؉�h�&�s^~���r��fz���u��;�`Q��FQUU\�~����:{UR�UȜQ_�	�6a���2`�\���&x��������v`��脛,�(6����~�l����V�^���3�J��M?k�܂��є���kL�e�,�	���T����K�NBݔ�
� ,< �Qw����"���C��P
1��KpQ>������>�-44�Oh7 �'G�l��[4��-[�1��f�u��D�'p��ybǗ���'� #4�ָ��I����	�u%�)=c�v��LQ�hn�����4Aǅ��`<��k�"�c����7�y�T�;g�}�y��v2Ot״P�hT,�b`@���V�&{�GO-���r���ݓ�Qn�Cyhkk��Z9��)k�mo�ՠ�aݽ�o���3)*6 ��	�=^�E�K���)��3M�����x�(��0n8�Y���sʢE��͋n1��`�{Ŀf����^{PhTGGN�Fl�	 �-���S�-���]ٷ��T�CV}τ�#���rcS��6�Gy6�����j;a��1Ư���r�;�iO��Ty��ʒ�w����4�������bhF5)d���.��hg��A��qO��('Ģ#F�!�~�
\G�� ��ꫲ�����]i�F��\'�Ψ�p�;��F74��<����.�f�y�y����������X����P�$��X�v�6E
��>]k��jyM�z����d'�:���	��r�d��=`�x�eK�jhݣŝxD�P�Z{���[�	|LdV����.�TV�y�͞�־�i��mg�	2ӻ}ɲ�����>�L�H�mO�q��򪫮R�������M�9e�}m}mU���
�P��:���㑛�D�4�0x���/�ˤ�iI43��z��dƟ���,�簉��G������<1�z��Y�fѱ��p�zu�Q3w��1�6��Ń�]�+��ku�.ވ� ��BЮ�Z>�6��W\_n[��3��F��ODF����\;<�}e��+����e ��Dho��8�C~�>���X����CȈ�����f�b���'q�:�1.Ub�xto@"�a^�Ӓ�$�KWۂ���+�-�/�_����%���st��>7�64���Т��+o�{�E���x���2&n<���=a��b?��d0��&�����$��1�3i'�Dn����R������܋��A�Y~{>_�şy���{�G�E\i�H�&i'���Jv������P�%P�L�*�8��@5>����3��=�;�O�w>-�����l��x�ae�;ʊ;��מݏ��kC�n}�B|N�8k��ѧ�Wܗ2�Iy�u@#��|6�%7������_��F���mdo�,[v'7O�0���T��7c�"6+�0��`�T�p�22��9�� �Pf�����wT��G�Y��+��]�,?�L��ܤܞ�T,̛�v3f�	�8p���vL�q}t0^̑��	;W[�Γ��7a�le�0G2�]�R��vX�9�����<`��aw$�OzX��R�<-jh��=�鼅��?�lA�	�>�������Ro�A���8�7�ж��v̹ܼ�D�7v��c34���ܘi�+���Ey桜���'�G��9�'<���_�J#��]=��z��x�@�x��l�9-E��@)2��p�	�A�f;H���L��o��<�o+'���n��%�5gl��&��Oz}��`^Yݾ��v���*΄w������5�4�h�>�X'��k��!.�ζ �
��K�.�������v���dݺ��wS��0�{G-��+�,���� ��O�ǔ��"	[.fL�݈,�'��ހa&��{`��M�����l��[�G�<����{����2�m��d2�pR��72����0�;X�|����4��k<H`�X��!a=k]i=��w�8{gv������.~�?��9_���9_�Z�nT�@��}����/7[����%���j�:�/�c�?��M�^�2cM�>!�i�g����\lTd��]��*V|�LN�l�H&�u�+�&��+�M�n[l�	� -�����6@�O��6y�R�S�X4l�0#`g�*����0D���Zƨ�g4�l���+�Z�?��`��C!��ͤ�����j���~�5eɒ���y��tv�T|`Пd/�dZr��9=�NƉ�v�"^U8�����qh��ｳ���	*�N�*�y�!�zHG3{�<>��8����I�0`��4j�n��M;�+�O���wa�'�7�73{x��[������-�V>��S���&����~���{=�&�L�Lǵ�H'Ft��̴1|n+Ն��zy|11*dRR��w�t#@?�_r���5	��/jЋ������|]�M����ف?���L��&N��A�+���۹y�y��@����f�y�y�����oܗ~�����X�oV��a4c�K���nN�XĒ|*�����jt!�0"�8��I�9XE��?��k��j�+Z�vz�-��*�(|��	p�PB��!C����8�=9@�Rȼ�����5Q
1� 7�U���יI�|�d�y�k�Y��O�[����x�>.�L����s�?�ߛ�3�vu��0->b��!�t�2�S���b�@.�xw�Y���?}E��*F?<��]��zV\+�������S�q5J>��_�i~�7(�k���݀�a�<�F=�,o����~:�?����Oi���~���.,{����6�����7�� ��F���������H�hK�!���{4�����:U �čL�ǲ��)DS#�&�j�븄@b��{�r_�p��q��[q#8w$��w�
a�,��k:�i�������8�d�[�<�<p�x ����b��<0�=`�'�N�S�a���r��1�1���=ce��] 6&���,w�p̄b7*ӕ�ctv�`�$׽(`��C��V��fۍˏOzm2&)lt���s�����6r
>A�v �kA0jhMWBF�=
��)��"-�8�����
�KLe�\kc<�;o�=�t��V�_~w�ۑo�G�!����tl��[ysq0hQ_�qk�P����"E��-�D�t�WH�G��5/�C�2�~��vݐ���_{E���Q4N'l
������]u�-�J3�<��ۅ�< �X�Ĉ�q�\e$+v�!���.<t hI]��	m�|����a9����zI7��2���U4Kr?��-�C�䊧h/\
���ܪ�'�Y|�5gC�Fa�b3&J]el�לݼ~�o���� �&�Tsu��=y��'sp?�+����k� wu��:�n |����8`���<�<py�O5S��?�:g>�,��)&�^�\Ʊ��+��o�aL���G�Q9a2�M�9��׼��u���/
_|�B�?�֫,+B�����5E�R�ُ�Y��rf5m_�1D��ig�sb�H|K��v�����(�c�p˖�Y6y�!�?���zR�~��V��?���n�;�Ƈ��km��F`�H-@�ʱ�t��� K2�\T7��U�{��N���e?ˑ�}�����_�����Nbs�M�'�o�n8�J�9��ɧ��.��0���L' I�>�����D&Lf��~��Tf[��/|�򐇿���g�9?��7���9v����2���װ�A��N�L�N��A��'�b� �P	1,V�J,�� J(��P_G%��y~�6\�Iݣ5h��=2~5O���n`�с�d��$\�� b{S�e���믿�1�'�F64���k�y�y���I����-��V�7���gc��W��3�;d�UtR"�=sJ@.�b����������s���{bU�����RN�Dm$�2%'Q�@$�-n���75vm
�PU�(�:!��kgT$� ,���|��cYy־�/�y�}���w�����m\�s���w,��k������% ��E��x��	*BmX�w r�OXp�q����'p�5}̳�G'�o�/-��з��^�fb���.�	��v[�y�����Z�չQ�LG�:�`Le�(���L?�W�E=_���(����+d�On���1��~��h�_O�O<���'��������n}��ӾS����4��cO���?���ğl�1��>�v15$y�I"Z�S�ĭK������jۈ�m4�5։7�g��Qa���@=KQX�$����M �UAS����+�$�Ҡ�\or��Ȯ���'���1?�����?�i��q��v��l��-B��O���UW[ٞ^�Di���i��� ,�E�D+���� �Ä1������`,�=�%d�HF,��i"�B�ߘ׀M��*�v�!��@ʼ�?yPy��u�721��5��ȩ�4�{\2	Pn���n.�u@R�@�3��{v��1���q�(v���?{���G���it�y���*���?c�H��rOԱiI�Ub�I�% ��&���r�Sn�AX�|��7���ፌ�V��G�n�?��q;��p��VC���%��	����8�i33��<�DI��G50cl���cέQ��t�o_)��G}�e��Q���/��]~=��oй�2G-��z;ԱH���Q{5���[��&�򚑊�a��Re/��B*���5A�BR@l�1�� >b`�aH3��i��ξzm�j��ۮ�)	/���� s��K�~��	�nL�&h�g讖��P��؂�v`��o���O56�r}Ξ���G]�@�:)�th�G��"�/NaA�����5Q�>q�[��"��*�\s@3�<�(1vDc���B�P�Ȭgʪ��{Tc�2�i;qW'� ���[����#��aQS�-�م���ó�i�"7�(�0E����n��!兯�rY�d��ڌM����G�K�:���#��>$����G�/x.��r>ڙ��Q�l�'�]�wa�S)z��!���T��J�����R�#��r�[x#�Y����o��~��:��k�9�OU�:��09	���3T4b�{�1��Nƕ����-�sG�o��Is>%���']s������([�xXYw��[9��r���>�W��p2_�G��X�A	h�86����\�B�����B��F�ilu1l(H�t�ӓvb�7L���"��U	6 �/y��1�G�eRK�����d�r�
��(�~[F�y9����'�r����d�@�������Pi���y��}���W����j[r������m.�`�@
�@�b�E�'=!F�$"P2cRi.6��%�<%#]$'��q5�1"�F��\7����ꢪ+N��dQ��bW�س�cT@�&����t�:o�Pʦeq>`SA�AC?xz� ? }�i�,[<��r���+�P�!�֛��J�`��ꪫ��}��m`i{r�mN�D�0�y�����4ptׂ�pO!�(5
tD�cյܞr�, �m>�g�G���8���ߦ?t��ƛ�gO8��vCBn�q�D],�?�ȍ_�j���L�AK0�=�<y d��_��~��SΫo r�QI�9�kn���]v��e�G����k�+7ް�=�ӈ��t���`�PT�1ͩ�X!�yuxX�у1��/���#2�A5��1��&@�|��9(]1���3$��2�m6ܜ��Ψ���/��&I�����=.��%u�E��\�z�s�N����;��������u7X�?ۛ rS����1v/�y�y�������٦�g򸠰����.��:d
��$�$&f�����5�a�������&��
���1[��I>sǍ^��v_Ѡ�Z��*+��z�C@nF���al���=��rkh+�����m��0;�KE��LWܤB؆eE����Y~���֛ ������"��������ذ�t��~Bkx��s<��bWט���=��<<u`� H�/��K9���	m8O�qm}��O�-������Ջc���7xS��q����:��]
�T�A�2�^��6>n�~����d��ɂx�x�>S������]`����r��>"���%f�`Jfo���μ�����D� ��=(/�	������YEq<��+�AA�dh�"��0��6K26��_*旫��b��LOԍ-N����R1l�n��[���3���z_9���<�<p�=��u��y�y�=`Z�����L�[o��M�6�j��2`��aˋ�k�ɿ&�TXm$!�×�	#R�W��T�X���ܘ�IF��2$��r��
��ׯ�Juͮ� �3f�
�v>F��0#@״�d���t�P�#9T�w<G�>�LH���O���Ï�n���)�Lx���ڻ��6�	➀˻����¹L|�:m�AX�z�qͧڂP+L8Nv�R9r���*�Y��ŗ�~jm;�`���zFw}Ҏe���+������த>��8����p�K�f���q�8�1Vr�������̍�����@�����ҥ���{Y��ǧ��g]d�o��)I�k
^�М@�@vJ!�aF��e�1��^.2�#]7���sF�?0��$x� |晲���0ꡪRwm�Wc�U�&��rl����Q��N�t5�h/�� ��O�a�Sn���Z�\y��<x��:E�74�3�az��y`�{�"������/����.M�u�1�[����]�^\���l��ԋaO��|�*�	�0�0;M�UmC���6u���i�����p}S8��P�����P���dH�[��I���#��VN�VJ#-Ye$A&�w?Ϟ������Q��?������X��{�,f�W��v�_���Y�kbx�lL�ov���D9y�뉱D�9^c�|L]W���=��Ӟ��/�΋�d(������V�����r��?7�Չ�L�����/����)��i�1N�7��� �}��d�=�c��|H�y��������YBΨ��;���q|y�fo.o�������،������+������M
�*6�~�A���L��] ����6��A1g��E���*ޜ��� Sp]$`�����Ŭt��-K9]���w�#�LK�&���$@A�.7���N&������v�rٙW/:�I+�C�"�������G�j���E��怟=�NXk-{B��^]u�b]sce�b��7"���&V��������-6d�;'x�H�B6�����0���2�]��+��z//YFVb�OzJt���>'姑mM���vl�����90d��	8W�O��:;Z7�$mq�$>� ۶q�+؟����G�����dϵ����8��t���L���$��xc)Mw�~C?��b�&̷Hk�J� ��4���^`@k1[=8��8�S�dh�W����;���V�����?�h��tJNUC捀�*|�4cK�� `�@ ���7" &hg��"�9�Ro��:?�Wq�S �<�����n����o{.�J�6� YyR�1|���.�� ��4l�;��ޜ��	�~ 0�'Ī�g'vblB��y��1��A��D�`Ц�b����c$����"Mb�p��ɱv ?d�p# ~ �]���sR�F�Y��"��$xH}H	�6k�P�w���������<�<0����9�t�@�@��%�z �7X���f�X(X� 2���\>��T�ML���i�2]w��lIF]3+_��З;�b@$]�
�x�!7�+�].�T�i_y�M����*נ�t|*~O��l-�mah�3��'Hd"�v�e'4|�Uv����8ˇ4�#�+�,��0�
�U]m됧J���������ޫ�#�S�_����x�ڀ�V���[򾢶��6ϡ�\���HT9\�A��`-,�ȇ�n��-ً��o����=�捜������7?�~�b����ꤛTr�b�g���47��ے��S��.�I�h�Y���1:Vne��w��#������_���M����<㹟3?�SV�A��c�ElAsՇ|�e��4���x����:H�'c�x�u��� ��Tgq�\����q�]��$2�	����^��HFLW r���� ����dJc���<t��.-��i��WF��~�����׃��>�i5�y�y`*��9����[���t���k�Y&��h�m���'l.Rb��+,&K�,�!I�)t��4R0�I2�M�/<_��'�������&��B�:��7G��L��ͷ����TR�~�C ����ږ�x�[x.��5q�� Z�%TވG��?�sFY�k��i���:,7f�Q3PTr�}Y~����,�}�6���\���`qƅ�������"���;��6�'�����0�sZ�C>�C�T8�B�e��u��sv��k�����@�z��3wb9����;k�F0�2�L�����y�4��%ٳ��t�*�U�e�X�dυq����kw�H�OJ��i�/�����e����"�;��y�UPn�jF8��"�����M�=�Ѧ�v��,�5 �Ƶx[&����&�V�%cn��PV�?ǡK(WtDI��` 6�턘lJq�ğ����{�[ ��Ld-�ՖHżXp�W���� %q�w����rʫV/_��$-nh�4,G�y�y��%|��~�:�|��ګ�ɑS)gJM�QR$5����QiB|�<��-F�B�Sy�$�k�Ϙ�)΋��pAee�+��iAط2}S(���.�\��O��т��(T|�X����O�/���օ�-@i�*�M��6H��Wڹq�r0�%�xkS$��
�}��~������9ͅ��-���[nY\��ˁ�_���=�_羍���y�6����������s�{��\ko_��0�3O�0H+���N<�#��i��o1���y�G)�I�ʘ&�@+�O5��2�Q�o *�:�`5-�Y�8D+1ڞ��hb6"\g\�py$*�M�<h�\�?�f���3��~��}?����[ʆۼ�\vY��ą�$N~�$jj�z���r���N�	%GI���v���������F���K�2P�����
�}�2�q���[�gƑ�Q�lԲ8a��a7�|+�s�M���`n�3�i�0�Cm`�3	j��QK�)�{�܏��-44L�nMh����[��h>��i␵�Y�Jb�'�N�BYQQZN������Q��6��3!b��$E~J���]�.��I�A���E��ʈ�2~��E�t�,$L"Q�ۖħ�Q=B*]����&�.�F�k�k0�⺮B���RH�a��&9�'?1*ih˔},������j�A�q����PE�2������,;��q���w���o��Ę� 6��l��^ŧ�+x��A����xX��Y����{g��V>�1�	'۲��0������y��#o��n1��;�����  ���jD]�N�@�!h�k��h���k�MӔ���P�IIB�Q-@W������� ��W����z[T���)~�WĨ"�����w�6��:8��P9[�є��(�̙�#Xp6��Sj`/%K��������n�o(@Mݪ�!(�v���F�H�p�	��]'3��m�]�s�ݍ&5�A�6�I��ț =���C;�B�7	@�:Đ�|��o�d�n\q�Ý�����<��� ��<0�=`�_[�י�>��!kۜ���u��,Ě�WFʎ��7��נ�O�٭�e�c��}�!WJ�+�U����²e�/�8���h70�W��#W]�~0:b��]nެzp�kg�����(Ȫ>�]�����sR�-���xV(���+X��?4�0�Z�V<&X�m4�[�q�E�/���r�ŗ�>�k3!`S���u�)��{�䏑srJ:�� Y�!�N�+@�b�ԗ�<㗼�k������ixz���zb#���n���1*�!�ozJ�0�Ř�cM�p0(]k�_7Ec��h��AA��yN���o���u�[/�{>j�y1	|�F��Q�	�CG�3�h���D�׌"��
`����������u�6��^����bՈ:`��<;�4{� ����ᳱ1�����J���G0~w��W�ˉ�7 BZ羑?	 8�X#�ƍf�Q�Z Q��]4�1׸Km��G޿�j���Fx�^�F��y`V{���4l=]���6����֋ɹ�x�9U���	�S$d� h�ʵ�]�i�Cоg�a����"
em\��s4m���B4N���2� ���u��"+O`���[��[`_���C�1�a��| �YXa��>b�ጢ��N����R2f��˚Q�bI��q�}�b��~�,�e����|���O��,\o-{�&Ǣ��A�;��*�{YW�Q<�r,�0��RAw��f�'�����g�wꑞ��o��W;�#�(m��f��pf4��M�f�ϧ�c<䀛&���f@(E6�탅��H\��pZҺ����  @ IDAT�?i�mjW^�<�5�Rw5�����BH$�*�v�?�7D�������Yc�	wu��������FK�y@#B�d*�Uj��7�d1��E˴� Rl����A�a̢�ǁ7���8��& ~
`G�޻�˙�`g� <��;��;V:T�0qs��%�  ��]��^�< op��<�<0�@�IK6�b���X��w����z6�Ŕ�s_?m� ���p���!Q9驢J[L'\���)�0�d5
ڎ�2�8"h�[����6@�P|l��o�םYM;aņ�U*}?���N������b��d�%Q��D� dINZ<��|����3෮6k��s�t��h�ʌP;!m�H�&�o2c��٥@�w����o���9Y����o�!Z�`A���}�ue��eu�K����t⑴Sl(}�� D��j�px����ɑ &���da�=^�ű�  �8|���źx��^h|��OD�?u�ڕn �8 �#�
��r�=�ɸ��F�����'ru�����&�t���%�y�&^lUM��2F����F���Ā;x-
>��ُE;�mP�O�8�Z���o�ov#W��U�54��Vh�m����>�lؓM� 	��}�H�ag8Y���(�s�L��0��h��
�Ip1Їu��X}�H���P�E�]Y(O�����	�^�s�{��u{d-44��l.ih�l�`�"�����x��銨��lΐ8�N:`�
�y&Mt�ӃǅF�1�����M<N���ԍ��H�|�d��)/�魉�z-�ڴ&�w����r��܉}�@�#|L8×@��uW����\:G65��g %��gL}��ꂰ����U��WK)��#���iʒ4�U���%]���2����mN�ٹ�-����r�u7дN��oTnź��M�߽O�z��K�o�ئo��é�c�@"z�59�	Wuē��!'�=�	������ ��~��;���[U�'c��ƪ*�|����+� Z�G1Ɛh�0�[��=��Y1�n v�W��o_ƛx�D�	��T&ܠx��r�$��)Qx���4����C)�=�a�Ʃӳ���"
R���	�3i1���v3 �G̛BWu���x�3��� `��Xyα���3�9'��Ȕ��d3��- 0T>�EWa��T���8�O��Ii����!�z��뗝��t[�<�<0��!���� 9�|��q��k�bŴ���qG��Н�<��
B��K��a��h�܌���@S0�"_�x�ɁOHl��K�����}���Co���?��G���會ʫ���V��e��I�E�ݿ���tW��L�ŃsL	 VZ��N1d� ��;�M6h5�b�b���O�I��2�
a̒-�֦�`�9��g8ɢ��9i�+�p�˖.+;<�C�������8�H�o�O9�Ut�r���Ws$|Y��6��pZ@(��Ќ�� � � 
l�(#�m�D�.Ч�_����s��G������W��j�ڨ�|A.z � G��Ϲ!c�8*Tn:R���)��b(!�ǡu����
��~��ev�K�a@�49�L��������WT�V���~��Ҹ:�v�j�g;g�>:YsJ+i�1���g]3�^hԞ�3������v��ŀ��k��T�^Vj�a0B����00�;��& �Xx�%wc%�j�;M������e��\w(8i���2������8l�hh(�l��A���L8�u����G�d���> y�و�G������ qv����6�x���g���q��W��q[k���;ߴg���w�o|�Ee�|��������Y�t�	$܋�y���x�9��u���>[ҡ�P�ڏz�
�S+0�6��IЬ&�W,�G�����C��L;h�N����"���tD�ᆛÚaЙ�4������=Y}R���pyv�,�8���P�1Nv�G�OqV�׃�s9��_��_aO|_���� ʉ6@�r���5�gQ%�V��Uj��J��l'�5�#�OƇ�O5�1Ɯ�����M;�֚f�|����KX���i�@�p��p���dJ:�Y}v�*ޯl+���a�~�}k+�J�F���i	��1p��9OB�/k�)f��N���|���͓�#ň�?����vѿF�o� �)��I�C�~��蟰�#z�tk�P��	�d�şts����rs������?��F4�b��,�C��,��-�dG7��?VYe%.N}a�[�9�ST���e|�'�3��G1K�b��VZd5bl�)7:�v��&�f
a -�p��WJu,7rï�?�1/�;��rݯ-�|������q�;����K+���16��=:���=�I'L�t�l�g2#f��OA�Z%,�m):��(�F�	� F�S�'��Rt�����m���ʒ�w������|������1<��i4~
pā��=�� ՑtRTNΨu��,���GB���(ɢ�|��$}a�%{�Kn�Yc�X��ޢ[���]����>��Q����Q��������`����D=g� �|�]4� `�1��HH��g�t� 8=���2�w���%u��8JG5���#!6)�QI!HF��a����NVA��v��]6&Z
f��a^�56��4X~%T*X5��8�o�,��RMB��Db$Slb�)��=���h��2vZP���yfE�51H{1pF�8ӂ����p�c;Sv��ڮ������U���vj�����,vB�����-<f8eܼ��6>���k��T�3I�\�n>$I>���6͊Cd\F,�X2S�XT1|�v��X�Ba�o���[D6Z�d�"�ʍ�J+�M��7Z�|���-�w��ʋ_�X�'z�N�$1E���-~�E'�;7�2D�ft����ͫIҦ�XL[�����i��=L�A@OUV� %$�P�M�PeB��3���([�r87��@O�&�po�4���̞��ͧX�ٲ��f��������k��B�q�u��[�@h;�1���f"q@�!�$d���A�k�/����ITV�0�N�>|3�%�o�?^�T=v�Z�p�G�
������1.i`\�D�5��1e�d�3cƌ�fk����M���4��G��)]Q��8�ꋐ�Q\Gdz2f�K Z�ha�j��D�,�9�;W�$ה>�itu=o�wr"�ڃh�8�8)� �(0���J�4`	�;�:���o����`���Q����B���M��P;Ud�+NpAwעᔊ�������2�-��]�~ElQ����@7>fe�[���K��|=�gޘ�5I�����%q�gv�@5i] ��Ȏ,L��7��b҅خ6�XU�0���o]�`�o�����N�Y�cx3c�k����D����>�n����:��*�U�~����aN���^�T%��FB4b,��m���K���ͨQ<�rn*Öl0���0{OB��&����}iy��Z�-�?e���~���Q6�h!}=�+i���@7]�F��F5ZB��n��B�8M���s���}L�����2c�п���ʹ?���q�A3���zR�9.��!D]�(zO�	�n��!��@*IC����!�QEs�o~s�a�������?*���f�ֵcK���j:�$��H'�JxGx(�@E���3�#:&��`��́Ѓ@G���hO������<�*lH�����0�j��J�HB��Ձ�9��s����n���H�5��k!��8��>���J�C*�YZa6�k6��k����ᰛ=5o5m0آ�qt�X��k�z][�4Sz��,�*���sx�{�g^dl�n�T�@���]FT��C&p2�;\� ��;�a��q��yá����O�)<�Y�+W����=oۭ�����UI.�����\>�����8��Z�c�qŏ����� b᩸ʬ$*��D�t��S�.���}a��h��_�z�ud`��Y�;�)`"����凧��������o��n�c���~�������F����o׻M���=ϑhho%�t6\�s�k�ѽ#G@OuZ�	��l[�p�o��V����m��/D�L��_��g���ZL�����7�QN!��@��̓�;��
=�b#�e�*��_O��.�z,����5�O��3�
�#�b�
O�TL��X�=�$	F���3�oU��}�h�ɭ}�eg𘒂�ԡ�Ƌ�#�ea��B?�Q�(�@#U�Y$t ��a�ҡ��m6�.�	LΥoD��/Ak7�8�Ru�_�T	�ʨ�UR�	���W���)C6���Y��P�%�n�l0�B���=���J�`��|�ӄg�n�W/ \ψ�~0��E�4����Fpa 9bȺ@�̱W��M�ߤZT%}��q�/�xQ�+g�7/|r����5�zW����.k������	O���t?���8u��d�w"�7ht�G�նs;u#v�`)c�Jn<����Z�	.(o_��Pv���Sô��cCW�T�
.�k�m�� �>��c�= ��5X��:���x&Yx��N�Cm�����t����°nP	�?	�з�sSJ�Y��K�B+tb3b4l8�c�'�5�����]ǻ�4?��g�ݡ�x^7������-j�����,�"�f���h}��m�{ԗ~B�t?={�G���Ma��p���_�����LW�d���&H�5���
I�C�S�T����b�h+�������MX�B����
ڛ �H�n -&�^E��>5dM�]�ؿ��� ���!�e	=����0 ����VsVDbD.!BJ����W�� o�gL���>������g�j�y`6y ��T�V������|��q���!l���]0���N�N*i�ܪ($�����c!ɝag\U���ۂ�k�*̓oe�|���oZ�f�-Ky�sw)�y@����+;�S-�<c��"�6oh^�C�n�`�p��6�I�j�����ܥ=�t�L=����Iʡ�HUV�C�Hh|ff����׿��r���gф�o�����v.��+�J�O���l��GV���.�5T�-� ��c���?e�
i��JW�)�]n��c������f�Px�
ߓx���J~S%�F���e�Fp�*���Ԟ3P����������+l:O����'����%�Jۯ��?�D㨨�j��L���t�fD�F��$$K��H���r'~�b$,�,_]�y�N@���M�7��ʰ��� ���U�������,$�D��vY�B(�U&�E�x@���������g��Zݕ�%]a�LR5����U���������7�������%g�Ի�s{��o��b�]�M�V[�����N���[�C#��%lR����Y�����N�Tgj����2���S��p��oD�0�_rW=�.��2���۲��_>��=�z�eb52f��|�oZX.�G�Y,fkp}�	�q�\4��䦊��b3mY,�����w �UTkϽ!!��K�қH}�@)�(X��V��X Ă�	��<�Y@D*E�.U�%"�Bɿ�o�o��}νI �s���3���Z3{����샔k�q'�s*���Tf��+�"�#�#ņ����M���*�(��~��Ӥ�˳�f���"B��>�'��Ņ##e�F6$~�PN����X�W��F9�*|���[z���j�'�p���wm��F��
�m�(�C����J�e U�&!����P��Aӱ��x�%���y����m���� �%�����%j%^(�E�I�` V(��Z��
���l�B_"��z��&��j�6�Y,����?��-�_m�e7�t��jWe�K�ʺ8!�Ͳj�{-�ʪ� �2�f*��| ��E�B%j��{(��,f����WJ���rFz���<t�+�j#0�#�^ �}�zXD�p��ق�����o0hNӌ��H�n �"�3�O�Fh.B���F��r� /|4�����:@s�Ly�f�����ncɍ�R������yQ����ߝ��4y�]��ğ�¬K$�:�wȳ����@�de�J|�G���[��&BE�VrAf�N�0�a F�K�P�h`��
�}�>��t�q��/��BRI�2]Dy�w^oǈ�J���l{�$�']�4�5}ɕ�S�䃮OX��#�ȇ�za��o�V�/b��!�۽pc?����?�%�s�!nR%ZAN�s,��D��.�$d��>��tZe���ok>c���݈�c�@�pGp��"�Ia���]���9��1O:7�P(�k|�d&�Z(�<oCwx@A�u���	+A����O6*�,P��R���� =0�2vl$�4�@����) �"� E,T��&���C���EU�����P�7y�Y�p[��(�Q�k��"[�j!��h�6+{�xC��jӱ��Ph�����柨IQ�ycB�$�� !V+p61>=�-�XRsh���@�f	��	 �鋈Byq! � @L��|�t�y�������c�L�-�/�c�]��~�H��"�����~�`�ob��;L�:��e�G"��x�1�|	��|�#1QY��g�P/?��G��
?8뚴Ƌ>�_@�f̘�Y�>i�t����?�iE
�������
47���Ct �GI4K�y�j4
6VYv���ٿ�s�_�A;O:vo;�Z���N��Q
S��V"$�aM������~n�)��.��gI`�����������_V\q9ƕ�` <&�,b!J�t"�gn v6�%�"��@3� ,�(��\�$3�%dB��e��8f���q!���9��Y"s	]ֈ3u>eR��ɕ ����?�1�c��5��R�૾��������S{x-h���㐎	/K~���fZq��M�\����~�n`mj#0�#P���ֿE>�=�Ĕ�L��#�����q���7->8���M��цḢ^T�.Ծ������ө ��U2,g�]e�h�]�.�e����c�ۥG�?�R[4YT��T�@C��bG�ř�WDz�@���[@AfvP �i�N$Te`�D���b�'��\�b��㝦�F���*�=�in�v���b@<a��c?����+yl#l���0�yDI=�Y .q���I�@�ȗ��PWf��D��{>�s[�%�|0N��}K>Y��T���p�#��5Y�!6TB�ŷR}Qn���E��]�i�Z�M���8�C��3t�w�U�嘀[�x8~��ɊJ&�B�(�h!T�F&���s	a�W"V7�I"�t�����m/�!WR�w�wMl���Ȳ,ģ ��*�F�m��Ѽ@DbT"�d}^`�AC��(I+l���j2MnO�幽0���Vg�:�:U��t�Ω�����wM�`��ojTעmF]��mj#�(D�#�]��[Ҟ{t��>u_w�𨜞rή����g�L�I��R��Ŵ�/�����!�������J��3���B����������9�����_�~~���W���]o����j�h�!%�e�J�'�2��C<��>̀�����D>2Z!�ʂ��&67�2��� $2KdR60x%�Ny��g�w�#m�/�+�}oZf�O���)���2�O��w�[��|�9�Xa�gC����� 8�A�Ϝ9+���Kӫ��)W�+�Q^ ���i������p��aŬ��)�8��V�mt�-��SU���\mTȹ�P��O �U���>V{B�WZqB����"�{��Q�K�	Ĩ w�Jf�s#f�d\Pt����f~�2�:
�E]���Hh/�@<@�YTNA0l��-��n��*K���X!~��/%�b�Ё�R�r��1@��~�KC�+*�3vnx�����ZAGbA;�Px6n��g�M�c�'���� ��͏'�>�7s${�	)�f�^~<��e��%3;�V[Ξ���V^i�4v옴κK����K''��$�q��:묰�}t�e�Y�\h�6�0:G�k�Km<c�1���i���Ụ/}ᕣ",�x��OO<�T�W՘��T�E�C����?�9�T�y5�� ͇q�G(1�Y�u
;��v�D��m�9��Q�w�y���*�F��~����s���	�rA�5+�.��U����Hb�)�T]�0Ƀ���h
���C��u�#F�5��4�b��0eƧ+�yoZv�	�@���t?^�ԫ��-p����[�bՍ�I�_�N�Qr��Р=|����NO��.|�K��7\��j/��CGX��aG*��׈)D��BU"�A8ڀ�F��B	4V5'M����G*c�z#��]�sN:��3��J������|�>�q�w��i� �	zä�mP�ˠw��cSbL�doo�S^Yփ�6ءQ�/��mCM<�Y��c)���.��4R�%��¾����V3/t�x��<z	��*�Z@ܒ���=Ǿ�5';~LZf���⋏K'-��\s���j���-�6�x���j˦��^2-��4fp��Kps��7��8��qozp�MmFe��=*��uJ��eS�b����}O����kԔo}�Y��?����ͣڦQ��e?5�#h���䰫/Z>�Wr��4"����Ģ��T�)�"Y���Z0�x�N� PN�hS�����7npa��I���/Ӭ��R��2�G�Tϐ���)��� E�a��e��]4 ]�dIb�X��7�b��X�|�.�j��ޥ?}GZk�$~�FH��C�A��vw���S���$�(`E}E�X%/�R�H�5K�.�|��n��y,�׊�������1q�k!밝c� [1�d	���J%X,
��F��*��y��� �Ѹ�|����/T�Ÿ�M�����m� >C���d���@��w��r9$���r�����m�:�#Y) ���")�샢#Q���^�)�Y�[b܄��f�E4�g�r�\�HuVX-
���������n�4i��_.�|�U�6����lR�`��i���O]i\��Wޚ�b��Ԫ&>]�(�J۪[�VN�ya�o�6�&�W FMW��4#0��s�t�bx<O+?���M���1Ya�rӥ�Y��&�j����(�䤍��#�,�B���Ʉ���
���2&��g#�T�:EʺL 5L����wٵ��7��d�t��ۦ��{iz��)4d+��G��A�K��>*y��`,�@8�@PȞ��W,���dU%Ʀ��*���l��E=���o���<(����B�cxja�رy1��:��C޾}��w�� �O9a͝k4	A�$:J���0 d�,*�iI0P}�΅l�d}g��@��__�����i���&[�tF���B���d��$Ʀ��:�R�p*A��]� g��0�|��97e�Jԇ�@{����
+�/�X�y��~]}����ɠ���d��gy��C���a)�JxZ��aw�C���I�`UK�\M ��K!��۠H��+�J����B4^ )���<�mf�k�5Υ�w�R4��J���CM����fvg�uWI�l�Z�r���n���m��J�.;�ncL�;�rs^�4騷�p|�r��D���n���0�eM�B��&��l#0Z"Pʣť֏6��Y�M���楊�3s�T!}q���K/�1���)�|��\^���.�e�|���cl����Q�D��� Ε�!YY�;��Pث�� ��3x* }��>45��c�L�^z[������Ϡ�=��곡�Rf	!Z	*�$�2���`b,jq	)$��͒6]���*��2��򗧾!m���D�Ԣ�.���}�����?�㥍xޜX ��rM��KYЀS��K��t�n2�G�ޥ:���m�����"]c�Ch�	�xǩ��+�V�q�F����F�v��K@�"������г)65�|�>�/�>k��La __�p{�������Nd��3Q;��ߕ��D�����ĝ�����J���� #+g������z�H�dq��]y԰���F���yU�22��3`:� ��9_��R�����o����+�m�\��_9�'�WH�8���2/���/��V��@�D g�6�uL�Ͱ��,� ��i��,��(� ��D;k��i�Վ���Eʜ8�c��J�d|L�Q慿�e���2Q@U�~��8X0�S�%�`�v�l�����(�-~����͇�,]w��|I�ǚ��)���U��L-��/�rg�2����VU�6�e%�`�i�hlɜZY&�il��)�х�~��ץ��޸����@;���̟^žE�xX#8�Gt��1�s�\5Y����TPU�x��(��H�Eɺ]���ƾ���MEi�W�sλ<��#�*��l|�`RlTvk4:�A$��ʥĐ��SĲ�?x����~yO�cw�Ge?���e�,N�	����~@��P̳A1;J�2�ۊ>��C�=�7��,#D-kH���3�QlI�)k��qg%/Ԥ츷������l e��?.
�6yŴ��N�o�|:�ۤ�W^�.���ƻ.2㢁>�.��|9�{��6��8��_������*�?��=<�f��A�&��o>$m��Z�U���IWW�Q.7�^��w�ɜ��Gy�}����EQ�Z��*�j��.2� �G�d�E,�����X}��� ���;/Z��]�'�����o�Y?�rh��Tc׻'�Ŕ��$Y��y�]b�ݼe2XZ;���R�F4��X�R<d	�N���D�x1���zMz�V+�k�rэ~>��ߦ��w��c-E̢P<��ɰ�����������Q�;pn>���^�(t;h��>��ioH[l�^!�[ .��`�ғ|	k9j# p�>H1�� 2(	�Y�*K��y�k�b$<����G��L�v8>M���F�ť�t�	~�(6���1��E��f�d�F]+��vݺ��d����*�k(�Lπ�Ѽ vWETT�7�DLnɥǧ��X>�����6I�7��!3��z�P,�+%,^���)�ԾΗ�����i�u���/�t~qfa����F�y���{`ي��Ϳ���P=���F�&l�09��p���� ,�e�ud	C(p��Hf��z���XPȆV���,�$R�
�@[��k�7\̸o���ca��3'R�����I�zy�������rm�ЁX۪#��uO�p�0�Ģ7��c�nVोW�J#��4I��2H�Cj�/逇Ou	��=������H�]pu�H*��h�������|��iU{���v@���־�K:p~
6�H��M%uȪ���}&{C��O����ܭ1GfBE�Ѫ�s�}�qqQ���w�{o�6�[�KHU|����2R�:�P2>e\��PEÞP�P��ޏ?��PF���cl�	�{[�h�`�~2��2���	=�%����tT���L[�c�S�v�.٨G�(U`+R���0liFb��m��;Lq&��<VG����q���;�+���y����^���4��O�����t�G�K�l�.7�P+�#M��9�4u���t�(�u�� #��E�6}�1�{�uk{��&�b��<�B����N���㚾�-SbQ�"@7���%p��h(H�q\.b@1gZ'�L���+�Ő��l�k,��M��*�6-�(�+��\��i���m�J �/����=��H��X����J�����z�|{;�2��~���D����3�D �ް�	c\RG�j[J���o�o.��?��^�5׃�_}�ѧ����ج�ml��,�ܶͽ_��<�{������	Uc΁��@ԡ���!ja��R����ƛ�MLyH��)1�@��7g��S|�}W��!׹Y"4	[�,�� �	�{Y�I���s߃��v72rTck���<�jNYT�1�(;GTV�)�Cl��=�l8d(gY���<���a���%�T�:o�Յ_�:h��7��z�]@�1;1.���i�]6J�}¾�ʋߟ������+>����W�}��6-��={�͝�|�3��V�j#�,"�^ xAkUz3s�u�n�F���$�y�VL�W��o$�ju??Py��.�O�"$�;F�8��m�qY��1��@�()PqG��83�_@rMĕ�:#��^V}�E�e}���`1�>w�;������{�@\q�M�Ñ��3�~�G�^/���~�-b�{�^�ӝov��u7�����<a��ЧE�&e�AՄv�g��Y
.hf	�X�e���q�S��{޿L��4s����N@O\u�t��wt���LV����`|f{��v��ż0t���P� �13�:. �x��2��) zs�D
��>�8?��{��ݩF�����p">�7?F*�lV!V;���tve�d�	�����B� �p!r�o��k�A������5��-�0���<R��/ �㸔�t�-��
�RY#� j�Ri|EO� EB�^��Q 8d�X�+OZ6�g�y��7^��z���[�J��_5y�v����M?߳s���M��=����<K��mz4�q��F��#0�N�`�t(��c����&Ϙ�ǟN��� %���ђ��煜�-��I_|��'Xp�	Ie	�"�"����	����!}�в8���L,!�?�e����j���mX���g��q��/�:M��
���ۙ����k~�ĂO�BJ���rrdJ:�J�V���UC��e�����6PYFb\��F}x9��}�:��r�9麛n�j���y�nip�= �w����IqbY�W��g�xA �Q��S��(V@L��.�@6��	�"8?��ޜ.��&�L��HO���9��Ys�u�����V�}�0�_0���~F�S�S�3�J � )`� T~ ��b���wJh�M�G2�i�-V���*A-�����t l4�'lK^"B�f�&-t�~62�s��5QK��硬 E��m,Z�����#����A:��7�{�zT�~���4��v�G���80���iҤη�����f��cA�����Ë��6�L�mj#������bB�YN��J�/_lAꊫnuw��Ҟz��	����7=u.��Zt��P��`8��X�K�"CA��M��whL���ӭ����K�#�� Zt�:�������J7��{?�Z6��}C1#aӣ� /]����/80<��:AG4TI���DY�P�#CDc��f�+>1PHӰF�^�Ο��z{~z/�뇄�=���o�����@��E y��ԋ�˦|fP����/�W���"pA����_����^٤4����z�~}��|B�-���hp�G]yqd�p(W�̒L�UgG %[U�n���6}�h/��O� �����Q��]]bqa�9�<���6��j3^TD!I���Ju�ŴR [������x�1k���O����X��n��k���}�����}4M����=���fi%e�[��WP�]V�YH�	��5�)#�w��p�~�@{��z�mo#��[ۊ\-}0�s
�bLq?��]��; ������#,����.��<�h��x	SY�hb5nF�\>�d��D]�!�=�[oy����Wt�2���������o��1�]�Ta�\�����L�c��d��Lm��NVm*��B��e<�=(�ڇ}��>@U'�K�:oP�q�;oN㉡����t嵷�v����<o�ɺ�M�{!��_�`��y��T�pg��d��M�T�u�e�F��n�x ��m����t���Z����֞<1-nO��i��1|��OV
��W� �2D������ �8���B�&�ԓ3�c�?�Bb�Z9q�!. ��>5x���D+��Tx�Y]ś���ț|\0(4���YM�u�Ĭ�S���I��(�7ɿ�;���y[z��N�����vN+��l��+�r�1���"�r��(�@93�"�ZW�����f,� �S�q�j��l�	8���ܿpB��3F��ﾱ{�����0��#�\�"����a�z慝0Y�D-�X&�Rd`6��(ۡ�J/ˉn[2��w�K�-��"��v��?��]i�uV���]e�l�����s��ŷ���ho���!	+ db�WPֲ|���<~A��������﷫���×ϡ�9|o޾�M3�^��3�]w?0\�z�����C��V��5g;��y��#W �#��+l��sW8 �K�pQ��I�/�+f��'\�<����������QB�@VhK�N1�4��Q5Y Jd�
�D6JA)@��v7�ᇧ��Ǎ������\�C�W �"�(q�P�\B�:�	S�aRf���֘5�-��cw�W_c���C�=]{�!��;�K_=��i�-7�_��Ww��1�^��d!c[�E��,�:���,����1�i#�0"`o��h0]�0�T|�x���ߞ�6��:�o���9Z^���W�ok��.�8tU�rSd�Wo��`"0�����!/257�E�w�9���z��3��ro������5yR�����)��>�������m,��''��w����\#�r�62Pr
�e�U�0�������$�C�P;v K��/����<��W��,��WI�=��]8��Y�e������� ��N�q��8d 3� uQZj�N��L�u�13}��`�+og٫�	yq�4s��Q$�Å4s�tȁ��ȈH��
1�ܨ0��:���Hֈ�yMO�W�]f)k������y������EQAˁ/A.cHJ�J�" a!Q8J��b�0���R�§��%]��L��#��~l����#?�OZӞ(A����"Ccm�|E�;�^�|o��x�"0���|���m#�@"`o��Ks�r��_P�_��%���&�Q�m��m��j�Xyl�V��G�-npsS��iʆ:�I8�M�\Y�Q*�^��`�Ja�e
5�D����^�{+�����;}�����x�X���x��F_���q}�y��t(n�6�� :��8��a��R���c�ISP��5-��В�w����L�|hZ�>}�.�Ѯ'�|��?��������+ �E^$wXŪ��RIq�.��#���tg�&�J�=6�7ع�/�MW]��`�8p�>QԎz< %4�#-��DI&=�d�(HE?\~�?8H��l�%�`��={�o4���"�crnK� b�G���PEj�Nͬ1��>��iCC�Yo�t�a���^v���?6}��}�ZkN*4[�O#�����Ӷ��^D#�U�"�~�v?F`0}���s��a���r�.�g��M�K.�E�o�=�]����*:��U��0/�,�����a��*��E�;�uE��u�]�L��Z�g"�7�n����e��=���C �@�yn9�]F��I6���Ho�j���)�7�q7_�k_}��mk���KXu՚�xB�E|#=���@%��6��T]s���1_���`�� ���/��"��j�o�1�Jkԅ�	�o0o���:D;���g ��?�^|�&ģ��~�5T	�LT�K�	���%PA0��q���"ȝ���f��{�g˱�0�[�QXP�{�)@*R78� �\�r��(]D�X:`fM"���g|LZm��_��1���C�տ?$}�?�I+����æ���ۏ�nۼ�F�ϰ�����}��t��}��!gOL��Et\���9�����7_�B�I ��Lp��-T*2 ,V|�R�D
���Y)	#p�B������zR��y!�S��\�C�{-�LX*�����N����z��"t�}��ך��J����]D�ڋ��1���o�v���oN�U�R�2�,Ye�).88��9i�ݿd��)=�{���*Ż�`�<���4n�x���B �����L2��e)�9�isO����h�0�d�Xje\6���7ܛ�xb�T�W,p�0aqkWă.�/������I�@��G���j	c�%%.X!M��XO^��WU���[�bj�y���N�%��H:l!,��܇���@(�1hey>s:7  @ IDATAݙQ�TƸ���2��Ao�>����K>�>y���ĉ+q����I!]<�b��u���v�m�"�&)�[g�3����7���9Ww@�#��sL�Ŧذgl��c���＿?ѥ��Mj�F �2����)�x��&.U<X����"�HYVA�A�8��$�S��GYl�ؤ�����d�Xp#��F�l�G ڗ�U�画�Q�%����2��1���� W�7,���][��j����=o�5�i!\!�2�f3��RTl����uT�w!|�ɿ_)�<�������Sl��ƌ��n�76J�ݤK�dY#�\'��Y`)[V�8Q�㱋/����E�PO��h��߲�Ñʁ~���k[},Wb
	�Z?DLH���YΎ#֯���l���L�*���������[��p�S?�B�-��C���ņ1
Q^Pl2�	�3�����q��s�����t���L_���i��2D��\�h*m]���K�].�ތ���k����5�"0��~�o[c�j�U� L�>���'�h�Ԛ���6�]�?�5Zb��Śk��P��T*a���ݣ��b�4:ˡ�ذq�i�:���>�:Dw�\s��Ԭt��H��/i����T�/�|��+u1�&�"5���7�8]����X\���h�G�՜,�8�x�G�Vb��$�RE��<Lk�����V '�J�Qf%��c$�d8�PZӗ_~���#���q�G���̋�%��Gs�k-1���� �)�W����Ɔ��o=��t�'�i��W�Ǐ��h�v��+�pz�pC��`e�6�0�L���ZȌ��Ey���I7��w/�#�K/��),Y �8�cN��U J��JR�#��+�&��I2e���Ė^zlm��sb)�£>�����Q�e�`�G��*�{�ZFgK��o���>!�����ft�}�n)�;	���N9mt�����Z���p�=%.��B��5j\�X�ȶ$e�V��+�4lt���
C�RDi�3��>3������M�J�~�i����.���w�i[�Ƈ�0Wi���3g��x!��xWu`6�6G�ꢐ�p�r�}���G��&�7�~�H���)6��&8�cP��\Y�i��:��v��+0����`E��ޭ֑�=���ӑ_�C��	y8\���$��
�����3Oz�W���1ol����X�Z}��{���.)`�� J� �m�K�k�~��&�gl����Tϕ���%�y�t�j�ǘ�{�~1��DM�ڧt���� G;�p�3Ie�(��'����3],�^��F����o�zd���pk�����@�R���N�����kf�G&i�-KL��=	�K���$�+.��є����X��I^��dN�_Z�4��&��YNwNԡ�Q����!+��dPɆ�R��ŗ���Zl����ӳ�N����/H;��iՍ>����k���M��S�s�Z��]��?��������8Р���ٔ͵>�#�y|��}P�F~	����TV�Y>�j�!0�q����ZU�t�@�Xډ����Ji����������s�CQ�����$&�"`/��t$�W4/6nL��g�N;n�ɂ�c[�yG瞝w\�F���#��c+"�G�$2���U�&1JH>�␢��@ʋz*���^}}�}�D�Ƥ	Y��}1qhǱ��@^z-�(�aQ�Ƈ-���`�m�49��x\N�J(6'����|!,��K�����u�i��Q�q��7�m��|�1iʆhxLŵ��0r_��ԝ�$���A4h���yN��w�j_Xp`���c���~�j���p�R�kA4�G08���F(iY��A�-7�,P�g� 2-�+Z1P����4(ry��a����r+,����-�k_�qZo��y��un�U$�=�;6^��"m��"�1q��Io:���G��s��O\T�Ԇ^���fxN%^ȓcGcN�x���/ GX���ĝ�;/�H��N��K��ƘƆt���g�܂�x��h������m�&�H�����"�|MD<�:^P�S���������kM�ב�n�'�z���O���/s���ǈ
 ^���*Ę�>8�Q]A�\��y�-��X���s[�����3}���O�M���/a��6 0~}^8���0^�vƁZ9�JR	�g��(
>� 6���Y7�:�~rʁiם�k mj#�8����m0��bʕU/��m�"����!7��4�0�6Z`�ә��n��$⃻�Z,wJ�E[��}�X�ė��$��?S���,cL��G�w��y,x�WI �&�+��
Q�k$1�v����v�d�*;�d�iS�����K�n|'���1i�=�����e�H���,|��Ϳ����1>_��V�k��eo��;����=���}��=hX��
l�"�GIc���������7q�)��hE��?�>�[Om��&��3f��_�t7�n���~bx������u��W}�ˊ�v�y����P�6�`b����zi�W�u�Z�Ƿ�i�ͤ�ך�j<�L���%�
5�!��`�1w��
eI�h��V͜%�|̄ �X��1s��M�b��&���9�tq��'r��� �]��]�u��v��+��k��b�j[�"��l}��"�}�xOG�\=�tC��-���M�q�\�w,w�7�r������]0�X���5�[n��w��3M�q���;mȘ�6�sq*���Y)��Վժ��m�H,��i�ˊ�,�Y80���0��h+��pdD��zނ�}�/�z�}6���gҁ��a��Z�.�mz~"��j��M|0m��D�.���m���ׅ�!��8�K9�Bf�m�Y[5F8XPw�)��ƅC���}~�{.*�����mG��u���Fb\�X�ㅱp�2*T3ҍV��
���kJ�(�����z�t�io��~:?��k��}����S�o_oA"��������0{�� ��E��w"�l��z���W����<�!] iĈ�2�{S�$߼,� 4âg��F]ϏSB,��J+��ꕷآ��m�[�{5ì�z��m���S�Ll,_�W��<����A�_���Y�Q�H�`�Od�g ��{��6y�::�{/���bF'�����[t$(bw�FF�-�BŢRZ�dIh��v��j�pQZ7C�)��s`�O7��Y0x06�����ԌY��nH��ǩi�f�L�v���k�b�y�Ө��"�-jsD��;+�]fB���oO�8d'���X��f�y,6�e��0�^
�eB0�О碛hX�/��v�}LO<���`<jL���S�n�8�l��а�{ s���4��d�� q��$�3s�� �������`����1��t������]7���7P7�j���{]k��]�������nh��)ڄ	[e��7 �Dh���Ĺ����K"�^��Xh+ۉ�s�E���(D�=7����[*e�*�<Vj�5��Wu���ܭ���(G���^��o}�����l`۪E/cҷ/��n��S�v5P1����0_�V2E�ba�����ο��K�KS�y\�-~ԾgS������3�ȃ�bV�k��-x� `�X��dY�*��]�|�� x[��5���aCB,�0�2� "z#6U">x��;�x�5�I�zq�t�umc���q�4Ncm6�����Y��I/y�w�=�MM�̪o��Il�V�9 t0"�6�i��#��ĸB[��w�g?����HK.�8/ �Ҹ�t�/��ͰvY[m�*��N8�X�s�wZ9���#,@�Q
0�V0ɒ!Q)���B0�L�F��w�^r�Ai�5&B���5��e��~�WV4�d�ǮB���-�Θ��no)ǳp�H��(���N�Q����?p�QT�{#����9��n�0�m���(����-F84�(y�V�ʡʀ[�0t����<B��	��E\����ӒK.QZj�6��56Ol#�-��t�Yi�����F�L7�<�fqL����Q�6���`Ŵ� �n+ʎʧ����>�Wk�b�e�;��m�û!
�V���iʂ��WJ:� Ap�r f�+BX���\vP
����v&W^�����2Tf�� S���h�3�R�Q>rj��7ߝ�8�Դ�=!p��������1�D�Fl�a#��i��cn��q��;x;��b��燣! �ƒ �/;=`��mA�	%�6tJ@�vi���=6K�^�߷�?�3%⊧ ���ң��`��7Hm�c��?�0x�<��@4y�4�J<�=h���H$�n��)�z�7`Do�[�&�>ie
�I���mǻX�/1�&���c�{\p1 �U�8 0#H!p-a#��J���������M�Y��*8�ވ^K�Ǐ�&�8B�H,���*5ѣ4�$N��.1˂���;hq,P���9U���E������6b��r��V�F��O<h���p	�o1�ä{1�fԀ9��c��K��s�����t`��״u�/��U��kr���Q��0�.H2�X��EWX㊲�*R-K�!/��D����2��hK�{����\�βt��Mw5kSx���uh��ߖ�y�/�j[�9���o�cf4����	�FC��y<�m{�t���F Ǟ5@����ٍ�C�ӌ �yl����5�h:�p���<�Hc�)�/t���}/\B\�9�'����~7�θ�v~��HyC K4�B�E	.`��<`�㸵���T�<dA
!cS+l|��ۧO�7���:���W����î;o�7�u4#�D_xඵ�ԥK�/����|<d�gQ���b,,Æ���N��X#vY$��V8����p ��
�vF�T�r�� �
�>a c֐�T��8c��ޅ��f=��~�i�F�"���F������=���&��*�v3/J��}��9��c�e�ȕ	�o����R�s~�]vZ���W�:�iA�q� D�Dԅfm �[��V�B=ɹ&.h�ťK�*uݼ�x�Qe�K7�j��F�5ي�*��QZ�;���&�z��O���̫Ҟ�d��-�J_?�|{�d:�����wb�4|���H�����'�o�~�>��z���q�J���Ң��4�
{N/����/�*MX�����҇����H`�}����9v��{���ð���~���2��'�۝W(r�.����F�x����%�DU%P�{+���k���7�F�'6���ʋ@8���6���[��x���}� �n�Q:i��fYɣ�g52Ġ��v�Y�xπ�!.R�i6:�6G�A�%� ]���ߴ�E��� y�c�J0?�Z%�B�x����;����H�sV�tD��z�����P���ȱl�ҧ]��*6���Ё�ϻ��(����4a���b���������u/�W�]	_�4e�ʙ�`5	Ph�T��X��f�`�M���ꄦ��ٔ�!�؜�\��S1�Z���)`1�(k!�� ����vIoy��|��0m����n�۲{�xrF�`�/F_t����}&Y���M%��$E��p Hv�1|�U�MW���N���vڅ�o����7�ύ��wGKw+Y:�����L[��`U�u�{~��5� ��=p\�x�!��R��_w��p�����s'��$|"4u�q/3��zD�_(/��KJ{��ZX����+��L����=x���C�#�M�rCEc�#����NTž�S|�"��|)W��0`�F�Q?R��3��n#0T�5�	C1[z���F]mm���'��Xw�c����+�!��1��a٬��v�\򧛊�]�p��[n{a�/M�x����ׅ5��ʩ�45�Y����C�*�סUU�f���zh���ƚ�w��b޴��T�%H�\Ak�XF,(�9X!�T�5���;��آ��~>}��i?�/�^�S̆�p�M��Ͼ����_C#���]����/�,ǀ����Pr��s��#v�3	����7�z�~n���s��S�����a��"�W\A�m��*t��8�)2I~A?�<I1.�=��վ'���@|��b�����<���p�sl��48Q�G��8����yLC�ԣs�ER9�$�w��$izz)� �6zSC΀8�`~���A����P�*��J�#��5��c���C�h�@��<�"m��h�y>l�6��S҉W���$�!"�cJ�i� ���ɽ\������v�Q���$-�&�9�`+ ,F��?7�ʨIx|r����k���`ǺH���JCf<4�0��HD �\�s�.��Pѐ����m�g]0X�ã0�zQ�0B16j�Z0�MP�
 �6a*U���u+�����i���~)�&p���;��;�k�$Z�x�c׾�s��X�B�q���bQc2�M��8x�q>�H���7�)���<_tm�B$b�h����3��%�ޙ����s��T�j�j���U�֭z\B�V�j/�g���G���߹}z��^,}U"�:Vw��Ӗ��G��.8���s{�*~*Ak&��
:~) ��,����%�_��}�˂�A�0��{�0�]�$�2D
~�	Z�mGI����İb���O�pu:n�K�*��E����8�O	#�mj#0�]��yt��t�qz�qmK��I!<],�Ϊi��l^<AJS�s@���df�dXf��9�MED��͐�/�[^PK�_K,J���w��l�����W�(�@4�l��ZC��$ʲ[Y m�
sU!��U����^l'��ch�/��v�+˔UCL?�В�D�^ bU�JQ0��O�L;��?��t�͠�`�6��1��f�JS�LϱG|��"���P8J�_���@閽@^�[�����|q�%��/�����it��:�q���;n��UW˨g>�P�4��7}�<��&*(@�d���*Q;���	�c�!N�wl���ͻ׎
�IV�W�喴�_N�8�ʄ߀�[�u��R�X"��(x8�q�N^P�c�G���;�8(�Γ!`��އ�J�t��0��l��àZ�3�☰X q��@oas�16e�u���A)��k28^�wA��Z��@gV�$��6/�+K^�ۚ�D`q���S6#/f���B�1�r�n4|�O6�>��\��Ѽ�`�o^��,�C��0|ƿf����%m�����Hڠ������}�2p3�͕�"\��C�+ύ���,�&�xYW�I�^"W?K�h�RU���.���T���rQ����4$N,���!�)P���<'
F�e���������0��z��'�S���4q%n�gΜ�ƍ��,��G�x>ݮ��UQP8E��܃m,,���hԴB��{@t�!�P�	9�j�E�?R=��E�����<��0�����]4+9�*2$�(k����&�×��L��o[�Օ�I���t���M+��,e�����ȴ��e��A�뮇���CO�E��<�FPU<G y��� Q����d���85ڠ�M���#��X�`�N���_^Ԑ�H�K-�czC��e a����w�y3��Z�w����`u[�h�-��Bc��)�Z��@g좛]�mMgdZ��f��QW[G�ZƤo_<���I�MV�.&u�cE��}c]���P<�$M"R�"#�?Mk��N����)���B�o>����U!4�!C��ȋH"vĽp�i�H�ʰj4-᪒+٦�0A��e`�|���TJ���@��Y��d���i��*8y8IB�,��v���M[��Ĵ��'�_����	 ��Oε��S,�D�x�4�FMSA���f�0��u:�AA��6�d�4y�Ux�OǗˌL��?��?�>�����}72Q^�xA���bdJ^����l| + i����N��9`�����T�2�ŉ������t�=S��e���Z�B�:`$�U�9H$�����9�}�a!cj�9����%����yG�?}�G�����C͆�|��(>��K����J(\V2|f�C�0��Ѝ�*�ӏ�����]�j�����F�#�S`���H�I7��^�������,̶�:��ߘ�!�dxi+ˉ�	 �) �&~�*�o~�_��G!��y-��/�kW��J��G�ZȖ|�QYR79��(H�tA$C�@�&���x�A�<�vW-�M��"hX r���.����U�����h�ł�
̨[d����F���;��g:�ÿH�o��������ɔ���q��2Z'�9	V��1D�`���pi��v);���k����Ӌ��x���,���)#�]z�M���j�F�Td���|�HA��J1ɫ,�h�Bu�&���)���_�i��#�	n��^�����'_����s��.p t����C$������nV�Vp2�`+-��允�~�u�4[e�gͲ�ޱ�O�������aCdr���[9r���}U��vV�P�5Hd��D�2�T�m#�-��y�}�-��������F`"���ҿΉ�Z�z��}.)F2�������
!���"q�c�����yD�,�g@����ٷ|�?� b>3�p�r #OZĜ�B��C!^�X�f*V\��m,Qu4P�M�\�}�>��f+�Ԇ?� 0=�S�a���*�hm���ء-���l�~�����E�=�wi��ǤC��U�O�����Еm[0�"�������E`=FV��FqT0�F�1��KA�!bX@>��}���O�n�n!12`yQ�:����-��1� �JY���f�K�t@+?v>�]h��^�^���^ɾMO��v9�[i��`@�}�x�����6W�u~Ѐ�2��`�\�	�RMеM�~�H�ζqN�+3�z�.ֈ7��.\���#:7 �<?���r�'BRd��r���6�R����AȅlB�d�LTҤ�Y�����v ٜ?�V�����@�����;�^?D`0s�`�:�0Gw\���V��VM�ܖV�ʑ+�J�Bc���	�-�} ��ۚg�K�p���S7�?|x�;v�����6��Ž.��N�fk�>ٴ�KR�D^C��(Z��s����o�X%�pI/}�;�A@����f��*��q�`��$I]�t��ИA�Ʈ�v��ӫ�f{|5�f�x��λ��w�ʍ ��=���	�B;�_&�A�_��h�8��*�'�f�� FEP���x5���g��N{{a��G(�(����E�O�cl�킋*gk(�7����}�_y�n?�۫��5���ǧm^qr�Þ��C���q�D�1h|rś���,��<O4��X��:�Ư�=0'�� ���I>�t�����n:��"%ӛ��g�dR8f�UBz���F,�
�	I����Y�u&q�+�W$ Ц6�����*�x�i�MmZƤo�qv��*�MzM�j@5�V����N����~�o��^��e5���iE@��z�|����\0��y�+6�$���
�BS����X�-�B�;�E_Aʪdt%�ґZ/{TvAT��E	�Eg�1.��r|h���EP�zÞo��]pn�٣83؈$�%pgD�6��fR�g�����#אa�;��N��V���'� <��>Ɔ�7U�\`��� ��=ԯ"YP,D+�#"P�EϦ�Q����G^V�_�"�ҿＡ��q�o̠�����ߧv���/c�ܿ�n��N���&*��W'Ԗ�TlQ�b��=�`���?�G���4����g	D �a��%%��$Ђ͒�pY(d��h���8B(�4\�} �=�֋�O%xнyM�K�>J�U!�9ީ.�+��LQe���@��蹊H�ʒf���?����s����v~.��n���@���ʶx���n�i�AWM�>�:��~9�V�Ӗ�qX���S:���n)Ue黧�»U�]Ê�/ڮG�7~�Z� �M�m��a������;E�BT�β&�qI�`����~%/r�
R��)n�mG�Z��=%�P"���ȋ�8R6�.�ka&7Yxe1�h0]|����V`#+�ʘ�)P����8m��W�+�������Gon\T]?�����=���iڴ'��x���hU�f�V��eh.o�̊���c�5�$`q���̋-�$��H$�����]���8�L�h�F��S��q�Y�.�\�Y,����0��F�x���q�Y�_���a78|,��
D41�1��)�%MBf�${��-H5�W�C)c��8N��1?��T�<�d�	�~��ky���p��������j��W�l�y��B&�I�-�T[-���|E����n��<�4g��`�Um#0���_\5�<o�T�,"��W��f�����bH���S�'}��mKX�&�9�ҋ�w�I��q}���7Z�b�����Ԗ:�E���5�Q���ʾ�d��mj�Z�Lo+[i�2>.�d:�q�*�!e�u
q{X��w+�N	d�*.� {�B�����8W�;���MS!O�VDV�?_q[z��OI�pR���c����b}��Oλ��������C$�4��
]%t+a����K�;e-�cf��'2��$��0��E��n��Q�y�f��B,L��"1-��mHNe�дh*�sx1���}ُߑ&,�$�{9���TD���_�_?J;����9
�g	�】Df�p;��*.&��"Y��.�C��O����C�U��)0�Z �դ��)��; ��`# ���!��> %����J=�+a� 3XS�c��l!�.%l���e��|���F`�#`���̳p+�F�9D@K��`�Um#0oL���"|բ�u}�E�2�
v���=>m#xNy�2���ODk&�`I.0��s���.PM��.Z|�V�x���Y�P�.&������PM ��h�x(��g3�~.ژ+����E`+M��f���?W�jJJ�+ ��.��[�d�$�[�2����7���@�n! �M�nɥ&n�	����tｏ�M_�����I/{���ƿ��w������ps�e9��Gi�a�* *C�%�ad8a88����"A�(Df��,�	<����E \�y��?����[4��+4:��M'K��БJ-)(*Uw�A�R!�����.>��~�O����i�]>�����S0}#F�.B�є�V�����F��D[�a�\@z�U�`�K	��.W�1dn��Q�YH�8��;Z�9� gJm��G�� !ǀh�@)#*!g����djk��|���m�M�f�����b��F`~"ۧ�Qie��ӑ�ۇؾha�ӳ瘜}��9gp��E]1ZQ������j���n������+a�-��Ʊ�Q�3�G%/&�l���>]X$?�����{^����.ـB�e#��GT�a� +�8m�f/�6�y�+dC4�%����V4ޱ�%YŦ5��<$�2|�c�{W �����7�ە�k�rw�������ߥ3�]B�<��HmbktA��{���D��#�a4#�w<��-�����n�� ��0 ������}�/�OW�D�i���G�c������D�䯁pIǀp��a�B�t�)KѰ��`�h<�d
xcF:����A����6��_���C�� �GȮT���8~	�k�PF�lHo�t��K<��t��d�\�X��C44$�@T*gN�����y�I�J� �-��q�v�ǌe_�؎#P�H��tg:"b�
=~��8�C0>VX�4iڼ��s������/pz�Zm�F���
��6�5��īҌ�D,S�X ���X%b���S �#� �\��-�d�E,��_{��=� �7xޱ�cK�N\��	��\��c5�U0��c�^aѭ�mHA7�dq!�nV!$����䅗-Ĩc��\ug%�⪪ 4��|��"uWq�,
��,^�� 6Q���V��:+���9J�g4�m�
�_?��i�;>}�_�i���x�6�:P��_\p#}�f��RU8pV����Q6�$�!X%hL �\�����+��&O�c��h��N�ޏ�+oJ��p�9b�A�ƀ��p�DQyB�/Ԥ^鸉!�'`0�z@������|�ǉ��c�����O������ϥˮ�7�qt��{~��Y�[�<���cJ��a0�3K0n����Fid�%�p�l��m���3�>���F���?7�l�T�V�;}�>�ru�)! B���xi���i�M\�ԊuW_�[���s��e�Q�Uo#0l�%���-������`�}Ͳͩ5�Kf��POM�����O�#Af�ys.+�K)nt�Y��h|ʢ�i�7í�K�|�FC�������w����V=\/�f	$�r�y�dh�}YLT�b[]y�N���z��1
�Ld�gm�ރií� ��r�OQG6@���X3��u�:W��Ĉ��l���i��єL�����Z�>�7���s�
���8����^_K�������/���rl2�S����
���.�(	�xY��e�ѐ����?�_ƌ#�?���|���ǩ�-������@{
g<tU#��������+��7 y��c��җl�>���Ԥ{��m{x���ݫ����qǿ~Ƃ_�+���aP0P"���cA�1JJe��`f�PEVI;Ce&D9�� �DUV�8��w���� �U�m���C�h,�������3<�qYP�6��@g��m�-����ĕ�����l)�$�#%��#{���z�}m��<cҡv�ާގy���ye�r���-�A�
 ����D�� /6����o>��`�ݿ�����k���޵�=>.G0�X�Q�r�"��`1~at��9,��Ŗ�(us%�W�aы���w7y��Џv�-�U�EE�x2@�#���(|��>��(`C�`˽1@R�[(2X�@)�H6x�<�U�ہ���9��6����ߦ�v>>���g�9�]��#����SJ��;�-�1eD��⁳��ǂ��ɀ2��ea�p�p��mn01m���$����'��w�O�W:�t����i�p (��p�$^�K8J�Z&rM��q+)g�f���>�k��Q/�dO�I�]60�����6��ly .�O�wJ�qHB�� ����c�,
���<��c�Y�������#tyG���H��i�<ip��O!1�v�5����e?Oh���7��~`��H4�N��`v�CQs̈́(�rBԁ*�4h���/iT�E���[�f�E�<��<P���j��o#P�@o��kMl����Y�����_Z��?�L��y���y�_��&n�����v9w�E
��� �P,���t~�z4�� ^f�Ri�e�ㄸ >�1pw�e-��@4(��a"��^���Er��,�I�V1iw0:	��!2_	�8N����A+-u0e�%%���hS�U|<&ԩYi"&!S �g�@ֆ�a��~I��8Z��g�|&����7}�'�iӛ-T\w�ql�s���؇"�����Cy����ym5L�5UBG��E#��-�8��q��@k�W�:ԔJ#�����Vy�ކɷ�z���ة^m�ao�������/�j���;}S��T��Ad�)�N����T2Q���A������̒�"��taS%g0����E�ш�u1����Y�q�I�?��� ��
��2@� �h1�U�H<�D�S�_�����em�mS��OY�6[{m���j��F`AG`�t�N��>����	%pl�撚#
Y�����kMܘ5	ñ/�ҏϾ,/�C��' �bb����7/baN��\A kWQ���E���P�=	��U �b3�h��"�3Vof7�^v(RVx렗5Ü6��6X2U�!P4<�E�P����ѝ=��$1˜�kk �vx��+bC�bQ B��`6,������\n����<���֔Zh�o��s{�i#%��("���!����%�(��	tC�$����;&���f".��=qp��P��8=2p#�{!_�J���2<ҭseI�mא��:�S��!/�����n���i��'�~�p��%U@�l!�)@�R�7�Iﱎ�LD���
�:��f`������lS���f|�R �ā��f�A{�~e���̙��?:R3�!r�*�2�ٞ��b��r�+��A ��g���.>�С��-�F`>"�_͇|+�F`�"0Ԓz��[�6CE`L:銔�\^�LL�ͩ&МɆ�F'J��g����<I0=�D����"Qʐb	��C�"7y<��W�q-'vL꺃T����֛_c?k����t8%f�ۄ	Z&6Pu٧!�	���J𔢞�3�s}$��+�@FQ�W%(X���%�B�j���ل��2F���Y��3q��L�rulx- X�}'�����R֋�L�1����<��->r�t�c
�����5�{1�W��C�B8�jY�PIB(��'c)��5[��;�Y}����_���P�^E�� "�G[��{F�:�U��qR����5����?�+.������I���;�؆�~]�.� ��rO}L�&q�}�z�b�3�RC�e������ ����eK�F�,�Ԡ�$�cs��D{A�#�����fY�s��:�1���g�B���p���a����<��.4',վ@�j��?-p���E>�:�E>m `Ƥo�qN��>��\\���Qm�S�}?S�p���8��S3��95�`�Id��s%h ���Řo��^n��&n��(��/�7)m��l8~�av�[�]wjXZ�@�8s����z7��̵�`�3<'���g���R��Ц��V�W�?U\�d�!(a�2V�q�^�}��D�u�
3�W�w���1X���R���M���"��lg�%�&6�F�g2�?`+.Xib�2ܑ�{)�;��!B��γJ�r=��q�oن��9ED�����Ӑ}Vu?;%���E����գ�lY#o]��E�Q �y��� 3�����#-t<4>��	Bvc��.<���_I�\e�#~�u��Yi���j?5�0}�;��rj�GCذ%D�TF,k�@h�"�XK���
��K�*�v`Kn�a�c�̝�9d��\blz���I�~�ԒK��-�[-P��D ؟

JK0�$��
:x��4Z���XR��W_cEcXu#x�`FQ���R����fG0{�v�jm���ȹ�l#�"�^ x�kU�G`N��_
�r��"]Vsj5#�.)�r3P�-QHe} $d��q[&�n�ql��r,d\�fo����
~���'�*h�@p���K��5���,�y=D�o���2bW[���3�n�����.��P��ߣvX�D�ȱ8sjn�� �uDEYɸ��D��fׁ>�S�Q #�1TM͂�Wi�>���!p��j.Ʋi8�?[m�ǵ�8��B�fٻ)�����%�O��G*"#����VÈ�J�e�|<cg�(���yea�z��7��o�j'�A��`1s?�J'�6Y҉����E�������'���\!����Hk��ʈ�*���~�5���_O�?>��p	� s
�a�B��"e��F,������%5QU�4`?& �?	A8�B$��}��p�sXh���K?�ګ��v!O��a#=���f���O�T����⧘��@fI�I+p�HQ�;NmJW���V2�څivJ([�Ƥ*���U���r\67�M\v��J;�+K�ao(����~g��V?z"�\I��ZOF$���4�r�έ�� �}uY�1L����pp"���dJ�S8tQ�X�4�qHx��s�w��/s%���m��^/WZe��\��ή`f4/����Y��m6,�L`�XPah���w�a3�Q�`�1�¦�A�U�5҄�lW	CII�;���F�k��e�\�Ǖ���W�˨�F���B��-;Y� l�N�(T!�.^T����k���kސ~�Q,��غ�[�p���mSxT���٤�oE�i�����w�Z�2  @ IDAT ZRi�	���%I$:�?��� ��.&VW���`Z�X1.Q�Hp��FL�d	*I@�9�0�f����U}����7��x��w�ԩt��>�owߖ^kC��H�o�Y¶�L{}�T�)3jӚ���Q]��i�A,UH��a���UD|T�w|�a�M˫�}17��D�u�dj7ǅ�7|�����F|�;j���ӆ�~W�'	H��a\h$�� �ʥ���V�~~����hf>������ۼa�k��b��Q��kN�87���M��؎�~����g��R1�<�"0a�+��||$�zEU(':(>�[�O�N=�p�q;r�3��{U��S��?�.�����������
o~�7Vu�}�E`p�s�M�ԣ�e�����O��_��*��N�I5�N�5r���o�z�v��!�1+�:�@�R"c��Dn&Q����e�7�Y���/��/��-���D|$z��ciV)A��x��*o?���Z�.���vX(V(�5��j��Թ�8B��yA����`VoF]L"�
uO�� !Ɔ*=C�Y�H��
�H|����k�k��n��[��x-���pȟr2�l��I�;�	+�\M�g�?����������O��O�Q�'�_��A�_�+Y�>��&�)'}��ѝ#,���슎u��o��o�;f�g������rNApa��C�8v�����>A�*�g���ꆠ�s�5.�� s�(y�^�,�|C���5Q�
�V\i���cv/+��L��4�ċztW@Ə%<���30��5�g�:��J�{��cH >�D=`t�^���ٱ��3�O��Oo�9�){l���c�\yt�c|_���|����9���'d�ZYv���
�/I��q+��������i�#M�2���G;�퇏���%������<�. <����E����v���Vٟ������)u��<����l)�w�30�r�C�*��]XUkOE4�{m�����*�����Z���ݩ|�. � !l]�Y[~��u�MA�"�W0"V���:���W��(ق�I~��������_l}T���G����c��T��_����>���,��J���U�!ux��O4,|b@�0�P�*�DdЄk���6ma[\�]���2�%,�N:���N��)�l��I���7���2 �	���[�M^����#o�>���	9�o�}׼Ļ�M��p�ʢ��u6�����=�ﴟF����x���?ac�ח~[~����]����s�>�π 8�s�5i �`B��y�����Q}f3�G�kD|�]�g2�sI�[&�@��@�q����(��k���r�PLq����M���~����Sp�.�%D! �d�c|=��*�\�y�m������P8��l��:c:�&k����~���ya�mЯ��r�]��fͶ��.�\�`�u��r���=������A���{���dq�L�q�PI�����D �u�8���;�8!C�Z�U��3u*�Ce�5V(kO_�.�-^���E��._V��h.�Դ���X�?�q��F���Qi���a���w(�� O!� O!X�E�G',TΝ���K~@����c0o����uL �9���J���³v�	��M�>,�H-���$~�7�X���h�<�묷J���݅�k�'"�k02��2����tB�h!�تq-�g��'�XY0��0$�!;�7,^Փ=����ղ��2�ѾA���U�+�AN�K~��Ⱦ�j6��栈[��0�T�h�����[��Xm�Q�3�nHɃ�c�;?�N��Gn�֎o�>�v��̖Ύ�*b���.\w�m֒�����pWM\͐OOD���Q�p?z��se}�����?�/�b#s��f��Kh=�ϗ^�c�~���L d	x+�1F��rs"FQ�e�#9� ���(Q��g�0ɰ4�x=�:�W.}l����m�c��gk�y�\�� 04�	M�6vU9Z��7L��	����b|!-���7�j�x���S��"sG:�&R9ꓝ��x��m���U�+-�^}w��ڇ����U����2����<{���cB��jCr��ݰ���ֻ�g��M9D���,�ܬ[���w��&�o�h���l��r��3 0�u\���%���${1�m�)i�=n���������x��/�5�y��j�g���s夅&�E�X�~rj�n�ʚk,j
�+/x�2e���(K/�w*�";�-�E����W���O���ʃ|��������LO*�l5W�j��MN� c�����rC�y�Sq�V�%'gl�%:,�/�'�}!e�(�<�n 1�J��#�X���5}��K�ٔ��M��~!. d�k,X�P[��o�k�*^�#12�b���LΝ���[�8I#1sG��<x�gH���V"��N9%d$豢���(�,�U�D#�9W��iD���� �}�
a�`�8V��>�e�V�������<��+m����x�J:hd��}Ke�t�}�&���D�ݲӶ3�_��1Ɩ� ����������V5L헲+]�d�'J��[q����׿f���v3�zs�RT��DjG��6C:����g�zv��;'l��m�S&O�_x�;4��p(>�ʈS � <��CRՔʒ��>I�r5!�hG�p
L�@c�4eR���k�C�޾�f/eD�`����p��5�Gm�e�Ŝ��)l��O��R���H!�	*� ��5��yG2��N�<+�����q�F��M&�����;�.W\sk�ە3�E�ٷ���\��֏l�kW]&�E5�y��#S( "^q^jb���ηoه��7^c�� k�!���܏��h��'�c��ho�3Ðlp7�,�s؞4�ظVWt��&�(?�W���P�,tD��`�M������Y�˟~�\q�4��]���+��Y�l��*e��,W�]{Ų٦����/sh���z~�����Z�^\1`�������{o����;�\�4�tα�5�O��y���u2 (�rr�o�%��P���->k��*@j�C�W~�u_Yy%����ɴ��q�|�?̰ '���T�,�=�`�y�s�]T��V�Ţ���h��ӕxl�{�V`]ދ�3��p ݲ�euS�q��*AR��%ժ��ݺ�mȝ�z�K��}W�p0`��/(`�$K'����ګ-���>Ҵ�t���,��>>�A�,�Ծ��pG�#�i�~��pע���"���ڛ�eW��rj�ꛬCDW,PK����0&����?C�x׏*��Zf��˗�cG"�b=���Tv���u��e�o����$|]l��[����;"4�������C������㗂'��nf��:m��ZR�h��.��tRY~�%�W>�����g���ڧ"���� �����1����Ѱ8q�6�О8z��� z؀����ɼ�j(i�J�z8����	�/�踏=����9��~����땪{`~���Sq&� `��0;u�d4l����o�*���N��c�G���~5������:x�>������~�KU�{���S�2Q���͗ys�׳x`�q}�����f>\.�ym��k�Ѫ�*�Ł���eVX���m�-6_�l��ʪvE�؈y�TS�Ri�������+S˷O�W.٢�7�>IbZ�S�A~�l)I��m}*'y��	�@�zS"�dn�����t��&�%�����u�O|7N�����b�_~���}|����[�ij��Tyrڂ�T_:���pPN�b&6:{���y������!�[���0oW.:��
��"�%���h�I�{�JY�\�ִ��R���R H6+���ρ18f$U�Q�D?��e�t#n���yQI����3�xՂ����"�# �e���/� KN�i���W��G���܎����
��W�~�����<��2�������U=`B�HA���>��s컝<������7�0/�P�=5�����#cFF� �������)�ܘ�h����[�Q>�&�h?l��I�l����/��V����go1?�~�=[���(WSCd1b��Q-h8p�큤6�0�\n��=�i|�F2=P5c�5��i<9���u�ٜ��ȅ�1s��ȗb�2W�!"��Q��c�a��O�/|�B��M����@���LV���Ǹ]��\|�`m�5�qc���Kwة{���kr�8�F|��J]������������ʛ`���
Ȗ��2��;�y�[�������q�����|j��A,�˥[z'�tڊ�c4�!wX��;=�E���#�я���mѼ`5q�N$7�&�}8QΏ�׮������Ʒ_=ߤ~����o��o�g:���~�3�-XX+)6�m
;0%^���tAY,���V؁v3P��탼*v�]����m�y69���N�I�O�Vƿ���XL%�G^���?M�8�y@GWgW�աb�WřaXu��#��JK��؊6Z�=��F�]6�̘��4����CJ<�4Sej��E�q��5���������c�þ{ZX��>��y��)����_�ȱf��ڟ���|xcv�i�G���1��?�s��h�c����.ʱID�� �3�õp�è�E���f>�H�U�\�`�3̂�������� ۧ�c�w�yF������]�V΍ɂt?�h�	����XK�7�
��K��78Z���v�|�� 7SW���N*h� L�l���px��x�K�x�5�^�S�X��[�Z	��t�#Z陙:�`p�P�UT9 `�<^�)��wz��������Hr����RV�PAu:T}��|�H��� 5�A|��8��YŨ��ƫUɹP=>Xa	,k�� �6�\u�_�Y�`����{���A��ьٚ7I�LP���\K6;�#r�4����F��SDadML��!)�w`H��g��Q0N�G��F'�gc�ʮ;n��߬:�O?���T{4g`;�1J��:r���&D)@r����#�X��UA0�W��hྐྵM���o���V��[A������\�R�J$�%^08-�$�7o��s$6/\g��b��<��׳*�X�4��*)�����t�э�!����`2z�](+�Jp���W�Xm������'7�����=��>���/�`0�/d)_=t��C=���ϯ�K�������m;�ҳ�5� ��D͵��}��˯N�����ڈ��!�
P=58����G����=oq��(vP��\�KSk/ �<X�Xt�w�y����}`ǲ�4�\tAߚ?��Q��{�[�bd�%C�!�7x3�8�8*�@&��y���P~�F��.l�k�\w���(����d���!���K��-!��8B���R�/�z�e6��G��̏�:�uEr��&_d�Q�����!u"�<��^0�g��G�k��B�@u��������m2��pb�㙗-�}/�z�m "��#��O^r�9�#0��w&)�\��>������	Y�އ[��.��.Q�Mk�����9[�3ө�}����a�-�G~��q��Xہ'W���H�,�TYji��}�O��&�B��i�Z���"j���`�7^Х�<~ҍ�N������vW���%Wd��FM�DP��?�dc�ק���]ơ��=���N�K�>����d�UpT3%�$!�帍x�ӯβ���(�B��a�M�6�y<;ǆ�!��MR� ;���ӫ6e_�"��H��!�9�6;�<5��f8ݾ�]�ͤ��Y�-��:�
��Y"3x����2 ]8l!G���J�T�9�7|���O\�ڱ���8�M�k��� �hz����A%QF��H�x��  E��j/J#��xW��+�O���o,��o�aǬ�D9<G�����s�z����>�l��i�v�ʫQЧ���n��8m�M��`���X��m���S}0G�+sw�'R��QU�`��z�P3����yZN��8Bm�%*R]1gA�g5�G��S+t@��&N��`�_S�a�ߐ�p?�q��ٝ	���잺�(7�0�������I��� ���=�c�x���Fl��q���|�{���B6uir����WS��t2N��ɐ�&F�9y����l3Y�	G�n�*B`��LU�̭�"+�H`q�5���jR<�A< �˞��=�"O-��c�L�vm���������;��u�C��{*�����9kN�����{���5��U�=�6N���b�����˅�B�:��m�+�|�"�X�h�˭���_>���o�M�4 �-�ݦ薽�=j7�@	>����"b��6dF�R�h0V \���� ���*���کZ]�G�U�D0��}))`R����X���w���g� l1ðu|���o'5L#,���C1`H�4�C��)a�Zv��z��6lX����Q��,3����=���0�����YX����&�Zܬ�H�`���*W��!'��큋$��.�LŁ�m��}U��qg�r`F(j r| �(�Y͓�#:�lĪψ]:hh�}N�(ǣ]�;�3ۗ�_1�>c���R?r������b��ъN�,�k'<F��b���g2��~�+�����-�q�4���7�������շ�a�� �Eq���&��q\U]	 �X��,�w�$�T��@��w��ƍ��1UU>2�?�S�R����e���gU~�>@�<��`��y=8�5�5e?�5��(��a�]@�?��n��޲��ߘ{�Y{�[Z�4��#0� �����E`�����[��y����ӕ�_�1��LP�+�7�N�$v.� ��,��C ��:�dT�Q��	<<yT����7�QV]u�1�F�c��.ba�'~� ��V��k�0/��p�aA���VA�����*Ξ]���r�]���n��\u��Ys˹��ovf�~���u<�XL��`k��a���c!�I��3%��2'y
���Tv�.�o}`E��倳��m�)__��A��`��D�x��]m��py�Ӧ��<n*t�'����q>�py�������Q�lG.��o'��V��+��Z%f"��b�5^��UO#9��ͽ�=�=�l����\9��>����< ���\ػQ.�-ՀNr?<`�d�㑬��6������+��������c�A{#)$��WY|��>��ܨ����x(���U&!!s��q��tࡲ���/�|~'���R�>ڠ��/�w���;�"^, `j� GQ�n��BsX(E&B{6.��$�ZI"�-K���d��@�9!��>:��sσn����ɯț�b0|%Ii�L�(����j�Ǭ��)�b��Щ��j �R�#��>�(�i"X�1Q� *&fW�4dq��4�d�L#��j�"��a6�n�{}�?iT�h�:\p����8�K�~��9z�ϼ�=�?8"��\ x�8:��>@��ve˗\�II,>���ӤO�^jh�����dg���>���,���!�� T���HD�*C�p�C�5P7m�1���S9�+�M��N�˼��z'>���T�U�~-lڴ�ʊ+�mW모e<�{����w?P��~V����I�_Uy���}��[�jc��_�1�8c��� [��	�h�C��3�e~  ���z�[�T���09�����%�":V?���N�����M�g�=�
T63�{�GAze�h����W��������p�64H��v�<���W��_��Qh-�4���R0u|�*�9����6���_�֘m�0n>y�Yf<c�N��(�s�֜F�<(/W�"y�A�1-���,g
Y�P�K�F�_��n0���)��Ϝi?7̏���$��	[Yy��!����`#��S�cP\�Њ~tѤBp���__Yu�e�џ{E�t�u$�>���"'�y�� �����d[��� ���Ԕ�r�`Y�j�
Ł�4�r1���|�uV�x���_�w��oP���-T���0"�5�r�udZ��ng>�9�U��D��3!�ղ>��J� ;I�!�,2��
�GH�C���+�_ �CJ�w��,رc
�:��I>k�,���-�x�)o���á���,\ P@�F`p�	C4`��}�@�1c=�ߝ��%�1}�j���؜@ɐm3?U��\��(��Qw���*x�~%鶜+r7�8 t��w�sN9���&w0tʧ��[=� �뭻�-����[��`��"�F���Yva�r�5�8�`9���˭�̲��E�����Z{������n$�s�6&��loJ�����2B^	λ
��G:8N۰����)��wY(v��ʓ
�s�/ty�}�ꢡz�pō�v@}g]p=ͮg��,r���[d:�p��n���*�qƢB�=��w�p�<��*��y����J�7!#�Ei����(��,�bn���-��d�5�f�ۆ/9E[��(6�pc�ݏ)w�� <d��=���
�Jy�.-�&�.��5�K'#�S?J�K�*M�q��)e�-�.�?p7�{�n���8w�m?W�0�fx�@q���6��\���En��A)���6X��]f��J��d�kZ	&�q�ŃBv��A�H<� )Β��|Ӓ�֌#�ƹ�O�&�ux�M���� �0����σ��,��,��:�p���+Q�,�t8���tϟ=ֺ �0�uW P�xq5��U�c�C���g7h�'��.�Ii��D�6i��t�[a�%ʬ;0�p�iy�(�,�����iT�N0��U0f�(�2��7ͼq2�T>�v��B���d #~��(��?�������ǧ�~�%�R���+|^��5�����s�=�������u�-弿�SN��=�������r�{���"0�������ț��x���A'&X(0y+{?�
&X�u|�{k�_�;G�g��%�?V�
̳?�o�޲����\m����P�����Z�}d�z��c�p�[���z\�L�`��r�����W#��n��H�.��lPtD_������~%�;��c����0!��y�T��}��r�g�+��~s~��o���Q8(>~�nRYg��`��8��(�\A@"�Pvq�2Γ��.T����pe`65m%^( 1���T���/�hs�&b�����J�������xo�e
��Q9�ݨw�8C�6��Q`��D!R��'���o�h���k���'#J#AU�P�p�u|�"�2����BX�S.x�n(1q�y���\�	q�35��:] ��̟T�:��@$��>Q���5�H?��.���w 	�5���8*5x�D�C��n����CW^��,,%�|��. �d�x����_��ߗ=��k�i���3i���(�[Y�*�'K�k�C�� :��LX$��F�����p��3l������C�\ ��}z�oR�M3<�6m 3rK/�D��o��h���`������g_S~f�k���ڷ����c�:����L�Q9(H��'JĲG�9��у���=��=<l}Sfx�w���%$����-߼�j47z��q+��˵K�\֣�h.a堸g�N��ﴞ��m]f�մ�����.��ŗ]S�{6�3�������-��_֘hO�&���F�kF���(��tPA江��xn���.;o�FL����x�g�6�~��Py�~�G��u� ��M�4/p�A�.+�
��T0�\�h9�X��1vQ�iW�v2����+�~����Hh]p��#UN����n���vhMhj(�#+{�ߌk������	�U�Q*Q��X���֝��}�%�a�$�����ƕ�QrD��f��� ��0|���4����X��-��ѴI["�����ZPF3Ys`"pHI�ȑ�7���!ԇ��I�D����1 ���cJc���*/��D5z@C�ѧJ����'>q���o�78��8���\ >6J'�X�RFa���ݷ� LF��p���}R��-K�ƿ�ɛ�wuf�p2�L�kb-`�B�%֐`���0���+���4��-�/?�h���x��hn�`�s%�9^�]>��x�rK.�Xy���ϚeϷٳ���ȣ��+����KʥW�^fΌ�LE��n��G/b'�����[�L��9��HX�E �%3t���b �&���t�6�Z�d0\fo�U.e�喬:�� �N�T>:Fң�Qj��;A&�!5V�n/�v��0����m2_��}�NW�3Q��|�c.�ϿaS��Q��a#bҊ��vz̷Pq��x��Xv��3��_�����ڀ�����x����x�i�Yt<0��wz�x�����j�2�o�7�RbB�M�e|�[B��<�s�/4����,��f3�c��x2N��������@V�_텼O�>.��I�2�>�� �S�
k��hdƺ�b��i�]��wG�U�&����Y&��g����fX(�l���o�^��)* Ƹ���
�5xB�>h�9 ڝ�`@�r��	��Z��`��]̎4.����$\�n]9��^���}�5�)U�u�_������~�z
�<A�i�'�O�Q�V,�آ�U�nlS�_�l�Zc�B/�=-`~�o���2�0gu ��N�!�*c��	� :�D�YNx@�r��8��3e����o���j�v�#�M��q�Fm���ӗl�~��!o,���r�y�)'��[�n��a��\m����_�?��4 {	��Hȵ�n��_�A�p]�ؑ "1� �PU�b����|�������Wmp�nw�G8��2�` �(w�{t%5$GY;pu��D0�W_m�Q��_m�����/^r���^�q-
�T�60[��ƂcpDh<����@���92V	����W�Aph�x4.!)N���6���4S�K�n��;��_b�7Z��<�d9 �����/�(:��<D�3���� �g
�;����ϯ۬\������5 �F } ���g����"1ED�!ўX$�)^NG5�r�W�p?B����@-�ƨ�Jr+0f��������f#�Bu$��%R��{c �Ġ�9	`�K�i�����D�6I�_l�}܊9r��'l����q��:3L�VV� �a�W��PR���J���,j����G\�:*5��9���k=����"0���Aa��I��aп��[��|°�9�#��k%\��M�}1Ra=#�)�eT�6�\��`Հ��̝�ҁF�U������i<UN � �ˏ��~���m�~yY�+�9B|�h��e�S��̼���o��Z�}x�#6#'�yI�홷�ߜ|Yy�9lw�2�j�4 ���t���B2M�r����Sk�Q�$g�T��!V��;���_^)����s'���#J����_C��L��r[�6?��1!7�/���XD[뢄3�������<�6!j���r�J��Ox���IA��!�vhf�b�Xf���+^��+��X�c��#� ��vۿ�$�o=�����;���� �}?H75�@��2g������� �B(���?�I9l�jL��0�E����֜t��~�_�ʋ�f����l�h'oA�4���A��ߛ��
,�\���SL��H�dK����l���G_hߨ���/��_s\�w0uܭ2���1�`�[�y22n!�G!
8�P�I2��(�y����u)>�#U��$�. ��2��R@� ��dH����
��s�0Q9����О:�+��B��`,���J�VV�%�A�t(���U5�|�O����?�����2�艀�Oa�D@��+צ
'��^��r��9��ϓ��D^���e��f���9��|���"�I%j�"�,f�F�U�L�C��
e���[4j,��G�q�����������Z�aC��v3�a��Z���'�%��`��'�+[l�6��~�	;$?���>�Gׁ�j����+T'9�i�
Y�k�2n��g��	!�-7��Mg�"��	5"�b��c�8���U\�ɵ�G�x(�
,�C]�!�#n������?l��}n��}so֦��b�9�<���Q��$p5ZB�L]��%ڽN�.終4�<:G�Ő��爉6&:�$z�G#�\�o6+�lS6x2Tq �� zX$vy� �u\/"���%��'�VG�B�X����o�s9�S�f��}m�ƛ�|���a���)}�~l�>�fW�_h�hC��OC;���t��9�$�W@���/�p�7� �'�t�շs��ˆƖR~	��(r(Z:k,��?s̶Q�HJ�`K�(��8n8�'3;D��+(�l���d��mo�b�,���a&��7aK_5��7c���m5���:��NY���ؘz1���w�:�������A�C�(���bK{���?�'�6��ճ3&>�m2'O�{	9&{�����i��)
R(�V�)�6�湤�3�,�N����?W� xnF`��)o{�6�G�s���}ʷܥ�f����cl��]b�j�Ta�5i
�ޏ|��p]yD�1����;pq��}���&F��6h$Ə�b��l�ц.��FV�11.u�p�A��i�E]��`�cQ�h����5W�K,*�eT5	�������B}�0lE��v��,�(wi��3���m�c�'-痦��
�3��x|�~��WQw͌UB[|��ߗN�̛0��Hhn��6\�>�-��H�����Z$��߆�_!�}�@5 �ύj��?-9��{�u�������#�������/��F���ʜ`�%*�ho|���hѭ�vF�T�?������r��;���O*�>Y�k=n��c�x�Mwͺ��y����玏4;|���6^�Y�ȵ����2�0����'�UN��$�C�9nb����v��:fU�� t��I��Y� ��(����5��%�0��4�^����W=rT�e��� �����3 ��24t���~�}ɕ�M���v(�%�֜����L`�D�1(o��j@���I�g2�ub�Los�M���br��`���߿��ז����r��)�~��e�%%m�m���u(�M��dz�C]���C��������H,�=�)����ş���b��ҫ��Z�W7��.���3�یTe~��k\����dq�u�5&[W%�p����ZC;r9T�c#S��Eʸ
@�o�ANuX��..Pa5�~��e��~JsAw�t�z&˸�pзN)?9�2���٨C��u10`?����̑!}
��k��4D�P>J��k�I#���q�	?3��������w�m�ø��O���	"�Gd��Bw�}ᷥU&���7��ځm��V�K*y�e�RT�7G����u�ds% E*;l�&/Z�3����t�yW�d���"�k��v���Cr�P�%W�İ�	����6�G�6�S]-v���/^z}d����C�Ċ$��IH�ur1W��'�	;R%:ВQ!rw��E l��KǾ�p뮀��&w
��#����G��?��S�p��q��4}��6�"�Ef�'�n�鎲����%�m�j����E 8���T�&ZM�`����Ț$u!g�#�;��(OF?8:�<��t����ھ|��;&��\� R��m�1 ��|��?��|�Wז�N��n��m���H �A�.Lr?~���S���Grz�ۙ�!ۥ�����c������������bR�r 9�p�Wˉ�{Byܳ�/?�e!�d�kKf
x஻�*�x���#�<�� �`@�@��u��`��}t~�˺k������?}�I��_d���l4S1�������� K���gts�uYF��2�Τ&����"��ܵl����O���7G��A�D�n����s.+�9�����/��o?���Ce��l��:E�U6ё�|�Vk��@��v^կCq0[Y��N;�e�����m���˭7�C�W�wt�~:����jvRu�ǐw�X���|$�O�� 9��d_4}偠���zD�:�P�z 1�P��ʝܲ��C����YN�&�h�`I�x�־��e����V��X}��ri��x1�����=\��}�y�'?��M��� D@@��A�F�4�h���%�Ab4m�GJ� �+�,�Ϳ8��L��h�����Hc�<Q&;�� ��R�/B`�DH�����I�R��ߢ[�&���
+-S�8�c�%</ �	xbE@��o�����5��\KZS$#��]��E1�H����H@��6}6	�t��.0�G�c�7Un���V����NZ,��7A\��{��DL�q,�&3�C��S?ުn�
�p����>����.�����-��)g<�h�r�K-�X9��;F����̙S^���3a���Al��q�a?2����Q~�ą�;�GP��h�r��A뇓�o���?��]�K_��=���=V2>�wF��1���e�|����.*'�3��wэ��{g�4#6�Z��d۹my�ȕ!���(��V�@��,�Э�֕7\��h�Xw�t�g8^��y�>�;k<�}6���_��`�ϑ��
g!�e�m��#9�Op���,���G��m���n�i3�~@{��dj���.|�����2QFp��n��l��P59r��jԫٖ6�F5���/�b���=｣?�ˌA>n#�=ٸ�n`�XG�Io�a(�Q[a��|��z6�(b������d|��ۜ�iKe�1pX��R��B:�%%N�V�i�7� �$�l�e�i�q��E�,{��u7��������:8����e,V�_��6��yW]��R9�'�Z��L(��(���їu�я�`_d�g����;hj��Ĳ�d3&��h������8+*����v׉��h�6f��; `^���C^��U: ���t�Q���-�_7T����)�}�'����|' �L��{��o�r�ou\�9��R�n��q6ԁ�����F�2���as�v/{!/$�d��8�'���ÝR��A�y~�!\�:�/W�OpB�d�Cˆ;R>�����O���}wl�m4�F3���h TГpg�#=��ѧG�N#V�D
UVvH�,�(�V^l�i���B�x;��&%�	�q'0�OIC���(�7lM��!;:F��5�Q`��U�CP�	�@�L��u,�HM�Q2�i���젎"���EfNY�Ȕk4X���I���Q�z,%q`��b͹�=�!$�&M���ϻn����mp�B3�k��i��؉�]=� p���ݲ=���Y�LIR�Yy|��NZ4�g�C�X��͜��^%�k->�d��E����n{�վ�KA]U� ���F�:�b���T?��W�g�a�ˡ�Y�����T_ġ��lJ[ݴU��c^�77%��"w���.{(ÿ���*!�:��E��'��ВK�� ?�I@P�F�Y���;�D��krp.3��o$�!�T�rd	ϯ�B&޺���n)s�V�F�� �@�}����Ӱ;�>ohG;�㨜j1��*DU�� �=E>��<���%���ϼ���_K&<��裏֋&!9!��	~����؟�U��?)km�_��=Z���_�=��o/MD��[���"@�^�3ːވ�Z�� >W��Ż|�:�ԦI�G�A� �����k%L*���9��N���M�w��C��4��B+\�o �S}��R����Y�:�����-���訮Ł�61��UZWb`"�� ���N�Q�<l���ih�n WW���Y���9{V��ˉ�ȇL���ؔ܎\��~��Ӥyv��qǝ66��5f�q�~]p�90i4#`��լ��~*u⤃��zeYi��E�b�k�Xߑ�9�����l��\0�D����@�	b���F�%&�d�' �9ݾ͸����dkSu�F��)��c��r����O"G����I�Ή�� rRYy���  @ IDAT��y����.�j����(i1�E��M<�b��3���1c�6@��X4����F5�s~n��+ם��������1���t���.>�	�O�!�L��.�nx�귄�h���=��;5B�<��������*���d���H�^�>���A�q�ag�&�7��k.��v�+~�����Jxq�i�x�c�&������`9�W�������˾R^�՗ˆ;^>������*��Q7���.D#�B!��B���� T�� �Լ�N��M�ʃ'�l`��e'�����~q�T1�E���W��Nɱ��7�1V�o��<W����p;�u�z����:kT�7��nKCSPSUu"A6�����<�;bX�[@!��6��M�����������P�o�:�Bjl-L5W�!�e�;	gy7��uT�;�-;Is��Ͽ����p�� 1�"��a=�"1p7G�)�����?ꈝz�ݲ�����Mn:9u&T�5I�9eJh�\E�;��ՙ�U�Tk|8+p��* k�N:�R���Ϟf��Y��2(L�`�X=S��݀@oJ�=��'�!�/0��%uG�Ӗ�64c�� ������lpXCT�`�ه�<�H�Y0\�Y��/vg3] r۾t='ǝm39c#��
��H���8�/Z��_�]8H�$:��A��&�U���< ����H�����6,��f��d<X|�W G�쥘�<^�ݺ>5�R[�����g�/G��2m�<�6���7���q�Ո�v���S6~���G�rF����&`�g�=�Nǡ�y�.��bH(�m��v��}�:�"Ah�J�GPNt�˸ ������V%��K�88h�~��{��Mtַ� ���
$19�G�^}Y7�F	ǎ�p6+i쒯+�⪮�
���uOi��>e���r� ��>٣<˓��e�Z�-9#
t�ic���r�St#	H�씌��Ӿ� �R�<�U�3H�(�!$� ���������O�}}���_R&-dW���)zX�g�4'q��'M���lW_Q�	��\M)�g>�V��
�i �/�:�;��Zb9�OW�g?�AD�F`���y+��BB��Kޯk�-&��r*{c�Z���-ܗ���E��[짽T�\��},Z<�y���z�$���*���"(��v����RV]yEY0f9�H�C���|���۬�2���[��[�c�1��]�a��q(J'r�opNw��<�hy���M �X���|�t҆z��}��
��S��䄰pD��I��<;<G�$��iD�ixt��/������oN�yCL�����ͳks�E�'�񗲱=ǿ�._/����r啷{�EW�YQf���o�5�GZY��=j��Nʀ�rW�ی7A���������ƼӮ�е.����c9^ �ڪ+�!�ߊ��']	�z�=j6҈�6\�@F��t8���2O������/%ʍ&��C8�-���߷�����d��"����e�):�T )��1_�b��J?Qv �ʖ;(����VY�zc�Ԧ��E��e����ޘ��	�N7��������A�|���}���:�$�SO��B`rԉ<��������P��@�(�W9h�D]{�A}8�N��s ��f�ߢ��Î9������ċ � >�v��~�oS���b��2�W�\���y����&���b�X��o�����+��5�7GD��gVa���"�c<��{���+��&���U߬�o`����1��R޴�f{x����r�e��#�x�mp�eI`2M�qM�N�����."����M�{���`�MaN�9�W-r�f�U�JpN#r��Pn�q�ha��}쿖��^�4pg���\M�Fm����+���e��*��ԉe�C���)b�>�g���C��z�kÂ�ST�b;���*1 �n��$�'���0�� 	��aW)�_&��`y�����"��#��)��~o�(�g:�x�I����hG7@�KpV�Ԡ'^"p0e=DWBj�H���V�4�݈��s�
�.9�����n�&PA d$�)�K��X���|&bݵ��A����p�(%���	���8��RbO���ߎ�.{ӑd����AT&|6��D@���ݹ,��v'�MVy��sWg��}�f8�$�-�L�X� 8yڐ��lUK��f%�3�9)�(�Y��-��zؙ��[�A>q#��!>�N[�	�:�un���ؕп���F	���"�J^/ף*"����)*K,�H�k�����V3p�?y�_M�5V�?���h�9��1����/\!��&���uÈ�s��[�}�f~���mW.��F��;��7p�-1WA�({p���oq^�ʩ7d�X�Ie�ϝ�l
�[�+�؎]'��K�GNX�2U�
�<�Տ(#ƭ�N�:������'��1{��o��l���<�奯?����W����W���fﷱ���a�2��e��[o<Y� B�9��v|:��z�#��Z�͢�r@$�y�P�d9A�+��*�(����Q }Ac�5��#���O��h��|h�T,1k��Fl p&�L�p���(�K&�9��Am���T�b-�ذv�-:�Ƽ*���:�3�m.�X2��T3@�nb&�:&t�{e����.n.��C�����5���N�+x���CN]��c.�	�>}�ۄ���- ��L��������i��\5g*ML>����A�r�br%�2Lz`n1ւ�b���_���x}���I��d+���:�e[<!�g�im��Z���}}�N��9��΄���k|ylvÎF_��ZM����D�X�p�,������4~��\�p��Q<0�#r;dw>L.�̜�͎�i�mΘ��:i�DYr��˧޳M�Ƹ톛��#ё#(�Y� 	�x(��8�=�B����~+�Q��>묹Z�t������]#�4�kK���hńDs:�[��믻�����g�&�o��������;��<�L�����ag�;��9s�_
:�G��Y��U�.c����硇Z%KD9HlG�C@'�!H�n��uY�Or)�r��!��0�~���/����'����@��������B�R������7��H�����yL�q�2U�܆bA)�BQ���'.�X��|�{f�R։��:�&U�B2���`y3�$7����}AF6,'�u�oʤv+$�71P4��~�����AD`�}m����<k����om�j�b�t��դ�]{�̈	ܬ1L�>u�s����ZE�X�H�+�@"A'lÇ	�M��Ŀ�4e�,��-�<�|��Nn�	~;T�W��i��"eO�碄~)�r"jA�}r�+���w/��1���orU���q���_
��K"�E���4��"E>�.��/�=��e�}��S�)y�ӑ���J�������ϿoK�pʹ� �W����� ��[�_�!L �C�3//g��`�f����1�Yf+.T��T�U l��w ?�&^+��K/��n�[�̙�O�9�S�O=���k+[����G���t}Á�S&P3��O�ԈyͶ[�_��Ae���XCglI��(����?�i����%�����}QU�w:̟�xYo���iW��Ͽμ7�i|2Ma^s�gY��.��3B��U&t:k��hL�AZm/=lՖ�j���^29�?���C�\?d"5gD�ة���O祐�˛h�ws�DT�0�O��&��]��u(�x�����'���b���{<�	�>]mB�c�:o�/>��kQ�'��dQ=��(4�Y�`Sn&��!kȔ�Y�h��xP�Od������ߦY�@Ƞ���8�I�b�ڙr M�h�����21����X���Svӻ��8;�M�M�͡*��LU�]z�i-�h�ͳgݭ2��7,�RP&.����F�q<��#�A�I�*5f�"���gb7�ǯ�K����"��:W�&w�]�,_��Vn?�d�H6�9K�U�>iy�S�%��{�]'>�����Ï�p�$wl��Znc�%���f��g�*�İ��2X���_��?�ϩ̿�?����������������mD�2&��n"n��=я��¸�H�X�^!�s-����Ѕ�F��HI���"��P&�D�u��b��(���T�s�jiO�������%|�-3�n{o[!��S�e���g�D�"��'%����!A�d�`�ٺ�p"��x/R�-

�$�%TE�
�|O�!���BR�ۋj�,~I~���V-�Ax�X�T"�{��,D���8�%( �x;�����ʡ���?H;��M�0Ll�m���E���d�������j�gN�P��J7^���L�Y0tTAs)�S���h�!1� 1�<	�Q͐� ~�|�D)�����/{}���������G6����-���ڽ�k)�M-{GBT?�$�k|k�����FƊ�-f#� �~�!��f����}����I*�1�O�y��=� bc��~����L���r��*z$��?�P�@������(��{�z������T(�qԉr,̎q�*ot�dE���M-��Ȃ7�#��F����I�U��m�p}6,���T��pپG�y4��:�q����׾�e���W���;�'��k��@|�")�6q��E܂̜����v	j�=-�;� �hM��޾Y�F��)�����̺)^`����9ׇ;�����1�]B[��l��_4f৥��p���8F�tȀ�F�j�����\_�rg��Z��Tl�ւ�n8���ŏ� `��*�j (�����/�̟`Wꈞ~�H�N+'������TEgg斶mR�~ׅc6ͯ�z\ӭ��]>����Su�|bF���&f^�>�1��l��K�ؠ,���6��s�S��0��$dgbNT�qrX�	����$M�^K��G��b����>u�
WZ�D+:�	�It z��?<w�2�����/��v�3��M��<�{[�Җ���r=�gZ�U-R^� %� �hn�y&}�&�bYm�E!�H�Z�����Ɯ஀B�Y"�0���9�|�~ǎ6K]cQ�--�PYd���:�6kZ�5�NP�P��ĕ��g@����Z�I�������ܿG:>pi(����y�j�����2h(,���'�o<�%�m�wQ�v�˺�<���CǗ��zS�o�#�d����)�U���Ih�&�y��wQ�m� !��^0j��G?U��>}������`N�Vf}&
�ϟ��߱�-��a�-_8./�c����x���#Dn��vR������l�e���� �>��d�?�1]��.t c�Me��Q�<ƖY('D�fŀH�����*���F���weTmRA%�P���1���PX�ՠ��=�n����UNԹ�\�^� �pΎ#0��_��(BRu衧/�p��������g��-ַl�g:Z\`����v1��))�bl!P'�T3�0���u'4/'n�'��pcE��A����m��%����J��Э���SY��a:���S��B���F@}����2�(��yb�#�=��������!�32S0V���Ŷ�Y�����zd\��9�",u�d�r�	ة�$�3N"�#A��)qG�!߽�l��o�;f���$��`A�oۮ|�mv�YŹ���b��w��|�ֶ�@��D�II`R9��kmN��F |����j^ؒ2Q�\p㍼B���{�<��Q��
J�5Iw��.�����e��,��ޟ�������f�q0u�ڝ�q�yQ���A�Д`� %;c��!ir+��b�����s��r��I���w�5��ɵ~���b���P�`Yq�eF�1����anG�����e�c����� Υ�G����h4N�`_�m<�-zbo�]?j��h�J�C�9h��A�
���њ�	e>��E�
^d��:����#���57|��(c"i���rXd(�� ܱ���b�V������+ݮ�8����7����L�Ä�@��M� Lp�4�k��+ү�qFYb�Em��I�O͜�p��5�)�rn[� DŻ*����*��6��*�M�����8��@�'a����)�r�����c�b�%��~����*�`�R��Z��N�+�~|ĩ�v�l>�������C����g8/illkv
�^���qVf����/D4x���|��N9仧e�
ksU#�Q U���nW��My˶ކ���Qq���؇A��Q�|(.��hGސ�~�n4�8j��/�	z?�����b�q����|,IDb��p5Q9�x���~�����$�ӽcw��~��e�W}�����)��.\td��?��>o����Y�A�memP��ReO*]�[д�+?e8	z)wI'�1�6<��N�	6	3��j�]����@�"�LwlV��YS􉟞p��h��\C�� �u@f� JP�,N���)������S*�/R*�ؕ��Xt����j�Py �BE�o����ʃ��(Wq���2 �:Q�%	T%�k����%s�B�1��1c���R70� ��0�,���Q��0!#P�����ӈ��#l��=g��'9�bBL5&F��dr� \�<:6a��v#u��ܒ�� ���=3�y���ꉺ��+���u�e�������\������ �����(WH�L�W�vL+A�2+��V���/����W���������Lr��	E�J����N��W��<�ؿ��w<����j$,��z�᷿���߻�޼���َ>�[$1����ѵ�ɳ�WxS���?����3Ȏ6����;m���}�w��W����zC�F��Zo���%�`/�i�'p �*�_�ى��qg�X��{�c�?������:�<�����������9�O�2(;��h�$�@rP�hp�0X%Q���u�v�Z&��Z��@�x��dek��2O��]U���P�V�Y[lў/$�����W���W�1��%��	�.e�(W��i�*
��g�
�A�4D;d�;&�J �}��3ފ�d� �6�]-��ڪ�����p���g� beY���������*��X&�.����|��_�.��֌%?����y�����#�8m�������D��τ�Ӂ�=��F�����"prZs�Uʋ6[�&�X�q�j8�	�&JN� ��T�ùج���$��`K��hh��ZU��v嫱�gr������Z
�	���^�{���u�qjǍ�����TP���V_u�^��b̍Q�o�9�Ǌ̡r�Ǻ;\� 9&���7����>(�@�Ў���
,ξ}�gO*{}�D�"��5��N�� =|û�j���_��_P�9��0s4���,�y�UY�1F���
����(H�c����Ga#:�	~��feJ�<`�K6��CH��1�/�1.�5"�m��O����n4q�l�E���n��(�ߞz~��ۑ��^P�>>���`��>J�}�ܤ���߰;F�$���}B��]G�@��ga$ׇc+U���̎�m�HW�&W�%��*?��b�ɶYQjc^��;�M�u�ei�f_}����+�c&Np��i�m�j���t-��/:��J��Ude(��r�%��@zH���2�J�L��'�M2���j1ك]E�@U��K�`�O�q`���B�tPr�GA"v* ��q0��f�GS�F�F�X� xI\�}����} ,����0_����ʕ?�6��#_SQ?�l�҉��N1i��3��s~���IU�ʛ�x�$W�I?4�e˖$߫2��e9�C��#�@n,@�1�Y�̲���`_��{'��ۗ�'`2~&v�Tn��k�����ڌ#^z�![���Q����2��3��k)�A�&�	HbOd��K�9n�6~
�B�i
^TjL�;����7e:'��/h��s��k����W�/�U?@v��V�Q�Ge k
��x 3�m��v��͸�0��;g�Af�Z�t�O����8f��~q��c��咛�i\�Ǳ�8�l��#ʞ�?��w~���.vD��^�p}S#��h0���ܷ=�R0�"�$(|7\Q�PBT � �ĺ9X(/ٮ\�!�r��~��Ne���aM�}r<&���@���8 `�FN��(vPN2m�3/ÂU3"q�3-)t	��%^\����Cp���䖀[�GȤ*ښ� ���C���Z�9�-�|���|��*h8��Ű�u d!FQk?~��� :�\_-�mDc@/�K]U��r��W�C�l�P7�&P��j�>�]���F;�l��o�135�S���@�i8&�W5���.�I�M�vhX+TgX�B��JP$���	nH����=��Vb}�G��a�D }a�B���N��V�"y��H��/iwZW#`�����i��5`޼Zi��ݱQ�
ݺ��/,� 6�@�)Z:��h�e_j∺T%�1�^r�o_f�~���G��x�ǌ�B`��C�T�Yz1��0��/4���l�pY�nY�n��;ʯO�7��=�9Ǝ.~�y������U��ed6�ҍH�`��S#8�Ϳ�نZ���HB�<��F�H7�|{y�GV>s�9�/�oy�s�o6��`��:a���A�`��k��h�J���eY�:dBV.z;GsqJ��L3]o�Nf<�0:)f$�N`��6�b��R.88O��e36^��]}��3>����у�����w�ŹOd`�d�d+���A�����Lb}�\2�	L�˂0�Q��D���X� ��R�B{���'8X�3G�INrIA���ƻ�W��s��n?�"@� vl͸ppl�qI�F���Mxia��|�y�� � ���q�a�#��Bf���X���ժȩ�=/�e	~�8�p!rdB�a3�_��l�=�k��� d\�9�M*��r���9����AۏA陎���[ү�[�ț��� �B�vvG;�SiaW�D�`m\!EķA��o��A��N�]��U�����7_�vE�e�c9�i� 8Y4zHt��IC���)[���e�ݎ(�c�=�	s(6�y�����ϻ��-� GR�%�b���VY<ҋ2�����Y7����u�Xܞ�>�#[��!�kV�Y��,�vhŜ������EuOh���;9fGk����[��{Ƿ˚�P����s/��~1Z!�J�틋�k���!b(�.05E@M�"��&���Y�&\q�aG�I�T�UC�m�`a|�yU�r�3W�V���rS���d�z 	s��/]��n.���$�����ϝN$��">���q2�L�ʔ�
�
}�%o�e��V4���(#B�����!�wC"��X�tQ �z�& #��|M�=P�ռ�9A��FEϣ��H�d]�@t�!2�
��h[�8Ui����{����堃�9����@�J�߁�;�:ځ�I��/��O���ӝ�(N��hۓ`?;)b�6��J��tHX�YQ��=F�&&]�\�Rg �6������ �x����G*�[qiv�ɸ�	�	�`":�+���7��>�?�$��n��6����7�|�;�����M�~�3�Ƶ<o;��S0IvH-���ص)����׼����`�6�0%'^<2�����=�*�C����^9��Av��	]����o�Y��L�Yߊ����XU�λf�2�L���|��|hu)��/e��0�l.�<�h9𛧔�w8��x�,3�Ίqg��S�umC`5�W�V����J�ax^K w��K;+����� |�DT���:ln�dtn�!mh��Α.���q���A�M�~�<
�k���2݊f_|:��y��/�`�����I���`�Ek��cx'>�ƅ+ �ã[��j3�S����j'	�,���u�#��~�C��B/tQ����_�w�~U���S_�� ��'ו4©T��n��C/�]x",sm��T �u�t>��c ��vQٔ������۹A�H�]j"�=�}��X ���_���][ى*f:n�c�ɻ3�-��6oL�B*oi��	�^�Ci��;����:�N?#҇�5������C��f�� �\���/G[���D�#�?�XR7P膜!�{�� ��s�̱�g�����\�dZ���^�s)�ZL��S���!���<�.�\���k��)�_��G{�'���Ņ�����m�o&m���p��X@!��+ed�d�p&j�� �O��z�����,#�d�`mz�C�s�q�
(�j&���bߺ�EԈ���yjy�·�/-��ڕO��5>���?�ݜ���?1��8��;�A2G1�6�ʟ�FNLR&�bMC/�*Z@V��J�w2�g2?й�S]"R儫��f�b�4��v`��r�������g_L��G浌��V�\w5���Ю��N	%@(�K/Ҥ��t�+MQDD��� ��/H��(EEA�*ҥ(�H��wLBK(�{���̜so�佗��;��3{v���̙r��t���t��"�E�N���K\�%�J���� ��r݈h'�h*�(]��A�NCo�=q5�5��OT�#
�?�R_���J��5�|�5;���3j���ȼ]4Z�pnT�����+ȹ��!�e/�|Xz��	��w�e"��S��׳������v��oo�o4h� |4�Š�,�`��@�E������A�� MQ<)Wʐs�$�����?�lxԚk&[.i�2ķ������P�_����r#7��Y�� s�.L�����M]�j��d9N�#~���|fV��l��a'i��,��@�i� J��<�,Z��2X�$�<�Wm���������O�l���u��o���o�ٺ鳻���Oؗ��M	�M�^��\I��q������o�qq�?/��-7]�Av��F3��a���
�F2y��S�}�����'��دorA�p���ӮH����fkG��$�������i��� ��Fr����\/�v^�	���;��Τ�80�z�͕��1����o��|��E���v��w��X�i?5�:��4����׹�LI�p���v\���u�X�H8��F!���Y��;=F�ψ:%_u����	,y]� �)|d�b�Ү�(����` ����3gV�>^'����3Y���K�Z*}X[ :�.�F����ui��s�jO�Q��&�J)4�ї��a����Kzi����,�n�M��fd0q�.�_���aFV5@M��<�:]�r�>!5T��J�2K{0Y���h�,����2��1v;�XP�0��F��IW�[o���4�E`�5����0u�Dt����a9h�}���t~H6wFt�av��M���9�M͔�/���iY7l�O!�a;r��3�Q8� ?�P'q��_*	^*68�!2YL�9x4�.�(�!�cO�)���av��^�����H��gw�8�y�{����?�^�H���j�3N���W��B��9��t�E��9'���!��_����j�5��N")�##	0cayVDJ$35��jB���I�}�Z��lU���_�G�q�?Ar�M����9ϴ���ć����v� G}�Ì��<�j�,9!U�9�A��]k0���߈��gU�/;�����X��a��}6�3\�Qx.�%��F�0͔d���������5�wg��Ƙ%#I6���7��E�n	P���(�v2���)
�a����r1�\�Ae�2Eձ��8xT�
���˵�L!���!��}T!i�������+� �]��6�&R�S�`n���73l�]S�?{��{���
C6�S}�:�sl戀&��n��4߂��n����}G5 ���x)`�0x	Kuv���6b�`���o�_y�� ��ǆ���U� �S1�\�}���=�Џ���F��mZ�/��D�L(TT.���/30��	#������i�B��mّ�F�d:}#]#�v�Ƣ��Q��v����	^U��e�h%�*[]R#I���8.]s�}�6���� ���L:xߍ��*+#	dn���\�H�YBUj�6�~�����>^ohkM}�W|��|��ٵf�n�⟶;�D��lE? ���%���� ��F��opq'����s3�	ݥJ���1j��t�f%�2,Й緊J5l�\$P΅� *`%2f����-#�v����$�|�rz`T/�l�+-��g�6࿖���k�	3Mwޜb��D�pK�_�yp.�����{p^ l��o!� R�|�5����AMDn4�:���t�$�()N�K>Ԋ��D#+rTjVE�g������^�j%"dW��J�x��Q����fMP� W:��4��o��ڤ�☺��Wj�49������GNKG?�"л 0���u���ُ_�a ���ö� �)�����AR��L
��E9xj1��c̀m$�-g.P�:�AK��@H�&Ez����}R�3�ab#z�~���׽}��>�K�/��fyG�y��W�")�R��[PEFd���sδǎ���?i�)KK,��Wi.��FJ��:i��"�e;���x0���`�
��w�CJy��X�W��7���������|�2ƺ��y �uB���zk,��� ��G_1+�˄b�$�cV�!�+3ue�C_t^܌0�~���S�������`��y�*�U�_y��Fs�N#�U!�v�h~�It���+��+?��?�l���sЌ_�����=�4��|���)C 2Ёs�AA.�=�Ɯi.H�(c�Lˀ+m���|���Ja��M������.��ԩ�}�E��5�<s��]s�T0���O��l�-�H1�̬�!���ɑ�8�x����،��f��w�U-T� �`|*�8ޙ��y_0�P!���rj��Ȋ�)Gl��T�В�L���a�)c%��![����S��ԙ�ƾBp����J=^�g  ��J�g G^����C=��uG{�1���q�$����;l�'C��5�f��j��V΁3�>�[M�����]���	�:�ف+�PU3l�����m��7�E<	�Ð�����7{�J�"�2�K5B(�s"��#
�"e]�2'�79��7|Yx�t�/vOם�ɴ�{����>�G��o����{3N�0>�&.nC�A�LJ<8�>�i� �a����I{~��bg���@$����wXu�M��_�� ��8��X9͠��-��#?-/$J��������-��/b�Xe�e�V3� �/$��'8[AWp0
r+���$�00���=c�s�[�����~8��8ۧJ��'5�[��v���滏.�#��]��^�ͳ�(�
ǮcX8"�S�U9P��2(�t�T�bG]QS��H��=
ݰ�����j�� *6,����W���R�gN��7? j��ǀi�[����(��B����u��@���<r�!��v
�L��OF;�6����Y`M/�a�ҧ���*��F���i�C���8�G�џ0�|p��p09F\��������8�8`�1w���t�=������(�;�4�Аvu�v�2��L����;������i,�\�qӀ���6��q�|�8Bk=�
���-pYֈu�1�=-]Q�WO=R��PA��T7�����/ڠ_^oU���C3K/=��1��ѧ���bqP$�:؟P��{�,�@2*����ツ�~�G�����t��I7��g��Nk'�F�ͅ����P�� �q]T�����h��!�D��I,����.��7t�.-�.<-���ǥ�>tlz�̗�iꟜ�X�[l�V�����F�˝p����� ��S�\���Mp �J��
]6�W^y5]y��6/4�i5o�zл��<��!���#׺�2}$�ܐ���a鐓�%�	�B?�LJ�0��;m�s�Yx�mm�pr!��O�G@p>��T�U�h�\���[��z�BE��_���֢Ƃ����+k� mܐJ-r��� 
O�ցD0�\������>���f��W�S��)w��5;(�v��a!�����)���28�(��LQ+=�����n9ug1"�1��j3��KNe�i�{y#��(5ƃ:)������kF@X�P�����me�`P��]Tj걃���>hӆu�H ^F�C���E�:e��>����~���<�"�~0�<�yԈ�-Hu�7�3����/�E��&�E,d�p��(�P�`|d=�VC��C ��N��I3�P�3K��.�f��b�E�����ޭ�}��(}u�MM7�i��jӁo�?�t|S��r�ӆ��S�~��xO�2�64���S&����5cf�S�L�͍�l�K=:!�8���Z�����V�4����/d:��-ѯ��曇��p�k.�&�oJk���2�|�g>I^9���W���ݻ~����k�j��������lm�j��-�D(ݰ��K4��,����~��`��u����קO�R�	��m�w�3��F4#0>x�!��"��r��Z�:�sڂ�6���cZn�%23����L� ����=�q@y��==8�W���#��mܿgB1�����ݓ���������s�5v8:M���5����.P����Xc�iv�F6�u����9�)�_�@�F9>=��6v��f;�YA#a��{��&��Kn3��e��~�>�Hă�R��ūq�
��!.��P\�:����b#��V6KEE� ��jLrñ�X�.C$ZE�U�-=|�7�6P�n��__� ��۵�4{�	�4�3_'9c����,�o�$:�Z����H�0$�[�9 �1[��N�X��p�X�w�@H���������ɨ@#�T��0P6�tvp>&��K)k���BW$����L6\7F�(�U�Ǖ��<��;��͖fK?<��7��F�xe��P���Cѩ�O���pt3��F���������a��F��\�A9x1��&�<WR�a�" ���F��V�$�]E.@���ևy
�l7?��+y p;i��ͮ���D�M:6Z��t,��FYl�'��ʟ���-�Jw�?!=������/�Ǟ��y|B�����'�%6/Y���<���M0x�hƂ��5\x�,`Äd��jZ�����e4u-���|`ܘF���3-���i��JK.6:-:�>/d�U���+� ��� ��)^��6�e�� \GT;��!W�yMچE;V|�j8����y�M灄g��x+{����~}����c�巭�#��><���V7pq��*[N�؇c�sx2�_ �KyC����-��������#m��U��K����뭑v������o�Po��G��r_J�W��,��
�G��W�ȵ|��&��~w���}[��/]�,��{�띶^%����]���9ҭ}��FmjSU�������3�[|�.�6������UWX,=�ȳ���>�.쒍Q��(j��Aޘ봱�\�YMcL�Pxp-P�9\'+���fV$%�>�ڳ�T�v��=.I%$��C[X����Xq��u�|F��9�@ل����ebu;�D�6��_�WT���[u�:#D��X��J����9���wH�ګ�\S�������e�>ԔB����T���]8��f
��L���cp���8t���k�^W�}�nZ%�BQ��^�F�zV�;�ll?�����2@��!�(�\�I�|�)i��_�/�j�wj�T[�[�5B�b8�:����w�vҳ�����E�Em�U���{m������J�D���{lhk�y饗ҋ��x<����4��I�D�'�ÏOL��d\��})�M!J\@�M�O-�-��da{M��,�S2��,�C0_�1�F�9	s0@_�����mA,L����,<:�������J+,9gZf�y�&o[���:a���ȑ#k��]qc��Wγ��zlN0a���v�=dsj�����  @ IDAT�S�2΀c������|Q\3e����w�g_|m��/�#a�p���)d�_8Z\�@"C4� �<$�P!�D-mD�������	. �~�g)&����d+��H��7�(�B�[<�6��V��[�8V�S��96<�~��x��/҉�/�Ǟ|:m�ۉ����l\u�u
=���9���?�`Za�%����.IG�|}��u-���M)�#G6����8��Z���ʛ��鵫/��O�*h�e�+18�[3�ʅp�'�
M�UW]3䭚M$��\�+�/U�lV]�����;�s�B�s+�⧄+m�C;�цѼ�g� ������k��+�h��G�Z���c�]P+L��$��\X�Lu�T`�Q�E�YSa��L1#ԣ�7�i�Y}�y��	3��V@٪ӗ&lPT|�d�=�h�j>ې
�h�\�gG�C0f+���^���0DVn��u���5�sΑ���H����N1(�jO>�n��!.x8H�p|��5�q�HF�rV)VU���M�d�.����R:��+�;7Z6�g��&��y2���S�H���hz����3)/�)cA�z��~׿Ň�� d�ۋ[�^�ă��f
E�1W�����.i^�"R3 D:���R)��l�ݰԭ�K�q���~�9O�A�L�SOMJWاaڰ���<F�������i��8�	�"���RV��~���܋D1^F��#�2W�\�����#8/*2����6ʈ�6vG���x�`��o����77�_ �Wr�%�w�#�jD- <��M+PyŤ�
�|8����U���}�f����p��K�#bx�mZ���Sm3n��
w|à�_���v�
�tq@wh�����t�:�dʔW�'�}n��W��.�Z�ݗ	����n �tT�7�U�M�J�eI�՘TƝ3أx�N:w\�֧�����X,m�����~Ё��[Kl��w�r���C�ځ�<
~����N��/��A
v��)>�`�l�'%R
��PD����N
����xU��Q�).a�m�X1�g����_�v�&����H�Z?�hs?��:�a�m~��
��P�,�CO�5SO�T���O��}+^N'b���E�IϽ��y�������LL=�b�۾ؘ8������`?C�<�e�!����ՠ*��~7Җf���w2��'�NZ�"�u�"M�Y�̨�;P�7���0l�:�]�ec���q��n�kik+$C=V�{K��y=,�ӿ��=7XC|�|hE�w`h�g7o�醜Yp����}s��
��{�~��aሁ
Ic :p�/�"LQ�Dh�*H���b����+(b�pn.�J�9 ��T���ǿpn:��Q麛HW��t�ᦇ����۝���MO�U�r3��+�D�b	���nI����M2�UE��|(�U"(HB��BX'|�����R�HT��ve��}1��؈ �3�y1\����N�B��5�7pG�`���
B�z:k��x�/�5�{�$�a�����I���IH�gT<* ⤤�R�<�ݵ��G6O{�Y�n�ߤ��x4��g<s��p�����\��edʌ!��b�r҂!�U:	�0<�r����'^H??�\��������.���i���M�t#Ǖ�|V9w��[�,1�%?,�ƿNZ2���Y�o�,����/���	��y�wBC|��������ϙ�f-Ǭ����H�ڜگ�{��d���(�Uu_�uM/�ⲋ��Vqmw�f�x ��'� �1���Ж��j���V^�.� հX�[��@Ά�%���������QAw	oC�ƼOۭ�?����=�({���i�1�1�c?�+-2�����s����~^6_�c���H���~*�j�w޹����+�^w[Zw͕x��dΌ�5f���w����h�l��d���ʶ���H�+<�a*LCD��)y����m������jM�FZ��`&/�!Sc:�J��9�9��3������|z����4�oϤ�|�?�y��I�՗m%`C��t���N������h��f�p�E� �Q�/v�f�uM�ڕ�H��
M!��c�[�Y���H\ �b���:1M|�_*;�GW�.�|�E@�l�y���A��3qL0��w�ci����A�L����`���Q8H���OdI�|�gES�8B���@�q��4䨦��ʅ�ai�Q#ӋvUoo��R��ƍ�Pٖ �xsH(z��uK��#�L�pW�B+��!k|����&�����%VT��c���n��*��m)tH��[��+�?z^g�A�U�<�� 1���i�TZ�X`?1�"Uh
|/�q�JA�������B?�	�j�y�Ci�C�H���\�'���L8�HOU��r� ��7��_8�����UJ���x:����O����k#�6r��OO7�򀵽m���w�0��פ�Q��(�tK����y���f��WL�c��Mc_�=�R�3�F�i:�1ݙ�5��ct1��"�"�������c�^���Pw]/m���>�`L�N��/��60Kc,���4��â��i����˪�L�
�`�7Kx�7D��b�s��ٹ�B���UW\4��Ҩ��e�gÌN��3-����Pۆ�Хss.R�qP�M�5���?M���(����N���I�X/���Gm��4�X�:�1,� �jo�++n�7'�ĊT3��8�i�U����������4��6k�'Nz>=��D���Y�@�x:�Gҝw>��awL����L�ES�����o�E��s��l`^ѝ)K: O�hG�≜?0~�y���c�@�Z#���uu8�ε:MM#l���_}��]w]�#5���� ����>ޕ0!1pc��D���Kr�_	��#�!�c�4D���P5x�=.&D�a�"��X	�\Tr�k�!��d�W2�}�t@vY��|���W�M�Y���4�f�~�Az�����C�ʥ������ȁղ��`DK�Q)�HH��Lh�@�(�S�?n�@��a��jE�pfb8��A�.^���F������=`��b"��'@���ްP7޾�S�;�Qޅ��@n0f\G�jװ]��]AsƩ�WP�m�xƄ��|���e�E�,kϻ�v������e����:v��	�;h,�Y�Y2��Nڰ�K��d�Ć�vk�+��{�d�5l�����]Zw知)��zl��u��|����$��ё[R�Dv,��՗]u��n��}��ݷ[7m h��9���\<uY��
	P�!R'��5��`�Oxb�z	ը��*(w�9�
b�#�P�=
F1�¤o��
�P+{S�������j8�:���x�^��B�؃_H�o�dZs�EҒK�Ic�.*<ۥ�W{(�jʠ�}��[{Øcd��$"fС��?��[�6Q܁	؛�gv2�'4�1����O��,r#G���4�3 )����活.V[u���i�n5]m����T��gn^Zz����o]-���_��ŝ�z"=��S�I7�:1]~������/�+��.��+	s�
iz2�\�|D��*�t����6+�R�����B]�u�����z���.��^�K�;���ѻ qJ���P��K��M��%�fZ��ӮL��ԙ��4+�>�+�0�\b��C�{��ɭr�Ge�l%l�Ij�,uP)�'bW���!�i!�]�e�&��ģ<W��1i��>�O�u(b��� w�T�
�)�>��@)f
� ]lge�rg�ʬ�J5C�k�l�����v�X(4������^���ӱ�J�`�݌K����`�H}�HB���ٱ��;�u��֡����8�sѭ�p!�w5{`��2�'�
�4��#�Y�GחM�3�5�/V����v1k�1�+~��jb�k�G�z��6G�V3�D��p�?L����%<���l�޹��I���?�&�i�����ӟ�ީ�y�[�L��XS덙�Μww?��:6�����ϲ^�_7���1O�p���،���r��%��;+�1�ʶg��g�a8^�0M��ߚ���Gϝ6|�
��_<m��Jiۨ��9 �s����ǞJ�ly�7a�r��%k�`
9���X���PCÊA9���K��-���,�%�XZ�M3��hd0o�bo����G�����Ϻ/�z���i{{���<��k/�_7����.�%y��9�&�pA �Y,�s9��S,�j�B`2}Qm8�E�c�%�KY?�t�ܰ���~�������-K����p/��౟�u�`tmɕLx�;'W���7�\�`�˯�Q�,�F,���*2o�8�7�>��: X���Q&,����P�8b�%c���F�c�Jr�PdD��A\'��C�P*(@�,�J�n#.!�i��JS�������aS�Ϳ�Z:���X5���j?�ׯv��λH���_[��gՌ����l,�L_ľն!�d)�Ѡ�~띶!��hA�Ur O��h��,�;O�|S ��x���}�A��x]���eN�j�~+�F�*`l[p���?�=������m�@l��o?���/ �E���~��	�r��Z7<��a�y�H7��g��;P������7.���K`���mhg�@e �cN �N­��sZn�%^�k�I���t�ػ�ަ>�h�Uǟ�>���0��Z=���0�����a����er<׸�w[q��~�ix��K�M�Y0m���i��0����d�w�������9�jw$7�[�yX^��kйD����֐���/�L �B�@l���'��>;�\#�C7@�:Y�	�Em�p����^H�?����k�Mc��'=x?~�fcy\`�M8_d� 1v�b �K�$>�]A��F �K�r�R��{{J�Z�E���wm��t���I�㠏 V.�44#0(7�h�S~�c�E��R��7�6H��DÜ+0I�p�tvh�]��X���w�ӷp��[Ku�L�-Q�M����y�`0�j!l�� �,dȨh�@A��z��&q�}"�Bo��1� h$ �ځ�Ђ���_�h�g���>"6s��jO���I�����|��~���pA�6�r�����X5A}��9��izybR&b�7T⋧����O��m�&�
���/l�>�q�=��b�	��P��Ϳ!"��Pg����z{��C�������?��	�����om�/�f��&�܋��P�?H,X1�ȜfǚM]k�s��u7��۶3c ��~ǽ������b��2@ᐳqjDe�Q�����s�3�o,1��V�s4�h�����v�ʱ�s
����^�����i�м�><�`�>K,�`�q����l�����3>�~v�vi�m�O�%[�(̇�@�7}v�/�->�A��c����'�ݧ�q\��_73��ǲ�"��デ3��	~�H��鏯�+������?M<7ꍷ)��B`�h{��G?�y:����[��/���M��m�t�ۤw���ؒ���B�GN`�E,`ǡ��T�[)7�\��a?@[AuNU�"��*\�k�Z��.U੶��9�r�#3��ʏ�7��J�(�i���E��f�����j÷��VZe���0`���ͬ
����`�n�ˡI�K҃� ��b&���4���Dk���K�*��jH�|�rM��d�󃕐�&��
P�@��Z�xūlE�f���������&喋�raq��Om݆)�B��X�jY�b����ƿ۷j3(a�0�<���b+LgI�S^X�?���qR�A\��c9n8.d����K��Du��i�br�=K䠽�+]qӛV{���ɱA�샅��ge�/\���������T�T�Uh&.�-'�E~����k�{lB:���,�U>d�>,�������f\��F�uB���h<�$ �&��7� �osC����b��
t���f���6��Hh(��C�3h� ��~'ܟ	>-��QEM����Mh�))��A���~:8�a��,�(��ʞ�>o��k�_�h�4��}��'},��Vi�M��<d3����N�n8�����7�<���&rdl �E�(!<���V���Y������I�<�x�S(βU�?�ǆ|��_�g��cڶb<E҅H�.��E�Gw�,�r���������t�O��k��:�6bL���y1�R�&`f5���T�������uiU�<� ���.�W�=��_�9{����������A���~g��`�+����,�5[0`�c�p�R.��1<�<����n^�g^��f#H��/�J�iO�>ۚjB2�L�/�TW��Ǭ��r=��{{P<B-0�#G�]}�P`1�x3>��
�fS�%� �U��oO1����(l�Q�V�����ǷR�ض�<��&?�J�_�� �]�VV|�]b�eW���x�C���X*�y�):+&�S�w;��t�G��#R�Gg�O>�f�S݁��ķ�F����)e!�5���4��Xt����w��@�²?.@7�׫o�#�q�E�D��3%F����2uA��|n�����w]�����v;�}Kg��b@��؃D�#
b����Hd�g1{����Z��ZQ������/4[��0���v�m�[�4" ��Eu�n}>�����7o^kٴ�fK��6Y�^m:��ߟ�h�8���!]g�#�3�<�ǈF,��U������{�#��'���%�fM�Lu���h ^����m�K�1��Y'�����3Ƨ�?�W�6��C��B�U��1�2EG1zz#�����Ma���N���R��A�A�5��=���`w�g�Mƛ�(`p�bb�-�N<nG�m�b�O�z�{4�a�2X�:oÜ�l=Q?ǣ2F=ם���14FFl�M� ��>�GbCG�d�M�`�u��2�bg
b�A��jUA\��J���⏰�L�e���&/�S�/A�ʐCqV���1�P�N�Eۺʀ7��+5bV#u������ }�X +9� �
y�`�'t�B$}���a<Q,�R3�������O	W�w�Q�C?�����|�7�xO=b�\	�Wb(� ��Vb��/N2KH�*��2Y ����{bB�����X���@/���𭫧y�}�J��
ʁ�ka"�,�]��x��J�`�oO-G��zk���l� -]݌ҮhO��a�D�!�	�s�V�)����uh�3Ģ�u��ԭ��E;��o��v����6���(��ƭ��_6zۊ�g�����+�~�Ү;lh�ۛ/W������ ��'��w��������j�
4ֲ��6��1�(ᴉ�w�9��W`CO��)��#�wx���ҹ�������V��?�&>uPz��o�����u��f�Vc =�v��c�:o�a�a$�P�51*9�.Ks�~�}3����s/�����?g�q�>(�������^�!"�&�E���b�Ry��
�&�2��8��5gH|�h�3��Y�Ȼl�]{�m�*5T79�%��r���v��j:o�XF�u=�����F�'�y��R�}ă<HD����������
��z������MM�C�2�d�����{I,������(~�9rG9��h���|�?E�K<r]YG���}x6U΄��K��\���k���G���A��{?Sȼ��EG�fo']������\�������J�tl��u�]��m������鐓.M�M��A&�cI�����I��o�Ƴ^�75��ۀ��z[Yh#oGT���ǿs{��A����i��I�y��L�`�%v�����v�L�Gc�0	Pdv�F��d���"����wl�J:���J�\��t�w��C�
>%���sV�_x1�W�SD�՞*V9@�#�0�_����c"&��b-�6ф�r��*����7k����38�4g�?�|i���NW^�gz����%���&i�%�������rx]t#ᕀJ6�U#�jof�E�^����zu�SӘ��8@U����v_��<�w.�8�
)�o\}���.��7C���߽۴�/�|x�cSL�Mt�'/A��k�-�+�@�L�Z)\_B��BӁM!�`�T_f6kfEF����-��.$��S��A	U�66�QM䝺� y`�G��lMr Ii�k��~�F���_I%����׳�������� c�e�Ll�e��B�?��t��5%�Z����
����ɵ��d�����WmA��!cœ�~�_�xxP��P��j�Є��E��;�~<�����-���>Ͱ��oo���f)�^.�����%�U��X�c�{�q7�~���zYj�7�f/�ئ6���ɒ��I��1������p?X_T��b	ce����B���|Egc�Ag��q��믘�z�Gӽ1������Bp���g����3��R�E��_\F�8���=�2й�3�%� �М,4����JE�ȳ�(�^Á�2f��-f͛�%8�5����v��آ���}�o��������^i�w����;��v%���!��h��5$�lB���[�e�0,}�K� �h/���� v�g:"`���C)X4^{�^i��F�I#|5�E �TL�xQ ���*t,��0��Փ�6DYh�my+��C�~�n(�TC�ꖼt(��"��n�4
�𬸌�P!�h�A�: V_����Y"w���r��bX��T��¦�s����`'~b7q����G�ƪ^ж��K�'�[�����F�ѕ/��x����=$
��e��h9*���q���S�'�;%X�ש]�¥晙a-�j1���O~`�t���I�����c�p�V�8�"@�Zx�r�:+�C^��h6U�ǓAb�7�)��W��F]����hK�����/i���tZ�,�12y��Lx%�?��T�Aݮ��z��%�i<c�ܩ�J�A��|L�Q@c�ŝ�����ǹe]%]x��-��+��,���Z(?X�6�b��n96eBLm]����t�4��}҉��>-���a�s$] ,�^��Lz��t����Pu]4I��7<������/$F��E�q���R�+�@������.>m�^���h^z��gZ�U޸L��/?���pPz��CҤ���^�g��6��e-���f�����p�߂�筋��[�n.�H�x���Q�3����t��y�����tk���G�f������݈Z�����Æ(�sD�I��Ɵwp�2:�������5M�Q)K�x��EFH|����\��8�߇c��2�k��Q!ʔ�Wm��/-k=�M�@���
�)�3`&��G�N�^[��Ϊ�D���p��C�/j��t�ٴ�0����z�m�ۿЛ�Z���l��#�ն=�C��$�x�t���ř�������K����}����u�wlZ�~�>�3�o��}�)n덾�?�p�R ~`3<r�Ȅߍ���w30�Y�ڢ�ٝdYH����@�3��@af�ΕXe�}�vq[Ȫ+-������?8�:7F!�F�$	`r>:LYA�d�|����>rv���i�Ֆsz?a-�!,5f� � 	K\xQ>�]� Â������>BL�x�e0�Nu��~8C�J����`������s�vu0������+��m������@#���U])�.�w瞓�� �&���:%t'��vͽKU&Ko\u�4z�y�|\�Z�,�Լ��ֶ���~{�t�������N:�{[��V[��o�+��[��P���<��S�Fɣ�����zw��5H�Ӛ��;���J��P�~w���Lk����w>lq"҄��0%�OM��xAS<>��P�e?|�<�FC�>�f��֌�je��z�I`b磌26����^�!��.L/��"���|V���+U5���&S�u����4�`(���g �R7d���r�����|:8�κ���G�è��b��M�H`�?m'�_�\x��}�z�G�P"	��"kk�Ah�W��+}����F>1��������N��X�SbBj����V[!�?w���-ߔ�U3D�1d��*�⇂�:'qGN4�6<m�������g���m�}SDCiB����P�&{��;��Sp4�@^�0�8:��v��u��X�g��}zWC;F��Ax�h����#ё~A@?�����3�\{�^��_	}���{�Z�e��f�mP9#^�ۡAE!#�.s��x��6�����r��f����5uF��ܖ��j��dky��>A�a��+N��oy���@����Ú�Og4�gb(�3��-���Vi�M_L_�a���IK�8�.��A<�k/�6v:֡����(�7�:��?�N<iܯ\G�8�#�}��͢�ۢ�C�u�
{�)�-M\ ��>P���E�с�p�f%��\k'g
D���08��2BV�e07*.d,�j�p)�hT�Q&6�#���r"��
�k����T���kz�3�R�����3���4���!�î�G�6�pH����n�l47ST�D���]�/�b\��E-��B�u=kg00����ŕ��������Y�Y�����i�>�_5>}��+�z;�Vx�i�C.J��tgz�2���h��56ZX�^����"���m:�Xn����>ҥ��= f�z�s�4�u��D�<σ�;�c���Sq^UU�4�P��ɠ�O�:�$��]
�vb^r�.zu����Qw8����:۰��V��+G�� ���?��q�?;�`u��A8��"�{�f��q_XP�_B�y4U�R��F�:{�%�[��0.M~i
��-ԁ�aݰ�^�Jޣ�$����%�\n`\I�(�Rj0�`jf�}x�tõ�����/\I��Ut�Ek�M�J��������.�-m��Zi6�3�jȽ��C+F?$���COy-�����9g�8�#P�v0{ѳ��PDx����7N�$�7�Zx�q���ƕ`=G\%�ȳ���aR!�I�7��$��t�����%M�KU �.IXng���@F� }��2�.�Y�&�~*q�@+9&�1tDFJ�ł��e�P5�Q�yqİj����/+�W����ҔW���mƥ�~�*f�m5��؆���c9Q���U�џ�O�p+Q��<�Gd��%1����H���1}`�����_Z�]��ն;2�����EW�d�y���q�v[��j�i�k��<��c�7�y���b�u2ĩ�uܚN���>* 4Yk�l��دm��g>(a�[Ƨm�9þ��aL�	(+�r��S�0��Jv;H��y�:˦;��\a�^d�W���Xҹ��A|ȇ���� (�B�.F�l%���a{���:M�2L�텋#췼4�Ɔ�<�+2��5|F��o��g!�����_�_	�^��"��g�+B�:�Ў��,�0[@IƓ�߰�pV!=yd��DS�[�dE&�d����D�2eJ�x��q #0�#�����:�#���~�&��	�N�;�]i�yG��`�9̟��fD�b��Q���c�������I'��L�V�&fy[mѰ�P�6k�iE�T04�չ�	���VE($�^
�UzI#�Řl��a�JPw&�M��z)��@�	�Y�&�����e��bpY�������:C	2�g�\<xE<�^c MU�V��`�&@ط����;���O�M�aS9��)֚�	:��`F}[���˙�v5]��0�i�%�'x�c��.�޹��!��uA1������p����^z%�{ɭ鿿uqZe�#��<;]~�-i��TG�)���V���8h�4���sl��C�J��LZ��R����o��<�5���/C�o�?��K��X7l �����q�s�}Q��/�`�����w�C�@�	��뮱|�x�'❭��V���l`�j�/9�+G3�u�c��y!ӛ���"��p2,�;ZC�zڪ�d��G�5��������3KЧ�x�u��'[�0����ۭ���Gڬ]Q`�1N�E9䑂���0e�(��<�~����Vp����{���И�jP�o�Q��n�&L�A��������4-���4;���i�X?6��	��ݣ��^uÞ���gz g����Q1��	���#o7��3���	S���d� ZH��qʃ��x[E1�rp�"7���%\V �2�J.��T!���_�@$M����,�Gm�B\*T��3��K��*��� �u�Fv�A5�l��f�ņ_R1^�33�6\@���_t��9iZ��r�,a��!�L��F�k.AF�cå,Ya���-�d5\;�MC�6��8\�(���+����J{|�ڻ���?'�[�yl�i� �&�������,�n:mO��o�|g���5���׈0O6��HV�ʩ�^��ѵ));X���M����3��]/�������9��p�as�e�7}��v7C�-;���2�V�5�=�.Lc��Q>��F�h����ǥ���6��?1�Uk bi���oXl~*C�k^������Q�����S�jpS��c��YO�)"����]嶠��9}�`���X!��LU���ќ���1�s*�vZ࢚?�)�l>T���G�	}�̨��x0�BS걸�k�^j���om����i�{��|��i.�k�����cS��MM�zE����0�V߃ЍY�d��j������E�Anm�붱����i�ڿV0b���c�H���b.X�ݨ"hE^5�e!��a�iy�m+&o���s���f��&��.�dߪ���Q��A������t�q��N��Ԛ8k�z9��Bu�}aD+ym�/�����u.İ�y����_x�1!�-���X����˨��G'�`k,����FɀsUE����}�@*`2\~ʎ$q?��=�dz��g���>�&xv���;m1��A�	��E��FR.�͕'�Jog���yj�c�.^r�t��E��J��:�u���'y�ؾ�\E�1��[[�1#��á�t�*n���/o��ű=�7�}T�]z �{�xZz����ۤҝQl�ݑ%t�wX�� ~j,��}�%�q����ר�F�f�_4 �F��F!��g6��sR�[Y}ZL�.�d%=`�D�=.>�س;pi�S�f�O�Q�\؋�-Z�)�������e�A�g5Y�3�M��������N�gT�v�\�6����Z1�~ʇҳ�}/�~�>i�����0r�RZ/|Ъf�Y޳���.��?n�Ël���q_�D�����7h��l6j�E��p@w�@,��4�W�2�u������Y��͝ki�*�v���6�e��'/����|�$O=�����RI�!PӪVRE�Ss�,"�CU8pĉa�n��e�hZzAFb��4�"�C��`v@�P8�o3t���O�cf�!�n0]o��Xw�H�G!�0\U9�DK�%�����P�!�wi�e�x�`v���i�/�gO+msD���w�ج����*f���/κ����5`��6AC�$��s����?�����1l$V���V���7B�>���*���O5����K��O�����s>�/���.�%O�ҧ� �d?I��G�C}Ck3�Xn�
���M8iE�>�l���5�t��p��u�Nw65.<PQ��D��',��c���B�?0HK/6�⡒�z���չ_�FB˨u��sW���-'J5�T	g�hw紣���i������HUNMK/;&}x����^6�"�~��JK��]�Wzy�!�6���}�1���bqA�{�/N�����[���j�]�=h�D�;_9w�)S^<O����O������W���xF� �BՔWs��I圃�o(%䛣L�h�/P�r@���V�f�I��+1+�T�(���!'Nĕc OQ/X]��C�s�0����B���C�T�b�hj�%XIKe.�T�t�KqVA ⨓ʐWr�P������)�'�u�eMN�XZk�e�.��3� oXŲ#s��G�,��7t���*H��eG�)[C�x��Z��ͤ�~Za�d�!������[�&�e���s�5�Tk�^�3�	����A����}�<E����E�Q!��l���|�"������
�����F������fg7��K&�2xj5���+�㾾_�ڤ�_	8�9��קU�st���;�����)l�6�������&Ƴ�����k龇������������b'��|�
�>�t hlC�}�Yd��hh��1!�UE��W�:�j�^n�@{i�.`}1��ܶFQ'sw"����l�fQ
�z�� ��,�X0�mڄ�xH����	ǵ�}��L�UpQ�P7��Yz�t�-��'�0�p�i�NGy�*�Xd�V���򞹌��������Y"���`����N�/4o�|br�\s�P�f�4�����2d	>#���y��l�0&H$�.
�4EE��4�zɎe���ҧ�qAG���O;�"XT�r+L��IX�vd�L_�2�h &]СO��M����RC!d�����ۼ�ʂ�?����J��VP�4w���<`R�g�E�~�~B�"�hm����S��;;�h�7�[�*�i�`UG�3�t���.�R���\��^O��+�Mۏ�!'^�X8Ǵ���D�(��矟�����؊T���33�dmc�oY�0Ƴ�H���;��\�z�~����.Z��m�?F��a~��jU�B�<X5?6x��g_����ǝ:_�=p�7����}0G迚��Ɂ$_*5N �G�##�c��/���oh���xU�j4Mr)+5���vf�l����}�-��bc(��~Pi��E��M=����h0�yݶ�9f5���c��lz�\^��#C�8�O�9h��3b�Vb�Qs��7Z��6���z��=�c�w���&�{���;~k���������r�v���3q��.�y?;�/�����D\��6��i��u������QE�Ϥ�f@���y��:#ĤW�Ku�)�K�"�e�|	��8ƙ��B���B<�@�>�D�������S.�ALF�<�# |�� �N�s%.a4'c詇�L0|�HO]W�",;���ŰL�:�x1X�����j�kR�D���d[e�%� �.�aἈ`DRr�;$Ay( c#E�;E#���U+�&^��>�����nJ�n��t�c'>�P��s�j�Ƶz�C8��-EFX�xĒ��v)�p�;��s�d�q������Ey�$̑af���[��\� '��ra�?u�t����7�:_��x���/���������UZn���0#�������K��Ɖ����px�B^�B�nXY�${ِ$��m��5W@Ι���}t�K�=Կ�)|�x�$ZM����lKb���}�!3���H�%L���Z�Y����R��u	�z�c.|��qL�m��!y�x��]g�p���C��Y��z>�;�\���1�tܘ��R�˅�C�ͮ��Ox-����'�2eQ�[$��l��ʜ�2�"X g!�����A�L�N2�� �q�N��@��$�p��n����9YQ&�Kn��^L@*^QCE]p����������"��mŰS}�O�p�z�6��l#�|��!�r2׫�<��˳�0��ۛ�	���l�hF!*Z�y ���ot�Q$�`p6�[�<F
y�P��e�4��#��A���ԑ����ooNo�����=<p�]�&L��o��"r �5m6O9g,m�o�Kj�9"Т�g�����`[��gvzSZd�BEmA|���d{I����I���_݈�1	��^�W���G�t�0�}T���&G|����-����ԯӛ���4��Y�p=���֙/�8� �#s��$qd!I-�t��lr�d�/2ߴ�o��8ძY��-k�H1�hD!��e`#�3�p�7�+�zg�h�Ҍ�Ђ�����7M���  @ IDATk�w �<�p���68>4tI�����a�5�J��!���?/�U������c���KZ��s�� �@o�d&s���αMT�C��V۝8��Xtbr��̏��~j�� 	T��u�*D��ʔ���A0n���[E�K�Mp\�v�X��@%�C�4�s��
 ����CK�JR������SM�\�75\j%�.Id�P _�Z&��ӷ�3b�X���D4d���&��[�`��"nN �q����>Q�$F[�EQ�[?+�jC�A�� �b�o��:32}$A�]%$H��9f?	�O��s.�=���?��{���n7��+��o*��%rl�kf,�F �Q2|s�����1����o�{�ܷ��+>O=�<j�?���l�K��n;��.
�a��?����?��#t�U����]�[;���7�'&�W��?�����(uZ�BFT��Q���V�&~�O9����'�z��I�~�3=G蛭qѩh�=�X<����XXN��%��*��"R/��@���;�s��?+���ǃ���d�HR���O�,�J�PΎ�����A������p�;��-\܎���O/����M/��W� ��}��;W���/;�Vޖ�MFyB���f�w�~`���s|3�J
L���²f61��1�!��
��:�����"_Y�Bo.J��Y��@��n�f^�aN����X���S���^�c�?l\�B 9t %�t���ͫշ����P$�!�:���6��a�q��Y�4�x6��4�ȑ^}��gIQ��d_�>99D��C0�+�B�
uռ 4SC�Q>t<v���Wo��c�H{p�zT��B�|�������S��G^�;�s@Q��폱����DL�fS}�m`����9+a�0�`�l���Sn{R�������G_JE���4`����}L5�]���������h����/s�)n�G:˞����Ǧ���gn�yĸߤeV��1<�x��������і�y���`���~��S�U6w�D�����  �*W�(5��������"���Xvݍ�Ҥ	/�h�#B�5+Z�)M�͌3�B�1s�Pt�#k�.N�a`�ŀ�'��������5V[!��eC=�b��t��;��] �����~}v'���t�o��E =XJ��A������s�{�\�|3�7�L��&���iG�0�K0/���ㄈ;����'f��A4�����z�Yg�faM�*�����F84���� �Ġ t�;*�'����A
�l3vb�y�O��WT�B˪�C1���@�z�`l�3�pYS��P���@1�!}���]3Z���_	�S=�i��c��[����rY/U�qWM=�.�"��)rdQG#n�	��s&�Y�
*�N�:3. ��hē���$�)]���?��~���޿M����6��u.1}G�	�_{�x��Ō	{�]6�H��<`$�#9
��>_���T�۟���8 ��g�.�ͪlv�R��Ф׵��Uc���)]t��Ҽ�j2�C	m����=����cc�!+"���ɧ��fa�D̓hω����e5�X���^*,R�a>��yȈN�:ZR,�ۑ�)�l�d����F���k�<3湽͸/�7m���h�BF����L��3�9�"Y��>Q����H�O��1��� -<�,��S���l�^0W�"\V���OG����9��1r�m�m��.H^xC��H�!�Bɜ{���F��?͌դƩ�&*&2if�I���
X.KM�˄�P�	Ա���Y ��ɘl�FT�y�(�/����R���ILe�aHV`����(XBVn�Db.�� >|��t!������V����(�h�&��������R��ٟ�#��Q ��V�t�fO���O.㆏�:�o�{��f���}�&�����F�dp��{�E�]����J���&��Xkj�tV/���D��C� �q���~V�<�OV'��7����9|����$�d�#~}���{'�\Tם�`��N��&� ����w�a�}[���^rQ�V]��·��L��|�b�S��a\@)������\����z��`F7Շ�����ZR}R�?87��ᴲ����o�X���� @�$q*dIBF����#�l�E4�cOO
J�e��yW*�g�ԅ"�P.�N;/��i	�h��Y}I��q0#z��D �	}��[��^�u>ڎ�88+�=�3؜ۙT@Δ+����\�L����x �gV����,{Ξ|C��ì�SgE��Ͻ ���\%��Ç�)S훃(m��_��\�ˠt�_0Z&�'�lGJp>ՌV�w��8�����O  Z,5��VY�QڎbA_�j��FI�&UT�ܴh��$�U��1*[�J�̪�qyOʔ �.�E�a`S�%�3��!�WY �*�b2� `}��J__�{�Gf���@�������4�m���pq��S���Pa3���Be[�>��9��<��I\�!p�U�A����F�( I�r	(wÝ `������	�#���_�q������{��{�%!ط�����{q�yX��d~^���N���������׷�yz�F�ŷ��|��k�j��YAÚۣ9b�����;:�����VO[o����E>���?��wu�f�ߛMͰ͞�F:�(�/�Ā�rʺ%�I,���eY������O��?�9���g�r�)Ú���j�*�l����f���|ИXdz�@D �A��������r�!�^?;e�-��>�k��َ�؟��N�r���C�~�r�$`�d�F3�����i�Qޗ\y�؋@/3{z f��jߔ9���#r���nm�w�38�kr�f!�{���^��u�n�\
f��=�X~+nx 
9�e �`�mB�S�R�I9p ��#������Q�iBe!]9�`mTR-G� S7�+�H�U�Sr��0�O6y\��	4��K}`e�ש�jƟ6��?��2��V��^��{��6a��[o��؎x$��o��o
��rVXf���&������X��U!�]b�d٪�J � (��?D�>�[����XkF��3oM�~��t�=Jr�sl��wp����|��s]6�Wj�=�e�Ϯo������e�� Xt��G{2�q��TE�``��,[�FdP
�e	co�ᛗK��y�m����\��Q��o��Z�H������K�qZ��3�B��T:@�?P�r<C������O���n��B�)/�h�?�	�A�8؇��K�>�Ta�F���#ُp]%+�=p "�;w��}���hn]v��bC�@ [�h�(8�! �D���C*�l°�]�5����y�\ؔ-���^�?Z��M��$��!�"�5���+��=�GW�{�}d��G��v�h��4�Eg7#+fI�2��ۚr���,.f��fϼV3t������I�ce��fS��pJ%I5Of	dM��\aH�r,��LMU�E�J�{R�*XGel�p������$� ���~V�y�ö�9�:�.���S�O0#G�θ��N�� k*p�QV{t�Zfc�d� L�7�JwC�;d$�(P LC|�o�c�l  h���I�p1��Ԛ�A�ytBZa�78C�:墻�KT�a�FZ1Q�ez`�C!�2�<߼s���E�-��aWX����3��)���9A9���\a�t�׷��ɨH}�޸���s�Ig\xc��C")���������S���(	$�Ա���*��@���`�H<r8�`[q�E�a_�0���o両���X��wT�et��y�䓐���-4W���z{i�#�5��\�^|�%6���Ɠ�L#!or@NM\Q\i�\a��湦B��
W)J;���4z�<Dͨy���ϸX�v��ޫ�ߍ�4N�WM��"0[�<Gn�U�Xj*a�9�}m񪭌&O=D�!�c��;����~��>��FD8U*D̽����J�8!�8�4|,W�0��nɁp�|�����X��z!�$y/YOb�بqv��H� V;�d�����W�@�+3�R!-g
j�U��,Ͼ���S~ۡYhj�ɓ�d�f �ٲ�����������R:��q�^���ӫ���X�ى�9F�" ۲d���D	!O��̼f�l��}�y�������3��v�>��ѯ����H"NM���x:�4��[Xy���vz�y��X��t�$�O�p=n���Aۤ5VY����X������e��� ӪK�Ӡ��;��7�����i�����{0m�ϙ�#l�m�y�T
�,׼Ms�ٱ�ܑ��E�����+���o]k��Ϋ����r��lxp!���j��q�<�z� ��Y�%��T^s��뮎�{��/>��XtL���:z��G`��Ii�w��"���M6��n�}\!�C��}A�.�r椂(nRI����Z�h��������Q��Lw��
/��<�6�Hu/�5"`} ���A�~�Nfq�K�:���#7�C�	P���ñcoKo{�j�l��b�_��~~�i�nN���J��hX\�١�yA�@�T�[SG7�$?D���5�
�:���$n�5A��RyI�:��PZ"7z��@�5%��P�͊;����tqgT���, �k.<Ŭ6���2��NK��Z���b>�~����ǥ��_��} 0;m�N������h ����`�`/�bl�{�%c,1&�F�Xb,IL3јXbI�F�ػ��{�]���Q�sϽ�-����;��s���9��_����}�/&d���ܘ^��RD^�	��ֿL\rm�Z" /�"�� !qh*n�G�R9YP#&\��Y%�
)è�,�h�����o珃���h���W�I�"l��k�.��R��T=��1�y�ݔk����P�i�I:k��c6��8�
��X�ŕ���J:���;jC(m��B�H��yR:y��m)�A����V$�J'k��	�����r��ä{�9��a�|��oU/�a�LC��*���X3@ pH�St��O7�3M���=��.bh	�'W �����ф���{˻N�>?IO�|!_�����"����� ��t�n�7���Y��׃:���]����g�������<�F�׃��'�Ǹ���DUC�TUT�lp	�D�Gϰ�`����&��*������L��/�=�W����ŎFhx ������'�h�h� h�uTҰ�C��p��[�C>x��i�u�M�����l��E:I�ꛮ��R3�_L���R*���c��r�ޤ_�*�A(�ޔ��1>o��+(LܹH.��)(���F&�#KAn�T5Kb�����"��P�1Rl ���T�ň�1��D�T6[�'�'Ot���� �`�r�%�͖ �c�g����I!*W�����%
s�󼦓c(ꆜ�Z��"��n��>�/�ԥ��w�)$@�����مo����dم��]`�\�I����,߼G!6��T�,��͌�a������*w�`ӄ�[�ޕ[�a�W�!��lT[�����<R-��������zC�d�f-#mQ�	�����l�a(;�g>+�cc���Qԏq:S6�'y	F��}d�5��w-Yd�,�����i�$�-�ZTQn�+0L��Ѱb��]��-6�t�2���?��j{zs�8y���7ߕ7�M����\^}�=yq��Q�?ח\~�[C2��j͂yP��"��n���8��DQL=����9�D�M�P�ye@�޲Ā�e�A����-���VX��;_��b0��}'���hW�]�����/�G�(�J ��d1<��C>�&�0fe!��GJ��8��9@�QA�'�&�bа� �c�r��`��ھ' �~%���g�ț��kg�ΖP���:�l���G�倃���O�z����q6z�5��-�XEn��SzV}j+��8�٬�K
 g?=�@$}k3��l�5Y$�C�"8�(_�av���V"L��Ni�"7��Xf����E�t�\(ᐥy�7��@2��� �F���1��EA8��*'H��C����2�S-5�ն�}5��e��Tl���r��Ul��`���Ј��)��'%,Bf��@�b���:��!�������Z �LC }s�
K̯U@Zn~��v�V�n�5Ӽ���T�����k$�M��}�C�nQ��?I�P: �8���$pYH�.���r�w����\��&��7F��?�Ξ�
B]�{OB���y�@R��%-�B�zH�ۉE���m���dϵd�yz�o�IT��Q�̌m�h������O
�!�̈́-@�<�n��6���>nG}�L{�~��5��<��h1�3yv�X�և����ܻN����݀���f�}?��-2M�ey�񷚷��5;���a�|��>��8]= k2N>L�:Bd��1��1r���W�4�A�=ZR�9�Ȣ����񤍇����-�/���$���8�ߏ���Y3���D����Į�9#ɠ=�[�)�,p��dRNd2����	��V�ګw�Y�/ܚF��=�}�W��!<�8Ю���V��\L��p�	\�����. �*��}V�����	��W3X�,<`rŢ㢳v���;����k��6L��%R6� � m�Q1�����}�s��X�_#�l*�D��D|`���<
�h?y�����]�D�E�q$Q����B�+�qeE3���:uVn�`��(1ɠ��i�i�$�f���"Y�k:E�8hP�З��9��Ѿ�6c�7+�q��-Wݨߞ�J�@a1�Z�+W��!�n�y�{,H)� ��H�ӽ��d�.+A0�H�)�cDb.h��9Jl�x���r�"�Q2i��V[� ia
>���U5�_�!�]�j�@�zM�l���[���Q��������+T��#���&�*�6��
�s9yg���rщ�:�.Z��v����/�_�c��<�﨓��m�)��no�g���`�D�)�N�9J���^���f�8 �x��;bӟw�p�� �ia��4���A!�u�k�־}����/��C~{�é�~�p��O�)���C���9Nk��SG",��J�2b��:�3�
��EF���8�%�a���>�4YF���U׃�,�|x��O�1Š�:�T�4o�hH����c���C���KM}c$�%s{�X�'S ���3�Ʊ၊���c�ip#��<�ۘZu��"�#�/eh��:�c*E�� �2y���_x���F�YH&������~���w1���k�9�E���I�!�(�i�,�Ya5�3
�l�NٔP9��;�+9��L. ,ʸ�~"S(�c�f���G��&L3R⊊S�@���|�]��2��@H�MUxf$�F����0�F���z!�����ۏaf���yz�-s���
r�BP��Дn���W�0`��Q��ф�-�U�*N@$􇂙L���e���O��(�>U�"@�L�\�U!ȃA�
�u��~K|QȌ�(�4�Z����fA�i�`4>d�A�"�.|l�=���>I�9�V/b\�VNl�q�������G�s���������	��G��c"F+��M(r������6���؃���2��W�ه��5��hM��s��Do�^�#]N�r<U�����h�+��h{"7?��Z��PTt��J#��#9� *?�Pq�JĖO���0^&� ������b#�4H��L�.� ?2y��`��>�L�_(�	��)D�8J�����L�1�rIo��P���� �B��4�
�Z��C������\s�;dRɆ���5���=`#M���+��ym<�or�1�����ewq���z���y雿��R,(���?�/>��k�,��B��+6%<E�.d<5s����N�)C����j�`��<Y�
:ަ�/p@��Q4~�3'��FLJͅT&�V$â,RE.�E�a�4��\�/�z����6�y��h�@Jk�P��D9�#�d偨X�%�Px�.)\-2^�]>��>GVe��yl��p�+;m>؊2Cm��;���`�X���X�W�h���Xk�K�PAS0&��6(�u�X�{)TN�
��!��5�nM�X0�;(�"@��ٝ>Յ�Q4�cZV��zӿ!2T�|%&=X����[�B1��[�y�/�2	�3��
X�.�7����� ��]����1�`�y���/�c��߹:(�P9�ӟ�S��3Z ����G"����ݶ^A��� Yc�e�&�C��wƛN��),��%�J@�x
V�dJ��s�9+[/���/�@E�(
� �A+�4�� \�6�� �"��y{0�#��p�B��Z���2��|���ȍ��p0qq }�1.L>�E1�$��__���OV�f�LWÖi��i�#'����>�H6�{�=tK2ŸY_B��@��3���h��7h�5S����mX��-wb�,�4Ї[?ȸQ��t�eF3��7��|�]n�bYb�_�y�7XP�djN�U;�\�1���ήRaʉ��1>�:\X��QGc�lI=F����NDT00u�e�����Ι,����c��h��4	�Ν�.:��_h>Y}Ņe��I��sI����R����^zto]`���⪛^\�^zÓ���nU�#V`�Di��9��W����FA&�h��#'�v�ZQ�?���B��|��F�:���`��t�&	C���x;��O>�q�~$~���~��0����	{���ʘ�(���]�?fj��1Ȣr:�@��O��I � �"��X����󬗤�bI�Y�7  _� �~��g 
���im�3�$~��e*G�[����w�u[��������P��t=X�O}��s��j����v��\�����{�'���������z��#�����\�d��M�L��7���? �g�~���6����#�����1l�j+��y�Ք;�c�����
4@�N��B����}��2�8�3-@KL�.J�R�VB}ØU�$��A��<�Y���L�N���#��j�H�U����L�G�s	�p �kT�������U���`�R)��uMC�`KD!��}Y���W�l��-�i$0��m�5��v=�8�v�&i�Y��Xgyէ� �d�5��1-��S:k�`��䝷O��M�Y����kz��G^y�(Yb�_Ӈ�P�#�]��%�&�%�و��ě�K�"S�Dc�d+�l��|BWIJJ�X��{Lڀ��ۢ��l3:��-�J�W7��/��=@V^��,���2_���Y��T"�$�*��V������|M���=�P��+{�}c~E
i[82#�\��U
@L�.lx�|'9�w���'�0��F~���9��nݺʢ�ӦAKg�5����5�{�|�<�P��Л��kɛ�?Г
��s��Z�{Bˣ_����Ӷ���lq�Tg�ĊDU��Ah�q6�@Z�lΐ�c5J�g˕z����|�^]��B����$��A�OE��k� �(��'N�O�$PՋ���Z0�ɕU=�`|~�ы��~Ko�&��n�g�}�'�&ɰ}.�*���zUW'�/�d"C�R�+>��8����� ��L�G�p<l�U��X���4�V��8]^���a�Oj&�1Z+Ef{�p�%�I�8�Q���P�i�}�<G5��dU�V+�8a���;��Qrxr9��`H2�!��u��+�4� �3����k�����N����il��L6Ft*�h��3� (b\���q�A
��!��l�hQ>E�᫥, �)L�h�d�=6L�F�ၩx�\�5N L�A��80�k`�����|<�TL#��)�"cA�����˦��U�� �}U8	p��v�����N����������Z�5�Hrxx֨���1F�fB<�$_8`E�pA�%8���~Ub�J�uNQ@8�F\���o[�_f��d������'�.��,����)#�5�ӳ�o�2�����z�Ի�iR�}	�i��Z8)Mg��unb!(K�p���AVQ�
�����O�����6����c.�P?Yi���>�Ø�ޑ7F�-�>=V�y�]}>�-�����J�~n����-:p|�&�¥/Ϡi'B�+�4o�F���z 21e���"	ꝁ�!r[ټ#| � ~�����5��M��5� ��ٮ�w�/N��ӛ��� ;O��^��b���*���$���/7�q��5��Y�}��D�֭���jCg�Lߢn��B�0�%ԋu#A^���y ����}��}��Ύ������^{W��t�Ŧ�7M�)Z�Vԥ��O�1d�CB��,��+.��^2�o{l\q��E�^�>��]؞Vۍ�[P1��i���Aa�g�f)�D�L͘s5"�� �y*��4ǱX>��	�U"7%�*BEd+���Vi���PP5��dV�π�ĝ4���xAh�7�h�h� h��I>�	5m�A<�c*2��$,l����y���rյ�Nۯ�c!����WS�	 n��y@���w��S��.�Dj�Ă"��$��AiY�X DEq��y_l���D0���	�X<C�n�:��]u#��~�h����U����^��M�b�!6�'�r�?�J=�,���(�k07+�_Y�$3��N�t�Ab�G��DU�p�#���C��C��{,���������P��?�g��z��OO
\x�z�s��9��f
Gᄀ:�𞥁G�z$>'2�T����O0M#�<Ad}.�#���hǏ��' U�ޝ��qԓj.�IOUYe�A3�16�y��g)�d��e~1W�����@���N{��)��%d����6AX+�?_r�2a§��6�E��T��ٵ�R�� ���Y����@���r�n_c�F��!�w��.��,�=j֘0y`��@ (�r��-����h�8�Bo���p�	�ACӑv���\w�����Nv�e�i�y��^R�����X�Z�M�#�2B�F�л���{ms��d�+ɋrBn������0�@[�#�"��!
q��L #��2y�+�����7<��@��@�@��.r�}S䅤eL�6t�H�t䋁=�-=a�h�����-/���+��	ljbQr�O7�~u�.���k��`�A "�����Z��4�a�/����,��db���2��%-�p.�ƒ�0R�z�gϹd���ɖ.*�o2X�IܟW�����N�  M������JӔe�[T?����Z�%C�s���ͭ��KB���H��G�C��x!ک?�!O �߫�����'���횫,'CW$��.�B�9z�<��r�#��7����&g��4]�ਚ���X�grH�|Ff|�Q�؞=�-�ў3��N�v�cܮ��Kz���8��BB��!9�����bmq=E,�{��h�u���d����n8Hu�$n6?��ǆbB���䂂��ߎ݊�#Lʌ/�σr�y�Q ��;�*#5c���A���=�9��[u	9�ȍ�#�����W����*��ұ��e�m�.|t�Ƞ�S��A��[�>K�V2�����:P���i�^9����
u@�=b3;�,m��	h��8Λ�r�z�K���D|D��`PE���`�N��4�z�gs��`$��:��h�S��Eq�W);������V:qe5����I�rGS�|�z�q`��:J14��},�c�06q��lM��� �^ښbze��e�?�
6�e�#�|Q{���H���ˁ?��4w>�x��H��D������>⨢��a�,6AQ�W[C�1�x�¯���b}e�o�(���{6?n���m�����|��8dՋ��&�C9ϵg}CV��L�ɍ*�S��0H1��\I���{Z�Hj�e��� ��GBF�m�w����?l�tu�,�}���Q�aE=x�D{Zd@�o����j��/�Uw��{SF�����S�Z�A��/��+Q�6�#������Bת����I��ST�)!�⑩g@�fx���V`��O&M���}�z�%��9�@W-�9���(���Nh�?����<��؂96i�/�k�a N"�ԝ��R^z��%��s� �Bv@"Dh��yh�2;i�9�����,�̂r�ɻc)�v\����.� ���'0��WS4���@��pi�TH�z� 0���P��,�`��;/�^�A����Ҿ
MbC�l���E{ry�HK�(���&��B	׸i�Io�'�����u�9��:���!��X��7���O���mX�G��<b�|�ޘl�(�|�+�"�<�қn��}���84<�\�����<�Y��	�Y��-F�������m��ņ���8�\җ:��/'��$����/��N��#���!��1,Z�,��6s�}]���W��_��&�P��������'MM��τ���F��1Q���"��k�Yb�� ��o�/♷w/���~�%h���g�>���K/ ���6��k�d=�rt;|���ȃN�"��I��
~���ˣr������7*n��Ʀ%6Tk�2H����O����岻嚻F�ko�cm��V�,<q��*(��
��YqD��|d���|-_W`㋍��#_�"ulM�a+����ت-lʲ��o�%!6�g_���k�~�@7�=���G30M�;=p�W	U?m�#�?�f]P7���׽��=�'��m���+�e��'���+h9�YS�5�I�c�OhyZA�@��_���C��ɩ5j��Ԧ�� �z��\?܁��o�+^��I��+��)�A�V��}v�Xst��+�F���N���%y� o� �8��5��
��Ћyc*"�J�^���D �mа<��TL�ӔK�\�a��\P�Y�٠ �t�;� ��l��W#j�T �����Ъl���dv��P�S�ejA�*���@O���dP��5F����i�%7B���=g�a�k߆5N ����8�:ZG���d@���`Ya�n��J�
\(j^ߔ���;cɍN[�,�--�c�s�߿%���}FuRY\8	�<���:��z\��.V5e��r�f3L�ΐ��}����ﵚl�/��[�C�z� C��4y�)�� ��a���_���_�ʁV�asF�e�t���p��A�!b&�py��Y�W^�O��sn�_26�v���3�~c���_����O��O�=*#qr'�p:~�kse�J���q�a1�$1���s��#Ͽ�j�Q���IQ(@�\��_`��߱�ؚ��]����;Z9�n�	�Eq
���&���ڦNX r4����v޵����}e�U�M'���YQ��ͭw@����DK/�}T�b�l5䰂'�V4@.>a+}q�=��b<	��c�mv������W������(h�p�7��J^ѱ�p(�q2 ���S{ ��h�ޥG�2�'�s��g����&��0 ڦ��V���\S��@�J�F�9�:M0!N�P'�\CF�d� �Y#�-�ʰ��$xM��=�'!���c��}�p�ק���	��H@��"�If�g)��!*��eƠ�(L��^[/8�U/����hx������墺�p�z �#�VE��z��\r��-`�t��1�O%h���=�٤ɲŎ�`��_G��o���4/�C�'�jC���C�10��`�\��@V�-���{o@���?<'�ߞ�����M^�y���A�n�>�ʦ����&Oקnе�L۱��ڇ.2�F�%H�d���"t�
�Mh��]�x�_���X�����C=OփE��4��p�aM�T�������Q�{%(��T�J'��V<`!��
,j��bzr1��3E�>7
��Ӑo���4H�Q�Z���,Relv>��me�m���_jQ�R���a*Yp-��q����v��N���=�?��)��/���6[�����A�%H�5"�|��Y���$(	EB5f�x������_���j6� Ayu����]!i��o�+���A����d��Δ��JN�����KcuS��F_Qmi�;0���(ܺN\������������⩟R�L8�t�ke�I����^��2��^b�ۊ�K�
�y�ȹ�<
x�
!vtP��	xƒK�FeCB�@n���ɺ�XCq�o܄$-W׺
�v8���'�ei������c���np��~�
2"f�R��	�"[��r�^:��������]��4�����_f�N��[q����;
��BF�q�%r�MO��9s�wmMk��2HA:�>��#�} �/��c뭻���ue��M�T�nCdG�z��#e烮J���cl~�fި�H#82UZ,��F��]������ho�d�G�==Rv;�&�/-Ƣ�]�#dX+E���������vYQ�s�ZR7�k��{���a��u+"o�W�@�)]�}sr�y�K�>�s��ݢݡ�@�
��͢��j��1N�M&`3�;	�;y����\����'��?=`��k�A���gi�Q�xŠ�[�A��N]y19�[��L���b4f�;rɭ�ɵw�&o��;9�L{�üB *�i��J�&%�����W�B�� (A{��.O_� δx�]���L,mYX��)���`�-�C���&�G;b6�ΐ�T)Y�P�4� F�QW��H�ƪ��(=X��V_m��'�E"٩�V��ׅ�3�� ��1fe6�N���oЪ��9���yߑ�S?!�ޕ�v�8����0���Ŗ�a� ����bRG2cB_����-'�� ��&�_�����u����R��<���v�-�"'{kr�v�8����3v����cJ�@��YH�OaD�stA<0k����d��&�]'��O����!c�>Q.;kn���#����u�+�����s����}��	l���NWdХ�4 ��㔄4��R�<4���xTC��T����] Ɩ��**�~RNǴ�zv�&�NьtB_�`�'u���!T��<��Xw�����?�D�*?������P��Xj�`�[n�G�3l�!g��ݜ���J��&��n��jꃮ�#�0�Z�`�-+��OЅ�:؅�\��C���V�� 
'G�R5f��t�e��*����qɓi�=s�4窫=4)�u,��2\��i�����V zi��0���j����7�}>�
�fDB"kơ̈́������H*n|�*	J%'��PÈ<\	Q��ʋR2��$DW���������6Vu����&�	��_�D���� 	�q@���R(QQX��m=�6�/�D�Ǘ�5�Y���u�5J�^4N L��f1]'���j�_�1��L����1�j���s�ͼ�7�!�#���v�u���f^��`V�q��Dg�>����Y�6���\�k���wy���������D��Im���ܷ	[/��l�z �Ƒ��t��hT�3��{u��,�z�}�a��܅iժ~.!�7�s�� �l]`.��6dt�;�F��x�#�
�(='�zp�U��z�T��$ƫU�_J�����Q�Z����f`���~.ؼΈ��#�Gp�Q��6�˒BᴨG%Tr���k�(�a��,�m�:Ic����v!�%����yK��.��}F��`�����Q|�с�O�c�س8��2N�H�㠱���sq2 ��R��1�oi������Um������Md��5�͆`����H�i\����E�hoA��3���QB����1�5(,�`[J��L�����%7� �x�/f S@�k6B�6B��bJ��l=���ڜ������57����{d��q�F<�<��Wt��<�8Дgf3\o>^*�xnC�ۀ�\�Zn����TVl�ڍQ?M��e
)���U�������M�<_[�XA�  @ IDAT��N��rH4S4m0����y��)�|oy���t��c9����M=�փ���Z�e�5�dx����Aʳ)*-|��\�K=_��x0G:b
��w�E��/�<B�ơ9�1�����_p���x�k_�Z�U�:�_pE�Uo�+�kn��7�o,�q�5�L4<څ'CAP¦ �즫���+fdS�b����Yr���݈ӣ�A<1���(�~���5GT���@q�A.M�������-�j1_�H�)r�I��v[O���<&+N������N�c^�����l~�?e�]ϕ#O@��`'4a[4���������7��v6��sI!"�`��9,�� !�3��x�Ł���;Gi��2aA�8%���p��Ph���H�?'&�u:J	D M��z�\���+t�I���r���h��Zh�EG����2���_�|'=)��(�g��}����4�]��?���5����$��� /gV��O�$�!�^'�G�/��FYe�?J�%���7>U�u�=2�wK*E�`u��惮7��7��A<K<P;fI��B�������xb˟O6�c�ИI���$��A�S�&�	/�;���!�ߤM\YI�ϤD���o��q���W�-�K	�^��*�3��S�f����ʇ���l���һwO.��I�<?�L�bW��4�g��<)|���ZCA������K�j9	Qv.'�yX}���'�oD������$Ye�s�_��O��U��i�c�����\�Ϭ����ܐ�h�B�|���['��RK�B��`h��ۋ��BN��w:I�s�5��F.� ���,3p��#X����2I��cSi~3m��Vӊ�F�!�Эky��,3G,�a�'�>�վy^i�Daܔ$͊0�Rg=�� �?<�p�a��hAA=�Ra�W^-�]��r�HSV���Q����m�Ճ]J��A����@�h:��#�b�
LN�<�^�� /�y�-�3e�ksh��l�GE�n7��L�J��:Vd$�W�ph����FEYM4�r�n�0`�']L��L 5y�bV&��$	�H@�	�,$�'R>h`�� @%d2B��p� !'O�+',�����jW�?�M���N�s/�ON������ɥ
'6ⓩx�I��{���ݶ]\�\}Y��_n��|���)�q�Q��<uF�|��n[_lCbK<���q��t,1!C:��X:�o$M�͍MZJ6|�ߔ>�����F7-�a�7�o��j���.�Lbg<�u��4����e'�C�����������M�7w^���&�G�I��������|��M�|����&iFlTi�X�C.����[a2�b�V�|����C`#�t�_��z��k%���;k��mTQ^!V`F�k�Η`)�%���{k<�:�V*,+���J��hc��
;�<I6:�ry��׹�F��"�%��2�0��/��Xd�Cv�z�] G>b�>���;�/w 9C!Nv�ս[QHH�¬��T(�?�)�솚�ҝ_����;m>��� W�L�7������n�편Vn�76�Z�*	�q�9��rSL?�p�G�y�5���5g ���) dqt�@�+�zqa O��l"ljI�aS9<;�B�LYl4�7u��4`	nF6�5	^�"����x'�(5.�_�+I� �\) ��B|*�".ƆX7�R�F���CT�&�ŉ�(� �Σ�(�qJz�N��W��eg��)�<�٬�k���Q�ԥKW��o�˗�E�I�Bm��1N���x����d�o_*��|���O���n��^~Si�H�Hgb��{���gip�L4N �L�Πl��	ܒ��'��4�p�.M��RP���=`�Ϧ� �4�NVDZ(�&}m����?6ha�L���hؗ��k��-~�o��7L��@����7Go#ݺ�@�	�K:s>+nO�(���R���:�UTԀM��HX���se\�n�CA,F�cmP �-��$��?����v���H3=���Jc�6d���󨦀X�j(cof��"y��T�e�bԥV��!eTG]lC��<2��m����3�H����|3_.��\l�A�4�X�wޞ,/�L�+�����2���6�qP�kn{A���f,�z��8�+��͊�:�t��j�I7���}O�Fr�ܚ��ܮH�����{e�Ng�NG�(�?��nLk�1^���t�vAIwz��rh��L"�"�#!� �A"�")�8C��?b���� �����z��� ��^�:����jҹCO�y�$�-�h'��!f�Ԝ�9���	�aU��tMr1I�M,N�Q(K�0f�I�\��E���^!�C�U[s:MsLP&�D[�@�H���d�M�0��6�h�>T��D0sj��gD�uh�/�#�;�.��2�bG��~|�<��󥾂rb������"�I� �Eh� �E�n^1�,��9RY���Ӱ��q�:��' Υ3� GGC�2�S�iϋ�Z�ؠQ�=~m����w�3�/��B���l)�>�S}1��آu\�ˎ�oMN�\�@��}&��3RАΈki;:c)�0�������Ȑp��3ߚ�f
�
l쀓���8\ߔ�O�Nݵt!��&z-#�/�R�={���@�a_`{#V�/�&I_O\}�s��~��_#$�P����L+��=�����z��T�!�l���o�ЧN���4[�	Wɾ�[��L��t�s��{��L��N Mx��偣_�Qe��Iyj!ῠmI�+��F��M�[��&g\�T����2A�<D��!�����444�Z
�G�9s�Xͤ|J(��)�&0�[�;���J*���%!����A���fm���M��3/���2D���L
�@0f+<;'p�,�ubc!+!d!��e=f0S����)B[i��8I(�`��ye?���ڝx$��sm����3 i^�t3ň����R�'A;9`<ĭ����L�s2��z��DGF�>Iv��.X6���䱲����7<�/K��wd�d������.M�XJw�Ko�,�osNXe1�F��o���$�G\��9�/ds����O�q�����UVZ��{��oGX`^p�ݲ��k�
u��3�__̎:�d�����^zKb^���$���t,�X���B_@��"?��0�o��BJ#�N�w�$�|��:<����7����8���^�ۭd�AKN�M���ӫ��F� c�C�Qb6���vE����U`_~��B��=����1~�Mk>h�3-I�`��J��H��<�M�z�0�J?��ܐ����G("�C&�O������ܣ��i�M��c���?"���n��q�T7ػ+2?��pc=���Zq���6yj�
�������ĥ����5��9	G�ph"��o�+|��*�6�XCXE�����3��PB�� ��B<��[�5V�G�OL.=X��tJ��2Pѩ\��4�G1�i�P�Ě������Ъ ��DY�/֘v�4��0�]L~.&�3�/�X?y�*�Z[�3	m:������|N��G�j��n�YR3ȩ�^'�9�����/���P�	Ju�p�p��א콂���2��AI�8��@O��z�l�{��¬/�QbS袷�c��y]F$��ƃ�M�-`q�?��<��x ��iL� q��x�����3Ϯ���ca��7��\suO��wt�ۊ}qu��c6��Jhܜ����-��m-Y�>�O]^��(��ExB�6Z�?������^`ѴȀ��ܮRE-E��M���%,0�NK��H�K`����I�B����J1�Bm"���	Up�6�#��н/��zV�eniA� U7� ?�gÍ+ӗz�p������TUh�1��Gg<�wD�4��>����P~Q�"�"#6l���o}h�tӴӋ��.��AYa���~�l���_aN0��p�JӡN��]�۬���d�C�����`:��L���!�%� %%��X�amzF����ی�����ӵ�ϓ�.-
v@��#JS5+�$����"	B���n�OSG�,d&�:L ��*%PLƂty��:2e�..�e���X�p�@ZH��.�F_��v������
O�8sr�.����r��s/˭�?#S��Gh�_D� �s�]��^��6�Ϳ�h�\'k��Ge�/��K'+��У/��F\��7���� ���S)s��[�K΍0�a����i�8�3�iL��,� ���<�,M@:`�R���O^����`"��"����+wUy�|�X�.���2p���_%es�g�hۈ�=#����ȐF�ɐ/-��WД�	�g�l�4�S. �
} �i��w��zpᶵc���N�U8�q����1z��9*����`�	e�YkS<�Ѳ
�����'�#G�u�L�811�΢���W,�9p��[�}"p�6�a���GX(
#�dڋ+����s�Ӱ8	�7W��vX����(��J�J4С�q�B>�숗ߐ5������'����6��s R�ڍ4�Y��ƒ����%о]�����yHe��
>ml��`#TA�<pX�u�f����r�C�U��d�三���B�N~�G���K�68���8@��I� ㇤��ŅL�.r[I�\M)�iD�m>�� g"#qIl] (|���f��+і2�"�փ2���!�b	��.Km<��ޗ�9��ѷ�
IV�1��03_��s���H�1�,JyŽ��۲�v�˼��-v������	��'Ps���W'�8І��G�6��W\�)�yw@�$.FtO�!��7)i: |J��o9��U�ʁ�B���G=�	�Z���G˱��6�=�+>����ȵ�� A;����~�mY�p�-4c=�Z���:�E7RT���zR�L�x�=.��xa��[�;G�h,�������rw�Q �l]�%6�-���M�(Pl9��U`�TW�tQдB�G,�ǧV���Y��u�r�<�amI�'M�6"{o7�_3)�Ř-���Q�����]������Ż���w�A=������>T%�0��E���b"� ��-8	��̰�O��m����*��Z߇������i��&����Fby�	`�d&D^?�0�Ga��e�����n���ͬ����pw��ݩk�]M_�D���9Ƣ��v	���Oyޖy�]6wi* �&YA@R×�a�����2c�ڌ1g�i�E�	H��Ā�B ��1C�l6zB�d#�Z&�(��9��"��9 �&|��g�}���I>�0	��w\PqiI�m�f�7>�B\�G��y�� �)�~)�{_&�����s��ؓ����#�	��HԱ:�y�˺��8ڗ��B[Ls���.���a�M�Z�� �|�2�`�c[4�clK��ON��쏧�-��s	�d��.*���l�@L�hcC�j&B��i�e�E;�4۪�e;Z�����m#�g�I ��&rp��B,���o��?�0�HN�/2�W�9Ӗ\�0�x�;Јk`��Q���|!��LO�<ˋ�Z�_QZ�6uI�ZĠ�t�  ���������3.}ZV��9��{+�|�e��Bvܝ���6��r�lcFQ����rPеG�]���N��W�����͸K��q�^=�q�Cv]�5��GtV��IJ�~�Є����a?A�s.�[���������+����MO%1�\р��0d$9H�ear1�s��$#%\�A��#��J��A�e�Jt��ay�ͬ�gzUd���������N2H#����14i
!]�,����L*��p^�+�r�T~Vn�?�+��Ї����v�p�>�i׫lU:�v_���?
[�,�r��(J�CW�D����ƍ�i/���S�p�=���_�=XG�������ZS�"�/�~��,�_P��I�����M�9_z/t�̿����o_,w��de��Jбv﯊�m���	�6VC8�ͼMG�b?6uz.�A��lR"�I��xL�N������g6#�|��۞Z�������Չp�V�)m�l��0ц��N�7R���0�_ ��1����1%��å[�(��j���#N|Tŀ6pWi����W�U�Ӓ�<lXp��dI����py�tm�hU|������� ���+`a?T��������j�o�HG(y@��ܚ�"��n�e��Tɿ�Ǔr�n@����D�1G?Ze�R����TW��M����E�Ħ���j �h6>�y�9�S�j��j��}�[�E�_�C,凐��`���{%(g(^s����@��A}@�RuP���
```

### /Users/sand/GitHub/mono/ws/src/assets/information-svgrepo-com.svg
```svg
<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg height="800px" width="800px" version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
	 viewBox="0 0 512 512"  xml:space="preserve">
<style type="text/css">
	.st0{fill:#000000;}
</style>
<g>
	<path class="st0" d="M256.732,145.122c40.064,0,72.557-32.492,72.557-72.557C329.289,32.476,296.796,0,256.732,0
		c-40.073,0-72.565,32.476-72.565,72.565C184.167,112.629,216.659,145.122,256.732,145.122z"/>
	<path class="st0" d="M345.668,453.857h-9.864c-10.091,0-18.282-8.182-18.282-18.282V188.209c0-3.356-1.754-6.476-4.639-8.214
		c-2.86-1.739-6.435-1.82-9.401-0.26l-124.678,69.291c-36.279,18.135-18.875,39.796-5.363,39.252
		c13.504-0.56,53.731-4.517,53.731-4.517v151.816c0,10.1-8.19,18.282-18.281,18.282h-19.362c-5.045,0-9.14,4.095-9.14,9.14v39.87
		c0,5.038,4.095,9.133,9.14,9.133h156.139c5.046,0,9.141-4.095,9.141-9.133v-39.87C354.81,457.952,350.714,453.857,345.668,453.857z
		"/>
</g>
</svg>```

### /Users/sand/GitHub/mono/ws/src/assets/construction-equipment-hammer-tool-repair-tools-svgrepo-com.svg
```svg
<?xml version="1.0" ?>
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg">
<g id="layer1">
<path d="M 11.638672 0.89257812 C 9.6968368 0.80815061 8.1796875 2.1152344 8.1796875 2.1152344 A 0.50005 0.50005 0 0 0 8.6210938 2.984375 C 8.6210938 2.984375 10.342903 2.5499342 11.646484 3.8535156 C 11.719708 3.9267389 11.875 4.3333333 11.875 4.75 C 11.875 5.1666667 11.719708 5.5732611 11.646484 5.6464844 L 8.734375 8.5585938 L 8.7324219 8.5585938 A 0.50005 0.50005 0 0 0 8.4921875 8.5 A 0.50005 0.50005 0 0 0 8.1464844 8.6464844 L 0.14648438 16.646484 A 0.50005 0.50005 0 0 0 0.14648438 17.353516 L 2.1464844 19.353516 A 0.50005 0.50005 0 0 0 2.8535156 19.353516 L 10.853516 11.353516 A 0.50005 0.50005 0 0 0 10.941406 10.765625 L 14.75 6.9570312 L 15.292969 7.5 L 15.146484 7.6464844 A 0.50005 0.50005 0 0 0 15.146484 8.3535156 L 16.646484 9.8535156 A 0.50005 0.50005 0 0 0 17.353516 9.8535156 L 19.853516 7.3535156 A 0.50005 0.50005 0 0 0 19.853516 6.6464844 L 18.353516 5.1464844 A 0.50005 0.50005 0 0 0 17.646484 5.1464844 L 17.5 5.2929688 L 16.941406 4.734375 L 16.941406 4.7324219 A 0.50005 0.50005 0 0 0 16.853516 4.1464844 L 15.353516 2.6464844 A 0.50005 0.50005 0 0 0 14.765625 2.5585938 L 14.353516 2.1464844 C 13.49128 1.2842485 12.521207 0.93094933 11.638672 0.89257812 z M 11.595703 1.8925781 C 12.257356 1.9213461 12.94622 2.1532515 13.646484 2.8535156 L 14.396484 3.6035156 A 0.50005 0.50005 0 0 0 14.984375 3.6914062 L 15.808594 4.515625 A 0.50005 0.50005 0 0 0 15.808594 4.5175781 A 0.50005 0.50005 0 0 0 15.896484 5.1035156 L 17.146484 6.3535156 A 0.50005 0.50005 0 0 0 17.853516 6.3535156 L 18 6.2070312 L 18.792969 7 L 17 8.7929688 L 16.207031 8 L 16.353516 7.8535156 A 0.50005 0.50005 0 0 0 16.353516 7.1464844 L 15.103516 5.8964844 A 0.50005 0.50005 0 0 0 14.396484 5.8964844 L 10.25 10.042969 L 9.4570312 9.25 L 12.353516 6.3535156 C 12.780292 5.9267389 12.875 5.3333333 12.875 4.75 C 12.875 4.1666667 12.780292 3.5732611 12.353516 3.1464844 C 11.779442 2.5724108 11.159019 2.310211 10.5625 2.1445312 C 10.909394 2.0432192 11.206918 1.8756745 11.595703 1.8925781 z M 8.5 9.7070312 L 9.7929688 11 L 2.5 18.292969 L 1.2070312 17 L 8.5 9.7070312 z " style="fill:#222222; fill-opacity:1; stroke:none; stroke-width:0px;"/>
</g>
</svg>```

### /Users/sand/GitHub/mono/ws/src/assets/svelte.svg
```svg
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="26.6" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 308"><path fill="#FF3E00" d="M239.682 40.707C211.113-.182 154.69-12.301 113.895 13.69L42.247 59.356a82.198 82.198 0 0 0-37.135 55.056a86.566 86.566 0 0 0 8.536 55.576a82.425 82.425 0 0 0-12.296 30.719a87.596 87.596 0 0 0 14.964 66.244c28.574 40.893 84.997 53.007 125.787 27.016l71.648-45.664a82.182 82.182 0 0 0 37.135-55.057a86.601 86.601 0 0 0-8.53-55.577a82.409 82.409 0 0 0 12.29-30.718a87.573 87.573 0 0 0-14.963-66.244"></path><path fill="#FFF" d="M106.889 270.841c-23.102 6.007-47.497-3.036-61.103-22.648a52.685 52.685 0 0 1-9.003-39.85a49.978 49.978 0 0 1 1.713-6.693l1.35-4.115l3.671 2.697a92.447 92.447 0 0 0 28.036 14.007l2.663.808l-.245 2.659a16.067 16.067 0 0 0 2.89 10.656a17.143 17.143 0 0 0 18.397 6.828a15.786 15.786 0 0 0 4.403-1.935l71.67-45.672a14.922 14.922 0 0 0 6.734-9.977a15.923 15.923 0 0 0-2.713-12.011a17.156 17.156 0 0 0-18.404-6.832a15.78 15.78 0 0 0-4.396 1.933l-27.35 17.434a52.298 52.298 0 0 1-14.553 6.391c-23.101 6.007-47.497-3.036-61.101-22.649a52.681 52.681 0 0 1-9.004-39.849a49.428 49.428 0 0 1 22.34-33.114l71.664-45.677a52.218 52.218 0 0 1 14.563-6.398c23.101-6.007 47.497 3.036 61.101 22.648a52.685 52.685 0 0 1 9.004 39.85a50.559 50.559 0 0 1-1.713 6.692l-1.35 4.116l-3.67-2.693a92.373 92.373 0 0 0-28.037-14.013l-2.664-.809l.246-2.658a16.099 16.099 0 0 0-2.89-10.656a17.143 17.143 0 0 0-18.398-6.828a15.786 15.786 0 0 0-4.402 1.935l-71.67 45.674a14.898 14.898 0 0 0-6.73 9.975a15.9 15.9 0 0 0 2.709 12.012a17.156 17.156 0 0 0 18.404 6.832a15.841 15.841 0 0 0 4.402-1.935l27.345-17.427a52.147 52.147 0 0 1 14.552-6.397c23.101-6.006 47.497 3.037 61.102 22.65a52.681 52.681 0 0 1 9.003 39.848a49.453 49.453 0 0 1-22.34 33.12l-71.664 45.673a52.218 52.218 0 0 1-14.563 6.398"></path></svg>```

### /Users/sand/GitHub/mono/ws/src/assets/clock-activity-svgrepo-com.svg
```svg
<?xml version="1.0" encoding="utf-8"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M4 12C4 7.58172 7.58172 4 12 4C12.5523 4 13 3.55228 13 3C13 2.44772 12.5523 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C14.7611 22 17.2625 20.8796 19.0711 19.0711C19.4616 18.6805 19.4616 18.0474 19.0711 17.6569C18.6805 17.2663 18.0474 17.2663 17.6569 17.6569C16.208 19.1057 14.2094 20 12 20C7.58172 20 4 16.4183 4 12ZM13 6C13 5.44772 12.5523 5 12 5C11.4477 5 11 5.44772 11 6V12C11 12.2652 11.1054 12.5196 11.2929 12.7071L14.2929 15.7071C14.6834 16.0976 15.3166 16.0976 15.7071 15.7071C16.0976 15.3166 16.0976 14.6834 15.7071 14.2929L13 11.5858V6ZM21.7483 15.1674C21.535 15.824 20.8298 16.1833 20.1732 15.97C19.5167 15.7566 19.1574 15.0514 19.3707 14.3949C19.584 13.7383 20.2892 13.379 20.9458 13.5923C21.6023 13.8057 21.9617 14.5108 21.7483 15.1674ZM21.0847 11.8267C21.7666 11.7187 22.2318 11.0784 22.1238 10.3966C22.0158 9.71471 21.3755 9.2495 20.6937 9.3575C20.0118 9.46549 19.5466 10.1058 19.6546 10.7877C19.7626 11.4695 20.4029 11.9347 21.0847 11.8267ZM20.2924 5.97522C20.6982 6.53373 20.5744 7.31544 20.0159 7.72122C19.4574 8.127 18.6757 8.00319 18.2699 7.44468C17.8641 6.88617 17.9879 6.10446 18.5464 5.69868C19.1049 5.2929 19.8867 5.41671 20.2924 5.97522ZM17.1997 4.54844C17.5131 3.93333 17.2685 3.18061 16.6534 2.86719C16.0383 2.55378 15.2856 2.79835 14.9722 3.41346C14.6588 4.02858 14.9033 4.78129 15.5185 5.09471C16.1336 5.40812 16.8863 5.16355 17.1997 4.54844Z" fill="#000000"/>
</svg>```

### /Users/sand/GitHub/mono/ws/src/assets/cloud-progress-svgrepo-com.svg
```svg
<?xml version="1.0" encoding="utf-8"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.76705 15.7528C7.18092 15.7358 7.50264 15.3865 7.48564 14.9726C7.46864 14.5587 7.11935 14.237 6.70549 14.254L6.76705 15.7528ZM3.89999 12.3364L3.15034 12.3135C3.14976 12.3325 3.14991 12.3515 3.15077 12.3705L3.89999 12.3364ZM6.02842 9.75339L6.18021 10.4879C6.52855 10.4159 6.77842 10.1091 6.77842 9.75339H6.02842ZM6.02842 9.66939L5.27921 9.63497C5.27868 9.64643 5.27842 9.65791 5.27842 9.66939L6.02842 9.66939ZM8.86372 7.00339L8.8332 7.75277C8.84385 7.7532 8.85452 7.75341 8.86519 7.75339L8.86372 7.00339ZM9.90404 7.18839L9.64447 7.89204C10.0028 8.02422 10.4032 7.86604 10.5744 7.52468L9.90404 7.18839ZM13.4725 5.00339L13.4578 5.75324C13.4734 5.75355 13.489 5.75337 13.5045 5.75271L13.4725 5.00339ZM17.3725 8.67039L18.1225 8.66975C18.1225 8.65895 18.1223 8.64814 18.1218 8.63735L17.3725 8.67039ZM17.2107 9.72039L16.4958 9.49367C16.4293 9.70328 16.4582 9.93151 16.5747 10.118C16.6913 10.3044 16.8839 10.4303 17.1014 10.4624L17.2107 9.72039ZM19.5 12.3364L20.2492 12.3705C20.2501 12.3507 20.2502 12.3308 20.2496 12.311L19.5 12.3364ZM16.6945 14.254C16.2806 14.237 15.9314 14.5587 15.9144 14.9726C15.8973 15.3865 16.2191 15.7358 16.6329 15.7528L16.6945 14.254ZM12.237 17.527C12.5262 17.2304 12.5201 16.7556 12.2236 16.4664C11.927 16.1773 11.4522 16.1833 11.163 16.4798L12.237 17.527ZM9.21299 18.4798C8.92383 18.7764 8.92984 19.2513 9.22642 19.5404C9.523 19.8296 9.99783 19.8236 10.287 19.527L9.21299 18.4798ZM8.99999 19.0034C8.99999 19.4176 9.33578 19.7534 9.74999 19.7534C10.1642 19.7534 10.5 19.4176 10.5 19.0034H8.99999ZM10.5 11.0034C10.5 10.5892 10.1642 10.2534 9.74999 10.2534C9.33578 10.2534 8.99999 10.5892 8.99999 11.0034H10.5ZM9.21299 19.527C9.50216 19.8236 9.97699 19.8296 10.2736 19.5404C10.5701 19.2513 10.5762 18.7764 10.287 18.4798L9.21299 19.527ZM8.33699 16.4798C8.04783 16.1833 7.573 16.1773 7.27642 16.4664C6.97984 16.7556 6.97383 17.2304 7.26299 17.527L8.33699 16.4798ZM11.163 12.4798C10.8738 12.7764 10.8798 13.2513 11.1764 13.5404C11.473 13.8296 11.9478 13.8236 12.237 13.527L11.163 12.4798ZM14.187 11.527C14.4762 11.2304 14.4701 10.7556 14.1736 10.4664C13.877 10.1773 13.4022 10.1833 13.113 10.4798L14.187 11.527ZM14.4 11.0034C14.4 10.5892 14.0642 10.2534 13.65 10.2534C13.2358 10.2534 12.9 10.5892 12.9 11.0034H14.4ZM12.9 19.0034C12.9 19.4176 13.2358 19.7534 13.65 19.7534C14.0642 19.7534 14.4 19.4176 14.4 19.0034H12.9ZM14.187 10.4798C13.8978 10.1833 13.423 10.1773 13.1264 10.4664C12.8298 10.7556 12.8238 11.2304 13.113 11.527L14.187 10.4798ZM15.063 13.527C15.3522 13.8236 15.827 13.8296 16.1236 13.5404C16.4201 13.2513 16.4262 12.7764 16.137 12.4798L15.063 13.527ZM6.70549 14.254C5.63621 14.2979 4.7013 13.445 4.64922 12.3022L3.15077 12.3705C3.23884 14.3026 4.8375 15.832 6.76705 15.7528L6.70549 14.254ZM4.64964 12.3593C4.67806 11.4306 5.32385 10.6648 6.18021 10.4879L5.87663 9.01891C4.31664 9.3413 3.19924 10.7153 3.15034 12.3135L4.64964 12.3593ZM6.77842 9.75339C6.77842 9.75334 6.77842 9.75328 6.77842 9.75323C6.77842 9.75317 6.77842 9.75312 6.77842 9.75306C6.77842 9.75301 6.77842 9.75295 6.77842 9.7529C6.77842 9.75284 6.77842 9.75279 6.77842 9.75273C6.77842 9.75268 6.77842 9.75262 6.77842 9.75257C6.77842 9.75252 6.77842 9.75246 6.77842 9.75241C6.77842 9.75235 6.77842 9.7523 6.77842 9.75224C6.77842 9.75219 6.77842 9.75213 6.77842 9.75208C6.77842 9.75202 6.77842 9.75197 6.77842 9.75191C6.77842 9.75186 6.77842 9.7518 6.77842 9.75175C6.77842 9.75169 6.77842 9.75164 6.77842 9.75159C6.77842 9.75153 6.77842 9.75148 6.77842 9.75142C6.77842 9.75137 6.77842 9.75131 6.77842 9.75126C6.77842 9.7512 6.77842 9.75115 6.77842 9.75109C6.77842 9.75104 6.77842 9.75098 6.77842 9.75093C6.77842 9.75087 6.77842 9.75082 6.77842 9.75077C6.77842 9.75071 6.77842 9.75066 6.77842 9.7506C6.77842 9.75055 6.77842 9.75049 6.77842 9.75044C6.77842 9.75038 6.77842 9.75033 6.77842 9.75027C6.77842 9.75022 6.77842 9.75016 6.77842 9.75011C6.77842 9.75005 6.77842 9.75 6.77842 9.74994C6.77842 9.74989 6.77842 9.74984 6.77842 9.74978C6.77842 9.74973 6.77842 9.74967 6.77842 9.74962C6.77842 9.74956 6.77842 9.74951 6.77842 9.74945C6.77842 9.7494 6.77842 9.74934 6.77842 9.74929C6.77842 9.74923 6.77842 9.74918 6.77842 9.74912C6.77842 9.74907 6.77842 9.74902 6.77842 9.74896C6.77842 9.74891 6.77842 9.74885 6.77842 9.7488C6.77842 9.74874 6.77842 9.74869 6.77842 9.74863C6.77842 9.74858 6.77842 9.74852 6.77842 9.74847C6.77842 9.74841 6.77842 9.74836 6.77842 9.7483C6.77842 9.74825 6.77842 9.74819 6.77842 9.74814C6.77842 9.74809 6.77842 9.74803 6.77842 9.74798C6.77842 9.74792 6.77842 9.74787 6.77842 9.74781C6.77842 9.74776 6.77842 9.7477 6.77842 9.74765C6.77842 9.74759 6.77842 9.74754 6.77842 9.74748C6.77842 9.74743 6.77842 9.74737 6.77842 9.74732C6.77842 9.74727 6.77842 9.74721 6.77842 9.74716C6.77842 9.7471 6.77842 9.74705 6.77842 9.74699C6.77842 9.74694 6.77842 9.74688 6.77842 9.74683C6.77842 9.74677 6.77842 9.74672 6.77842 9.74666C6.77842 9.74661 6.77842 9.74655 6.77842 9.7465C6.77842 9.74644 6.77842 9.74639 6.77842 9.74634C6.77842 9.74628 6.77842 9.74623 6.77842 9.74617C6.77842 9.74612 6.77842 9.74606 6.77842 9.74601C6.77842 9.74595 6.77842 9.7459 6.77842 9.74584C6.77842 9.74579 6.77842 9.74573 6.77842 9.74568C6.77842 9.74562 6.77842 9.74557 6.77842 9.74552C6.77842 9.74546 6.77842 9.74541 6.77842 9.74535C6.77842 9.7453 6.77842 9.74524 6.77842 9.74519C6.77842 9.74513 6.77842 9.74508 6.77842 9.74502C6.77842 9.74497 6.77842 9.74491 6.77842 9.74486C6.77842 9.7448 6.77842 9.74475 6.77842 9.74469C6.77842 9.74464 6.77842 9.74459 6.77842 9.74453C6.77842 9.74448 6.77842 9.74442 6.77842 9.74437C6.77842 9.74431 6.77842 9.74426 6.77842 9.7442C6.77842 9.74415 6.77842 9.74409 6.77842 9.74404C6.77842 9.74398 6.77842 9.74393 6.77842 9.74387C6.77842 9.74382 6.77842 9.74377 6.77842 9.74371C6.77842 9.74366 6.77842 9.7436 6.77842 9.74355C6.77842 9.74349 6.77842 9.74344 6.77842 9.74338C6.77842 9.74333 6.77842 9.74327 6.77842 9.74322C6.77842 9.74316 6.77842 9.74311 6.77842 9.74305C6.77842 9.743 6.77842 9.74294 6.77842 9.74289C6.77842 9.74284 6.77842 9.74278 6.77842 9.74273C6.77842 9.74267 6.77842 9.74262 6.77842 9.74256C6.77842 9.74251 6.77842 9.74245 6.77842 9.7424C6.77842 9.74234 6.77842 9.74229 6.77842 9.74223C6.77842 9.74218 6.77842 9.74212 6.77842 9.74207C6.77842 9.74202 6.77842 9.74196 6.77842 9.74191C6.77842 9.74185 6.77842 9.7418 6.77842 9.74174C6.77842 9.74169 6.77842 9.74163 6.77842 9.74158C6.77842 9.74152 6.77842 9.74147 6.77842 9.74141C6.77842 9.74136 6.77842 9.7413 6.77842 9.74125C6.77842 9.74119 6.77842 9.74114 6.77842 9.74109C6.77842 9.74103 6.77842 9.74098 6.77842 9.74092C6.77842 9.74087 6.77842 9.74081 6.77842 9.74076C6.77842 9.7407 6.77842 9.74065 6.77842 9.74059C6.77842 9.74054 6.77842 9.74048 6.77842 9.74043C6.77842 9.74037 6.77842 9.74032 6.77842 9.74027C6.77842 9.74021 6.77842 9.74016 6.77842 9.7401C6.77842 9.74005 6.77842 9.73999 6.77842 9.73994C6.77842 9.73988 6.77842 9.73983 6.77842 9.73977C6.77842 9.73972 6.77842 9.73966 6.77842 9.73961C6.77842 9.73955 6.77842 9.7395 6.77842 9.73944C6.77842 9.73939 6.77842 9.73934 6.77842 9.73928C6.77842 9.73923 6.77842 9.73917 6.77842 9.73912C6.77842 9.73906 6.77842 9.73901 6.77842 9.73895C6.77842 9.7389 6.77842 9.73884 6.77842 9.73879C6.77842 9.73873 6.77842 9.73868 6.77842 9.73862C6.77842 9.73857 6.77842 9.73852 6.77842 9.73846C6.77842 9.73841 6.77842 9.73835 6.77842 9.7383C6.77842 9.73824 6.77842 9.73819 6.77842 9.73813C6.77842 9.73808 6.77842 9.73802 6.77842 9.73797C6.77842 9.73791 6.77842 9.73786 6.77842 9.7378C6.77842 9.73775 6.77842 9.73769 6.77842 9.73764C6.77842 9.73759 6.77842 9.73753 6.77842 9.73748C6.77842 9.73742 6.77842 9.73737 6.77842 9.73731C6.77842 9.73726 6.77842 9.7372 6.77842 9.73715C6.77842 9.73709 6.77842 9.73704 6.77842 9.73698C6.77842 9.73693 6.77842 9.73687 6.77842 9.73682C6.77842 9.73677 6.77842 9.73671 6.77842 9.73666C6.77842 9.7366 6.77842 9.73655 6.77842 9.73649C6.77842 9.73644 6.77842 9.73638 6.77842 9.73633C6.77842 9.73627 6.77842 9.73622 6.77842 9.73616C6.77842 9.73611 6.77842 9.73605 6.77842 9.736C6.77842 9.73594 6.77842 9.73589 6.77842 9.73584C6.77842 9.73578 6.77842 9.73573 6.77842 9.73567C6.77842 9.73562 6.77842 9.73556 6.77842 9.73551C6.77842 9.73545 6.77842 9.7354 6.77842 9.73534C6.77842 9.73529 6.77842 9.73523 6.77842 9.73518C6.77842 9.73512 6.77842 9.73507 6.77842 9.73502C6.77842 9.73496 6.77842 9.73491 6.77842 9.73485C6.77842 9.7348 6.77842 9.73474 6.77842 9.73469C6.77842 9.73463 6.77842 9.73458 6.77842 9.73452C6.77842 9.73447 6.77842 9.73441 6.77842 9.73436C6.77842 9.7343 6.77842 9.73425 6.77842 9.73419C6.77842 9.73414 6.77842 9.73409 6.77842 9.73403C6.77842 9.73398 6.77842 9.73392 6.77842 9.73387C6.77842 9.73381 6.77842 9.73376 6.77842 9.7337C6.77842 9.73365 6.77842 9.73359 6.77842 9.73354C6.77842 9.73348 6.77842 9.73343 6.77842 9.73337C6.77842 9.73332 6.77842 9.73327 6.77842 9.73321C6.77842 9.73316 6.77842 9.7331 6.77842 9.73305C6.77842 9.73299 6.77842 9.73294 6.77842 9.73288C6.77842 9.73283 6.77842 9.73277 6.77842 9.73272C6.77842 9.73266 6.77842 9.73261 6.77842 9.73255C6.77842 9.7325 6.77842 9.73244 6.77842 9.73239C6.77842 9.73234 6.77842 9.73228 6.77842 9.73223C6.77842 9.73217 6.77842 9.73212 6.77842 9.73206C6.77842 9.73201 6.77842 9.73195 6.77842 9.7319C6.77842 9.73184 6.77842 9.73179 6.77842 9.73173C6.77842 9.73168 6.77842 9.73162 6.77842 9.73157C6.77842 9.73152 6.77842 9.73146 6.77842 9.73141C6.77842 9.73135 6.77842 9.7313 6.77842 9.73124C6.77842 9.73119 6.77842 9.73113 6.77842 9.73108C6.77842 9.73102 6.77842 9.73097 6.77842 9.73091C6.77842 9.73086 6.77842 9.7308 6.77842 9.73075C6.77842 9.73069 6.77842 9.73064 6.77842 9.73059C6.77842 9.73053 6.77842 9.73048 6.77842 9.73042C6.77842 9.73037 6.77842 9.73031 6.77842 9.73026C6.77842 9.7302 6.77842 9.73015 6.77842 9.73009C6.77842 9.73004 6.77842 9.72998 6.77842 9.72993C6.77842 9.72987 6.77842 9.72982 6.77842 9.72977C6.77842 9.72971 6.77842 9.72966 6.77842 9.7296C6.77842 9.72955 6.77842 9.72949 6.77842 9.72944C6.77842 9.72938 6.77842 9.72933 6.77842 9.72927C6.77842 9.72922 6.77842 9.72916 6.77842 9.72911C6.77842 9.72905 6.77842 9.729 6.77842 9.72894C6.77842 9.72889 6.77842 9.72884 6.77842 9.72878C6.77842 9.72873 6.77842 9.72867 6.77842 9.72862C6.77842 9.72856 6.77842 9.72851 6.77842 9.72845C6.77842 9.7284 6.77842 9.72834 6.77842 9.72829C6.77842 9.72823 6.77842 9.72818 6.77842 9.72812C6.77842 9.72807 6.77842 9.72802 6.77842 9.72796C6.77842 9.72791 6.77842 9.72785 6.77842 9.7278C6.77842 9.72774 6.77842 9.72769 6.77842 9.72763C6.77842 9.72758 6.77842 9.72752 6.77842 9.72747C6.77842 9.72741 6.77842 9.72736 6.77842 9.7273C6.77842 9.72725 6.77842 9.72719 6.77842 9.72714C6.77842 9.72709 6.77842 9.72703 6.77842 9.72698C6.77842 9.72692 6.77842 9.72687 6.77842 9.72681C6.77842 9.72676 6.77842 9.7267 6.77842 9.72665C6.77842 9.72659 6.77842 9.72654 6.77842 9.72648C6.77842 9.72643 6.77842 9.72637 6.77842 9.72632C6.77842 9.72627 6.77842 9.72621 6.77842 9.72616C6.77842 9.7261 6.77842 9.72605 6.77842 9.72599C6.77842 9.72594 6.77842 9.72588 6.77842 9.72583C6.77842 9.72577 6.77842 9.72572 6.77842 9.72566C6.77842 9.72561 6.77842 9.72555 6.77842 9.7255C6.77842 9.72544 6.77842 9.72539 6.77842 9.72534C6.77842 9.72528 6.77842 9.72523 6.77842 9.72517C6.77842 9.72512 6.77842 9.72506 6.77842 9.72501C6.77842 9.72495 6.77842 9.7249 6.77842 9.72484C6.77842 9.72479 6.77842 9.72473 6.77842 9.72468C6.77842 9.72462 6.77842 9.72457 6.77842 9.72452C6.77842 9.72446 6.77842 9.72441 6.77842 9.72435C6.77842 9.7243 6.77842 9.72424 6.77842 9.72419C6.77842 9.72413 6.77842 9.72408 6.77842 9.72402C6.77842 9.72397 6.77842 9.72391 6.77842 9.72386C6.77842 9.7238 6.77842 9.72375 6.77842 9.72369C6.77842 9.72364 6.77842 9.72359 6.77842 9.72353C6.77842 9.72348 6.77842 9.72342 6.77842 9.72337C6.77842 9.72331 6.77842 9.72326 6.77842 9.7232C6.77842 9.72315 6.77842 9.72309 6.77842 9.72304C6.77842 9.72298 6.77842 9.72293 6.77842 9.72287C6.77842 9.72282 6.77842 9.72277 6.77842 9.72271C6.77842 9.72266 6.77842 9.7226 6.77842 9.72255C6.77842 9.72249 6.77842 9.72244 6.77842 9.72238C6.77842 9.72233 6.77842 9.72227 6.77842 9.72222C6.77842 9.72216 6.77842 9.72211 6.77842 9.72205C6.77842 9.722 6.77842 9.72194 6.77842 9.72189C6.77842 9.72184 6.77842 9.72178 6.77842 9.72173C6.77842 9.72167 6.77842 9.72162 6.77842 9.72156C6.77842 9.72151 6.77842 9.72145 6.77842 9.7214C6.77842 9.72134 6.77842 9.72129 6.77842 9.72123C6.77842 9.72118 6.77842 9.72112 6.77842 9.72107C6.77842 9.72102 6.77842 9.72096 6.77842 9.72091C6.77842 9.72085 6.77842 9.7208 6.77842 9.72074C6.77842 9.72069 6.77842 9.72063 6.77842 9.72058C6.77842 9.72052 6.77842 9.72047 6.77842 9.72041C6.77842 9.72036 6.77842 9.7203 6.77842 9.72025C6.77842 9.72019 6.77842 9.72014 6.77842 9.72009C6.77842 9.72003 6.77842 9.71998 6.77842 9.71992C6.77842 9.71987 6.77842 9.71981 6.77842 9.71976C6.77842 9.7197 6.77842 9.71965 6.77842 9.71959C6.77842 9.71954 6.77842 9.71948 6.77842 9.71943C6.77842 9.71937 6.77842 9.71932 6.77842 9.71927C6.77842 9.71921 6.77842 9.71916 6.77842 9.7191C6.77842 9.71905 6.77842 9.71899 6.77842 9.71894C6.77842 9.71888 6.77842 9.71883 6.77842 9.71877C6.77842 9.71872 6.77842 9.71866 6.77842 9.71861C6.77842 9.71855 6.77842 9.7185 6.77842 9.71844C6.77842 9.71839 6.77842 9.71834 6.77842 9.71828C6.77842 9.71823 6.77842 9.71817 6.77842 9.71812C6.77842 9.71806 6.77842 9.71801 6.77842 9.71795C6.77842 9.7179 6.77842 9.71784 6.77842 9.71779C6.77842 9.71773 6.77842 9.71768 6.77842 9.71762C6.77842 9.71757 6.77842 9.71752 6.77842 9.71746C6.77842 9.71741 6.77842 9.71735 6.77842 9.7173C6.77842 9.71724 6.77842 9.71719 6.77842 9.71713C6.77842 9.71708 6.77842 9.71702 6.77842 9.71697C6.77842 9.71691 6.77842 9.71686 6.77842 9.7168C6.77842 9.71675 6.77842 9.71669 6.77842 9.71664C6.77842 9.71659 6.77842 9.71653 6.77842 9.71648C6.77842 9.71642 6.77842 9.71637 6.77842 9.71631C6.77842 9.71626 6.77842 9.7162 6.77842 9.71615C6.77842 9.71609 6.77842 9.71604 6.77842 9.71598C6.77842 9.71593 6.77842 9.71587 6.77842 9.71582C6.77842 9.71577 6.77842 9.71571 6.77842 9.71566C6.77842 9.7156 6.77842 9.71555 6.77842 9.71549C6.77842 9.71544 6.77842 9.71538 6.77842 9.71533C6.77842 9.71527 6.77842 9.71522 6.77842 9.71516C6.77842 9.71511 6.77842 9.71505 6.77842 9.715C6.77842 9.71494 6.77842 9.71489 6.77842 9.71484C6.77842 9.71478 6.77842 9.71473 6.77842 9.71467C6.77842 9.71462 6.77842 9.71456 6.77842 9.71451C6.77842 9.71445 6.77842 9.7144 6.77842 9.71434C6.77842 9.71429 6.77842 9.71423 6.77842 9.71418C6.77842 9.71412 6.77842 9.71407 6.77842 9.71402C6.77842 9.71396 6.77842 9.71391 6.77842 9.71385C6.77842 9.7138 6.77842 9.71374 6.77842 9.71369C6.77842 9.71363 6.77842 9.71358 6.77842 9.71352C6.77842 9.71347 6.77842 9.71341 6.77842 9.71336C6.77842 9.7133 6.77842 9.71325 6.77842 9.71319C6.77842 9.71314 6.77842 9.71309 6.77842 9.71303C6.77842 9.71298 6.77842 9.71292 6.77842 9.71287C6.77842 9.71281 6.77842 9.71276 6.77842 9.7127C6.77842 9.71265 6.77842 9.71259 6.77842 9.71254C6.77842 9.71248 6.77842 9.71243 6.77842 9.71237C6.77842 9.71232 6.77842 9.71227 6.77842 9.71221C6.77842 9.71216 6.77842 9.7121 6.77842 9.71205C6.77842 9.71199 6.77842 9.71194 6.77842 9.71188C6.77842 9.71183 6.77842 9.71177 6.77842 9.71172C6.77842 9.71166 6.77842 9.71161 6.77842 9.71155C6.77842 9.7115 6.77842 9.71144 6.77842 9.71139C6.77842 9.71134 6.77842 9.71128 6.77842 9.71123C6.77842 9.71117 6.77842 9.71112 6.77842 9.71106C6.77842 9.71101 6.77842 9.71095 6.77842 9.7109C6.77842 9.71084 6.77842 9.71079 6.77842 9.71073C6.77842 9.71068 6.77842 9.71062 6.77842 9.71057C6.77842 9.71052 6.77842 9.71046 6.77842 9.71041C6.77842 9.71035 6.77842 9.7103 6.77842 9.71024C6.77842 9.71019 6.77842 9.71013 6.77842 9.71008C6.77842 9.71002 6.77842 9.70997 6.77842 9.70991C6.77842 9.70986 6.77842 9.7098 6.77842 9.70975C6.77842 9.70969 6.77842 9.70964 6.77842 9.70959C6.77842 9.70953 6.77842 9.70948 6.77842 9.70942C6.77842 9.70937 6.77842 9.70931 6.77842 9.70926C6.77842 9.7092 6.77842 9.70915 6.77842 9.70909C6.77842 9.70904 6.77842 9.70898 6.77842 9.70893C6.77842 9.70887 6.77842 9.70882 6.77842 9.70877C6.77842 9.70871 6.77842 9.70866 6.77842 9.7086C6.77842 9.70855 6.77842 9.70849 6.77842 9.70844C6.77842 9.70838 6.77842 9.70833 6.77842 9.70827C6.77842 9.70822 6.77842 9.70816 6.77842 9.70811C6.77842 9.70805 6.77842 9.708 6.77842 9.70794C6.77842 9.70789 6.77842 9.70784 6.77842 9.70778C6.77842 9.70773 6.77842 9.70767 6.77842 9.70762C6.77842 9.70756 6.77842 9.70751 6.77842 9.70745C6.77842 9.7074 6.77842 9.70734 6.77842 9.70729C6.77842 9.70723 6.77842 9.70718 6.77842 9.70712C6.77842 9.70707 6.77842 9.70702 6.77842 9.70696C6.77842 9.70691 6.77842 9.70685 6.77842 9.7068C6.77842 9.70674 6.77842 9.70669 6.77842 9.70663C6.77842 9.70658 6.77842 9.70652 6.77842 9.70647C6.77842 9.70641 6.77842 9.70636 6.77842 9.7063C6.77842 9.70625 6.77842 9.70619 6.77842 9.70614C6.77842 9.70609 6.77842 9.70603 6.77842 9.70598C6.77842 9.70592 6.77842 9.70587 6.77842 9.70581C6.77842 9.70576 6.77842 9.7057 6.77842 9.70565C6.77842 9.70559 6.77842 9.70554 6.77842 9.70548C6.77842 9.70543 6.77842 9.70537 6.77842 9.70532C6.77842 9.70527 6.77842 9.70521 6.77842 9.70516C6.77842 9.7051 6.77842 9.70505 6.77842 9.70499C6.77842 9.70494 6.77842 9.70488 6.77842 9.70483C6.77842 9.70477 6.77842 9.70472 6.77842 9.70466C6.77842 9.70461 6.77842 9.70455 6.77842 9.7045C6.77842 9.70444 6.77842 9.70439 6.77842 9.70434C6.77842 9.70428 6.77842 9.70423 6.77842 9.70417C6.77842 9.70412 6.77842 9.70406 6.77842 9.70401C6.77842 9.70395 6.77842 9.7039 6.77842 9.70384C6.77842 9.70379 6.77842 9.70373 6.77842 9.70368C6.77842 9.70362 6.77842 9.70357 6.77842 9.70352C6.77842 9.70346 6.77842 9.70341 6.77842 9.70335C6.77842 9.7033 6.77842 9.70324 6.77842 9.70319C6.77842 9.70313 6.77842 9.70308 6.77842 9.70302C6.77842 9.70297 6.77842 9.70291 6.77842 9.70286C6.77842 9.7028 6.77842 9.70275 6.77842 9.70269C6.77842 9.70264 6.77842 9.70259 6.77842 9.70253C6.77842 9.70248 6.77842 9.70242 6.77842 9.70237C6.77842 9.70231 6.77842 9.70226 6.77842 9.7022C6.77842 9.70215 6.77842 9.70209 6.77842 9.70204C6.77842 9.70198 6.77842 9.70193 6.77842 9.70187C6.77842 9.70182 6.77842 9.70177 6.77842 9.70171C6.77842 9.70166 6.77842 9.7016 6.77842 9.70155C6.77842 9.70149 6.77842 9.70144 6.77842 9.70138C6.77842 9.70133 6.77842 9.70127 6.77842 9.70122C6.77842 9.70116 6.77842 9.70111 6.77842 9.70105C6.77842 9.701 6.77842 9.70094 6.77842 9.70089C6.77842 9.70084 6.77842 9.70078 6.77842 9.70073C6.77842 9.70067 6.77842 9.70062 6.77842 9.70056C6.77842 9.70051 6.77842 9.70045 6.77842 9.7004C6.77842 9.70034 6.77842 9.70029 6.77842 9.70023C6.77842 9.70018 6.77842 9.70012 6.77842 9.70007C6.77842 9.70002 6.77842 9.69996 6.77842 9.69991C6.77842 9.69985 6.77842 9.6998 6.77842 9.69974C6.77842 9.69969 6.77842 9.69963 6.77842 9.69958C6.77842 9.69952 6.77842 9.69947 6.77842 9.69941C6.77842 9.69936 6.77842 9.6993 6.77842 9.69925C6.77842 9.69919 6.77842 9.69914 6.77842 9.69909C6.77842 9.69903 6.77842 9.69898 6.77842 9.69892C6.77842 9.69887 6.77842 9.69881 6.77842 9.69876C6.77842 9.6987 6.77842 9.69865 6.77842 9.69859C6.77842 9.69854 6.77842 9.69848 6.77842 9.69843C6.77842 9.69837 6.77842 9.69832 6.77842 9.69827C6.77842 9.69821 6.77842 9.69816 6.77842 9.6981C6.77842 9.69805 6.77842 9.69799 6.77842 9.69794C6.77842 9.69788 6.77842 9.69783 6.77842 9.69777C6.77842 9.69772 6.77842 9.69766 6.77842 9.69761C6.77842 9.69755 6.77842 9.6975 6.77842 9.69744C6.77842 9.69739 6.77842 9.69734 6.77842 9.69728C6.77842 9.69723 6.77842 9.69717 6.77842 9.69712C6.77842 9.69706 6.77842 9.69701 6.77842 9.69695C6.77842 9.6969 6.77842 9.69684 6.77842 9.69679C6.77842 9.69673 6.77842 9.69668 6.77842 9.69662C6.77842 9.69657 6.77842 9.69652 6.77842 9.69646C6.77842 9.69641 6.77842 9.69635 6.77842 9.6963C6.77842 9.69624 6.77842 9.69619 6.77842 9.69613C6.77842 9.69608 6.77842 9.69602 6.77842 9.69597C6.77842 9.69591 6.77842 9.69586 6.77842 9.6958C6.77842 9.69575 6.77842 9.69569 6.77842 9.69564C6.77842 9.69559 6.77842 9.69553 6.77842 9.69548C6.77842 9.69542 6.77842 9.69537 6.77842 9.69531C6.77842 9.69526 6.77842 9.6952 6.77842 9.69515C6.77842 9.69509 6.77842 9.69504 6.77842 9.69498C6.77842 9.69493 6.77842 9.69487 6.77842 9.69482C6.77842 9.69477 6.77842 9.69471 6.77842 9.69466C6.77842 9.6946 6.77842 9.69455 6.77842 9.69449C6.77842 9.69444 6.77842 9.69438 6.77842 9.69433C6.77842 9.69427 6.77842 9.69422 6.77842 9.69416C6.77842 9.69411 6.77842 9.69405 6.77842 9.694C6.77842 9.69394 6.77842 9.69389 6.77842 9.69384C6.77842 9.69378 6.77842 9.69373 6.77842 9.69367C6.77842 9.69362 6.77842 9.69356 6.77842 9.69351C6.77842 9.69345 6.77842 9.6934 6.77842 9.69334C6.77842 9.69329 6.77842 9.69323 6.77842 9.69318C6.77842 9.69312 6.77842 9.69307 6.77842 9.69302C6.77842 9.69296 6.77842 9.69291 6.77842 9.69285C6.77842 9.6928 6.77842 9.69274 6.77842 9.69269C6.77842 9.69263 6.77842 9.69258 6.77842 9.69252C6.77842 9.69247 6.77842 9.69241 6.77842 9.69236C6.77842 9.6923 6.77842 9.69225 6.77842 9.69219C6.77842 9.69214 6.77842 9.69209 6.77842 9.69203C6.77842 9.69198 6.77842 9.69192 6.77842 9.69187C6.77842 9.69181 6.77842 9.69176 6.77842 9.6917C6.77842 9.69165 6.77842 9.69159 6.77842 9.69154C6.77842 9.69148 6.77842 9.69143 6.77842 9.69137C6.77842 9.69132 6.77842 9.69127 6.77842 9.69121C6.77842 9.69116 6.77842 9.6911 6.77842 9.69105C6.77842 9.69099 6.77842 9.69094 6.77842 9.69088C6.77842 9.69083 6.77842 9.69077 6.77842 9.69072C6.77842 9.69066 6.77842 9.69061 6.77842 9.69055C6.77842 9.6905 6.77842 9.69044 6.77842 9.69039C6.77842 9.69034 6.77842 9.69028 6.77842 9.69023C6.77842 9.69017 6.77842 9.69012 6.77842 9.69006C6.77842 9.69001 6.77842 9.68995 6.77842 9.6899C6.77842 9.68984 6.77842 9.68979 6.77842 9.68973C6.77842 9.68968 6.77842 9.68962 6.77842 9.68957C6.77842 9.68952 6.77842 9.68946 6.77842 9.68941C6.77842 9.68935 6.77842 9.6893 6.77842 9.68924C6.77842 9.68919 6.77842 9.68913 6.77842 9.68908C6.77842 9.68902 6.77842 9.68897 6.77842 9.68891C6.77842 9.68886 6.77842 9.6888 6.77842 9.68875C6.77842 9.68869 6.77842 9.68864 6.77842 9.68859C6.77842 9.68853 6.77842 9.68848 6.77842 9.68842C6.77842 9.68837 6.77842 9.68831 6.77842 9.68826C6.77842 9.6882 6.77842 9.68815 6.77842 9.68809C6.77842 9.68804 6.77842 9.68798 6.77842 9.68793C6.77842 9.68787 6.77842 9.68782 6.77842 9.68777C6.77842 9.68771 6.77842 9.68766 6.77842 9.6876C6.77842 9.68755 6.77842 9.68749 6.77842 9.68744C6.77842 9.68738 6.77842 9.68733 6.77842 9.68727C6.77842 9.68722 6.77842 9.68716 6.77842 9.68711C6.77842 9.68705 6.77842 9.687 6.77842 9.68694C6.77842 9.68689 6.77842 9.68684 6.77842 9.68678C6.77842 9.68673 6.77842 9.68667 6.77842 9.68662C6.77842 9.68656 6.77842 9.68651 6.77842 9.68645C6.77842 9.6864 6.77842 9.68634 6.77842 9.68629C6.77842 9.68623 6.77842 9.68618 6.77842 9.68612C6.77842 9.68607 6.77842 9.68602 6.77842 9.68596C6.77842 9.68591 6.77842 9.68585 6.77842 9.6858C6.77842 9.68574 6.77842 9.68569 6.77842 9.68563C6.77842 9.68558 6.77842 9.68552 6.77842 9.68547C6.77842 9.68541 6.77842 9.68536 6.77842 9.6853C6.77842 9.68525 6.77842 9.68519 6.77842 9.68514C6.77842 9.68509 6.77842 9.68503 6.77842 9.68498C6.77842 9.68492 6.77842 9.68487 6.77842 9.68481C6.77842 9.68476 6.77842 9.6847 6.77842 9.68465C6.77842 9.68459 6.77842 9.68454 6.77842 9.68448C6.77842 9.68443 6.77842 9.68437 6.77842 9.68432C6.77842 9.68427 6.77842 9.68421 6.77842 9.68416C6.77842 9.6841 6.77842 9.68405 6.77842 9.68399C6.77842 9.68394 6.77842 9.68388 6.77842 9.68383C6.77842 9.68377 6.77842 9.68372 6.77842 9.68366C6.77842 9.68361 6.77842 9.68355 6.77842 9.6835C6.77842 9.68344 6.77842 9.68339 6.77842 9.68334C6.77842 9.68328 6.77842 9.68323 6.77842 9.68317C6.77842 9.68312 6.77842 9.68306 6.77842 9.68301C6.77842 9.68295 6.77842 9.6829 6.77842 9.68284C6.77842 9.68279 6.77842 9.68273 6.77842 9.68268C6.77842 9.68262 6.77842 9.68257 6.77842 9.68252C6.77842 9.68246 6.77842 9.68241 6.77842 9.68235C6.77842 9.6823 6.77842 9.68224 6.77842 9.68219C6.77842 9.68213 6.77842 9.68208 6.77842 9.68202C6.77842 9.68197 6.77842 9.68191 6.77842 9.68186C6.77842 9.6818 6.77842 9.68175 6.77842 9.68169C6.77842 9.68164 6.77842 9.68159 6.77842 9.68153C6.77842 9.68148 6.77842 9.68142 6.77842 9.68137C6.77842 9.68131 6.77842 9.68126 6.77842 9.6812C6.77842 9.68115 6.77842 9.68109 6.77842 9.68104C6.77842 9.68098 6.77842 9.68093 6.77842 9.68087C6.77842 9.68082 6.77842 9.68077 6.77842 9.68071C6.77842 9.68066 6.77842 9.6806 6.77842 9.68055C6.77842 9.68049 6.77842 9.68044 6.77842 9.68038C6.77842 9.68033 6.77842 9.68027 6.77842 9.68022C6.77842 9.68016 6.77842 9.68011 6.77842 9.68005C6.77842 9.68 6.77842 9.67994 6.77842 9.67989C6.77842 9.67984 6.77842 9.67978 6.77842 9.67973C6.77842 9.67967 6.77842 9.67962 6.77842 9.67956C6.77842 9.67951 6.77842 9.67945 6.77842 9.6794C6.77842 9.67934 6.77842 9.67929 6.77842 9.67923C6.77842 9.67918 6.77842 9.67912 6.77842 9.67907C6.77842 9.67902 6.77842 9.67896 6.77842 9.67891C6.77842 9.67885 6.77842 9.6788 6.77842 9.67874C6.77842 9.67869 6.77842 9.67863 6.77842 9.67858C6.77842 9.67852 6.77842 9.67847 6.77842 9.67841C6.77842 9.67836 6.77842 9.6783 6.77842 9.67825C6.77842 9.67819 6.77842 9.67814 6.77842 9.67809C6.77842 9.67803 6.77842 9.67798 6.77842 9.67792C6.77842 9.67787 6.77842 9.67781 6.77842 9.67776C6.77842 9.6777 6.77842 9.67765 6.77842 9.67759C6.77842 9.67754 6.77842 9.67748 6.77842 9.67743C6.77842 9.67737 6.77842 9.67732 6.77842 9.67727C6.77842 9.67721 6.77842 9.67716 6.77842 9.6771C6.77842 9.67705 6.77842 9.67699 6.77842 9.67694C6.77842 9.67688 6.77842 9.67683 6.77842 9.67677C6.77842 9.67672 6.77842 9.67666 6.77842 9.67661C6.77842 9.67655 6.77842 9.6765 6.77842 9.67644C6.77842 9.67639 6.77842 9.67634 6.77842 9.67628C6.77842 9.67623 6.77842 9.67617 6.77842 9.67612C6.77842 9.67606 6.77842 9.67601 6.77842 9.67595C6.77842 9.6759 6.77842 9.67584 6.77842 9.67579C6.77842 9.67573 6.77842 9.67568 6.77842 9.67562C6.77842 9.67557 6.77842 9.67552 6.77842 9.67546C6.77842 9.67541 6.77842 9.67535 6.77842 9.6753C6.77842 9.67524 6.77842 9.67519 6.77842 9.67513C6.77842 9.67508 6.77842 9.67502 6.77842 9.67497C6.77842 9.67491 6.77842 9.67486 6.77842 9.6748C6.77842 9.67475 6.77842 9.67469 6.77842 9.67464C6.77842 9.67459 6.77842 9.67453 6.77842 9.67448C6.77842 9.67442 6.77842 9.67437 6.77842 9.67431C6.77842 9.67426 6.77842 9.6742 6.77842 9.67415C6.77842 9.67409 6.77842 9.67404 6.77842 9.67398C6.77842 9.67393 6.77842 9.67387 6.77842 9.67382C6.77842 9.67377 6.77842 9.67371 6.77842 9.67366C6.77842 9.6736 6.77842 9.67355 6.77842 9.67349C6.77842 9.67344 6.77842 9.67338 6.77842 9.67333C6.77842 9.67327 6.77842 9.67322 6.77842 9.67316C6.77842 9.67311 6.77842 9.67305 6.77842 9.673C6.77842 9.67294 6.77842 9.67289 6.77842 9.67284C6.77842 9.67278 6.77842 9.67273 6.77842 9.67267C6.77842 9.67262 6.77842 9.67256 6.77842 9.67251C6.77842 9.67245 6.77842 9.6724 6.77842 9.67234C6.77842 9.67229 6.77842 9.67223 6.77842 9.67218C6.77842 9.67212 6.77842 9.67207 6.77842 9.67202C6.77842 9.67196 6.77842 9.67191 6.77842 9.67185C6.77842 9.6718 6.77842 9.67174 6.77842 9.67169C6.77842 9.67163 6.77842 9.67158 6.77842 9.67152C6.77842 9.67147 6.77842 9.67141 6.77842 9.67136C6.77842 9.6713 6.77842 9.67125 6.77842 9.67119C6.77842 9.67114 6.77842 9.67109 6.77842 9.67103C6.77842 9.67098 6.77842 9.67092 6.77842 9.67087C6.77842 9.67081 6.77842 9.67076 6.77842 9.6707C6.77842 9.67065 6.77842 9.67059 6.77842 9.67054C6.77842 9.67048 6.77842 9.67043 6.77842 9.67037C6.77842 9.67032 6.77842 9.67027 6.77842 9.67021C6.77842 9.67016 6.77842 9.6701 6.77842 9.67005C6.77842 9.66999 6.77842 9.66994 6.77842 9.66988C6.77842 9.66983 6.77842 9.66977 6.77842 9.66972C6.77842 9.66966 6.77842 9.66961 6.77842 9.66955C6.77842 9.6695 6.77842 9.66944 6.77842 9.66939H5.27842C5.27842 9.66944 5.27842 9.6695 5.27842 9.66955C5.27842 9.66961 5.27842 9.66966 5.27842 9.66972C5.27842 9.66977 5.27842 9.66983 5.27842 9.66988C5.27842 9.66994 5.27842 9.66999 5.27842 9.67005C5.27842 9.6701 5.27842 9.67016 5.27842 9.67021C5.27842 9.67027 5.27842 9.67032 5.27842 9.67037C5.27842 9.67043 5.27842 9.67048 5.27842 9.67054C5.27842 9.67059 5.27842 9.67065 5.27842 9.6707C5.27842 9.67076 5.27842 9.67081 5.27842 9.67087C5.27842 9.67092 5.27842 9.67098 5.27842 9.67103C5.27842 9.67109 5.27842 9.67114 5.27842 9.67119C5.27842 9.67125 5.27842 9.6713 5.27842 9.67136C5.27842 9.67141 5.27842 9.67147 5.27842 9.67152C5.27842 9.67158 5.27842 9.67163 5.27842 9.67169C5.27842 9.67174 5.27842 9.6718 5.27842 9.67185C5.27842 9.67191 5.27842 9.67196 5.27842 9.67202C5.27842 9.67207 5.27842 9.67212 5.27842 9.67218C5.27842 9.67223 5.27842 9.67229 5.27842 9.67234C5.27842 9.6724 5.27842 9.67245 5.27842 9.67251C5.27842 9.67256 5.27842 9.67262 5.27842 9.67267C5.27842 9.67273 5.27842 9.67278 5.27842 9.67284C5.27842 9.67289 5.27842 9.67294 5.27842 9.673C5.27842 9.67305 5.27842 9.67311 5.27842 9.67316C5.27842 9.67322 5.27842 9.67327 5.27842 9.67333C5.27842 9.67338 5.27842 9.67344 5.27842 9.67349C5.27842 9.67355 5.27842 9.6736 5.27842 9.67366C5.27842 9.67371 5.27842 9.67377 5.27842 9.67382C5.27842 9.67387 5.27842 9.67393 5.27842 9.67398C5.27842 9.67404 5.27842 9.67409 5.27842 9.67415C5.27842 9.6742 5.27842 9.67426 5.27842 9.67431C5.27842 9.67437 5.27842 9.67442 5.27842 9.67448C5.27842 9.67453 5.27842 9.67459 5.27842 9.67464C5.27842 9.67469 5.27842 9.67475 5.27842 9.6748C5.27842 9.67486 5.27842 9.67491 5.27842 9.67497C5.27842 9.67502 5.27842 9.67508 5.27842 9.67513C5.27842 9.67519 5.27842 9.67524 5.27842 9.6753C5.27842 9.67535 5.27842 9.67541 5.27842 9.67546C5.27842 9.67552 5.27842 9.67557 5.27842 9.67562C5.27842 9.67568 5.27842 9.67573 5.27842 9.67579C5.27842 9.67584 5.27842 9.6759 5.27842 9.67595C5.27842 9.67601 5.27842 9.67606 5.27842 9.67612C5.27842 9.67617 5.27842 9.67623 5.27842 9.67628C5.27842 9.67634 5.27842 9.67639 5.27842 9.67644C5.27842 9.6765 5.27842 9.67655 5.27842 9.67661C5.27842 9.67666 5.27842 9.67672 5.27842 9.67677C5.27842 9.67683 5.27842 9.67688 5.27842 9.67694C5.27842 9.67699 5.27842 9.67705 5.27842 9.6771C5.27842 9.67716 5.27842 9.67721 5.27842 9.67727C5.27842 9.67732 5.27842 9.67737 5.27842 9.67743C5.27842 9.67748 5.27842 9.67754 5.27842 9.67759C5.27842 9.67765 5.27842 9.6777 5.27842 9.67776C5.27842 9.67781 5.27842 9.67787 5.27842 9.67792C5.27842 9.67798 5.27842 9.67803 5.27842 9.67809C5.27842 9.67814 5.27842 9.67819 5.27842 9.67825C5.27842 9.6783 5.27842 9.67836 5.27842 9.67841C5.27842 9.67847 5.27842 9.67852 5.27842 9.67858C5.27842 9.67863 5.27842 9.67869 5.27842 9.67874C5.27842 9.6788 5.27842 9.67885 5.27842 9.67891C5.27842 9.67896 5.27842 9.67902 5.27842 9.67907C5.27842 9.67912 5.27842 9.67918 5.27842 9.67923C5.27842 9.67929 5.27842 9.67934 5.27842 9.6794C5.27842 9.67945 5.27842 9.67951 5.27842 9.67956C5.27842 9.67962 5.27842 9.67967 5.27842 9.67973C5.27842 9.67978 5.27842 9.67984 5.27842 9.67989C5.27842 9.67994 5.27842 9.68 5.27842 9.68005C5.27842 9.68011 5.27842 9.68016 5.27842 9.68022C5.27842 9.68027 5.27842 9.68033 5.27842 9.68038C5.27842 9.68044 5.27842 9.68049 5.27842 9.68055C5.27842 9.6806 5.27842 9.68066 5.27842 9.68071C5.27842 9.68077 5.27842 9.68082 5.27842 9.68087C5.27842 9.68093 5.27842 9.68098 5.27842 9.68104C5.27842 9.68109 5.27842 9.68115 5.27842 9.6812C5.27842 9.68126 5.27842 9.68131 5.27842 9.68137C5.27842 9.68142 5.27842 9.68148 5.27842 9.68153C5.27842 9.68159 5.27842 9.68164 5.27842 9.68169C5.27842 9.68175 5.27842 9.6818 5.27842 9.68186C5.27842 9.68191 5.27842 9.68197 5.27842 9.68202C5.27842 9.68208 5.27842 9.68213 5.27842 9.68219C5.27842 9.68224 5.27842 9.6823 5.27842 9.68235C5.27842 9.68241 5.27842 9.68246 5.27842 9.68252C5.27842 9.68257 5.27842 9.68262 5.27842 9.68268C5.27842 9.68273 5.27842 9.68279 5.27842 9.68284C5.27842 9.6829 5.27842 9.68295 5.27842 9.68301C5.27842 9.68306 5.27842 9.68312 5.27842 9.68317C5.27842 9.68323 5.27842 9.68328 5.27842 9.68334C5.27842 9.68339 5.27842 9.68344 5.27842 9.6835C5.27842 9.68355 5.27842 9.68361 5.27842 9.68366C5.27842 9.68372 5.27842 9.68377 5.27842 9.68383C5.27842 9.68388 5.27842 9.68394 5.27842 9.68399C5.27842 9.68405 5.27842 9.6841 5.27842 9.68416C5.27842 9.68421 5.27842 9.68427 5.27842 9.68432C5.27842 9.68437 5.27842 9.68443 5.27842 9.68448C5.27842 9.68454 5.27842 9.68459 5.27842 9.68465C5.27842 9.6847 5.27842 9.68476 5.27842 9.68481C5.27842 9.68487 5.27842 9.68492 5.27842 9.68498C5.27842 9.68503 5.27842 9.68509 5.27842 9.68514C5.27842 9.68519 5.27842 9.68525 5.27842 9.6853C5.27842 9.68536 5.27842 9.68541 5.27842 9.68547C5.27842 9.68552 5.27842 9.68558 5.27842 9.68563C5.27842 9.68569 5.27842 9.68574 5.27842 9.6858C5.27842 9.68585 5.27842 9.68591 5.27842 9.68596C5.27842 9.68602 5.27842 9.68607 5.27842 9.68612C5.27842 9.68618 5.27842 9.68623 5.27842 9.68629C5.27842 9.68634 5.27842 9.6864 5.27842 9.68645C5.27842 9.68651 5.27842 9.68656 5.27842 9.68662C5.27842 9.68667 5.27842 9.68673 5.27842 9.68678C5.27842 9.68684 5.27842 9.68689 5.27842 9.68694C5.27842 9.687 5.27842 9.68705 5.27842 9.68711C5.27842 9.68716 5.27842 9.68722 5.27842 9.68727C5.27842 9.68733 5.27842 9.68738 5.27842 9.68744C5.27842 9.68749 5.27842 9.68755 5.27842 9.6876C5.27842 9.68766 5.27842 9.68771 5.27842 9.68777C5.27842 9.68782 5.27842 9.68787 5.27842 9.68793C5.27842 9.68798 5.27842 9.68804 5.27842 9.68809C5.27842 9.68815 5.27842 9.6882 5.27842 9.68826C5.27842 9.68831 5.27842 9.68837 5.27842 9.68842C5.27842 9.68848 5.27842 9.68853 5.27842 9.68859C5.27842 9.68864 5.27842 9.68869 5.27842 9.68875C5.27842 9.6888 5.27842 9.68886 5.27842 9.68891C5.27842 9.68897 5.27842 9.68902 5.27842 9.68908C5.27842 9.68913 5.27842 9.68919 5.27842 9.68924C5.27842 9.6893 5.27842 9.68935 5.27842 9.68941C5.27842 9.68946 5.27842 9.68952 5.27842 9.68957C5.27842 9.68962 5.27842 9.68968 5.27842 9.68973C5.27842 9.68979 5.27842 9.68984 5.27842 9.6899C5.27842 9.68995 5.27842 9.69001 5.27842 9.69006C5.27842 9.69012 5.27842 9.69017 5.27842 9.69023C5.27842 9.69028 5.27842 9.69034 5.27842 9.69039C5.27842 9.69044 5.27842 9.6905 5.27842 9.69055C5.27842 9.69061 5.27842 9.69066 5.27842 9.69072C5.27842 9.69077 5.27842 9.69083 5.27842 9.69088C5.27842 9.69094 5.27842 9.69099 5.27842 9.69105C5.27842 9.6911 5.27842 9.69116 5.27842 9.69121C5.27842 9.69127 5.27842 9.69132 5.27842 9.69137C5.27842 9.69143 5.27842 9.69148 5.27842 9.69154C5.27842 9.69159 5.27842 9.69165 5.27842 9.6917C5.27842 9.69176 5.27842 9.69181 5.27842 9.69187C5.27842 9.69192 5.27842 9.69198 5.27842 9.69203C5.27842 9.69209 5.27842 9.69214 5.27842 9.69219C5.27842 9.69225 5.27842 9.6923 5.27842 9.69236C5.27842 9.69241 5.27842 9.69247 5.27842 9.69252C5.27842 9.69258 5.27842 9.69263 5.27842 9.69269C5.27842 9.69274 5.27842 9.6928 5.27842 9.69285C5.27842 9.69291 5.27842 9.69296 5.27842 9.69302C5.27842 9.69307 5.27842 9.69312 5.27842 9.69318C5.27842 9.69323 5.27842 9.69329 5.27842 9.69334C5.27842 9.6934 5.27842 9.69345 5.27842 9.69351C5.27842 9.69356 5.27842 9.69362 5.27842 9.69367C5.27842 9.69373 5.27842 9.69378 5.27842 9.69384C5.27842 9.69389 5.27842 9.69394 5.27842 9.694C5.27842 9.69405 5.27842 9.69411 5.27842 9.69416C5.27842 9.69422 5.27842 9.69427 5.27842 9.69433C5.27842 9.69438 5.27842 9.69444 5.27842 9.69449C5.27842 9.69455 5.27842 9.6946 5.27842 9.69466C5.27842 9.69471 5.27842 9.69477 5.27842 9.69482C5.27842 9.69487 5.27842 9.69493 5.27842 9.69498C5.27842 9.69504 5.27842 9.69509 5.27842 9.69515C5.27842 9.6952 5.27842 9.69526 5.27842 9.69531C5.27842 9.69537 5.27842 9.69542 5.27842 9.69548C5.27842 9.69553 5.27842 9.69559 5.27842 9.69564C5.27842 9.69569 5.27842 9.69575 5.27842 9.6958C5.27842 9.69586 5.27842 9.69591 5.27842 9.69597C5.27842 9.69602 5.27842 9.69608 5.27842 9.69613C5.27842 9.69619 5.27842 9.69624 5.27842 9.6963C5.27842 9.69635 5.27842 9.69641 5.27842 9.69646C5.27842 9.69652 5.27842 9.69657 5.27842 9.69662C5.27842 9.69668 5.27842 9.69673 5.27842 9.69679C5.27842 9.69684 5.27842 9.6969 5.27842 9.69695C5.27842 9.69701 5.27842 9.69706 5.27842 9.69712C5.27842 9.69717 5.27842 9.69723 5.27842 9.69728C5.27842 9.69734 5.27842 9.69739 5.27842 9.69744C5.27842 9.6975 5.27842 9.69755 5.27842 9.69761C5.27842 9.69766 5.27842 9.69772 5.27842 9.69777C5.27842 9.69783 5.27842 9.69788 5.27842 9.69794C5.27842 9.69799 5.27842 9.69805 5.27842 9.6981C5.27842 9.69816 5.27842 9.69821 5.27842 9.69827C5.27842 9.69832 5.27842 9.69837 5.27842 9.69843C5.27842 9.69848 5.27842 9.69854 5.27842 9.69859C5.27842 9.69865 5.27842 9.6987 5.27842 9.69876C5.27842 9.69881 5.27842 9.69887 5.27842 9.69892C5.27842 9.69898 5.27842 9.69903 5.27842 9.69909C5.27842 9.69914 5.27842 9.69919 5.27842 9.69925C5.27842 9.6993 5.27842 9.69936 5.27842 9.69941C5.27842 9.69947 5.27842 9.69952 5.27842 9.69958C5.27842 9.69963 5.27842 9.69969 5.27842 9.69974C5.27842 9.6998 5.27842 9.69985 5.27842 9.69991C5.27842 9.69996 5.27842 9.70002 5.27842 9.70007C5.27842 9.70012 5.27842 9.70018 5.27842 9.70023C5.27842 9.70029 5.27842 9.70034 5.27842 9.7004C5.27842 9.70045 5.27842 9.70051 5.27842 9.70056C5.27842 9.70062 5.27842 9.70067 5.27842 9.70073C5.27842 9.70078 5.27842 9.70084 5.27842 9.70089C5.27842 9.70094 5.27842 9.701 5.27842 9.70105C5.27842 9.70111 5.27842 9.70116 5.27842 9.70122C5.27842 9.70127 5.27842 9.70133 5.27842 9.70138C5.27842 9.70144 5.27842 9.70149 5.27842 9.70155C5.27842 9.7016 5.27842 9.70166 5.27842 9.70171C5.27842 9.70177 5.27842 9.70182 5.27842 9.70187C5.27842 9.70193 5.27842 9.70198 5.27842 9.70204C5.27842 9.70209 5.27842 9.70215 5.27842 9.7022C5.27842 9.70226 5.27842 9.70231 5.27842 9.70237C5.27842 9.70242 5.27842 9.70248 5.27842 9.70253C5.27842 9.70259 5.27842 9.70264 5.27842 9.70269C5.27842 9.70275 5.27842 9.7028 5.27842 9.70286C5.27842 9.70291 5.27842 9.70297 5.27842 9.70302C5.27842 9.70308 5.27842 9.70313 5.27842 9.70319C5.27842 9.70324 5.27842 9.7033 5.27842 9.70335C5.27842 9.70341 5.27842 9.70346 5.27842 9.70352C5.27842 9.70357 5.27842 9.70362 5.27842 9.70368C5.27842 9.70373 5.27842 9.70379 5.27842 9.70384C5.27842 9.7039 5.27842 9.70395 5.27842 9.70401C5.27842 9.70406 5.27842 9.70412 5.27842 9.70417C5.27842 9.70423 5.27842 9.70428 5.27842 9.70434C5.27842 9.70439 5.27842 9.70444 5.27842 9.7045C5.27842 9.70455 5.27842 9.70461 5.27842 9.70466C5.27842 9.70472 5.27842 9.70477 5.27842 9.70483C5.27842 9.70488 5.27842 9.70494 5.27842 9.70499C5.27842 9.70505 5.27842 9.7051 5.27842 9.70516C5.27842 9.70521 5.27842 9.70527 5.27842 9.70532C5.27842 9.70537 5.27842 9.70543 5.27842 9.70548C5.27842 9.70554 5.27842 9.70559 5.27842 9.70565C5.27842 9.7057 5.27842 9.70576 5.27842 9.70581C5.27842 9.70587 5.27842 9.70592 5.27842 9.70598C5.27842 9.70603 5.27842 9.70609 5.27842 9.70614C5.27842 9.70619 5.27842 9.70625 5.27842 9.7063C5.27842 9.70636 5.27842 9.70641 5.27842 9.70647C5.27842 9.70652 5.27842 9.70658 5.27842 9.70663C5.27842 9.70669 5.27842 9.70674 5.27842 9.7068C5.27842 9.70685 5.27842 9.70691 5.27842 9.70696C5.27842 9.70702 5.27842 9.70707 5.27842 9.70712C5.27842 9.70718 5.27842 9.70723 5.27842 9.70729C5.27842 9.70734 5.27842 9.7074 5.27842 9.70745C5.27842 9.70751 5.27842 9.70756 5.27842 9.70762C5.27842 9.70767 5.27842 9.70773 5.27842 9.70778C5.27842 9.70784 5.27842 9.70789 5.27842 9.70794C5.27842 9.708 5.27842 9.70805 5.27842 9.70811C5.27842 9.70816 5.27842 9.70822 5.27842 9.70827C5.27842 9.70833 5.27842 9.70838 5.27842 9.70844C5.27842 9.70849 5.27842 9.70855 5.27842 9.7086C5.27842 9.70866 5.27842 9.70871 5.27842 9.70877C5.27842 9.70882 5.27842 9.70887 5.27842 9.70893C5.27842 9.70898 5.27842 9.70904 5.27842 9.70909C5.27842 9.70915 5.27842 9.7092 5.27842 9.70926C5.27842 9.70931 5.27842 9.70937 5.27842 9.70942C5.27842 9.70948 5.27842 9.70953 5.27842 9.70959C5.27842 9.70964 5.27842 9.70969 5.27842 9.70975C5.27842 9.7098 5.27842 9.70986 5.27842 9.70991C5.27842 9.70997 5.27842 9.71002 5.27842 9.71008C5.27842 9.71013 5.27842 9.71019 5.27842 9.71024C5.27842 9.7103 5.27842 9.71035 5.27842 9.71041C5.27842 9.71046 5.27842 9.71052 5.27842 9.71057C5.27842 9.71062 5.27842 9.71068 5.27842 9.71073C5.27842 9.71079 5.27842 9.71084 5.27842 9.7109C5.27842 9.71095 5.27842 9.71101 5.27842 9.71106C5.27842 9.71112 5.27842 9.71117 5.27842 9.71123C5.27842 9.71128 5.27842 9.71134 5.27842 9.71139C5.27842 9.71144 5.27842 9.7115 5.27842 9.71155C5.27842 9.71161 5.27842 9.71166 5.27842 9.71172C5.27842 9.71177 5.27842 9.71183 5.27842 9.71188C5.27842 9.71194 5.27842 9.71199 5.27842 9.71205C5.27842 9.7121 5.27842 9.71216 5.27842 9.71221C5.27842 9.71227 5.27842 9.71232 5.27842 9.71237C5.27842 9.71243 5.27842 9.71248 5.27842 9.71254C5.27842 9.71259 5.27842 9.71265 5.27842 9.7127C5.27842 9.71276 5.27842 9.71281 5.27842 9.71287C5.27842 9.71292 5.27842 9.71298 5.27842 9.71303C5.27842 9.71309 5.27842 9.71314 5.27842 9.71319C5.27842 9.71325 5.27842 9.7133 5.27842 9.71336C5.27842 9.71341 5.27842 9.71347 5.27842 9.71352C5.27842 9.71358 5.27842 9.71363 5.27842 9.71369C5.27842 9.71374 5.27842 9.7138 5.27842 9.71385C5.27842 9.71391 5.27842 9.71396 5.27842 9.71402C5.27842 9.71407 5.27842 9.71412 5.27842 9.71418C5.27842 9.71423 5.27842 9.71429 5.27842 9.71434C5.27842 9.7144 5.27842 9.71445 5.27842 9.71451C5.27842 9.71456 5.27842 9.71462 5.27842 9.71467C5.27842 9.71473 5.27842 9.71478 5.27842 9.71484C5.27842 9.71489 5.27842 9.71494 5.27842 9.715C5.27842 9.71505 5.27842 9.71511 5.27842 9.71516C5.27842 9.71522 5.27842 9.71527 5.27842 9.71533C5.27842 9.71538 5.27842 9.71544 5.27842 9.71549C5.27842 9.71555 5.27842 9.7156 5.27842 9.71566C5.27842 9.71571 5.27842 9.71577 5.27842 9.71582C5.27842 9.71587 5.27842 9.71593 5.27842 9.71598C5.27842 9.71604 5.27842 9.71609 5.27842 9.71615C5.27842 9.7162 5.27842 9.71626 5.27842 9.71631C5.27842 9.71637 5.27842 9.71642 5.27842 9.71648C5.27842 9.71653 5.27842 9.71659 5.27842 9.71664C5.27842 9.71669 5.27842 9.71675 5.27842 9.7168C5.27842 9.71686 5.27842 9.71691 5.27842 9.71697C5.27842 9.71702 5.27842 9.71708 5.27842 9.71713C5.27842 9.71719 5.27842 9.71724 5.27842 9.7173C5.27842 9.71735 5.27842 9.71741 5.27842 9.71746C5.27842 9.71752 5.27842 9.71757 5.27842 9.71762C5.27842 9.71768 5.27842 9.71773 5.27842 9.71779C5.27842 9.71784 5.27842 9.7179 5.27842 9.71795C5.27842 9.71801 5.27842 9.71806 5.27842 9.71812C5.27842 9.71817 5.27842 9.71823 5.27842 9.71828C5.27842 9.71834 5.27842 9.71839 5.27842 9.71844C5.27842 9.7185 5.27842 9.71855 5.27842 9.71861C5.27842 9.71866 5.27842 9.71872 5.27842 9.71877C5.27842 9.71883 5.27842 9.71888 5.27842 9.71894C5.27842 9.71899 5.27842 9.71905 5.27842 9.7191C5.27842 9.71916 5.27842 9.71921 5.27842 9.71927C5.27842 9.71932 5.27842 9.71937 5.27842 9.71943C5.27842 9.71948 5.27842 9.71954 5.27842 9.71959C5.27842 9.71965 5.27842 9.7197 5.27842 9.71976C5.27842 9.71981 5.27842 9.71987 5.27842 9.71992C5.27842 9.71998 5.27842 9.72003 5.27842 9.72009C5.27842 9.72014 5.27842 9.72019 5.27842 9.72025C5.27842 9.7203 5.27842 9.72036 5.27842 9.72041C5.27842 9.72047 5.27842 9.72052 5.27842 9.72058C5.27842 9.72063 5.27842 9.72069 5.27842 9.72074C5.27842 9.7208 5.27842 9.72085 5.27842 9.72091C5.27842 9.72096 5.27842 9.72102 5.27842 9.72107C5.27842 9.72112 5.27842 9.72118 5.27842 9.72123C5.27842 9.72129 5.27842 9.72134 5.27842 9.7214C5.27842 9.72145 5.27842 9.72151 5.27842 9.72156C5.27842 9.72162 5.27842 9.72167 5.27842 9.72173C5.27842 9.72178 5.27842 9.72184 5.27842 9.72189C5.27842 9.72194 5.27842 9.722 5.27842 9.72205C5.27842 9.72211 5.27842 9.72216 5.27842 9.72222C5.27842 9.72227 5.27842 9.72233 5.27842 9.72238C5.27842 9.72244 5.27842 9.72249 5.27842 9.72255C5.27842 9.7226 5.27842 9.72266 5.27842 9.72271C5.27842 9.72277 5.27842 9.72282 5.27842 9.72287C5.27842 9.72293 5.27842 9.72298 5.27842 9.72304C5.27842 9.72309 5.27842 9.72315 5.27842 9.7232C5.27842 9.72326 5.27842 9.72331 5.27842 9.72337C5.27842 9.72342 5.27842 9.72348 5.27842 9.72353C5.27842 9.72359 5.27842 9.72364 5.27842 9.72369C5.27842 9.72375 5.27842 9.7238 5.27842 9.72386C5.27842 9.72391 5.27842 9.72397 5.27842 9.72402C5.27842 9.72408 5.27842 9.72413 5.27842 9.72419C5.27842 9.72424 5.27842 9.7243 5.27842 9.72435C5.27842 9.72441 5.27842 9.72446 5.27842 9.72452C5.27842 9.72457 5.27842 9.72462 5.27842 9.72468C5.27842 9.72473 5.27842 9.72479 5.27842 9.72484C5.27842 9.7249 5.27842 9.72495 5.27842 9.72501C5.27842 9.72506 5.27842 9.72512 5.27842 9.72517C5.27842 9.72523 5.27842 9.72528 5.27842 9.72534C5.27842 9.72539 5.27842 9.72544 5.27842 9.7255C5.27842 9.72555 5.27842 9.72561 5.27842 9.72566C5.27842 9.72572 5.27842 9.72577 5.27842 9.72583C5.27842 9.72588 5.27842 9.72594 5.27842 9.72599C5.27842 9.72605 5.27842 9.7261 5.27842 9.72616C5.27842 9.72621 5.27842 9.72627 5.27842 9.72632C5.27842 9.72637 5.27842 9.72643 5.27842 9.72648C5.27842 9.72654 5.27842 9.72659 5.27842 9.72665C5.27842 9.7267 5.27842 9.72676 5.27842 9.72681C5.27842 9.72687 5.27842 9.72692 5.27842 9.72698C5.27842 9.72703 5.27842 9.72709 5.27842 9.72714C5.27842 9.72719 5.27842 9.72725 5.27842 9.7273C5.27842 9.72736 5.27842 9.72741 5.27842 9.72747C5.27842 9.72752 5.27842 9.72758 5.27842 9.72763C5.27842 9.72769 5.27842 9.72774 5.27842 9.7278C5.27842 9.72785 5.27842 9.72791 5.27842 9.72796C5.27842 9.72802 5.27842 9.72807 5.27842 9.72812C5.27842 9.72818 5.27842 9.72823 5.27842 9.72829C5.27842 9.72834 5.27842 9.7284 5.27842 9.72845C5.27842 9.72851 5.27842 9.72856 5.27842 9.72862C5.27842 9.72867 5.27842 9.72873 5.27842 9.72878C5.27842 9.72884 5.27842 9.72889 5.27842 9.72894C5.27842 9.729 5.27842 9.72905 5.27842 9.72911C5.27842 9.72916 5.27842 9.72922 5.27842 9.72927C5.27842 9.72933 5.27842 9.72938 5.27842 9.72944C5.27842 9.72949 5.27842 9.72955 5.27842 9.7296C5.27842 9.72966 5.27842 9.72971 5.27842 9.72977C5.27842 9.72982 5.27842 9.72987 5.27842 9.72993C5.27842 9.72998 5.27842 9.73004 5.27842 9.73009C5.27842 9.73015 5.27842 9.7302 5.27842 9.73026C5.27842 9.73031 5.27842 9.73037 5.27842 9.73042C5.27842 9.73048 5.27842 9.73053 5.27842 9.73059C5.27842 9.73064 5.27842 9.73069 5.27842 9.73075C5.27842 9.7308 5.27842 9.73086 5.27842 9.73091C5.27842 9.73097 5.27842 9.73102 5.27842 9.73108C5.27842 9.73113 5.27842 9.73119 5.27842 9.73124C5.27842 9.7313 5.27842 9.73135 5.27842 9.73141C5.27842 9.73146 5.27842 9.73152 5.27842 9.73157C5.27842 9.73162 5.27842 9.73168 5.27842 9.73173C5.27842 9.73179 5.27842 9.73184 5.27842 9.7319C5.27842 9.73195 5.27842 9.73201 5.27842 9.73206C5.27842 9.73212 5.27842 9.73217 5.27842 9.73223C5.27842 9.73228 5.27842 9.73234 5.27842 9.73239C5.27842 9.73244 5.27842 9.7325 5.27842 9.73255C5.27842 9.73261 5.27842 9.73266 5.27842 9.73272C5.27842 9.73277 5.27842 9.73283 5.27842 9.73288C5.27842 9.73294 5.27842 9.73299 5.27842 9.73305C5.27842 9.7331 5.27842 9.73316 5.27842 9.73321C5.27842 9.73327 5.27842 9.73332 5.27842 9.73337C5.27842 9.73343 5.27842 9.73348 5.27842 9.73354C5.27842 9.73359 5.27842 9.73365 5.27842 9.7337C5.27842 9.73376 5.27842 9.73381 5.27842 9.73387C5.27842 9.73392 5.27842 9.73398 5.27842 9.73403C5.27842 9.73409 5.27842 9.73414 5.27842 9.73419C5.27842 9.73425 5.27842 9.7343 5.27842 9.73436C5.27842 9.73441 5.27842 9.73447 5.27842 9.73452C5.27842 9.73458 5.27842 9.73463 5.27842 9.73469C5.27842 9.73474 5.27842 9.7348 5.27842 9.73485C5.27842 9.73491 5.27842 9.73496 5.27842 9.73502C5.27842 9.73507 5.27842 9.73512 5.27842 9.73518C5.27842 9.73523 5.27842 9.73529 5.27842 9.73534C5.27842 9.7354 5.27842 9.73545 5.27842 9.73551C5.27842 9.73556 5.27842 9.73562 5.27842 9.73567C5.27842 9.73573 5.27842 9.73578 5.27842 9.73584C5.27842 9.73589 5.27842 9.73594 5.27842 9.736C5.27842 9.73605 5.27842 9.73611 5.27842 9.73616C5.27842 9.73622 5.27842 9.73627 5.27842 9.73633C5.27842 9.73638 5.27842 9.73644 5.27842 9.73649C5.27842 9.73655 5.27842 9.7366 5.27842 9.73666C5.27842 9.73671 5.27842 9.73677 5.27842 9.73682C5.27842 9.73687 5.27842 9.73693 5.27842 9.73698C5.27842 9.73704 5.27842 9.73709 5.27842 9.73715C5.27842 9.7372 5.27842 9.73726 5.27842 9.73731C5.27842 9.73737 5.27842 9.73742 5.27842 9.73748C5.27842 9.73753 5.27842 9.73759 5.27842 9.73764C5.27842 9.73769 5.27842 9.73775 5.27842 9.7378C5.27842 9.73786 5.27842 9.73791 5.27842 9.73797C5.27842 9.73802 5.27842 9.73808 5.27842 9.73813C5.27842 9.73819 5.27842 9.73824 5.27842 9.7383C5.27842 9.73835 5.27842 9.73841 5.27842 9.73846C5.27842 9.73852 5.27842 9.73857 5.27842 9.73862C5.27842 9.73868 5.27842 9.73873 5.27842 9.73879C5.27842 9.73884 5.27842 9.7389 5.27842 9.73895C5.27842 9.73901 5.27842 9.73906 5.27842 9.73912C5.27842 9.73917 5.27842 9.73923 5.27842 9.73928C5.27842 9.73934 5.27842 9.73939 5.27842 9.73944C5.27842 9.7395 5.27842 9.73955 5.27842 9.73961C5.27842 9.73966 5.27842 9.73972 5.27842 9.73977C5.27842 9.73983 5.27842 9.73988 5.27842 9.73994C5.27842 9.73999 5.27842 9.74005 5.27842 9.7401C5.27842 9.74016 5.27842 9.74021 5.27842 9.74027C5.27842 9.74032 5.27842 9.74037 5.27842 9.74043C5.27842 9.74048 5.27842 9.74054 5.27842 9.74059C5.27842 9.74065 5.27842 9.7407 5.27842 9.74076C5.27842 9.74081 5.27842 9.74087 5.27842 9.74092C5.27842 9.74098 5.27842 9.74103 5.27842 9.74109C5.27842 9.74114 5.27842 9.74119 5.27842 9.74125C5.27842 9.7413 5.27842 9.74136 5.27842 9.74141C5.27842 9.74147 5.27842 9.74152 5.27842 9.74158C5.27842 9.74163 5.27842 9.74169 5.27842 9.74174C5.27842 9.7418 5.27842 9.74185 5.27842 9.74191C5.27842 9.74196 5.27842 9.74202 5.27842 9.74207C5.27842 9.74212 5.27842 9.74218 5.27842 9.74223C5.27842 9.74229 5.27842 9.74234 5.27842 9.7424C5.27842 9.74245 5.27842 9.74251 5.27842 9.74256C5.27842 9.74262 5.27842 9.74267 5.27842 9.74273C5.27842 9.74278 5.27842 9.74284 5.27842 9.74289C5.27842 9.74294 5.27842 9.743 5.27842 9.74305C5.27842 9.74311 5.27842 9.74316 5.27842 9.74322C5.27842 9.74327 5.27842 9.74333 5.27842 9.74338C5.27842 9.74344 5.27842 9.74349 5.27842 9.74355C5.27842 9.7436 5.27842 9.74366 5.27842 9.74371C5.27842 9.74377 5.27842 9.74382 5.27842 9.74387C5.27842 9.74393 5.27842 9.74398 5.27842 9.74404C5.27842 9.74409 5.27842 9.74415 5.27842 9.7442C5.27842 9.74426 5.27842 9.74431 5.27842 9.74437C5.27842 9.74442 5.27842 9.74448 5.27842 9.74453C5.27842 9.74459 5.27842 9.74464 5.27842 9.74469C5.27842 9.74475 5.27842 9.7448 5.27842 9.74486C5.27842 9.74491 5.27842 9.74497 5.27842 9.74502C5.27842 9.74508 5.27842 9.74513 5.27842 9.74519C5.27842 9.74524 5.27842 9.7453 5.27842 9.74535C5.27842 9.74541 5.27842 9.74546 5.27842 9.74552C5.27842 9.74557 5.27842 9.74562 5.27842 9.74568C5.27842 9.74573 5.27842 9.74579 5.27842 9.74584C5.27842 9.7459 5.27842 9.74595 5.27842 9.74601C5.27842 9.74606 5.27842 9.74612 5.27842 9.74617C5.27842 9.74623 5.27842 9.74628 5.27842 9.74634C5.27842 9.74639 5.27842 9.74644 5.27842 9.7465C5.27842 9.74655 5.27842 9.74661 5.27842 9.74666C5.27842 9.74672 5.27842 9.74677 5.27842 9.74683C5.27842 9.74688 5.27842 9.74694 5.27842 9.74699C5.27842 9.74705 5.27842 9.7471 5.27842 9.74716C5.27842 9.74721 5.27842 9.74727 5.27842 9.74732C5.27842 9.74737 5.27842 9.74743 5.27842 9.74748C5.27842 9.74754 5.27842 9.74759 5.27842 9.74765C5.27842 9.7477 5.27842 9.74776 5.27842 9.74781C5.27842 9.74787 5.27842 9.74792 5.27842 9.74798C5.27842 9.74803 5.27842 9.74809 5.27842 9.74814C5.27842 9.74819 5.27842 9.74825 5.27842 9.7483C5.27842 9.74836 5.27842 9.74841 5.27842 9.74847C5.27842 9.74852 5.27842 9.74858 5.27842 9.74863C5.27842 9.74869 5.27842 9.74874 5.27842 9.7488C5.27842 9.74885 5.27842 9.74891 5.27842 9.74896C5.27842 9.74902 5.27842 9.74907 5.27842 9.74912C5.27842 9.74918 5.27842 9.74923 5.27842 9.74929C5.27842 9.74934 5.27842 9.7494 5.27842 9.74945C5.27842 9.74951 5.27842 9.74956 5.27842 9.74962C5.27842 9.74967 5.27842 9.74973 5.27842 9.74978C5.27842 9.74984 5.27842 9.74989 5.27842 9.74994C5.27842 9.75 5.27842 9.75005 5.27842 9.75011C5.27842 9.75016 5.27842 9.75022 5.27842 9.75027C5.27842 9.75033 5.27842 9.75038 5.27842 9.75044C5.27842 9.75049 5.27842 9.75055 5.27842 9.7506C5.27842 9.75066 5.27842 9.75071 5.27842 9.75077C5.27842 9.75082 5.27842 9.75087 5.27842 9.75093C5.27842 9.75098 5.27842 9.75104 5.27842 9.75109C5.27842 9.75115 5.27842 9.7512 5.27842 9.75126C5.27842 9.75131 5.27842 9.75137 5.27842 9.75142C5.27842 9.75148 5.27842 9.75153 5.27842 9.75159C5.27842 9.75164 5.27842 9.75169 5.27842 9.75175C5.27842 9.7518 5.27842 9.75186 5.27842 9.75191C5.27842 9.75197 5.27842 9.75202 5.27842 9.75208C5.27842 9.75213 5.27842 9.75219 5.27842 9.75224C5.27842 9.7523 5.27842 9.75235 5.27842 9.75241C5.27842 9.75246 5.27842 9.75252 5.27842 9.75257C5.27842 9.75262 5.27842 9.75268 5.27842 9.75273C5.27842 9.75279 5.27842 9.75284 5.27842 9.7529C5.27842 9.75295 5.27842 9.75301 5.27842 9.75306C5.27842 9.75312 5.27842 9.75317 5.27842 9.75323C5.27842 9.75328 5.27842 9.75334 5.27842 9.75339H6.77842ZM6.77763 9.70381C6.8301 8.56167 7.76444 7.70924 8.8332 7.75277L8.89424 6.25401C6.96565 6.17546 5.36793 7.70389 5.27921 9.63497L6.77763 9.70381ZM8.86519 7.75339C9.13045 7.75287 9.3941 7.79968 9.64447 7.89204L10.1636 6.48474C9.74661 6.33091 9.30621 6.25252 8.86225 6.25339L8.86519 7.75339ZM10.5744 7.52468C11.1339 6.4094 12.2557 5.72957 13.4578 5.75324L13.4873 4.25354C11.6923 4.21818 10.0456 5.23356 9.23366 6.8521L10.5744 7.52468ZM13.5045 5.75271C15.1363 5.68302 16.5474 6.9835 16.6233 8.70343L18.1218 8.63735C18.0111 6.12639 15.9345 4.14756 13.4405 4.25407L13.5045 5.75271ZM16.6225 8.67103C16.6228 8.95064 16.5799 9.22831 16.4958 9.49367L17.9256 9.94711C18.0565 9.53433 18.1229 9.10326 18.1225 8.66975L16.6225 8.67103ZM17.1014 10.4624C18.0096 10.5962 18.7173 11.385 18.7504 12.3618L20.2496 12.311C20.1928 10.6369 18.9717 9.22168 17.32 8.9784L17.1014 10.4624ZM18.7508 12.3022C18.6987 13.445 17.7638 14.2979 16.6945 14.254L16.6329 15.7528C18.5625 15.832 20.1611 14.3026 20.2492 12.3705L18.7508 12.3022ZM11.163 16.4798L9.21299 18.4798L10.287 19.527L12.237 17.527L11.163 16.4798ZM10.5 19.0034V11.0034H8.99999V19.0034H10.5ZM10.287 18.4798L8.33699 16.4798L7.26299 17.527L9.21299 19.527L10.287 18.4798ZM12.237 13.527L14.187 11.527L13.113 10.4798L11.163 12.4798L12.237 13.527ZM12.9 11.0034V19.0034H14.4V11.0034H12.9ZM13.113 11.527L15.063 13.527L16.137 12.4798L14.187 10.4798L13.113 11.527Z" fill="#000000"/>
</svg>```
